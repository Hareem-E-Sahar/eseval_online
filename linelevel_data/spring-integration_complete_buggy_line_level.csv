"fix_commit_hash","commit_hash","change_type","is_buggy_line","code_change_remove_common_tokens"
"b85ed0fe279daee8322a6f9a4342af0938596422","126fa35e2bf8a6dba7c71492b2dca9a1d400d3af","added",0,"import java.io.*;"
"b85ed0fe279daee8322a6f9a4342af0938596422","126fa35e2bf8a6dba7c71492b2dca9a1d400d3af","added",0,"FileOutputStream fileOutputStream = new FileOutputStream(accessTokenCreds);"
"b85ed0fe279daee8322a6f9a4342af0938596422","126fa35e2bf8a6dba7c71492b2dca9a1d400d3af","added",0,"props.store(fileOutputStream, ""oauth-access-token"");"
"b85ed0fe279daee8322a6f9a4342af0938596422","126fa35e2bf8a6dba7c71492b2dca9a1d400d3af","added",0,"IOUtils.closeQuietly(fileOutputStream);"
"b85ed0fe279daee8322a6f9a4342af0938596422","126fa35e2bf8a6dba7c71492b2dca9a1d400d3af","deleted",1,"import java.io.BufferedReader;"
"b85ed0fe279daee8322a6f9a4342af0938596422","126fa35e2bf8a6dba7c71492b2dca9a1d400d3af","deleted",1,"import java.io.File;"
"b85ed0fe279daee8322a6f9a4342af0938596422","126fa35e2bf8a6dba7c71492b2dca9a1d400d3af","deleted",1,"import java.io.FileWriter;"
"b85ed0fe279daee8322a6f9a4342af0938596422","126fa35e2bf8a6dba7c71492b2dca9a1d400d3af","deleted",1,"import java.io.InputStreamReader;"
"b85ed0fe279daee8322a6f9a4342af0938596422","126fa35e2bf8a6dba7c71492b2dca9a1d400d3af","deleted",1,"FileWriter writer = new FileWriter(accessTokenCreds);"
"b85ed0fe279daee8322a6f9a4342af0938596422","126fa35e2bf8a6dba7c71492b2dca9a1d400d3af","deleted",1,"props.store(writer, ""oauth-access-token"");"
"b85ed0fe279daee8322a6f9a4342af0938596422","126fa35e2bf8a6dba7c71492b2dca9a1d400d3af","deleted",1,"IOUtils.closeQuietly(writer);"
"245ae1d5fad32653c997774925207ea97ebec5d4","126fa35e2bf8a6dba7c71492b2dca9a1d400d3af","added",0,"import org.junit.Before;"
"245ae1d5fad32653c997774925207ea97ebec5d4","126fa35e2bf8a6dba7c71492b2dca9a1d400d3af","added",0,"*"
"245ae1d5fad32653c997774925207ea97ebec5d4","126fa35e2bf8a6dba7c71492b2dca9a1d400d3af","added",0,"* @author Josh Long"
"245ae1d5fad32653c997774925207ea97ebec5d4","126fa35e2bf8a6dba7c71492b2dca9a1d400d3af","added",0,"@Before"
"245ae1d5fad32653c997774925207ea97ebec5d4","126fa35e2bf8a6dba7c71492b2dca9a1d400d3af","deleted",1,"import javax.annotation.PostConstruct;"
"245ae1d5fad32653c997774925207ea97ebec5d4","126fa35e2bf8a6dba7c71492b2dca9a1d400d3af","deleted",1,"@PostConstruct"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"public String getChannelName(Method method) {"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"String channelName = this.getAnnotationValue(method, this.channelAttributeName, String.class);"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"if (channelName == null) {"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"channelName = this.getAnnotationValue(method.getDeclaringClass(), this.channelAttributeName, String.class);"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"}"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"return (StringUtils.hasText(channelName) ? channelName : null);"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,": ""#"" + ExpressionSource.RETURN_VALUE_VARIABLE_NAME;"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"payloadExpression = ""#"" + ExpressionSource.ARGUMENT_MAP_VARIABLE_NAME + ""["" + i + ""]"";"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"headerExpressions.put(name, ""#"" + ExpressionSource.ARGUMENT_MAP_VARIABLE_NAME + ""['"" + i + ""']"");"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,": ""#"" + this.getReturnValueVariableName(method);"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"payloadExpression = ""#"" + this.getArgumentMapVariableName(method) + ""["" + i + ""]"";"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"headerExpressions.put(name, ""#"" + this.getArgumentMapVariableName(method) + ""['"" + i + ""']"");"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"public String getMethodNameVariableName(Method method) {"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"ExpressionBinding annotation = AnnotationUtils.findAnnotation(method, ExpressionBinding.class);"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"if (annotation != null) {"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"return annotation.methodNameVariableName();"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"}"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"return ExpressionSource.DEFAULT_METHOD_NAME_VARIABLE_NAME;"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"public String[] getArgumentVariableNames(Method method) {"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"String argNameList = annotation.argumentVariableNames();"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"if (StringUtils.hasText(argNameList)) {"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"return StringUtils.tokenizeToStringArray(argNameList, "","");"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"return this.parameterNameDiscoverer.getParameterNames(method);"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"public String getArgumentMapVariableName(Method method) {"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"return annotation.argumentMapVariableName();"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"return ExpressionSource.DEFAULT_ARGUMENT_MAP_VARIABLE_NAME;"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"public String getReturnValueVariableName(Method method) {"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"return annotation.returnValueVariableName();"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"return ExpressionSource.DEFAULT_RETURN_VALUE_VARIABLE_NAME;"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"public String getExceptionVariableName(Method method) {"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"return annotation.exceptionVariableName();"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"return ExpressionSource.DEFAULT_EXCEPTION_VARIABLE_NAME;"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"public String getChannelName(Method method) {"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"String channelName = this.getAnnotationValue(method, this.channelAttributeName, String.class);"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"if (channelName == null) {"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"channelName = this.getAnnotationValue(method.getDeclaringClass(), this.channelAttributeName, String.class);"
"5c7f97f1015cc67e6b8ee71177ae1b877482e832","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"return (StringUtils.hasText(channelName) ? channelName : null);"
"25a2efe59cf4f2504c1f60b82cd0ad24564747b2","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"* Copyright 2002-2012 the original author or authors."
"25a2efe59cf4f2504c1f60b82cd0ad24564747b2","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"* Base class for url-based outbound gateway parsers."
"25a2efe59cf4f2504c1f60b82cd0ad24564747b2","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"*"
"25a2efe59cf4f2504c1f60b82cd0ad24564747b2","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"* Copyright 2002-2010 the original author or authors."
"25a2efe59cf4f2504c1f60b82cd0ad24564747b2","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"* Base class for url-based outbound gateway parsers."
"25a2efe59cf4f2504c1f60b82cd0ad24564747b2","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"*"
"25a2efe59cf4f2504c1f60b82cd0ad24564747b2","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"@Override"
"25a2efe59cf4f2504c1f60b82cd0ad24564747b2","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"protected String resolveId(Element element, AbstractBeanDefinition definition, ParserContext parserContext)"
"25a2efe59cf4f2504c1f60b82cd0ad24564747b2","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"throws BeanDefinitionStoreException {"
"25a2efe59cf4f2504c1f60b82cd0ad24564747b2","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"String id = super.resolveId(element, definition, parserContext);"
"25a2efe59cf4f2504c1f60b82cd0ad24564747b2","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"if (!StringUtils.hasText(id)) {"
"25a2efe59cf4f2504c1f60b82cd0ad24564747b2","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"id = element.getAttribute(""name"");"
"25a2efe59cf4f2504c1f60b82cd0ad24564747b2","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"}"
"25a2efe59cf4f2504c1f60b82cd0ad24564747b2","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"id = parserContext.getReaderContext().generateBeanName(definition);"
"25a2efe59cf4f2504c1f60b82cd0ad24564747b2","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"return id;"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"import org.apache.commons.logging.Log;"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"import org.apache.commons.logging.LogFactory;"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"*"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"private final Log logger = LogFactory.getLog(this.getClass());"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"private static final SpelExpressionParser PARSER = new SpelExpressionParser();"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"Object argumentValue = arguments[i];"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"for (Object key : ((Map<?, ?>) argumentValue).keySet()) {"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"if (payloadExpression == null){"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"throw new MessagingException(""Ambiguous method parameters; found more than one "" +"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"""Map-typed parameter and neither one contains a @Payload annotation"");"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"}"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"for (Object key : argumentValue.keySet()) {"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"if (this.logger.isWarnEnabled()){"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"this.logger.warn(""Invalid header name ["" + key +"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"""], name type must be String. Skipping mapping of this header to MessageHeaders."");"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"else {"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"Object value = argumentValue.get(key);"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"headers.put((String) key, value);"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"ParameterNameDiscoverer parameterNameDiscoverer = new LocalVariableTableParameterNameDiscoverer();"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"*"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"private static final SpelExpressionParser PARSER = new SpelExpressionParser();"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"Object argumentValue = arguments[i];"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"for (Object key : ((Map<?, ?>) argumentValue).keySet()) {"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"throw new MessagingException(""Ambiguous method parameters; found more than one "" +"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"""Map-typed parameter and neither one contains a @Payload annotation"");"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"for (Object key : argumentValue.keySet()) {"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"throw new IllegalArgumentException(""Invalid header name ["" + key +"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"""], name type must be String."");"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"Object value = argumentValue.get(key);"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"headers.put((String) key, value);"
"d2d9d67edb9b217d7813673efc449b7886e212a3","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"ParameterNameDiscoverer parameterNameDiscoverer = new LocalVariableTableParameterNameDiscoverer();"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"* Copyright 2002-2011 the original author or authors."
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"*"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"private volatile Folder folder;"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"private final Object folderMonitor = new Object();"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"return this.folder;"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"protected void openFolder() throws MessagingException {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (this.folder == null) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"this.folder = this.store.getFolder(this.url);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (this.folder == null || !this.folder.exists()) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (this.folder.isOpen()) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"this.folder.open(this.folderOpenMode);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"public Message[] receive() throws javax.mail.MessagingException {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"synchronized (this.folderMonitor) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"try {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"this.openFolder();"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (logger.isInfoEnabled()) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"logger.info(""attempting to receive mail from folder ["" + this.getFolder().getFullName() + ""]"");"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"}"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"Message[] messages = this.searchForNewMessages();"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (this.maxFetchSize > 0 && messages.length > this.maxFetchSize) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"Message[] reducedMessages = new Message[this.maxFetchSize];"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"System.arraycopy(messages, 0, reducedMessages, 0, this.maxFetchSize);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"messages = reducedMessages;"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (logger.isDebugEnabled()) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"logger.debug(""found "" + messages.length + "" new messages"");"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (messages.length > 0) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"this.fetchMessages(messages);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"List<Message> copiedMessages = new LinkedList<Message>();"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"logger.debug(""Recieved "" + messages.length + "" messages"");"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"boolean recentFlagSupported = false;"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"Flags flags = this.getFolder().getPermanentFlags();"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (flags != null){"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"recentFlagSupported = flags.contains(Flags.Flag.RECENT);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"for (int i = 0; i < messages.length; i++) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (!recentFlagSupported){"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (flags != null && flags.contains(Flags.Flag.USER)){"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (logger.isDebugEnabled()){"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"logger.debug(""USER flags are supported by this mail server. Flagging message with '"" + SI_USER_FLAG + ""' user flag"");"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"Flags siFlags = new Flags();"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"siFlags.add(SI_USER_FLAG);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"messages[i].setFlags(siFlags, true);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"else {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"logger.debug(""USER flags are not supported by this mail server. Flagging message with system flag"");"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"messages[i].setFlag(Flags.Flag.FLAGGED, true);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (this.selectorExpression != null) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"Message message = messages[i];"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (this.selectorExpression.getValue(this.context, message, Boolean.class)){"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"this.setAdditionalFlags(message);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"copiedMessages.add(new MimeMessage((MimeMessage) message));"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"logger.debug(""Fetched email with subject '"" + message.getSubject() + ""' will be discarded by the matching filter"" +"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,""" and will not be flagged as SEEN."");"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"this.setAdditionalFlags(messages[i]);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"copiedMessages.add(new MimeMessage((MimeMessage) messages[i]));"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (this.shouldDeleteMessages()) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"this.deleteMessages(messages);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"return copiedMessages.toArray(new Message[copiedMessages.size()]);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"finally {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"MailTransportUtils.closeFolder(this.folder, this.shouldDeleteMessages);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"this.folder.fetch(messages, contentsProfile);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"* Optional method allowing you to set additional flags."
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"public void destroy() throws Exception {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"MailTransportUtils.closeService(this.store);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"this.folder = null;"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"this.store = null;"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"this.initialized = false;"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"* Copyright 2002-2012 the original author or authors."
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"*"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"* @author Gary Russell"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"private final ThreadLocal<MailReceiverContext> contextHolder = new ThreadLocal<MailReceiverContext>();"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"return this.getTransactionContext().getFolder();"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"}"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"public MailReceiverContext getTransactionContext() {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"return doObtainTransactionContext();"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"private MailReceiverContext doObtainTransactionContext() {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"MailReceiverContext mailReceiverContext = this.contextHolder.get();"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (mailReceiverContext == null ||"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"mailReceiverContext.getFolder() == null ||"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"!mailReceiverContext.getFolder().isOpen()) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"try {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.openFolder();"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"return this.contextHolder.get();"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"catch (MessagingException e) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"throw new org.springframework.integration.MessagingException(""Failed to open folder"", e);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"return mailReceiverContext;"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"protected synchronized void openFolder() throws MessagingException {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"MailReceiverContext context = this.contextHolder.get();"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Folder folder = null;"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (context == null) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"folder = this.store.getFolder(this.url);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.contextHolder.set(new MailReceiverContext(folder));"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"else {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"folder = context.getFolder();"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (folder == null || !folder.exists()) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (folder.isOpen()) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"folder.open(this.folderOpenMode);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"public Message[] receive() throws javax.mail.MessagingException {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (logger.isInfoEnabled()) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"logger.info(""attempting to receive mail from folder ["" + this.getFolder().getFullName() + ""]"");"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Message[] messages = this.searchForNewMessages();"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (this.maxFetchSize > 0 && messages.length > this.maxFetchSize) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Message[] reducedMessages = new Message[this.maxFetchSize];"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"System.arraycopy(messages, 0, reducedMessages, 0, this.maxFetchSize);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"messages = reducedMessages;"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (logger.isDebugEnabled()) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"logger.debug(""found "" + messages.length + "" new messages"");"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (messages.length > 0) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.fetchMessages(messages);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"List<Message> copiedMessages = new LinkedList<Message>();"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"logger.debug(""Received "" + messages.length + "" messages"");"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"for (int i = 0; i < messages.length; i++) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (this.selectorExpression != null) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Message message = messages[i];"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (this.selectorExpression.getValue(this.context, message, Boolean.class)){"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"copiedMessages.add(new MimeMessage((MimeMessage) message));"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"copiedMessages.add(new MimeMessage((MimeMessage) messages[i]));"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.contextHolder.get().setMessages(messages);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"return copiedMessages.toArray(new Message[copiedMessages.size()]);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.contextHolder.get().getFolder().fetch(messages, contentsProfile);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"* Optional method allowing you to set additional flags."
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"public synchronized void destroy() throws Exception {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"MailTransportUtils.closeService(this.store);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.store = null;"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.initialized = false;"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"/**"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"* Delete and expunge messages after success."
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"* @param context"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"*/"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"public void closeContextAfterSuccess(MailReceiverContext context) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Assert.notNull(context, ""Mail Reader Context cannot be null"");"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Message[] messages = this.contextHolder.get().getMessages();"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Assert.state(messages != null, ""No messages in mail receiver context"");"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"RuntimeException exceptionToThrow = null;"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"boolean recentFlagSupported = false;"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Flags flags = context.getFolder().getPermanentFlags();"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (flags != null){"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"recentFlagSupported = flags.contains(Flags.Flag.RECENT);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (!recentFlagSupported){"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (flags != null && flags.contains(Flags.Flag.USER)){"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (logger.isDebugEnabled()){"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"logger.debug(""USER flags are supported by this mail server. Flagging message with '"" + SI_USER_FLAG + ""' user flag"");"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Flags siFlags = new Flags();"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"siFlags.add(SI_USER_FLAG);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"messages[i].setFlags(siFlags, true);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"logger.debug(""USER flags are not supported by this mail server. Flagging message with system flag"");"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"messages[i].setFlag(Flags.Flag.FLAGGED, true);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.setAdditionalFlags(message);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"logger.debug(""Fetched email with subject '"" + message.getSubject() + ""' will be discarded by the matching filter"" +"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,""" and will not be flagged as SEEN."");"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.setAdditionalFlags(messages[i]);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"catch (Exception e) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"exceptionToThrow = new org.springframework.integration.MessagingException(""Failed to set flags"", e);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (this.shouldDeleteMessages) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (messages != null) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.deleteMessages(messages);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"exceptionToThrow = new org.springframework.integration.MessagingException(""Failed to delete messages"", e);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Folder folder = context.getFolder();"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"MailTransportUtils.closeFolder(folder, this.shouldDeleteMessages);"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.contextHolder.remove();"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (exceptionToThrow != null) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"throw exceptionToThrow;"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"public void closeContextAfterFailure(MailReceiverContext context) {"
"94cc5a73e2910c231ff879e3390dc9f5c4bbe617","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"MailTransportUtils.closeFolder(context.getFolder(), false);"
"77fae8844a197459cc515f3fc198a1d2ae64f205","7ec2138ae8043612b35e3a9a9afbb7729b5c989c","added",0,"* Copyright 2002-2013 the original author or authors."
"77fae8844a197459cc515f3fc198a1d2ae64f205","7ec2138ae8043612b35e3a9a9afbb7729b5c989c","added",0,"* @author Artem Bilan"
"77fae8844a197459cc515f3fc198a1d2ae64f205","7ec2138ae8043612b35e3a9a9afbb7729b5c989c","added",0,"if (StringUtils.hasText(ref) && StringUtils.hasText(type)) {"
"77fae8844a197459cc515f3fc198a1d2ae64f205","7ec2138ae8043612b35e3a9a9afbb7729b5c989c","added",0,"parserContext.getReaderContext().error(""'type' and 'ref' attributes are mutually-exclusive, "" +"
"77fae8844a197459cc515f3fc198a1d2ae64f205","7ec2138ae8043612b35e3a9a9afbb7729b5c989c","added",0,"""but both have valid values; type: "" + type + ""; ref: "" + ref,"
"77fae8844a197459cc515f3fc198a1d2ae64f205","7ec2138ae8043612b35e3a9a9afbb7729b5c989c","added",0,"IntegrationNamespaceUtils.createElementDescription(element));"
"77fae8844a197459cc515f3fc198a1d2ae64f205","7ec2138ae8043612b35e3a9a9afbb7729b5c989c","added",0,"}"
"77fae8844a197459cc515f3fc198a1d2ae64f205","7ec2138ae8043612b35e3a9a9afbb7729b5c989c","added",0,"if (StringUtils.hasText(ref)) {"
"77fae8844a197459cc515f3fc198a1d2ae64f205","7ec2138ae8043612b35e3a9a9afbb7729b5c989c","added",0,"else if (StringUtils.hasText(type)) {"
"77fae8844a197459cc515f3fc198a1d2ae64f205","7ec2138ae8043612b35e3a9a9afbb7729b5c989c","added",0,"builder.getBeanDefinition().getConstructorArgumentValues().addGenericArgumentValue(type, ""java.lang.Class"");"
"77fae8844a197459cc515f3fc198a1d2ae64f205","7ec2138ae8043612b35e3a9a9afbb7729b5c989c","deleted",1,"* Copyright 2002-2010 the original author or authors."
"77fae8844a197459cc515f3fc198a1d2ae64f205","7ec2138ae8043612b35e3a9a9afbb7729b5c989c","deleted",1,"import org.springframework.util.Assert;"
"77fae8844a197459cc515f3fc198a1d2ae64f205","7ec2138ae8043612b35e3a9a9afbb7729b5c989c","deleted",1,"import org.springframework.util.ClassUtils;"
"77fae8844a197459cc515f3fc198a1d2ae64f205","7ec2138ae8043612b35e3a9a9afbb7729b5c989c","deleted",1,"Assert.isTrue(!(StringUtils.hasText(ref) && StringUtils.hasText(type)),"
"77fae8844a197459cc515f3fc198a1d2ae64f205","7ec2138ae8043612b35e3a9a9afbb7729b5c989c","deleted",1,"""'type' and 'ref' attributes are mutually-exclusive, but both have valid values; type: "" + type + ""; ref:"");"
"77fae8844a197459cc515f3fc198a1d2ae64f205","7ec2138ae8043612b35e3a9a9afbb7729b5c989c","deleted",1,"if (StringUtils.hasText(ref)){"
"77fae8844a197459cc515f3fc198a1d2ae64f205","7ec2138ae8043612b35e3a9a9afbb7729b5c989c","deleted",1,"} else if (StringUtils.hasText(type)){"
"77fae8844a197459cc515f3fc198a1d2ae64f205","7ec2138ae8043612b35e3a9a9afbb7729b5c989c","deleted",1,"ClassLoader classLoader = parserContext.getReaderContext().getBeanClassLoader();"
"77fae8844a197459cc515f3fc198a1d2ae64f205","7ec2138ae8043612b35e3a9a9afbb7729b5c989c","deleted",1,"if (classLoader == null) {"
"77fae8844a197459cc515f3fc198a1d2ae64f205","7ec2138ae8043612b35e3a9a9afbb7729b5c989c","deleted",1,"classLoader = this.getClass().getClassLoader();"
"77fae8844a197459cc515f3fc198a1d2ae64f205","7ec2138ae8043612b35e3a9a9afbb7729b5c989c","deleted",1,"}"
"77fae8844a197459cc515f3fc198a1d2ae64f205","7ec2138ae8043612b35e3a9a9afbb7729b5c989c","deleted",1,"Class<?> clazz = ClassUtils.resolveClassName(type, classLoader);"
"77fae8844a197459cc515f3fc198a1d2ae64f205","7ec2138ae8043612b35e3a9a9afbb7729b5c989c","deleted",1,"builder.getBeanDefinition().getConstructorArgumentValues().addGenericArgumentValue(clazz, ""java.lang.Class"");"
"70886b254371d07d7ad267f539348b201ff45faf","5db5f5fb7a73353b9ad01ac9ab5a575864da06a6","added",0,"* Copyright 2002-2013 the original author or authors."
"70886b254371d07d7ad267f539348b201ff45faf","5db5f5fb7a73353b9ad01ac9ab5a575864da06a6","added",0,"import org.springframework.integration.jmx.OperationInvokingMessageHandler;"
"70886b254371d07d7ad267f539348b201ff45faf","5db5f5fb7a73353b9ad01ac9ab5a575864da06a6","added",0,"* @author Artem Bilan"
"70886b254371d07d7ad267f539348b201ff45faf","5db5f5fb7a73353b9ad01ac9ab5a575864da06a6","added",0,"BeanDefinitionBuilder builder = BeanDefinitionBuilder.rootBeanDefinition(OperationInvokingMessageHandler.class);"
"70886b254371d07d7ad267f539348b201ff45faf","5db5f5fb7a73353b9ad01ac9ab5a575864da06a6","added",0,"IntegrationNamespaceUtils.setValueIfAttributeDefined(builder, element, ""requires-reply"");"
"70886b254371d07d7ad267f539348b201ff45faf","5db5f5fb7a73353b9ad01ac9ab5a575864da06a6","deleted",1,"* Copyright 2002-2010 the original author or authors."
"70886b254371d07d7ad267f539348b201ff45faf","5db5f5fb7a73353b9ad01ac9ab5a575864da06a6","deleted",1,"BeanDefinitionBuilder builder = BeanDefinitionBuilder.rootBeanDefinition("
"70886b254371d07d7ad267f539348b201ff45faf","5db5f5fb7a73353b9ad01ac9ab5a575864da06a6","deleted",1,"""org.springframework.integration.jmx.OperationInvokingMessageHandler"");"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"* @author Gary Russell"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"private final Map<String, Expression> globalHeaderExpressions;"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"this(method, headerExpressions, null);"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"}"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"public GatewayMethodInboundMessageMapper(Method method, Map<String, Expression> headerExpressions,"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"Map<String, Expression> globalHeaderExpressions) {"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"this.globalHeaderExpressions = globalHeaderExpressions;"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"// Explicit headers in XML override any @Header annotations..."
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"Map<String, Object> evaluatedHeaders = evaluateHeaders(methodInvocationEvaluationContext, this.headerExpressions);"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"// ...whereas global (default) headers do not..."
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"if (!CollectionUtils.isEmpty(this.globalHeaderExpressions)) {"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"Map<String, Object> evaluatedHeaders = evaluateHeaders(methodInvocationEvaluationContext, this.globalHeaderExpressions);"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"builder.copyHeadersIfAbsent(evaluatedHeaders);"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"private Map<String, Object> evaluateHeaders(EvaluationContext methodInvocationEvaluationContext, Map<String, Expression> headerExpressions) {"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"Map<String, Object> evaluatedHeaders = new HashMap<String, Object>();"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"for (Map.Entry<String, Expression> entry : headerExpressions.entrySet()) {"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"Object value = entry.getValue().getValue(methodInvocationEvaluationContext);"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"if (value != null) {"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"evaluatedHeaders.put(entry.getKey(), value);"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"return evaluatedHeaders;"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"// TODO deprecated in 3.0/4.0 - retained for backwards compatibility"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"context.setVariable(""gatewayMethod"", this.method);"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"Map<String, Object> evaluatedHeaders = new HashMap<String, Object>();"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"for (Map.Entry<String, Expression> entry : this.headerExpressions.entrySet()) {"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"Object value = entry.getValue().getValue(methodInvocationEvaluationContext);"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"if (value != null) {"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"evaluatedHeaders.put(entry.getKey(), value);"
"36795e5ee85ec5d9ae95d3dbd58a8b125492a0c4","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"}"
"5be8ef3fd8f258584220b5feb12f73e64f3b0244","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"* Copyright 2002-2013 the original author or authors."
"5be8ef3fd8f258584220b5feb12f73e64f3b0244","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"* Parser for the &lt;inbound-channel-adapter/&gt; element of the 'jms' namespace."
"5be8ef3fd8f258584220b5feb12f73e64f3b0244","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"*"
"5be8ef3fd8f258584220b5feb12f73e64f3b0244","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"return builder.getBeanDefinition();"
"5be8ef3fd8f258584220b5feb12f73e64f3b0244","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"* Copyright 2002-2010 the original author or authors."
"5be8ef3fd8f258584220b5feb12f73e64f3b0244","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"import org.springframework.beans.factory.config.BeanDefinition;"
"5be8ef3fd8f258584220b5feb12f73e64f3b0244","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"import org.springframework.beans.factory.parsing.BeanComponentDefinition;"
"5be8ef3fd8f258584220b5feb12f73e64f3b0244","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"import org.springframework.beans.factory.support.BeanDefinitionReaderUtils;"
"5be8ef3fd8f258584220b5feb12f73e64f3b0244","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"* Parser for the &lt;inbound-channel-adapter/&gt; element of the 'jms' namespace."
"5be8ef3fd8f258584220b5feb12f73e64f3b0244","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"*"
"5be8ef3fd8f258584220b5feb12f73e64f3b0244","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"BeanDefinition beanDefinition = builder.getBeanDefinition();"
"5be8ef3fd8f258584220b5feb12f73e64f3b0244","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"String beanName = BeanDefinitionReaderUtils.generateBeanName(beanDefinition, parserContext.getRegistry());"
"5be8ef3fd8f258584220b5feb12f73e64f3b0244","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"return new BeanComponentDefinition(beanDefinition, beanName);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"import java.util.LinkedList;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"import org.springframework.util.CollectionUtils;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"* @author Artem Bilan"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private static final String CANDIDATE_METHODS = ""CANDIDATE_METHODS"";"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private static final String CANDIDATE_MESSAGE_METHODS = ""CANDIDATE_MESSAGE_METHODS"";"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private final Map<Class<?>, HandlerMethod> handlerMessageMethods;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private final LinkedList<Map<Class<?>, HandlerMethod>> handlerMethodsList;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private final HandlerMethod handlerMethod;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.handlerMethod =  new HandlerMethod(method, canProcessMessageList);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.handlerMethods = null;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.handlerMessageMethods = null;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.handlerMethodsList = null;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Map<String, Map<Class<?>, HandlerMethod>> handlerMethodsForTarget ="
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.findHandlerMethodsForTarget(targetObject, annotationType, methodName, requiresReply);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Map<Class<?>, HandlerMethod> handlerMethods = handlerMethodsForTarget.get(CANDIDATE_METHODS);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Map<Class<?>, HandlerMethod> handlerMessageMethods = handlerMethodsForTarget.get(CANDIDATE_MESSAGE_METHODS);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if ((handlerMethods.size() == 1 && handlerMessageMethods.isEmpty()) ||"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"(handlerMessageMethods.size() == 1 && handlerMethods.isEmpty())) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (handlerMethods.size() == 1) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.handlerMethod = handlerMethods.values().iterator().next();"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"}"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"else {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.handlerMethod = handlerMessageMethods.values().iterator().next();"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.handlerMethod = null;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.handlerMethods = handlerMethods;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.handlerMessageMethods = handlerMessageMethods;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.handlerMethodsList = new LinkedList<Map<Class<?>, HandlerMethod>>();"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"//TODO Consider to use global option to determine a precedence of methods"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.handlerMethodsList.add(this.handlerMethods);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.handlerMethodsList.add(this.handlerMessageMethods);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"sb.append(""."" + targetMethod);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Assert.state(context.getTypeConverter().canConvert(TypeDescriptor.valueOf(((Method) method).getReturnType()),"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"TypeDescriptor.valueOf(expectedType)),"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"HandlerMethod candidate = this.findHandlerMethodForParameters(parameters);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Assert.notNull(candidate, ""No candidate methods found for messages."");"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Expression expression = candidate.getExpression();"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Class<?> expectedType = this.expectedType != null ? this.expectedType : candidate.method.getReturnType();"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"try {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"@SuppressWarnings(""unchecked"")"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"T result = (T) this.evaluateExpression(expression, parameters, expectedType);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (this.requiresReply) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Assert.notNull(result,"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"""Expression evaluation result was null, but this processor requires a reply."");"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"return result;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"catch (Exception e) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Throwable evaluationException = e;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if ((e instanceof EvaluationException || e instanceof MessageHandlingException) && e.getCause() != null) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"evaluationException = e.getCause();"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (evaluationException instanceof Exception) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"throw (Exception) evaluationException;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"throw new IllegalStateException(""Cannot process message"", evaluationException);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private Map<String, Map<Class<?>, HandlerMethod>> findHandlerMethodsForTarget(final Object targetObject,"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Map<String, Map<Class<?>, HandlerMethod>> handlerMethods = new HashMap<String, Map<Class<?>, HandlerMethod>>();"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"final Map<Class<?>, HandlerMethod> candidateMessageMethods = new HashMap<Class<?>, HandlerMethod>();"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"final Map<Class<?>, HandlerMethod> fallbackMessageMethods = new HashMap<Class<?>, HandlerMethod>();"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"final AtomicReference<Class<?>> ambiguousFallbackMessageGenericType = new AtomicReference<Class<?>>();"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"@Override"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Class<?> targetParameterType = handlerMethod.getTargetParameterType();"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (handlerMethod.isMessageMethod()) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (candidateMessageMethods.containsKey(targetParameterType)) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"throw new IllegalArgumentException(""Found more than one method match for type "" +"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"""[Message<"" + targetParameterType + "">]"");"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"candidateMessageMethods.put(targetParameterType, handlerMethod);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (candidateMethods.containsKey(targetParameterType)) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"String exceptionMessage = ""Found more than one method match for "";"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (Void.class.equals(targetParameterType)) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"exceptionMessage += ""empty parameter for 'payload'"";"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"exceptionMessage += ""type ["" + targetParameterType + ""]"";"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"throw new IllegalArgumentException(exceptionMessage);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"candidateMethods.put(targetParameterType, handlerMethod);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (fallbackMessageMethods.containsKey(targetParameterType)) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"// we need to check for duplicate type matches,"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"// but only if we end up falling back"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"// and we'll only keep track of the first one"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"ambiguousFallbackMessageGenericType.compareAndSet(null, targetParameterType);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"fallbackMessageMethods.put(targetParameterType, handlerMethod);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (fallbackMethods.containsKey(targetParameterType)) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"ambiguousFallbackType.compareAndSet(null, targetParameterType);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"fallbackMethods.put(targetParameterType, handlerMethod);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (!candidateMethods.isEmpty() || !candidateMessageMethods.isEmpty()) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"handlerMethods.put(CANDIDATE_METHODS, candidateMethods);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"handlerMethods.put(CANDIDATE_MESSAGE_METHODS, candidateMessageMethods);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"return handlerMethods;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if ((ambiguousFallbackType.get() != null"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"||"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"&& ServiceActivator.class.equals(annotationType)) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"/*"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"* When there are ambiguous fallback methods,"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"* a Service Activator can finally fallback to RequestReplyExchanger.exchange(m)."
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"* Ambiguous means > 1 method that takes the same payload type, or > 1 method"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"* that takes a Message with the same generic type."
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"*/"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (logger.isDebugEnabled()) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"logger.debug(targetObject.getClass() + "": Ambiguous fallback methods; using RequestReplyExchanger.exchange()"");"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"handlerMethods.put(CANDIDATE_METHODS, Collections.<Class<?>, HandlerMethod>singletonMap(Object.class, handlerMethod));"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Assert.state(!fallbackMethods.isEmpty() || !fallbackMessageMethods.isEmpty(),"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"""Target object of type ["" + this.targetObject.getClass() + ""] has no eligible methods for handling Messages."");"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"//TODO backward compatibility"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"throw  new IllegalArgumentException(e.getMessage());"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Assert.isNull(ambiguousFallbackMessageGenericType.get(),"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"""Found ambiguous parameter type ["" + ambiguousFallbackMessageGenericType + ""] for method match: """
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"+ fallbackMethods.values());"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"handlerMethods.put(CANDIDATE_METHODS, fallbackMethods);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"handlerMethods.put(CANDIDATE_MESSAGE_METHODS, fallbackMessageMethods);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private HandlerMethod findHandlerMethodForParameters(ParametersWrapper parameters) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (this.handlerMethod != null) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"return this.handlerMethod;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"return closestMatch;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (Iterable.class.isAssignableFrom(payloadType) && this.handlerMethods.containsKey(Iterator.class)) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"return this.handlerMethods.get(Iterator.class);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"return this.handlerMethods.get(Void.class);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"for (Map<Class<?>, HandlerMethod> handlerMethods : handlerMethodsList) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Set<Class<?>> candidates = handlerMethods.keySet();"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Class<?> match = null;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (!CollectionUtils.isEmpty(candidates)) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"match = ClassUtils.findClosestMatch(payloadType, candidates, true);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (match != null) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"return handlerMethods.get(match);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"return null;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private volatile TypeDescriptor targetParameterTypeDescriptor;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private volatile Class<?> targetParameterType = Void.class;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private volatile boolean messageMethod;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Class<?> getTargetParameterType() {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private boolean isMessageMethod() {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"return messageMethod;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"MethodParameter methodParameter = new MethodParameter(method, i);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"TypeDescriptor parameterTypeDescriptor = new TypeDescriptor(methodParameter);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.setExclusiveTargetParameterType(parameterTypeDescriptor, methodParameter);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"sb.append(this.determineHeaderExpression(headerAnnotation, methodParameter));"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.messageMethod = true;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Type type =  method.getGenericParameterTypes()[i];"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (parameterizedType != null && Message.class.isAssignableFrom((Class<?>) parameterizedType)){"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (targetParameterType != null && Map.class.isAssignableFrom(this.targetParameterType)) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (this.targetParameterTypeDescriptor == null) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.targetParameterTypeDescriptor = TypeDescriptor.valueOf(Void.class);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private synchronized void setExclusiveTargetParameterType(TypeDescriptor targetParameterType, MethodParameter methodParameter) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Assert.isNull(this.targetParameterTypeDescriptor, ""Found more than one parameter type candidate: ["""
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"+ this.targetParameterTypeDescriptor + ""] and ["" + targetParameterType + ""]"");"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.targetParameterTypeDescriptor = targetParameterType;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (Message.class.isAssignableFrom(targetParameterType.getObjectType())) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"methodParameter.increaseNestingLevel();"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.targetParameterType = methodParameter.getNestedParameterType();"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"methodParameter.decreaseNestingLevel();"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.targetParameterType = targetParameterType.getObjectType();"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"public class ParametersWrapper {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"return this.messages.getClass();"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"HandlerMethod handlerMethod = new HandlerMethod(method, canProcessMessageList);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"this.handlerMethods = Collections.<Class<?>, HandlerMethod> singletonMap(handlerMethod.getTargetParameterType()"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,".getObjectType(), handlerMethod);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"this.handlerMethods = this.findHandlerMethodsForTarget(targetObject, annotationType, methodName, requiresReply);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"sb.append(""."" + (String) targetMethod);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Assert.state(context.getTypeConverter().canConvert(TypeDescriptor.valueOf(((Method) method).getReturnType()), TypeDescriptor.valueOf(expectedType)),"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Throwable evaluationException = null;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"List<HandlerMethod> candidates = this.findHandlerMethodsForParameters(parameters);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Assert.state(!candidates.isEmpty(), ""No candidate methods found for messages."");"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"for (HandlerMethod candidate : candidates) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"try {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Expression expression = candidate.getExpression();"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Class<?> expectedType = this.expectedType != null ? this.expectedType : candidate.method.getReturnType();"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"@SuppressWarnings(""unchecked"")"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"T result = (T) this.evaluateExpression(expression, parameters, expectedType);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (this.requiresReply) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Assert.notNull(result,"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"""Expression evaluation result was null, but this processor requires a reply."");"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"}"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"return result;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"// keep the first exception"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"catch (EvaluationException e) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (evaluationException == null) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"evaluationException = e.getCause();"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"evaluationException = e;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"catch (MessageHandlingException e) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"catch (Exception e) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (evaluationException instanceof Exception) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"throw (Exception) evaluationException;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"else if (evaluationException instanceof Error) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"throw (Error) evaluationException;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"else {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"throw new IllegalStateException(""Cannot process message"", evaluationException);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"private Map<Class<?>, HandlerMethod> findHandlerMethodsForTarget(final Object targetObject,"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Class<?> targetParameterType = handlerMethod.getTargetParameterType().getObjectType();"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Assert.isTrue(!candidateMethods.containsKey(targetParameterType),"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"""Found more than one method match for type ["" + targetParameterType + ""]"");"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"candidateMethods.put(targetParameterType, handlerMethod);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (fallbackMethods.containsKey(targetParameterType)) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"// we need to check for duplicate type matches,"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"// but only if we end up falling back"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"// and we'll only keep track of the first one"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"ambiguousFallbackType.compareAndSet(null, targetParameterType);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"fallbackMethods.put(targetParameterType, handlerMethod);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (!candidateMethods.isEmpty()) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"return candidateMethods;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if ((fallbackMethods.isEmpty() || ambiguousFallbackType.get() != null) && ServiceActivator.class.equals(annotationType)) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"// a Service Activator can fallback to either MessageHandler.handleMessage(m) or RequestReplyExchanger.exchange(m)"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"else if (""org.springframework.integration.core.MessageHandler"".equals(iface.getName()) && !requiresReply) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"frameworkMethods.add(targetClass.getMethod(""handleMessage"", Message.class));"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"return Collections.<Class<?>, HandlerMethod>singletonMap(Object.class, handlerMethod);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Assert.notEmpty(fallbackMethods, ""Target object of type ["" + this.targetObject.getClass()"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"+ ""] has no eligible methods for handling Messages."");"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"return fallbackMethods;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"private List<HandlerMethod> findHandlerMethodsForParameters(ParametersWrapper parameters) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"return Collections.singletonList(closestMatch);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"return new ArrayList<HandlerMethod>(this.handlerMethods.values());"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Set<Class<?>> candidates = this.handlerMethods.keySet();"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Class<?> match = null;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (candidates != null && !candidates.isEmpty()) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"match = ClassUtils.findClosestMatch(payloadType, candidates, true);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"return (match != null) ? this.handlerMethods.get(match) : null;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"private volatile TypeDescriptor targetParameterType;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"TypeDescriptor getTargetParameterType() {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"TypeDescriptor defaultParameterTypeDescriptor = TypeDescriptor.valueOf(List.class);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"TypeDescriptor parameterTypeDescriptor = new TypeDescriptor(new MethodParameter(method, i));"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"defaultParameterTypeDescriptor = parameterTypeDescriptor;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"this.setExclusiveTargetParameterType(parameterTypeDescriptor);"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"sb.append(this.determineHeaderExpression(headerAnnotation, new MethodParameter(method, i)));"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Type type =  method.getGenericParameterTypes()[0];"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (parameterizedType != null && Message.class.isAssignableFrom((Class<?>)parameterizedType)){"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (targetParameterType != null && Map.class.isAssignableFrom(this.targetParameterType.getObjectType())) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (this.targetParameterType == null) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"this.targetParameterType = defaultParameterTypeDescriptor;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"private synchronized void setExclusiveTargetParameterType(TypeDescriptor targetParameterType) {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Assert.isNull(this.targetParameterType, ""Found more than one parameter type candidate: ["""
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"+ this.targetParameterType + ""] and ["" + targetParameterType + ""]"");"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"this.targetParameterType = targetParameterType;"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"@SuppressWarnings(""unused"")"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"private static class ParametersWrapper {"
"945cb14407525834065d692592541f2dda74fe51","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"return Collection.class;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import java.util.LinkedList;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import org.springframework.util.CollectionUtils;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"* @author Artem Bilan"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private static final String CANDIDATE_METHODS = ""CANDIDATE_METHODS"";"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private static final String CANDIDATE_MESSAGE_METHODS = ""CANDIDATE_MESSAGE_METHODS"";"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private final Map<Class<?>, HandlerMethod> handlerMessageMethods;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private final LinkedList<Map<Class<?>, HandlerMethod>> handlerMethodsList;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private final HandlerMethod handlerMethod;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMethod =  new HandlerMethod(method, canProcessMessageList);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMethods = null;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMessageMethods = null;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMethodsList = null;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Map<String, Map<Class<?>, HandlerMethod>> handlerMethodsForTarget ="
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.findHandlerMethodsForTarget(targetObject, annotationType, methodName, requiresReply);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Map<Class<?>, HandlerMethod> handlerMethods = handlerMethodsForTarget.get(CANDIDATE_METHODS);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Map<Class<?>, HandlerMethod> handlerMessageMethods = handlerMethodsForTarget.get(CANDIDATE_MESSAGE_METHODS);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if ((handlerMethods.size() == 1 && handlerMessageMethods.isEmpty()) ||"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"(handlerMessageMethods.size() == 1 && handlerMethods.isEmpty())) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (handlerMethods.size() == 1) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMethod = handlerMethods.values().iterator().next();"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"}"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"else {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMethod = handlerMessageMethods.values().iterator().next();"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMethod = null;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMethods = handlerMethods;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMessageMethods = handlerMessageMethods;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMethodsList = new LinkedList<Map<Class<?>, HandlerMethod>>();"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"//TODO Consider to use global option to determine a precedence of methods"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMethodsList.add(this.handlerMethods);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMethodsList.add(this.handlerMessageMethods);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"sb.append(""."" + targetMethod);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Assert.state(context.getTypeConverter().canConvert(TypeDescriptor.valueOf(((Method) method).getReturnType()),"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"TypeDescriptor.valueOf(expectedType)),"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"HandlerMethod candidate = this.findHandlerMethodForParameters(parameters);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Assert.notNull(candidate, ""No candidate methods found for messages."");"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Expression expression = candidate.getExpression();"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Class<?> expectedType = this.expectedType != null ? this.expectedType : candidate.method.getReturnType();"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"try {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"@SuppressWarnings(""unchecked"")"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"T result = (T) this.evaluateExpression(expression, parameters, expectedType);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (this.requiresReply) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Assert.notNull(result,"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""Expression evaluation result was null, but this processor requires a reply."");"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return result;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"catch (Exception e) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Throwable evaluationException = e;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if ((e instanceof EvaluationException || e instanceof MessageHandlingException) && e.getCause() != null) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"evaluationException = e.getCause();"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (evaluationException instanceof Exception) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"throw (Exception) evaluationException;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"throw new IllegalStateException(""Cannot process message"", evaluationException);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private Map<String, Map<Class<?>, HandlerMethod>> findHandlerMethodsForTarget(final Object targetObject,"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Map<String, Map<Class<?>, HandlerMethod>> handlerMethods = new HashMap<String, Map<Class<?>, HandlerMethod>>();"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"final Map<Class<?>, HandlerMethod> candidateMessageMethods = new HashMap<Class<?>, HandlerMethod>();"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"final Map<Class<?>, HandlerMethod> fallbackMessageMethods = new HashMap<Class<?>, HandlerMethod>();"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"final AtomicReference<Class<?>> ambiguousFallbackMessageGenericType = new AtomicReference<Class<?>>();"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"@Override"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Class<?> targetParameterType = handlerMethod.getTargetParameterType();"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (handlerMethod.isMessageMethod()) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (candidateMessageMethods.containsKey(targetParameterType)) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"throw new IllegalArgumentException(""Found more than one method match for type "" +"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""[Message<"" + targetParameterType + "">]"");"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"candidateMessageMethods.put(targetParameterType, handlerMethod);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (candidateMethods.containsKey(targetParameterType)) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"String exceptionMessage = ""Found more than one method match for "";"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (Void.class.equals(targetParameterType)) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"exceptionMessage += ""empty parameter for 'payload'"";"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"exceptionMessage += ""type ["" + targetParameterType + ""]"";"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"throw new IllegalArgumentException(exceptionMessage);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"candidateMethods.put(targetParameterType, handlerMethod);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (fallbackMessageMethods.containsKey(targetParameterType)) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"// we need to check for duplicate type matches,"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"// but only if we end up falling back"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"// and we'll only keep track of the first one"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"ambiguousFallbackMessageGenericType.compareAndSet(null, targetParameterType);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"fallbackMessageMethods.put(targetParameterType, handlerMethod);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (fallbackMethods.containsKey(targetParameterType)) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"ambiguousFallbackType.compareAndSet(null, targetParameterType);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"fallbackMethods.put(targetParameterType, handlerMethod);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (!candidateMethods.isEmpty() || !candidateMessageMethods.isEmpty()) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"handlerMethods.put(CANDIDATE_METHODS, candidateMethods);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"handlerMethods.put(CANDIDATE_MESSAGE_METHODS, candidateMessageMethods);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return handlerMethods;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if ((ambiguousFallbackType.get() != null"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"||"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"&& ServiceActivator.class.equals(annotationType)) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"/*"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"* When there are ambiguous fallback methods,"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"* a Service Activator can finally fallback to RequestReplyExchanger.exchange(m)."
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"* Ambiguous means > 1 method that takes the same payload type, or > 1 method"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"* that takes a Message with the same generic type."
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"*/"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (logger.isDebugEnabled()) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"logger.debug(targetObject.getClass() + "": Ambiguous fallback methods; using RequestReplyExchanger.exchange()"");"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"handlerMethods.put(CANDIDATE_METHODS, Collections.<Class<?>, HandlerMethod>singletonMap(Object.class, handlerMethod));"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Assert.state(!fallbackMethods.isEmpty() || !fallbackMessageMethods.isEmpty(),"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""Target object of type ["" + this.targetObject.getClass() + ""] has no eligible methods for handling Messages."");"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"//TODO backward compatibility"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"throw  new IllegalArgumentException(e.getMessage());"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Assert.isNull(ambiguousFallbackMessageGenericType.get(),"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""Found ambiguous parameter type ["" + ambiguousFallbackMessageGenericType + ""] for method match: """
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"+ fallbackMethods.values());"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"handlerMethods.put(CANDIDATE_METHODS, fallbackMethods);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"handlerMethods.put(CANDIDATE_MESSAGE_METHODS, fallbackMessageMethods);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private HandlerMethod findHandlerMethodForParameters(ParametersWrapper parameters) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (this.handlerMethod != null) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return this.handlerMethod;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return closestMatch;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (Iterable.class.isAssignableFrom(payloadType) && this.handlerMethods.containsKey(Iterator.class)) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return this.handlerMethods.get(Iterator.class);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return this.handlerMethods.get(Void.class);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"for (Map<Class<?>, HandlerMethod> handlerMethods : handlerMethodsList) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Set<Class<?>> candidates = handlerMethods.keySet();"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Class<?> match = null;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (!CollectionUtils.isEmpty(candidates)) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"match = ClassUtils.findClosestMatch(payloadType, candidates, true);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (match != null) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return handlerMethods.get(match);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return null;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private volatile TypeDescriptor targetParameterTypeDescriptor;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private volatile Class<?> targetParameterType = Void.class;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private volatile boolean messageMethod;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Class<?> getTargetParameterType() {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private boolean isMessageMethod() {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return messageMethod;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"MethodParameter methodParameter = new MethodParameter(method, i);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"TypeDescriptor parameterTypeDescriptor = new TypeDescriptor(methodParameter);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.setExclusiveTargetParameterType(parameterTypeDescriptor, methodParameter);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"sb.append(this.determineHeaderExpression(headerAnnotation, methodParameter));"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.messageMethod = true;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Type type =  method.getGenericParameterTypes()[i];"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (parameterizedType != null && Message.class.isAssignableFrom((Class<?>) parameterizedType)){"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (targetParameterType != null && Map.class.isAssignableFrom(this.targetParameterType)) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (this.targetParameterTypeDescriptor == null) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.targetParameterTypeDescriptor = TypeDescriptor.valueOf(Void.class);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private synchronized void setExclusiveTargetParameterType(TypeDescriptor targetParameterType, MethodParameter methodParameter) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Assert.isNull(this.targetParameterTypeDescriptor, ""Found more than one parameter type candidate: ["""
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"+ this.targetParameterTypeDescriptor + ""] and ["" + targetParameterType + ""]"");"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.targetParameterTypeDescriptor = targetParameterType;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (Message.class.isAssignableFrom(targetParameterType.getObjectType())) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"methodParameter.increaseNestingLevel();"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.targetParameterType = methodParameter.getNestedParameterType();"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"methodParameter.decreaseNestingLevel();"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.targetParameterType = targetParameterType.getObjectType();"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public class ParametersWrapper {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return this.messages.getClass();"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"HandlerMethod handlerMethod = new HandlerMethod(method, canProcessMessageList);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.handlerMethods = Collections.<Class<?>, HandlerMethod> singletonMap(handlerMethod.getTargetParameterType()"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".getObjectType(), handlerMethod);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.handlerMethods = this.findHandlerMethodsForTarget(targetObject, annotationType, methodName, requiresReply);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"sb.append(""."" + (String) targetMethod);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.state(context.getTypeConverter().canConvert(TypeDescriptor.valueOf(((Method) method).getReturnType()), TypeDescriptor.valueOf(expectedType)),"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Throwable evaluationException = null;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"List<HandlerMethod> candidates = this.findHandlerMethodsForParameters(parameters);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.state(!candidates.isEmpty(), ""No candidate methods found for messages."");"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"for (HandlerMethod candidate : candidates) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"try {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Expression expression = candidate.getExpression();"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Class<?> expectedType = this.expectedType != null ? this.expectedType : candidate.method.getReturnType();"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"@SuppressWarnings(""unchecked"")"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"T result = (T) this.evaluateExpression(expression, parameters, expectedType);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (this.requiresReply) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.notNull(result,"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""Expression evaluation result was null, but this processor requires a reply."");"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"}"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return result;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"// keep the first exception"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"catch (EvaluationException e) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (evaluationException == null) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"evaluationException = e.getCause();"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"evaluationException = e;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"catch (MessageHandlingException e) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"catch (Exception e) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (evaluationException instanceof Exception) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"throw (Exception) evaluationException;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"else if (evaluationException instanceof Error) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"throw (Error) evaluationException;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"else {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"throw new IllegalStateException(""Cannot process message"", evaluationException);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private Map<Class<?>, HandlerMethod> findHandlerMethodsForTarget(final Object targetObject,"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Class<?> targetParameterType = handlerMethod.getTargetParameterType().getObjectType();"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.isTrue(!candidateMethods.containsKey(targetParameterType),"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""Found more than one method match for type ["" + targetParameterType + ""]"");"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"candidateMethods.put(targetParameterType, handlerMethod);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (fallbackMethods.containsKey(targetParameterType)) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"// we need to check for duplicate type matches,"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"// but only if we end up falling back"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"// and we'll only keep track of the first one"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"ambiguousFallbackType.compareAndSet(null, targetParameterType);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"fallbackMethods.put(targetParameterType, handlerMethod);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (!candidateMethods.isEmpty()) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return candidateMethods;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if ((fallbackMethods.isEmpty() || ambiguousFallbackType.get() != null) && ServiceActivator.class.equals(annotationType)) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"// a Service Activator can fallback to either MessageHandler.handleMessage(m) or RequestReplyExchanger.exchange(m)"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"else if (""org.springframework.integration.core.MessageHandler"".equals(iface.getName()) && !requiresReply) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"frameworkMethods.add(targetClass.getMethod(""handleMessage"", Message.class));"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return Collections.<Class<?>, HandlerMethod>singletonMap(Object.class, handlerMethod);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.notEmpty(fallbackMethods, ""Target object of type ["" + this.targetObject.getClass()"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"+ ""] has no eligible methods for handling Messages."");"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return fallbackMethods;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private List<HandlerMethod> findHandlerMethodsForParameters(ParametersWrapper parameters) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return Collections.singletonList(closestMatch);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return new ArrayList<HandlerMethod>(this.handlerMethods.values());"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Set<Class<?>> candidates = this.handlerMethods.keySet();"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Class<?> match = null;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (candidates != null && !candidates.isEmpty()) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"match = ClassUtils.findClosestMatch(payloadType, candidates, true);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return (match != null) ? this.handlerMethods.get(match) : null;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private volatile TypeDescriptor targetParameterType;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"TypeDescriptor getTargetParameterType() {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"TypeDescriptor defaultParameterTypeDescriptor = TypeDescriptor.valueOf(List.class);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"TypeDescriptor parameterTypeDescriptor = new TypeDescriptor(new MethodParameter(method, i));"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"defaultParameterTypeDescriptor = parameterTypeDescriptor;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.setExclusiveTargetParameterType(parameterTypeDescriptor);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"sb.append(this.determineHeaderExpression(headerAnnotation, new MethodParameter(method, i)));"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Type type =  method.getGenericParameterTypes()[0];"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (parameterizedType != null && Message.class.isAssignableFrom((Class<?>)parameterizedType)){"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (targetParameterType != null && Map.class.isAssignableFrom(this.targetParameterType.getObjectType())) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (this.targetParameterType == null) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.targetParameterType = defaultParameterTypeDescriptor;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private synchronized void setExclusiveTargetParameterType(TypeDescriptor targetParameterType) {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.isNull(this.targetParameterType, ""Found more than one parameter type candidate: ["""
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"+ this.targetParameterType + ""] and ["" + targetParameterType + ""]"");"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.targetParameterType = targetParameterType;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"@SuppressWarnings(""unused"")"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private static class ParametersWrapper {"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return Collection.class;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"@Test"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"MessageGroupProcessor processor = new MethodInvokingMessageGroupProcessor(new AnnotatedParametersAggregator());"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"when(messageGroupMock.getMessages()).thenReturn(messagesUpForProcessing);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Object result = processor.processMessageGroup(messageGroupMock);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Object payload = ((Message<?>) result).getPayload();"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertTrue(payload instanceof Integer);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertEquals(7, payload);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"@Test(expected = IllegalArgumentException.class)"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"@SuppressWarnings(""unused"")"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"new MethodInvokingMessageGroupProcessor(new AnnotatedParametersAggregator());"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import static org.hamcrest.CoreMatchers.instanceOf;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import static org.hamcrest.CoreMatchers.is;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import static org.junit.Assert.assertEquals;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import static org.junit.Assert.assertNull;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import static org.junit.Assert.assertSame;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import static org.junit.Assert.assertThat;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import static org.junit.Assert.assertTrue;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Object handlerMethods =  new DirectFieldAccessor(new DirectFieldAccessor(new DirectFieldAccessor(accessor"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertNull(handlerMethods);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Object handlerMethod =  new DirectFieldAccessor(new DirectFieldAccessor(new DirectFieldAccessor(accessor"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".getPropertyValue(""outputProcessor"")).getPropertyValue(""processor"")).getPropertyValue(""delegate""))"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".getPropertyValue(""handlerMethod"");"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertTrue(handlerMethod.toString().contains(""createSingleMessageFromGroup""));"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Object handlerMethods = releaseStrategyAccessor.getPropertyValue(""handlerMethods"");"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Object handlerMethod = releaseStrategyAccessor.getPropertyValue(""handlerMethod"");"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertTrue(handlerMethod.toString().contains(""checkCompleteness""));"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import java.util.Map;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import static org.hamcrest.CoreMatchers.is;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import static org.hamcrest.CoreMatchers.instanceOf;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import static org.junit.Assert.assertEquals;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import static org.junit.Assert.assertSame;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import static org.junit.Assert.assertThat;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import static org.junit.Assert.assertTrue;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Map<?, ?> map = (Map<?, ?>) new DirectFieldAccessor(new DirectFieldAccessor(new DirectFieldAccessor(accessor"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"assertEquals(""The MethodInvokingAggregator is not injected with the appropriate aggregation method"", 1, map"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".size());"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"assertEquals(""The release strategy is not injected with the appropriate method"", 1, map.size());"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"assertTrue(""Handler methods do not contain correct method: "" + map, map.toString().contains("
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""createSingleMessageFromGroup""));"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Map<?, ?> map = (Map<?, ?>) releaseStrategyAccessor.getPropertyValue(""handlerMethods"");"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"assertTrue(""Handler methods do not contain correct method: "" + map, map.toString()"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".contains(""checkCompleteness""));"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"* Copyright 2002-2013 the original author or authors."
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import static org.junit.Assert.assertEquals;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import static org.junit.Assert.assertNotNull;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import static org.junit.Assert.assertNull;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import static org.junit.Assert.assertSame;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import static org.junit.Assert.assertTrue;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import static org.springframework.integration.test.util.TestUtils.getPropertyValue;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"* @author Artem Bilan"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Object handlerMethods = new DirectFieldAccessor(new DirectFieldAccessor(new DirectFieldAccessor(releaseStrategyAdapter)"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertNull(handlerMethods);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Object handlerMethod = new DirectFieldAccessor(new DirectFieldAccessor(new DirectFieldAccessor(releaseStrategyAdapter)"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".getPropertyValue(""adapter"")).getPropertyValue(""delegate"")).getPropertyValue(""handlerMethod"");"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertTrue(handlerMethod.toString().contains(""completionChecker""));"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertNull(processorAccessor.getPropertyValue(""handlerMethods""));"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Object handlerMethod = processorAccessor.getPropertyValue(""handlerMethod"");"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertNotNull(handlerMethod);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"DirectFieldAccessor handlerMethodAccessor = new DirectFieldAccessor(handlerMethod);"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"* Copyright 2002-2010 the original author or authors."
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import java.util.Map;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import static org.junit.Assert.assertEquals;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import static org.junit.Assert.assertNull;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import static org.junit.Assert.assertSame;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import static org.junit.Assert.assertTrue;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import static org.springframework.integration.test.util.TestUtils.getPropertyValue;"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Map<?, ?> map = (Map<?, ?>) new DirectFieldAccessor(new DirectFieldAccessor(new DirectFieldAccessor(releaseStrategyAdapter)"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"assertEquals(""The MethodInvokingAggregator is not injected with the appropriate aggregation method"", 1, map"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".size());"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"assertEquals(""The release strategy is not injected with the appropriate method"", 1, map.size());"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"assertTrue(""Handler methods do not contain correct method: "" + map, map.toString()"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".contains(""completionChecker""));"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Map<?, ?> handlerMethods = (Map<?, ?>) processorAccessor.getPropertyValue(""handlerMethods"");"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"assertEquals(1, handlerMethods.size());"
"945cb14407525834065d692592541f2dda74fe51","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"DirectFieldAccessor handlerMethodAccessor = new DirectFieldAccessor(handlerMethods.values().iterator().next());"
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"if (queueElement != null && dispatcherElement != null) {"
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"""The 'dispatcher' sub-element and any queue sub-element are mutually exclusive."", element);"
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"if (dispatcherElement == null) {"
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"// check for the dispatcher attribute (deprecated)"
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"String dispatcherAttribute = element.getAttribute(""dispatcher"");"
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"boolean hasDispatcherAttribute = StringUtils.hasText(dispatcherAttribute);"
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"if (hasDispatcherAttribute && logger.isWarnEnabled()) {"
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"logger.warn(""The 'dispatcher' attribute on the 'channel' element is deprecated. """
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"+ ""Please use the 'dispatcher' sub-element instead."");"
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"}"
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"if (queueElement != null && (dispatcherElement != null || hasDispatcherAttribute)) {"
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"""The 'dispatcher' attribute or sub-element "" + ""and any queue sub-element are mutually exclusive."","
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"element);"
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"if (dispatcherElement != null && hasDispatcherAttribute) {"
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"parserContext.getReaderContext().error("
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"""The 'dispatcher' attribute and 'dispatcher' """
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"+ ""sub-element are mutually exclusive. NOTE: the attribute is DEPRECATED. """
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"+ ""Please use the dispatcher sub-element instead."", element);"
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"return null;"
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"if (hasDispatcherAttribute) {"
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"// this attribute is deprecated, but if set, we need to create a DirectChannel"
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"// without any LoadBalancerStrategy and the failover flag set to true (default)."
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"builder = BeanDefinitionBuilder.genericBeanDefinition(DirectChannel.class);"
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"if (""failover"".equals(dispatcherAttribute)) {"
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"// round-robin dispatcher is used by default, the ""failover"" value simply disables it"
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"builder.addConstructorArgValue(null);"
"c2004f1ab31ed7eabcbf991b38165c89d703654b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"else if (dispatcherElement == null) {"
"c2004f1ab31ed7eabcbf991b38165c89d703654b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"MessageChannel channel = (MessageChannel) context.getBean(""channelWithFailover"");"
"c2004f1ab31ed7eabcbf991b38165c89d703654b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"MessageChannel channel = (MessageChannel) context.getBean(""channelWithFailoverAttribute"");"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import org.springframework.core.GenericTypeResolver;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"protected final Class<T> annotationType;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"@SuppressWarnings(""unchecked"")"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.annotationType = (Class<T>) GenericTypeResolver.resolveTypeArgument(this.getClass(),"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"MethodAnnotationPostProcessor.class);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"public Object postProcess(Object bean, String beanName, Method method, List<Annotation> annotations) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"MessageHandler handler = this.createHandler(bean, method, annotations);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.setAdviceChainIfPresent(beanName, annotations, handler);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"String handlerBeanName = this.generateHandlerBeanName(beanName, method);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"AbstractEndpoint endpoint = this.createEndpoint(handler, annotations);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"protected final void setAdviceChainIfPresent(String beanName, List<Annotation> annotations, MessageHandler handler) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"String[] adviceChainNames = MessagingAnnotationUtils.resolveAttribute(annotations, ADVICE_CHAIN_ATTRIBUTE,"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"String[].class);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"/*"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* Note: we don't merge advice chain contents; if the directAnnotation has a non-empty"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* attribute, it wins. You cannot ""remove"" an advice chain from a meta-annotation"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* by setting an empty array on the custom annotation."
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"*/"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"private AbstractEndpoint createEndpoint(MessageHandler handler, List<Annotation> annotations) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"String inputChannelName = MessagingAnnotationUtils.resolveAttribute(annotations, INPUT_CHANNEL_ATTRIBUTE,"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"String.class);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.configurePollingEndpoint(pollingConsumer, annotations);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"Poller[] pollers = MessagingAnnotationUtils.resolveAttribute(annotations, ""poller"", Poller[].class);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"Assert.state(ObjectUtils.isEmpty(pollers), ""A '@Poller' should not be specified for Annotation-based "" +"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"""endpoint, since '"" + inputChannel + ""' is a SubscribableChannel (not pollable)."");"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"protected void configurePollingEndpoint(AbstractPollingEndpoint pollingEndpoint, List<Annotation> annotations) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"Assert.state(!StringUtils.hasText(triggerRef) && !StringUtils.hasText(executorRef) &&"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"!StringUtils.hasText(cron) && !StringUtils.hasText(fixedDelayValue) &&"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"!StringUtils.hasText(fixedRateValue) && !StringUtils.hasText(maxMessagesPerPollValue),"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"Assert.state(!StringUtils.hasText(cron) && !StringUtils.hasText(fixedDelayValue)"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"&& !StringUtils.hasText(fixedRateValue),"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"protected String generateHandlerBeanName(String originalBeanName, Method method) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"String baseName = originalBeanName + ""."" + method.getName() + ""."""
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"+ ClassUtils.getShortNameAsProperty(this.annotationType);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"protected void setOutputChannelIfPresent(List<Annotation> annotations, AbstractReplyProducingMessageHandler	handler) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"String outputChannelName = MessagingAnnotationUtils.resolveAttribute(annotations, ""outputChannel"", String.class);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"if (StringUtils.hasText(outputChannelName)) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"handler.setOutputChannel(this.channelResolver.resolveDestination(outputChannelName));"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"}"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"protected abstract MessageHandler createHandler(Object bean, Method method, List<Annotation> annotations);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"public Object postProcess(Object bean, String beanName, Method method, T annotation) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"MessageHandler handler = this.createHandler(bean, method, annotation);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"this.setAdviceChainIfPresent(beanName, annotation, handler);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"String handlerBeanName = this.generateHandlerBeanName(beanName, method, annotation.annotationType());"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"AbstractEndpoint endpoint = this.createEndpoint(handler, annotation);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"protected final void setAdviceChainIfPresent(String beanName, T annotation, MessageHandler handler) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"String[] adviceChainNames = (String[]) AnnotationUtils.getValue(annotation, ADVICE_CHAIN_ATTRIBUTE);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"private AbstractEndpoint createEndpoint(MessageHandler handler, T annotation) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"String inputChannelName = (String) AnnotationUtils.getValue(annotation, INPUT_CHANNEL_ATTRIBUTE);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"this.configurePollingEndpoint(pollingConsumer, annotation);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"Poller[] pollers = (Poller[]) AnnotationUtils.getValue(annotation, ""poller"");"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"Assert.state(ObjectUtils.isEmpty(pollers), ""A '@Poller' should not be specified for for Annotation-based endpoint, "" +"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"""since '"" + inputChannel + ""' is a SubscribableChannel (not pollable)."");"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"protected void configurePollingEndpoint(AbstractPollingEndpoint pollingEndpoint, T annotation) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"Assert.state(!StringUtils.hasText(triggerRef) && !StringUtils.hasText(executorRef) && !StringUtils.hasText(cron)"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"&& !StringUtils.hasText(fixedDelayValue) && !StringUtils.hasText(fixedRateValue)"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"&& !StringUtils.hasText(maxMessagesPerPollValue),"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"Assert.state(!StringUtils.hasText(cron) && !StringUtils.hasText(fixedDelayValue) && !StringUtils.hasText(fixedRateValue),"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"protected String generateHandlerBeanName(String originalBeanName, Method method, Class<? extends Annotation> annotationType) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"String baseName = originalBeanName + ""."" + method.getName() + ""."" + ClassUtils.getShortNameAsProperty(annotationType);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"* @param annotation The annotation."
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"protected abstract MessageHandler createHandler(Object bean, Method method, T annotation);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import java.util.List;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* @author Gary Russell"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* @author Artem Bilan"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"protected MessageHandler createHandler(Object bean, Method method, List<Annotation> annotations) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"MethodInvokingReleaseStrategy releaseStrategy = null;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"Method releaseStrategyMethod = MessagingAnnotationUtils.findAnnotatedMethod(bean, ReleaseStrategy.class);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"if (releaseStrategyMethod != null) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"releaseStrategy = new MethodInvokingReleaseStrategy(bean, releaseStrategyMethod);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"}"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"MethodInvokingCorrelationStrategy correlationStrategy = null;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"Method correlationStrategyMethod = MessagingAnnotationUtils.findAnnotatedMethod(bean, CorrelationStrategy.class);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"if (correlationStrategyMethod != null) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"correlationStrategy = new MethodInvokingCorrelationStrategy(bean, correlationStrategyMethod);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"AggregatingMessageHandler handler = new AggregatingMessageHandler(processor, new SimpleMessageStore(),"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"correlationStrategy, releaseStrategy);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"String discardChannelName = MessagingAnnotationUtils.resolveAttribute(annotations, ""discardChannel"", String.class);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"String outputChannelName = MessagingAnnotationUtils.resolveAttribute(annotations, ""outputChannel"", String.class);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"Long sendTimeout = MessagingAnnotationUtils.resolveAttribute(annotations, ""sendTimeout"", Long.class);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"if (sendTimeout != null) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"handler.setSendTimeout(sendTimeout);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"Boolean sendPartialResultsOnExpiry = MessagingAnnotationUtils.resolveAttribute(annotations,"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"""sendPartialResultsOnExpiry"", Boolean.class);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"if (sendPartialResultsOnExpiry != null) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"handler.setSendPartialResultOnExpiry(sendPartialResultsOnExpiry);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"import java.util.concurrent.atomic.AtomicReference;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"import org.springframework.core.annotation.AnnotationUtils;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"import org.springframework.util.ReflectionUtils;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"protected MessageHandler createHandler(Object bean, Method method, Aggregator annotation) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"MethodInvokingReleaseStrategy releaseStrategy = getReleaseStrategy(bean);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"MethodInvokingCorrelationStrategy correlationStrategy = getCorrelationStrategy(bean);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"AggregatingMessageHandler handler = new AggregatingMessageHandler(processor, new SimpleMessageStore(), correlationStrategy, releaseStrategy);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"String discardChannelName = annotation.discardChannel();"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"String outputChannelName = annotation.outputChannel();"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"handler.setSendTimeout(annotation.sendTimeout());"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"handler.setSendPartialResultOnExpiry(annotation.sendPartialResultsOnExpiry());"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"private MethodInvokingReleaseStrategy getReleaseStrategy(final Object bean) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"final AtomicReference<MethodInvokingReleaseStrategy> reference = new AtomicReference<MethodInvokingReleaseStrategy>();"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"ReflectionUtils.doWithMethods(bean.getClass(), new ReflectionUtils.MethodCallback() {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"@Override"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"public void doWith(Method method) throws IllegalArgumentException, IllegalAccessException {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"Annotation annotation = AnnotationUtils.getAnnotation(method, ReleaseStrategy.class);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"if (annotation != null) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"reference.set(new MethodInvokingReleaseStrategy(bean, method));"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"}"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"});"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"return reference.get();"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"private MethodInvokingCorrelationStrategy getCorrelationStrategy(final Object bean) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"final AtomicReference<MethodInvokingCorrelationStrategy> reference = new AtomicReference<MethodInvokingCorrelationStrategy>();"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"Annotation annotation = AnnotationUtils.getAnnotation(method, CorrelationStrategy.class);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"reference.set(new MethodInvokingCorrelationStrategy(bean, method));"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import java.util.List;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"* @author Gary Russell"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"* @author Artem Bilan"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"protected MessageHandler createHandler(Object bean, Method method, List<Annotation> annotations) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"MethodInvokingReleaseStrategy releaseStrategy = null;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Method releaseStrategyMethod = MessagingAnnotationUtils.findAnnotatedMethod(bean, ReleaseStrategy.class);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (releaseStrategyMethod != null) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"releaseStrategy = new MethodInvokingReleaseStrategy(bean, releaseStrategyMethod);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"}"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"MethodInvokingCorrelationStrategy correlationStrategy = null;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Method correlationStrategyMethod = MessagingAnnotationUtils.findAnnotatedMethod(bean, CorrelationStrategy.class);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (correlationStrategyMethod != null) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"correlationStrategy = new MethodInvokingCorrelationStrategy(bean, correlationStrategyMethod);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"AggregatingMessageHandler handler = new AggregatingMessageHandler(processor, new SimpleMessageStore(),"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"correlationStrategy, releaseStrategy);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"String discardChannelName = MessagingAnnotationUtils.resolveAttribute(annotations, ""discardChannel"", String.class);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"String outputChannelName = MessagingAnnotationUtils.resolveAttribute(annotations, ""outputChannel"", String.class);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Long sendTimeout = MessagingAnnotationUtils.resolveAttribute(annotations, ""sendTimeout"", Long.class);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (sendTimeout != null) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"handler.setSendTimeout(sendTimeout);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Boolean sendPartialResultsOnExpiry = MessagingAnnotationUtils.resolveAttribute(annotations,"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"""sendPartialResultsOnExpiry"", Boolean.class);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (sendPartialResultsOnExpiry != null) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"handler.setSendPartialResultOnExpiry(sendPartialResultsOnExpiry);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"import java.util.concurrent.atomic.AtomicReference;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"import org.springframework.core.annotation.AnnotationUtils;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"import org.springframework.util.ReflectionUtils;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"protected MessageHandler createHandler(Object bean, Method method, Aggregator annotation) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"MethodInvokingReleaseStrategy releaseStrategy = getReleaseStrategy(bean);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"MethodInvokingCorrelationStrategy correlationStrategy = getCorrelationStrategy(bean);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"AggregatingMessageHandler handler = new AggregatingMessageHandler(processor, new SimpleMessageStore(), correlationStrategy, releaseStrategy);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"String discardChannelName = annotation.discardChannel();"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"String outputChannelName = annotation.outputChannel();"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"handler.setSendTimeout(annotation.sendTimeout());"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"handler.setSendPartialResultOnExpiry(annotation.sendPartialResultsOnExpiry());"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"private MethodInvokingReleaseStrategy getReleaseStrategy(final Object bean) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"final AtomicReference<MethodInvokingReleaseStrategy> reference = new AtomicReference<MethodInvokingReleaseStrategy>();"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"ReflectionUtils.doWithMethods(bean.getClass(), new ReflectionUtils.MethodCallback() {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"@Override"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"public void doWith(Method method) throws IllegalArgumentException, IllegalAccessException {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"Annotation annotation = AnnotationUtils.getAnnotation(method, ReleaseStrategy.class);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"if (annotation != null) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"reference.set(new MethodInvokingReleaseStrategy(bean, method));"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"}"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"});"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"return reference.get();"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"private MethodInvokingCorrelationStrategy getCorrelationStrategy(final Object bean) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"final AtomicReference<MethodInvokingCorrelationStrategy> reference = new AtomicReference<MethodInvokingCorrelationStrategy>();"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"Annotation annotation = AnnotationUtils.getAnnotation(method, CorrelationStrategy.class);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"reference.set(new MethodInvokingCorrelationStrategy(bean, method));"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import java.lang.annotation.Annotation;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import java.util.List;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import org.springframework.messaging.MessageChannel;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import org.springframework.messaging.MessageHandler;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* @author Gary Russell"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"protected MessageHandler createHandler(Object bean, Method method,"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"List<Annotation> annotations) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"String defaultOutputChannelName = MessagingAnnotationUtils.resolveAttribute(annotations, ""defaultOutputChannel"","
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"String.class);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"import org.springframework.messaging.MessageChannel;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"import org.springframework.messaging.MessageHandler;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"protected MessageHandler createHandler(Object bean, Method method, Router annotation) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"String defaultOutputChannelName = annotation.defaultOutputChannel();"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import java.lang.annotation.Annotation;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import java.util.List;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import org.springframework.messaging.MessageHandler;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* @author Gary Russell"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"protected MessageHandler createHandler(Object bean, Method method, List<Annotation> annotations) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.setOutputChannelIfPresent(annotations, serviceActivator);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"import org.springframework.messaging.MessageHandler;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"import org.springframework.util.StringUtils;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"protected MessageHandler createHandler(Object bean, Method method, ServiceActivator annotation) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"String outputChannelName = annotation.outputChannel();"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"if (StringUtils.hasText(outputChannelName)) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"serviceActivator.setOutputChannel(this.channelResolver.resolveDestination(outputChannelName));"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"}"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import java.lang.annotation.Annotation;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import java.util.List;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import org.springframework.messaging.MessageHandler;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* @author Gary Russell"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"protected MessageHandler createHandler(Object bean, Method method, List<Annotation> annotations) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.setOutputChannelIfPresent(annotations, splitter);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"import org.springframework.messaging.MessageHandler;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"import org.springframework.util.StringUtils;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"protected MessageHandler createHandler(Object bean, Method method, Splitter annotation) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"String outputChannelName = annotation.outputChannel();"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"if (StringUtils.hasText(outputChannelName)) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"splitter.setOutputChannel(this.channelResolver.resolveDestination(outputChannelName));"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"}"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import java.lang.annotation.Annotation;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import java.util.List;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import org.springframework.messaging.MessageHandler;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* @author Gary Russell"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"protected MessageHandler createHandler(Object bean, Method method, List<Annotation> annotations) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.setOutputChannelIfPresent(annotations, handler);"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"import org.springframework.messaging.MessageHandler;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"import org.springframework.util.StringUtils;"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"protected MessageHandler createHandler(Object bean, Method method, Transformer annotation) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"String outputChannelName = annotation.outputChannel();"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"if (StringUtils.hasText(outputChannelName)) {"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"handler.setOutputChannel(this.channelResolver.resolveDestination(outputChannelName));"
"24f176c897cc7fc3f5311d6d5de9a3e98db53c3c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"}"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"import org.springframework.aop.TargetSource;"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"import org.springframework.aop.framework.Advised;"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"import org.springframework.context.annotation.Bean;"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"import org.springframework.core.annotation.AnnotatedElementUtils;"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"import org.springframework.core.convert.ConversionService;"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"import org.springframework.core.convert.support.DefaultConversionService;"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"protected final ConfigurableListableBeanFactory beanFactory;"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"protected final ConversionService conversionService;"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"Assert.notNull(beanFactory, ""'beanFactory' must not be null"");"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"Assert.isInstanceOf(ConfigurableListableBeanFactory.class, beanFactory,"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"""'beanFactory' must be instanceOf ConfigurableListableBeanFactory"");"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"this.beanFactory = (ConfigurableListableBeanFactory) beanFactory;"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"ConversionService conversionService = this.beanFactory.getConversionService();"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"if (conversionService != null) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"this.conversionService = conversionService;"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"}"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"else {"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"this.conversionService = new DefaultConversionService();"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"boolean handlerExists = false;"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"if (this.beanAnnotationAware() && AnnotatedElementUtils.isAnnotated(method, Bean.class.getName())) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"Object handlerBean = this.resolveTargetBeanFromMethodWithBeanAnnotation(method);"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"handlerExists = handlerBean != null && handler == handlerBean;"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"if (!handlerExists) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"this.beanFactory.registerSingleton(handlerBeanName, handler);"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"handler = (MessageHandler) this.beanFactory.initializeBean(handler, handlerBeanName);"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"boolean createEndpoint = StringUtils.hasText(inputChannel);"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"if (!createEndpoint && beanAnnotationAware()) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"boolean isBean = AnnotatedElementUtils.isAnnotated(method, Bean.class.getName());"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"Assert.isTrue(!isBean, ""A channel name in '"" + getInputChannelAttribute() + ""' is required when "" + this.annotationType +"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,""" is used on '@Bean' methods."");"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"return createEndpoint;"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"protected boolean beanAnnotationAware() {"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"return true;"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"this.beanFactory.registerSingleton(inputChannelName, inputChannel);"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"inputChannel = (MessageChannel) this.beanFactory.initializeBean(inputChannel, inputChannelName);"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"protected AbstractEndpoint doCreateEndpoint(MessageHandler handler, MessageChannel inputChannel,List<Annotation> annotations) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"protected Object resolveTargetBeanFromMethodWithBeanAnnotation(Method method) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"String id = null;"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"String[] names = AnnotationUtils.getAnnotation(method, Bean.class).name();"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"if (!ObjectUtils.isEmpty(names)) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"id = names[0];"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"if (!StringUtils.hasText(id)) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"id = method.getName();"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"return this.beanFactory.getBean(id);"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"@SuppressWarnings(""unchecked"")"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"<H> H extractTypeIfPossible(Object targetObject, Class<H> expectedType) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"if (targetObject == null) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"return null;"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"if (expectedType.isAssignableFrom(targetObject.getClass())) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"return (H) targetObject;"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"if (targetObject instanceof Advised) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"TargetSource targetSource = ((Advised) targetObject).getTargetSource();"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"if (targetSource == null) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"try {"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"return extractTypeIfPossible(targetSource.getTarget(), expectedType);"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"} catch (Exception e) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"throw new IllegalStateException(e);"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"* @param annotations The messaging annotation (or meta-annotation hierarchy) on the method."
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"import org.springframework.beans.factory.BeanFactory;"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"protected final BeanFactory beanFactory;"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"Assert.notNull(beanFactory, ""BeanFactory must not be null"");"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"this.beanFactory = beanFactory;"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"if (beanFactory instanceof ConfigurableListableBeanFactory) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"ConfigurableListableBeanFactory listableBeanFactory = (ConfigurableListableBeanFactory) beanFactory;"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"listableBeanFactory.registerSingleton(handlerBeanName, handler);"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"handler = (MessageHandler) listableBeanFactory.initializeBean(handler, handlerBeanName);"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"return StringUtils.hasText(inputChannel);"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"if (this.beanFactory instanceof ConfigurableListableBeanFactory) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"ConfigurableListableBeanFactory listableBeanFactory = (ConfigurableListableBeanFactory) this.beanFactory;"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"listableBeanFactory.registerSingleton(inputChannelName, inputChannel);"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"inputChannel = (MessageChannel) listableBeanFactory.initializeBean(inputChannel, inputChannelName);"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"}"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"protected AbstractEndpoint doCreateEndpoint(MessageHandler handler, MessageChannel inputChannel,"
"34cc492942f41c1998be6db32a5f752bf57246e8","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"List<Annotation> annotations) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"import org.springframework.aop.TargetSource;"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"import org.springframework.aop.framework.Advised;"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"import org.springframework.context.annotation.Bean;"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"import org.springframework.core.annotation.AnnotatedElementUtils;"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"import org.springframework.core.convert.ConversionService;"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"import org.springframework.core.convert.support.DefaultConversionService;"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"protected final ConfigurableListableBeanFactory beanFactory;"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"protected final ConversionService conversionService;"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"Assert.notNull(beanFactory, ""'beanFactory' must not be null"");"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"Assert.isInstanceOf(ConfigurableListableBeanFactory.class, beanFactory,"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"""'beanFactory' must be instanceOf ConfigurableListableBeanFactory"");"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"this.beanFactory = (ConfigurableListableBeanFactory) beanFactory;"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"ConversionService conversionService = this.beanFactory.getConversionService();"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"if (conversionService != null) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"this.conversionService = conversionService;"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"}"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"else {"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"this.conversionService = new DefaultConversionService();"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"boolean handlerExists = false;"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"if (this.beanAnnotationAware() && AnnotatedElementUtils.isAnnotated(method, Bean.class.getName())) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"Object handlerBean = this.resolveTargetBeanFromMethodWithBeanAnnotation(method);"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"handlerExists = handlerBean != null && handler == handlerBean;"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"if (!handlerExists) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"this.beanFactory.registerSingleton(handlerBeanName, handler);"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"handler = (MessageHandler) this.beanFactory.initializeBean(handler, handlerBeanName);"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"boolean createEndpoint = StringUtils.hasText(inputChannel);"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"if (!createEndpoint && beanAnnotationAware()) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"boolean isBean = AnnotatedElementUtils.isAnnotated(method, Bean.class.getName());"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"Assert.isTrue(!isBean, ""A channel name in '"" + getInputChannelAttribute() + ""' is required when "" + this.annotationType +"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,""" is used on '@Bean' methods."");"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"return createEndpoint;"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"protected boolean beanAnnotationAware() {"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"return true;"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"this.beanFactory.registerSingleton(inputChannelName, inputChannel);"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"inputChannel = (MessageChannel) this.beanFactory.initializeBean(inputChannel, inputChannelName);"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"protected AbstractEndpoint doCreateEndpoint(MessageHandler handler, MessageChannel inputChannel,List<Annotation> annotations) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"protected Object resolveTargetBeanFromMethodWithBeanAnnotation(Method method) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"String id = null;"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"String[] names = AnnotationUtils.getAnnotation(method, Bean.class).name();"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"if (!ObjectUtils.isEmpty(names)) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"id = names[0];"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"if (!StringUtils.hasText(id)) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"id = method.getName();"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"return this.beanFactory.getBean(id);"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"@SuppressWarnings(""unchecked"")"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"<H> H extractTypeIfPossible(Object targetObject, Class<H> expectedType) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"if (targetObject == null) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"return null;"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"if (expectedType.isAssignableFrom(targetObject.getClass())) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"return (H) targetObject;"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"if (targetObject instanceof Advised) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"TargetSource targetSource = ((Advised) targetObject).getTargetSource();"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"if (targetSource == null) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"try {"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"return extractTypeIfPossible(targetSource.getTarget(), expectedType);"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"} catch (Exception e) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"throw new IllegalStateException(e);"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"* @param annotations The messaging annotation (or meta-annotation hierarchy) on the method."
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"import org.springframework.beans.factory.BeanFactory;"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"protected final BeanFactory beanFactory;"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"Assert.notNull(beanFactory, ""BeanFactory must not be null"");"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"this.beanFactory = beanFactory;"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"if (beanFactory instanceof ConfigurableListableBeanFactory) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"ConfigurableListableBeanFactory listableBeanFactory = (ConfigurableListableBeanFactory) beanFactory;"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"listableBeanFactory.registerSingleton(handlerBeanName, handler);"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"handler = (MessageHandler) listableBeanFactory.initializeBean(handler, handlerBeanName);"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"return StringUtils.hasText(inputChannel);"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"if (this.beanFactory instanceof ConfigurableListableBeanFactory) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"ConfigurableListableBeanFactory listableBeanFactory = (ConfigurableListableBeanFactory) this.beanFactory;"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"listableBeanFactory.registerSingleton(inputChannelName, inputChannel);"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"inputChannel = (MessageChannel) listableBeanFactory.initializeBean(inputChannel, inputChannelName);"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"}"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"protected AbstractEndpoint doCreateEndpoint(MessageHandler handler, MessageChannel inputChannel,"
"34cc492942f41c1998be6db32a5f752bf57246e8","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"List<Annotation> annotations) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"import java.util.Properties;"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"import org.springframework.context.annotation.Bean;"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"import org.springframework.core.annotation.AnnotatedElementUtils;"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"import org.springframework.core.convert.TypeDescriptor;"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"import org.springframework.integration.router.AbstractMessageRouter;"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"import org.springframework.util.ObjectUtils;"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"* @author Artem Bilan"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"protected MessageHandler createHandler(Object bean, Method method, List<Annotation> annotations) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"AbstractMessageRouter router;"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"if (AnnotatedElementUtils.isAnnotated(method, Bean.class.getName())) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"Object target = this.resolveTargetBeanFromMethodWithBeanAnnotation(method);"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"router = this.extractTypeIfPossible(target, AbstractMessageRouter.class);"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"if (router == null) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"if (target instanceof MessageHandler) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"Assert.isTrue(this.routerAttributesProvided(annotations), ""'defaultOutputChannel', """
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"+ ""'applySequence', 'ignoreSendFailures', 'resolutionRequired' and 'channelMappings' """
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"+ ""can be applied to 'AbstractMessageRouter' implementations, but target handler is: """
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"+ target.getClass());"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"return (MessageHandler) target;"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"}"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"else {"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"router = new MethodInvokingRouter(target);"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"return router;"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"router = new MethodInvokingRouter(bean, method);"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"String defaultOutputChannelName = MessagingAnnotationUtils.resolveAttribute(annotations,"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"""defaultOutputChannel"", String.class);"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"router.setDefaultOutputChannelName(defaultOutputChannelName);"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"String applySequence = MessagingAnnotationUtils.resolveAttribute(annotations, ""applySequence"", String.class);"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"if (StringUtils.hasText(applySequence)) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"router.setApplySequence(Boolean.parseBoolean(this.environment.resolvePlaceholders(applySequence)));"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"String ignoreSendFailures = MessagingAnnotationUtils.resolveAttribute(annotations, ""ignoreSendFailures"","
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"if (StringUtils.hasText(ignoreSendFailures)) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"router.setIgnoreSendFailures(Boolean.parseBoolean(this.environment.resolvePlaceholders(ignoreSendFailures)));"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"if (this.routerAttributesProvided(annotations)) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"MethodInvokingRouter methodInvokingRouter = (MethodInvokingRouter) router;"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"String resolutionRequired = MessagingAnnotationUtils.resolveAttribute(annotations, ""resolutionRequired"","
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"String.class);"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"if (StringUtils.hasText(resolutionRequired)) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"String resolutionRequiredValue = this.environment.resolvePlaceholders(resolutionRequired);"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"if (StringUtils.hasText(resolutionRequiredValue)) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"methodInvokingRouter.setResolutionRequired(Boolean.parseBoolean(resolutionRequiredValue));"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"String prefix = MessagingAnnotationUtils.resolveAttribute(annotations, ""prefix"", String.class);"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"if (StringUtils.hasText(prefix)) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"methodInvokingRouter.setPrefix(this.environment.resolvePlaceholders(prefix));"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"String suffix = MessagingAnnotationUtils.resolveAttribute(annotations, ""suffix"", String.class);"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"if (StringUtils.hasText(suffix)) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"methodInvokingRouter.setSuffix(this.environment.resolvePlaceholders(suffix));"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"String[] channelMappings = MessagingAnnotationUtils.resolveAttribute(annotations, ""channelMappings"","
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"String[].class);"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"if (!ObjectUtils.isEmpty(channelMappings)) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"StringBuilder mappings = new StringBuilder();"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"for (String channelMapping : channelMappings) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"mappings.append(channelMapping).append(""\n"");"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"Properties properties = (Properties) this.conversionService.convert(mappings.toString(),"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"TypeDescriptor.valueOf(String.class), TypeDescriptor.valueOf(Properties.class));"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"methodInvokingRouter.replaceChannelMappings(properties);"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"private boolean routerAttributesProvided(List<Annotation> annotations) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"String defaultOutputChannel = MessagingAnnotationUtils.resolveAttribute(annotations, ""defaultOutputChannel"","
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"return StringUtils.hasText(defaultOutputChannel) || !ObjectUtils.isEmpty(channelMappings)"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"|| StringUtils.hasText(prefix) || StringUtils.hasText(suffix) || StringUtils.hasText(resolutionRequired)"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"|| StringUtils.hasText(applySequence) || StringUtils.hasText(ignoreSendFailures);"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"import org.springframework.messaging.MessageChannel;"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"protected MessageHandler createHandler(Object bean, Method method,"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"List<Annotation> annotations) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"MethodInvokingRouter router = new MethodInvokingRouter(bean, method);"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"router.setBeanFactory(this.beanFactory);"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"String defaultOutputChannelName = MessagingAnnotationUtils.resolveAttribute(annotations, ""defaultOutputChannel"","
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"if (StringUtils.hasText(defaultOutputChannelName)) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"MessageChannel defaultOutputChannel = this.channelResolver.resolveDestination(defaultOutputChannelName);"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"Assert.notNull(defaultOutputChannel, ""unable to resolve defaultOutputChannel '"" + defaultOutputChannelName + ""'"");"
"34cc492942f41c1998be6db32a5f752bf57246e8","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"router.setDefaultOutputChannel(defaultOutputChannel);"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import java.util.Properties;"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import org.springframework.context.annotation.Bean;"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import org.springframework.core.annotation.AnnotatedElementUtils;"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import org.springframework.core.convert.TypeDescriptor;"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import org.springframework.integration.router.AbstractMessageRouter;"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import org.springframework.util.ObjectUtils;"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"* @author Artem Bilan"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"protected MessageHandler createHandler(Object bean, Method method, List<Annotation> annotations) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"AbstractMessageRouter router;"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (AnnotatedElementUtils.isAnnotated(method, Bean.class.getName())) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Object target = this.resolveTargetBeanFromMethodWithBeanAnnotation(method);"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"router = this.extractTypeIfPossible(target, AbstractMessageRouter.class);"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (router == null) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (target instanceof MessageHandler) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Assert.isTrue(this.routerAttributesProvided(annotations), ""'defaultOutputChannel', """
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"+ ""'applySequence', 'ignoreSendFailures', 'resolutionRequired' and 'channelMappings' """
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"+ ""can be applied to 'AbstractMessageRouter' implementations, but target handler is: """
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"+ target.getClass());"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return (MessageHandler) target;"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"}"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"else {"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"router = new MethodInvokingRouter(target);"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return router;"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"router = new MethodInvokingRouter(bean, method);"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"String defaultOutputChannelName = MessagingAnnotationUtils.resolveAttribute(annotations,"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"""defaultOutputChannel"", String.class);"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"router.setDefaultOutputChannelName(defaultOutputChannelName);"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"String applySequence = MessagingAnnotationUtils.resolveAttribute(annotations, ""applySequence"", String.class);"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (StringUtils.hasText(applySequence)) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"router.setApplySequence(Boolean.parseBoolean(this.environment.resolvePlaceholders(applySequence)));"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"String ignoreSendFailures = MessagingAnnotationUtils.resolveAttribute(annotations, ""ignoreSendFailures"","
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (StringUtils.hasText(ignoreSendFailures)) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"router.setIgnoreSendFailures(Boolean.parseBoolean(this.environment.resolvePlaceholders(ignoreSendFailures)));"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (this.routerAttributesProvided(annotations)) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"MethodInvokingRouter methodInvokingRouter = (MethodInvokingRouter) router;"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"String resolutionRequired = MessagingAnnotationUtils.resolveAttribute(annotations, ""resolutionRequired"","
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"String.class);"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (StringUtils.hasText(resolutionRequired)) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"String resolutionRequiredValue = this.environment.resolvePlaceholders(resolutionRequired);"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (StringUtils.hasText(resolutionRequiredValue)) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"methodInvokingRouter.setResolutionRequired(Boolean.parseBoolean(resolutionRequiredValue));"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"String prefix = MessagingAnnotationUtils.resolveAttribute(annotations, ""prefix"", String.class);"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (StringUtils.hasText(prefix)) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"methodInvokingRouter.setPrefix(this.environment.resolvePlaceholders(prefix));"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"String suffix = MessagingAnnotationUtils.resolveAttribute(annotations, ""suffix"", String.class);"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (StringUtils.hasText(suffix)) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"methodInvokingRouter.setSuffix(this.environment.resolvePlaceholders(suffix));"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"String[] channelMappings = MessagingAnnotationUtils.resolveAttribute(annotations, ""channelMappings"","
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"String[].class);"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (!ObjectUtils.isEmpty(channelMappings)) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"StringBuilder mappings = new StringBuilder();"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"for (String channelMapping : channelMappings) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"mappings.append(channelMapping).append(""\n"");"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Properties properties = (Properties) this.conversionService.convert(mappings.toString(),"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"TypeDescriptor.valueOf(String.class), TypeDescriptor.valueOf(Properties.class));"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"methodInvokingRouter.replaceChannelMappings(properties);"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private boolean routerAttributesProvided(List<Annotation> annotations) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"String defaultOutputChannel = MessagingAnnotationUtils.resolveAttribute(annotations, ""defaultOutputChannel"","
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return StringUtils.hasText(defaultOutputChannel) || !ObjectUtils.isEmpty(channelMappings)"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"|| StringUtils.hasText(prefix) || StringUtils.hasText(suffix) || StringUtils.hasText(resolutionRequired)"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"|| StringUtils.hasText(applySequence) || StringUtils.hasText(ignoreSendFailures);"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"import org.springframework.messaging.MessageChannel;"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"protected MessageHandler createHandler(Object bean, Method method,"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"List<Annotation> annotations) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"MethodInvokingRouter router = new MethodInvokingRouter(bean, method);"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"router.setBeanFactory(this.beanFactory);"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"String defaultOutputChannelName = MessagingAnnotationUtils.resolveAttribute(annotations, ""defaultOutputChannel"","
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"if (StringUtils.hasText(defaultOutputChannelName)) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"MessageChannel defaultOutputChannel = this.channelResolver.resolveDestination(defaultOutputChannelName);"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"Assert.notNull(defaultOutputChannel, ""unable to resolve defaultOutputChannel '"" + defaultOutputChannelName + ""'"");"
"34cc492942f41c1998be6db32a5f752bf57246e8","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"router.setDefaultOutputChannel(defaultOutputChannel);"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import org.springframework.context.annotation.Bean;"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import org.springframework.core.annotation.AnnotatedElementUtils;"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import org.springframework.integration.handler.AbstractReplyProducingMessageHandler;"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import org.springframework.messaging.Message;"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import org.springframework.util.StringUtils;"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* @author Artem Bilan"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"AbstractReplyProducingMessageHandler serviceActivator;"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"if (AnnotatedElementUtils.isAnnotated(method, Bean.class.getName())) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"final Object target = this.resolveTargetBeanFromMethodWithBeanAnnotation(method);"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"serviceActivator = this.extractTypeIfPossible(target, AbstractReplyProducingMessageHandler.class);"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"if (serviceActivator == null) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"if (target instanceof MessageHandler) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"/*"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* Return a reply-producing message handler so that we still get 'produced no reply' messages"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* and the super class will inject the advice chain to advise the handler method if needed."
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"*/"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"return new AbstractReplyProducingMessageHandler() {"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"@Override"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"protected Object handleRequestMessage(Message<?> requestMessage) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"((MessageHandler) target).handleMessage(requestMessage);"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"return null;"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"}"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"};"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"else {"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"serviceActivator = new ServiceActivatingHandler(target);"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"return (MessageHandler) target;"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"serviceActivator = new ServiceActivatingHandler(bean, method);"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"String requiresReply = MessagingAnnotationUtils.resolveAttribute(annotations, ""requiresReply"", String.class);"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"if (StringUtils.hasText(requiresReply)) {"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"serviceActivator.setRequiresReply(Boolean.parseBoolean(this.environment.resolvePlaceholders(requiresReply)));"
"34cc492942f41c1998be6db32a5f752bf57246e8","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"ServiceActivatingHandler serviceActivator = new ServiceActivatingHandler(bean, method);"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"* @author John Anderson"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"logger.info(getConnectionId() + "" Insufficient threads in the assembler fixed thread pool; consider "" +"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"""increasing this task executor pool size; data avail: "" + this.channelInputStream.available());"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"if (dataAvailable()) {"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"}"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"else {"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"logger.trace(this.getConnectionId() + "" Nio message assembler exiting... avail: "" + this.channelInputStream.available());"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"checkForAssembler();"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"if (logger.isTraceEnabled()) {"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"logger.trace(""Before read:"" + this.rawBuffer.position() + ""/"" + this.rawBuffer.limit());"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"int len = this.socketChannel.read(this.rawBuffer);"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"if (len < 0) {"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"this.writingToPipe = false;"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"this.closeConnection(true);"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"logger.trace(""After read:"" + this.rawBuffer.position() + ""/"" + this.rawBuffer.limit());"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"this.rawBuffer.flip();"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"logger.trace(""After flip:"" + this.rawBuffer.position() + ""/"" + this.rawBuffer.limit());"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"if (logger.isDebugEnabled()) {"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"logger.debug(""Read "" + rawBuffer.limit() + "" into raw buffer"");"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"this.sendToPipe(rawBuffer);"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"catch (RejectedExecutionException e) {"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"throw e;"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"private void checkForAssembler() {"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"logger.info(""Insufficient threads in the assembler fixed thread pool; consider "" +"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"""increasing this task executor pool size"");"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"if (this.isOpen() && dataAvailable()) {"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"} else {"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"Thread.yield();"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"logger.trace(this.getConnectionId() + "" Nio message assembler exiting..."");"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"if (checkForAssembler()) {"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"if (logger.isTraceEnabled()) {"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"logger.trace(""Before read:"" + this.rawBuffer.position() + ""/"" + this.rawBuffer.limit());"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"}"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"int len = this.socketChannel.read(this.rawBuffer);"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"if (len < 0) {"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"this.writingToPipe = false;"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"this.closeConnection(true);"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"logger.trace(""After read:"" + this.rawBuffer.position() + ""/"" + this.rawBuffer.limit());"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"this.rawBuffer.flip();"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"logger.trace(""After flip:"" + this.rawBuffer.position() + ""/"" + this.rawBuffer.limit());"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"if (logger.isDebugEnabled()) {"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"logger.debug(""Read "" + rawBuffer.limit() + "" into raw buffer"");"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"this.sendToPipe(rawBuffer);"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"private boolean checkForAssembler() {"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"return false;"
"3c063a265bddc15eb4a4b714d9896dbd22b8dc99","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"return true;"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"import java.util.concurrent.CountDownLatch;"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"private volatile CountDownLatch writingLatch;"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"if (logger.isTraceEnabled()) {"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"logger.trace(getConnectionId() + "" checking data avail: "" + this.channelInputStream.available() +"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","added",0,""" pending: "" + (this.writingToPipe));"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"}"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"return writingToPipe || this.channelInputStream.available() > 0;"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"logger.trace(getConnectionId() + "" checking data avail (convert): "" + this.channelInputStream.available() +"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"if (this.channelInputStream.available() <= 0) {"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"try {"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"if (this.writingLatch.await(60, TimeUnit.SECONDS)) {"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"return null;"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"else { // should never happen"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"throw new IOException(""Timed out waiting for IO"");"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"catch (InterruptedException e) {"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"Thread.currentThread().interrupt();"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"throw new IOException(""Interrupted waiting for IO"");"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"this.writingLatch = new CountDownLatch(1);"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"this.writingLatch.countDown();"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"if (TcpNioConnection.this.writingLatch != null) {"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"TcpNioConnection.this.writingLatch.countDown();"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","added",0,"TcpNioConnection.this.writingLatch = new CountDownLatch(1);"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"return this.channelInputStream.available() > 0 || writingToPipe;"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"if (!dataAvailable()) {"
"5aee3c85ba6f380e9949f37aa5105935ddd92a4a","4090905770bae7dd4621443b46c7766624aa5a10","deleted",1,"return null;"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* @param server the ServerSocketChannel to select"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* @param selector the Selector multiplexor"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"private void doSelect(ServerSocketChannel server, final Selector selector) throws IOException {"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"}"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"catch (Exception e) {"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.setActive(false);"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"if (this.serverChannel != null) {"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"try {"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.serverChannel.close();"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"catch (IOException e) {"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"finally {"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.serverChannel = null;"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"import java.net.SocketException;"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"import java.nio.channels.ClosedChannelException;"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"* @param server"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"* @param selector"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"* @throws ClosedChannelException"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"* @throws SocketException"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"private void doSelect(ServerSocketChannel server, final Selector selector)"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"throws IOException, SocketException {"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"} catch (Exception e) {"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"if (this.serverChannel == null) {"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return;"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"}"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"try {"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"this.serverChannel.close();"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"catch (IOException e) {}"
"a64b53a1b5265588583c2930f82e92853c8f7e6b","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"this.serverChannel = null;"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"import org.springframework.messaging.MessageDeliveryException;"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"CorrelationStrategy correlationStrategy, ReleaseStrategy releaseStrategy) {"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"this.correlationStrategy = (correlationStrategy == null"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"? new HeaderAttributeCorrelationStrategy(IntegrationMessageHeaderAccessor.CORRELATION_ID)"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,": correlationStrategy);"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"""Release strategy of type ["" + this.releaseStrategy.getClass().getSimpleName() +"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"""] cannot release partial sequences. Use the default SequenceSizeReleaseStrategy instead."");"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"((SequenceSizeReleaseStrategy) this.releaseStrategy).setReleasePartialSequences(releasePartialSequences);"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"Assert.state(correlationKey != null, ""Null correlation not allowed.  Maybe the CorrelationStrategy is failing?"");"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"logger.debug(""Cancel 'forceComplete' scheduling for MessageGroup with Correlation Key [ """
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"+ correlationKey + ""]."");"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"if (this.sequenceAware) {"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"scheduleGroupToForceComplete(messageGroup);"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"private void scheduleGroupToForceComplete(final MessageGroup messageGroup) {"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"final Long groupTimeout = this.obtainGroupTimeout(messageGroup);"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"/*"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"* When 'groupTimeout' is evaluated to 'null' we do nothing."
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"* The 'MessageGroupStoreReaper' can be used to 'forceComplete' message groups."
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"*/"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"if (groupTimeout != null && groupTimeout >= 0) {"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"if (groupTimeout > 0) {"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"ScheduledFuture<?> scheduledFuture = this.getTaskScheduler()"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,".schedule(new Runnable() {"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"@Override"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"public void run() {"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"try {"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"AbstractCorrelatingMessageHandler.this.forceComplete(messageGroup);"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"}"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"catch (MessageDeliveryException e) {"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"if (logger.isDebugEnabled()) {"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"logger.debug(""The MessageGroup [ "" + messageGroup +"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"""] is rescheduled by the reason: "" + e.getMessage());"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"}, new Date(System.currentTimeMillis() + groupTimeout));"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"logger.debug(""Schedule MessageGroup [ "" + messageGroup + ""] to 'forceComplete'."");"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"this.expireGroupScheduledFutures.put(UUIDConverter.getUUID(messageGroup.getGroupId()), scheduledFuture);"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"else {"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"forceComplete(messageGroup);"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"this.messagingTemplate.send(this.discardChannel, message);"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"ScheduledFuture<?> scheduledFuture ="
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"this.expireGroupScheduledFutures.remove(UUIDConverter.getUUID(correlationKey));"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"removeGroup = false;"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"logger.debug(""Group expiry candidate ("" + correlationKey +"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,""") has been affected by MessageDeliveryException - "" +"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"""it may be reconsidered for a future expiration one more time"");"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"throw e;"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"protected int findLastReleasedSequenceNumber(Object groupId, Collection<Message<?>> partialSequence) {"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,".size(), new Date(group.getLastModified()), new Date(), !sendPartialResultOnExpiry));"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"protected void verifyResultCollectionConsistsOfMessages(Collection<?> elements) {"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"Assert.isAssignable(Message.class, commonElementType,"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"""The expected collection of Messages contains non-Message element: "" + commonElementType);"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"else if (replyChannel instanceof String) {"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"CorrelationStrategy correlationStrategy, ReleaseStrategy releaseStrategy) {"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"this.correlationStrategy = correlationStrategy == null ?"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"new HeaderAttributeCorrelationStrategy(IntegrationMessageHeaderAccessor.CORRELATION_ID) : correlationStrategy;"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"""Release strategy of type ["" + this.releaseStrategy.getClass().getSimpleName()"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"+ ""] cannot release partial sequences. Use the default SequenceSizeReleaseStrategy instead."");"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"((SequenceSizeReleaseStrategy)this.releaseStrategy).setReleasePartialSequences(releasePartialSequences);"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"Assert.state(correlationKey!=null, ""Null correlation not allowed.  Maybe the CorrelationStrategy is failing?"");"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"logger.debug(""Cancel 'forceComplete' scheduling for MessageGroup with Correlation Key [ "" + correlationKey + ""]."");"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"if (this.sequenceAware){"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"Long groupTimeout = this.obtainGroupTimeout(messageGroup);"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"if (groupTimeout != null && groupTimeout >= 0) {"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"if (groupTimeout > 0) {"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"final MessageGroup messageGroupToSchedule = messageGroup;"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"scheduledFuture = this.getTaskScheduler()"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,".schedule(new Runnable() {"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"@Override"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"public void run() {"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"AbstractCorrelatingMessageHandler.this.forceComplete(messageGroupToSchedule);"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"}"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"}, new Date(System.currentTimeMillis() + groupTimeout));"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"if (logger.isDebugEnabled()) {"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"logger.debug(""Schedule MessageGroup [ "" + messageGroup + ""] to 'forceComplete'."");"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"this.expireGroupScheduledFutures.put(groupIdUuid, scheduledFuture);"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"else {"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"this.forceComplete(messageGroup);"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"this.discardChannel.send(message);"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"ScheduledFuture<?> scheduledFuture = this.expireGroupScheduledFutures.remove(UUIDConverter.getUUID(correlationKey));"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"protected int findLastReleasedSequenceNumber(Object groupId, Collection<Message<?>> partialSequence){"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,".size(), new Date(group.getLastModified()) , new Date(), !sendPartialResultOnExpiry));"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"protected void verifyResultCollectionConsistsOfMessages(Collection<?> elements){"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"Assert.isAssignable(Message.class, commonElementType, ""The expected collection of Messages contains non-Message element: "" + commonElementType);"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"} else {"
"1c051416ce75e69caa202d1c9153a7f77588a87b","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"} else if (replyChannel instanceof String) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import org.springframework.beans.BeansException;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import org.springframework.messaging.core.DestinationResolutionException;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"private volatile String requestChannelName;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"private volatile String replyChannelName;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"private volatile String errorChannelName;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"private final HistoryWritingMessagePostProcessor historyWritingPostProcessor ="
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"new HistoryWritingMessagePostProcessor();"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"/**"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* Set the request channel name."
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* @param requestChannelName the channel bean name to which request messages will be sent"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* @since 4.1"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"*/"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"public void setRequestChannelName(String requestChannelName) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"Assert.hasText(requestChannelName, ""'requestChannelName' must not be empty"");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.requestChannelName = requestChannelName;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"}"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* Set the reply channel name. If no reply channel is provided, this gateway will"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* always use an anonymous, temporary channel for handling replies."
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* @param replyChannelName the channel bean name from which reply messages will be received"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"public void setReplyChannelName(String replyChannelName) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"Assert.hasText(replyChannelName, ""'replyChannelName' must not be empty"");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.replyChannelName = replyChannelName;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* Set the error channel name. If no error channel is provided, this gateway will"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* propagate Exceptions to the caller. To completely suppress Exceptions, provide"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* a reference to the ""nullChannel"" here."
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* @param errorChannelName The error channel bean name."
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"public void setErrorChannelName(String errorChannelName) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"Assert.hasText(errorChannelName, ""'errorChannelName' must not be empty"");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.errorChannelName = errorChannelName;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"Assert.state(!(this.requestChannelName != null && this.requestChannel != null),"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"""'requestChannelName' and 'requestChannel' are mutually exclusive."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"Assert.state(!(this.replyChannelName != null && this.replyChannel != null),"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"""'replyChannelName' and 'replyChannel' are mutually exclusive."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"Assert.state(!(this.errorChannelName != null && this.errorChannel != null),"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"""'errorChannelName' and 'errorChannel' are mutually exclusive."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"private MessageChannel getRequestChannel() {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"if (this.requestChannelName != null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"synchronized (this) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"try {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"Assert.state(getBeanFactory() != null,"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"""A bean factory is required to resolve the requestChannel at runtime."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.requestChannel = getBeanFactory().getBean(this.requestChannelName, MessageChannel.class);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.requestChannelName = null;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"catch (BeansException e) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"throw new DestinationResolutionException(""Failed to look up MessageChannel with name '"""
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"+ this.requestChannelName + ""' in the BeanFactory."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"return this.requestChannel;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"private MessageChannel getReplyChannel() {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"if (this.replyChannelName != null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"""A bean factory is required to resolve the replyChannel at runtime."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.replyChannel = getBeanFactory().getBean(this.replyChannelName, MessageChannel.class);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.replyChannelName = null;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"+ this.replyChannelName + ""' in the BeanFactory."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"return this.replyChannel;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"private MessageChannel getErrorChannel() {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"if (this.errorChannelName != null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"""A bean factory is required to resolve the errorChannel at runtime."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.errorChannel = getBeanFactory().getBean(this.errorChannelName, MessageChannel.class);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.errorChannelName = null;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"+ this.errorChannelName + ""' in the BeanFactory."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"return this.errorChannel;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"MessageChannel requestChannel = getRequestChannel();"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"Assert.state(requestChannel != null,"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.messagingTemplate.convertAndSend(requestChannel, object, this.historyWritingPostProcessor);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"MessageChannel errorChannel = getErrorChannel();"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"if (errorChannel != null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.messagingTemplate.send(errorChannel, new ErrorMessage(e));"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"MessageChannel replyChannel = getReplyChannel();"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"Assert.state(replyChannel != null && (replyChannel instanceof PollableChannel),"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"return this.messagingTemplate.receiveAndConvert(replyChannel, null);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"if (requestChannel == null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"if (replyChannel != null && this.replyMessageCorrelator == null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"reply = this.messagingTemplate.convertSendAndReceive(requestChannel, object, null,"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.historyWritingPostProcessor);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"reply = this.messagingTemplate.sendAndReceive(requestChannel, requestMessage);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"errorFlowReply = this.messagingTemplate.sendAndReceive(errorChannel, errorMessage);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"throw new MessagingException(errorMessage, ""failure occurred in error-handling flow"","
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"errorFlowFailure);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"if (replyChannel instanceof SubscribableChannel) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"correlator = new EventDrivenConsumer((SubscribableChannel) replyChannel, handler);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"else if (replyChannel instanceof PollableChannel) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"PollingConsumer endpoint = new PollingConsumer((PollableChannel) replyChannel, handler);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"else {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"throw new MessagingException(""Unsupported 'replyChannel' type ["" + replyChannel.getClass() + ""]."""
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"+ ""SubscribableChannel or PollableChannel type are supported."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"private final HistoryWritingMessagePostProcessor historyWritingPostProcessor = new HistoryWritingMessagePostProcessor();"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"*"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"Assert.state(this.requestChannel != null,"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"this.messagingTemplate.convertAndSend(this.requestChannel, object, this.historyWritingPostProcessor);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"if (this.errorChannel != null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"this.messagingTemplate.send(this.errorChannel, new ErrorMessage(e));"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"Assert.state(this.replyChannel != null && (this.replyChannel instanceof PollableChannel),"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"return this.messagingTemplate.receiveAndConvert((PollableChannel) this.replyChannel, null);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"if (this.requestChannel == null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"if (this.replyChannel != null && this.replyMessageCorrelator == null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"reply = this.messagingTemplate.convertSendAndReceive(this.requestChannel, object, null, this.historyWritingPostProcessor);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"reply = this.messagingTemplate.sendAndReceive(this.requestChannel, requestMessage);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"errorFlowReply = this.messagingTemplate.sendAndReceive(this.errorChannel, errorMessage);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"throw new MessagingException(errorMessage, ""failure occurred in error-handling flow"", errorFlowFailure);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"if (this.replyChannel instanceof SubscribableChannel) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"correlator = new EventDrivenConsumer("
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"(SubscribableChannel) this.replyChannel, handler);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"else if (this.replyChannel instanceof PollableChannel) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"PollingConsumer endpoint = new PollingConsumer("
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"(PollableChannel) this.replyChannel, handler);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"import org.springframework.beans.BeansException;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"import org.springframework.messaging.core.DestinationResolutionException;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"private volatile String requestChannelName;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"private volatile String replyChannelName;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"private volatile String errorChannelName;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"private final HistoryWritingMessagePostProcessor historyWritingPostProcessor ="
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"new HistoryWritingMessagePostProcessor();"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"/**"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"* Set the request channel name."
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"* @param requestChannelName the channel bean name to which request messages will be sent"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"* @since 4.1"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"*/"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"public void setRequestChannelName(String requestChannelName) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"Assert.hasText(requestChannelName, ""'requestChannelName' must not be empty"");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"this.requestChannelName = requestChannelName;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"}"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"* Set the reply channel name. If no reply channel is provided, this gateway will"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"* always use an anonymous, temporary channel for handling replies."
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"* @param replyChannelName the channel bean name from which reply messages will be received"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"public void setReplyChannelName(String replyChannelName) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"Assert.hasText(replyChannelName, ""'replyChannelName' must not be empty"");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"this.replyChannelName = replyChannelName;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"* Set the error channel name. If no error channel is provided, this gateway will"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"* propagate Exceptions to the caller. To completely suppress Exceptions, provide"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"* a reference to the ""nullChannel"" here."
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"* @param errorChannelName The error channel bean name."
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"public void setErrorChannelName(String errorChannelName) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"Assert.hasText(errorChannelName, ""'errorChannelName' must not be empty"");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"this.errorChannelName = errorChannelName;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"Assert.state(!(this.requestChannelName != null && this.requestChannel != null),"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"""'requestChannelName' and 'requestChannel' are mutually exclusive."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"Assert.state(!(this.replyChannelName != null && this.replyChannel != null),"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"""'replyChannelName' and 'replyChannel' are mutually exclusive."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"Assert.state(!(this.errorChannelName != null && this.errorChannel != null),"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"""'errorChannelName' and 'errorChannel' are mutually exclusive."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"private MessageChannel getRequestChannel() {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"if (this.requestChannelName != null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"synchronized (this) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"try {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"Assert.state(getBeanFactory() != null,"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"""A bean factory is required to resolve the requestChannel at runtime."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"this.requestChannel = getBeanFactory().getBean(this.requestChannelName, MessageChannel.class);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"this.requestChannelName = null;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"catch (BeansException e) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"throw new DestinationResolutionException(""Failed to look up MessageChannel with name '"""
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"+ this.requestChannelName + ""' in the BeanFactory."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"return this.requestChannel;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"private MessageChannel getReplyChannel() {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"if (this.replyChannelName != null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"""A bean factory is required to resolve the replyChannel at runtime."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"this.replyChannel = getBeanFactory().getBean(this.replyChannelName, MessageChannel.class);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"this.replyChannelName = null;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"+ this.replyChannelName + ""' in the BeanFactory."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"return this.replyChannel;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"private MessageChannel getErrorChannel() {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"if (this.errorChannelName != null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"""A bean factory is required to resolve the errorChannel at runtime."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"this.errorChannel = getBeanFactory().getBean(this.errorChannelName, MessageChannel.class);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"this.errorChannelName = null;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"+ this.errorChannelName + ""' in the BeanFactory."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"return this.errorChannel;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"MessageChannel requestChannel = getRequestChannel();"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"Assert.state(requestChannel != null,"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"this.messagingTemplate.convertAndSend(requestChannel, object, this.historyWritingPostProcessor);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"MessageChannel errorChannel = getErrorChannel();"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"if (errorChannel != null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"this.messagingTemplate.send(errorChannel, new ErrorMessage(e));"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"MessageChannel replyChannel = getReplyChannel();"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"Assert.state(replyChannel != null && (replyChannel instanceof PollableChannel),"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"return this.messagingTemplate.receiveAndConvert(replyChannel, null);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"if (requestChannel == null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"if (replyChannel != null && this.replyMessageCorrelator == null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"reply = this.messagingTemplate.convertSendAndReceive(requestChannel, object, null,"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"this.historyWritingPostProcessor);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"reply = this.messagingTemplate.sendAndReceive(requestChannel, requestMessage);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"errorFlowReply = this.messagingTemplate.sendAndReceive(errorChannel, errorMessage);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"throw new MessagingException(errorMessage, ""failure occurred in error-handling flow"","
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"errorFlowFailure);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"if (replyChannel instanceof SubscribableChannel) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"correlator = new EventDrivenConsumer((SubscribableChannel) replyChannel, handler);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"else if (replyChannel instanceof PollableChannel) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"PollingConsumer endpoint = new PollingConsumer((PollableChannel) replyChannel, handler);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"else {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"throw new MessagingException(""Unsupported 'replyChannel' type ["" + replyChannel.getClass() + ""]."""
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"+ ""SubscribableChannel or PollableChannel type are supported."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"private final HistoryWritingMessagePostProcessor historyWritingPostProcessor = new HistoryWritingMessagePostProcessor();"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"*"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"Assert.state(this.requestChannel != null,"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"this.messagingTemplate.convertAndSend(this.requestChannel, object, this.historyWritingPostProcessor);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"if (this.errorChannel != null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"this.messagingTemplate.send(this.errorChannel, new ErrorMessage(e));"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"Assert.state(this.replyChannel != null && (this.replyChannel instanceof PollableChannel),"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"return this.messagingTemplate.receiveAndConvert((PollableChannel) this.replyChannel, null);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"if (this.requestChannel == null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"if (this.replyChannel != null && this.replyMessageCorrelator == null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"reply = this.messagingTemplate.convertSendAndReceive(this.requestChannel, object, null, this.historyWritingPostProcessor);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"reply = this.messagingTemplate.sendAndReceive(this.requestChannel, requestMessage);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"errorFlowReply = this.messagingTemplate.sendAndReceive(this.errorChannel, errorMessage);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"throw new MessagingException(errorMessage, ""failure occurred in error-handling flow"", errorFlowFailure);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"if (this.replyChannel instanceof SubscribableChannel) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"correlator = new EventDrivenConsumer("
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"(SubscribableChannel) this.replyChannel, handler);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"else if (this.replyChannel instanceof PollableChannel) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"PollingConsumer endpoint = new PollingConsumer("
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"(PollableChannel) this.replyChannel, handler);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import org.springframework.beans.BeansException;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import org.springframework.messaging.core.DestinationResolutionException;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private volatile String requestChannelName;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private volatile String replyChannelName;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private volatile String errorChannelName;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private final HistoryWritingMessagePostProcessor historyWritingPostProcessor ="
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"new HistoryWritingMessagePostProcessor();"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"/**"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"* Set the request channel name."
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"* @param requestChannelName the channel bean name to which request messages will be sent"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"* @since 4.1"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"*/"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"public void setRequestChannelName(String requestChannelName) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Assert.hasText(requestChannelName, ""'requestChannelName' must not be empty"");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"this.requestChannelName = requestChannelName;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"}"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"* Set the reply channel name. If no reply channel is provided, this gateway will"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"* always use an anonymous, temporary channel for handling replies."
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"* @param replyChannelName the channel bean name from which reply messages will be received"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"public void setReplyChannelName(String replyChannelName) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Assert.hasText(replyChannelName, ""'replyChannelName' must not be empty"");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"this.replyChannelName = replyChannelName;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"* Set the error channel name. If no error channel is provided, this gateway will"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"* propagate Exceptions to the caller. To completely suppress Exceptions, provide"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"* a reference to the ""nullChannel"" here."
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"* @param errorChannelName The error channel bean name."
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"public void setErrorChannelName(String errorChannelName) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Assert.hasText(errorChannelName, ""'errorChannelName' must not be empty"");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"this.errorChannelName = errorChannelName;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Assert.state(!(this.requestChannelName != null && this.requestChannel != null),"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"""'requestChannelName' and 'requestChannel' are mutually exclusive."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Assert.state(!(this.replyChannelName != null && this.replyChannel != null),"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"""'replyChannelName' and 'replyChannel' are mutually exclusive."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Assert.state(!(this.errorChannelName != null && this.errorChannel != null),"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"""'errorChannelName' and 'errorChannel' are mutually exclusive."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private MessageChannel getRequestChannel() {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (this.requestChannelName != null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"synchronized (this) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"try {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Assert.state(getBeanFactory() != null,"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"""A bean factory is required to resolve the requestChannel at runtime."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"this.requestChannel = getBeanFactory().getBean(this.requestChannelName, MessageChannel.class);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"this.requestChannelName = null;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"catch (BeansException e) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"throw new DestinationResolutionException(""Failed to look up MessageChannel with name '"""
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"+ this.requestChannelName + ""' in the BeanFactory."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return this.requestChannel;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private MessageChannel getReplyChannel() {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (this.replyChannelName != null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"""A bean factory is required to resolve the replyChannel at runtime."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"this.replyChannel = getBeanFactory().getBean(this.replyChannelName, MessageChannel.class);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"this.replyChannelName = null;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"+ this.replyChannelName + ""' in the BeanFactory."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return this.replyChannel;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private MessageChannel getErrorChannel() {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (this.errorChannelName != null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"""A bean factory is required to resolve the errorChannel at runtime."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"this.errorChannel = getBeanFactory().getBean(this.errorChannelName, MessageChannel.class);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"this.errorChannelName = null;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"+ this.errorChannelName + ""' in the BeanFactory."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return this.errorChannel;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"MessageChannel requestChannel = getRequestChannel();"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Assert.state(requestChannel != null,"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"this.messagingTemplate.convertAndSend(requestChannel, object, this.historyWritingPostProcessor);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"MessageChannel errorChannel = getErrorChannel();"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (errorChannel != null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"this.messagingTemplate.send(errorChannel, new ErrorMessage(e));"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"MessageChannel replyChannel = getReplyChannel();"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Assert.state(replyChannel != null && (replyChannel instanceof PollableChannel),"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return this.messagingTemplate.receiveAndConvert(replyChannel, null);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (requestChannel == null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (replyChannel != null && this.replyMessageCorrelator == null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"reply = this.messagingTemplate.convertSendAndReceive(requestChannel, object, null,"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"this.historyWritingPostProcessor);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"reply = this.messagingTemplate.sendAndReceive(requestChannel, requestMessage);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"errorFlowReply = this.messagingTemplate.sendAndReceive(errorChannel, errorMessage);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"throw new MessagingException(errorMessage, ""failure occurred in error-handling flow"","
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"errorFlowFailure);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (replyChannel instanceof SubscribableChannel) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"correlator = new EventDrivenConsumer((SubscribableChannel) replyChannel, handler);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"else if (replyChannel instanceof PollableChannel) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"PollingConsumer endpoint = new PollingConsumer((PollableChannel) replyChannel, handler);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"else {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"throw new MessagingException(""Unsupported 'replyChannel' type ["" + replyChannel.getClass() + ""]."""
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"+ ""SubscribableChannel or PollableChannel type are supported."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"private final HistoryWritingMessagePostProcessor historyWritingPostProcessor = new HistoryWritingMessagePostProcessor();"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"*"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"Assert.state(this.requestChannel != null,"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"this.messagingTemplate.convertAndSend(this.requestChannel, object, this.historyWritingPostProcessor);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"if (this.errorChannel != null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"this.messagingTemplate.send(this.errorChannel, new ErrorMessage(e));"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"Assert.state(this.replyChannel != null && (this.replyChannel instanceof PollableChannel),"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"return this.messagingTemplate.receiveAndConvert((PollableChannel) this.replyChannel, null);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"if (this.requestChannel == null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"if (this.replyChannel != null && this.replyMessageCorrelator == null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"reply = this.messagingTemplate.convertSendAndReceive(this.requestChannel, object, null, this.historyWritingPostProcessor);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"reply = this.messagingTemplate.sendAndReceive(this.requestChannel, requestMessage);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"errorFlowReply = this.messagingTemplate.sendAndReceive(this.errorChannel, errorMessage);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"throw new MessagingException(errorMessage, ""failure occurred in error-handling flow"", errorFlowFailure);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"if (this.replyChannel instanceof SubscribableChannel) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"correlator = new EventDrivenConsumer("
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"(SubscribableChannel) this.replyChannel, handler);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"else if (this.replyChannel instanceof PollableChannel) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"PollingConsumer endpoint = new PollingConsumer("
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"(PollableChannel) this.replyChannel, handler);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"import org.springframework.beans.BeansException;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"import org.springframework.messaging.core.DestinationResolutionException;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"private volatile String requestChannelName;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"private volatile String replyChannelName;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"private volatile String errorChannelName;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"private final HistoryWritingMessagePostProcessor historyWritingPostProcessor ="
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"new HistoryWritingMessagePostProcessor();"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"/**"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"* Set the request channel name."
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"* @param requestChannelName the channel bean name to which request messages will be sent"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"* @since 4.1"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"*/"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"public void setRequestChannelName(String requestChannelName) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"Assert.hasText(requestChannelName, ""'requestChannelName' must not be empty"");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"this.requestChannelName = requestChannelName;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"}"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"* Set the reply channel name. If no reply channel is provided, this gateway will"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"* always use an anonymous, temporary channel for handling replies."
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"* @param replyChannelName the channel bean name from which reply messages will be received"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"public void setReplyChannelName(String replyChannelName) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"Assert.hasText(replyChannelName, ""'replyChannelName' must not be empty"");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"this.replyChannelName = replyChannelName;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"* Set the error channel name. If no error channel is provided, this gateway will"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"* propagate Exceptions to the caller. To completely suppress Exceptions, provide"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"* a reference to the ""nullChannel"" here."
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"* @param errorChannelName The error channel bean name."
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"public void setErrorChannelName(String errorChannelName) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"Assert.hasText(errorChannelName, ""'errorChannelName' must not be empty"");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"this.errorChannelName = errorChannelName;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"Assert.state(!(this.requestChannelName != null && this.requestChannel != null),"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"""'requestChannelName' and 'requestChannel' are mutually exclusive."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"Assert.state(!(this.replyChannelName != null && this.replyChannel != null),"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"""'replyChannelName' and 'replyChannel' are mutually exclusive."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"Assert.state(!(this.errorChannelName != null && this.errorChannel != null),"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"""'errorChannelName' and 'errorChannel' are mutually exclusive."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"private MessageChannel getRequestChannel() {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"if (this.requestChannelName != null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"synchronized (this) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"try {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"Assert.state(getBeanFactory() != null,"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"""A bean factory is required to resolve the requestChannel at runtime."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"this.requestChannel = getBeanFactory().getBean(this.requestChannelName, MessageChannel.class);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"this.requestChannelName = null;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"catch (BeansException e) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"throw new DestinationResolutionException(""Failed to look up MessageChannel with name '"""
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"+ this.requestChannelName + ""' in the BeanFactory."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"return this.requestChannel;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"private MessageChannel getReplyChannel() {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"if (this.replyChannelName != null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"""A bean factory is required to resolve the replyChannel at runtime."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"this.replyChannel = getBeanFactory().getBean(this.replyChannelName, MessageChannel.class);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"this.replyChannelName = null;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"+ this.replyChannelName + ""' in the BeanFactory."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"return this.replyChannel;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"private MessageChannel getErrorChannel() {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"if (this.errorChannelName != null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"""A bean factory is required to resolve the errorChannel at runtime."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"this.errorChannel = getBeanFactory().getBean(this.errorChannelName, MessageChannel.class);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"this.errorChannelName = null;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"+ this.errorChannelName + ""' in the BeanFactory."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"return this.errorChannel;"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"MessageChannel requestChannel = getRequestChannel();"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"Assert.state(requestChannel != null,"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"this.messagingTemplate.convertAndSend(requestChannel, object, this.historyWritingPostProcessor);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"MessageChannel errorChannel = getErrorChannel();"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"if (errorChannel != null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"this.messagingTemplate.send(errorChannel, new ErrorMessage(e));"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"MessageChannel replyChannel = getReplyChannel();"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"Assert.state(replyChannel != null && (replyChannel instanceof PollableChannel),"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"return this.messagingTemplate.receiveAndConvert(replyChannel, null);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"if (requestChannel == null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"if (replyChannel != null && this.replyMessageCorrelator == null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"reply = this.messagingTemplate.convertSendAndReceive(requestChannel, object, null,"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"this.historyWritingPostProcessor);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"reply = this.messagingTemplate.sendAndReceive(requestChannel, requestMessage);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"errorFlowReply = this.messagingTemplate.sendAndReceive(errorChannel, errorMessage);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"throw new MessagingException(errorMessage, ""failure occurred in error-handling flow"","
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"errorFlowFailure);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"if (replyChannel instanceof SubscribableChannel) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"correlator = new EventDrivenConsumer((SubscribableChannel) replyChannel, handler);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"else if (replyChannel instanceof PollableChannel) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"PollingConsumer endpoint = new PollingConsumer((PollableChannel) replyChannel, handler);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"else {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"throw new MessagingException(""Unsupported 'replyChannel' type ["" + replyChannel.getClass() + ""]."""
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","added",0,"+ ""SubscribableChannel or PollableChannel type are supported."");"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","deleted",1,"private final HistoryWritingMessagePostProcessor historyWritingPostProcessor = new HistoryWritingMessagePostProcessor();"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","deleted",1,"*"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","deleted",1,"Assert.state(this.requestChannel != null,"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","deleted",1,"this.messagingTemplate.convertAndSend(this.requestChannel, object, this.historyWritingPostProcessor);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","deleted",1,"if (this.errorChannel != null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","deleted",1,"this.messagingTemplate.send(this.errorChannel, new ErrorMessage(e));"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","deleted",1,"Assert.state(this.replyChannel != null && (this.replyChannel instanceof PollableChannel),"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","deleted",1,"return this.messagingTemplate.receiveAndConvert((PollableChannel) this.replyChannel, null);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","deleted",1,"if (this.requestChannel == null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","deleted",1,"if (this.replyChannel != null && this.replyMessageCorrelator == null) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","deleted",1,"reply = this.messagingTemplate.convertSendAndReceive(this.requestChannel, object, null, this.historyWritingPostProcessor);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","deleted",1,"reply = this.messagingTemplate.sendAndReceive(this.requestChannel, requestMessage);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","deleted",1,"errorFlowReply = this.messagingTemplate.sendAndReceive(this.errorChannel, errorMessage);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","deleted",1,"throw new MessagingException(errorMessage, ""failure occurred in error-handling flow"", errorFlowFailure);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","deleted",1,"if (this.replyChannel instanceof SubscribableChannel) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","deleted",1,"correlator = new EventDrivenConsumer("
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","deleted",1,"(SubscribableChannel) this.replyChannel, handler);"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","deleted",1,"else if (this.replyChannel instanceof PollableChannel) {"
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","deleted",1,"PollingConsumer endpoint = new PollingConsumer("
"7f74c571d47cfab8aac159fe81db5cc963a55d4c","3e2d09e5d7ea745c115c6789c858359f30e12227","deleted",1,"(PollableChannel) this.replyChannel, handler);"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import org.springframework.core.annotation.AnnotationAttributes;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import org.springframework.messaging.handler.annotation.Header;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import org.springframework.messaging.handler.annotation.Headers;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import org.springframework.messaging.handler.annotation.Payload;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Assert.state(context.getTypeConverter()"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".canConvert(TypeDescriptor.valueOf(((Method) method).getReturnType()),"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private boolean canReturnExpectedType(AnnotatedMethodFilter filter, Class<?> targetType,"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"TypeConverter typeConverter) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (typeConverter.canConvert(TypeDescriptor.valueOf(method.getReturnType()),"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"TypeDescriptor.valueOf(expectedType))) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"logger.debug(targetObject.getClass() +"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,""": Ambiguous fallback methods; using RequestReplyExchanger.exchange()"");"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""Target object of type ["" + this.targetObject.getClass() +"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""] has no eligible methods for handling Messages."");"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private static final ParameterNameDiscoverer PARAMETER_NAME_DISCOVERER ="
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"new LocalVariableTableParameterNameDiscoverer();"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"@SuppressWarnings(""deprecation"")"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Annotation mappingAnnotation ="
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"MessagingAnnotationUtils.findMessagePartAnnotation(parameterAnnotations[i]);"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (annotationType.equals(org.springframework.integration.annotation.Payload.class)"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"|| annotationType.equals(Payload.class)) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"String qualifierExpression = (String) AnnotationUtils.getValue(mappingAnnotation);"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"else if (annotationType.equals(org.springframework.integration.annotation.Headers.class)"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"|| annotationType.equals(Headers.class)) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"else if (annotationType.equals(org.springframework.integration.annotation.Header.class)"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"|| annotationType.equals(Header.class)) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"sb.append(this.determineHeaderExpression(mappingAnnotation, methodParameter));"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"else if ((parameterTypeDescriptor.isAssignableTo(messageListTypeDescriptor)"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"|| parameterTypeDescriptor.isAssignableTo(messageArrayTypeDescriptor))) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private String determineHeaderExpression(Annotation headerAnnotation, MethodParameter methodParameter) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"AnnotationAttributes annotationAttributes ="
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"(AnnotationAttributes) AnnotationUtils.getAnnotationAttributes(headerAnnotation);"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"String valueAttribute = annotationAttributes.getString(AnnotationUtils.VALUE);"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"String fallbackExpression = (annotationAttributes.getBoolean(""required""))"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"? ""T(org.springframework.util.Assert).isTrue(false, 'required header not available: """
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"+ headerName + ""')"""
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private synchronized void setExclusiveTargetParameterType(TypeDescriptor targetParameterType,"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"MethodParameter methodParameter) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import org.springframework.integration.annotation.Header;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import org.springframework.integration.annotation.Headers;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import org.springframework.integration.annotation.Payload;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import org.springframework.messaging.MessagingException;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.state(context.getTypeConverter().canConvert(TypeDescriptor.valueOf(((Method) method).getReturnType()),"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private boolean canReturnExpectedType(AnnotatedMethodFilter filter, Class<?> targetType, TypeConverter typeConverter) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (typeConverter.canConvert(TypeDescriptor.valueOf(method.getReturnType()), TypeDescriptor.valueOf(expectedType))) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"logger.debug(targetObject.getClass() + "": Ambiguous fallback methods; using RequestReplyExchanger.exchange()"");"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""Target object of type ["" + this.targetObject.getClass() + ""] has no eligible methods for handling Messages."");"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private static final ParameterNameDiscoverer PARAMETER_NAME_DISCOVERER = new LocalVariableTableParameterNameDiscoverer();"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Annotation mappingAnnotation = findMappingAnnotation(parameterAnnotations[i]);"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (annotationType.equals(Payload.class)) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"String qualifierExpression = ((Payload) mappingAnnotation).value();"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"else if (annotationType.equals(Headers.class)) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"else if (annotationType.equals(Header.class)) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Header headerAnnotation = (Header) mappingAnnotation;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"sb.append(this.determineHeaderExpression(headerAnnotation, methodParameter));"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"else if ((parameterTypeDescriptor.isAssignableTo(messageListTypeDescriptor) || parameterTypeDescriptor"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".isAssignableTo(messageArrayTypeDescriptor))) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private Annotation findMappingAnnotation(Annotation[] annotations) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (annotations == null || annotations.length == 0) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return null;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"}"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Annotation match = null;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"for (Annotation annotation : annotations) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Class<? extends Annotation> type = annotation.annotationType();"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (type.equals(Payload.class) || type.equals(Payloads.class) || type.equals(Header.class) || type.equals(Headers.class)) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (match != null) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"throw new MessagingException("
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""At most one parameter annotation can be provided for message mapping, """
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"+ ""but found two: ["" + match.annotationType().getName() + ""] and ["""
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"+ annotation.annotationType().getName() + ""]"");"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"match = annotation;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return match;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private String determineHeaderExpression(Header headerAnnotation, MethodParameter methodParameter) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"String valueAttribute = headerAnnotation.value();"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"String fallbackExpression = (headerAnnotation.required())"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"? ""T(org.springframework.util.Assert).isTrue(false, 'required header not available:  "" + headerName + ""')"""
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private synchronized void setExclusiveTargetParameterType(TypeDescriptor targetParameterType, MethodParameter methodParameter) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"* Copyright 2002-2014 the original author or authors."
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import static org.hamcrest.CoreMatchers.is;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import static org.junit.Assert.assertEquals;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import static org.junit.Assert.assertThat;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import static org.junit.Assert.assertTrue;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import static org.junit.Assert.fail;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import static org.mockito.Mockito.when;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import org.springframework.messaging.Message;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import org.springframework.messaging.handler.annotation.Header;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import org.springframework.messaging.handler.annotation.Headers;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import org.springframework.messaging.support.GenericMessage;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"* Copyright 2002-2013 the original author or authors."
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import org.springframework.messaging.Message;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import org.springframework.integration.annotation.Header;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import org.springframework.integration.annotation.Headers;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import org.springframework.messaging.support.GenericMessage;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import static org.junit.Assert.assertTrue;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import static org.hamcrest.CoreMatchers.is;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import static org.junit.Assert.assertEquals;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import static org.junit.Assert.assertThat;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import static org.junit.Assert.fail;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import static org.mockito.Mockito.when;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"* Copyright 2002-2014 the original author or authors."
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"import org.springframework.messaging.handler.annotation.Header;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"public String test(String str, @Header(IntegrationMessageHeaderAccessor.PRIORITY) int priority,"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"@Header(""$custom"") String custom);"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"* Copyright 2002-2010 the original author or authors."
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"import org.springframework.integration.annotation.Header;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"public String test(String str, @Header(IntegrationMessageHeaderAccessor.PRIORITY) int priority, @Header(""$custom"") String custom);"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","564860bde313c8ac335bfecad2118f97c8e0f6ab","added",0,"* Copyright 2002-2014 the original author or authors."
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","564860bde313c8ac335bfecad2118f97c8e0f6ab","added",0,"import org.springframework.messaging.handler.annotation.Header;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","564860bde313c8ac335bfecad2118f97c8e0f6ab","added",0,"public String test(String str, @Header(IntegrationMessageHeaderAccessor.PRIORITY) int priority,"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","564860bde313c8ac335bfecad2118f97c8e0f6ab","added",0,"@Header(""$custom"") String custom);"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","564860bde313c8ac335bfecad2118f97c8e0f6ab","deleted",1,"* Copyright 2002-2010 the original author or authors."
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","564860bde313c8ac335bfecad2118f97c8e0f6ab","deleted",1,"import org.springframework.integration.annotation.Header;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","564860bde313c8ac335bfecad2118f97c8e0f6ab","deleted",1,"public String test(String str, @Header(IntegrationMessageHeaderAccessor.PRIORITY) int priority, @Header(""$custom"") String custom);"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","d5a80421ecccc176df5f01361c9a463a47445259","added",0,"* Copyright 2002-2014 the original author or authors."
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","d5a80421ecccc176df5f01361c9a463a47445259","added",0,"import org.springframework.messaging.handler.annotation.Payload;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","d5a80421ecccc176df5f01361c9a463a47445259","deleted",1,"* Copyright 2002-2013 the original author or authors."
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","d5a80421ecccc176df5f01361c9a463a47445259","deleted",1,"import org.springframework.integration.annotation.Payload;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"import org.springframework.messaging.handler.annotation.Header;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"public String appendFoo(Object payload, @Header(""foo"") Object header) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"public String evalCorrelationId(@Header(IntegrationMessageHeaderAccessor.CORRELATION_ID + "".toUpperCase()"") String result) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"return result;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"import org.springframework.integration.annotation.Header;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"public String appendFoo(Object payload, @Header(value = ""foo"") Object header) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"public String evalCorrelationId(@Header(value = IntegrationMessageHeaderAccessor.CORRELATION_ID + "".toUpperCase()"") String result) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"return result.toString();"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* Copyright 2002-2014 the original author or authors."
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import org.springframework.messaging.handler.annotation.Header;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import org.springframework.messaging.support.GenericMessage;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"router.handleMessage(badMessage);"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"fail();"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"}"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"catch (MessageDeliveryException e) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"private void doTestChannelInstanceResolutionByPayload(MethodInvokingRouter router,"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"TestChannelResolver channelResolver) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"private void doTestChannelInstanceResolutionByMessage(MethodInvokingRouter router,"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"private void doTestMultiChannelNameResolutionByPayload(MethodInvokingRouter router,"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"private void doTestMultiChannelNameResolutionByMessage(MethodInvokingRouter router,"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"private void doTestMultiChannelNameArrayResolutionByMessage(MethodInvokingRouter router,"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"private void doTestMultiChannelListResolutionByPayload(MethodInvokingRouter router,"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"private void doTestMultiChannelListResolutionByMessage(MethodInvokingRouter router,"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"private void doTestMultiChannelArrayResolutionByMessage(MethodInvokingRouter router,"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"* Copyright 2002-2011 the original author or authors."
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"import org.springframework.integration.annotation.Header;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"import org.springframework.messaging.support.GenericMessage;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"router.handleMessage(badMessage);"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"fail();"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"} catch (MessageDeliveryException e) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"private void doTestChannelInstanceResolutionByPayload(MethodInvokingRouter router, TestChannelResolver channelResolver) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"private void doTestChannelInstanceResolutionByMessage(MethodInvokingRouter router, TestChannelResolver channelResolver) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"private void doTestMultiChannelNameResolutionByPayload(MethodInvokingRouter router, TestChannelResolver channelResolver) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"private void doTestMultiChannelNameResolutionByMessage(MethodInvokingRouter router, TestChannelResolver channelResolver) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"private void doTestMultiChannelNameArrayResolutionByMessage(MethodInvokingRouter router, TestChannelResolver channelResolver) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"private void doTestMultiChannelListResolutionByPayload(MethodInvokingRouter router, TestChannelResolver channelResolver) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"private void doTestMultiChannelListResolutionByMessage(MethodInvokingRouter router, TestChannelResolver channelResolver) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"private void doTestMultiChannelArrayResolutionByMessage(MethodInvokingRouter router, TestChannelResolver channelResolver) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"* Copyright 2002-2014 the original author or authors."
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"import org.springframework.messaging.handler.annotation.Header;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"import org.springframework.messaging.support.GenericMessage;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"router.handleMessage(badMessage);"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"fail();"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"}"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"catch (MessageDeliveryException e) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"private void doTestChannelInstanceResolutionByPayload(MethodInvokingRouter router,"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"TestChannelResolver channelResolver) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"private void doTestChannelInstanceResolutionByMessage(MethodInvokingRouter router,"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"private void doTestMultiChannelNameResolutionByPayload(MethodInvokingRouter router,"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"private void doTestMultiChannelNameResolutionByMessage(MethodInvokingRouter router,"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"private void doTestMultiChannelNameArrayResolutionByMessage(MethodInvokingRouter router,"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"private void doTestMultiChannelListResolutionByPayload(MethodInvokingRouter router,"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"private void doTestMultiChannelListResolutionByMessage(MethodInvokingRouter router,"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"private void doTestMultiChannelArrayResolutionByMessage(MethodInvokingRouter router,"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"* Copyright 2002-2011 the original author or authors."
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"import org.springframework.integration.annotation.Header;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"import org.springframework.messaging.support.GenericMessage;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"router.handleMessage(badMessage);"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"fail();"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"} catch (MessageDeliveryException e) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"private void doTestChannelInstanceResolutionByPayload(MethodInvokingRouter router, TestChannelResolver channelResolver) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"private void doTestChannelInstanceResolutionByMessage(MethodInvokingRouter router, TestChannelResolver channelResolver) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"private void doTestMultiChannelNameResolutionByPayload(MethodInvokingRouter router, TestChannelResolver channelResolver) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"private void doTestMultiChannelNameResolutionByMessage(MethodInvokingRouter router, TestChannelResolver channelResolver) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"private void doTestMultiChannelNameArrayResolutionByMessage(MethodInvokingRouter router, TestChannelResolver channelResolver) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"private void doTestMultiChannelListResolutionByPayload(MethodInvokingRouter router, TestChannelResolver channelResolver) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"private void doTestMultiChannelListResolutionByMessage(MethodInvokingRouter router, TestChannelResolver channelResolver) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"private void doTestMultiChannelArrayResolutionByMessage(MethodInvokingRouter router, TestChannelResolver channelResolver) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"* Copyright 2002-2014 the original author or authors."
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"import java.util.Collections;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"import org.springframework.messaging.Message;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"import org.springframework.messaging.handler.annotation.Header;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"import org.springframework.messaging.support.GenericMessage;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Collections.addAll(results, payload.split(regex));"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Collections.addAll(results, header.split(regex));"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"* Copyright 2002-2010 the original author or authors."
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"import org.springframework.messaging.Message;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"import org.springframework.integration.annotation.Header;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"import org.springframework.messaging.support.GenericMessage;"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,";"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"for (String s : payload.split(regex)) {"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"results.add(s);"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"}"
"00c404f383c1d998c0293f5f37ff5a7cdb2223d0","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"for (String s : header.split(regex)) {"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"* Copyright 2013-2014 the original author or authors."
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"import java.util.Map;"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"* @author Artem Bilan"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"public static final String ROUTING_SLIP = ""routingSlip"";"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"|| IntegrationMessageHeaderAccessor.SEQUENCE_SIZE.equals(headerName)"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"|| IntegrationMessageHeaderAccessor.PRIORITY.equals(headerName)) {"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"else if (IntegrationMessageHeaderAccessor.ROUTING_SLIP.equals(headerName)) {"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"Assert.isTrue(Map.class.isAssignableFrom(headerValue.getClass()), ""The '"" + headerName"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"+ ""' header value must be an List."");"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"* Copyright 2013 the original author or authors."
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"|| IntegrationMessageHeaderAccessor.SEQUENCE_SIZE.equals(headerName)) {"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"else if (IntegrationMessageHeaderAccessor.PRIORITY.equals(headerName)) {"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"Assert.isTrue(Integer.class.isAssignableFrom(headerValue.getClass()), ""The '"" + headerName"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"+ ""' header value must be an Integer."");"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"import static org.hamcrest.Matchers.instanceOf;"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"import static org.junit.Assert.assertThat;"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"import java.util.List;"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"import org.springframework.integration.routingslip.ExpressionEvaluatingRoutingSlipRouteStrategy;"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"assertEquals(123L, correlationId);"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"assertEquals(123, new IntegrationMessageHeaderAccessor(result).getCorrelationId());"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"Message<?> result = template.sendAndReceive(channel,"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"new GenericMessage<Map<String, String>>(Collections.singletonMap(""priority"", ""-10"")));"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"assertEquals(12345L, result.getHeaders().get(""number""));"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"new ClassPathXmlApplicationContext(""HeaderEnricherWithUnexpectedSubElementForHeader-fail-context.xml"","
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"this.getClass());"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"@Test"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"public void testRoutingSlip() {"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"MessagingTemplate template = new MessagingTemplate();"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"MessageChannel channel = context.getBean(""routingSlipInput"", MessageChannel.class);"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"Message<?> result = template.sendAndReceive(channel, new GenericMessage<String>(""test""));"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"assertNotNull(result);"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"Object routingSlip = new IntegrationMessageHeaderAccessor(result)"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,".getHeader(IntegrationMessageHeaderAccessor.ROUTING_SLIP);"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"assertNotNull(routingSlip);"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"assertThat(routingSlip, instanceOf(Map.class));"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"@SuppressWarnings(""unchecked"")"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"List<Object> routingSlipPath = (List<Object>) ((Map) routingSlip).keySet().iterator().next();"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"assertEquals(""fooChannel"", routingSlipPath.get(0));"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"assertThat(routingSlipPath.get(1), instanceOf(ExpressionEvaluatingRoutingSlipRouteStrategy.class));"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"assertEquals(""bazRoutingSlip"", routingSlipPath.get(2));"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"}"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"return !(name != null ? !name.equals(testBean.name) : testBean.name != null);"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"assertEquals(new Long(123), correlationId);"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"assertEquals(new Integer(123), new IntegrationMessageHeaderAccessor(result).getCorrelationId());"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"Message<?> result = template.sendAndReceive(channel, new GenericMessage<Map<String, String>>(Collections.singletonMap(""priority"", ""-10"")));"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"assertEquals(new Long(12345), result.getHeaders().get(""number""));"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"new ClassPathXmlApplicationContext(""HeaderEnricherWithUnexpectedSubElementForHeader-fail-context.xml"", this.getClass());"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"if (name != null ? !name.equals(testBean.name) : testBean.name != null) return false;"
"fa03c6f2686e9aa799c00ccb851c74cf196b9a84","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"return true;"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* Copyright 2002-2015 the original author or authors."
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* Connection factory that caches connections from the underlying target factory. The underlying"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* factory will be reconfigured to have {@code singleUse=true} in order for the connection to be"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* returned to the cache after use. Users should not subsequently set the underlying property to"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* false, or cache starvation will result."
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"*"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"/**"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* Construct a caching connection factory that delegates to the provided factory, with"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* the provided pool size."
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* @param target the target factory."
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* @param poolSize the number of connections to allow."
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"*/"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.pool = new SimplePool<TcpConnectionSupport>(poolSize,"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"new SimplePool.PoolItemCallback<TcpConnectionSupport>() {"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"@Override"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"public TcpConnectionSupport createForPool() {"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"try {"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return targetConnectionFactory.getConnection();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"}"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"catch (Exception e) {"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"throw new MessagingException(""Failed to obtain connection"", e);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"public boolean isStale(TcpConnectionSupport connection) {"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return !connection.isOpen();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"public void removedFromPool(TcpConnectionSupport connection) {"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"connection.close();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"});"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* @param connectionWaitTimeout the new timeout."
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* @see SimplePool#setWaitTimeout(long)"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* @param poolSize the new pool size."
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* @see SimplePool#setPoolSize(int)"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* @see SimplePool#getPoolSize()"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* @return the pool size."
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* @see SimplePool#getIdleCount()"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* @return the idle count."
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* @see SimplePool#getActiveCount()"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* @return the active count."
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* @see SimplePool#getAllocatedCount()"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* @return the allocated count."
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"cachedConnection.registerListener(getListener());"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"if (this.released) {"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"logger.debug(""Connection "" + getConnectionId() + "" has already been released"");"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"else {"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"if (logger.isDebugEnabled()) {"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"logger.debug(""Factory not running - closing "" + getConnectionId());"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"pool.releaseItem(getTheConnection());"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return getConnectionId();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"AbstractIntegrationMessageBuilder<?> messageBuilder ="
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"CachingClientConnectionFactory.this.getMessageBuilderFactory()"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,".fromMessage(message)"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,".setHeader(IpHeaders.CONNECTION_ID, getConnectionId());"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"getListener().onMessage(messageBuilder.build());"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"getTheConnection().close();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return this.targetConnectionFactory.isRunning();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return this.targetConnectionFactory.hashCode();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.targetConnectionFactory.setComponentName(componentName);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return this.targetConnectionFactory.getComponentType();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"public boolean equals(Object o) {"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"if (this == o) return true;"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"if (o == null || getClass() != o.getClass()) return false;"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"CachingClientConnectionFactory that = (CachingClientConnectionFactory) o;"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return this.targetConnectionFactory.equals(that.targetConnectionFactory);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return this.targetConnectionFactory.getSoTimeout();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.targetConnectionFactory.setSoTimeout(soTimeout);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return this.targetConnectionFactory.getSoReceiveBufferSize();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.targetConnectionFactory.setSoReceiveBufferSize(soReceiveBufferSize);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return this.targetConnectionFactory.getSoSendBufferSize();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.targetConnectionFactory.setSoSendBufferSize(soSendBufferSize);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return this.targetConnectionFactory.isSoTcpNoDelay();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.targetConnectionFactory.setSoTcpNoDelay(soTcpNoDelay);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return this.targetConnectionFactory.getSoLinger();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.targetConnectionFactory.setSoLinger(soLinger);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return this.targetConnectionFactory.isSoKeepAlive();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.targetConnectionFactory.setSoKeepAlive(soKeepAlive);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return this.targetConnectionFactory.getSoTrafficClass();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.targetConnectionFactory.setSoTrafficClass(soTrafficClass);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return this.targetConnectionFactory.getHost();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return this.targetConnectionFactory.getPort();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return this.targetConnectionFactory.getSender();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return this.targetConnectionFactory.getSerializer();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return this.targetConnectionFactory.getDeserializer();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return this.targetConnectionFactory.getMapper();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.targetConnectionFactory.registerListener(new TcpListener() {"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.targetConnectionFactory.registerSender(sender);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.targetConnectionFactory.setTaskExecutor(taskExecutor);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.targetConnectionFactory.setDeserializer(deserializer);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.targetConnectionFactory.setSerializer(serializer);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.targetConnectionFactory.setMapper(mapper);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return this.targetConnectionFactory.isSingleUse();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* Ignored on this factory; connections are always cached in the pool. The underlying"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* connection factory will have its singleUse property coerced to true (causing the"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* connection to be returned). Setting it to false on the underlying factory after initialization"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* will cause cache starvation."
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* @param singleUse the singleUse."
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"if (!singleUse && logger.isDebugEnabled()) {"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"logger.debug(""singleUse=false is not supported; cached connections are never closed"");"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"public void setInterceptorFactoryChain(TcpConnectionInterceptorFactoryChain interceptorFactoryChain) {"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.targetConnectionFactory.setInterceptorFactoryChain(interceptorFactoryChain);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.targetConnectionFactory.setLookupHost(lookupHost);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return this.targetConnectionFactory.isLookupHost();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"setActive(true);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.targetConnectionFactory.start();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.targetConnectionFactory.stop();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return this.targetConnectionFactory.getPhase();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return this.targetConnectionFactory.isAutoStartup();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.targetConnectionFactory.stop(callback);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"* Copyright 2002-2014 the original author or authors."
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"pool = new SimplePool<TcpConnectionSupport>(poolSize, new SimplePool.PoolItemCallback<TcpConnectionSupport>() {"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"@Override"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"public TcpConnectionSupport createForPool() {"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"try {"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return targetConnectionFactory.getConnection();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"} catch (Exception e) {"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"throw new MessagingException(""Failed to obtain connection"", e);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"}"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"public boolean isStale(TcpConnectionSupport connection) {"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return !connection.isOpen();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"public void removedFromPool(TcpConnectionSupport connection) {"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"connection.close();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"});"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"cachedConnection.registerListener(this.getListener());"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"if(this.released) {"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"logger.debug(""Connection "" + this.getConnectionId() + "" has already been released"");"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"else  {"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"if (logger.isDebugEnabled()){"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"logger.debug(""Factory not running - closing "" + this.getConnectionId());"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"pool.releaseItem(this.getTheConnection());"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return this.getConnectionId();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"AbstractIntegrationMessageBuilder<?> messageBuilder = CachingClientConnectionFactory.this"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,".getMessageBuilderFactory().fromMessage(message)"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,".setHeader(IpHeaders.CONNECTION_ID, this.getConnectionId());"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"this.getListener().onMessage(messageBuilder.build());"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"this.getTheConnection().close();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return targetConnectionFactory.isRunning();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return targetConnectionFactory.hashCode();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"targetConnectionFactory.setComponentName(componentName);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return targetConnectionFactory.getComponentType();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"public boolean equals(Object obj) {"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return targetConnectionFactory.equals(obj);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return targetConnectionFactory.getSoTimeout();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"targetConnectionFactory.setSoTimeout(soTimeout);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return targetConnectionFactory.getSoReceiveBufferSize();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"targetConnectionFactory.setSoReceiveBufferSize(soReceiveBufferSize);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return targetConnectionFactory.getSoSendBufferSize();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"targetConnectionFactory.setSoSendBufferSize(soSendBufferSize);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return targetConnectionFactory.isSoTcpNoDelay();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"targetConnectionFactory.setSoTcpNoDelay(soTcpNoDelay);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return targetConnectionFactory.getSoLinger();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"targetConnectionFactory.setSoLinger(soLinger);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return targetConnectionFactory.isSoKeepAlive();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"targetConnectionFactory.setSoKeepAlive(soKeepAlive);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return targetConnectionFactory.getSoTrafficClass();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"targetConnectionFactory.setSoTrafficClass(soTrafficClass);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return targetConnectionFactory.getHost();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return targetConnectionFactory.getPort();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return targetConnectionFactory.getSender();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return targetConnectionFactory.getSerializer();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return targetConnectionFactory.getDeserializer();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return targetConnectionFactory.getMapper();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"targetConnectionFactory.registerListener(new TcpListener() {"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"targetConnectionFactory.registerSender(sender);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"targetConnectionFactory.setTaskExecutor(taskExecutor);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"targetConnectionFactory.setDeserializer(deserializer);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"targetConnectionFactory.setSerializer(serializer);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"targetConnectionFactory.setMapper(mapper);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return targetConnectionFactory.isSingleUse();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"targetConnectionFactory.setSingleUse(singleUse);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"public void setInterceptorFactoryChain("
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"TcpConnectionInterceptorFactoryChain interceptorFactoryChain) {"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"targetConnectionFactory"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,".setInterceptorFactoryChain(interceptorFactoryChain);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"targetConnectionFactory.setLookupHost(lookupHost);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return targetConnectionFactory.isLookupHost();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"this.setActive(true);"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"targetConnectionFactory.start();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"targetConnectionFactory.stop();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return targetConnectionFactory.getPhase();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return targetConnectionFactory.isAutoStartup();"
"b56a56e8e630295dc05a388defd775559836236e","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"targetConnectionFactory.stop(callback);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"Message<?> message = document.getMessage();"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"if (message.getHeaders().containsKey(SAVED_KEY)) {"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"Message<?> saved = getMessage(message.getHeaders().getId());"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"if (saved != null) {"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"if (saved.equals(message)) {"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"return;"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"} // We need to save it under its own id"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"}"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"final long createdDate = document.get_Group_timestamp() == 0"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"? System.currentTimeMillis()"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,": document.get_Group_timestamp();"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"Message<?> result = getMessageBuilderFactory().fromMessage(message).setHeader(SAVED_KEY, Boolean.TRUE)"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,".setHeader(CREATED_DATE_KEY, createdDate).build();"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"@SuppressWarnings(""unchecked"")"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"Map<String, Object> innerMap ="
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"(Map<String, Object>) new DirectFieldAccessor(result.getHeaders()).getPropertyValue(""headers"");"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"// using reflection to set ID since it is immutable through MessageHeaders"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"innerMap.put(MessageHeaders.ID, message.getHeaders().get(MessageHeaders.ID));"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"innerMap.put(MessageHeaders.TIMESTAMP, message.getHeaders().get(MessageHeaders.TIMESTAMP));"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"document.set_Group_timestamp(createdDate);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"template.insert(document, collectionName);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"MessageWrapper messageWrapper ="
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"this.template.findOne(whereMessageIdIs(id), MessageWrapper.class, this.collectionName);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"this.template.findAndRemove(whereMessageIdIs(id), MessageWrapper.class, this.collectionName);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"return (messageWrapper != null ? messageWrapper.getMessage() : null);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"Query query = whereGroupIdOrder(groupId);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"MessageWrapper messageDocument = template.findOne(query, MessageWrapper.class, collectionName);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"long createdTime = 0;"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"int lastReleasedSequence = 0;"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"boolean complete = false;"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"if (messageDocument != null) {"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"createdTime = messageDocument.get_Group_timestamp();"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"lastReleasedSequence = messageDocument.get_LastReleasedSequenceNumber();"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"complete = messageDocument.get_Group_complete();"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"MessageWrapper wrapper = new MessageWrapper(message);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"wrapper.set_GroupId(groupId);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"wrapper.set_Group_timestamp(createdTime == 0 ? System.currentTimeMillis() : createdTime);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"wrapper.set_Group_update_timestamp(System.currentTimeMillis());"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"wrapper.set_Group_complete(complete);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"wrapper.set_LastReleasedSequenceNumber(lastReleasedSequence);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"wrapper.setSequence(getNextId());"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"addMessageDocument(wrapper);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"return getMessageGroup(groupId);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"template.findAndRemove(whereMessageIdIsAndGroupIdIs(messageToRemove.getHeaders().getId(), groupId),"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"MessageWrapper.class, collectionName);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"updateGroup(groupId, lastModifiedUpdate());"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"List<MessageGroup> messageGroups = new ArrayList<MessageGroup>();"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"Query query = Query.query(Criteria.where(GROUP_ID_KEY).exists(true));"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"@SuppressWarnings(""rawtypes"")"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"List groupIds = template.getCollection(collectionName)"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,".distinct(GROUP_ID_KEY, query.getQueryObject());"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"for (Object groupId : groupIds) {"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"messageGroups.add(getMessageGroup(groupId));"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"return messageGroups.iterator();"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"Query query = whereGroupIdIs(groupId).with(new Sort(GROUP_UPDATE_TIMESTAMP_KEY, SEQUENCE));"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"MessageWrapper messageWrapper = template.findAndRemove(query, MessageWrapper.class, collectionName);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"Message<?> message = null;"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"if (messageWrapper != null) {"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"message = messageWrapper.getMessage();"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"return message;"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"(Map<String, Object>) new DirectFieldAccessor(messageHeaders).getPropertyValue(""headers"");"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"Map<String, Object> headers ="
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"MongoDbMessageStore.this.converter.normalizeHeaders((Map<String, Object>) source.get(""headers""));"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"GenericMessage<?> message ="
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"new GenericMessage<Object>(MongoDbMessageStore.this.converter.extractPayload(source), headers);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"MongoDbMessageStore.this.converter.normalizeHeaders((Map<String, Object>) dbObject.get(""headers""));"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"return MutableMessageBuilder.withPayload(MongoDbMessageStore.this.converter.extractPayload(dbObject))"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,".copyHeaders(headers)"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,".build();"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"AdviceMessage message ="
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","added",0,"new AdviceMessage(MongoDbMessageStore.this.converter.extractPayload(source), headers, inputMessage);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"import org.springframework.dao.DataAccessException;"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"import org.springframework.data.mongodb.core.DbCallback;"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"import com.mongodb.DB;"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"import com.mongodb.MongoException;"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"*"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"this.template.executeInSession(new DbCallback<Void>() {"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"@Override"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"public Void doInDB(DB db) throws MongoException, DataAccessException {"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"Message<?> message = document.getMessage();"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"if (message.getHeaders().containsKey(SAVED_KEY)) {"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"Message<?> saved = getMessage(message.getHeaders().getId());"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"if (saved != null) {"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"if (saved.equals(message)) {"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"return null;"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"} // We need to save it under its own id"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"}"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"final long createdDate = document.get_Group_timestamp() == 0 ? System.currentTimeMillis() : document.get_Group_timestamp();"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"Message<?> result = getMessageBuilderFactory().fromMessage(message).setHeader(SAVED_KEY, Boolean.TRUE)"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,".setHeader(CREATED_DATE_KEY, createdDate).build();"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"@SuppressWarnings(""unchecked"")"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"Map<String, Object> innerMap = (Map<String, Object>) new DirectFieldAccessor(result.getHeaders()).getPropertyValue(""headers"");"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"// using reflection to set ID since it is immutable through MessageHeaders"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"innerMap.put(MessageHeaders.ID, message.getHeaders().get(MessageHeaders.ID));"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"innerMap.put(MessageHeaders.TIMESTAMP, message.getHeaders().get(MessageHeaders.TIMESTAMP));"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"document.set_Group_timestamp(createdDate);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"template.insert(document, collectionName);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"});"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"MessageWrapper messageWrapper = this.template.findOne(whereMessageIdIs(id), MessageWrapper.class, this.collectionName);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"MessageWrapper messageWrapper =  this.template.findAndRemove(whereMessageIdIs(id), MessageWrapper.class, this.collectionName);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"return (messageWrapper != null) ? messageWrapper.getMessage() : null;"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"return this.template.executeInSession(new DbCallback<MessageGroup>() {"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"public MessageGroup doInDB(DB db) throws MongoException, DataAccessException {"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"Query query = whereGroupIdOrder(groupId);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"MessageWrapper messageDocument = template.findOne(query, MessageWrapper.class, collectionName);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"long createdTime = 0;"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"int lastReleasedSequence = 0;"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"boolean complete = false;"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"if (messageDocument != null) {"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"createdTime = messageDocument.get_Group_timestamp();"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"lastReleasedSequence = messageDocument.get_LastReleasedSequenceNumber();"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"complete = messageDocument.get_Group_complete();"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"MessageWrapper wrapper = new MessageWrapper(message);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"wrapper.set_GroupId(groupId);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"wrapper.set_Group_timestamp(createdTime == 0 ? System.currentTimeMillis() : createdTime);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"wrapper.set_Group_update_timestamp(System.currentTimeMillis());"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"wrapper.set_Group_complete(complete);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"wrapper.set_LastReleasedSequenceNumber(lastReleasedSequence);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"wrapper.setSequence(getNextId());"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"addMessageDocument(wrapper);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"return getMessageGroup(groupId);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"template.findAndRemove(whereMessageIdIsAndGroupIdIs(messageToRemove.getHeaders().getId(), groupId),"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"MessageWrapper.class, collectionName);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"updateGroup(groupId, lastModifiedUpdate());"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"return this.template.executeInSession(new DbCallback<Iterator<MessageGroup>>() {"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"public Iterator<MessageGroup> doInDB(DB db) throws MongoException, DataAccessException {"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"List<MessageGroup> messageGroups = new ArrayList<MessageGroup>();"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"Query query = Query.query(Criteria.where(GROUP_ID_KEY).exists(true));"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"@SuppressWarnings(""rawtypes"")"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"List groupIds = template.getCollection(collectionName)"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,".distinct(GROUP_ID_KEY, query.getQueryObject());"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"for (Object groupId : groupIds) {"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"messageGroups.add(getMessageGroup(groupId));"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"return messageGroups.iterator();"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"return this.template.executeInSession(new DbCallback<Message<?>>() {"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"public Message<?> doInDB(DB db) throws MongoException, DataAccessException {"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"Query query = whereGroupIdIs(groupId).with(new Sort(GROUP_UPDATE_TIMESTAMP_KEY, SEQUENCE));"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"MessageWrapper messageWrapper = template.findAndRemove(query, MessageWrapper.class, collectionName);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"Message<?> message = null;"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"if (messageWrapper != null) {"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"message = messageWrapper.getMessage();"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"return message;"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"Map<String, Object> innerMap = (Map<String, Object>) new DirectFieldAccessor(messageHeaders).getPropertyValue(""headers"");"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"Map<String, Object> headers = MongoDbMessageStore.this.converter.normalizeHeaders((Map<String, Object>) source.get(""headers""));"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"GenericMessage<?> message = new GenericMessage<Object>(MongoDbMessageStore.this.converter.extractPayload(source), headers);"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"Map<String, Object> headers = MongoDbMessageStore.this.converter.normalizeHeaders((Map<String, Object>) dbObject.get(""headers""));"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"return MutableMessageBuilder.withPayload(MongoDbMessageStore.this.converter.extractPayload(dbObject)).copyHeaders(headers).build();"
"a60a8733ccce00257e39d0a59ec8156bf80a774b","9754d59f62f78a92ab0ac6208c38a75235028dd0","deleted",1,"AdviceMessage message = new AdviceMessage(MongoDbMessageStore.this.converter.extractPayload(source), headers, inputMessage);"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"* Copyright 2002-2015 the original author or authors."
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"import org.springframework.integration.dispatcher.MessageHandlingTaskDecorator;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"import org.springframework.messaging.support.MessageHandlingRunnable;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"* @author Artem Bilan"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"public class PublishSubscribeChannel extends AbstractExecutorChannel {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"super(executor);"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"getDispatcher().setIgnoreFailures(ignoreFailures);"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"getDispatcher().setApplySequence(applySequence);"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"getDispatcher().setMinSubscribers(minSubscribers);"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"getDispatcher().setIgnoreFailures(this.ignoreFailures);"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"getDispatcher().setApplySequence(this.applySequence);"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"getDispatcher().setMinSubscribers(this.minSubscribers);"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"Integer maxSubscribers ="
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"getIntegrationProperty(IntegrationProperties.CHANNELS_MAX_BROADCAST_SUBSCRIBERS, Integer.class);"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"getDispatcher().setBeanFactory(this.getBeanFactory());"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"getDispatcher().setMessageHandlingTaskDecorator(new MessageHandlingTaskDecorator() {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"@Override"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"public Runnable decorate(MessageHandlingRunnable task) {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"if (PublishSubscribeChannel.this.executorInterceptorsSize > 0) {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"return new MessageHandlingTask(task);"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"}"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"else {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"return task;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"});"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","added",0,"return (BroadcastingDispatcher) this.dispatcher;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"* Copyright 2002-2014 the original author or authors."
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"public class PublishSubscribeChannel extends AbstractSubscribableChannel {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"private volatile BroadcastingDispatcher dispatcher;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"private volatile Executor executor;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"private volatile Integer maxSubscribers;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"this.executor = executor;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"*"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"this.getDispatcher().setIgnoreFailures(ignoreFailures);"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"this.getDispatcher().setApplySequence(applySequence);"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"}"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"/**"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"* Specify the maximum number of subscribers supported by the"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"* channel's dispatcher."
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"* @param maxSubscribers The maximum number of subscribers allowed."
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"*/"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"public void setMaxSubscribers(int maxSubscribers) {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"this.maxSubscribers = maxSubscribers;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"this.getDispatcher().setMaxSubscribers(maxSubscribers);"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"this.getDispatcher().setMinSubscribers(minSubscribers);"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"this.dispatcher.setIgnoreFailures(this.ignoreFailures);"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"this.dispatcher.setApplySequence(this.applySequence);"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"this.dispatcher.setMinSubscribers(this.minSubscribers);"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"Integer maxSubscribers = this.getIntegrationProperty(IntegrationProperties.CHANNELS_MAX_BROADCAST_SUBSCRIBERS, Integer.class);"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"this.dispatcher.setBeanFactory(this.getBeanFactory());"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","590892e2997b805ee15c72965c5345df3268c2be","deleted",1,"return this.dispatcher;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"/* Copyright 2002-2015 the original author or authors."
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"import org.springframework.messaging.MessagingException;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"import org.springframework.messaging.support.MessageHandlingRunnable;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"import org.springframework.util.Assert;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"* @author Artem Bilan"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"private final MessageHandler dispatchHandler = new MessageHandler() {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"@Override"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"public void handleMessage(Message<?> message) throws MessagingException {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"doDispatch(message);"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"}"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"};"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"private final Executor executor;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"private volatile MessageHandlingTaskDecorator messageHandlingTaskDecorator ="
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"new MessageHandlingTaskDecorator() {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"public Runnable decorate(MessageHandlingRunnable task) {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"return task;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"public void setMessageHandlingTaskDecorator(MessageHandlingTaskDecorator messageHandlingTaskDecorator) {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"Assert.notNull(messageHandlingTaskDecorator, ""'messageHandlingTaskDecorator' must not be null."");"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"this.messageHandlingTaskDecorator = messageHandlingTaskDecorator;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"Runnable task = createMessageHandlingTask(message);"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"this.executor.execute(task);"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"private Runnable createMessageHandlingTask(final Message<?> message) {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"MessageHandlingRunnable task = new MessageHandlingRunnable() {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"public void run() {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"public Message<?> getMessage() {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"return message;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"public MessageHandler getMessageHandler() {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"return UnicastingDispatcher.this.dispatchHandler;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"return this.messageHandlingTaskDecorator.decorate(task);"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"while (!success && handlerIterator.hasNext()) {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"/* Copyright 2002-2014 the original author or authors."
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"private final Executor executor;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"this.executor.execute(new Runnable() {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"@Override"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"public void run() {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"doDispatch(message);"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"}"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"});"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"while (success == false && handlerIterator.hasNext()) {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"* Copyright 2002-2015 the original author or authors."
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"import org.springframework.test.annotation.DirtiesContext;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"* @author Artem Bilan"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"@DirtiesContext"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"@MessageEndpoint"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"private static class AnnotatedEndpoint {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"@ServiceActivator(inputChannel = ""input"", outputChannel = ""output"")"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"public String process(String message) {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"count++;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"return message + "": "" + count;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"}"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"@ServiceActivator(inputChannel = ""inputImplicit"", outputChannel = ""output"")"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"public String processImplicit(String message) {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"* Copyright 2002-2014 the original author or authors."
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"@MessageEndpoint"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"@ServiceActivator(inputChannel = ""input"", outputChannel = ""output"")"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"public String process(String message) {"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"count++;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"String result = message + "": "" + count;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"return result;"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"}"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"@ServiceActivator(inputChannel = ""inputImplicit"", outputChannel = ""output"")"
"09fb4f78c9ffce753abd035f7754764d0a61ffa4","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"public String processImplicit(String message) {"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"* Copyright 2002-2016 the original author or authors."
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"import java.util.List;"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"import org.jivesoftware.smack.filter.StanzaFilter;"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"import org.jivesoftware.smack.packet.ExtensionElement;"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"import org.springframework.expression.EvaluationContext;"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"import org.springframework.expression.Expression;"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"import org.springframework.integration.expression.ExpressionUtils;"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"private XmppHeaderMapper headerMapper = new DefaultXmppHeaderMapper();"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"private Expression payloadExpression;"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"private StanzaFilter stanzaFilter;"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"private EvaluationContext evaluationContext;"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"* @deprecated since version 4.3 in favor of {@link #setPayloadExpression(Expression)}"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"@Deprecated"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"if (this.payloadExpression == null) {"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"setPayloadExpression(extractPayload ? null : EXPRESSION_PARSER.parseExpression(""#this""));"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"}"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"/**"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"* Specify a {@link StanzaFilter} to use for the incoming packets."
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"* @param stanzaFilter the {@link StanzaFilter} to use"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"* @since 4.3"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"* @see XMPPConnection#addAsyncStanzaListener(StanzaListener, StanzaFilter)"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"*/"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"public void setStanzaFilter(StanzaFilter stanzaFilter) {"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"this.stanzaFilter = stanzaFilter;"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"* Specify a SpEL expression to evaluate a {@code payload} against an incoming"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"* {@link org.jivesoftware.smack.packet.Message}."
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"* @param payloadExpression the {@link Expression} for payload evaluation."
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"* @see StanzaListener"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"* @see org.jivesoftware.smack.packet.Message"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"public void setPayloadExpression(Expression payloadExpression) {"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"this.payloadExpression = payloadExpression;"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"@Override protected void onInit() {"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"super.onInit();"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"this.evaluationContext = ExpressionUtils.createStandardEvaluationContext(getBeanFactory());"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"Assert.isTrue(this.initialized, this.getComponentName() + "" ["" + this.getComponentType()"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"+ ""] must be initialized"");"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"this.xmppConnection.addAsyncStanzaListener(this.stanzaListener, this.stanzaFilter);"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"Object messageBody = xmppMessage.getBody();"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"if (ChatMessageListeningEndpoint.this.payloadExpression != null) {"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"EvaluationContext evaluationContext = ChatMessageListeningEndpoint.this.evaluationContext;"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"List<ExtensionElement> extensions = xmppMessage.getExtensions();"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"if (extensions.size() == 1) {"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"ExtensionElement extension = extensions.get(0);"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"evaluationContext = ExpressionUtils.createStandardEvaluationContext(getBeanFactory());"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"evaluationContext.setVariable(""extension"", extension);"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"messageBody = ChatMessageListeningEndpoint.this.payloadExpression"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,".getValue(evaluationContext, xmppMessage);"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"if (messageBody != null) {"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"sendMessage(getMessageBuilderFactory()"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,".withPayload(messageBody)"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,".copyHeaders(mappedHeaders).build());"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"else if (logger.isInfoEnabled()) {"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"logger.info(""The 'payloadExpression' ["""
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"+ ChatMessageListeningEndpoint.this.payloadExpression.getExpressionString()"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"+ ""] has been evaluated to 'null'. The XMPP Message ["" + xmppMessage + ""] is ignored."");"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"else {"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","added",0,"logger.info(""The XMPP Message ["" + xmppMessage + ""] with empty body is ignored."");"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,"* Copyright 2002-2015 the original author or authors."
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,"import org.springframework.integration.support.AbstractIntegrationMessageBuilder;"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,"import org.springframework.util.StringUtils;"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,"private volatile boolean extractPayload = true;"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,"private volatile XmppHeaderMapper headerMapper = new DefaultXmppHeaderMapper();"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,"*"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,"this.extractPayload = extractPayload;"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,"Assert.isTrue(this.initialized, this.getComponentName() + "" ["" + this.getComponentType() + ""] must be initialized"");"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,"this.xmppConnection.addAsyncStanzaListener(this.stanzaListener, null);"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,"String messageBody = xmppMessage.getBody();"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,"/*"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,"* Since there are several types of chat messages with different ChatState (e.g., composing, paused etc)"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,"* we need to perform further validation since for now we only support messages that have"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,"* content (e.g., Use A says 'Hello' to User B). We don't yet support messages with no"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,"* content (e.g., User A is typing a message for User B etc.)."
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,"* See https://jira.springsource.org/browse/INT-1728"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,"* Also see: packet.getExtensions()"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,"*/"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,"if (StringUtils.hasText(messageBody)){"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,"Object payload = (extractPayload ? messageBody : xmppMessage);"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,"AbstractIntegrationMessageBuilder<?> messageBuilder ="
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,"ChatMessageListeningEndpoint.this.getMessageBuilderFactory()"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,".withPayload(payload)"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,".copyHeaders(mappedHeaders);"
"f7c59b3b18ccad008ead795c7efa32e5f70afc2f","8e8530b1fc1d963bd952098d99ff27457f6d8a81","deleted",1,"sendMessage(messageBuilder.build());"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"int size = messageGroup.size();"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"int sequenceSize = messageGroup.getSequenceSize();"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"import org.springframework.integration.IntegrationMessageHeaderAccessor;"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"int size = messageGroup.getMessages().size();"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"int sequenceSize = 0;"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"Message<?> message = messageGroup.getOne();"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"if (message != null) {"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"sequenceSize = new IntegrationMessageHeaderAccessor(message).getSequenceSize();"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"}"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"* @author Artem Bilan"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"* Flag that determines if partial sequences are allowed. If true then as soon as"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"* enough messages arrive that can be ordered they will be released, provided they"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"* all have sequence numbers greater than those already released."
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"int size = messageGroup.size();"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"if (this.releasePartialSequences && size > 0) {"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"Collection<Message<?>> messages = messageGroup.getMessages();"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"int sequenceSize = messageGroup.getSequenceSize();"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"* Flag that determines if partial sequences are allowed. If true then as soon as enough messages arrive that can be"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"* ordered they will be released, provided they all have sequence numbers greater than those already released."
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"*"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"Collection<Message<?>> messages = messageGroup.getMessages();"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"if (this.releasePartialSequences && !messages.isEmpty()) {"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"int size = messages.size();"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"int sequenceSize = new IntegrationMessageHeaderAccessor(messageGroup.getOne()).getSequenceSize();"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"import java.sql.PreparedStatement;"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"import java.sql.SQLException;"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"import java.sql.Timestamp;"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"import java.util.concurrent.CountDownLatch;"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"import org.springframework.jdbc.core.PreparedStatementSetter;"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"@Transactional"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"Message<?> message = MessageBuilder.withPayload(""foo"").setCorrelationId(""X"").build();"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"message = messageStore.getMessage(message.getHeaders().getId());"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"assertEquals(""Y"", new IntegrationMessageHeaderAccessor(message).getCorrelationId());"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"messageStore.addMessagesToGroup(groupId, message);"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"messageStore.addMessagesToGroup(groupId, messages.toArray(new Message[messages.size()]));"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"JdbcTemplate template = new JdbcTemplate(this.dataSource);"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"""SELECT * from INT_GROUP_TO_MESSAGE where GROUP_KEY = ?"", uuidGroupId).size() == 0);"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"this.messageStore.addMessagesToGroup(groupId,"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"MessageBuilder.withPayload(""foo"").setCorrelationId(groupId).build());"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"MessageBuilder.withPayload(""bar"").setCorrelationId(groupId).build());"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"MessageGroup group = this.messageStore.getMessageGroup(groupId);"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"assertEquals(""foo"", this.messageStore.pollMessageFromGroup(groupId).getPayload());"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"assertEquals(""bar"", this.messageStore.pollMessageFromGroup(groupId).getPayload());"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"final String groupId = ""X"";"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"final CountDownLatch groupRemovalLatch = new CountDownLatch(1);"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"messageStore.addMessagesToGroup(groupId, MessageBuilder.withPayload(""bar"").setCorrelationId(groupId).build());"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"template.afterPropertiesSet();"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"template.update(""UPDATE INT_MESSAGE_GROUP set CREATED_DATE=? where GROUP_KEY=? and REGION=?"","
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"new PreparedStatementSetter() {"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"@Override"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"public void setValues(PreparedStatement ps) throws SQLException {"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"ps.setTimestamp(1, new Timestamp(System.currentTimeMillis() - 10000));"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"ps.setString(2, UUIDConverter.getUUID(groupId).toString());"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"ps.setString(3, ""DEFAULT"");"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"}"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"});"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"updateMessageGroup(template, groupId, 1000);"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"updateMessageGroup(template, groupId, 2000);"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"private void updateMessageGroup(JdbcTemplate template, final String groupId, final long timeout) {"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"template.update(""UPDATE INT_MESSAGE_GROUP set UPDATED_DATE=? where GROUP_KEY=? and REGION=?"","
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"ps.setTimestamp(1, new Timestamp(System.currentTimeMillis() - timeout));"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"messageStore.addMessagesToGroup(groupId, MessageBuilder.withPayload(""foo"").setCorrelationId(groupId).build());"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"messageStore.addMessagesToGroup(groupId, MessageBuilder.withPayload(""baz"").setCorrelationId(groupId).build());"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"messageStore.addMessagesToGroup(""Y"", MessageBuilder.withPayload(""barA"").setCorrelationId(groupId).build(),"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"MessageBuilder.withPayload(""bazA"").setCorrelationId(groupId).build());"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"assertEquals(1, messageFromGroup1.getHeaders().get(IntegrationMessageHeaderAccessor.SEQUENCE_NUMBER));"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"assertEquals(2, messageFromGroup2.getHeaders().get(IntegrationMessageHeaderAccessor.SEQUENCE_NUMBER));"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"assertEquals(1, messageFromRegion1.getHeaders().get(IntegrationMessageHeaderAccessor.SEQUENCE_NUMBER));"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"assertEquals(2, messageFromRegion2.getHeaders().get(IntegrationMessageHeaderAccessor.SEQUENCE_NUMBER));"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"Message<?> oneOfTwo = MessageBuilder.withPayload(""hello"")"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,".setSequenceNumber(1)"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,".setSequenceSize(2)"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,".setCorrelationId(groupId)"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,".build();"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"Message<?> twoOfTwo = MessageBuilder.withPayload(""world"")"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,".setSequenceNumber(2)"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"messageStore.addMessagesToGroup(groupId, oneOfTwo, twoOfTwo);"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"import org.apache.commons.logging.Log;"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"import org.apache.commons.logging.LogFactory;"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"private static final Log LOG = LogFactory.getLog(JdbcMessageStoreTests.class);"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"@Transactional"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"Message<String> message = MessageBuilder.withPayload(""foo"").setCorrelationId(""X"").build();"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"assertEquals(""Y"", new IntegrationMessageHeaderAccessor(messageStore.getMessage(message.getHeaders().getId())).getCorrelationId());"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"messageStore.addMessageToGroup(groupId, message);"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"@DirtiesContext"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"JdbcTemplate template = new JdbcTemplate(dataSource);"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"""SELECT * from INT_GROUP_TO_MESSAGE where GROUP_KEY = '""  + uuidGroupId + ""'"").size() == 0);"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"messageStore.addMessageToGroup(groupId, MessageBuilder.withPayload(""foo"").setCorrelationId(groupId).build());"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"messageStore.addMessageToGroup(groupId, MessageBuilder.withPayload(""bar"").setCorrelationId(groupId).build());"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"MessageGroup group = messageStore.getMessageGroup(groupId);"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"assertEquals(""foo"", messageStore.pollMessageFromGroup(groupId).getPayload());"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"assertEquals(""bar"", messageStore.pollMessageFromGroup(groupId).getPayload());"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"String groupId = ""X"";"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"Thread.sleep(1000);"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"Thread.sleep(2001);"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"Thread.sleep(2000);"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"Thread.sleep(1);"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"messageStore.addMessageToGroup(groupId, MessageBuilder.withPayload(""baz"").setCorrelationId(groupId).build());"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"messageStore.addMessageToGroup(""Y"", MessageBuilder.withPayload(""barA"").setCorrelationId(groupId).build());"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"messageStore.addMessageToGroup(""Y"", MessageBuilder.withPayload(""bazA"").setCorrelationId(groupId).build());"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"LOG.info(""messageFromGroup1: "" + messageFromGroup1.getHeaders().getId() + ""; Sequence #: "" + new IntegrationMessageHeaderAccessor(messageFromGroup1).getSequenceNumber());"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"LOG.info(""messageFromGroup2: "" + messageFromGroup2.getHeaders().getId() + ""; Sequence #: "" + new IntegrationMessageHeaderAccessor(messageFromGroup1).getSequenceNumber());"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"assertEquals(Integer.valueOf(1), messageFromGroup1.getHeaders().get(IntegrationMessageHeaderAccessor.SEQUENCE_NUMBER));"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"assertEquals(Integer.valueOf(2), messageFromGroup2.getHeaders().get(IntegrationMessageHeaderAccessor.SEQUENCE_NUMBER));"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"LOG.info(""messageFromRegion1: "" + messageFromRegion1.getHeaders().getId() + ""; Sequence #: "" + new IntegrationMessageHeaderAccessor(messageFromRegion1).getSequenceNumber());"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"LOG.info(""messageFromRegion2: "" + messageFromRegion2.getHeaders().getId() + ""; Sequence #: "" + new IntegrationMessageHeaderAccessor(messageFromRegion1).getSequenceNumber());"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"assertEquals(Integer.valueOf(1), messageFromRegion1.getHeaders().get(IntegrationMessageHeaderAccessor.SEQUENCE_NUMBER));"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"assertEquals(Integer.valueOf(2), messageFromRegion2.getHeaders().get(IntegrationMessageHeaderAccessor.SEQUENCE_NUMBER));"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"Message<?> oneOfTwo = MessageBuilder.withPayload(""hello"").setSequenceNumber(1).setSequenceSize(2).setCorrelationId(groupId).build();"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"Message<?> twoOfTwo = MessageBuilder.withPayload(""world"").setSequenceNumber(2).setSequenceSize(2).setCorrelationId(groupId).build();"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"messageStore.addMessageToGroup(groupId, oneOfTwo);"
"286c421c1a57dbda9cbf92f003e20bf4e0fec715","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"messageStore.addMessageToGroup(groupId, twoOfTwo);"
"eaaa21ef5d769452587d739d99c81d8a9f8103fd","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public static class ParametersWrapper {"
"eaaa21ef5d769452587d739d99c81d8a9f8103fd","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"public Expression getExpression() {"
"eaaa21ef5d769452587d739d99c81d8a9f8103fd","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return this.expression;"
"eaaa21ef5d769452587d739d99c81d8a9f8103fd","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"}"
"eaaa21ef5d769452587d739d99c81d8a9f8103fd","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private static class ParametersWrapper {"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import static org.hamcrest.Matchers.equalTo;"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"@SuppressWarnings({ ""rawtypes"", ""unchecked"" })"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"@Test"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public void optionalAndRequiredWithAnnotatedMethod() throws Exception {"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"AnnotatedTestService service = new AnnotatedTestService();"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Method method = service.getClass().getMethod(""optionalAndRequiredHeader"", String.class, Integer.class);"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"MethodInvokingMessageProcessor processor = new MethodInvokingMessageProcessor(service, method);"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"processor.setUseSpelInvoker(true);"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"optionalAndRequiredWithAnnotatedMethodGuts(processor, false);"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"}"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public void compiledOptionalAndRequiredWithAnnotatedMethod() throws Exception {"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"DirectFieldAccessor compilerConfigAccessor = compileImmediate(processor);"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"optionalAndRequiredWithAnnotatedMethodGuts(processor, true);"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertNotNull(TestUtils.getPropertyValue(processor, ""delegate.handlerMethod.expression.compiledAst""));"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"compilerConfigAccessor.setPropertyValue(""compilerMode"", SpelCompilerMode.OFF);"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private void optionalAndRequiredWithAnnotatedMethodGuts(MethodInvokingMessageProcessor processor,"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"boolean compiled) {"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Message<String> message = MessageBuilder.withPayload(""foo"")"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".setHeader(""num"", 42)"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".build();"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Object result = processor.processMessage(message);"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertEquals(""null42"", result);"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"message = MessageBuilder.withPayload(""foo"")"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".setHeader(""prop"", ""bar"")"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"result = processor.processMessage(message);"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertEquals(""bar42"", result);"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"try {"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"fail(""Expected MessageHandlingException"");"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"catch (MessageHandlingException e) {"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (compiled) {"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertThat(e.getCause().getMessage(), equalTo(""required header not available: num""));"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"else {"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertThat(e.getCause().getCause().getMessage(), equalTo(""required header not available: num""));"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public void optionalAndRequiredDottedWithAnnotatedMethod() throws Exception {"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Method method = service.getClass().getMethod(""optionalAndRequiredDottedHeader"", String.class, Integer.class);"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"optionalAndRequiredDottedWithAnnotatedMethodGuts(processor, false);"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public void compiledOptionalAndRequiredDottedWithAnnotatedMethod() throws Exception {"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"optionalAndRequiredDottedWithAnnotatedMethodGuts(processor, true);"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private void optionalAndRequiredDottedWithAnnotatedMethodGuts(MethodInvokingMessageProcessor processor,"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Message<String> message = MessageBuilder.withPayload(""hello"")"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".setHeader(""dot2"", new DotBean())"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"message = MessageBuilder.withPayload(""hello"")"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".setHeader(""dot1"", new DotBean())"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertThat(e.getCause().getMessage(), equalTo(""required header not available: dot2""));"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"else { // interpreted"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertThat(e.getCause().getCause().getMessage(), equalTo(""required header not available: dot2""));"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private DirectFieldAccessor compileImmediate(MethodInvokingMessageProcessor processor) {"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"// Update the parser configuration compiler mode"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"SpelParserConfiguration config = TestUtils.getPropertyValue(processor,"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""delegate.handlerMethod.EXPRESSION_PARSER.configuration"", SpelParserConfiguration.class);"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"DirectFieldAccessor accessor = new DirectFieldAccessor(config);"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"accessor.setPropertyValue(""compilerMode"", SpelCompilerMode.IMMEDIATE);"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return accessor;"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public Integer requiredHeader(@Header(value = ""num"") Integer num) {"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"@Header(value = ""num"") Integer num) {"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return prop + num;"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public String optionalAndRequiredDottedHeader(@Header(name = ""dot1.foo"", required = false) String prop,"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"@Header(name = ""dot2.baz"") Integer num) {"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public static class DotBean {"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private final String foo = ""bar"";"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private final Integer baz = 42;"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public String getFoo() {"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return this.foo;"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public Integer getBaz() {"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return this.baz;"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"@SuppressWarnings({""rawtypes"", ""unchecked""})"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"// Update the parser configuration compiler mode"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"SpelParserConfiguration config = TestUtils.getPropertyValue(processor,"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""delegate.handlerMethod.EXPRESSION_PARSER.configuration"", SpelParserConfiguration.class);"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"new DirectFieldAccessor(config).setPropertyValue(""compilerMode"", SpelCompilerMode.IMMEDIATE);"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"public Integer requiredHeader(@Header(value = ""num"", required = true) Integer num) {"
"c5c874f5635cb68383e3b84fac97e8f2a69e1423","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"@Header(value = ""num"", required = true) Integer num) {"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* Copyright 2002-2017 the original author or authors."
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import static org.hamcrest.Matchers.greaterThan;"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import static org.hamcrest.Matchers.instanceOf;"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import static org.hamcrest.Matchers.not;"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import static org.junit.Assert.assertThat;"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import org.springframework.integration.IntegrationMessageHeaderAccessor;"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* @author Artem Bilan"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.splitter = new XPathMessageSplitter(splittingXPath);"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.splitter.setOutputChannel(replyChannel);"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.splitter.setRequiresReply(true);"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.splitter.handleMessage(new GenericMessage<>(doc));"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"assertThat(message.getPayload(), instanceOf(Node.class));"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"assertThat(message.getPayload(), not(instanceOf(Document.class)));"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"assertThat(new IntegrationMessageHeaderAccessor(message).getSequenceSize(), greaterThan(0));"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.splitter.setCreateDocuments(true);"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"assertThat(message.getPayload(), instanceOf(Document.class));"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.splitter.handleMessage(new GenericMessage<>(payload));"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"assertThat(message.getPayload(), instanceOf(String.class));"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.splitter.handleMessage(new GenericMessage<>(123));"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"* Copyright 2002-2016 the original author or authors."
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"import static org.junit.Assert.assertFalse;"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"import static org.junit.Assert.assertTrue;"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"splitter = new XPathMessageSplitter(splittingXPath);"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"splitter.setOutputChannel(replyChannel);"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"splitter.setRequiresReply(true);"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"splitter.handleMessage(new GenericMessage<Document>(doc));"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"assertTrue(""unexpected payload type"" + message.getPayload().getClass().getName(), message.getPayload() instanceof Node);"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"assertFalse(""unexpected payload type"" + message.getPayload().getClass().getName(), message.getPayload() instanceof Document);"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"splitter.setCreateDocuments(true);"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"assertTrue(""unexpected payload type"" + message.getPayload().getClass().getName(), message.getPayload() instanceof Document);"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"splitter.handleMessage(new GenericMessage<String>(payload));"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"assertTrue(""unexpected payload type "" + message.getPayload().getClass().getName(), message.getPayload() instanceof String);"
"f112ecbb7e2233b37b3136a2054bf3a496087eb1","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"splitter.handleMessage(new GenericMessage<Integer>(123));"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import java.util.concurrent.CompletableFuture;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import org.reactivestreams.Subscriber;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import org.springframework.integration.channel.ReactiveStreamsSubscribableChannel;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import org.springframework.integration.endpoint.ReactiveStreamsConsumer;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import org.springframework.integration.mapping.MessageMappingException;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import org.springframework.integration.support.MutableMessageBuilder;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import org.springframework.lang.Nullable;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import org.springframework.messaging.MessageDeliveryException;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import org.springframework.messaging.MessageHeaders;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import org.springframework.messaging.support.MessageBuilder;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import reactor.core.publisher.Mono;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"registerReplyMessageCorrelatorIfNecessary();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"protected Mono<Message<?>> sendAndReceiveMessageReactive(Object object) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"initializeIfNecessary();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Assert.notNull(object, ""request must not be null"");"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"MessageChannel requestChannel = getRequestChannel();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (requestChannel == null) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"throw new MessagingException(""No request channel available. Cannot send request message."");"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"}"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return doSendAndReceiveMessageReactive(requestChannel, object, false);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"@SuppressWarnings(""unchecked"")"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private Mono<Message<?>> doSendAndReceiveMessageReactive(MessageChannel requestChannel, Object object,"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"boolean error) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return Mono.defer(() -> {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Message<?> message;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"try {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"message = object instanceof Message<?>"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"? (Message<?>) object"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,": this.requestMapper.toMessage(object);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"message = this.historyWritingPostProcessor.postProcessMessage(message);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"catch (Exception e) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"throw new MessageMappingException(""Cannot map to message: "" + object, e);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Object originalReplyChannelHeader = message.getHeaders().getReplyChannel();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Object originalErrorChannelHeader = message.getHeaders().getErrorChannel();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"FutureReplyChannel replyChannel = new FutureReplyChannel();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Message<?> requestMessage = MutableMessageBuilder.fromMessage(message)"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".setReplyChannel(replyChannel)"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".setHeader(this.messagingTemplate.getSendTimeoutHeader(), null)"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".setHeader(this.messagingTemplate.getReceiveTimeoutHeader(), null)"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".setErrorChannel(replyChannel)"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".build();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (requestChannel instanceof ReactiveStreamsSubscribableChannel) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"((ReactiveStreamsSubscribableChannel) requestChannel)"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".subscribeTo(Mono.just(requestMessage));"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"else {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"long sendTimeout = sendTimeout(requestMessage);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"boolean sent ="
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"sendTimeout >= 0"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"? requestChannel.send(requestMessage, sendTimeout)"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,": requestChannel.send(requestMessage);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (!sent) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"throw new MessageDeliveryException(requestMessage,"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"""Failed to send message to channel '"" + requestChannel +"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"""' within timeout: "" + sendTimeout);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return Mono.fromFuture(replyChannel.messageFuture)"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".doOnSubscribe(s -> {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (!error && this.countsEnabled) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"this.messageCount.incrementAndGet();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"})"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".<Message<?>>map(replyMessage ->"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"MessageBuilder.fromMessage(replyMessage)"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".setHeader(MessageHeaders.REPLY_CHANNEL, originalReplyChannelHeader)"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".setHeader(MessageHeaders.ERROR_CHANNEL, originalErrorChannelHeader)"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".build())"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".onErrorResume(t -> error ? Mono.error(t) : handleSendError(requestMessage, t));"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"});"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private Mono<Message<?>> handleSendError(Message<?> requestMessage, Throwable exception) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (logger.isDebugEnabled()) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"logger.debug(""failure occurred in gateway sendAndReceiveReactive: "" + exception.getMessage());"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"MessageChannel errorChannel = getErrorChannel();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (errorChannel != null) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"ErrorMessage errorMessage = buildErrorMessage(requestMessage, exception);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return doSendAndReceiveMessageReactive(errorChannel, errorMessage, true);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"catch (Exception errorFlowFailure) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"throw new MessagingException(errorMessage, ""failure occurred in error-handling flow"", errorFlowFailure);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"// no errorChannel so we'll propagate"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"throw wrapExceptionIfNecessary(exception, ""gateway received checked Exception"");"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private long sendTimeout(Message<?> requestMessage) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Long sendTimeout = headerToLong(requestMessage.getHeaders()"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".get(this.messagingTemplate.getSendTimeoutHeader()));"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return (sendTimeout != null ? sendTimeout : this.messagingTemplate.getSendTimeout());"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private long receiveTimeout(Message<?> requestMessage) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Long receiveTimeout = headerToLong(requestMessage.getHeaders()"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".get(this.messagingTemplate.getReceiveTimeoutHeader()));"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return (receiveTimeout != null ? receiveTimeout : this.messagingTemplate.getReceiveTimeout());"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"@Nullable"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private Long headerToLong(@Nullable Object headerValue) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (headerValue instanceof Number) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return ((Number) headerValue).longValue();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"else if (headerValue instanceof String) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return Long.parseLong((String) headerValue);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return null;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return this.errorMessageStrategy.buildErrorMessage(throwable, getErrorMessageAttributes(requestMessage));"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"throw wrapExceptionIfNecessary(t, description);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private RuntimeException wrapExceptionIfNecessary(Throwable t, String description) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return (RuntimeException) t;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return new MessagingException(description, t);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"protected void registerReplyMessageCorrelatorIfNecessary() {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"MessageChannel replyChannel = getReplyChannel();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (replyChannel != null && this.replyMessageCorrelator == null) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"boolean shouldStartCorrelator;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"synchronized (this.replyMessageCorrelatorMonitor) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (this.replyMessageCorrelator != null) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"AbstractEndpoint correlator;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"BridgeHandler handler = new BridgeHandler();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (getBeanFactory() != null) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"handler.setBeanFactory(getBeanFactory());"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"handler.afterPropertiesSet();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (replyChannel instanceof SubscribableChannel) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"correlator = new EventDrivenConsumer((SubscribableChannel) replyChannel, handler);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"else if (replyChannel instanceof PollableChannel) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"PollingConsumer endpoint = new PollingConsumer((PollableChannel) replyChannel, handler);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"endpoint.setBeanFactory(getBeanFactory());"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"endpoint.setReceiveTimeout(this.replyTimeout);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"endpoint.afterPropertiesSet();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"correlator = endpoint;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"else if (replyChannel instanceof ReactiveStreamsSubscribableChannel) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"ReactiveStreamsConsumer endpoint ="
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"new ReactiveStreamsConsumer(replyChannel, (Subscriber<Message<?>>) handler);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"throw new MessagingException(""Unsupported 'replyChannel' type ["" + replyChannel.getClass() + ""]."""
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"+ ""SubscribableChannel or PollableChannel type are supported."");"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"this.replyMessageCorrelator = correlator;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"shouldStartCorrelator = true;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (shouldStartCorrelator && isRunning()) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (isRunning()) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"this.replyMessageCorrelator.start();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private static class FutureReplyChannel implements MessageChannel {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private final CompletableFuture<Message<?>> messageFuture = new CompletableFuture<>();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"@Override"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"public boolean send(Message<?> message, long timeout) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return this.messageFuture.complete(message);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"MessageChannel replyChannel = getReplyChannel();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"if (replyChannel != null && this.replyMessageCorrelator == null) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"this.registerReplyMessageCorrelator();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"}"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"ErrorMessage errorMessage = this.errorMessageStrategy.buildErrorMessage(throwable,"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"getErrorMessageAttributes(requestMessage));"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"return errorMessage;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"throw (RuntimeException) t;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"throw new MessagingException(description, t);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"private void registerReplyMessageCorrelator() {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"synchronized (this.replyMessageCorrelatorMonitor) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"if (this.replyMessageCorrelator != null) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"return;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"AbstractEndpoint correlator = null;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"BridgeHandler handler = new BridgeHandler();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"if (this.getBeanFactory() != null) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"handler.setBeanFactory(this.getBeanFactory());"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"handler.afterPropertiesSet();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"if (replyChannel instanceof SubscribableChannel) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"correlator = new EventDrivenConsumer((SubscribableChannel) replyChannel, handler);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"else if (replyChannel instanceof PollableChannel) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"PollingConsumer endpoint = new PollingConsumer((PollableChannel) replyChannel, handler);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"endpoint.setBeanFactory(this.getBeanFactory());"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"endpoint.setReceiveTimeout(this.replyTimeout);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"endpoint.afterPropertiesSet();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"correlator = endpoint;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"else {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"throw new MessagingException(""Unsupported 'replyChannel' type ["" + replyChannel.getClass() + ""]."""
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"+ ""SubscribableChannel or PollableChannel type are supported."");"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"if (this.isRunning()) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"correlator.start();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"this.replyMessageCorrelator = correlator;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"import org.springframework.core.ResolvableType;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"import org.springframework.http.server.ServerHttpResponse;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"*"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public abstract class HttpRequestHandlingEndpointSupport extends BaseHttpInboundEndpoint {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private final List<HttpMessageConverter<?>> defaultMessageConverters = new ArrayList<>();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private volatile List<HttpMessageConverter<?>> messageConverters = new ArrayList<>();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"BeanFactory beanFactory = getBeanFactory();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"@SuppressWarnings({ ""rawtypes"", ""unchecked"" })"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (isReadable(request)) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"requestBody = extractRequestBody(request);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"Map<String, Object> headers = getHeaderMapper().toHeaders(request.getHeaders());"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (getPayloadExpression() != null) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"payload = getPayloadExpression().getValue(evaluationContext);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (!CollectionUtils.isEmpty(getHeaderExpressions())) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"for (Entry<String, Expression> entry : getHeaderExpressions().entrySet()) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (getStatusCodeExpression() != null) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,".setHeader(org.springframework.integration.http.HttpHeaders.STATUS_CODE,"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"evaluateHttpStatus())"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,".build();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"getHeaderMapper().fromHeaders(replyMessage.getHeaders(), response.getHeaders());"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (getExtractReplyPayload()) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"protected void setStatusCodeIfNeeded(ServerHttpResponse response) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"@SuppressWarnings({ ""unchecked"", ""rawtypes"" })"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"ResolvableType requestPayloadType = getRequestPayloadType();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"Class<?> expectedType;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (requestPayloadType == null) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"expectedType = ""text"".equals(contentType.getType()) ? String.class : byte[].class;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"}"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"else {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"expectedType = requestPayloadType.resolve();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"import java.util.Arrays;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"import java.util.concurrent.atomic.AtomicInteger;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"import org.springframework.expression.EvaluationContext;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"import org.springframework.http.HttpHeaders;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"import org.springframework.http.HttpMethod;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"import org.springframework.integration.context.OrderlyShutdownCapable;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"import org.springframework.integration.expression.ExpressionUtils;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"import org.springframework.integration.gateway.MessagingGatewaySupport;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"import org.springframework.integration.http.support.DefaultHttpHeaderMapper;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"import org.springframework.messaging.MessageHeaders;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"import org.springframework.util.ClassUtils;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public abstract class HttpRequestHandlingEndpointSupport extends MessagingGatewaySupport"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"implements OrderlyShutdownCapable {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private static final boolean jaxb2Present = ClassUtils.isPresent(""javax.xml.bind.Binder"","
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"HttpRequestHandlingEndpointSupport.class.getClassLoader());"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private static final boolean romeToolsPresent = ClassUtils.isPresent(""com.rometools.rome.feed.atom.Feed"","
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private static final List<HttpMethod> nonReadableBodyHttpMethods ="
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Arrays.asList(HttpMethod.GET, HttpMethod.HEAD, HttpMethod.OPTIONS);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private final List<HttpMessageConverter<?>> defaultMessageConverters = new ArrayList<HttpMessageConverter<?>>();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private final boolean expectReply;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private volatile List<HttpMessageConverter<?>> messageConverters = new ArrayList<HttpMessageConverter<?>>();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private volatile RequestMapping requestMapping = new RequestMapping();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private volatile CrossOrigin crossOrigin;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private volatile Class<?> requestPayloadType = null;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private volatile HeaderMapper<HttpHeaders> headerMapper = DefaultHttpHeaderMapper.inboundMapper();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private volatile boolean extractReplyPayload = true;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private volatile Expression payloadExpression;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private volatile Map<String, Expression> headerExpressions;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private volatile Expression statusCodeExpression;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private volatile EvaluationContext evaluationContext;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private final AtomicInteger activeCount = new AtomicInteger();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"this.expectReply = expectReply;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"/**"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* @return Whether to expect a reply."
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"*/"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"protected boolean isExpectReply() {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return this.expectReply;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"}"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* Specifies a SpEL expression to evaluate in order to generate the Message payload."
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* The EvaluationContext will be populated with an HttpEntity instance as the root object,"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* and it may contain variables:"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* <ul>"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* <li><code>#pathVariables</code></li>"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* <li><code>#requestParams</code></li>"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* <li><code>#requestAttributes</code></li>"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* <li><code>#requestHeaders</code></li>"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* <li><code>#matrixVariables</code></li>"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* <li><code>#cookies</code>"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* </ul>"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* @param payloadExpression The payload expression."
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public void setPayloadExpression(Expression payloadExpression) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"this.payloadExpression = payloadExpression;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* Specifies a Map of SpEL expressions to evaluate in order to generate the Message headers."
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* The keys in the map will be used as the header names. When evaluating the expression,"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* the EvaluationContext will be populated with an HttpEntity instance as the root object,"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* @param headerExpressions The header expressions."
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public void setHeaderExpressions(Map<String, Expression> headerExpressions) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"this.headerExpressions = headerExpressions;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* Set the {@link HeaderMapper} to use when mapping between HTTP headers and MessageHeaders."
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* @param headerMapper The header mapper."
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public void setHeaderMapper(HeaderMapper<HttpHeaders> headerMapper) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Assert.notNull(headerMapper, ""headerMapper must not be null"");"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"this.headerMapper = headerMapper;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* Set the {@link RequestMapping} which allows you to specify a flexible RESTFul-mapping for this endpoint."
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* @param requestMapping The request mapping."
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public void setRequestMapping(RequestMapping requestMapping) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Assert.notNull(requestMapping, ""requestMapping must not be null"");"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"this.requestMapping = requestMapping;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public final RequestMapping getRequestMapping() {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return this.requestMapping;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* Set the {@link CrossOrigin} to permit cross origin requests for this endpoint."
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* @param crossOrigin the CrossOrigin config."
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* @since 4.2"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public void setCrossOrigin(CrossOrigin crossOrigin) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"this.crossOrigin = crossOrigin;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public CrossOrigin getCrossOrigin() {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return this.crossOrigin;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* Specify the type of payload to be generated when the inbound HTTP request content is read by the"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* {@link HttpMessageConverter}s. By default this value is null which means at runtime any ""text"" Content-Type will"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* result in String while all others default to <code>byte[].class</code>."
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* @param requestPayloadType The payload type."
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public void setRequestPayloadType(Class<?> requestPayloadType) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"this.requestPayloadType = requestPayloadType;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* Specify whether only the reply Message's payload should be passed in the response. If this is set to 'false', the"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* entire Message will be used to generate the response. The default is 'true'."
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* @param extractReplyPayload true to extract the reply payload."
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public void setExtractReplyPayload(boolean extractReplyPayload) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"this.extractReplyPayload = extractReplyPayload;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* Specify the {@link Expression} to resolve a status code for Response to override"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* the default '200 OK' or '500 Internal Server Error' for a timeout."
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* @param statusCodeExpression The status code Expression."
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* @since 5.0"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* @see #setStatusCodeExpression(Expression)"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public void setStatusCodeExpressionString(String statusCodeExpression) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"setStatusCodeExpression(EXPRESSION_PARSER.parseExpression(statusCodeExpression));"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* <p>The {@link #statusCodeExpression} is applied only for the one-way"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* {@code <http:inbound-channel-adapter/>} or when no reply (timeout) is received for"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* a gateway. The {@code <http:inbound-gateway/>} (or whenever"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* {@link #HttpRequestHandlingEndpointSupport(boolean) expectReply} is true) resolves"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* an {@link HttpStatus} from the"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* {@link org.springframework.integration.http.HttpHeaders#STATUS_CODE} reply"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* {@link Message} header."
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* @since 4.1"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* @see #setReplyTimeout(long)"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* @see HttpRequestHandlingEndpointSupport#HttpRequestHandlingEndpointSupport(boolean)"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public void setStatusCodeExpression(Expression statusCodeExpression) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"this.statusCodeExpression = statusCodeExpression;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"@Override"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public String getComponentType() {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return (this.expectReply) ? ""http:inbound-gateway"" : ""http:inbound-channel-adapter"";"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"BeanFactory beanFactory = this.getBeanFactory();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"this.validateSupportedMethods();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (this.statusCodeExpression != null) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"this.evaluationContext = createEvaluationContext();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"@SuppressWarnings({""rawtypes"", ""unchecked""})"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (this.isReadable(request)) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"requestBody = this.extractRequestBody(request);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Map<String, Object> headers = this.headerMapper.toHeaders(request.getHeaders());"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (this.payloadExpression != null) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"payload = this.payloadExpression.getValue(evaluationContext);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (!CollectionUtils.isEmpty(this.headerExpressions)) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"for (Entry<String, Expression> entry : this.headerExpressions.entrySet()) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,".setHeader(org.springframework.integration.http.HttpHeaders.STATUS_CODE,"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"evaluateHttpStatus())"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,".build();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"this.headerMapper.fromHeaders(replyMessage.getHeaders(), response.getHeaders());"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (this.extractReplyPayload) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"protected void setStatusCodeIfNeeded(ServletServerHttpResponse response) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private HttpStatus evaluateHttpStatus() {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (this.evaluationContext == null) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Object value = this.statusCodeExpression.getValue(this.evaluationContext);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return buildHttpStatus(value);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* Checks if the request has a readable body (not a GET, HEAD, or OPTIONS request)."
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private boolean isReadable(ServletServerHttpRequest request) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return !(CollectionUtils.containsInstance(nonReadableBodyHttpMethods, request.getMethod()));"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"@SuppressWarnings({""unchecked"", ""rawtypes""})"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Class<?> expectedType = this.requestPayloadType;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (expectedType == null) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"expectedType = (""text"".equals(contentType.getType())) ? String.class : byte[].class;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private HttpStatus resolveHttpStatusFromHeaders(MessageHeaders headers) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Object httpStatusFromHeader = headers.get(org.springframework.integration.http.HttpHeaders.STATUS_CODE);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return buildHttpStatus(httpStatusFromHeader);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private HttpStatus buildHttpStatus(Object httpStatusValue) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"HttpStatus httpStatus = null;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (httpStatusValue instanceof HttpStatus) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"httpStatus = (HttpStatus) httpStatusValue;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (httpStatusValue instanceof Integer) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"httpStatus = HttpStatus.valueOf((Integer) httpStatusValue);"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (httpStatusValue instanceof String) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"httpStatus = HttpStatus.valueOf(Integer.parseInt((String) httpStatusValue));"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return httpStatus;"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"protected StandardEvaluationContext createEvaluationContext() {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return ExpressionUtils.createStandardEvaluationContext(this.getBeanFactory());"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private void validateSupportedMethods() {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (this.requestPayloadType != null"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"&& CollectionUtils.containsAny(nonReadableBodyHttpMethods,"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Arrays.asList(this.requestMapping.getMethods()))) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (logger.isWarnEnabled()) {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"logger.warn(""The 'requestPayloadType' attribute will have no relevance for one "" +"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"""of the specified HTTP methods '"" + nonReadableBodyHttpMethods + ""'"");"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public int beforeShutdown() {"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"stop();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return this.activeCount.get();"
"d4a99919ed78c011dc8d69bae745eedd425eb672","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public int afterShutdown() {"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private static final ExpressionParser EXPRESSION_PARSER_OFF ="
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"new SpelExpressionParser(new SpelParserConfiguration(SpelCompilerMode.OFF, null));"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private static final ExpressionParser EXPRESSION_PARSER_IMMEDIATE ="
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"new SpelExpressionParser(new SpelParserConfiguration(SpelCompilerMode.IMMEDIATE, null));"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private static final ExpressionParser EXPRESSION_PARSER_MIXED ="
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"new SpelExpressionParser(new SpelParserConfiguration(SpelCompilerMode.MIXED, null));"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private static final TypeDescriptor messageListTypeDescriptor ="
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"new TypeDescriptor(ReflectionUtils.findField(MessagingMethodInvokerHelper.class, ""dummyMessages""));"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private MessagingMethodInvokerHelper(Object targetObject, Class<? extends Annotation> annotationType,"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Method method, Class<?> expectedType, boolean canProcessMessageList) {"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.annotationType = annotationType;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.canProcessMessageList = canProcessMessageList;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Assert.notNull(method, ""method must not be null"");"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.method = method;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.requiresReply = expectedType != null;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (expectedType != null) {"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Assert.isTrue(method.getReturnType() != Void.class && method.getReturnType() != Void.TYPE,"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""method must have a return type"");"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.expectedType = TypeDescriptor.valueOf(expectedType);"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"}"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"else {"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.expectedType = null;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Assert.notNull(targetObject, ""targetObject must not be null"");"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.targetObject = targetObject;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"try {"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"InvocableHandlerMethod invocableHandlerMethod ="
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.messageHandlerMethodFactory.createInvocableHandlerMethod(targetObject, method);"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMethod = new HandlerMethod(invocableHandlerMethod, canProcessMessageList);"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.defaultHandlerMethod = null;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"checkSpelInvokerRequired(getTargetClass(targetObject), method, this.handlerMethod);"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"catch (IneligibleMethodException e) {"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"throw new IllegalArgumentException(e);"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMethods = null;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMessageMethods = null;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMethodsList = null;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"setDisplayString(targetObject, method);"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"JsonObjectMapper<?, ?> mapper;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"mapper = JsonObjectMapperProvider.newInstance();"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"catch (IllegalStateException e) {"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"mapper = null;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.jsonObjectMapper = mapper;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.expressionContext = new BeanExpressionContext((ConfigurableListableBeanFactory) beanFactory, null);"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"&& contentTypeIsJson(message)) {"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return contentType != null && contentType.toString().contains(""json"");"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"? EXPRESSION_PARSER_DEFAULT"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,": SPEL_COMPILERS.get(SpelCompilerMode.valueOf(compilerMode));"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"BeanFactory beanFactory = getBeanFactory();"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (beanFactory != null &&"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"beanFactory.containsBean(IntegrationContextUtils.ARGUMENT_RESOLVER_MESSAGE_CONVERTER_BEAN_NAME)) {"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"MessageConverter messageConverter ="
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"beanFactory.getBean(IntegrationContextUtils.ARGUMENT_RESOLVER_MESSAGE_CONVERTER_BEAN_NAME,"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"MessageConverter.class);"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.messageHandlerMethodFactory.setMessageConverter(messageConverter);"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"HandlerMethodArgumentResolversHolder handlerMethodArgumentResolversHolder ="
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"beanFactory.getBean(this.canProcessMessageList"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"? IntegrationContextUtils.LIST_ARGUMENT_RESOLVERS_BEAN_NAME"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,": IntegrationContextUtils.ARGUMENT_RESOLVERS_BEAN_NAME,"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"HandlerMethodArgumentResolversHolder.class);"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.messageHandlerMethodFactory.setCustomArgumentResolvers("
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"handlerMethodArgumentResolversHolder.getResolvers());"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"PayloadExpressionArgumentResolver payloadExpressionArgumentResolver = new PayloadExpressionArgumentResolver();"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private static final ExpressionParser EXPRESSION_PARSER_OFF = new SpelExpressionParser("
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"new SpelParserConfiguration(SpelCompilerMode.OFF, null));"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private static final ExpressionParser EXPRESSION_PARSER_IMMEDIATE = new SpelExpressionParser("
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"new SpelParserConfiguration(SpelCompilerMode.IMMEDIATE, null));"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private static final ExpressionParser EXPRESSION_PARSER_MIXED = new SpelExpressionParser("
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"new SpelParserConfiguration(SpelCompilerMode.MIXED, null));"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private static final TypeDescriptor messageListTypeDescriptor = new TypeDescriptor("
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"ReflectionUtils.findField(MessagingMethodInvokerHelper.class, ""dummyMessages""));"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.expressionContext ="
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"new BeanExpressionContext((ConfigurableListableBeanFactory) beanFactory, null);"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"&& contentTypeIsJson(message)) {"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return contentType != null ? contentType.toString().contains(""json"") : false;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private MessagingMethodInvokerHelper(Object targetObject, Class<? extends Annotation> annotationType,"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Method method, Class<?> expectedType, boolean canProcessMessageList) {"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.annotationType = annotationType;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.canProcessMessageList = canProcessMessageList;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.notNull(method, ""method must not be null"");"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.method = method;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.requiresReply = expectedType != null;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (expectedType != null) {"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.isTrue(method.getReturnType() != Void.class && method.getReturnType() != Void.TYPE,"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""method must have a return type"");"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.expectedType = TypeDescriptor.valueOf(expectedType);"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"}"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"else {"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.expectedType = null;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.notNull(targetObject, ""targetObject must not be null"");"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.targetObject = targetObject;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"try {"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"InvocableHandlerMethod invocableHandlerMethod ="
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.messageHandlerMethodFactory.createInvocableHandlerMethod(targetObject, method);"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.handlerMethod = new HandlerMethod(invocableHandlerMethod, canProcessMessageList);"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.defaultHandlerMethod = null;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"checkSpelInvokerRequired(getTargetClass(targetObject), method, this.handlerMethod);"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"catch (IneligibleMethodException e) {"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"throw new IllegalArgumentException(e);"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.handlerMethods = null;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.handlerMessageMethods = null;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.handlerMethodsList = null;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.setDisplayString(targetObject, method);"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"JsonObjectMapper<?, ?> mapper;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"mapper = JsonObjectMapperProvider.newInstance();"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"catch (IllegalStateException e) {"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"mapper = null;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.jsonObjectMapper = mapper;"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"? EXPRESSION_PARSER_DEFAULT"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,": SPEL_COMPILERS.get(SpelCompilerMode.valueOf(compilerMode));"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (getBeanFactory() != null"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"&& getBeanFactory().containsBean("
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"IntegrationContextUtils.ARGUMENT_RESOLVER_MESSAGE_CONVERTER_BEAN_NAME)) {"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.messageHandlerMethodFactory.setMessageConverter(getBeanFactory().getBean("
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"IntegrationContextUtils.ARGUMENT_RESOLVER_MESSAGE_CONVERTER_BEAN_NAME,"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"MessageConverter.class));"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (this.canProcessMessageList) {"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.messageHandlerMethodFactory.setCustomArgumentResolvers(getBeanFactory().getBean("
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"IntegrationContextUtils.LIST_ARGUMENT_RESOLVERS_BEAN_NAME,"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"HandlerMethodArgumentResolversHolder.class).getResolvers());"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"IntegrationContextUtils.ARGUMENT_RESOLVERS_BEAN_NAME,"
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"PayloadExpressionArgumentResolver payloadExpressionArgumentResolver ="
"9414ceef869b2bcf8ba9aabdb1c0a0204e2c220f","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"new PayloadExpressionArgumentResolver();"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"import org.junit.runner.RunWith;"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"import org.springframework.beans.factory.annotation.Autowired;"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"import org.springframework.context.ApplicationContext;"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"import org.springframework.test.annotation.DirtiesContext;"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"import org.springframework.test.context.junit4.SpringRunner;"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"@RunWith(SpringRunner.class)"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"@DirtiesContext"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"@Autowired"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"private ApplicationContext  context;"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"Object edc = this.context.getBean(""rabbitGateway"");"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"checkGWProps(this.context, gateway);"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"AsyncAmqpOutboundGateway async = this.context.getBean(""asyncGateway.handler"", AsyncAmqpOutboundGateway.class);"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"checkGWProps(this.context, async);"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"assertSame(this.context.getBean(""asyncTemplate""), TestUtils.getPropertyValue(async, ""template""));"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"assertSame(this.context.getBean(""ems""), TestUtils.getPropertyValue(gateway, ""errorMessageStrategy""));"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"protected void checkGWProps(ApplicationContext context, Orderable gateway) {"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"Object eventDrivenConsumer = this.context.getBean(""withHeaderMapperCustomRequestResponse"");"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"MessageChannel requestChannel = this.context.getBean(""toRabbit1"", MessageChannel.class);"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"QueueChannel queueChannel = this.context.getBean(""fromRabbit"", QueueChannel.class);"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"Object eventDrivenConsumer = this.context.getBean(""withHeaderMapperCustomAndStandardResponse"");"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"MessageChannel requestChannel = this.context.getBean(""toRabbit2"", MessageChannel.class);"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"Object eventDrivenConsumer = this.context.getBean(""withHeaderMapperNothingToMap"");"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"MessageChannel requestChannel = this.context.getBean(""toRabbit3"", MessageChannel.class);"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"Object eventDrivenConsumer = this.context.getBean(""chainWithRabbitOutboundGateway"");"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"MessageChannel requestChannel = this.context.getBean(""toRabbit4"", MessageChannel.class);"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"import org.springframework.context.ConfigurableApplicationContext;"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"ConfigurableApplicationContext context = new ClassPathXmlApplicationContext("
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"""AmqpOutboundGatewayParserTests-context.xml"", this.getClass());"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"Object edc = context.getBean(""rabbitGateway"");"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"checkGWProps(context, gateway);"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"AsyncAmqpOutboundGateway async = context.getBean(""asyncGateway.handler"", AsyncAmqpOutboundGateway.class);"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"checkGWProps(context, async);"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"assertSame(context.getBean(""asyncTemplate""), TestUtils.getPropertyValue(async, ""template""));"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"assertSame(context.getBean(""ems""), TestUtils.getPropertyValue(gateway, ""errorMessageStrategy""));"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"context.close();"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"protected void checkGWProps(ConfigurableApplicationContext context, Orderable gateway) {"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"@SuppressWarnings({ ""resource"" })"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"Object eventDrivenConsumer = context.getBean(""withHeaderMapperCustomRequestResponse"");"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"MessageChannel requestChannel = context.getBean(""toRabbit1"", MessageChannel.class);"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"QueueChannel queueChannel = context.getBean(""fromRabbit"", QueueChannel.class);"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"Object eventDrivenConsumer = context.getBean(""withHeaderMapperCustomAndStandardResponse"");"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"MessageChannel requestChannel = context.getBean(""toRabbit2"", MessageChannel.class);"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"Object eventDrivenConsumer = context.getBean(""withHeaderMapperNothingToMap"");"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"MessageChannel requestChannel = context.getBean(""toRabbit3"", MessageChannel.class);"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"@SuppressWarnings(""resource"")"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"Object eventDrivenConsumer = context.getBean(""chainWithRabbitOutboundGateway"");"
"90c46f5a79894a130badad77d2ee7ede9b33f697","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"MessageChannel requestChannel = context.getBean(""toRabbit4"", MessageChannel.class);"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"* Copyright 2002-2018 the original author or authors."
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import java.util.UUID;"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"*"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private static final ExpressionParser expressionParser = new SpelExpressionParser();"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"ExpressionEvaluatingMessageProcessor<String> processor = new ExpressionEvaluatingMessageProcessor<>(expression);"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertEquals(""foo"", processor.processMessage(new GenericMessage<>(""foo"")));"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"EvaluationContext evaluationContext ="
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"TestUtils.getPropertyValue(processor, ""evaluationContext"", EvaluationContext.class);"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertEquals(""2"", processor.processMessage(new GenericMessage<>(""2"")));"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertEquals(null, processor.processMessage(new GenericMessage<>(""2"")));"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return Arrays.toString(resources);"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"applicationContext.getBeanFactory()"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".registerSingleton(IntegrationContextUtils.INTEGRATION_EVALUATION_CONTEXT_BEAN_NAME,"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"factoryBean.getObject());"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"String result = processor.processMessage(new GenericMessage<>(""classpath*:*-test.xml""));"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertTrue(""Wrong result: "" + result, result.contains(""log4j2-test.xml""));"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"ExpressionEvaluatingMessageProcessor<UUID> processor = new ExpressionEvaluatingMessageProcessor<>(expression);"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"GenericMessage<String> message = new GenericMessage<>(""foo"");"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertEquals(""foo"", processor.processMessage(new GenericMessage<>(new TestPayload())));"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"* Copyright 2002-2016 the original author or authors."
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import org.springframework.expression.spel.SpelParserConfiguration;"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private static final ExpressionParser expressionParser = new SpelExpressionParser(new SpelParserConfiguration(true, true));"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"@SuppressWarnings({ ""rawtypes"", ""unchecked"" })"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"ExpressionEvaluatingMessageProcessor processor = new ExpressionEvaluatingMessageProcessor(expression);"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"assertEquals(""foo"", processor.processMessage(new GenericMessage<String>(""foo"")));"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"EvaluationContext evaluationContext = TestUtils.getPropertyValue(processor, ""evaluationContext"", EvaluationContext.class);"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"assertEquals(""2"", processor.processMessage(new GenericMessage<String>(""2"")));"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"assertEquals(null, processor.processMessage(new GenericMessage<String>(""2"")));"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return Arrays.asList(resources).toString();"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"applicationContext.getBeanFactory().registerSingleton(IntegrationContextUtils.INTEGRATION_EVALUATION_CONTEXT_BEAN_NAME,"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"factoryBean.getObject());"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"String result = (String) processor.processMessage(new GenericMessage<String>(""classpath*:*.properties""));"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"assertTrue(""Wrong result: "" + result, result.contains(""log4j.properties""));"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"GenericMessage<String> message = new GenericMessage<String>(""foo"");"
"30450c48be3782ebff629337176bb7413bc97e2c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"assertEquals(""foo"", processor.processMessage(new GenericMessage<TestPayload>(new TestPayload())));"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","added",0,"* Copyright 2002-2018 the original author or authors."
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","added",0,"import java.util.UUID;"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","added",0,"*"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","added",0,"private static final ExpressionParser expressionParser = new SpelExpressionParser();"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","added",0,"ExpressionEvaluatingMessageProcessor<String> processor = new ExpressionEvaluatingMessageProcessor<>(expression);"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","added",0,"assertEquals(""foo"", processor.processMessage(new GenericMessage<>(""foo"")));"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","added",0,"EvaluationContext evaluationContext ="
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","added",0,"TestUtils.getPropertyValue(processor, ""evaluationContext"", EvaluationContext.class);"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","added",0,"assertEquals(""2"", processor.processMessage(new GenericMessage<>(""2"")));"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","added",0,"assertEquals(null, processor.processMessage(new GenericMessage<>(""2"")));"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","added",0,"return Arrays.toString(resources);"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","added",0,"applicationContext.getBeanFactory()"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","added",0,".registerSingleton(IntegrationContextUtils.INTEGRATION_EVALUATION_CONTEXT_BEAN_NAME,"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","added",0,"factoryBean.getObject());"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","added",0,"String result = processor.processMessage(new GenericMessage<>(""classpath*:*-test.xml""));"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","added",0,"assertTrue(""Wrong result: "" + result, result.contains(""log4j2-test.xml""));"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","added",0,"ExpressionEvaluatingMessageProcessor<UUID> processor = new ExpressionEvaluatingMessageProcessor<>(expression);"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","added",0,"GenericMessage<String> message = new GenericMessage<>(""foo"");"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","added",0,"assertEquals(""foo"", processor.processMessage(new GenericMessage<>(new TestPayload())));"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","deleted",1,"* Copyright 2002-2016 the original author or authors."
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","deleted",1,"import org.springframework.expression.spel.SpelParserConfiguration;"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","deleted",1,"private static final ExpressionParser expressionParser = new SpelExpressionParser(new SpelParserConfiguration(true, true));"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","deleted",1,"@SuppressWarnings({ ""rawtypes"", ""unchecked"" })"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","deleted",1,"ExpressionEvaluatingMessageProcessor processor = new ExpressionEvaluatingMessageProcessor(expression);"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","deleted",1,"assertEquals(""foo"", processor.processMessage(new GenericMessage<String>(""foo"")));"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","deleted",1,"EvaluationContext evaluationContext = TestUtils.getPropertyValue(processor, ""evaluationContext"", EvaluationContext.class);"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","deleted",1,"assertEquals(""2"", processor.processMessage(new GenericMessage<String>(""2"")));"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","deleted",1,"assertEquals(null, processor.processMessage(new GenericMessage<String>(""2"")));"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","deleted",1,"return Arrays.asList(resources).toString();"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","deleted",1,"applicationContext.getBeanFactory().registerSingleton(IntegrationContextUtils.INTEGRATION_EVALUATION_CONTEXT_BEAN_NAME,"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","deleted",1,"factoryBean.getObject());"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","deleted",1,"String result = (String) processor.processMessage(new GenericMessage<String>(""classpath*:*.properties""));"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","deleted",1,"assertTrue(""Wrong result: "" + result, result.contains(""log4j.properties""));"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","deleted",1,"GenericMessage<String> message = new GenericMessage<String>(""foo"");"
"30450c48be3782ebff629337176bb7413bc97e2c","c17bddc34f7dc456b29f118718aaf6888184cb0b","deleted",1,"assertEquals(""foo"", processor.processMessage(new GenericMessage<TestPayload>(new TestPayload())));"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","390cc84c5b41e4375bb89b6007231bc7727bd112","added",0,"import org.springframework.core.task.AsyncTaskExecutor;"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","390cc84c5b41e4375bb89b6007231bc7727bd112","added",0,"import org.springframework.core.task.SimpleAsyncTaskExecutor;"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","390cc84c5b41e4375bb89b6007231bc7727bd112","added",0,"private AsyncTaskExecutor executor = new SimpleAsyncTaskExecutor();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","390cc84c5b41e4375bb89b6007231bc7727bd112","added",0,"final AtomicReference<ServerSocket> serverSocket = new AtomicReference<>();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","390cc84c5b41e4375bb89b6007231bc7727bd112","added",0,"this.executor.execute(() -> {"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","390cc84c5b41e4375bb89b6007231bc7727bd112","added",0,"List<Socket> sockets = new ArrayList<>();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","390cc84c5b41e4375bb89b6007231bc7727bd112","added",0,"results[j] = (this.executor.submit(() -> {"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","390cc84c5b41e4375bb89b6007231bc7727bd112","added",0,"Set<String> replies = new HashSet<>();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","390cc84c5b41e4375bb89b6007231bc7727bd112","added",0,"final AtomicReference<String> lastReceived = new AtomicReference<>();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","390cc84c5b41e4375bb89b6007231bc7727bd112","deleted",1,"import java.util.concurrent.Executors;"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","390cc84c5b41e4375bb89b6007231bc7727bd112","deleted",1,"final AtomicReference<ServerSocket> serverSocket = new AtomicReference<ServerSocket>();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","390cc84c5b41e4375bb89b6007231bc7727bd112","deleted",1,"Executors.newSingleThreadExecutor().execute(() -> {"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","390cc84c5b41e4375bb89b6007231bc7727bd112","deleted",1,"List<Socket> sockets = new ArrayList<Socket>();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","390cc84c5b41e4375bb89b6007231bc7727bd112","deleted",1,"results[j] = (Executors.newSingleThreadExecutor().submit(() -> {"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","390cc84c5b41e4375bb89b6007231bc7727bd112","deleted",1,"Set<String> replies = new HashSet<String>();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","390cc84c5b41e4375bb89b6007231bc7727bd112","deleted",1,"final AtomicReference<String> lastReceived = new AtomicReference<String>();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"import org.springframework.core.task.AsyncTaskExecutor;"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"import org.springframework.core.task.SimpleAsyncTaskExecutor;"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"private AsyncTaskExecutor executor = new SimpleAsyncTaskExecutor();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"final AtomicReference<ServerSocket> serverSocket = new AtomicReference<>();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.executor.execute(() -> {"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"List<Socket> sockets = new ArrayList<>();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"results[j] = (this.executor.submit(() -> {"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"Set<String> replies = new HashSet<>();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"final AtomicReference<String> lastReceived = new AtomicReference<>();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"import java.util.concurrent.Executors;"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"final AtomicReference<ServerSocket> serverSocket = new AtomicReference<ServerSocket>();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"Executors.newSingleThreadExecutor().execute(() -> {"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"List<Socket> sockets = new ArrayList<Socket>();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"results[j] = (Executors.newSingleThreadExecutor().submit(() -> {"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"Set<String> replies = new HashSet<String>();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"final AtomicReference<String> lastReceived = new AtomicReference<String>();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"import org.springframework.beans.factory.DisposableBean;"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"import org.springframework.core.task.AsyncTaskExecutor;"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"import org.springframework.core.task.SimpleAsyncTaskExecutor;"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"private final AsyncTaskExecutor executor = new SimpleAsyncTaskExecutor();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"final AtomicReference<ServerSocket> serverSocket = new AtomicReference<>();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.executor.execute(() -> {"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"factory.setSoTimeout(100);"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"Thread.sleep(10);"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"Map<SocketChannel, TcpNioConnection> connections = new HashMap<>();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"finally {"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"exec.shutdownNow();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"}"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"try {"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"stream.read(out);"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"catch (IOException e) {"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"e.printStackTrace();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"latch.countDown();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"cleanupCompositeExecutor(compositeExec);"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"private void cleanupCompositeExecutor(CompositeExecutor compositeExec) throws Exception {"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"TestUtils.getPropertyValue(compositeExec, ""primaryTaskExecutor"", DisposableBean.class).destroy();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"TestUtils.getPropertyValue(compositeExec, ""secondaryTaskExecutor"", DisposableBean.class).destroy();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"final int numberOfSockets = 10;"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"factory.registerListener(message -> {"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"if (!(message instanceof ErrorMessage)) {"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return false;"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"Thread.sleep(1);"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"te.shutdown();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"final AtomicReference<ServerSocket> serverSocket = new AtomicReference<ServerSocket>();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"Executors.newSingleThreadExecutor().execute(() -> {"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"factory.setSoTimeout(1000);"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"Thread.sleep(100);"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"Map<SocketChannel, TcpNioConnection> connections = new HashMap<SocketChannel, TcpNioConnection>();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"ExecutorService exec = Executors.newSingleThreadExecutor();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"exec.execute(new Runnable() {"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"@Override"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"public void run() {"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"try {"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"stream.read(out);"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"}"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"catch (IOException e) {"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"e.printStackTrace();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"latch.countDown();"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"final int numberOfSockets = 100;"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"factory.registerListener(new TcpListener() {"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"public boolean onMessage(Message<?> message) {"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"if (!(message instanceof ErrorMessage)) {"
"c3b64dc1acc34db5ad6dc2026c2c6e758c742349","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return false;"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"* Copyright 2002-2018 the original author or authors."
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"import java.util.stream.Collectors;"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"import org.springframework.expression.Expression;"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"*"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"private final ParameterNameDiscoverer parameterNameDiscoverer = new LocalVariableTableParameterNameDiscoverer();"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"private final Map<Method, String> channels = new HashMap<>();"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"private final Map<Method, Expression> payloadExpressions = new HashMap<>();"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"private final Map<Method, Map<String, Expression>> headersExpressions = new HashMap<>();"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"this(Collections.singleton(Publisher.class));"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"@Override"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"return this.channels.computeIfAbsent(method, method1 -> {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"String channelName = getAnnotationValue(method, this.channelAttributeName, String.class);"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"if (channelName == null) {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"channelName = getAnnotationValue(method.getDeclaringClass(), this.channelAttributeName, String.class);"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"}"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"return StringUtils.hasText(channelName) ? channelName : null;"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"});"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"public Expression getExpressionForPayload(Method method) {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"return this.payloadExpressions.computeIfAbsent(method, method1 -> {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"Expression payloadExpression = null;"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"Annotation methodPayloadAnnotation = AnnotationUtils.findAnnotation(method, Payload.class);"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"if (methodPayloadAnnotation != null) {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"String payloadExpressionString = getAnnotationValue(methodPayloadAnnotation, null, String.class);"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"if (!StringUtils.hasText(payloadExpressionString)) {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"payloadExpression = RETURN_VALUE_EXPRESSION;"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"else {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"payloadExpression = EXPRESSION_PARSER.parseExpression(payloadExpressionString);"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"Annotation[][] annotationArray = method.getParameterAnnotations();"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"for (int i = 0; i < annotationArray.length; i++) {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"Annotation[] parameterAnnotations = annotationArray[i];"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"for (Annotation currentAnnotation : parameterAnnotations) {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"if (Payload.class.equals(currentAnnotation.annotationType())) {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"Assert.state(payloadExpression == null,"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"""@Payload can be used at most once on a @Publisher method, "" +"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"""either at method-level or on a single parameter"");"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"Assert.state("""".equals(AnnotationUtils.getValue(currentAnnotation)),"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"""@Payload on a parameter for a @Publisher method may not contain an expression"");"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"payloadExpression ="
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"EXPRESSION_PARSER.parseExpression(""#"" + ARGUMENT_MAP_VARIABLE_NAME + ""["" + i + ""]"");"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"if (payloadExpression == null ||"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"RETURN_VALUE_EXPRESSION.getExpressionString().equals(payloadExpression.getExpressionString())) {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"Assert.isTrue(!void.class.equals(method.getReturnType()),"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"""When defining @Publisher on a void-returning method, an explicit payload "" +"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"""expression that does not rely upon a #return value is required."");"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"return payloadExpression;"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"@Deprecated"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"public String getPayloadExpression(Method method) {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"return getExpressionForPayload(method)"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,".getExpressionString();"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"public Map<String, Expression> getExpressionsForHeaders(Method method) {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"return this.headersExpressions.computeIfAbsent(method, method1 -> {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"Map<String, Expression> headerExpressions = new HashMap<>();"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"String[] parameterNames = this.parameterNameDiscoverer.getParameterNames(method);"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"if (Header.class.equals(currentAnnotation.annotationType())) {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"String name = getAnnotationValue(currentAnnotation, null, String.class);"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"if (!StringUtils.hasText(name)) {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"name = parameterNames[i];"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"headerExpressions.put(name,"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"EXPRESSION_PARSER.parseExpression(""#"" + ARGUMENT_MAP_VARIABLE_NAME + ""["" + i + ""]""));"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"return headerExpressions;"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"public Map<String, String> getHeaderExpressions(Method method) {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"return getExpressionsForHeaders(method)"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,".entrySet()"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,".stream()"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,".collect(Collectors.toMap(Map.Entry::getKey, e -> e.getValue().getExpressionString()));"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"value = getAnnotationValue(annotation, attributeName, expectedType);"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"Object valueAsObject = (attributeName == null) ? AnnotationUtils.getValue(annotation)"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"* Copyright 2002-2015 the original author or authors."
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"private final ParameterNameDiscoverer parameterNameDiscoverer = new LocalVariableTableParameterNameDiscoverer();"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"this(Collections.<Class<? extends Annotation>>singleton(Publisher.class));"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"String channelName = this.getAnnotationValue(method, this.channelAttributeName, String.class);"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"if (channelName == null) {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"channelName = this.getAnnotationValue(method.getDeclaringClass(), this.channelAttributeName, String.class);"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"}"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"return (StringUtils.hasText(channelName) ? channelName : null);"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"public String getPayloadExpression(Method method) {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"String payloadExpression = null;"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"Annotation methodPayloadAnnotation = AnnotationUtils.findAnnotation(method, Payload.class);"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"if (methodPayloadAnnotation != null) {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"payloadExpression = getAnnotationValue(methodPayloadAnnotation, null, String.class);"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"if (!StringUtils.hasText(payloadExpression)) {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"payloadExpression = ""#"" + PublisherMetadataSource.RETURN_VALUE_VARIABLE_NAME;"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"Annotation[][] annotationArray = method.getParameterAnnotations();"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"for (int i = 0; i < annotationArray.length; i++) {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"Annotation[] parameterAnnotations = annotationArray[i];"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"for (Annotation currentAnnotation : parameterAnnotations) {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"if (Payload.class.equals(currentAnnotation.annotationType())) {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"Assert.state(payloadExpression == null,"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"""@Payload can be used at most once on a @Publisher method, "" +"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"""either at method-level or on a single parameter"");"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"Assert.state("""".equals(AnnotationUtils.getValue(currentAnnotation)),"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"""@Payload on a parameter for a @Publisher method may not contain an expression"");"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"payloadExpression = ""#"" + PublisherMetadataSource.ARGUMENT_MAP_VARIABLE_NAME + ""["" + i + ""]"";"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"if (payloadExpression == null"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"|| payloadExpression.contains(""#"" + PublisherMetadataSource.RETURN_VALUE_VARIABLE_NAME)) {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"Assert.isTrue(!void.class.equals(method.getReturnType()),"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"""When defining @Publisher on a void-returning method, an explicit payload "" +"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"""expression that does not rely upon a #return value is required."");"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"return payloadExpression;"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"public Map<String, String> getHeaderExpressions(Method method) {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"Map<String, String> headerExpressions = new HashMap<String, String>();"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"String[] parameterNames = this.parameterNameDiscoverer.getParameterNames(method);"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"if (Header.class.equals(currentAnnotation.annotationType())) {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"String name = getAnnotationValue(currentAnnotation, null, String.class);"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"if (!StringUtils.hasText(name)) {"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"name = parameterNames[i];"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"headerExpressions.put(name,"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"""#"" + PublisherMetadataSource.ARGUMENT_MAP_VARIABLE_NAME + ""["" + i + ""]"");"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"return headerExpressions;"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"value = this.getAnnotationValue(annotation, attributeName, expectedType);"
"b1a3ca764c73e5da4bf10eb4b6be1116375ac227","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"Object valueAsObject = (attributeName == null) ?  AnnotationUtils.getValue(annotation)"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"* Copyright 2014-2018 the original author or authors."
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"import java.util.concurrent.ExecutorService;"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"import java.util.concurrent.Executors;"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"import org.springframework.beans.factory.DisposableBean;"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"import org.springframework.scheduling.concurrent.CustomizableThreadFactory;"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"import org.springframework.util.ReflectionUtils;"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"public final class RedisLockRegistry implements ExpirableLockRegistry, DisposableBean {"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"private static final long DEFAULT_EXPIRE_AFTER = 60000L;"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"public static final long DEFAULT_DELETE_TIMEOUT = 10000L;"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"/**"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"* An {@link ExecutorService} to call {@link StringRedisTemplate#delete(Object)} in"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"* the separate thread when the current one is interrupted."
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"*/"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"private ExecutorService executorService ="
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"Executors.newCachedThreadPool(new CustomizableThreadFactory(""redis-lock-registry-""));"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"* Flag to denote whether the {@link ExecutorService} was provided via the setter and"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"* thus should not be shutdown when {@link #destroy()} is called"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"private boolean executorServiceExplicitlySet;"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"* Time in milliseconds to wait for the {@link StringRedisTemplate#delete(Object)} in"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"* the background thread."
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"private long deleteTimeoutMillis = DEFAULT_DELETE_TIMEOUT;"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"@Override"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"public void destroy() {"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"if (!this.executorServiceExplicitlySet) {"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"this.executorService.shutdown();"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"}"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"/*"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"* This method must be uninterruptible so catch and ignore"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"* interrupts and only break out of the while loop when"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"* we get the lock."
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"if (Thread.currentThread().isInterrupted()) {"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"RedisLockRegistry.this.executorService.submit(() ->"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"RedisLockRegistry.this.redisTemplate.delete(this.lockKey))"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,".get(RedisLockRegistry.this.deleteTimeoutMillis, TimeUnit.MILLISECONDS);"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"else {"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"RedisLockRegistry.this.redisTemplate.delete(this.lockKey);"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"catch (Exception e) {"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","added",0,"ReflectionUtils.rethrowRuntimeException(e);"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"* Copyright 2014-2017 the original author or authors."
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"public final class RedisLockRegistry implements ExpirableLockRegistry {"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"private static final long DEFAULT_EXPIRE_AFTER = 60000;"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"/*"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"* This method must be uninterruptible so catch and ignore"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"* interrupts and only break out of the while loop when"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"* we get the lock."
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"*/"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"RedisLockRegistry.this.redisTemplate.delete(this.lockKey);"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,"import org.springframework.data.redis.connection.lettuce.LettuceClientConfiguration;"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,"import org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory;"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,"import io.lettuce.core.ClientOptions;"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,"import io.lettuce.core.SocketOptions;"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,"public static LettuceConnectionFactory connectionFactory;"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,"protected static void setupConnectionFactory() {"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,"RedisStandaloneConfiguration redisStandaloneConfiguration = new RedisStandaloneConfiguration();"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,"redisStandaloneConfiguration.setPort(REDIS_PORT);"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,"LettuceClientConfiguration clientConfiguration = LettuceClientConfiguration.builder()"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,".clientOptions("
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,"ClientOptions.builder()"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,".socketOptions("
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,"SocketOptions.builder()"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,".connectTimeout(Duration.ofMillis(10000))"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,".build())"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,".commandTimeout(Duration.ofSeconds(10000))"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,".build();"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,"connectionFactory = new LettuceConnectionFactory(redisStandaloneConfiguration, clientConfiguration);"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,"connectionFactory.afterPropertiesSet();"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,"}"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,"public static void cleanUpConnectionFactoryIfAny() {"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,"if (connectionFactory != null) {"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,"connectionFactory.destroy();"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,"try {"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,"connectionFactory.getConnection();"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,"catch (Exception e) {"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,"Assume.assumeTrue(""Skipping test due to Redis not being available on port: "" + REDIS_PORT + "": "" + e, false);"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","added",0,"return base;"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"import org.springframework.data.redis.connection.jedis.JedisClientConfiguration;"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"import org.springframework.data.redis.connection.jedis.JedisConnectionFactory;"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"static ThreadLocal<JedisConnectionFactory> connectionFactoryResource = new ThreadLocal<JedisConnectionFactory>();"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"JedisConnectionFactory connectionFactory = null;"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"try {"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"RedisStandaloneConfiguration redisStandaloneConfiguration = new RedisStandaloneConfiguration();"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"redisStandaloneConfiguration.setPort(REDIS_PORT);"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"JedisClientConfiguration clientConfiguration = JedisClientConfiguration.builder()"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,".connectTimeout(Duration.ofSeconds(20))"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,".readTimeout(Duration.ofSeconds(20))"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,".build();"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"connectionFactory = new JedisConnectionFactory(redisStandaloneConfiguration, clientConfiguration);"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"connectionFactory.afterPropertiesSet();"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"connectionFactory.getConnection();"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"connectionFactoryResource.set(connectionFactory);"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"}"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"catch (Exception e) {"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"if (connectionFactory != null) {"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"connectionFactory.destroy();"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"return new Statement() {"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"@Override"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"public void evaluate() throws Throwable {"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"Assume.assumeTrue(""Skipping test due to Redis not being available on port: "" + REDIS_PORT, false);"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"};"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"base.evaluate();"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"finally {"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"JedisConnectionFactory connectionFactory = connectionFactoryResource.get();"
"b8d4e6b0dea7a2f7c27676f4311db1bcbe374568","9c7c6dccfcb344a2dbfa91c7cae3e4f18084a9cb","deleted",1,"connectionFactoryResource.remove();"
"5e47a6a9c4ef33ad1c335351e9a0fade6cbf14a2","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","added",0,"public void testFromMessageWithExpressions() {"
"5e47a6a9c4ef33ad1c335351e9a0fade6cbf14a2","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","added",0,"final AtomicReference<URI> uriHolder = new AtomicReference<>();"
"5e47a6a9c4ef33ad1c335351e9a0fade6cbf14a2","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","added",0,"public ClientHttpRequest createRequest(URI uri, HttpMethod httpMethod) {"
"5e47a6a9c4ef33ad1c335351e9a0fade6cbf14a2","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","added",0,"Message<?> message = new GenericMessage<>(""bar"");"
"5e47a6a9c4ef33ad1c335351e9a0fade6cbf14a2","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","added",0,"/**"
"5e47a6a9c4ef33ad1c335351e9a0fade6cbf14a2","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","added",0,"* Test for INT-3054: Do not break if there are extra uri variables defined in the http outbound gateway."
"5e47a6a9c4ef33ad1c335351e9a0fade6cbf14a2","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","added",0,"*/"
"5e47a6a9c4ef33ad1c335351e9a0fade6cbf14a2","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","added",0,"public void testFromMessageWithSuperfluousExpressionsInt3054() {"
"5e47a6a9c4ef33ad1c335351e9a0fade6cbf14a2","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","added",0,"Map<String, Expression> multipleExpressions = new HashMap<>();"
"5e47a6a9c4ef33ad1c335351e9a0fade6cbf14a2","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","added",0,"public void testInt3055UriVariablesExpression() {"
"5e47a6a9c4ef33ad1c335351e9a0fade6cbf14a2","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","added",0,"Map<String, Object> expressions = new HashMap<>();"
"5e47a6a9c4ef33ad1c335351e9a0fade6cbf14a2","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","deleted",1,"import java.io.IOException;"
"5e47a6a9c4ef33ad1c335351e9a0fade6cbf14a2","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","deleted",1,"public void testFromMessageWithExpressions() throws Exception {"
"5e47a6a9c4ef33ad1c335351e9a0fade6cbf14a2","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","deleted",1,"final AtomicReference<URI> uriHolder = new AtomicReference<URI>();"
"5e47a6a9c4ef33ad1c335351e9a0fade6cbf14a2","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","deleted",1,"public ClientHttpRequest createRequest(URI uri, HttpMethod httpMethod) throws IOException {"
"5e47a6a9c4ef33ad1c335351e9a0fade6cbf14a2","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","deleted",1,"Message<?> message = new GenericMessage<Object>(""bar"");"
"5e47a6a9c4ef33ad1c335351e9a0fade6cbf14a2","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","deleted",1,"/** Test for INT-3054: Do not break if there are extra uri variables defined in the http outbound gateway. */"
"5e47a6a9c4ef33ad1c335351e9a0fade6cbf14a2","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","deleted",1,"public void testFromMessageWithSuperfluousExpressionsInt3054() throws Exception {"
"5e47a6a9c4ef33ad1c335351e9a0fade6cbf14a2","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","deleted",1,"Map<String, Expression> multipleExpressions = new HashMap<String, Expression>();"
"5e47a6a9c4ef33ad1c335351e9a0fade6cbf14a2","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","deleted",1,"public void testInt3055UriVariablesExpression() throws Exception {"
"5e47a6a9c4ef33ad1c335351e9a0fade6cbf14a2","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","deleted",1,"registrar.setBeanClassLoader(context.getClassLoader());"
"5e47a6a9c4ef33ad1c335351e9a0fade6cbf14a2","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","deleted",1,"Map<String, Object> expressions = new HashMap<String, Object>();"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"* Copyright 2002-2018 the original author or authors."
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"import org.springframework.integration.jms.JmsDestinationPollingSource;"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"try (ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext("
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"""jmsInboundWithJmsTemplate.xml"", this.getClass())) {"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"PollableChannel output = (PollableChannel) context.getBean(""output"");"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"Message<?> message = output.receive(timeoutOnReceive);"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"MessageHistory history = MessageHistory.read(message);"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"assertNotNull(history);"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"Properties componentHistoryRecord = TestUtils.locateComponentInHistory(history, ""inboundAdapter"", 0);"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"assertNotNull(componentHistoryRecord);"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"assertEquals(""jms:inbound-channel-adapter"", componentHistoryRecord.get(""type""));"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"assertNotNull(""message should not be null"", message);"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"assertEquals(""polling-test"", message.getPayload());"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"}"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"public void adapterWithoutJmsTemplateAndAcknowledgeMode() {"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"JmsTemplate jmsTemplate ="
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"TestUtils.getPropertyValue(context.getBean(""inboundAdapterWithoutJmsTemplate""),"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"""source.jmsTemplate"", JmsTemplate.class);"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"assertTrue(jmsTemplate.isSessionTransacted());"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"""jmsInboundWithConnectionFactoryAndDestination.xml"", this.getClass())) {"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"assertFalse(TestUtils.getPropertyValue(context.getBean(""adapter""), ""source.jmsTemplate"", JmsTemplate.class)"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,".isSessionTransacted());"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"""jmsInboundWithConnectionFactoryAndDestinationName.xml"", this.getClass())) {"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"Message<?> message = output.receive(this.timeoutOnReceive);"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"JmsDestinationPollingSource jmsDestinationPollingSource = context"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,".getBean(JmsDestinationPollingSource.class);"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"TestUtils.getPropertyValue(jmsDestinationPollingSource, ""jmsTemplate"", JmsTemplate.class);"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"assertEquals(1000, jmsTemplate.getReceiveTimeout());"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"""jmsInboundWithDestinationAndDefaultConnectionFactory.xml"", this.getClass())) {"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"""jmsInboundWithDestinationNameAndDefaultConnectionFactory.xml"", this.getClass())) {"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"""jmsInboundWithHeaderMapper.xml"", this.getClass())) {"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"assertEquals(""foo"", message.getHeaders().get(""testProperty""));"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"assertEquals(123, message.getHeaders().get(""testAttribute""));"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"""jmsInboundWithMessageSelector.xml"", this.getClass())) {"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"PollableChannel output = (PollableChannel) context.getBean(""output1"");"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"assertEquals(""test [with selector: TestProperty = 'foo']"", message.getPayload());"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"""jmsInboundWithReceiveTimeout.xml"", this.getClass())) {"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"TestUtils.getPropertyValue(context.getBean(""adapter""), ""source.jmsTemplate"", JmsTemplate.class);"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"assertEquals(99, jmsTemplate.getReceiveTimeout());"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"""jmsInboundWithMessageConverter.xml"", this.getClass())) {"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"assertEquals(""converted-test"", message.getPayload());"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","added",0,"PollableChannel output = (PollableChannel) context.getBean(""output2"");"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"* Copyright 2002-2016 the original author or authors."
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext("
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"""jmsInboundWithJmsTemplate.xml"", this.getClass());"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"PollableChannel output = (PollableChannel) context.getBean(""output"");"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"Message<?> message = output.receive(timeoutOnReceive);"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"MessageHistory history = MessageHistory.read(message);"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"assertNotNull(history);"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"Properties componentHistoryRecord = TestUtils.locateComponentInHistory(history, ""inboundAdapter"", 0);"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"assertNotNull(componentHistoryRecord);"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"assertEquals(""jms:inbound-channel-adapter"", componentHistoryRecord.get(""type""));"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"assertNotNull(""message should not be null"", message);"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"assertEquals(""polling-test"", message.getPayload());"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"context.close();"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"public void adapterWithoutJmsTemplateAndAcknowlegeMode() {"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"JmsTemplate jmsTemplate ="
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"TestUtils.getPropertyValue(context.getBean(""inboundAdapterWithoutJmsTemplate""),"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"""source.jmsTemplate"", JmsTemplate.class);"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"assertTrue(jmsTemplate.isSessionTransacted());"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"""jmsInboundWithConnectionFactoryAndDestination.xml"", this.getClass());"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"assertFalse(TestUtils.getPropertyValue(context.getBean(""adapter""), ""source.jmsTemplate"", JmsTemplate.class)"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,".isSessionTransacted());"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"""jmsInboundWithConnectionFactoryAndDestinationName.xml"", this.getClass());"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"""jmsInboundWithDestinationAndDefaultConnectionFactory.xml"", this.getClass());"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"""jmsInboundWithDestinationNameAndDefaultConnectionFactory.xml"", this.getClass());"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"""jmsInboundWithHeaderMapper.xml"", this.getClass());"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"assertEquals(""foo"", message.getHeaders().get(""testProperty""));"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"assertEquals(123, message.getHeaders().get(""testAttribute""));"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"""jmsInboundWithMessageSelector.xml"", this.getClass());"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"PollableChannel output = (PollableChannel) context.getBean(""output1"");"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"assertEquals(""test [with selector: TestProperty = 'foo']"", message.getPayload());"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"""jmsInboundWithReceiveTimeout.xml"", this.getClass());"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"TestUtils.getPropertyValue(context.getBean(""adapter""), ""source.jmsTemplate"", JmsTemplate.class);"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"assertEquals(99, jmsTemplate.getReceiveTimeout());"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"""jmsInboundWithMessageConverter.xml"", this.getClass());"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"assertEquals(""converted-test"", message.getPayload());"
"0545a7b0ffb12666b788e694d2d292732fc9fc8c","998ca827d79e414350aaba9154504c1c6dc39aa1","deleted",1,"PollableChannel output = (PollableChannel) context.getBean(""output2"");"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"* Copyright 2002-2018 the original author or authors."
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"import org.springframework.expression.EvaluationContext;"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"import org.springframework.integration.StaticMessageHeaderAccessor;"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"import org.springframework.integration.expression.ExpressionUtils;"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"* @author Artem Bilan"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"private Destination destination;"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"private String destinationName;"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"private JmsHeaderMapper headerMapper = new DefaultJmsHeaderMapper();"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"private boolean extractPayload = true;"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"private ExpressionEvaluatingMessageProcessor<?> destinationExpressionProcessor;"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"private Expression deliveryModeExpression;"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"private Expression timeToLiveExpression;"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"private EvaluationContext evaluationContext;"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"Assert.notNull(headerMapper, ""'headerMapper' cannot be null"");"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"/**"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"* Specify a SpEL expression to evaluate a {@code deliveryMode} for the JMS message to send."
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"* This option is applied only of QoS is enabled on the {@link JmsTemplate}."
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"* @param deliveryModeExpression to use"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"* @since 5.1"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"* @see #setDeliveryModeExpression(Expression)"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"*/"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"public void setDeliveryModeExpressionString(String deliveryModeExpression) {"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"setDeliveryModeExpression(EXPRESSION_PARSER.parseExpression(deliveryModeExpression));"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"}"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"public void setDeliveryModeExpression(Expression deliveryModeExpression) {"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"this.deliveryModeExpression = deliveryModeExpression;"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"* Specify a SpEL expression to evaluate a {@code timeToLive} for the JMS message to send."
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"* @param timeToLiveExpression to use"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"* @see #setTimeToLiveExpression(Expression)"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"public void setTimeToLiveExpressionString(String timeToLiveExpression) {"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"setTimeToLiveExpression(EXPRESSION_PARSER.parseExpression(timeToLiveExpression));"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"public void setTimeToLiveExpression(Expression timeToLiveExpression) {"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"this.timeToLiveExpression = timeToLiveExpression;"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"this.evaluationContext = ExpressionUtils.createStandardEvaluationContext(getBeanFactory());"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"protected void handleMessageInternal(final Message<?> message) {"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"if (this.jmsTemplate instanceof DynamicJmsTemplate && this.jmsTemplate.isExplicitQosEnabled()) {"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"Integer priority = StaticMessageHeaderAccessor.getPriority(message);"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"if (priority != null) {"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"DynamicJmsTemplateProperties.setPriority(priority);"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"if (this.deliveryModeExpression != null) {"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"Integer deliveryMode ="
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"this.deliveryModeExpression.getValue(this.evaluationContext, message, Integer.class);"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"if (deliveryMode != null) {"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"DynamicJmsTemplateProperties.setDeliveryMode(deliveryMode);"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"if (this.timeToLiveExpression != null) {"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"Long timeToLive = this.timeToLiveExpression.getValue(this.evaluationContext, message, Long.class);"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"if (timeToLive != null) {"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"DynamicJmsTemplateProperties.setTimeToLive(timeToLive);"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"send(destination, objectToSend, messagePostProcessor);"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"DynamicJmsTemplateProperties.clearDeliveryMode();"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"DynamicJmsTemplateProperties.clearTimeToLive();"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"public javax.jms.Message postProcessMessage(javax.jms.Message jmsMessage) {"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"* Copyright 2002-2017 the original author or authors."
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"import javax.jms.JMSException;"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"import org.springframework.integration.IntegrationMessageHeaderAccessor;"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"private volatile Destination destination;"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"private volatile String destinationName;"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"private volatile JmsHeaderMapper headerMapper = new DefaultJmsHeaderMapper();"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"private volatile boolean extractPayload = true;"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"private volatile ExpressionEvaluatingMessageProcessor<?> destinationExpressionProcessor;"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"*"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"protected void handleMessageInternal(final Message<?> message) throws Exception {"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"if (message == null) {"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"throw new IllegalArgumentException(""message must not be null"");"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"}"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"DynamicJmsTemplateProperties.setPriority(new IntegrationMessageHeaderAccessor(message).getPriority());"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"this.send(destination, objectToSend, messagePostProcessor);"
"90e4c542102c10431d067d2c452982a3c4a1d7a2","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"public javax.jms.Message postProcessMessage(javax.jms.Message jmsMessage) throws JMSException {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"import java.time.Duration;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"import java.util.Date;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"import org.reactivestreams.Subscription;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"import org.springframework.scheduling.support.SimpleTriggerContext;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"import reactor.core.publisher.Flux;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"import reactor.core.publisher.Mono;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"import reactor.core.scheduler.Schedulers;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"private ClassLoader beanClassLoader = ClassUtils.getDefaultClassLoader();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"private Trigger trigger = new PeriodicTrigger(10);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"private long maxMessagesPerPoll = -1;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"private TransactionSynchronizationFactory transactionSynchronizationFactory;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"private volatile Callable<Message<?>> pollingTask;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"private volatile Flux<Message<?>> pollingFlux;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"private volatile Subscription subscription;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"private volatile ScheduledFuture<?> runningTask;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"protected boolean isReactive() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"return false;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"}"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"protected Flux<Message<?>> getPollingFlux() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"return this.pollingFlux;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"// LifecycleSupport implementation"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"@Override // guarded by super#lifecycleLock"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"protected void doStart() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"if (!this.initialized) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"onInit();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"this.pollingTask = createPollingTask();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"if (isReactive()) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"this.pollingFlux = createFluxGenerator();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"else {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"Assert.state(getTaskScheduler() != null, ""unable to start polling, no taskScheduler available"");"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"this.runningTask ="
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"getTaskScheduler()"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,".schedule(createPoller(), this.trigger);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"private Callable<Message<?>> createPollingTask() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"Callable<Message<?>> pollingTask = this::doPoll;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"pollingTask = (Callable<Message<?>>) proxyFactory.getProxy(this.beanClassLoader);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"return pollingTask;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"private Runnable createPoller() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"return () ->"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"this.taskExecutor.execute(() -> {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"int count = 0;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"while (this.initialized && (this.maxMessagesPerPoll <= 0 || count < this.maxMessagesPerPoll)) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"if (pollForMessage() == null) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"break;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"count++;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"});"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"private Flux<Message<?>> createFluxGenerator() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"SimpleTriggerContext triggerContext = new SimpleTriggerContext();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"return Flux"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,".<Duration>generate(sink -> {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"Date date = this.trigger.nextExecutionTime(triggerContext);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"if (date != null) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"triggerContext.update(date, null, null);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"long millis = date.getTime() - System.currentTimeMillis();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"sink.next(Duration.ofMillis(millis));"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"sink.complete();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"})"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,".concatMap(duration ->"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"Mono.delay(duration)"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,".doOnNext(l ->"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"triggerContext.update(triggerContext.lastScheduledExecutionTime(),"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"new Date(), null))"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,".flatMapMany(l ->"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"Flux"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,".<Message<?>>generate(fluxSink -> {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"Message<?> message = pollForMessage();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"if (message != null) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"fluxSink.next(message);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"fluxSink.complete();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,".take(this.maxMessagesPerPoll)"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,".subscribeOn(Schedulers.fromExecutor(this.taskExecutor))"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,".doOnComplete(() ->"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"triggerContext.lastActualExecutionTime(),"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"new Date())"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,")), 1)"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,".repeat(this::isRunning)"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,".doOnSubscribe(subscription -> this.subscription = subscription);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"private Message<?> pollForMessage() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"return this.pollingTask.call();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"if (e instanceof MessagingException) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"throw (MessagingException) e;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"Message<?> failedMessage = null;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"if (this.transactionSynchronizationFactory != null) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"Object resource = TransactionSynchronizationManager.getResource(getResourceToBind());"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"if (resource instanceof IntegrationResourceHolder) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"failedMessage = ((IntegrationResourceHolder) resource).getMessage();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"throw new MessagingException(failedMessage, e);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"finally {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"Object resource = getResourceToBind();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"if (TransactionSynchronizationManager.hasResource(resource)) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"TransactionSynchronizationManager.unbindResource(resource);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"private Message<?> doPoll() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"IntegrationResourceHolder holder = bindResourceHolderIfNecessary(getResourceKey(), getResourceToBind());"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"Message<?> message;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"message = receiveMessage();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"return null;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"if (!isReactive()) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"try {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"handleMessage(message);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"catch (Exception e) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"throw new MessagingExceptionWrapper(message, (MessagingException) e);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"throw new MessagingException(message, e);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"return message;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"protected void doStop() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"if (this.runningTask != null) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"this.runningTask.cancel(true);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"this.runningTask = null;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"if (this.subscription != null) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","added",0,"this.subscription.cancel();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"private Trigger trigger = new PeriodicTrigger(10);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"private ClassLoader beanClassLoader = ClassUtils.getDefaultClassLoader();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"private long maxMessagesPerPoll = -1;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"private TransactionSynchronizationFactory transactionSynchronizationFactory;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"private volatile ScheduledFuture<?> runningTask;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"private volatile Runnable poller;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"private Runnable createPoller() throws Exception {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"Callable<Boolean> pollingTask = this::doPoll;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"pollingTask = (Callable<Boolean>) proxyFactory.getProxy(this.beanClassLoader);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"return new Poller(pollingTask);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"// LifecycleSupport implementation"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"@Override // guarded by super#lifecycleLock"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"protected void doStart() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"if (!this.initialized) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"this.onInit();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"}"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"Assert.state(this.getTaskScheduler() != null,"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"""unable to start polling, no taskScheduler available"");"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"this.poller = createPoller();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"this.initialized = false;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"throw new MessagingException(""Failed to create Poller"", e);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"this.runningTask = this.getTaskScheduler().schedule(this.poller, this.trigger);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"protected void doStop() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"if (this.runningTask != null) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"this.runningTask.cancel(true);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"this.runningTask = null;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"private boolean doPoll() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"IntegrationResourceHolder holder = this.bindResourceHolderIfNecessary("
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"this.getResourceKey(), this.getResourceToBind());"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"Message<?> message = null;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"message = this.receiveMessage();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"return false;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"boolean result;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"result = false;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"try {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"this.handleMessage(message);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"catch (Exception e) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"if (e instanceof MessagingException) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"throw new MessagingExceptionWrapper(message, (MessagingException) e);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"else {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"throw new MessagingException(message, e);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"result = true;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"return result;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"/**"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"* Default Poller implementation"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"*/"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"private final class Poller implements Runnable {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"private final Callable<Boolean> pollingTask;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"Poller(Callable<Boolean> pollingTask) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"this.pollingTask = pollingTask;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"@Override"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"public void run() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"AbstractPollingEndpoint.this.taskExecutor.execute(() -> {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"int count = 0;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"while (AbstractPollingEndpoint.this.initialized"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"&& (AbstractPollingEndpoint.this.maxMessagesPerPoll <= 0"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"|| count < AbstractPollingEndpoint.this.maxMessagesPerPoll)) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"if (!Poller.this.pollingTask.call()) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"break;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"count++;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"throw (MessagingException) e;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"Message<?> failedMessage = null;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"if (AbstractPollingEndpoint.this.transactionSynchronizationFactory != null) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"Object resource = TransactionSynchronizationManager.getResource(getResourceToBind());"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"if (resource instanceof IntegrationResourceHolder) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"failedMessage = ((IntegrationResourceHolder) resource).getMessage();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"throw new MessagingException(failedMessage, e);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"finally {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"Object resource = getResourceToBind();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"if (TransactionSynchronizationManager.hasResource(resource)) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"TransactionSynchronizationManager.unbindResource(resource);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","3d6969a8370862494ea29ad677ee254d23efb689","deleted",1,"});"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import java.time.Duration;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import java.util.Date;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import org.reactivestreams.Subscription;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import org.springframework.scheduling.support.SimpleTriggerContext;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import reactor.core.publisher.Flux;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import reactor.core.publisher.Mono;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import reactor.core.scheduler.Schedulers;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private ClassLoader beanClassLoader = ClassUtils.getDefaultClassLoader();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private Trigger trigger = new PeriodicTrigger(10);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private long maxMessagesPerPoll = -1;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private TransactionSynchronizationFactory transactionSynchronizationFactory;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private volatile Callable<Message<?>> pollingTask;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private volatile Flux<Message<?>> pollingFlux;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private volatile Subscription subscription;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private volatile ScheduledFuture<?> runningTask;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"protected boolean isReactive() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return false;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"}"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"protected Flux<Message<?>> getPollingFlux() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return this.pollingFlux;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"// LifecycleSupport implementation"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"@Override // guarded by super#lifecycleLock"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"protected void doStart() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (!this.initialized) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"onInit();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"this.pollingTask = createPollingTask();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (isReactive()) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"this.pollingFlux = createFluxGenerator();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"else {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Assert.state(getTaskScheduler() != null, ""unable to start polling, no taskScheduler available"");"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"this.runningTask ="
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"getTaskScheduler()"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".schedule(createPoller(), this.trigger);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private Callable<Message<?>> createPollingTask() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Callable<Message<?>> pollingTask = this::doPoll;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"pollingTask = (Callable<Message<?>>) proxyFactory.getProxy(this.beanClassLoader);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return pollingTask;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private Runnable createPoller() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return () ->"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"this.taskExecutor.execute(() -> {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"int count = 0;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"while (this.initialized && (this.maxMessagesPerPoll <= 0 || count < this.maxMessagesPerPoll)) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (pollForMessage() == null) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"break;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"count++;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"});"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private Flux<Message<?>> createFluxGenerator() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"SimpleTriggerContext triggerContext = new SimpleTriggerContext();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return Flux"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".<Duration>generate(sink -> {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Date date = this.trigger.nextExecutionTime(triggerContext);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (date != null) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"triggerContext.update(date, null, null);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"long millis = date.getTime() - System.currentTimeMillis();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"sink.next(Duration.ofMillis(millis));"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"sink.complete();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"})"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".concatMap(duration ->"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Mono.delay(duration)"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".doOnNext(l ->"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"triggerContext.update(triggerContext.lastScheduledExecutionTime(),"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"new Date(), null))"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".flatMapMany(l ->"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Flux"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".<Message<?>>generate(fluxSink -> {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Message<?> message = pollForMessage();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (message != null) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"fluxSink.next(message);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"fluxSink.complete();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".take(this.maxMessagesPerPoll)"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".subscribeOn(Schedulers.fromExecutor(this.taskExecutor))"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".doOnComplete(() ->"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"triggerContext.lastActualExecutionTime(),"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"new Date())"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,")), 1)"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".repeat(this::isRunning)"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,".doOnSubscribe(subscription -> this.subscription = subscription);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private Message<?> pollForMessage() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return this.pollingTask.call();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (e instanceof MessagingException) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"throw (MessagingException) e;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Message<?> failedMessage = null;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (this.transactionSynchronizationFactory != null) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Object resource = TransactionSynchronizationManager.getResource(getResourceToBind());"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (resource instanceof IntegrationResourceHolder) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"failedMessage = ((IntegrationResourceHolder) resource).getMessage();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"throw new MessagingException(failedMessage, e);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"finally {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Object resource = getResourceToBind();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (TransactionSynchronizationManager.hasResource(resource)) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"TransactionSynchronizationManager.unbindResource(resource);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private Message<?> doPoll() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"IntegrationResourceHolder holder = bindResourceHolderIfNecessary(getResourceKey(), getResourceToBind());"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"Message<?> message;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"message = receiveMessage();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return null;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (!isReactive()) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"try {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"handleMessage(message);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"catch (Exception e) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"throw new MessagingExceptionWrapper(message, (MessagingException) e);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"throw new MessagingException(message, e);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"return message;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"protected void doStop() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (this.runningTask != null) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"this.runningTask.cancel(true);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"this.runningTask = null;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"if (this.subscription != null) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"this.subscription.cancel();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"private Trigger trigger = new PeriodicTrigger(10);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"private ClassLoader beanClassLoader = ClassUtils.getDefaultClassLoader();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"private long maxMessagesPerPoll = -1;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"private TransactionSynchronizationFactory transactionSynchronizationFactory;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"private volatile ScheduledFuture<?> runningTask;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"private volatile Runnable poller;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"private Runnable createPoller() throws Exception {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"Callable<Boolean> pollingTask = this::doPoll;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"pollingTask = (Callable<Boolean>) proxyFactory.getProxy(this.beanClassLoader);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"return new Poller(pollingTask);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"// LifecycleSupport implementation"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"@Override // guarded by super#lifecycleLock"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"protected void doStart() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"if (!this.initialized) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"this.onInit();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"}"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"Assert.state(this.getTaskScheduler() != null,"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"""unable to start polling, no taskScheduler available"");"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"this.poller = createPoller();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"this.initialized = false;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"throw new MessagingException(""Failed to create Poller"", e);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"this.runningTask = this.getTaskScheduler().schedule(this.poller, this.trigger);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"protected void doStop() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"if (this.runningTask != null) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"this.runningTask.cancel(true);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"this.runningTask = null;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"private boolean doPoll() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"IntegrationResourceHolder holder = this.bindResourceHolderIfNecessary("
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"this.getResourceKey(), this.getResourceToBind());"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"Message<?> message = null;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"message = this.receiveMessage();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"return false;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"boolean result;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"result = false;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"try {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"this.handleMessage(message);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"catch (Exception e) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"if (e instanceof MessagingException) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"throw new MessagingExceptionWrapper(message, (MessagingException) e);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"else {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"throw new MessagingException(message, e);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"result = true;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"return result;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"/**"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"* Default Poller implementation"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"*/"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"private final class Poller implements Runnable {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"private final Callable<Boolean> pollingTask;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"Poller(Callable<Boolean> pollingTask) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"this.pollingTask = pollingTask;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"@Override"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"public void run() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"AbstractPollingEndpoint.this.taskExecutor.execute(() -> {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"int count = 0;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"while (AbstractPollingEndpoint.this.initialized"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"&& (AbstractPollingEndpoint.this.maxMessagesPerPoll <= 0"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"|| count < AbstractPollingEndpoint.this.maxMessagesPerPoll)) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"if (!Poller.this.pollingTask.call()) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"break;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"count++;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"throw (MessagingException) e;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"Message<?> failedMessage = null;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"if (AbstractPollingEndpoint.this.transactionSynchronizationFactory != null) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"Object resource = TransactionSynchronizationManager.getResource(getResourceToBind());"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"if (resource instanceof IntegrationResourceHolder) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"failedMessage = ((IntegrationResourceHolder) resource).getMessage();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"throw new MessagingException(failedMessage, e);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"finally {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"Object resource = getResourceToBind();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"if (TransactionSynchronizationManager.hasResource(resource)) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"TransactionSynchronizationManager.unbindResource(resource);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"});"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"import java.time.Duration;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"import java.util.Date;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"import org.reactivestreams.Subscription;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"import org.springframework.scheduling.support.SimpleTriggerContext;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"import reactor.core.publisher.Flux;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"import reactor.core.publisher.Mono;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"import reactor.core.scheduler.Schedulers;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"private ClassLoader beanClassLoader = ClassUtils.getDefaultClassLoader();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"private Trigger trigger = new PeriodicTrigger(10);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"private long maxMessagesPerPoll = -1;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"private TransactionSynchronizationFactory transactionSynchronizationFactory;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"private volatile Callable<Message<?>> pollingTask;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"private volatile Flux<Message<?>> pollingFlux;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"private volatile Subscription subscription;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"private volatile ScheduledFuture<?> runningTask;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"protected boolean isReactive() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"return false;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"}"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"protected Flux<Message<?>> getPollingFlux() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"return this.pollingFlux;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"// LifecycleSupport implementation"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"@Override // guarded by super#lifecycleLock"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"protected void doStart() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"if (!this.initialized) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"onInit();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"this.pollingTask = createPollingTask();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"if (isReactive()) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"this.pollingFlux = createFluxGenerator();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"else {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"Assert.state(getTaskScheduler() != null, ""unable to start polling, no taskScheduler available"");"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"this.runningTask ="
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"getTaskScheduler()"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,".schedule(createPoller(), this.trigger);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"private Callable<Message<?>> createPollingTask() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"Callable<Message<?>> pollingTask = this::doPoll;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"pollingTask = (Callable<Message<?>>) proxyFactory.getProxy(this.beanClassLoader);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"return pollingTask;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"private Runnable createPoller() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"return () ->"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"this.taskExecutor.execute(() -> {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"int count = 0;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"while (this.initialized && (this.maxMessagesPerPoll <= 0 || count < this.maxMessagesPerPoll)) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"if (pollForMessage() == null) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"break;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"count++;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"});"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"private Flux<Message<?>> createFluxGenerator() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"SimpleTriggerContext triggerContext = new SimpleTriggerContext();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"return Flux"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,".<Duration>generate(sink -> {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"Date date = this.trigger.nextExecutionTime(triggerContext);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"if (date != null) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"triggerContext.update(date, null, null);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"long millis = date.getTime() - System.currentTimeMillis();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"sink.next(Duration.ofMillis(millis));"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"sink.complete();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"})"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,".concatMap(duration ->"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"Mono.delay(duration)"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,".doOnNext(l ->"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"triggerContext.update(triggerContext.lastScheduledExecutionTime(),"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"new Date(), null))"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,".flatMapMany(l ->"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"Flux"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,".<Message<?>>generate(fluxSink -> {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"Message<?> message = pollForMessage();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"if (message != null) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"fluxSink.next(message);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"fluxSink.complete();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,".take(this.maxMessagesPerPoll)"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,".subscribeOn(Schedulers.fromExecutor(this.taskExecutor))"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,".doOnComplete(() ->"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"triggerContext.lastActualExecutionTime(),"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"new Date())"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,")), 1)"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,".repeat(this::isRunning)"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,".doOnSubscribe(subscription -> this.subscription = subscription);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"private Message<?> pollForMessage() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"return this.pollingTask.call();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"if (e instanceof MessagingException) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"throw (MessagingException) e;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"Message<?> failedMessage = null;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"if (this.transactionSynchronizationFactory != null) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"Object resource = TransactionSynchronizationManager.getResource(getResourceToBind());"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"if (resource instanceof IntegrationResourceHolder) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"failedMessage = ((IntegrationResourceHolder) resource).getMessage();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"throw new MessagingException(failedMessage, e);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"finally {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"Object resource = getResourceToBind();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"if (TransactionSynchronizationManager.hasResource(resource)) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"TransactionSynchronizationManager.unbindResource(resource);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"private Message<?> doPoll() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"IntegrationResourceHolder holder = bindResourceHolderIfNecessary(getResourceKey(), getResourceToBind());"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"Message<?> message;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"message = receiveMessage();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"return null;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"if (!isReactive()) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"try {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"handleMessage(message);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"catch (Exception e) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"throw new MessagingExceptionWrapper(message, (MessagingException) e);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"throw new MessagingException(message, e);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"return message;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"protected void doStop() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"if (this.runningTask != null) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"this.runningTask.cancel(true);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"this.runningTask = null;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"if (this.subscription != null) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"this.subscription.cancel();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"private Trigger trigger = new PeriodicTrigger(10);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"private ClassLoader beanClassLoader = ClassUtils.getDefaultClassLoader();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"private long maxMessagesPerPoll = -1;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"private TransactionSynchronizationFactory transactionSynchronizationFactory;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"private volatile ScheduledFuture<?> runningTask;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"private volatile Runnable poller;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"private Runnable createPoller() throws Exception {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"Callable<Boolean> pollingTask = this::doPoll;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"pollingTask = (Callable<Boolean>) proxyFactory.getProxy(this.beanClassLoader);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"return new Poller(pollingTask);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"// LifecycleSupport implementation"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"@Override // guarded by super#lifecycleLock"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"protected void doStart() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"if (!this.initialized) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"this.onInit();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"}"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"Assert.state(this.getTaskScheduler() != null,"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"""unable to start polling, no taskScheduler available"");"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"this.poller = createPoller();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"this.initialized = false;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"throw new MessagingException(""Failed to create Poller"", e);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"this.runningTask = this.getTaskScheduler().schedule(this.poller, this.trigger);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"protected void doStop() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"if (this.runningTask != null) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"this.runningTask.cancel(true);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"this.runningTask = null;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"private boolean doPoll() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"IntegrationResourceHolder holder = this.bindResourceHolderIfNecessary("
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"this.getResourceKey(), this.getResourceToBind());"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"Message<?> message = null;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"message = this.receiveMessage();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"return false;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"boolean result;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"result = false;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"try {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"this.handleMessage(message);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"catch (Exception e) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"if (e instanceof MessagingException) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"throw new MessagingExceptionWrapper(message, (MessagingException) e);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"else {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"throw new MessagingException(message, e);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"result = true;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"return result;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"/**"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"* Default Poller implementation"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"*/"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"private final class Poller implements Runnable {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"private final Callable<Boolean> pollingTask;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"Poller(Callable<Boolean> pollingTask) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"this.pollingTask = pollingTask;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"@Override"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"public void run() {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"AbstractPollingEndpoint.this.taskExecutor.execute(() -> {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"int count = 0;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"while (AbstractPollingEndpoint.this.initialized"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"&& (AbstractPollingEndpoint.this.maxMessagesPerPoll <= 0"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"|| count < AbstractPollingEndpoint.this.maxMessagesPerPoll)) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"if (!Poller.this.pollingTask.call()) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"break;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"count++;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"throw (MessagingException) e;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"Message<?> failedMessage = null;"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"if (AbstractPollingEndpoint.this.transactionSynchronizationFactory != null) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"Object resource = TransactionSynchronizationManager.getResource(getResourceToBind());"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"if (resource instanceof IntegrationResourceHolder) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"failedMessage = ((IntegrationResourceHolder) resource).getMessage();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"throw new MessagingException(failedMessage, e);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"finally {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"Object resource = getResourceToBind();"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"if (TransactionSynchronizationManager.hasResource(resource)) {"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"TransactionSynchronizationManager.unbindResource(resource);"
"27353ed3933925e69dc7b9394392e22f07b3f18e","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"});"
"8b4d1e66e55cb5986cc44a01032a491878f9962c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import java.util.function.Consumer;"
"8b4d1e66e55cb5986cc44a01032a491878f9962c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import java.util.function.Function;"
"8b4d1e66e55cb5986cc44a01032a491878f9962c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"final Class<? extends Annotation> annotationType, final String methodNameToUse,"
"8b4d1e66e55cb5986cc44a01032a491878f9962c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"final boolean requiresReply) {"
"8b4d1e66e55cb5986cc44a01032a491878f9962c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"final String methodName;"
"8b4d1e66e55cb5986cc44a01032a491878f9962c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (methodNameToUse == null) {"
"8b4d1e66e55cb5986cc44a01032a491878f9962c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (Function.class.isAssignableFrom(targetClass)) {"
"8b4d1e66e55cb5986cc44a01032a491878f9962c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"methodName = ""apply"";"
"8b4d1e66e55cb5986cc44a01032a491878f9962c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"}"
"8b4d1e66e55cb5986cc44a01032a491878f9962c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"else if (Consumer.class.isAssignableFrom(targetClass)) {"
"8b4d1e66e55cb5986cc44a01032a491878f9962c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"methodName = ""accept"";"
"8b4d1e66e55cb5986cc44a01032a491878f9962c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"else {"
"8b4d1e66e55cb5986cc44a01032a491878f9962c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"methodName = null;"
"8b4d1e66e55cb5986cc44a01032a491878f9962c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"methodName = methodNameToUse;"
"8b4d1e66e55cb5986cc44a01032a491878f9962c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"theMethod = org.springframework.util.ClassUtils"
"8b4d1e66e55cb5986cc44a01032a491878f9962c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".getMostSpecificMethod(theMethod, targetObject.getClass());"
"8b4d1e66e55cb5986cc44a01032a491878f9962c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"final Class<? extends Annotation> annotationType, final String methodName, final boolean requiresReply) {"
"8b4d1e66e55cb5986cc44a01032a491878f9962c","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"theMethod = org.springframework.util.ClassUtils.getMostSpecificMethod(theMethod, targetObject.getClass());"
"0f5cfd4314a1f8fe73ce02c224fb2eebe9fe9516","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import org.springframework.integration.support.AbstractIntegrationMessageBuilder;"
"0f5cfd4314a1f8fe73ce02c224fb2eebe9fe9516","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public void shouldFindAnnotatedAggregatorMethod() {"
"0f5cfd4314a1f8fe73ce02c224fb2eebe9fe9516","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertThat(((AbstractIntegrationMessageBuilder<?>) result).build().getPayload(), is(7));"
"0f5cfd4314a1f8fe73ce02c224fb2eebe9fe9516","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertThat(((AbstractIntegrationMessageBuilder<?>) result).build().getPayload(), is(""[1, 2, 4, 3, 101, 102]""));"
"0f5cfd4314a1f8fe73ce02c224fb2eebe9fe9516","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertThat(((AbstractIntegrationMessageBuilder<?>) result).build().getPayload(), is(""[1, 2, 4]""));"
"0f5cfd4314a1f8fe73ce02c224fb2eebe9fe9516","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertTrue(((AbstractIntegrationMessageBuilder<?>) result).build().getPayload() instanceof Iterator<?>);"
"0f5cfd4314a1f8fe73ce02c224fb2eebe9fe9516","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Object payload = ((AbstractIntegrationMessageBuilder<?>) result).build().getPayload();"
"0f5cfd4314a1f8fe73ce02c224fb2eebe9fe9516","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"public void shouldFindAnnotatedAggregatorMethod() throws Exception {"
"0f5cfd4314a1f8fe73ce02c224fb2eebe9fe9516","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"assertThat(((Message<?>) result).getPayload(), is(7));"
"0f5cfd4314a1f8fe73ce02c224fb2eebe9fe9516","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"assertThat(((Message<?>) result).getPayload(), is(""[1, 2, 4, 3, 101, 102]""));"
"0f5cfd4314a1f8fe73ce02c224fb2eebe9fe9516","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"assertThat(((Message<?>) result).getPayload(), is(""[1, 2, 4]""));"
"0f5cfd4314a1f8fe73ce02c224fb2eebe9fe9516","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"assertTrue(((Message<?>) result).getPayload() instanceof Iterator<?>);"
"0f5cfd4314a1f8fe73ce02c224fb2eebe9fe9516","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Object payload = ((Message<?>) result).getPayload();"
"d7356aa85d44511cda19e8e4c699145e496756e3","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"* Copyright 2002-2018 the original author or authors."
"d7356aa85d44511cda19e8e4c699145e496756e3","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"* @author Artem Bilan"
"d7356aa85d44511cda19e8e4c699145e496756e3","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"addElementToHeaderMapping(""reply-channel"", MessageHeaders.REPLY_CHANNEL);"
"d7356aa85d44511cda19e8e4c699145e496756e3","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"addElementToHeaderMapping(""error-channel"", MessageHeaders.ERROR_CHANNEL);"
"d7356aa85d44511cda19e8e4c699145e496756e3","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"addElementToHeaderMapping(""correlation-id"", IntegrationMessageHeaderAccessor.CORRELATION_ID);"
"d7356aa85d44511cda19e8e4c699145e496756e3","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"addElementToHeaderMapping(""expiration-date"", IntegrationMessageHeaderAccessor.EXPIRATION_DATE,"
"d7356aa85d44511cda19e8e4c699145e496756e3","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"Long.class.getName());"
"d7356aa85d44511cda19e8e4c699145e496756e3","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"addElementToHeaderMapping(""priority"", IntegrationMessageHeaderAccessor.PRIORITY, Integer.class.getName());"
"d7356aa85d44511cda19e8e4c699145e496756e3","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"addElementToHeaderMapping(""routing-slip"", IntegrationMessageHeaderAccessor.ROUTING_SLIP, Map.class.getName());"
"d7356aa85d44511cda19e8e4c699145e496756e3","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"* Copyright 2002-2014 the original author or authors."
"d7356aa85d44511cda19e8e4c699145e496756e3","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"this.addElementToHeaderMapping(""reply-channel"", MessageHeaders.REPLY_CHANNEL);"
"d7356aa85d44511cda19e8e4c699145e496756e3","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"this.addElementToHeaderMapping(""error-channel"", MessageHeaders.ERROR_CHANNEL);"
"d7356aa85d44511cda19e8e4c699145e496756e3","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"this.addElementToHeaderMapping(""correlation-id"", IntegrationMessageHeaderAccessor.CORRELATION_ID);"
"d7356aa85d44511cda19e8e4c699145e496756e3","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"this.addElementToHeaderMapping(""expiration-date"", IntegrationMessageHeaderAccessor.EXPIRATION_DATE, Long.class);"
"d7356aa85d44511cda19e8e4c699145e496756e3","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"this.addElementToHeaderMapping(""priority"", IntegrationMessageHeaderAccessor.PRIORITY, Integer.class);"
"d7356aa85d44511cda19e8e4c699145e496756e3","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"this.addElementToHeaderMapping(""routing-slip"", IntegrationMessageHeaderAccessor.ROUTING_SLIP, Map.class);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"private final Map<String, RedisLock> locks = new ConcurrentHashMap<>();"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"private final String clientId = UUID.randomUUID().toString();"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"private final String registryKey;"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"private final StringRedisTemplate redisTemplate;"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"private final RedisScript<Boolean> obtainLockScript;"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"private final long expireAfter;"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"Boolean success ="
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"RedisLockRegistry.this.redisTemplate.execute(RedisLockRegistry.this.obtainLockScript,"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"Collections.singletonList(this.lockKey), RedisLockRegistry.this.clientId,"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"String.valueOf(RedisLockRegistry.this.expireAfter));"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"boolean result = Boolean.TRUE.equals(success);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"if (result) {"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"return result;"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"if (!isAcquiredInThisProcess()) {"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"throw new IllegalStateException(""Lock was released in the store due to expiration. "" +"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"""The integrity of data protected by this lock may have been compromised."");"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"}"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"return this.lockedAt == other.lockedAt;"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"private final Map<String, RedisLock> locks = new ConcurrentHashMap<>();"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"private final String clientId = UUID.randomUUID().toString();"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"private final String registryKey;"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"private final StringRedisTemplate redisTemplate;"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"private final RedisScript<Boolean> obtainLockScript;"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"private final long expireAfter;"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"boolean success = RedisLockRegistry.this.redisTemplate.execute(RedisLockRegistry.this.obtainLockScript,"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"Collections.singletonList(this.lockKey), RedisLockRegistry.this.clientId,"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"String.valueOf(RedisLockRegistry.this.expireAfter));"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"if (success) {"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"return success;"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"if (this.lockedAt != other.lockedAt) {"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"return false;"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"}"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"return true;"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"return new StringRedisTemplate(getConnectionFactoryForTest());"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"public void testLock() {"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"RedisLockRegistry registry = new RedisLockRegistry(getConnectionFactoryForTest(), this.registryKey);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"public void testReentrantLock() {"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"final RedisLockRegistry registry = new RedisLockRegistry(getConnectionFactoryForTest(), this.registryKey);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"Lock lock1 = registry.obtain(""foo"");"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"AtomicBoolean locked = new AtomicBoolean();"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"CountDownLatch latch1 = new CountDownLatch(1);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"CountDownLatch latch2 = new CountDownLatch(1);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"CountDownLatch latch3 = new CountDownLatch(1);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"RedisLockRegistry registry1 = new RedisLockRegistry(getConnectionFactoryForTest(), this.registryKey);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"RedisLockRegistry registry2 = new RedisLockRegistry(getConnectionFactoryForTest(), this.registryKey);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"Lock lock1 = registry1.obtain(""foo"");"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"Lock lock = registry.obtain(""foo"");"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"CountDownLatch latch = new CountDownLatch(1);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"RedisLockRegistry registry1 = new RedisLockRegistry(getConnectionFactoryForTest(), this.registryKey, 1);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"RedisLockRegistry registry2 = new RedisLockRegistry(getConnectionFactoryForTest(), this.registryKey, 1);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"public void testExceptionOnExpire() throws Exception {"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"RedisLockRegistry registry = new RedisLockRegistry(getConnectionFactoryForTest(), this.registryKey, 1);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"assertTrue(lock1.tryLock());"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"this.thrown.expect(IllegalStateException.class);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"this.thrown.expectMessage(""Lock was released in the store due to expiration."");"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"waitForExpire(""foo"");"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"lock1.unlock();"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"}"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"@Test"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"@RedisAvailable"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"public void testEquals() {"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"RedisConnectionFactory connectionFactory = getConnectionFactoryForTest();"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"RedisLockRegistry registry = new RedisLockRegistry(getConnectionFactoryForTest(), this.registryKey, 100);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","added",0,"StringRedisTemplate template = createTemplate();"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"return new StringRedisTemplate(this.getConnectionFactoryForTest());"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"public void testLock() throws Exception {"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"RedisLockRegistry registry = new RedisLockRegistry(this.getConnectionFactoryForTest(), this.registryKey);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"public void testReentrantLock() throws Exception {"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"final RedisLockRegistry registry = new RedisLockRegistry(this.getConnectionFactoryForTest(), this.registryKey);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"final Lock lock1 = registry.obtain(""foo"");"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"final AtomicBoolean locked = new AtomicBoolean();"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"final CountDownLatch latch1 = new CountDownLatch(1);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"final CountDownLatch latch2 = new CountDownLatch(1);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"final CountDownLatch latch3 = new CountDownLatch(1);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"final RedisLockRegistry registry1 = new RedisLockRegistry(this.getConnectionFactoryForTest(), this.registryKey);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"final RedisLockRegistry registry2 = new RedisLockRegistry(this.getConnectionFactoryForTest(), this.registryKey);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"final Lock lock1 = registry1.obtain(""foo"");"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"final Lock lock = registry.obtain(""foo"");"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"final CountDownLatch latch = new CountDownLatch(1);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"RedisLockRegistry registry1 = new RedisLockRegistry(this.getConnectionFactoryForTest(), this.registryKey, 100);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"RedisLockRegistry registry2 = new RedisLockRegistry(this.getConnectionFactoryForTest(), this.registryKey, 100);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"public void testEquals() throws Exception {"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"RedisConnectionFactory connectionFactory = this.getConnectionFactoryForTest();"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"RedisLockRegistry registry = new RedisLockRegistry(this.getConnectionFactoryForTest(), this.registryKey, 100);"
"c5f29fc6ef4519f0d2f211dede5045154a3c300e","40a535b14090280ffffba341a195d273986fcfa6","deleted",1,"StringRedisTemplate template = this.createTemplate();"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","035d0c01b0c7c136bc98afbad61812af5a0aa3ce","added",0,"* Copyright 2002-2018 the original author or authors."
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","035d0c01b0c7c136bc98afbad61812af5a0aa3ce","added",0,"* @author Artem Bilan"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","035d0c01b0c7c136bc98afbad61812af5a0aa3ce","added",0,"*"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","035d0c01b0c7c136bc98afbad61812af5a0aa3ce","added",0,"private static final ExpressionParser DEFAULT_PARSER = new SpelExpressionParser();"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","035d0c01b0c7c136bc98afbad61812af5a0aa3ce","added",0,"private ExpressionParser parser = DEFAULT_PARSER;"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","035d0c01b0c7c136bc98afbad61812af5a0aa3ce","added",0,"Assert.hasText(expressionString, ""'expressionString' must not be empty or null"");"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","035d0c01b0c7c136bc98afbad61812af5a0aa3ce","added",0,"Assert.notNull(parserConfiguration, ""'parserConfiguration' must not be null"");"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","035d0c01b0c7c136bc98afbad61812af5a0aa3ce","added",0,"protected Expression createInstance() {"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","035d0c01b0c7c136bc98afbad61812af5a0aa3ce","deleted",1,"* Copyright 2002-2010 the original author or authors."
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","035d0c01b0c7c136bc98afbad61812af5a0aa3ce","deleted",1,"private final static ExpressionParser DEFAULT_PARSER = new SpelExpressionParser();"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","035d0c01b0c7c136bc98afbad61812af5a0aa3ce","deleted",1,"private volatile ExpressionParser parser = DEFAULT_PARSER;"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","035d0c01b0c7c136bc98afbad61812af5a0aa3ce","deleted",1,"Assert.hasText(expressionString, ""expressionString must not be empty or null"");"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","035d0c01b0c7c136bc98afbad61812af5a0aa3ce","deleted",1,"Assert.notNull(parserConfiguration, ""parserConfiguration must not be null"");"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","035d0c01b0c7c136bc98afbad61812af5a0aa3ce","deleted",1,"protected Expression createInstance() throws Exception {"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"* Copyright 2002-2018 the original author or authors."
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"private static final Log logger = LogFactory.getLog(BeanFactoryChannelResolver.class);"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"private BeanFactory beanFactory;"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"private HeaderChannelRegistry replyChannelRegistry;"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"* Copyright 2002-2017 the original author or authors."
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"private final static Log logger = LogFactory.getLog(BeanFactoryChannelResolver.class);"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"private volatile BeanFactory beanFactory;"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"private volatile HeaderChannelRegistry replyChannelRegistry;"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","1536b3c539dd24e804659153d184b1ba349b9128","added",0,"* Copyright 2002-2018 the original author or authors."
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","1536b3c539dd24e804659153d184b1ba349b9128","added",0,"import static org.hamcrest.Matchers.startsWith;"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","1536b3c539dd24e804659153d184b1ba349b9128","added",0,"import static org.junit.Assert.assertThat;"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","1536b3c539dd24e804659153d184b1ba349b9128","added",0,"private static volatile int adviceCalled;"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","1536b3c539dd24e804659153d184b1ba349b9128","added",0,"public void checkOrderedGateway() {"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","1536b3c539dd24e804659153d184b1ba349b9128","added",0,"public void testOutboundGatewayWithDirectoryExpression() {"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","1536b3c539dd24e804659153d184b1ba349b9128","added",0,"handler.handleMessage(new GenericMessage<>(""foo""));"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","1536b3c539dd24e804659153d184b1ba349b9128","added",0,"messagingTemplate.sendAndReceive(new GenericMessage<>(""Initial File Content:""));"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","1536b3c539dd24e804659153d184b1ba349b9128","added",0,"Message<?> replyMessage = messagingTemplate.sendAndReceive(new GenericMessage<>(""String content:""));"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","1536b3c539dd24e804659153d184b1ba349b9128","added",0,"messagingTemplate.sendAndReceive(new GenericMessage<>(""String content:""));"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","1536b3c539dd24e804659153d184b1ba349b9128","added",0,"assertThat(e.getMessage(), startsWith(""The destination file already exists at '""));"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","1536b3c539dd24e804659153d184b1ba349b9128","added",0,"Message<?> m = messagingTemplate.sendAndReceive(new GenericMessage<>(""String content:""));"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","1536b3c539dd24e804659153d184b1ba349b9128","added",0,"protected Object doInvoke(ExecutionCallback callback, Object target, Message<?> message) {"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","1536b3c539dd24e804659153d184b1ba349b9128","deleted",1,"* Copyright 2002-2017 the original author or authors."
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","1536b3c539dd24e804659153d184b1ba349b9128","deleted",1,"private volatile static int adviceCalled;"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","1536b3c539dd24e804659153d184b1ba349b9128","deleted",1,"public void checkOrderedGateway() throws Exception {"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","1536b3c539dd24e804659153d184b1ba349b9128","deleted",1,"public void testOutboundGatewayWithDirectoryExpression() throws Exception {"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","1536b3c539dd24e804659153d184b1ba349b9128","deleted",1,"handler.handleMessage(new GenericMessage<String>(""foo""));"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","1536b3c539dd24e804659153d184b1ba349b9128","deleted",1,"messagingTemplate.sendAndReceive(new GenericMessage<String>(""Initial File Content:""));"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","1536b3c539dd24e804659153d184b1ba349b9128","deleted",1,"Message<?> replyMessage = messagingTemplate.sendAndReceive(new GenericMessage<String>(""String content:""));"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","1536b3c539dd24e804659153d184b1ba349b9128","deleted",1,"messagingTemplate.sendAndReceive(new GenericMessage<String>(""String content:""));"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","1536b3c539dd24e804659153d184b1ba349b9128","deleted",1,"assertTrue(e.getMessage().startsWith(""The destination file already exists at '""));"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","1536b3c539dd24e804659153d184b1ba349b9128","deleted",1,"Message<?> m = messagingTemplate.sendAndReceive(new GenericMessage<String>(""String content:""));"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","1536b3c539dd24e804659153d184b1ba349b9128","deleted",1,"protected Object doInvoke(ExecutionCallback callback, Object target, Message<?> message) throws Exception {"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"public static final String DEFAULT_SI_USER_FLAG = ""spring-integration-mail-adapter"";"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"for (Message message1 : messages) {"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"MimeMessage message = (MimeMessage) message1;"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"for (Message message : messages) {"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"message.setFlag(Flags.Flag.DELETED, true);"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"import org.apache.commons.logging.Log;"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"import org.apache.commons.logging.LogFactory;"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"public final static String DEFAULT_SI_USER_FLAG = ""spring-integration-mail-adapter"";"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"protected final Log logger = LogFactory.getLog(getClass()); // NOSONAR safe to use final"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"for (int i = 0; i < messages.length; i++) {"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"MimeMessage message = (MimeMessage) messages[i];"
"93d7c58b64e2bcc95f73e7fd47ccb3e8926683df","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"messages[i].setFlag(Flags.Flag.DELETED, true);"
"6ddcfb3a8dd026901c4470e67fb471d4f3cf0a34","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"* @author Alen Turkovic"
"6ddcfb3a8dd026901c4470e67fb471d4f3cf0a34","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"session.dirty();"
"6ddcfb3a8dd026901c4470e67fb471d4f3cf0a34","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"if (session instanceof CachingSessionFactory<?>.CachedSession) {"
"6ddcfb3a8dd026901c4470e67fb471d4f3cf0a34","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"((CachingSessionFactory.CachedSession) session).dirty();"
"6ddcfb3a8dd026901c4470e67fb471d4f3cf0a34","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"}"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"() -> ""Cannot convert to expected type ("" + this.expectedType + "") from "" + this.method);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"logger.debug(""Failed to convert from JSON"", e);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"() -> ""Target object of type ["" + this.targetObject.getClass() +"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Assert.isNull(ambiguousFallbackType.get(),"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"() -> ""Found ambiguous parameter type ["" + ambiguousFallbackType +"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""] for method match: "" + fallbackMethods.values());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"() -> ""Found ambiguous parameter type ["""
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"UseSpelInvoker useSpel ="
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"AnnotationUtils.findAnnotation(AopUtils.getMostSpecificMethod(methodArg, targetClass),"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"UseSpelInvoker.class);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (interfaces.length == 1) {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"logger.debug(""Exception trying to extract interface"", e);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"StringBuilder sb ="
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"new StringBuilder(""#target."")"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".append(method.getName())"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".append('(');"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""The @Payloads annotation can only be applied "" +"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""if method handler canProcessMessageList."");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Assert.notNull(object, () -> ""required header not available: "" + header);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""Cannot convert to expected type ("" + this.expectedType + "") from "" + this.method);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (logger.isDebugEnabled()) {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"logger.debug(""Failed to convert from JSON"", e);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"}"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""Target object of type ["" + this.targetObject.getClass() +"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.isNull(ambiguousFallbackType.get(), ""Found ambiguous parameter type ["" + ambiguousFallbackType"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"+ ""] for method match: "" + fallbackMethods.values());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""Found ambiguous parameter type ["""
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"UseSpelInvoker useSpel = AnnotationUtils.findAnnotation(AopUtils.getMostSpecificMethod(methodArg, targetClass),"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"UseSpelInvoker.class);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (interfaces != null && interfaces.length == 1) {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"logger.debug(""Exception trying to extract interface"", e);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"StringBuilder sb = new StringBuilder(""#target."" + method.getName() + ""("");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""The @Payloads annotation can only be applied if method handler "" +"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""canProcessMessageList"" +"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""."");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (object == null) {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"throw new IllegalArgumentException(""required header not available: "" + header);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"* Copyright 2002-2019 the original author or authors."
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import static org.hamcrest.CoreMatchers.instanceOf;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import static org.mockito.Mockito.mock;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import org.springframework.beans.factory.BeanFactory;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private final List<Message<?>> messagesUpForProcessing = new ArrayList<>(3);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.messagesUpForProcessing.add(MessageBuilder.withPayload(1).build());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.messagesUpForProcessing.add(MessageBuilder.withPayload(2).build());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.messagesUpForProcessing.add(MessageBuilder.withPayload(4).build());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"MethodInvokingMessageGroupProcessor processor ="
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"new MethodInvokingMessageGroupProcessor(new AnnotatedAggregatorMethod());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"processor.setBeanFactory(mock(BeanFactory.class));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"when(this.messageGroupMock.getMessages()).thenReturn(this.messagesUpForProcessing);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Object result = processor.processMessageGroup(this.messageGroupMock);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public void shouldFindSimpleAggregatorMethod() {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"new MethodInvokingMessageGroupProcessor(new SimpleAggregator());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public void shouldFindSimpleAggregatorMethodForMessages() {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public void shouldFindListPayloads() {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public void shouldFindAnnotatedPayloadsWithNoType() {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.messagesUpForProcessing.add("
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"MessageBuilder.withPayload(3)"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".setHeader(""foo"", Arrays.asList(101, 102))"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".build());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public void shouldUseAnnotatedPayloads() {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return flags.toString();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public void shouldFindSimpleAggregatorMethodWithCollection() {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public void shouldFindSimpleAggregatorMethodWithArray() {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public void shouldFindSimpleAggregatorMethodWithIterator() {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"conversionService.addConverter(new Converter<ArrayList<?>, Iterator<?>>() { // Must not be lambda"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"new MethodInvokingMessageGroupProcessor(new UnannotatedAggregator());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertThat(((AbstractIntegrationMessageBuilder<?>) result).build().getPayload(), instanceOf(Iterator.class));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"new MethodInvokingMessageGroupProcessor(new AnnotatedParametersAggregator());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public void singleAnnotation() {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"aggregator.setBeanFactory(mock(BeanFactory.class));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"group.add(new GenericMessage<>(""foo""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"group.add(new GenericMessage<>(""bar""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public void testHeaderParameters() {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"MethodInvokingMessageGroupProcessor processor = new MethodInvokingMessageGroupProcessor(bean);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertEquals(""foobar"", processor.aggregatePayloads(group, processor.aggregateHeaders(group)));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public void testHeadersParameters() {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public void noAnnotations() {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"handler.setBeanFactory(mock(BeanFactory.class));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"handler.afterPropertiesSet();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"* Copyright 2002-2017 the original author or authors."
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private final List<Message<?>> messagesUpForProcessing = new ArrayList<Message<?>>(3);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"messagesUpForProcessing.add(MessageBuilder.withPayload(1).build());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"messagesUpForProcessing.add(MessageBuilder.withPayload(2).build());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"messagesUpForProcessing.add(MessageBuilder.withPayload(4).build());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"MessageGroupProcessor processor = new MethodInvokingMessageGroupProcessor(new AnnotatedAggregatorMethod());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"when(messageGroupMock.getMessages()).thenReturn(messagesUpForProcessing);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Object result = processor.processMessageGroup(messageGroupMock);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"public void shouldFindSimpleAggregatorMethod() throws Exception {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"MessageGroupProcessor processor = new MethodInvokingMessageGroupProcessor(new SimpleAggregator());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"public void shouldFindSimpleAggregatorMethodForMessages() throws Exception {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"public void shouldFindListPayloads() throws Exception {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"public void shouldFindAnnotatedPayloadsWithNoType() throws Exception {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"messagesUpForProcessing.add(MessageBuilder.withPayload(3).setHeader(""foo"", Arrays.asList(101, 102)).build());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"public void shouldUseAnnotatedPayloads() throws Exception {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"List<Integer> result = new ArrayList<Integer>();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"for (int flag : flags) {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"result.add(flag);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"}"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return result.toString();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"public void shouldFindSimpleAggregatorMethodWithCollection() throws Exception {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"public void shouldFindSimpleAggregatorMethodWithArray() throws Exception {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"public void shouldFindSimpleAggregatorMethodWithIterator() throws Exception {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"MethodInvokingMessageGroupProcessor processor = new MethodInvokingMessageGroupProcessor(new SimpleAggregator());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"conversionService.addConverter(new Converter<ArrayList<?>, Iterator<?>>() {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"MessageGroupProcessor processor = new MethodInvokingMessageGroupProcessor(new UnannotatedAggregator());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"assertTrue(((AbstractIntegrationMessageBuilder<?>) result).build().getPayload() instanceof Iterator<?>);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"MessageGroupProcessor processor = new MethodInvokingMessageGroupProcessor(new AnnotatedParametersAggregator());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"public void singleAnnotation() throws Exception {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"group.add(new GenericMessage<String>(""foo""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"group.add(new GenericMessage<String>(""bar""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"public void testHeaderParameters() throws Exception {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"MethodInvokingMessageGroupProcessor aggregator = new MethodInvokingMessageGroupProcessor(bean);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"assertEquals(""foobar"", aggregator.aggregatePayloads(group, aggregator.aggregateHeaders(group)));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"public void testHeadersParameters() throws Exception {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"public void noAnnotations() throws Exception {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"* Copyright 2002-2019 the original author or authors."
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"import static org.junit.Assert.assertFalse;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"import static org.junit.Assert.assertTrue;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"import org.springframework.beans.factory.BeanFactory;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"adapter.setBeanFactory(mock(BeanFactory.class));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"assertTrue(adapter.canRelease(createListOfMessages(0)));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"assertFalse(adapter.canRelease(createListOfMessages(0)));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"assertTrue(messages.size() > 0);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"return messages.size() >"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"new IntegrationMessageHeaderAccessor(messages.iterator().next()).getSequenceSize();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"MethodInvokingReleaseStrategy adapter = new MethodInvokingReleaseStrategy(new TestReleaseStrategy(),"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"assertTrue(adapter.canRelease(messages));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"return messages.size() > new IntegrationMessageHeaderAccessor(messages.iterator().next())"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,".getSequenceSize();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"StringBuilder buffer = new StringBuilder();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"MethodInvokingReleaseStrategy adapter ="
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"new MethodInvokingReleaseStrategy(new TestReleaseStrategy(), ""invalidParameterType"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"""listSubclassParameter"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"new MethodInvokingReleaseStrategy(new TestReleaseStrategy(), ""wrongReturnType"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"TestReleaseStrategy.class.getMethod(""listSubclassParameter"", LinkedList.class));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"""wrongReturnType"", List.class));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"wrongReturnType.setBeanFactory(mock(BeanFactory.class));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"List<Message<?>> messages = new ArrayList<>();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"messages.add(new GenericMessage<>(""123""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"messages.add(new GenericMessage<>(""456""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"messages.add(new GenericMessage<>(""789""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"* Copyright 2002-2015 the original author or authors."
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"import org.junit.Assert;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"Assert.assertTrue(adapter.canRelease(createListOfMessages(0)));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"Assert.assertTrue(!adapter.canRelease(createListOfMessages(0)));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"Assert.assertTrue(messages.size() > 0);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"return messages.size() > new IntegrationMessageHeaderAccessor(messages.iterator().next()).getSequenceSize();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"ReleaseStrategy adapter = new MethodInvokingReleaseStrategy(new TestReleaseStrategy(),"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"Assert.assertTrue(adapter.canRelease(messages));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"StringBuffer buffer = new StringBuffer();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"ReleaseStrategy adapter = new MethodInvokingReleaseStrategy(new TestReleaseStrategy(), ""invalidParameterType"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"ReleaseStrategy adapter = new MethodInvokingReleaseStrategy(new TestReleaseStrategy(), ""listSubclassParameter"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"ReleaseStrategy adapter = new MethodInvokingReleaseStrategy(new TestReleaseStrategy(), ""wrongReturnType"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"TestReleaseStrategy.class.getMethod(""listSubclassParameter"", new Class<?>[] { LinkedList.class }));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"""wrongReturnType"", new Class<?>[] {List.class}));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"List<Message<?>> messages = new ArrayList<Message<?>>();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"messages.add(new GenericMessage<String>(""123""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"messages.add(new GenericMessage<String>(""456""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"messages.add(new GenericMessage<String>(""789""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"* Copyright 2002-2019 the original author or authors."
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import static org.junit.Assert.assertFalse;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import static org.junit.Assert.assertTrue;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import org.springframework.beans.factory.BeanFactory;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"adapter.setBeanFactory(mock(BeanFactory.class));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertTrue(adapter.canRelease(createListOfMessages(0)));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertFalse(adapter.canRelease(createListOfMessages(0)));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertTrue(messages.size() > 0);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return messages.size() >"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"new IntegrationMessageHeaderAccessor(messages.iterator().next()).getSequenceSize();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"MethodInvokingReleaseStrategy adapter = new MethodInvokingReleaseStrategy(new TestReleaseStrategy(),"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertTrue(adapter.canRelease(messages));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return messages.size() > new IntegrationMessageHeaderAccessor(messages.iterator().next())"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".getSequenceSize();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"StringBuilder buffer = new StringBuilder();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"MethodInvokingReleaseStrategy adapter ="
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"new MethodInvokingReleaseStrategy(new TestReleaseStrategy(), ""invalidParameterType"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""listSubclassParameter"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"new MethodInvokingReleaseStrategy(new TestReleaseStrategy(), ""wrongReturnType"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"TestReleaseStrategy.class.getMethod(""listSubclassParameter"", LinkedList.class));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""wrongReturnType"", List.class));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"wrongReturnType.setBeanFactory(mock(BeanFactory.class));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"List<Message<?>> messages = new ArrayList<>();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"messages.add(new GenericMessage<>(""123""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"messages.add(new GenericMessage<>(""456""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"messages.add(new GenericMessage<>(""789""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"* Copyright 2002-2015 the original author or authors."
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import org.junit.Assert;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.assertTrue(adapter.canRelease(createListOfMessages(0)));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.assertTrue(!adapter.canRelease(createListOfMessages(0)));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.assertTrue(messages.size() > 0);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return messages.size() > new IntegrationMessageHeaderAccessor(messages.iterator().next()).getSequenceSize();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"ReleaseStrategy adapter = new MethodInvokingReleaseStrategy(new TestReleaseStrategy(),"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.assertTrue(adapter.canRelease(messages));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"StringBuffer buffer = new StringBuffer();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"ReleaseStrategy adapter = new MethodInvokingReleaseStrategy(new TestReleaseStrategy(), ""invalidParameterType"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"ReleaseStrategy adapter = new MethodInvokingReleaseStrategy(new TestReleaseStrategy(), ""listSubclassParameter"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"ReleaseStrategy adapter = new MethodInvokingReleaseStrategy(new TestReleaseStrategy(), ""wrongReturnType"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"TestReleaseStrategy.class.getMethod(""listSubclassParameter"", new Class<?>[] { LinkedList.class }));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""wrongReturnType"", new Class<?>[] {List.class}));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"List<Message<?>> messages = new ArrayList<Message<?>>();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"messages.add(new GenericMessage<String>(""123""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"messages.add(new GenericMessage<String>(""456""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"messages.add(new GenericMessage<String>(""789""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* Copyright 2002-2019 the original author or authors."
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import static org.mockito.Mockito.mock;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import org.springframework.beans.factory.BeanFactory;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"assertTrue(latch.await(500, TimeUnit.MILLISECONDS));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"ServiceActivatingHandler handler = new ServiceActivatingHandler(object);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"handler.setBeanFactory(mock(BeanFactory.class));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"handler.afterPropertiesSet();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"return handler;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"* Copyright 2002-2018 the original author or authors."
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"latch.await(500, TimeUnit.MILLISECONDS);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"assertEquals(0, latch.getCount());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"return new ServiceActivatingHandler(object);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"import static org.mockito.Mockito.mock;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"import org.springframework.beans.factory.BeanFactory;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"serviceActivator.setBeanFactory(mock(BeanFactory.class));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"serviceActivator.afterPropertiesSet();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"assertEquals(new IntegrationMessageHeaderAccessor(message).getCorrelationId(),"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"new IntegrationMessageHeaderAccessor(reply).getCorrelationId());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"public void testCorrelationNotPassedFromRequestHeaderIfAlreadySetByHandler() {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"splitter.setBeanFactory(mock(BeanFactory.class));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"splitter.afterPropertiesSet();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"assertTrue(""Sequence details missing"","
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"reply1.getHeaders().containsKey(IntegrationMessageHeaderAccessor.SEQUENCE_DETAILS));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","added",0,"reply2.getHeaders().containsKey(IntegrationMessageHeaderAccessor.SEQUENCE_DETAILS));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"assertEquals(new IntegrationMessageHeaderAccessor(message).getCorrelationId(), new IntegrationMessageHeaderAccessor(reply).getCorrelationId());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"assertTrue(new IntegrationMessageHeaderAccessor(message).getCorrelationId().equals(new IntegrationMessageHeaderAccessor(reply).getCorrelationId()));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"public void testCorrelationNotPassedFromRequestHeaderIfAlreadySetByHandler() throws Exception {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"assertTrue(""Sequence details missing"", reply1.getHeaders().containsKey(IntegrationMessageHeaderAccessor.SEQUENCE_DETAILS));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","c2ee2161a1cc008f2c542a4192dbd3a67a50a8f1","deleted",1,"assertTrue(""Sequence details missing"", reply2.getHeaders().containsKey(IntegrationMessageHeaderAccessor.SEQUENCE_DETAILS));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* Copyright 2002-2019 the original author or authors."
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import static org.junit.Assert.assertNotEquals;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"ServiceActivatingHandler endpoint = createEndpoint();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"ServiceActivatingHandler endpoint = new ServiceActivatingHandler(new TestNullReplyBean(), ""handle"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"endpoint.setBeanFactory(mock(BeanFactory.class));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"endpoint.afterPropertiesSet();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"ServiceActivatingHandler endpoint ="
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"new ServiceActivatingHandler(new Object() {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"@SuppressWarnings(""unused"")"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"public Message<?> handle(Message<?> message) {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"return message;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"}"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"}, ""handle"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"return MessageBuilder.fromMessage(message)"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,".setCorrelationId(""ABC-123"").build();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"assertNotEquals(message.getHeaders().getId(), correlationId);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"ServiceActivatingHandler handler = new ServiceActivatingHandler(new TestBean(), ""handle"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"handler.setBeanFactory(mock(BeanFactory.class));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"handler.afterPropertiesSet();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"return handler;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"return new GenericMessage<>(message.getPayload().toString().toUpperCase());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"* Copyright 2002-2017 the original author or authors."
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"import static org.junit.Assert.assertFalse;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"ServiceActivatingHandler endpoint = this.createEndpoint();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"ServiceActivatingHandler endpoint = new ServiceActivatingHandler("
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"new TestNullReplyBean(), ""handle"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"ServiceActivatingHandler endpoint = new ServiceActivatingHandler(new Object() {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"@SuppressWarnings(""unused"")"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"public Message<?> handle(Message<?> message) {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"return message;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"}"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"}, ""handle"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"return MessageBuilder.fromMessage(message)"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,".setCorrelationId(""ABC-123"").build();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"assertFalse(message.getHeaders().getId().equals(correlationId));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"return new ServiceActivatingHandler(new TestBean(), ""handle"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"return new GenericMessage<String>(message.getPayload().toString().toUpperCase());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public Object resolveArgument(MethodParameter parameter, Message<?> message) {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return ""Person: "" + this.name;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"processor.setBeanFactory(mock(BeanFactory.class));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Object result = processor.processMessage(new GenericMessage<String>(""testing""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Object result = processor.processMessage(new GenericMessage<Integer>(123456789));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Message<?> result = (Message<?>) processor.processMessage(new GenericMessage<String>(""testing""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"MethodInvokingMessageProcessor processor ="
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"new MethodInvokingMessageProcessor(new TestBean(), ""testVoidReturningMethods"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Object result = processor.processMessage(new GenericMessage<>(""456""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"processor.processMessage(new GenericMessage<>(""foo""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertEquals(""foo"", processor.processMessage(new GenericMessage<>(""foo"")));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Message<String> message ="
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"MessageBuilder.withPayload(""foo"")"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".setHeader(""prop"", ""bar"")"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".setHeader(""number"", 42)"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".build();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"helper.setBeanFactory(mock(BeanFactory.class));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public void testInt3199GettersAmbiguity() {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private final Map<String, Object> arguments = new LinkedHashMap<>();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"MessagingMethodInvokerHelper helper ="
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"new MessagingMethodInvokerHelper(new Foo(), ServiceActivator.class, false);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"MessagingMethodInvokerHelper<?> helper ="
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"new MessagingMethodInvokerHelper<>(bean,"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"UseSpelInvokerBean.class.getDeclaredMethod(""foo"", String.class), false);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"SingleMethodJsonWithSpELBean.class.getDeclaredMethod(""foo"","
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"SingleMethodJsonWithSpELBean.Foo.class),"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"false);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"public Object resolveArgument(MethodParameter parameter, Message<?> message) throws Exception {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return ""Person: "" + name;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Object result = processor.processMessage(new GenericMessage<>(""testing""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Object result = processor.processMessage(new GenericMessage<>(123456789));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Message<?> result = (Message<?>) processor.processMessage(new GenericMessage<>(""testing""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"MethodInvokingMessageProcessor processor = new MethodInvokingMessageProcessor(new TestBean(),"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""testVoidReturningMethods"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Object result = processor.processMessage(new GenericMessage<String>(""456""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"processor.processMessage(new GenericMessage<String>(""foo""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"assertEquals(""foo"", processor.processMessage(new GenericMessage<String>(""foo"")));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Message<String> message = MessageBuilder.withPayload(""foo"").setHeader(""prop"", ""bar"").setHeader(""number"", 42)"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".build();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"public void testInt3199GettersAmbiguity() throws Exception {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private final Map<String, Object> arguments = new LinkedHashMap<String, Object>();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"MessagingMethodInvokerHelper helper = new MessagingMethodInvokerHelper(new Foo(), ServiceActivator.class,"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"false);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"MessagingMethodInvokerHelper<?> helper = new MessagingMethodInvokerHelper<>(bean,"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"UseSpelInvokerBean.class.getDeclaredMethod(""foo"", String.class), false);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"SingleMethodJsonWithSpELBean.class.getDeclaredMethod(""foo"","
"eed16f02ca916c57a696c4c4d2a5d33debc55755","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"SingleMethodJsonWithSpELBean.Foo.class),"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* Copyright 2002-2019 the original author or authors."
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import static org.mockito.Mockito.mock;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import org.springframework.beans.factory.BeanFactory;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* @author Artem Bilan"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"handler.setBeanFactory(mock(BeanFactory.class));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"handler.handleMessage(new GenericMessage<>(""test""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"Message<?> message = new GenericMessage<>(""test"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"MethodInvokingMessageHandler handler = new MethodInvokingMessageHandler(new TestSink(),"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"""methodWithReturnValue"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"SynchronousQueue<String> queue = new SynchronousQueue<>();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"Message<String> message = new GenericMessage<>(""testing"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"handler.setBeanFactory(context);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"context.close();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"* Copyright 2002-2016 the original author or authors."
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"handler.handleMessage(new GenericMessage<String>(""test""));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"Message<?> message = new GenericMessage<String>(""test"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"MethodInvokingMessageHandler handler = new MethodInvokingMessageHandler(new TestSink(), ""methodWithReturnValue"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"SynchronousQueue<String> queue = new SynchronousQueue<String>();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"Message<String> message = new GenericMessage<String>(""testing"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"context.stop();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"import org.junit.After;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"private final TestUtils.TestApplicationContext context = TestUtils.createTestApplicationContext();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"this.context.registerBean(""illegalArgumentChannel"", this.illegalArgumentChannel);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"this.context.registerBean(""runtimeExceptionChannel"", this.runtimeExceptionChannel);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"this.context.registerBean(""messageHandlingExceptionChannel"", this.messageHandlingExceptionChannel);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"this.context.registerBean(""messageDeliveryExceptionChannel"", this.messageDeliveryExceptionChannel);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"this.context.registerBean(""defaultChannel"", this.defaultChannel);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"this.context.refresh();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"@After"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"public void terDown() {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"this.context.close();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"}"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"Message<?> failedMessage = new GenericMessage<>(""foo"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"router.setBeanFactory(this.context);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"router.setApplicationContext(this.context);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"router.setDefaultOutputChannel(this.defaultChannel);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"MessageHandlingException error ="
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"new MessageRejectedException(new GenericMessage<Object>(""foo""), ""failed"", rootCause);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"ctx.getBean(ErrorMessageExceptionTypeRouter.class)"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,".handleMessage(new GenericMessage<>(new NullPointerException()));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"import org.springframework.beans.factory.support.DefaultListableBeanFactory;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"private final DefaultListableBeanFactory beanFactory = new DefaultListableBeanFactory();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"beanFactory.registerSingleton(""illegalArgumentChannel"", illegalArgumentChannel);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"beanFactory.registerSingleton(""runtimeExceptionChannel"", runtimeExceptionChannel);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"beanFactory.registerSingleton(""messageHandlingExceptionChannel"", messageHandlingExceptionChannel);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"beanFactory.registerSingleton(""messageDeliveryExceptionChannel"", messageDeliveryExceptionChannel);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"beanFactory.registerSingleton(""defaultChannel"", defaultChannel);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"Message<?> failedMessage = new GenericMessage<String>(""foo"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"router.setBeanFactory(beanFactory);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"router.setApplicationContext(TestUtils.createTestApplicationContext());"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"router.setDefaultOutputChannel(defaultChannel);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"MessageHandlingException error = new MessageRejectedException(new GenericMessage<Object>(""foo""), ""failed"", rootCause);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"ctx.getBean(ErrorMessageExceptionTypeRouter.class).handleMessage(new GenericMessage<>(new NullPointerException()));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"* Copyright 2002-2019 the original author or authors."
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"import static org.mockito.Mockito.mock;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"import org.springframework.beans.factory.BeanFactory;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"router.setBeanFactory(mock(BeanFactory.class));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"router.afterPropertiesSet();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"Message<String> message = new GenericMessage<>(""bar"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"doTestChannelNameResolutionByMessage(router);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"Message<String> fooMessage = new GenericMessage<>(""foo"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"Message<String> barMessage = new GenericMessage<>(""bar"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"Message<String> badMessage = new GenericMessage<>(""bad"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"doTestChannelInstanceResolutionByPayload(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"doTestChannelInstanceResolutionByMessage(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"doTestMultiChannelNameResolutionByPayload(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"doTestMultiChannelNameResolutionByMessage(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"public void multiChannelNameResolutionByMessageConfiguredByMethodName() {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"doTestMultiChannelNameArrayResolutionByMessage(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"doTestMultiChannelListResolutionByPayload(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"doTestMultiChannelListResolutionByMessage(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","added",0,"doTestMultiChannelArrayResolutionByMessage(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"* Copyright 2002-2016 the original author or authors."
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"Message<String> message = new GenericMessage<String>(""bar"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"this.doTestChannelNameResolutionByMessage(router);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"Message<String> fooMessage = new GenericMessage<String>(""foo"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"Message<String> barMessage = new GenericMessage<String>(""bar"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"Message<String> badMessage = new GenericMessage<String>(""bad"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"this.doTestChannelInstanceResolutionByPayload(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"this.doTestChannelInstanceResolutionByMessage(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"this.doTestMultiChannelNameResolutionByPayload(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"this.doTestMultiChannelNameResolutionByMessage(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"public void multiChannelNameResolutionByMessageConfiguredByMethodName() throws Exception {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"this.doTestMultiChannelNameArrayResolutionByMessage(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"this.doTestMultiChannelListResolutionByPayload(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"this.doTestMultiChannelListResolutionByMessage(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","0754889c5cd3346d02a8085e5fcfa9992532fbad","deleted",1,"this.doTestMultiChannelArrayResolutionByMessage(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"* Copyright 2002-2019 the original author or authors."
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"import static org.mockito.Mockito.mock;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"import org.springframework.beans.factory.BeanFactory;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"router.setBeanFactory(mock(BeanFactory.class));"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"router.afterPropertiesSet();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"Message<String> message = new GenericMessage<>(""bar"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"doTestChannelNameResolutionByMessage(router);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"Message<String> fooMessage = new GenericMessage<>(""foo"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"Message<String> barMessage = new GenericMessage<>(""bar"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"Message<String> badMessage = new GenericMessage<>(""bad"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"doTestChannelInstanceResolutionByPayload(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"doTestChannelInstanceResolutionByMessage(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"doTestMultiChannelNameResolutionByPayload(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"doTestMultiChannelNameResolutionByMessage(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"public void multiChannelNameResolutionByMessageConfiguredByMethodName() {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"doTestMultiChannelNameArrayResolutionByMessage(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"doTestMultiChannelListResolutionByPayload(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"doTestMultiChannelListResolutionByMessage(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","added",0,"doTestMultiChannelArrayResolutionByMessage(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"* Copyright 2002-2016 the original author or authors."
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"Message<String> message = new GenericMessage<String>(""bar"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"this.doTestChannelNameResolutionByMessage(router);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"Message<String> fooMessage = new GenericMessage<String>(""foo"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"Message<String> barMessage = new GenericMessage<String>(""bar"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"Message<String> badMessage = new GenericMessage<String>(""bad"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"this.doTestChannelInstanceResolutionByPayload(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"this.doTestChannelInstanceResolutionByMessage(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"this.doTestMultiChannelNameResolutionByPayload(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"this.doTestMultiChannelNameResolutionByMessage(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"public void multiChannelNameResolutionByMessageConfiguredByMethodName() throws Exception {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"this.doTestMultiChannelNameArrayResolutionByMessage(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"this.doTestMultiChannelListResolutionByPayload(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"this.doTestMultiChannelListResolutionByMessage(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","cb90d396574275e70869b6520cf3b7274af770cf","deleted",1,"this.doTestMultiChannelArrayResolutionByMessage(router, channelResolver);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","added",0,"* Copyright 2002-2019 the original author or authors."
"eed16f02ca916c57a696c4c4d2a5d33debc55755","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","added",0,"handler.setRequestFactory("
"eed16f02ca916c57a696c4c4d2a5d33debc55755","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","added",0,"(uri, httpMethod) -> {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","added",0,"uriHolder.set(uri);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","added",0,"throw new RuntimeException(""intentional"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","added",0,"});"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","added",0,"context.close();"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","deleted",1,"* Copyright 2002-2018 the original author or authors."
"eed16f02ca916c57a696c4c4d2a5d33debc55755","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","deleted",1,"import org.springframework.http.HttpMethod;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","deleted",1,"import org.springframework.http.client.ClientHttpRequest;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","deleted",1,"import org.springframework.http.client.SimpleClientHttpRequestFactory;"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","deleted",1,"handler.setRequestFactory(new SimpleClientHttpRequestFactory() {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","deleted",1,"@Override"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","deleted",1,"public ClientHttpRequest createRequest(URI uri, HttpMethod httpMethod) {"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","deleted",1,"uriHolder.set(uri);"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","deleted",1,"throw new RuntimeException(""intentional"");"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","deleted",1,"}"
"eed16f02ca916c57a696c4c4d2a5d33debc55755","2955ef989e091af55b3f18c3b24ebf9b0e0ab49f","deleted",1,"});"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"try {"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"obtainFolder();"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"MimeMessage[] filteredMessages = searchAndFilterMessages();"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (this.headerMapper != null) {"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"org.springframework.messaging.Message<?>[] converted ="
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"new org.springframework.messaging.Message<?>[filteredMessages.length];"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"int n = 0;"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"for (MimeMessage message : filteredMessages) {"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"Map<String, Object> headers = this.headerMapper.toHeaders(message);"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"converted[n++] ="
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"getMessageBuilderFactory()"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,".withPayload(extractContent(message, headers))"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,".copyHeaders(headers)"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,".build();"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"}"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"return converted;"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"else {"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"return filteredMessages;"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"finally {"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"MailTransportUtils.closeFolder(this.folder, this.shouldDeleteMessages);"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"this.folderReadLock.unlock();"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"private void obtainFolder() throws MessagingException {"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"private MimeMessage[] searchAndFilterMessages() throws MessagingException {"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (this.logger.isInfoEnabled()) {"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"this.logger.info(""attempting to receive mail from folder ["" + this.folder.getFullName() + ""]"");"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"Message[] messages = searchForNewMessages();"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (this.maxFetchSize > 0 && messages.length > this.maxFetchSize) {"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"Message[] reducedMessages = new Message[this.maxFetchSize];"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"System.arraycopy(messages, 0, reducedMessages, 0, this.maxFetchSize);"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"messages = reducedMessages;"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (this.logger.isDebugEnabled()) {"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"this.logger.debug(""found "" + messages.length + "" new messages"");"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (messages.length > 0) {"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"fetchMessages(messages);"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"this.logger.debug(""Received "" + messages.length + "" messages"");"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"MimeMessage[] filteredMessages = filterMessagesThruSelector(messages);"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"postProcessFilteredMessages(filteredMessages);"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"*"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"* @since 2.2"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"return obtainFolderInstance();"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"folder = getFolder();"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"try {"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (this.logger.isInfoEnabled()) {"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.logger.info(""attempting to receive mail from folder ["" + folder.getFullName() + ""]"");"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"}"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Message[] messages = searchForNewMessages();"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (this.maxFetchSize > 0 && messages.length > this.maxFetchSize) {"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Message[] reducedMessages = new Message[this.maxFetchSize];"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"System.arraycopy(messages, 0, reducedMessages, 0, this.maxFetchSize);"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"messages = reducedMessages;"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (this.logger.isDebugEnabled()) {"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.logger.debug(""found "" + messages.length + "" new messages"");"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (messages.length > 0) {"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"fetchMessages(messages);"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.logger.debug(""Received "" + messages.length + "" messages"");"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"MimeMessage[] filteredMessages = filterMessagesThruSelector(messages);"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"postProcessFilteredMessages(filteredMessages);"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (this.headerMapper != null) {"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"org.springframework.messaging.Message<?>[] converted ="
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"new org.springframework.messaging.Message<?>[filteredMessages.length];"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"int n = 0;"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"for (MimeMessage message : filteredMessages) {"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Map<String, Object> headers = this.headerMapper.toHeaders(message);"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"converted[n++] ="
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"getMessageBuilderFactory()"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,".withPayload(extractContent(message, headers))"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,".copyHeaders(headers)"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,".build();"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"return converted;"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"else {"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"return filteredMessages;"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"finally {"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"MailTransportUtils.closeFolder(folder, this.shouldDeleteMessages);"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.folderReadLock.unlock();"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"*"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"* @since 2.2"
"119db815c21e659f2099cdc6a54e9e3048ffb5ec","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"return AbstractMailReceiver.this.obtainFolderInstance();"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"import java.io.OutputStream;"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"import java.util.stream.Collectors;"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"private static final PosixFilePermission[] POSIX_FILE_PERMISSIONS ="
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"{"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"PosixFilePermission.OTHERS_EXECUTE,"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"PosixFilePermission.OTHERS_WRITE,"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"PosixFilePermission.OTHERS_READ,"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"PosixFilePermission.GROUP_EXECUTE,"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"PosixFilePermission.GROUP_WRITE,"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"PosixFilePermission.GROUP_READ,"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"PosixFilePermission.OWNER_EXECUTE,"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"PosixFilePermission.OWNER_WRITE,"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"PosixFilePermission.OWNER_READ"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"};"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"private final Map<String, FileState> fileStates = new HashMap<>();"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"/**"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"* Configure a {@link TaskScheduler} for flush operations."
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"* @param taskScheduler the {@link TaskScheduler} to use."
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"*/"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"public void setTaskScheduler(TaskScheduler taskScheduler) { // NOSONAR"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"setChmod(Integer.parseInt(chmod, 8)); // NOSONAR 8-bit"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"Assert.isTrue(chmod >= 0 && chmod <= 0777, // NOSONAR permissions octal"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"""'chmod' must be between 0 and 0777 (octal)"");"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"BitSet bits = BitSet.valueOf(new byte[] { (byte) chmod, (byte) (chmod >> 8) }); // NOSONAR"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"this.permissions = bits.stream()"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,".boxed()"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,".map((b) -> POSIX_FILE_PERMISSIONS[b])"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,".collect(Collectors.toSet());"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"this.evaluationContext, null, ""destinationDirectoryExpression"");"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"this.flushTask = taskScheduler.scheduleAtFixedRate(new Flusher(), this.flushInterval / 3); // NOSONAR"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"while (n++ < 10 && this.fileStates.size() > 0) { // NOSONAR"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"@Override // NOSONAR"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"File destinationDirectoryToUse = evaluateDestinationDirectoryExpression(requestMessage);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"boolean ignore = (FileExistsMode.IGNORE.equals(this.fileExistsMode) // NOSONAR"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"resultFile = writeMessageToFile(requestMessage, originalFileFromHeader, tempFile, resultFile,"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"timestamp);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"if (resultFile != null && originalFileFromHeader == null && payload instanceof File) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"return getMessageBuilderFactory()"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,".withPayload(resultFile)"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,".setHeader(FileHeaders.ORIGINAL_FILE, payload);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"private File writeMessageToFile(Message<?> requestMessage, File originalFileFromHeader, File tempFile,"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"File resultFile, Object timestamp) throws IOException {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"File fileToReturn = null;"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"Object payload = requestMessage.getPayload();"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"if (payload instanceof File) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"fileToReturn = handleFileMessage((File) payload, tempFile, resultFile, requestMessage);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"}"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"else if (payload instanceof InputStream) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"fileToReturn = handleInputStreamMessage((InputStream) payload, originalFileFromHeader, tempFile,"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"resultFile, requestMessage);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"else if (payload instanceof byte[]) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"fileToReturn = handleByteArrayMessage((byte[]) payload, originalFileFromHeader, tempFile, resultFile,"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"requestMessage);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"else if (payload instanceof String) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"fileToReturn = handleStringMessage((String) payload, originalFileFromHeader, tempFile, resultFile,"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"else {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"throw new IllegalArgumentException("
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"""Unsupported Message payload type ["" + payload.getClass().getName() + ""]"");"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"if (this.preserveTimestamp) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"if (timestamp instanceof Number) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"if (!fileToReturn.setLastModified(((Number) timestamp).longValue())) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"throw new IllegalStateException(""Could not set last modified '"" + timestamp"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"+ ""' timestamp on file: "" + fileToReturn);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"else if (this.logger.isWarnEnabled()) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"this.logger.warn(""Could not set lastModified, header "" + FileHeaders.SET_MODIFIED"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"+ "" must be a Number, not "" + (timestamp == null ? ""null"" : timestamp.getClass()));"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"return fileToReturn;"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"appendStreamToFile(fileToWriteTo, sourceFileInputStream);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"try (InputStream inputStream = sourceFileInputStream;"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"OutputStream outputStream ="
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"new BufferedOutputStream(new FileOutputStream(tempFile), this.bufferSize)) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"int bytesRead;"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"while ((bytesRead = inputStream.read(buffer)) != -1) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"outputStream.write(buffer, 0, bytesRead);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"outputStream.write(System.lineSeparator().getBytes());"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"outputStream.flush();"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"cleanUpAfterCopy(tempFile, resultFile, originalFile);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"return resultFile;"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"private void appendStreamToFile(File fileToWriteTo, InputStream sourceFileInputStream) throws IOException {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"FileState state = getFileState(fileToWriteTo, false);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"BufferedOutputStream bos = null;"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"try (InputStream inputStream = sourceFileInputStream) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"bos = state != null ? state.stream : createOutputStream(fileToWriteTo, true);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"byte[] buffer = new byte[StreamUtils.BUFFER_SIZE];"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"int bytesRead = -1;"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"bos.write(buffer, 0, bytesRead);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"if (FileWritingMessageHandler.this.appendNewLine) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"bos.write(System.lineSeparator().getBytes());"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"finally {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"try {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"if (state == null || FileWritingMessageHandler.this.flushTask == null) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"clearState(fileToWriteTo, state);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"state.lastWrite = System.currentTimeMillis();"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"catch (IOException ex) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"writeBytesToFile(fileToWriteTo, append, bytes);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"cleanUpAfterCopy(fileToWriteTo, resultFile, originalFile);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"private void writeBytesToFile(File fileToWriteTo, boolean append, byte[] bytes) throws IOException {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"bos = state != null ? state.stream : createOutputStream(fileToWriteTo, append);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"bos.write(bytes);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"if (this.appendNewLine) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"if (state == null || this.flushTask == null) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"if (bos != null) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"bos.close();"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"writeStringToFile(fileToWriteTo, append, content);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"private void writeStringToFile(File fileToWriteTo, boolean append, String content) throws IOException {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"FileState state = getFileState(fileToWriteTo, true);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"BufferedWriter writer = null;"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"writer = state != null ? state.writer : createWriter(fileToWriteTo, append);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"writer.write(content);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"writer.newLine();"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"if (writer != null) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"writer.close();"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"if (this.deleteSourceFiles && originalFile != null && !originalFile.delete()) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"throw new IllegalStateException(""Could not delete original file: "" + originalFile);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"if (state != null // NOSONAR"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"&& ((isString && state.stream != null) || (!isString && state.writer != null))) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"import java.util.HashSet;"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"import org.apache.commons.logging.Log;"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"import org.apache.commons.logging.LogFactory;"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"private final Log logger = LogFactory.getLog(this.getClass());"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"private final Map<String, FileState> fileStates = new HashMap<String, FileState>();"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"public void setTaskScheduler(TaskScheduler taskScheduler) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"setChmod(Integer.parseInt(chmod, 8));"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"Assert.isTrue(chmod >= 0 && chmod <= 0777, ""'chmod' must be between 0 and 0777 (octal)"");"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"/*"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"* Bitset.valueOf(byte[]) takes a little-endian array of bytes to create a BitSet."
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"* Since we are interested in 9 bits, we construct an array with the low-order byte"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"* (bits 0-7) followed by the second order byte (bit 8)."
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"* BitSet.stream() returns a stream of ints representing those bits that are set."
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"* We use that stream with a switch to create the set of PosixFilePermissions"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"* representing the bits that were set in the chmod value."
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"*/"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"BitSet bits = BitSet.valueOf(new byte[] { (byte) chmod, (byte) (chmod >> 8) });"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"final Set<PosixFilePermission> posixPermissions = new HashSet<>();"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"bits.stream().forEach(b -> {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"switch (b) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"case 0:"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"posixPermissions.add(PosixFilePermission.OTHERS_EXECUTE);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"break;"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"case 1:"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"posixPermissions.add(PosixFilePermission.OTHERS_WRITE);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"case 2:"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"posixPermissions.add(PosixFilePermission.OTHERS_READ);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"case 3:"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"posixPermissions.add(PosixFilePermission.GROUP_EXECUTE);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"case 4:"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"posixPermissions.add(PosixFilePermission.GROUP_WRITE);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"case 5:"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"posixPermissions.add(PosixFilePermission.GROUP_READ);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"case 6:"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"posixPermissions.add(PosixFilePermission.OWNER_EXECUTE);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"case 7:"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"posixPermissions.add(PosixFilePermission.OWNER_WRITE);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"case 8:"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"posixPermissions.add(PosixFilePermission.OWNER_READ);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"}"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"});"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"this.permissions = posixPermissions;"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"this.evaluationContext, null, ""destinationDirectoryExpression"");"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"this.flushTask = taskScheduler.scheduleAtFixedRate(new Flusher(), this.flushInterval / 3);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"while (n++ < 10 && this.fileStates.size() > 0) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"@Override"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"Assert.notNull(requestMessage, ""message must not be null"");"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"Assert.notNull(payload, ""message payload must not be null"");"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"final File destinationDirectoryToUse = evaluateDestinationDirectoryExpression(requestMessage);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"boolean ignore = (FileExistsMode.IGNORE.equals(this.fileExistsMode)"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"if (payload instanceof File) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"resultFile = handleFileMessage((File) payload, tempFile, resultFile, requestMessage);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"else if (payload instanceof InputStream) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"resultFile = handleInputStreamMessage((InputStream) payload, originalFileFromHeader, tempFile,"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"resultFile, requestMessage);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"else if (payload instanceof byte[]) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"resultFile = this.handleByteArrayMessage("
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"(byte[]) payload, originalFileFromHeader, tempFile, resultFile, requestMessage);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"else if (payload instanceof String) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"resultFile = this.handleStringMessage("
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"(String) payload, originalFileFromHeader, tempFile, resultFile, requestMessage);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"else {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"throw new IllegalArgumentException("
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"""unsupported Message payload type ["" + payload.getClass().getName() + ""]"");"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"if (this.preserveTimestamp) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"if (timestamp instanceof Number) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"resultFile.setLastModified(((Number) timestamp).longValue());"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"if (this.logger.isWarnEnabled()) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"this.logger.warn(""Could not set lastModified, header "" + FileHeaders.SET_MODIFIED"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"+ "" must be a Number, not "" + (timestamp == null ? ""null"" : timestamp.getClass()));"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"if (resultFile != null) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"if (originalFileFromHeader == null && payload instanceof File) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"return this.getMessageBuilderFactory().withPayload(resultFile)"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,".setHeader(FileHeaders.ORIGINAL_FILE, payload);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"FileState state = getFileState(fileToWriteTo, false);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"BufferedOutputStream bos = null;"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"try {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"bos = state != null ? state.stream : createOutputStream(fileToWriteTo, true);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"byte[] buffer = new byte[StreamUtils.BUFFER_SIZE];"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"int bytesRead = -1;"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"while ((bytesRead = sourceFileInputStream.read(buffer)) != -1) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"bos.write(buffer, 0, bytesRead);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"if (FileWritingMessageHandler.this.appendNewLine) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"bos.write(System.lineSeparator().getBytes());"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"finally {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"sourceFileInputStream.close();"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"catch (IOException ex) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"if (state == null || FileWritingMessageHandler.this.flushTask == null) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"if (bos != null) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"bos.close();"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"clearState(fileToWriteTo, state);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"state.lastWrite = System.currentTimeMillis();"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"bos = new BufferedOutputStream(new FileOutputStream(tempFile), this.bufferSize);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"bos.flush();"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"cleanUpAfterCopy(tempFile, resultFile, originalFile);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"return resultFile;"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"bos = state != null ? state.stream : createOutputStream(fileToWriteTo, append);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"bos.write(bytes);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"this.cleanUpAfterCopy(fileToWriteTo, resultFile, originalFile);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"FileState state = getFileState(fileToWriteTo, true);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"BufferedWriter writer = null;"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"writer = state != null ? state.writer : createWriter(fileToWriteTo, append);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"writer.write(content);"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"writer.newLine();"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"if (writer != null) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"writer.close();"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"if (this.deleteSourceFiles && originalFile != null) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"originalFile.delete();"
"a609bd939817aed4605891b5402d28d4671fa4fb","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"if (state != null && ((isString && state.stream != null) || (!isString && state.writer != null))) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"import java.io.OutputStream;"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"import java.util.stream.Collectors;"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"private static final PosixFilePermission[] POSIX_FILE_PERMISSIONS ="
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"{"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"PosixFilePermission.OTHERS_EXECUTE,"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"PosixFilePermission.OTHERS_WRITE,"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"PosixFilePermission.OTHERS_READ,"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"PosixFilePermission.GROUP_EXECUTE,"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"PosixFilePermission.GROUP_WRITE,"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"PosixFilePermission.GROUP_READ,"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"PosixFilePermission.OWNER_EXECUTE,"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"PosixFilePermission.OWNER_WRITE,"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"PosixFilePermission.OWNER_READ"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"};"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"private final Map<String, FileState> fileStates = new HashMap<>();"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"/**"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"* Configure a {@link TaskScheduler} for flush operations."
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"* @param taskScheduler the {@link TaskScheduler} to use."
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"*/"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"public void setTaskScheduler(TaskScheduler taskScheduler) { // NOSONAR"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"setChmod(Integer.parseInt(chmod, 8)); // NOSONAR 8-bit"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"Assert.isTrue(chmod >= 0 && chmod <= 0777, // NOSONAR permissions octal"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"""'chmod' must be between 0 and 0777 (octal)"");"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"BitSet bits = BitSet.valueOf(new byte[] { (byte) chmod, (byte) (chmod >> 8) }); // NOSONAR"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"this.permissions = bits.stream()"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,".boxed()"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,".map((b) -> POSIX_FILE_PERMISSIONS[b])"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,".collect(Collectors.toSet());"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"this.evaluationContext, null, ""destinationDirectoryExpression"");"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"this.flushTask = taskScheduler.scheduleAtFixedRate(new Flusher(), this.flushInterval / 3); // NOSONAR"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"while (n++ < 10 && this.fileStates.size() > 0) { // NOSONAR"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"@Override // NOSONAR"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"File destinationDirectoryToUse = evaluateDestinationDirectoryExpression(requestMessage);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"boolean ignore = (FileExistsMode.IGNORE.equals(this.fileExistsMode) // NOSONAR"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"resultFile = writeMessageToFile(requestMessage, originalFileFromHeader, tempFile, resultFile,"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"timestamp);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"if (resultFile != null && originalFileFromHeader == null && payload instanceof File) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"return getMessageBuilderFactory()"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,".withPayload(resultFile)"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,".setHeader(FileHeaders.ORIGINAL_FILE, payload);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"private File writeMessageToFile(Message<?> requestMessage, File originalFileFromHeader, File tempFile,"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"File resultFile, Object timestamp) throws IOException {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"File fileToReturn = null;"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"Object payload = requestMessage.getPayload();"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"if (payload instanceof File) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"fileToReturn = handleFileMessage((File) payload, tempFile, resultFile, requestMessage);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"}"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"else if (payload instanceof InputStream) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"fileToReturn = handleInputStreamMessage((InputStream) payload, originalFileFromHeader, tempFile,"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"resultFile, requestMessage);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"else if (payload instanceof byte[]) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"fileToReturn = handleByteArrayMessage((byte[]) payload, originalFileFromHeader, tempFile, resultFile,"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"requestMessage);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"else if (payload instanceof String) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"fileToReturn = handleStringMessage((String) payload, originalFileFromHeader, tempFile, resultFile,"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"else {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"throw new IllegalArgumentException("
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"""Unsupported Message payload type ["" + payload.getClass().getName() + ""]"");"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"if (this.preserveTimestamp) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"if (timestamp instanceof Number) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"if (!fileToReturn.setLastModified(((Number) timestamp).longValue())) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"throw new IllegalStateException(""Could not set last modified '"" + timestamp"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"+ ""' timestamp on file: "" + fileToReturn);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"else if (this.logger.isWarnEnabled()) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"this.logger.warn(""Could not set lastModified, header "" + FileHeaders.SET_MODIFIED"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"+ "" must be a Number, not "" + (timestamp == null ? ""null"" : timestamp.getClass()));"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"return fileToReturn;"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"appendStreamToFile(fileToWriteTo, sourceFileInputStream);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"try (InputStream inputStream = sourceFileInputStream;"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"OutputStream outputStream ="
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"new BufferedOutputStream(new FileOutputStream(tempFile), this.bufferSize)) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"int bytesRead;"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"while ((bytesRead = inputStream.read(buffer)) != -1) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"outputStream.write(buffer, 0, bytesRead);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"outputStream.write(System.lineSeparator().getBytes());"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"outputStream.flush();"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"cleanUpAfterCopy(tempFile, resultFile, originalFile);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"return resultFile;"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"private void appendStreamToFile(File fileToWriteTo, InputStream sourceFileInputStream) throws IOException {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"FileState state = getFileState(fileToWriteTo, false);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"BufferedOutputStream bos = null;"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"try (InputStream inputStream = sourceFileInputStream) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"bos = state != null ? state.stream : createOutputStream(fileToWriteTo, true);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"byte[] buffer = new byte[StreamUtils.BUFFER_SIZE];"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"int bytesRead = -1;"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"bos.write(buffer, 0, bytesRead);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"if (FileWritingMessageHandler.this.appendNewLine) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"bos.write(System.lineSeparator().getBytes());"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"finally {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"try {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"if (state == null || FileWritingMessageHandler.this.flushTask == null) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"clearState(fileToWriteTo, state);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"state.lastWrite = System.currentTimeMillis();"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"catch (IOException ex) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"writeBytesToFile(fileToWriteTo, append, bytes);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"cleanUpAfterCopy(fileToWriteTo, resultFile, originalFile);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"private void writeBytesToFile(File fileToWriteTo, boolean append, byte[] bytes) throws IOException {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"bos = state != null ? state.stream : createOutputStream(fileToWriteTo, append);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"bos.write(bytes);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"if (this.appendNewLine) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"if (state == null || this.flushTask == null) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"if (bos != null) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"bos.close();"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"writeStringToFile(fileToWriteTo, append, content);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"private void writeStringToFile(File fileToWriteTo, boolean append, String content) throws IOException {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"FileState state = getFileState(fileToWriteTo, true);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"BufferedWriter writer = null;"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"writer = state != null ? state.writer : createWriter(fileToWriteTo, append);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"writer.write(content);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"writer.newLine();"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"if (writer != null) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"writer.close();"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"if (this.deleteSourceFiles && originalFile != null && !originalFile.delete()) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"throw new IllegalStateException(""Could not delete original file: "" + originalFile);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"if (state != null // NOSONAR"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","added",0,"&& ((isString && state.stream != null) || (!isString && state.writer != null))) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"import java.util.HashSet;"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"import org.apache.commons.logging.Log;"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"import org.apache.commons.logging.LogFactory;"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"private final Log logger = LogFactory.getLog(this.getClass());"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"private final Map<String, FileState> fileStates = new HashMap<String, FileState>();"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"public void setTaskScheduler(TaskScheduler taskScheduler) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"setChmod(Integer.parseInt(chmod, 8));"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"Assert.isTrue(chmod >= 0 && chmod <= 0777, ""'chmod' must be between 0 and 0777 (octal)"");"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"/*"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"* Bitset.valueOf(byte[]) takes a little-endian array of bytes to create a BitSet."
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"* Since we are interested in 9 bits, we construct an array with the low-order byte"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"* (bits 0-7) followed by the second order byte (bit 8)."
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"* BitSet.stream() returns a stream of ints representing those bits that are set."
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"* We use that stream with a switch to create the set of PosixFilePermissions"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"* representing the bits that were set in the chmod value."
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"*/"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"BitSet bits = BitSet.valueOf(new byte[] { (byte) chmod, (byte) (chmod >> 8) });"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"final Set<PosixFilePermission> posixPermissions = new HashSet<>();"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"bits.stream().forEach(b -> {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"switch (b) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"case 0:"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"posixPermissions.add(PosixFilePermission.OTHERS_EXECUTE);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"break;"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"case 1:"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"posixPermissions.add(PosixFilePermission.OTHERS_WRITE);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"case 2:"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"posixPermissions.add(PosixFilePermission.OTHERS_READ);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"case 3:"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"posixPermissions.add(PosixFilePermission.GROUP_EXECUTE);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"case 4:"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"posixPermissions.add(PosixFilePermission.GROUP_WRITE);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"case 5:"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"posixPermissions.add(PosixFilePermission.GROUP_READ);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"case 6:"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"posixPermissions.add(PosixFilePermission.OWNER_EXECUTE);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"case 7:"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"posixPermissions.add(PosixFilePermission.OWNER_WRITE);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"case 8:"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"posixPermissions.add(PosixFilePermission.OWNER_READ);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"}"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"});"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"this.permissions = posixPermissions;"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"this.evaluationContext, null, ""destinationDirectoryExpression"");"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"this.flushTask = taskScheduler.scheduleAtFixedRate(new Flusher(), this.flushInterval / 3);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"while (n++ < 10 && this.fileStates.size() > 0) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"@Override"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"Assert.notNull(requestMessage, ""message must not be null"");"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"Assert.notNull(payload, ""message payload must not be null"");"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"final File destinationDirectoryToUse = evaluateDestinationDirectoryExpression(requestMessage);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"boolean ignore = (FileExistsMode.IGNORE.equals(this.fileExistsMode)"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"if (payload instanceof File) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"resultFile = handleFileMessage((File) payload, tempFile, resultFile, requestMessage);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"else if (payload instanceof InputStream) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"resultFile = handleInputStreamMessage((InputStream) payload, originalFileFromHeader, tempFile,"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"resultFile, requestMessage);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"else if (payload instanceof byte[]) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"resultFile = this.handleByteArrayMessage("
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"(byte[]) payload, originalFileFromHeader, tempFile, resultFile, requestMessage);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"else if (payload instanceof String) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"resultFile = this.handleStringMessage("
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"(String) payload, originalFileFromHeader, tempFile, resultFile, requestMessage);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"else {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"throw new IllegalArgumentException("
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"""unsupported Message payload type ["" + payload.getClass().getName() + ""]"");"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"if (this.preserveTimestamp) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"if (timestamp instanceof Number) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"resultFile.setLastModified(((Number) timestamp).longValue());"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"if (this.logger.isWarnEnabled()) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"this.logger.warn(""Could not set lastModified, header "" + FileHeaders.SET_MODIFIED"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"+ "" must be a Number, not "" + (timestamp == null ? ""null"" : timestamp.getClass()));"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"if (resultFile != null) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"if (originalFileFromHeader == null && payload instanceof File) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"return this.getMessageBuilderFactory().withPayload(resultFile)"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,".setHeader(FileHeaders.ORIGINAL_FILE, payload);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"FileState state = getFileState(fileToWriteTo, false);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"BufferedOutputStream bos = null;"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"try {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"bos = state != null ? state.stream : createOutputStream(fileToWriteTo, true);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"byte[] buffer = new byte[StreamUtils.BUFFER_SIZE];"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"int bytesRead = -1;"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"while ((bytesRead = sourceFileInputStream.read(buffer)) != -1) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"bos.write(buffer, 0, bytesRead);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"if (FileWritingMessageHandler.this.appendNewLine) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"bos.write(System.lineSeparator().getBytes());"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"finally {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"sourceFileInputStream.close();"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"catch (IOException ex) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"if (state == null || FileWritingMessageHandler.this.flushTask == null) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"if (bos != null) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"bos.close();"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"clearState(fileToWriteTo, state);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"state.lastWrite = System.currentTimeMillis();"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"bos = new BufferedOutputStream(new FileOutputStream(tempFile), this.bufferSize);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"bos.flush();"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"cleanUpAfterCopy(tempFile, resultFile, originalFile);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"return resultFile;"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"bos = state != null ? state.stream : createOutputStream(fileToWriteTo, append);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"bos.write(bytes);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"this.cleanUpAfterCopy(fileToWriteTo, resultFile, originalFile);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"FileState state = getFileState(fileToWriteTo, true);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"BufferedWriter writer = null;"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"writer = state != null ? state.writer : createWriter(fileToWriteTo, append);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"writer.write(content);"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"writer.newLine();"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"if (writer != null) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"writer.close();"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"if (this.deleteSourceFiles && originalFile != null) {"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"originalFile.delete();"
"a609bd939817aed4605891b5402d28d4671fa4fb","6da3307943ddf8c41f30f95473cfee4f22bdbe14","deleted",1,"if (state != null && ((isString && state.stream != null) || (!isString && state.writer != null))) {"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"private static final String PROTOCOL = ""imap"";"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"setProtocol(PROTOCOL);"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"Assert.isTrue(url.toLowerCase().startsWith(PROTOCOL),"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"this.cancelIdleInterval = cancelIdleInterval * 1000; // NOSONAR - convert seconds to milliseconds"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"for (String name : new String[] { PROTOCOL, ""imaps"" }) {"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (this.pingTask != null) {"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"this.pingTask.cancel(true);"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"}"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"openFolder();"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"Folder folder = getFolder();"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"() -> ""folder is not an instance of ["" + IMAPFolder.class.getName() + ""]"");"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"else if (!folder.getPermanentFlags().contains(Flags.Flag.RECENT) && searchForNewMessages().length > 0) {"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"return;"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"Folder folderToUse = getFolder();"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"Flags supportedFlags = folderToUse.getPermanentFlags();"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"SearchTerm searchTerm = compileSearchTerms(supportedFlags);"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (folderToUse.isOpen()) {"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"return nullSafeMessages(searchTerm != null ? folderToUse.search(searchTerm) : folderToUse.getMessages());"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"catch (Exception ex) {"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"logger.error(""Error during resetting idle state."", ex);"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"searchTerm = applyTermsWhenNoRecentFlag(folder, searchTerm);"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"return searchTerm;"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"private SearchTerm applyTermsWhenNoRecentFlag(Folder folder, SearchTerm searchTerm) {"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"NotTerm notFlagged = null;"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (folder.getPermanentFlags().contains(Flag.USER)) {"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (logger.isDebugEnabled()) {"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"Flags siFlags = new Flags();"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"siFlags.add(getUserFlag());"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"notFlagged = new NotTerm(new FlagTerm(siFlags, true));"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"else {"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"logger.debug(""This email server does not support RECENT or USER flags. "" +"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"""System flag 'Flag.FLAGGED' will be used to prevent duplicates during email fetch."");"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"notFlagged = new NotTerm(new FlagTerm(new Flags(Flag.FLAGGED), true));"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (searchTerm == null) {"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"return notFlagged;"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"return new AndTerm(searchTerm, notFlagged);"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.setProtocol(""imap"");"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Assert.isTrue(url.toLowerCase().startsWith(""imap""),"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.cancelIdleInterval = cancelIdleInterval * 1000;"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"for (String name : new String[]{""imap"", ""imaps""}) {"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.openFolder();"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Folder folder = this.getFolder();"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"""folder is not an instance of ["" + IMAPFolder.class.getName() + ""]"");"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"else if (!folder.getPermanentFlags().contains(Flags.Flag.RECENT)) {"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (searchForNewMessages().length > 0) {"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"return;"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"}"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Flags supportedFlags = this.getFolder().getPermanentFlags();"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"SearchTerm searchTerm = this.compileSearchTerms(supportedFlags);"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (folder.isOpen()) {"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"return nullSafeMessages(searchTerm != null ? folder.search(searchTerm) : folder.getMessages());"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"catch (Exception ignore) {"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"NotTerm notFlagged = null;"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (folder.getPermanentFlags().contains(Flags.Flag.USER)) {"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Flags siFlags = new Flags();"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"siFlags.add(getUserFlag());"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"notFlagged = new NotTerm(new FlagTerm(siFlags, true));"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"else {"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"logger.debug(""This email server does not support RECENT or USER flags. "" +"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"""System flag 'Flag.FLAGGED' will be used to prevent duplicates during email fetch."");"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"notFlagged = new NotTerm(new FlagTerm(new Flags(Flags.Flag.FLAGGED), true));"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (searchTerm == null) {"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"searchTerm = notFlagged;"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"searchTerm = new AndTerm(searchTerm, notFlagged);"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"return searchTerm;"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"* Copyright 2002-2019 the original author or authors."
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"import javax.mail.Folder;"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"public static final String PROTOCOL = ""pop3"";"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"setProtocol(PROTOCOL);"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"Assert.isTrue(url.startsWith(PROTOCOL), ""url must start with 'pop3'"");"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"super(new URLName(PROTOCOL, host, port, ""INBOX"", username, password));"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"Folder folderToUse = getFolder();"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"int messageCount = folderToUse.getMessageCount();"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"return folderToUse.getMessages();"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"for (Message message : messages) {"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"new MimeMessage((MimeMessage) message);"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"* Copyright 2002-2011 the original author or authors."
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.setProtocol(""pop3"");"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Assert.isTrue(url.startsWith(""pop3""), ""url must start with 'pop3'"");"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"super(new URLName(""pop3"", host, port, ""INBOX"", username, password));"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"int messageCount = this.getFolder().getMessageCount();"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"return this.getFolder().getMessages();"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"*"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"for (int i = 0; i < messages.length; i++) {"
"5295a76b42812981d208e8896d720b596e07265d","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"new MimeMessage((MimeMessage) messages[i]);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"* Copyright 2002-2019 the original author or authors."
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"*"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"* @author Artem Bilan"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"/**"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"* A default retry interval for the {@link ClientModeConnectionManager} rescheduling."
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"*/"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"public static final long DEFAULT_RETRY_INTERVAL = 60000;"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"protected final Object lifecycleMonitor = new Object(); // NOSONAR"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"private final Map<String, TcpConnection> connections = new ConcurrentHashMap<>();"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"private AbstractConnectionFactory clientConnectionFactory;"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"private AbstractConnectionFactory serverConnectionFactory;"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"private boolean isClientMode;"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"private boolean isSingleUse;"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"private long retryInterval = DEFAULT_RETRY_INTERVAL;"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"TcpConnection connection;"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"public void handleMessageInternal(final Message<?> message) {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"handleMessageAsServer(message);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"}"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"else {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"handleMessageAsClient(message);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"private void handleMessageAsServer(Message<?> message) {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"// We don't own the connection, we are asynchronously replying"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"String connectionId = message.getHeaders().get(IpHeaders.CONNECTION_ID, String.class);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"TcpConnection connection = null;"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"if (connectionId != null) {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"connection = this.connections.get(connectionId);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"if (connection != null) {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"try {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"connection.send(message);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"catch (Exception ex) {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"logger.error(""Error sending message"", ex);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"connection.close();"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"throw wrapToMessageHandlingExceptionIfNecessary(message, ""Error sending message"", ex);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"finally {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"if (this.isSingleUse) { // close after replying"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"logger.error(""Unable to find outbound socket for "" + message);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"MessageHandlingException messageHandlingException ="
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"new MessageHandlingException(message, ""Unable to find outbound socket"");"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"publishNoConnectionEvent(messageHandlingException, connectionId);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"throw messageHandlingException;"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"private MessageHandlingException wrapToMessageHandlingExceptionIfNecessary(Message<?> message, String description,"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"Throwable cause) {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"if (cause instanceof MessageHandlingException) {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"throw (MessageHandlingException) cause;"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"throw new MessageHandlingException(message, description, cause);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"private void handleMessageAsClient(Message<?> message) {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"// we own the connection"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"connection = doWrite(message);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"catch (MessageHandlingException e) {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"// retry - socket may have closed"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"if (e.getCause() instanceof IOException) {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"if (logger.isDebugEnabled()) {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"logger.debug(""Fail on first write attempt"", e);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"throw e;"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"if (connection != null && this.isSingleUse"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"&& this.clientConnectionFactory.getListener() == null) {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"// if there's no collaborating inbound adapter, close immediately, otherwise"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"// it will close after receiving the reply."
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"throw wrapToMessageHandlingExceptionIfNecessary(message,"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"""Failed to handle message using "" + connectionId, ex);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"new TcpConnectionFailedCorrelationEvent(this, connectionId, messageHandlingException));"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"Assert.notNull(this.clientConnectionFactory, ""For client-mode, connection factory must be type='client'"");"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"Assert.notNull(this.clientConnectionFactory,"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"""For client-mode, connection factory must be type='client'"");"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"ClientModeConnectionManager manager ="
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"new ClientModeConnectionManager(this.clientConnectionFactory);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"Assert.state(getTaskScheduler() != null, ""Client mode requires a task scheduler"");"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"this.scheduledFuture = getTaskScheduler().scheduleAtFixedRate(manager, this.retryInterval);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"* Copyright 2002-2018 the original author or authors."
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"import org.springframework.scheduling.TaskScheduler;"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"private volatile AbstractConnectionFactory clientConnectionFactory;"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"private volatile AbstractConnectionFactory serverConnectionFactory;"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"private final Map<String, TcpConnection> connections = new ConcurrentHashMap<String, TcpConnection>();"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"private volatile boolean isClientMode;"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"private volatile boolean isSingleUse;"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"private volatile long retryInterval = 60000;"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"protected final Object lifecycleMonitor = new Object();"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"TcpConnection connection = null;"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"public void handleMessageInternal(final Message<?> message) throws"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"MessageHandlingException {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"// We don't own the connection, we are asynchronously replying"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"Object connectionId = message.getHeaders().get(IpHeaders.CONNECTION_ID);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"if (connectionId != null) {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"connection = this.connections.get(connectionId);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"if (connection != null) {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"try {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"connection.send(message);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"}"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"catch (Exception e) {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"logger.error(""Error sending message"", e);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"if (e instanceof MessageHandlingException) {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"throw (MessageHandlingException) e;"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"else {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"throw new MessageHandlingException(message, ""Error sending message"", e);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"finally {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"if (this.isSingleUse) { // close after replying"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"connection.close();"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"logger.error(""Unable to find outbound socket for "" + message);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"MessageHandlingException messageHandlingException = new MessageHandlingException(message,"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"""Unable to find outbound socket"");"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"publishNoConnectionEvent(messageHandlingException, (String) connectionId);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"throw messageHandlingException;"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"return;"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"// we own the connection"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"catch (MessageHandlingException e) {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"// retry - socket may have closed"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"if (e.getCause() instanceof IOException) {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"if (logger.isDebugEnabled()) {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"logger.debug(""Fail on first write attempt"", e);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"connection = doWrite(message);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"throw e;"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"if (connection != null && this.isSingleUse"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"&& this.clientConnectionFactory.getListener() == null) {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"// if there's no collaborating inbound adapter, close immediately, otherwise"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"// it will close after receiving the reply."
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"throw new MessageHandlingException(message, ""Failed to handle message using "" + connectionId, e);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"new TcpConnectionFailedCorrelationEvent(this, connectionId, messageHandlingException));"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"Assert.notNull(this.clientConnectionFactory,"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"""For client-mode, connection factory must be type='client'"");"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"ClientModeConnectionManager manager = new ClientModeConnectionManager("
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"this.clientConnectionFactory);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"Assert.state(this.getTaskScheduler() != null, ""Client mode requires a task scheduler"");"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"this.scheduledFuture = this.getTaskScheduler().scheduleAtFixedRate(manager, this.retryInterval);"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"@Override // super class is protected"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"public void setTaskScheduler(TaskScheduler taskScheduler) {"
"020ea76d59de8e82e1744f3f2d9ba0f4e75cce25","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"super.setTaskScheduler(taskScheduler);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"* Copyright 2002-2019 the original author or authors."
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"*"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private final MessagingMethodInvokerHelper delegate;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.delegate = new MessagingMethodInvokerHelper(targetObject, method, expectedType, true);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.delegate = new MessagingMethodInvokerHelper(targetObject, method, true);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.delegate = new MessagingMethodInvokerHelper(targetObject, methodName,"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.delegate = new MessagingMethodInvokerHelper(targetObject, methodName, true);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.delegate = new MessagingMethodInvokerHelper(targetObject, annotationType, Object.class, true);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"@SuppressWarnings(""unchecked"")"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return (T) this.delegate.process(messages, aggregateHeaders);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"* Copyright 2002-2018 the original author or authors."
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private final MessagingMethodInvokerHelper<T> delegate;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.delegate = new MessagingMethodInvokerHelper<T>(targetObject, method, expectedType, true);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.delegate = new MessagingMethodInvokerHelper<T>(targetObject, method, true);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.delegate = new MessagingMethodInvokerHelper<T>(targetObject, methodName,"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.delegate = new MessagingMethodInvokerHelper<T>(targetObject, methodName, true);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.delegate = new MessagingMethodInvokerHelper<T>(targetObject, annotationType, Object.class, true);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"try {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return this.delegate.process(messages, aggregateHeaders);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"}"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"catch (RuntimeException e) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"throw e;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"catch (Exception e) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"throw new IllegalStateException(""Failed to process message list"", e);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public class MessagingMethodInvokerHelper extends AbstractExpressionEvaluator implements Lifecycle {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private static final Log LOGGER = LogFactory.getLog(MessagingMethodInvokerHelper.class);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private static final TypeDescriptor MESSAGE_TYPE_DESCRIPTOR = TypeDescriptor.valueOf(Message.class);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private static final TypeDescriptor MESSAGE_LIST_TYPE_DESCRIPTOR ="
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"TypeDescriptor.collection(Collection.class, TypeDescriptor.valueOf(Message.class));"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private static final TypeDescriptor MESSAGE_ARRAY_TYPE_DESCRIPTOR = TypeDescriptor.valueOf(Message[].class);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private HandlerMethod handlerMethod;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private Class<? extends Annotation> annotationType;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private volatile String displayString;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private volatile boolean requiresReply;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private volatile boolean initialized;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private boolean useSpelInvoker;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public Object process(Message<?> message) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public Object process(Collection<Message<?>> messages, Map<String, Object> headers) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private void prepareEvaluationContext() {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"try {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"context.registerFunction(""requiredHeader"","
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"ParametersWrapper.class.getDeclaredMethod(""getHeader"", Map.class, String.class));"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"}"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"catch (NoSuchMethodException ex) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"throw new IllegalStateException(ex);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private Object processInternal(ParametersWrapper parameters) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Object result;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return getEvaluationContext(true)"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private synchronized void initialize() {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"LOGGER.info(""Overriding default instance of MessageHandlerMethodFactory with provided one."");"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (beanFactory != null) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"payloadExpressionArgumentResolver.setBeanFactory(beanFactory);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"payloadsArgumentResolver.setBeanFactory(beanFactory);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"mapArgumentResolver.setBeanFactory(beanFactory);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"collectionArgumentResolver.setBeanFactory(beanFactory);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private Object invokeHandlerMethod(HandlerMethod handlerMethod, ParametersWrapper parameters) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return handlerMethod.invoke(parameters);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"catch (MethodArgumentResolutionException | MessageConversionException | IllegalStateException ex) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return processInvokeExceptionAndFallbackToExpressionIfAny(handlerMethod, parameters, ex);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"catch (RuntimeException ex) { // NOSONAR no way to handle conditional catch according Sonar rules"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"throw ex;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"catch (Exception ex) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"throw new IllegalStateException(""HandlerMethod invocation error"", ex);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private Object processInvokeExceptionAndFallbackToExpressionIfAny(HandlerMethod handlerMethod,"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"ParametersWrapper parameters, RuntimeException ex) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (ex instanceof MessageConversionException) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (ex.getCause() instanceof ConversionFailedException &&"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"!(ex.getCause().getCause() instanceof ConverterNotFoundException)) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"else if (ex instanceof IllegalStateException && // NOSONAR complex boolean expression"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"(!(ex.getCause() instanceof IllegalArgumentException) ||"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"!ex.getStackTrace()[0].getClassName().equals(InvocableHandlerMethod.class.getName()) ||"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"(!""argument type mismatch"".equals(ex.getCause().getMessage()) &&"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"// JVM generates GeneratedMethodAccessor### after several calls with less error"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"// checking"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"!ex.getCause().getMessage().startsWith(""java.lang.ClassCastException@"")))) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return fallbackToInvokeExpression(handlerMethod, parameters);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private Object fallbackToInvokeExpression(HandlerMethod handlerMethod, ParametersWrapper parameters) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Expression expression = handlerMethod.expression;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (++handlerMethod.failedAttempts >= FAILED_ATTEMPTS_THRESHOLD) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"handlerMethod.spelOnly = true;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (LOGGER.isInfoEnabled()) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"LOGGER.info(""Failed to invoke [ "" + handlerMethod.invocableHandlerMethod +"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""] with provided arguments [ "" + parameters + "" ]. \n"" +"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""Falling back to SpEL invocation for expression [ "" +"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"expression.getExpressionString() + "" ]"");"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return invokeExpression(expression, parameters);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private Object invokeExpression(Expression expression, ParametersWrapper parameters) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return evaluateExpression(expression, parameters);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"throw processEvaluationException(ex);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private RuntimeException processEvaluationException(Exception ex) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Throwable evaluationException = ex;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if ((ex instanceof EvaluationException || ex instanceof MessageHandlingException)"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"&& ex.getCause() != null) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"evaluationException = ex.getCause();"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (evaluationException instanceof RuntimeException) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return (RuntimeException) evaluationException;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return new IllegalStateException(""Cannot process message"", evaluationException);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if ((parameters.getPayload() instanceof String && !type.equals(String.class) // NOSONAR"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"doConvertJsonPayload(parameters);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private void doConvertJsonPayload(ParametersWrapper parameters) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Object targetPayload ="
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.jsonObjectMapper.fromJson(parameters.getPayload(), this.handlerMethod.targetParameterType);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (this.handlerMethod.targetParameterTypeDescriptor.isAssignableTo(MESSAGE_TYPE_DESCRIPTOR)) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"parameters.message ="
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"getMessageBuilderFactory()"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".withPayload(targetPayload)"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".copyHeaders(parameters.getHeaders())"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".build();"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"else {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"parameters.payload = targetPayload;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"catch (Exception e) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"LOGGER.debug(""Failed to convert from JSON"", e);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (LOGGER.isDebugEnabled()) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"LOGGER.debug(""Method ["" + method1 + ""] is not eligible for Message handling """
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"LOGGER.debug(""Method ["" + method1 + ""] is not eligible for Message handling."", e);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"LOGGER.debug(targetObject.getClass() +"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"BeanFactory beanFactory = getBeanFactory();"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (beanFactory instanceof ConfigurableBeanFactory) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return ((ConfigurableBeanFactory) beanFactory).resolveEmbeddedValue(value);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"LOGGER.debug(""Exception trying to extract interface"", e);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return method != null && // NOSONAR"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"public Object invoke(ParametersWrapper parameters) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return this.invocableHandlerMethod.invoke(message);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"throw new IllegalStateException(""InvocableHandlerMethod invoke error"", ex);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"else if (parameterTypeDescriptor.isAssignableTo(MESSAGE_TYPE_DESCRIPTOR)) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"(parameterTypeDescriptor.isAssignableTo(MESSAGE_LIST_TYPE_DESCRIPTOR)"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"|| parameterTypeDescriptor.isAssignableTo(MESSAGE_ARRAY_TYPE_DESCRIPTOR))) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"public class MessagingMethodInvokerHelper<T> extends AbstractExpressionEvaluator implements Lifecycle {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private static final Log logger = LogFactory.getLog(MessagingMethodInvokerHelper.class);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private static final TypeDescriptor messageTypeDescriptor = TypeDescriptor.valueOf(Message.class);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"@SuppressWarnings(""unused"")"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private static final Collection<Message<?>> dummyMessages = Collections.emptyList();"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private static final TypeDescriptor messageListTypeDescriptor ="
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"new TypeDescriptor(ReflectionUtils.findField(MessagingMethodInvokerHelper.class, // NOSONAR never null"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""dummyMessages""));"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private static final TypeDescriptor messageArrayTypeDescriptor = TypeDescriptor.valueOf(Message[].class);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private volatile String displayString;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private volatile boolean requiresReply;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private HandlerMethod handlerMethod;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private Class<? extends Annotation> annotationType;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private volatile boolean initialized;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private boolean useSpelInvoker;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"public T process(Message<?> message) throws Exception {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"public T process(Collection<Message<?>> messages, Map<String, Object> headers) throws Exception {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private void prepareEvaluationContext() throws Exception {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"context.registerFunction(""requiredHeader"", ParametersWrapper.class.getDeclaredMethod(""getHeader"","
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Map.class, String.class));"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"@SuppressWarnings(""unchecked"")"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private T processInternal(ParametersWrapper parameters) throws Exception {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"T result;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return (T) getEvaluationContext(true)"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private synchronized void initialize() throws Exception {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"logger.info(""Overriding default instance of MessageHandlerMethodFactory with provided one."");"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"payloadExpressionArgumentResolver.setBeanFactory(beanFactory);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"payloadsArgumentResolver.setBeanFactory(beanFactory);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"mapArgumentResolver.setBeanFactory(beanFactory);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"collectionArgumentResolver.setBeanFactory(beanFactory);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private T invokeHandlerMethod(HandlerMethod handlerMethod, ParametersWrapper parameters) throws Exception {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return (T) handlerMethod.invoke(parameters);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"catch (MethodArgumentResolutionException | MessageConversionException | IllegalStateException e) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (e instanceof MessageConversionException) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (e.getCause() instanceof ConversionFailedException &&"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"!(e.getCause().getCause() instanceof ConverterNotFoundException)) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"throw e;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"}"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"else if (e instanceof IllegalStateException) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (!(e.getCause() instanceof IllegalArgumentException) ||"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"!e.getStackTrace()[0].getClassName().equals(InvocableHandlerMethod.class.getName()) ||"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"(!""argument type mismatch"".equals(e.getCause().getMessage()) &&"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"// JVM generates GeneratedMethodAccessor### after several calls with less error"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"// checking"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"!e.getCause().getMessage().startsWith(""java.lang.ClassCastException@""))) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Expression expression = handlerMethod.expression;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (++handlerMethod.failedAttempts >= FAILED_ATTEMPTS_THRESHOLD) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"handlerMethod.spelOnly = true;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (logger.isInfoEnabled()) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"logger.info(""Failed to invoke [ "" + handlerMethod.invocableHandlerMethod +"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""] with provided arguments [ "" + parameters + "" ]. \n"" +"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""Falling back to SpEL invocation for expression [ "" +"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"expression.getExpressionString() + "" ]"");"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return invokeExpression(expression, parameters);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private T invokeExpression(Expression expression, ParametersWrapper parameters) throws Exception {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return (T) evaluateExpression(expression, parameters);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"catch (Exception e) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Throwable evaluationException = e;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if ((e instanceof EvaluationException || e instanceof MessageHandlingException)"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"&& e.getCause() != null) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"evaluationException = e.getCause();"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (evaluationException instanceof Exception) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"throw (Exception) evaluationException;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"else {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"throw new IllegalStateException(""Cannot process message"", evaluationException);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if ((parameters.getPayload() instanceof String && !type.equals(String.class)"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"try {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Object targetPayload = this.jsonObjectMapper.fromJson(parameters.getPayload(), type);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (this.handlerMethod.targetParameterTypeDescriptor.isAssignableTo(messageTypeDescriptor)) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"parameters.message ="
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"getMessageBuilderFactory()"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".withPayload(targetPayload)"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".copyHeaders(parameters.getHeaders())"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".build();"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"parameters.payload = targetPayload;"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"logger.debug(""Failed to convert from JSON"", e);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (logger.isDebugEnabled()) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"logger.debug(""Method ["" + method1 + ""] is not eligible for Message handling """
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"logger.debug(""Method ["" + method1 + ""] is not eligible for Message handling."", e);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"logger.debug(targetObject.getClass() +"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (getBeanFactory() != null && getBeanFactory() instanceof ConfigurableBeanFactory) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return ((ConfigurableBeanFactory) getBeanFactory()).resolveEmbeddedValue(value);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"logger.debug(""Exception trying to extract interface"", e);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return method != null &&"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"public <T> T invoke(ParametersWrapper parameters) throws Exception {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return (T) this.invocableHandlerMethod.invoke(message);"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"else if (parameterTypeDescriptor.isAssignableTo(messageTypeDescriptor)) {"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"(parameterTypeDescriptor.isAssignableTo(messageListTypeDescriptor)"
"d2e974a6de2cc1869dbce668593c939fece28c27","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"|| parameterTypeDescriptor.isAssignableTo(messageArrayTypeDescriptor))) {"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"import org.junit.jupiter.api.Test;"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"import org.springframework.beans.factory.annotation.Autowired;"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"import org.springframework.test.context.junit.jupiter.SpringJUnitConfig;"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"@SpringJUnitConfig"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"@Autowired"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"void testDefaultResequencerProperties() {"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,".as(""The ResequencerEndpoint is not configured with the appropriate 'send partial results on "" +"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"""timeout'"" +"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,""" "" +"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"void testPropertyAssignment() {"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"EventDrivenConsumer endpoint = this.context.getBean(""completelyDefinedResequencer"", EventDrivenConsumer.class);"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"assertThat(getPropertyValue(resequencer, ""outputChannelName""))"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,".isEqualTo(""outputChannel"");"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"assertThat(getPropertyValue(resequencer, ""discardChannelName""))"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,".isEqualTo(""discardChannel"");"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,".as(""The ResequencerEndpoint is not configured with the appropriate "" +"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"""'send partial results on timeout' flag"")"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"void testCorrelationStrategyRefOnly() {"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"void testReleaseStrategyRefOnly() {"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"void testReleaseStrategyRefAndMethod() {"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"void shouldSetReleasePartialSequencesFlag() {"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"EventDrivenConsumer endpoint = (EventDrivenConsumer) context.getBean(""completelyDefinedResequencer"");"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"ResequencingMessageHandler resequencer = TestUtils.getPropertyValue(endpoint, ""handler"","
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"ResequencingMessageHandler.class);"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"void testCorrelationStrategyRefAndMethod() {"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","added",0,"public boolean bar(List<Message<?>> __) {"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"import org.junit.Before;"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"import org.junit.Test;"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"import org.springframework.context.support.ClassPathXmlApplicationContext;"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"import org.springframework.messaging.MessageChannel;"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"@Before"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"public void setUp() {"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"this.context = new ClassPathXmlApplicationContext(""resequencerParserTests.xml"", this.getClass());"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"}"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"public void testDefaultResequencerProperties() {"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,".as(""The ResequencerEndpoint is not configured with the appropriate 'send partial results on timeout' "" +"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"public void testPropertyAssignment() throws Exception {"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"EventDrivenConsumer endpoint = (EventDrivenConsumer) context.getBean(""completelyDefinedResequencer"");"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"MessageChannel outputChannel = (MessageChannel) context.getBean(""outputChannel"");"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"MessageChannel discardChannel = (MessageChannel) context.getBean(""discardChannel"");"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"assertThat(getPropertyValue(resequencer, ""outputChannel""))"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,".isEqualTo(outputChannel);"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"assertThat(getPropertyValue(resequencer, ""discardChannel""))"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,".isEqualTo(discardChannel);"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"""flag"")"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"public void testCorrelationStrategyRefOnly() throws Exception {"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"public void testReleaseStrategyRefOnly() throws Exception {"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"public void testReleaseStrategyRefAndMethod() throws Exception {"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"public void shouldSetReleasePartialSequencesFlag() {"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"ResequencingMessageHandler resequencer = TestUtils.getPropertyValue(endpoint, ""handler"","
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"ResequencingMessageHandler.class);"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"public void testCorrelationStrategyRefAndMethod() throws Exception {"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"@SuppressWarnings(""unused"")"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"private static <T> Message<T> createMessage(T payload, Object correlationId, int sequenceSize, int sequenceNumber,"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"MessageChannel outputChannel) {"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"return MessageBuilder.withPayload(payload).setCorrelationId(correlationId).setSequenceSize(sequenceSize)"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,".setSequenceNumber(sequenceNumber).setReplyChannel(outputChannel).build();"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","515ed698a601959ce97e332b82e1e119deb5eed6","deleted",1,"public boolean bar(List<Message<?>> messages) {"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"import static org.assertj.core.api.Assertions.assertThatIllegalArgumentException;"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"import org.springframework.context.ConfigurableApplicationContext;"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"MessagingAnnotationPostProcessor postProcessor = prepareMessagingAnnotationPostProcessor(context);"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"inputChannel.send(new GenericMessage<>(""world""));"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"AbstractApplicationContext context ="
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"new ClassPathXmlApplicationContext(""simpleAnnotatedEndpointTests.xml"", getClass());"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"GenericMessage<String> messageToSend = new GenericMessage<>(""world"");"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"testChannel.send(new GenericMessage<>(""foo""));"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"@Test"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"assertThatIllegalArgumentException()"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,".isThrownBy(postProcessor::afterPropertiesSet);"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"private MessagingAnnotationPostProcessor prepareMessagingAnnotationPostProcessor("
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"ConfigurableApplicationContext context) {"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"MessagingAnnotationPostProcessor postProcessor = new MessagingAnnotationPostProcessor();"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"postProcessor.setBeanFactory(context.getBeanFactory());"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"postProcessor.afterPropertiesSet();"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"postProcessor.afterSingletonsInstantiated();"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"return postProcessor;"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"}"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"MessagingAnnotationPostProcessor postProcessor = new MessagingAnnotationPostProcessor();"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"postProcessor.setBeanFactory(context.getBeanFactory());"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"postProcessor.afterPropertiesSet();"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"inputChannel.send(new GenericMessage<String>(""world""));"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"AbstractApplicationContext context = new ClassPathXmlApplicationContext(""simpleAnnotatedEndpointTests.xml"","
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"this"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,".getClass());"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"GenericMessage<String> messageToSend = new GenericMessage<String>(""world"");"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"testChannel.send(new GenericMessage<String>(""foo""));"
"3657d0559666c30b8dd72eeff9b4d3d22826844d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"@Test(expected = IllegalArgumentException.class)"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"* Copyright 2002-2019 the original author or authors."
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"import java.util.Set;"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"import org.springframework.lang.Nullable;"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"*"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"private final MessageHandler dispatchHandler = this::doDispatch;"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"private boolean failover = true;"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"private LoadBalancingStrategy loadBalancingStrategy;"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"private MessageHandlingTaskDecorator messageHandlingTaskDecorator = task -> task;"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"public UnicastingDispatcher(@Nullable Executor executor) {"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"public void setLoadBalancingStrategy(@Nullable LoadBalancingStrategy loadBalancingStrategy) {"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"Iterator<MessageHandler> handlerIterator = getHandlerIterator(message);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"List<RuntimeException> exceptions = null;"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"catch (Exception ex) {"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"RuntimeException runtimeException ="
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"IntegrationUtils.wrapInDeliveryExceptionIfNecessary(message,"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"() -> ""Dispatcher failed to deliver Message"", ex);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"if (exceptions == null) {"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"exceptions = new ArrayList<>();"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"}"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"boolean isLast = !handlerIterator.hasNext();"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"if (!isLast && this.failover) {"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"logExceptionBeforeFailOver(ex, handler, message);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"handleExceptions(exceptions, message, isLast);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"Set<MessageHandler> handlers = getHandlers();"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"return this.loadBalancingStrategy.getHandlerIterator(message, handlers);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"return handlers.iterator();"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"private void logExceptionBeforeFailOver(Exception ex, MessageHandler handler, Message<?> message) {"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"if (this.logger.isDebugEnabled()) {"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"this.logger.debug(""An exception was thrown by '"" + handler + ""' while handling '"" + message +"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"""'. Failing over to the next subscriber."", ex);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"else if (this.logger.isInfoEnabled()) {"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"this.logger.info(""An exception was thrown by '"" + handler + ""' while handling '"" + message + ""': "" +"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"ex.getMessage() + "". Failing over to the next subscriber."");"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"if (allExceptions.size() == 1) {"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"throw new AggregateMessageDeliveryException(message,"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"* Copyright 2002-2018 the original author or authors."
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"private final MessageHandler dispatchHandler = message -> doDispatch(message);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"private volatile boolean failover = true;"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"private volatile LoadBalancingStrategy loadBalancingStrategy;"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"private volatile MessageHandlingTaskDecorator messageHandlingTaskDecorator = task -> task;"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"public UnicastingDispatcher(Executor executor) {"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"*"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"public void setLoadBalancingStrategy(LoadBalancingStrategy loadBalancingStrategy) {"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"Iterator<MessageHandler> handlerIterator = this.getHandlerIterator(message);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"List<RuntimeException> exceptions = new ArrayList<RuntimeException>();"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"catch (Exception e) {"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"RuntimeException runtimeException = IntegrationUtils.wrapInDeliveryExceptionIfNecessary(message,"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"() -> ""Dispatcher failed to deliver Message"", e);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"this.handleExceptions(exceptions, message, !handlerIterator.hasNext());"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"return this.loadBalancingStrategy.getHandlerIterator(message, this.getHandlers());"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"return this.getHandlers().iterator();"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"if (allExceptions != null && allExceptions.size() == 1) {"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"throw new AggregateMessageDeliveryException(message, //NOSONAR - false positive"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"import static org.assertj.core.api.Assertions.assertThatExceptionOfType;"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"import static org.mockito.ArgumentMatchers.eq;"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"import static org.mockito.ArgumentMatchers.startsWith;"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"import static org.mockito.BDDMockito.given;"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"import static org.mockito.Mockito.spy;"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"import org.apache.commons.logging.Log;"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"import org.springframework.integration.test.util.TestUtils;"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"* @author Artem Bilan"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"public void dispatchMessageWithSingleHandler() {"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"this.dispatcher.addHandler(this.handler);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"this.dispatcher.dispatch(this.message);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"verify(this.handler).handleMessage(this.message);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"public void differentHandlerInvokedOnSecondMessage() {"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"this.dispatcher.addHandler(this.differentHandler);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"verify(this.differentHandler).handleMessage(this.message);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"public void multipleCyclesThroughHandlers() {"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"verify(this.handler, times(4)).handleMessage(this.message);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"verify(this.differentHandler, times(3)).handleMessage(this.message);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"public void currentHandlerIndexOverFlow() {"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"TestUtils.getPropertyValue(this.dispatcher, ""loadBalancingStrategy.currentHandlerIndex"", AtomicInteger.class)"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,".set(Integer.MAX_VALUE - 5);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"verify(this.handler, atLeast(18)).handleMessage(this.message);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"verify(this.differentHandler, atLeast(18)).handleMessage(this.message);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"doThrow(new MessagingException(""Mock Exception""))"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,".when(this.handler)"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,".handleMessage(this.message);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"assertThatExceptionOfType(MessagingException.class)"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,".isThrownBy(() -> this.dispatcher.dispatch(this.message))"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,".satisfies(ex -> assertThat(ex.getFailedMessage()).isEqualTo(this.message));"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"doThrow(new MessagingException(dontReplaceThisMessage, ""Mock Exception""))"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,".satisfies(ex -> assertThat(ex.getFailedMessage()).isEqualTo(dontReplaceThisMessage));"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"@Test"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"public void testFailOverAndLogging() {"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"RuntimeException testException = new RuntimeException(""intentional"");"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"doThrow(testException)"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"DirectFieldAccessor directFieldAccessor = new DirectFieldAccessor(this.dispatcher);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"Log log = (Log) spy(directFieldAccessor.getPropertyType(""logger""));"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"given(log.isDebugEnabled()).willReturn(true);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"directFieldAccessor.setPropertyValue(""logger"", log);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"verify(log).debug(startsWith(""An exception was thrown by '""), eq(testException));"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","added",0,"}"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"import static org.assertj.core.api.Assertions.fail;"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"public void dispatchMessageWithSingleHandler() throws Exception {"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"dispatcher.addHandler(handler);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"dispatcher.dispatch(message);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"public void differentHandlerInvokedOnSecondMessage() throws Exception {"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"dispatcher.addHandler(differentHandler);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"verify(handler).handleMessage(message);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"verify(differentHandler).handleMessage(message);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"public void multipleCyclesThroughHandlers() throws Exception {"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"verify(handler, times(4)).handleMessage(message);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"verify(differentHandler, times(3)).handleMessage(message);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"public void currentHandlerIndexOverFlow() throws Exception {"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"DirectFieldAccessor accessor = new DirectFieldAccessor("
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"new DirectFieldAccessor(dispatcher).getPropertyValue(""loadBalancingStrategy""));"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"((AtomicInteger) accessor.getPropertyValue(""currentHandlerIndex"")).set(Integer.MAX_VALUE - 5);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"verify(handler, atLeast(18)).handleMessage(message);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"verify(differentHandler, atLeast(18)).handleMessage(message);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"doThrow(new MessagingException(""Mock Exception""))."
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"when(handler).handleMessage(message);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"try {"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"fail(""Expected Exception"");"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"}"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"catch (MessagingException e) {"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"assertThat(e.getFailedMessage()).isEqualTo(message);"
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"doThrow(new MessagingException(dontReplaceThisMessage, ""Mock Exception""))."
"3006e58d31faa27a706ef7e8de40d961e7ebe260","fd373882dede46c9d7f6153c3c49a60c7a49edf0","deleted",1,"assertThat(e.getFailedMessage()).isEqualTo(dontReplaceThisMessage);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private final List<Map<Class<?>, HandlerMethod>> handlerMethodsList = new LinkedList<>();"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMethod = createHandlerMethod(this.method);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMethodsList.add("
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Collections.singletonMap(this.handlerMethod.targetParameterType, this.handlerMethod));"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private MessagingMethodInvokerHelper(Object targetObject, Class<? extends Annotation> annotationType,"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"String methodName, Class<?> expectedType, boolean canProcessMessageList) {"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.annotationType = annotationType;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.methodName = methodName;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.canProcessMessageList = canProcessMessageList;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Assert.notNull(targetObject, ""targetObject must not be null"");"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (expectedType != null) {"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.expectedType = TypeDescriptor.valueOf(expectedType);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"}"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"else {"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.expectedType = null;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.targetObject = targetObject;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Map<String, Map<Class<?>, HandlerMethod>> handlerMethodsForTarget ="
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"findHandlerMethodsForTarget(annotationType, methodName, expectedType != null);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Map<Class<?>, HandlerMethod> methods = handlerMethodsForTarget.get(CANDIDATE_METHODS);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Map<Class<?>, HandlerMethod> messageMethods = handlerMethodsForTarget.get(CANDIDATE_MESSAGE_METHODS);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if ((methods.size() == 1 && messageMethods.isEmpty()) ||"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"(messageMethods.size() == 1 && methods.isEmpty())) {"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (methods.size() == 1) {"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMethod = methods.values().iterator().next();"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMethod = messageMethods.values().iterator().next();"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMethod = null;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMethods = methods;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMessageMethods = messageMethods;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"//TODO Consider to use global option to determine a precedence of methods"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMethodsList.add(this.handlerMethods);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMethodsList.add(this.handlerMessageMethods);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"setDisplayString(targetObject, methodName);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"JsonObjectMapper<?, ?> mapper;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"try {"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"mapper = JsonObjectMapperProvider.newInstance();"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"catch (IllegalStateException e) {"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"mapper = null;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.jsonObjectMapper = mapper;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private HandlerMethod createHandlerMethod(Method method) {"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"InvocableHandlerMethod invocableHandlerMethod = createInvocableHandlerMethod(method);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"HandlerMethod handlerMethod = new HandlerMethod(invocableHandlerMethod, this.canProcessMessageList);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"checkSpelInvokerRequired(getTargetClass(this.targetObject), method, handlerMethod);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return handlerMethod;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private InvocableHandlerMethod createInvocableHandlerMethod(Method method) {"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return this.messageHandlerMethodFactory.createInvocableHandlerMethod(this.targetObject, method);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"HandlerMethod candidate = findHandlerMethodForParameters(parameters);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.handlerMethodsList"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".stream()"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".map(Map::values)"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".flatMap(Collection::stream)"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".forEach(handlerMethod ->"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"handlerMethod.replaceInvocableHandlerMethod("
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"createInvocableHandlerMethod(handlerMethod.invocableHandlerMethod.getMethod())));"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"!ex.getStackTrace()[0].getClassName().equals(InvocableHandlerMethod.class.getName()) ||"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"(!""argument type mismatch"".equals(ex.getCause().getMessage()) &&"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"// JVM generates GeneratedMethodAccessor### after several calls with less error"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"// checking"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"!ex.getCause().getMessage().startsWith(""java.lang.ClassCastException@"")))) {"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private Map<String, Map<Class<?>, HandlerMethod>> findHandlerMethodsForTarget("
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"final Class<? extends Annotation> annotationType, final String methodNameArg, final boolean requiresReply) {"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"final Class<?> targetClass = getTargetClass(this.targetObject);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"org.springframework.util.ClassUtils.getUserClass(this.targetObject));"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"handlerMethod1 = createHandlerMethod(method1);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"() -> ""Only one method can be @Default, but there are more for: "" + this.targetObject);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"findSingleSpecifMethodOnInterfacesIfProxy(methodNameToUse, candidateMessageMethods, candidateMethods);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"LOGGER.debug(this.targetObject.getClass() +"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"frameworkMethods.get(0), this.targetObject.getClass());"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"HandlerMethod theHandlerMethod = createHandlerMethod(frameworkMethod);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private void findSingleSpecifMethodOnInterfacesIfProxy(final String methodName,"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (AopUtils.isAopProxy(this.targetObject)) {"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Class<?>[] interfaces = ((Advised) this.targetObject).getProxiedInterfaces();"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"throw new IllegalStateException(""Ambiguous method "" + methodName + "" on "" + this.targetObject);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".getMostSpecificMethod(theMethod, this.targetObject.getClass());"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"HandlerMethod theHandlerMethod = createHandlerMethod(theMethod);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"HandlerMethod closestMatch = findClosestMatch(payloadType);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private InvocableHandlerMethod invocableHandlerMethod;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"void replaceInvocableHandlerMethod(InvocableHandlerMethod newInvocableHandlerMethod) {"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.invocableHandlerMethod = newInvocableHandlerMethod;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private final List<Map<Class<?>, HandlerMethod>> handlerMethodsList;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"createHandlerMethod();"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.handlerMethodsList = null;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private MessagingMethodInvokerHelper(Object targetObject, Class<? extends Annotation> annotationType,"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"String methodName, Class<?> expectedType, boolean canProcessMessageList) {"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.annotationType = annotationType;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.methodName = methodName;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.canProcessMessageList = canProcessMessageList;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.notNull(targetObject, ""targetObject must not be null"");"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (expectedType != null) {"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.expectedType = TypeDescriptor.valueOf(expectedType);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"}"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"else {"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.expectedType = null;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.targetObject = targetObject;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Map<String, Map<Class<?>, HandlerMethod>> handlerMethodsForTarget ="
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"findHandlerMethodsForTarget(targetObject, annotationType, methodName, expectedType != null);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Map<Class<?>, HandlerMethod> methods = handlerMethodsForTarget.get(CANDIDATE_METHODS);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Map<Class<?>, HandlerMethod> messageMethods = handlerMethodsForTarget.get(CANDIDATE_MESSAGE_METHODS);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if ((methods.size() == 1 && messageMethods.isEmpty()) ||"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"(messageMethods.size() == 1 && methods.isEmpty())) {"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (methods.size() == 1) {"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.handlerMethod = methods.values().iterator().next();"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.handlerMethod = messageMethods.values().iterator().next();"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.handlerMethods = null;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.handlerMessageMethods = null;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.handlerMethod = null;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.handlerMethods = methods;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.handlerMessageMethods = messageMethods;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.handlerMethodsList = new LinkedList<>();"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"//TODO Consider to use global option to determine a precedence of methods"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.handlerMethodsList.add(this.handlerMethods);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.handlerMethodsList.add(this.handlerMessageMethods);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"setDisplayString(targetObject, methodName);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"JsonObjectMapper<?, ?> mapper;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"try {"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"mapper = JsonObjectMapperProvider.newInstance();"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"catch (IllegalStateException e) {"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"mapper = null;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.jsonObjectMapper = mapper;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private void createHandlerMethod() {"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"InvocableHandlerMethod invocableHandlerMethod ="
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.messageHandlerMethodFactory.createInvocableHandlerMethod(this.targetObject, this.method);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.handlerMethod = new HandlerMethod(invocableHandlerMethod, this.canProcessMessageList);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.defaultHandlerMethod = null;"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"checkSpelInvokerRequired(getTargetClass(this.targetObject), this.method, this.handlerMethod);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"HandlerMethod candidate = this.findHandlerMethodForParameters(parameters);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"!ex.getStackTrace()[0].getClassName().equals(InvocableHandlerMethod.class.getName()) ||"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"(!""argument type mismatch"".equals(ex.getCause().getMessage()) &&"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"// JVM generates GeneratedMethodAccessor### after several calls with less error"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"// checking"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"!ex.getCause().getMessage().startsWith(""java.lang.ClassCastException@"")))) {"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private Map<String, Map<Class<?>, HandlerMethod>> findHandlerMethodsForTarget(final Object targetObject,"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"final Class<? extends Annotation> annotationType, final String methodNameArg,"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"final boolean requiresReply) {"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"final Class<?> targetClass = getTargetClass(targetObject);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"org.springframework.util.ClassUtils.getUserClass(targetObject));"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.messageHandlerMethodFactory.createInvocableHandlerMethod(targetObject, method1);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"handlerMethod1 = new HandlerMethod(invocableHandlerMethod, this.canProcessMessageList);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"checkSpelInvokerRequired(targetClass, method1, handlerMethod1);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"() -> ""Only one method can be @Default, but there are more for: "" + targetObject);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"findSingleSpecifMethodOnInterfacesIfProxy(targetObject, methodNameToUse, candidateMessageMethods,"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"candidateMethods);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"LOGGER.debug(targetObject.getClass() +"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"frameworkMethods.get(0), targetObject.getClass());"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.messageHandlerMethodFactory.createInvocableHandlerMethod(targetObject,"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"frameworkMethod);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"HandlerMethod theHandlerMethod = new HandlerMethod(invocableHandlerMethod, this.canProcessMessageList);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"checkSpelInvokerRequired(targetClass, frameworkMethod, theHandlerMethod);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private void findSingleSpecifMethodOnInterfacesIfProxy(final Object targetObject, final String methodName,"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (AopUtils.isAopProxy(targetObject)) {"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Class<?>[] interfaces = ((Advised) targetObject).getProxiedInterfaces();"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"throw new IllegalStateException(""Ambiguous method "" + methodName + "" on "" + targetObject);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".getMostSpecificMethod(theMethod, targetObject.getClass());"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.messageHandlerMethodFactory.createInvocableHandlerMethod(targetObject, theMethod);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"checkSpelInvokerRequired(targetClass.get(), theMethod, theHandlerMethod);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"HandlerMethod closestMatch = this.findClosestMatch(payloadType);"
"005bc806800121122e018600ef2f3a80b1859221","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private final InvocableHandlerMethod invocableHandlerMethod;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import org.springframework.util.ClassUtils;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private final String methodName;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private final Method method;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private final Class<? extends Annotation> annotationType;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private final HandlerMethod handlerMethod;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.methodName = null;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.jsonObjectMapper = configureJsonObjectMapperIfAny();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Assert.notNull(targetObject, ""targetObject must not be null"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (methodName == null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (targetObject instanceof Function) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.methodName = ""apply"";"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"}"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"else if (targetObject instanceof Consumer) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.methodName = ""accept"";"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"else {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.methodName = methodName;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.method = null;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.requiresReply = expectedType != null;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Map<String, Map<Class<?>, HandlerMethod>> handlerMethodsForTarget = findHandlerMethodsForTarget();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private JsonObjectMapper<?, ?> configureJsonObjectMapperIfAny() {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return JsonObjectMapperProvider.newInstance();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return null;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"HandlerMethod newHandlerMethod = new HandlerMethod(invocableHandlerMethod, this.canProcessMessageList);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"checkSpelInvokerRequired(getTargetClass(this.targetObject), method, newHandlerMethod);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return newHandlerMethod;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"() -> ""Cannot convert to expected type ("" + this.expectedType + "") from "" + this.methodName);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private Map<String, Map<Class<?>, HandlerMethod>> findHandlerMethodsForTarget() {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Map<Class<?>, HandlerMethod> candidateMethods = new HashMap<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Map<Class<?>, HandlerMethod> candidateMessageMethods = new HashMap<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Map<Class<?>, HandlerMethod> fallbackMethods = new HashMap<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Map<Class<?>, HandlerMethod> fallbackMessageMethods = new HashMap<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"AtomicReference<Class<?>> ambiguousFallbackType = new AtomicReference<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"AtomicReference<Class<?>> ambiguousFallbackMessageGenericType = new AtomicReference<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Class<?> targetClass = getTargetClass(this.targetObject);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"processMethodsFromTarget(candidateMethods, candidateMessageMethods, fallbackMethods, fallbackMessageMethods,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"ambiguousFallbackType, ambiguousFallbackMessageGenericType, targetClass);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (!candidateMethods.isEmpty() || !candidateMessageMethods.isEmpty()) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"methods.put(CANDIDATE_METHODS, candidateMethods);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"methods.put(CANDIDATE_MESSAGE_METHODS, candidateMessageMethods);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return methods;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if ((ambiguousFallbackType.get() != null"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"|| ambiguousFallbackMessageGenericType.get() != null)"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"&& ServiceActivator.class.equals(this.annotationType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"/*"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"* When there are ambiguous fallback methods,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"* a Service Activator can finally fallback to RequestReplyExchanger.exchange(m)."
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"* Ambiguous means > 1 method that takes the same payload type, or > 1 method"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"* that takes a Message with the same generic type."
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"*/"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Method frameworkMethod = obtainFrameworkMethod(targetClass);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (frameworkMethod != null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"HandlerMethod theHandlerMethod = createHandlerMethod(frameworkMethod);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"methods.put(CANDIDATE_METHODS, Collections.singletonMap(Object.class, theHandlerMethod));"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"validateFallbackMethods(fallbackMethods, fallbackMessageMethods, ambiguousFallbackType,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"ambiguousFallbackMessageGenericType);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"methods.put(CANDIDATE_METHODS, fallbackMethods);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"methods.put(CANDIDATE_MESSAGE_METHODS, fallbackMessageMethods);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private void validateFallbackMethods(Map<Class<?>, HandlerMethod> fallbackMethods,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Map<Class<?>, HandlerMethod> fallbackMessageMethods, AtomicReference<Class<?>> ambiguousFallbackType,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"AtomicReference<Class<?>> ambiguousFallbackMessageGenericType) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Assert.state(!fallbackMethods.isEmpty() || !fallbackMessageMethods.isEmpty(),"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"() -> ""Target object of type ["" + this.targetObject.getClass() +"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""] has no eligible methods for handling Messages."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Assert.isNull(ambiguousFallbackType.get(),"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"() -> ""Found ambiguous parameter type ["" + ambiguousFallbackType +"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""] for method match: "" + fallbackMethods.values());"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Assert.isNull(ambiguousFallbackMessageGenericType.get(),"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"() -> ""Found ambiguous parameter type ["""
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"+ ambiguousFallbackMessageGenericType"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"+ ""] for method match: """
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"+ fallbackMethods.values());"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private void processMethodsFromTarget(Map<Class<?>, HandlerMethod> candidateMethods,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Map<Class<?>, HandlerMethod> candidateMessageMethods, Map<Class<?>, HandlerMethod> fallbackMethods,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"AtomicReference<Class<?>> ambiguousFallbackMessageGenericType, Class<?> targetClass) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (this.annotationType != null && AnnotationUtils.findAnnotation(method1, this.annotationType) != null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"HandlerMethod handlerMethod1 = obtainHandlerMethodIfAny(method1);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (handlerMethod1 != null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"populateHandlerMethod(candidateMethods, candidateMessageMethods, fallbackMethods,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"fallbackMessageMethods,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"ambiguousFallbackType, ambiguousFallbackMessageGenericType, matchesAnnotation, handlerMethod1);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"}, new UniqueMethodFilter(targetClass));"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (candidateMethods.isEmpty() && candidateMessageMethods.isEmpty() && fallbackMethods.isEmpty()"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"&& fallbackMessageMethods.isEmpty()) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"findSingleSpecifMethodOnInterfacesIfProxy(candidateMessageMethods, candidateMethods);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"@Nullable"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private HandlerMethod obtainHandlerMethodIfAny(Method methodToProcess) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"HandlerMethod handlerMethodToUse = null;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (isMethodEligible(methodToProcess)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"handlerMethodToUse = createHandlerMethod("
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"AopUtils.selectInvocableMethod(methodToProcess, ClassUtils.getUserClass(this.targetObject)));"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"LOGGER.debug(""Method ["" + methodToProcess + ""] is not eligible for Message handling."", e);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (AnnotationUtils.getAnnotation(methodToProcess, Default.class) != null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.defaultHandlerMethod = handlerMethodToUse;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return handlerMethodToUse;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private boolean isMethodEligible(Method methodToProcess) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return !(methodToProcess.isBridge() || // NOSONAR boolean complexity"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"isMethodDefinedOnObjectClass(methodToProcess) ||"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"methodToProcess.getDeclaringClass().equals(Proxy.class) ||"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"(this.requiresReply && void.class.equals(methodToProcess.getReturnType())) ||"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"(this.methodName != null && !this.methodName.equals(methodToProcess.getName())) ||"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"(this.methodName == null &&"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"ObjectUtils.containsElement(new String[] { ""start"", ""stop"", ""isRunning"" },"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"methodToProcess.getName())));"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private void populateHandlerMethod(Map<Class<?>, HandlerMethod> candidateMethods,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"AtomicReference<Class<?>> ambiguousFallbackMessageGenericType, boolean matchesAnnotation,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"HandlerMethod handlerMethod1) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Class<?> targetParameterType = handlerMethod1.getTargetParameterType();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (matchesAnnotation || this.annotationType == null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (handlerMethod1.isMessageMethod()) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (candidateMessageMethods.containsKey(targetParameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"throw new IllegalArgumentException(""Found more than one method match for type "" +"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""[Message<"" + targetParameterType + "">]"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"candidateMessageMethods.put(targetParameterType, handlerMethod1);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (candidateMethods.containsKey(targetParameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"String exceptionMessage = ""Found more than one method match for "";"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (Void.class.equals(targetParameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"exceptionMessage += ""empty parameter for 'payload'"";"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"exceptionMessage += ""type ["" + targetParameterType + ""]"";"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"throw new IllegalArgumentException(exceptionMessage);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"candidateMethods.put(targetParameterType, handlerMethod1);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (fallbackMessageMethods.containsKey(targetParameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"// we need to check for duplicate type matches,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"// but only if we end up falling back"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"// and we'll only keep track of the first one"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"ambiguousFallbackMessageGenericType.compareAndSet(null, targetParameterType);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"fallbackMessageMethods.put(targetParameterType, handlerMethod1);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (fallbackMethods.containsKey(targetParameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"ambiguousFallbackType.compareAndSet(null, targetParameterType);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"fallbackMethods.put(targetParameterType, handlerMethod1);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private Method obtainFrameworkMethod(Class<?> targetClass) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Method frameworkMethod = null;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"for (Class<?> iface : ClassUtils.getAllInterfacesForClass(targetClass)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"try {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"// Can't use real class because of package tangle"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (""org.springframework.integration.gateway.RequestReplyExchanger"".equals(iface.getName())) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"frameworkMethod ="
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"ClassUtils.getMostSpecificMethod("
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"targetClass.getMethod(""exchange"", Message.class),"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.targetObject.getClass());"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (LOGGER.isDebugEnabled()) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"LOGGER.debug(this.targetObject.getClass() +"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,""": Ambiguous fallback methods; using RequestReplyExchanger.exchange()"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"break;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"catch (Exception ex) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"throw new IllegalStateException(ex);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return frameworkMethod;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private void findSingleSpecifMethodOnInterfacesIfProxy(Map<Class<?>, HandlerMethod> candidateMessageMethods,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"throw new IllegalStateException("
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""Ambiguous method "" + this.methodName + "" on "" + this.targetObject);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"}, method12 -> method12.getName().equals(this.methodName));"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"theMethod = ClassUtils.getMostSpecificMethod(theMethod, this.targetObject.getClass());"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"else if (ClassUtils.isCglibProxyClass(targetClass) || targetClass.getSimpleName().contains(""$MockitoMock$"")) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"match = org.springframework.integration.util.ClassUtils.findClosestMatch(payloadType, candidates, true);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Type genericParameterType = method.getGenericParameterTypes()[i];"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"hasUnqualifiedMapParameter = processMethodParameterForExpression(sb, hasUnqualifiedMapParameter,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"methodParameter, parameterTypeDescriptor, parameterType, genericParameterType,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"mappingAnnotation);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"sb.append("")"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (this.targetParameterTypeDescriptor == null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.targetParameterTypeDescriptor = TypeDescriptor.valueOf(Void.class);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return sb.toString();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private boolean processMethodParameterForExpression(StringBuilder sb, boolean hasUnqualifiedMapParameter,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"MethodParameter methodParameter, TypeDescriptor parameterTypeDescriptor, Class<?> parameterType,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Type genericParameterType, Annotation mappingAnnotation) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (mappingAnnotation != null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"processMappingAnnotationForExpression(sb, methodParameter, parameterTypeDescriptor, parameterType,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"else if (parameterTypeDescriptor.isAssignableTo(MESSAGE_TYPE_DESCRIPTOR)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.messageMethod = true;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"sb.append(""message"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"setExclusiveTargetParameterType(parameterTypeDescriptor, methodParameter);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"else if (this.canProcessMessageList &&"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"(parameterTypeDescriptor.isAssignableTo(MESSAGE_LIST_TYPE_DESCRIPTOR)"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"|| parameterTypeDescriptor.isAssignableTo(MESSAGE_ARRAY_TYPE_DESCRIPTOR))) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"sb.append(""messages"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"else if (Collection.class.isAssignableFrom(parameterType) || parameterType.isArray()) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"addCollectionParameterForExpression(sb);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"else if (Iterator.class.isAssignableFrom(parameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"populateIteratorParameterForExpression(sb, genericParameterType);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"else if (Map.class.isAssignableFrom(parameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Assert.isTrue(!hasUnqualifiedMapParameter,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""Found more than one Map typed parameter without any qualification. """
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"+ ""Consider using @Payload or @Headers on at least one of the parameters."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"populateMapParameterForExpression(sb, parameterType);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return true;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"sb.append(""payload"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return hasUnqualifiedMapParameter;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private void processMappingAnnotationForExpression(StringBuilder sb, MethodParameter methodParameter,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"TypeDescriptor parameterTypeDescriptor, Class<?> parameterType, Annotation mappingAnnotation) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Class<? extends Annotation> annotationType = mappingAnnotation.annotationType();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (annotationType.equals(Payload.class)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"String qualifierExpression = (String) AnnotationUtils.getValue(mappingAnnotation);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (StringUtils.hasText(qualifierExpression)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"sb.append(""."")"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".append(qualifierExpression);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (!StringUtils.hasText(qualifierExpression)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (annotationType.equals(Payloads.class)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Assert.isTrue(this.canProcessMessageList,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""The @Payloads annotation can only be applied "" +"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""if method handler canProcessMessageList."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Assert.isTrue(Collection.class.isAssignableFrom(parameterType),"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""The @Payloads annotation can only be applied to a Collection-typed parameter."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"sb.append(""messages.![payload"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"String qualifierExpression = ((Payloads) mappingAnnotation).value();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"sb.append(""]"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"else if (annotationType.equals(Headers.class)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Assert.isTrue(Map.class.isAssignableFrom(parameterType),"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""The @Headers annotation can only be applied to a Map-typed parameter."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"sb.append(""headers"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"else if (annotationType.equals(Header.class)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"sb.append(determineHeaderExpression(mappingAnnotation, methodParameter));"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private void addCollectionParameterForExpression(StringBuilder sb) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (this.canProcessMessageList) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"sb.append(""messages.![payload]"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private void populateIteratorParameterForExpression(StringBuilder sb, Type type) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Type parameterizedType = null;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (type instanceof ParameterizedType) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"parameterizedType = ((ParameterizedType) type).getActualTypeArguments()[0];"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (parameterizedType instanceof ParameterizedType) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"parameterizedType = ((ParameterizedType) parameterizedType).getRawType();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (parameterizedType != null && Message.class.isAssignableFrom((Class<?>) parameterizedType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"sb.append(""messages.iterator()"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"sb.append(""messages.![payload].iterator()"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"sb.append(""payload.iterator()"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private void populateMapParameterForExpression(StringBuilder sb, Class<?> parameterType) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (Properties.class.isAssignableFrom(parameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"sb.append(""payload instanceof T(java.util.Map) or """
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"+ ""(payload instanceof T(String) and payload.contains('=')) ? payload : headers"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"sb.append(""(payload instanceof T(java.util.Map) ? payload : headers)"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (this.targetParameterType != null && Map.class.isAssignableFrom(this.targetParameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"throw new IllegalArgumentException("
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""Unable to determine payload matching parameter due to ambiguous Map typed parameters. """
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"+ ""Consider adding the @Payload and or @Headers annotations as appropriate."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import java.util.ArrayList;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import org.springframework.integration.util.ClassUtils;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import org.springframework.util.ReflectionUtils.MethodFilter;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private HandlerMethod handlerMethod;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private Class<? extends Annotation> annotationType;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private String methodName;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private Method method;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"JsonObjectMapper<?, ?> mapper;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"try {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"mapper = JsonObjectMapperProvider.newInstance();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"}"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"catch (IllegalStateException e) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"mapper = null;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.jsonObjectMapper = mapper;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.methodName = methodName;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.notNull(targetObject, ""targetObject must not be null"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Map<String, Map<Class<?>, HandlerMethod>> handlerMethodsForTarget ="
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"findHandlerMethodsForTarget(annotationType, methodName, expectedType != null);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"HandlerMethod handlerMethod = new HandlerMethod(invocableHandlerMethod, this.canProcessMessageList);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"checkSpelInvokerRequired(getTargetClass(this.targetObject), method, handlerMethod);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return handlerMethod;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"() -> ""Cannot convert to expected type ("" + this.expectedType + "") from "" + this.method);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private Map<String, Map<Class<?>, HandlerMethod>> findHandlerMethodsForTarget("
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"final Class<? extends Annotation> annotationType, final String methodNameArg, final boolean requiresReply) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"final Map<Class<?>, HandlerMethod> candidateMethods = new HashMap<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"final Map<Class<?>, HandlerMethod> candidateMessageMethods = new HashMap<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"final Map<Class<?>, HandlerMethod> fallbackMethods = new HashMap<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"final Map<Class<?>, HandlerMethod> fallbackMessageMethods = new HashMap<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"final AtomicReference<Class<?>> ambiguousFallbackType = new AtomicReference<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"final AtomicReference<Class<?>> ambiguousFallbackMessageGenericType = new AtomicReference<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"final Class<?> targetClass = getTargetClass(this.targetObject);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"final String methodNameToUse;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (methodNameArg == null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (Function.class.isAssignableFrom(targetClass)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"methodNameToUse = ""apply"";"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"else if (Consumer.class.isAssignableFrom(targetClass)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"methodNameToUse = ""accept"";"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"else {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"methodNameToUse = null;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"methodNameToUse = methodNameArg;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"MethodFilter methodFilter = new UniqueMethodFilter(targetClass);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (method1.isBridge()) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (isMethodDefinedOnObjectClass(method1)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (method1.getDeclaringClass().equals(Proxy.class)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (annotationType != null && AnnotationUtils.findAnnotation(method1, annotationType) != null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (requiresReply && void.class.equals(method1.getReturnType())) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (methodNameToUse != null && !methodNameToUse.equals(method1.getName())) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (methodNameToUse == null"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"&& ObjectUtils.containsElement(new String[] { ""start"", ""stop"", ""isRunning"" }, method1.getName())) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"HandlerMethod handlerMethod1;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"method1 = AopUtils.selectInvocableMethod(method1,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"org.springframework.util.ClassUtils.getUserClass(this.targetObject));"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"handlerMethod1 = createHandlerMethod(method1);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"catch (IneligibleMethodException e) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (LOGGER.isDebugEnabled()) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"LOGGER.debug(""Method ["" + method1 + ""] is not eligible for Message handling """
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"+ e.getMessage() + ""."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"LOGGER.debug(""Method ["" + method1 + ""] is not eligible for Message handling."", e);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (AnnotationUtils.getAnnotation(method1, Default.class) != null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.defaultHandlerMethod = handlerMethod1;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Class<?> targetParameterType = handlerMethod1.getTargetParameterType();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (matchesAnnotation || annotationType == null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (handlerMethod1.isMessageMethod()) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (candidateMessageMethods.containsKey(targetParameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"throw new IllegalArgumentException(""Found more than one method match for type "" +"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""[Message<"" + targetParameterType + "">]"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"candidateMessageMethods.put(targetParameterType, handlerMethod1);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (candidateMethods.containsKey(targetParameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"String exceptionMessage = ""Found more than one method match for "";"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (Void.class.equals(targetParameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"exceptionMessage += ""empty parameter for 'payload'"";"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"exceptionMessage += ""type ["" + targetParameterType + ""]"";"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"throw new IllegalArgumentException(exceptionMessage);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"candidateMethods.put(targetParameterType, handlerMethod1);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (fallbackMessageMethods.containsKey(targetParameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"// we need to check for duplicate type matches,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"// but only if we end up falling back"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"// and we'll only keep track of the first one"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"ambiguousFallbackMessageGenericType.compareAndSet(null, targetParameterType);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"fallbackMessageMethods.put(targetParameterType, handlerMethod1);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (fallbackMethods.containsKey(targetParameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"ambiguousFallbackType.compareAndSet(null, targetParameterType);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"fallbackMethods.put(targetParameterType, handlerMethod1);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"}, methodFilter);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (candidateMethods.isEmpty() && candidateMessageMethods.isEmpty() && fallbackMethods.isEmpty()"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"&& fallbackMessageMethods.isEmpty()) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"findSingleSpecifMethodOnInterfacesIfProxy(methodNameToUse, candidateMessageMethods, candidateMethods);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (!candidateMethods.isEmpty() || !candidateMessageMethods.isEmpty()) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"methods.put(CANDIDATE_METHODS, candidateMethods);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"methods.put(CANDIDATE_MESSAGE_METHODS, candidateMessageMethods);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return methods;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if ((ambiguousFallbackType.get() != null"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"|| ambiguousFallbackMessageGenericType.get() != null)"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"&& ServiceActivator.class.equals(annotationType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"/*"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"* When there are ambiguous fallback methods,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"* a Service Activator can finally fallback to RequestReplyExchanger.exchange(m)."
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"* Ambiguous means > 1 method that takes the same payload type, or > 1 method"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"* that takes a Message with the same generic type."
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"*/"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"List<Method> frameworkMethods = new ArrayList<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Class<?>[] allInterfaces = org.springframework.util.ClassUtils.getAllInterfacesForClass(targetClass);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"for (Class<?> iface : allInterfaces) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (""org.springframework.integration.gateway.RequestReplyExchanger"".equals(iface.getName())) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"frameworkMethods.add(targetClass.getMethod(""exchange"", Message.class));"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"LOGGER.debug(this.targetObject.getClass() +"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,""": Ambiguous fallback methods; using RequestReplyExchanger.exchange()"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"catch (Exception e) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"// should never happen (but would fall through to errors below)"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (frameworkMethods.size() == 1) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Method frameworkMethod = org.springframework.util.ClassUtils.getMostSpecificMethod("
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"frameworkMethods.get(0), this.targetObject.getClass());"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"HandlerMethod theHandlerMethod = createHandlerMethod(frameworkMethod);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"methods.put(CANDIDATE_METHODS, Collections.singletonMap(Object.class, theHandlerMethod));"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.state(!fallbackMethods.isEmpty() || !fallbackMessageMethods.isEmpty(),"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"() -> ""Target object of type ["" + this.targetObject.getClass() +"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""] has no eligible methods for handling Messages."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.isNull(ambiguousFallbackType.get(),"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"() -> ""Found ambiguous parameter type ["" + ambiguousFallbackType +"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""] for method match: "" + fallbackMethods.values());"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.isNull(ambiguousFallbackMessageGenericType.get(),"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"() -> ""Found ambiguous parameter type ["""
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"+ ambiguousFallbackMessageGenericType"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"+ ""] for method match: """
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"+ fallbackMethods.values());"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"methods.put(CANDIDATE_METHODS, fallbackMethods);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"methods.put(CANDIDATE_MESSAGE_METHODS, fallbackMessageMethods);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private void findSingleSpecifMethodOnInterfacesIfProxy(final String methodName,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Map<Class<?>, HandlerMethod> candidateMessageMethods,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"throw new IllegalStateException(""Ambiguous method "" + methodName + "" on "" + this.targetObject);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"}, method12 -> method12.getName().equals(methodName));"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"theMethod = org.springframework.util.ClassUtils"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".getMostSpecificMethod(theMethod, this.targetObject.getClass());"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"else if (org.springframework.util.ClassUtils.isCglibProxyClass(targetClass)"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"|| targetClass.getSimpleName().contains(""$MockitoMock$"")) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"match = ClassUtils.findClosestMatch(payloadType, candidates, true);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (mappingAnnotation != null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Class<? extends Annotation> annotationType = mappingAnnotation.annotationType();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (annotationType.equals(Payload.class)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"sb.append(""payload"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"String qualifierExpression = (String) AnnotationUtils.getValue(mappingAnnotation);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (StringUtils.hasText(qualifierExpression)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"sb.append(""."")"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".append(qualifierExpression);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (!StringUtils.hasText(qualifierExpression)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.setExclusiveTargetParameterType(parameterTypeDescriptor, methodParameter);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (annotationType.equals(Payloads.class)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.isTrue(this.canProcessMessageList,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""The @Payloads annotation can only be applied "" +"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""if method handler canProcessMessageList."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.isTrue(Collection.class.isAssignableFrom(parameterType),"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""The @Payloads annotation can only be applied to a Collection-typed parameter."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"sb.append(""messages.![payload"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"String qualifierExpression = ((Payloads) mappingAnnotation).value();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"sb.append(""]"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"else if (annotationType.equals(Headers.class)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.isTrue(Map.class.isAssignableFrom(parameterType),"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""The @Headers annotation can only be applied to a Map-typed parameter."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"sb.append(""headers"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"else if (annotationType.equals(Header.class)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"sb.append(this.determineHeaderExpression(mappingAnnotation, methodParameter));"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"else if (parameterTypeDescriptor.isAssignableTo(MESSAGE_TYPE_DESCRIPTOR)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.messageMethod = true;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"sb.append(""message"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"else if (this.canProcessMessageList &&"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"(parameterTypeDescriptor.isAssignableTo(MESSAGE_LIST_TYPE_DESCRIPTOR)"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"|| parameterTypeDescriptor.isAssignableTo(MESSAGE_ARRAY_TYPE_DESCRIPTOR))) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"sb.append(""messages"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"else if (Collection.class.isAssignableFrom(parameterType) || parameterType.isArray()) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (this.canProcessMessageList) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"sb.append(""messages.![payload]"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"else if (Iterator.class.isAssignableFrom(parameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Type type = method.getGenericParameterTypes()[i];"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Type parameterizedType = null;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (type instanceof ParameterizedType) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"parameterizedType = ((ParameterizedType) type).getActualTypeArguments()[0];"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (parameterizedType instanceof ParameterizedType) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"parameterizedType = ((ParameterizedType) parameterizedType).getRawType();"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (parameterizedType != null && Message.class.isAssignableFrom((Class<?>) parameterizedType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"sb.append(""messages.iterator()"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"sb.append(""messages.![payload].iterator()"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"sb.append(""payload.iterator()"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"else if (Map.class.isAssignableFrom(parameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (Properties.class.isAssignableFrom(parameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"sb.append(""payload instanceof T(java.util.Map) or """
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"+ ""(payload instanceof T(String) and payload.contains('=')) ? payload : headers"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"sb.append(""(payload instanceof T(java.util.Map) ? payload : headers)"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.isTrue(!hasUnqualifiedMapParameter,"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""Found more than one Map typed parameter without any qualification. """
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"+ ""Consider using @Payload or @Headers on at least one of the parameters."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"hasUnqualifiedMapParameter = true;"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (hasUnqualifiedMapParameter) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (this.targetParameterType != null && Map.class.isAssignableFrom(this.targetParameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"throw new IllegalArgumentException("
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""Unable to determine payload matching parameter due to ambiguous Map typed parameters. """
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"+ ""Consider adding the @Payload and or @Headers annotations as appropriate."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"sb.append("")"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (this.targetParameterTypeDescriptor == null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.targetParameterTypeDescriptor = TypeDescriptor.valueOf(Void.class);"
"b4273dd6627cce57e9b2c78ae36491432065c649","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return sb.toString();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"import org.springframework.util.ClassUtils;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private final String methodName;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private final Method method;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private final Class<? extends Annotation> annotationType;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private final HandlerMethod handlerMethod;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.methodName = null;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.jsonObjectMapper = configureJsonObjectMapperIfAny();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Assert.notNull(targetObject, ""targetObject must not be null"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (methodName == null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (targetObject instanceof Function) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.methodName = ""apply"";"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"}"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"else if (targetObject instanceof Consumer) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.methodName = ""accept"";"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"else {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.methodName = methodName;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.method = null;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.requiresReply = expectedType != null;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Map<String, Map<Class<?>, HandlerMethod>> handlerMethodsForTarget = findHandlerMethodsForTarget();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private JsonObjectMapper<?, ?> configureJsonObjectMapperIfAny() {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"return JsonObjectMapperProvider.newInstance();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"return null;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"HandlerMethod newHandlerMethod = new HandlerMethod(invocableHandlerMethod, this.canProcessMessageList);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"checkSpelInvokerRequired(getTargetClass(this.targetObject), method, newHandlerMethod);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"return newHandlerMethod;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"() -> ""Cannot convert to expected type ("" + this.expectedType + "") from "" + this.methodName);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private Map<String, Map<Class<?>, HandlerMethod>> findHandlerMethodsForTarget() {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Map<Class<?>, HandlerMethod> candidateMethods = new HashMap<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Map<Class<?>, HandlerMethod> candidateMessageMethods = new HashMap<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Map<Class<?>, HandlerMethod> fallbackMethods = new HashMap<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Map<Class<?>, HandlerMethod> fallbackMessageMethods = new HashMap<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"AtomicReference<Class<?>> ambiguousFallbackType = new AtomicReference<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"AtomicReference<Class<?>> ambiguousFallbackMessageGenericType = new AtomicReference<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Class<?> targetClass = getTargetClass(this.targetObject);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"processMethodsFromTarget(candidateMethods, candidateMessageMethods, fallbackMethods, fallbackMessageMethods,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"ambiguousFallbackType, ambiguousFallbackMessageGenericType, targetClass);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (!candidateMethods.isEmpty() || !candidateMessageMethods.isEmpty()) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"methods.put(CANDIDATE_METHODS, candidateMethods);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"methods.put(CANDIDATE_MESSAGE_METHODS, candidateMessageMethods);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"return methods;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if ((ambiguousFallbackType.get() != null"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"|| ambiguousFallbackMessageGenericType.get() != null)"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"&& ServiceActivator.class.equals(this.annotationType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"/*"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"* When there are ambiguous fallback methods,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"* a Service Activator can finally fallback to RequestReplyExchanger.exchange(m)."
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"* Ambiguous means > 1 method that takes the same payload type, or > 1 method"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"* that takes a Message with the same generic type."
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"*/"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Method frameworkMethod = obtainFrameworkMethod(targetClass);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (frameworkMethod != null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"HandlerMethod theHandlerMethod = createHandlerMethod(frameworkMethod);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"methods.put(CANDIDATE_METHODS, Collections.singletonMap(Object.class, theHandlerMethod));"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"validateFallbackMethods(fallbackMethods, fallbackMessageMethods, ambiguousFallbackType,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"ambiguousFallbackMessageGenericType);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"methods.put(CANDIDATE_METHODS, fallbackMethods);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"methods.put(CANDIDATE_MESSAGE_METHODS, fallbackMessageMethods);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private void validateFallbackMethods(Map<Class<?>, HandlerMethod> fallbackMethods,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Map<Class<?>, HandlerMethod> fallbackMessageMethods, AtomicReference<Class<?>> ambiguousFallbackType,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"AtomicReference<Class<?>> ambiguousFallbackMessageGenericType) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Assert.state(!fallbackMethods.isEmpty() || !fallbackMessageMethods.isEmpty(),"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"() -> ""Target object of type ["" + this.targetObject.getClass() +"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"""] has no eligible methods for handling Messages."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Assert.isNull(ambiguousFallbackType.get(),"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"() -> ""Found ambiguous parameter type ["" + ambiguousFallbackType +"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"""] for method match: "" + fallbackMethods.values());"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Assert.isNull(ambiguousFallbackMessageGenericType.get(),"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"() -> ""Found ambiguous parameter type ["""
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"+ ambiguousFallbackMessageGenericType"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"+ ""] for method match: """
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"+ fallbackMethods.values());"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private void processMethodsFromTarget(Map<Class<?>, HandlerMethod> candidateMethods,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Map<Class<?>, HandlerMethod> candidateMessageMethods, Map<Class<?>, HandlerMethod> fallbackMethods,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"AtomicReference<Class<?>> ambiguousFallbackMessageGenericType, Class<?> targetClass) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (this.annotationType != null && AnnotationUtils.findAnnotation(method1, this.annotationType) != null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"HandlerMethod handlerMethod1 = obtainHandlerMethodIfAny(method1);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (handlerMethod1 != null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"populateHandlerMethod(candidateMethods, candidateMessageMethods, fallbackMethods,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"fallbackMessageMethods,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"ambiguousFallbackType, ambiguousFallbackMessageGenericType, matchesAnnotation, handlerMethod1);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"}, new UniqueMethodFilter(targetClass));"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (candidateMethods.isEmpty() && candidateMessageMethods.isEmpty() && fallbackMethods.isEmpty()"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"&& fallbackMessageMethods.isEmpty()) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"findSingleSpecifMethodOnInterfacesIfProxy(candidateMessageMethods, candidateMethods);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"@Nullable"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private HandlerMethod obtainHandlerMethodIfAny(Method methodToProcess) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"HandlerMethod handlerMethodToUse = null;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (isMethodEligible(methodToProcess)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"handlerMethodToUse = createHandlerMethod("
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"AopUtils.selectInvocableMethod(methodToProcess, ClassUtils.getUserClass(this.targetObject)));"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"LOGGER.debug(""Method ["" + methodToProcess + ""] is not eligible for Message handling."", e);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (AnnotationUtils.getAnnotation(methodToProcess, Default.class) != null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.defaultHandlerMethod = handlerMethodToUse;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"return handlerMethodToUse;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private boolean isMethodEligible(Method methodToProcess) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"return !(methodToProcess.isBridge() || // NOSONAR boolean complexity"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"isMethodDefinedOnObjectClass(methodToProcess) ||"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"methodToProcess.getDeclaringClass().equals(Proxy.class) ||"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"(this.requiresReply && void.class.equals(methodToProcess.getReturnType())) ||"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"(this.methodName != null && !this.methodName.equals(methodToProcess.getName())) ||"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"(this.methodName == null &&"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"ObjectUtils.containsElement(new String[] { ""start"", ""stop"", ""isRunning"" },"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"methodToProcess.getName())));"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private void populateHandlerMethod(Map<Class<?>, HandlerMethod> candidateMethods,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"AtomicReference<Class<?>> ambiguousFallbackMessageGenericType, boolean matchesAnnotation,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"HandlerMethod handlerMethod1) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Class<?> targetParameterType = handlerMethod1.getTargetParameterType();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (matchesAnnotation || this.annotationType == null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (handlerMethod1.isMessageMethod()) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (candidateMessageMethods.containsKey(targetParameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"throw new IllegalArgumentException(""Found more than one method match for type "" +"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"""[Message<"" + targetParameterType + "">]"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"candidateMessageMethods.put(targetParameterType, handlerMethod1);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (candidateMethods.containsKey(targetParameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"String exceptionMessage = ""Found more than one method match for "";"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (Void.class.equals(targetParameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"exceptionMessage += ""empty parameter for 'payload'"";"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"exceptionMessage += ""type ["" + targetParameterType + ""]"";"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"throw new IllegalArgumentException(exceptionMessage);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"candidateMethods.put(targetParameterType, handlerMethod1);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (fallbackMessageMethods.containsKey(targetParameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"// we need to check for duplicate type matches,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"// but only if we end up falling back"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"// and we'll only keep track of the first one"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"ambiguousFallbackMessageGenericType.compareAndSet(null, targetParameterType);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"fallbackMessageMethods.put(targetParameterType, handlerMethod1);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (fallbackMethods.containsKey(targetParameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"ambiguousFallbackType.compareAndSet(null, targetParameterType);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"fallbackMethods.put(targetParameterType, handlerMethod1);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private Method obtainFrameworkMethod(Class<?> targetClass) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Method frameworkMethod = null;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"for (Class<?> iface : ClassUtils.getAllInterfacesForClass(targetClass)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"try {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"// Can't use real class because of package tangle"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (""org.springframework.integration.gateway.RequestReplyExchanger"".equals(iface.getName())) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"frameworkMethod ="
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"ClassUtils.getMostSpecificMethod("
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"targetClass.getMethod(""exchange"", Message.class),"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.targetObject.getClass());"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (LOGGER.isDebugEnabled()) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"LOGGER.debug(this.targetObject.getClass() +"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,""": Ambiguous fallback methods; using RequestReplyExchanger.exchange()"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"break;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"catch (Exception ex) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"throw new IllegalStateException(ex);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"return frameworkMethod;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private void findSingleSpecifMethodOnInterfacesIfProxy(Map<Class<?>, HandlerMethod> candidateMessageMethods,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"throw new IllegalStateException("
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"""Ambiguous method "" + this.methodName + "" on "" + this.targetObject);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"}, method12 -> method12.getName().equals(this.methodName));"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"theMethod = ClassUtils.getMostSpecificMethod(theMethod, this.targetObject.getClass());"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"else if (ClassUtils.isCglibProxyClass(targetClass) || targetClass.getSimpleName().contains(""$MockitoMock$"")) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"match = org.springframework.integration.util.ClassUtils.findClosestMatch(payloadType, candidates, true);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Type genericParameterType = method.getGenericParameterTypes()[i];"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"hasUnqualifiedMapParameter = processMethodParameterForExpression(sb, hasUnqualifiedMapParameter,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"methodParameter, parameterTypeDescriptor, parameterType, genericParameterType,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"mappingAnnotation);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"sb.append("")"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (this.targetParameterTypeDescriptor == null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.targetParameterTypeDescriptor = TypeDescriptor.valueOf(Void.class);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"return sb.toString();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private boolean processMethodParameterForExpression(StringBuilder sb, boolean hasUnqualifiedMapParameter,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"MethodParameter methodParameter, TypeDescriptor parameterTypeDescriptor, Class<?> parameterType,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Type genericParameterType, Annotation mappingAnnotation) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (mappingAnnotation != null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"processMappingAnnotationForExpression(sb, methodParameter, parameterTypeDescriptor, parameterType,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"else if (parameterTypeDescriptor.isAssignableTo(MESSAGE_TYPE_DESCRIPTOR)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"this.messageMethod = true;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"sb.append(""message"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"setExclusiveTargetParameterType(parameterTypeDescriptor, methodParameter);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"else if (this.canProcessMessageList &&"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"(parameterTypeDescriptor.isAssignableTo(MESSAGE_LIST_TYPE_DESCRIPTOR)"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"|| parameterTypeDescriptor.isAssignableTo(MESSAGE_ARRAY_TYPE_DESCRIPTOR))) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"sb.append(""messages"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"else if (Collection.class.isAssignableFrom(parameterType) || parameterType.isArray()) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"addCollectionParameterForExpression(sb);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"else if (Iterator.class.isAssignableFrom(parameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"populateIteratorParameterForExpression(sb, genericParameterType);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"else if (Map.class.isAssignableFrom(parameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Assert.isTrue(!hasUnqualifiedMapParameter,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"""Found more than one Map typed parameter without any qualification. """
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"+ ""Consider using @Payload or @Headers on at least one of the parameters."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"populateMapParameterForExpression(sb, parameterType);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"return true;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"sb.append(""payload"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"return hasUnqualifiedMapParameter;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private void processMappingAnnotationForExpression(StringBuilder sb, MethodParameter methodParameter,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"TypeDescriptor parameterTypeDescriptor, Class<?> parameterType, Annotation mappingAnnotation) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Class<? extends Annotation> annotationType = mappingAnnotation.annotationType();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (annotationType.equals(Payload.class)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"String qualifierExpression = (String) AnnotationUtils.getValue(mappingAnnotation);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (StringUtils.hasText(qualifierExpression)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"sb.append(""."")"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,".append(qualifierExpression);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (!StringUtils.hasText(qualifierExpression)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (annotationType.equals(Payloads.class)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Assert.isTrue(this.canProcessMessageList,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"""The @Payloads annotation can only be applied "" +"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"""if method handler canProcessMessageList."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Assert.isTrue(Collection.class.isAssignableFrom(parameterType),"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"""The @Payloads annotation can only be applied to a Collection-typed parameter."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"sb.append(""messages.![payload"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"String qualifierExpression = ((Payloads) mappingAnnotation).value();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"sb.append(""]"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"else if (annotationType.equals(Headers.class)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Assert.isTrue(Map.class.isAssignableFrom(parameterType),"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"""The @Headers annotation can only be applied to a Map-typed parameter."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"sb.append(""headers"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"else if (annotationType.equals(Header.class)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"sb.append(determineHeaderExpression(mappingAnnotation, methodParameter));"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private void addCollectionParameterForExpression(StringBuilder sb) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (this.canProcessMessageList) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"sb.append(""messages.![payload]"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private void populateIteratorParameterForExpression(StringBuilder sb, Type type) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"Type parameterizedType = null;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (type instanceof ParameterizedType) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"parameterizedType = ((ParameterizedType) type).getActualTypeArguments()[0];"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (parameterizedType instanceof ParameterizedType) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"parameterizedType = ((ParameterizedType) parameterizedType).getRawType();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (parameterizedType != null && Message.class.isAssignableFrom((Class<?>) parameterizedType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"sb.append(""messages.iterator()"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"sb.append(""messages.![payload].iterator()"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"sb.append(""payload.iterator()"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"private void populateMapParameterForExpression(StringBuilder sb, Class<?> parameterType) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (Properties.class.isAssignableFrom(parameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"sb.append(""payload instanceof T(java.util.Map) or """
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"+ ""(payload instanceof T(String) and payload.contains('=')) ? payload : headers"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"sb.append(""(payload instanceof T(java.util.Map) ? payload : headers)"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"if (this.targetParameterType != null && Map.class.isAssignableFrom(this.targetParameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"throw new IllegalArgumentException("
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"""Unable to determine payload matching parameter due to ambiguous Map typed parameters. """
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","added",0,"+ ""Consider adding the @Payload and or @Headers annotations as appropriate."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"import java.util.ArrayList;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"import org.springframework.integration.util.ClassUtils;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"import org.springframework.util.ReflectionUtils.MethodFilter;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"private HandlerMethod handlerMethod;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"private Class<? extends Annotation> annotationType;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"private String methodName;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"private Method method;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"JsonObjectMapper<?, ?> mapper;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"try {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"mapper = JsonObjectMapperProvider.newInstance();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"}"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"catch (IllegalStateException e) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"mapper = null;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"this.jsonObjectMapper = mapper;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"this.methodName = methodName;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Assert.notNull(targetObject, ""targetObject must not be null"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Map<String, Map<Class<?>, HandlerMethod>> handlerMethodsForTarget ="
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"findHandlerMethodsForTarget(annotationType, methodName, expectedType != null);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"HandlerMethod handlerMethod = new HandlerMethod(invocableHandlerMethod, this.canProcessMessageList);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"checkSpelInvokerRequired(getTargetClass(this.targetObject), method, handlerMethod);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"return handlerMethod;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"() -> ""Cannot convert to expected type ("" + this.expectedType + "") from "" + this.method);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"private Map<String, Map<Class<?>, HandlerMethod>> findHandlerMethodsForTarget("
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"final Class<? extends Annotation> annotationType, final String methodNameArg, final boolean requiresReply) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"final Map<Class<?>, HandlerMethod> candidateMethods = new HashMap<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"final Map<Class<?>, HandlerMethod> candidateMessageMethods = new HashMap<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"final Map<Class<?>, HandlerMethod> fallbackMethods = new HashMap<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"final Map<Class<?>, HandlerMethod> fallbackMessageMethods = new HashMap<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"final AtomicReference<Class<?>> ambiguousFallbackType = new AtomicReference<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"final AtomicReference<Class<?>> ambiguousFallbackMessageGenericType = new AtomicReference<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"final Class<?> targetClass = getTargetClass(this.targetObject);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"final String methodNameToUse;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (methodNameArg == null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (Function.class.isAssignableFrom(targetClass)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"methodNameToUse = ""apply"";"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"else if (Consumer.class.isAssignableFrom(targetClass)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"methodNameToUse = ""accept"";"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"else {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"methodNameToUse = null;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"methodNameToUse = methodNameArg;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"MethodFilter methodFilter = new UniqueMethodFilter(targetClass);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (method1.isBridge()) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"return;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (isMethodDefinedOnObjectClass(method1)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (method1.getDeclaringClass().equals(Proxy.class)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (annotationType != null && AnnotationUtils.findAnnotation(method1, annotationType) != null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (requiresReply && void.class.equals(method1.getReturnType())) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (methodNameToUse != null && !methodNameToUse.equals(method1.getName())) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (methodNameToUse == null"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"&& ObjectUtils.containsElement(new String[] { ""start"", ""stop"", ""isRunning"" }, method1.getName())) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"HandlerMethod handlerMethod1;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"method1 = AopUtils.selectInvocableMethod(method1,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"org.springframework.util.ClassUtils.getUserClass(this.targetObject));"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"handlerMethod1 = createHandlerMethod(method1);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"catch (IneligibleMethodException e) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (LOGGER.isDebugEnabled()) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"LOGGER.debug(""Method ["" + method1 + ""] is not eligible for Message handling """
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"+ e.getMessage() + ""."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"LOGGER.debug(""Method ["" + method1 + ""] is not eligible for Message handling."", e);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (AnnotationUtils.getAnnotation(method1, Default.class) != null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"this.defaultHandlerMethod = handlerMethod1;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Class<?> targetParameterType = handlerMethod1.getTargetParameterType();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (matchesAnnotation || annotationType == null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (handlerMethod1.isMessageMethod()) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (candidateMessageMethods.containsKey(targetParameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"throw new IllegalArgumentException(""Found more than one method match for type "" +"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"""[Message<"" + targetParameterType + "">]"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"candidateMessageMethods.put(targetParameterType, handlerMethod1);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (candidateMethods.containsKey(targetParameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"String exceptionMessage = ""Found more than one method match for "";"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (Void.class.equals(targetParameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"exceptionMessage += ""empty parameter for 'payload'"";"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"exceptionMessage += ""type ["" + targetParameterType + ""]"";"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"throw new IllegalArgumentException(exceptionMessage);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"candidateMethods.put(targetParameterType, handlerMethod1);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (fallbackMessageMethods.containsKey(targetParameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"// we need to check for duplicate type matches,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"// but only if we end up falling back"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"// and we'll only keep track of the first one"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"ambiguousFallbackMessageGenericType.compareAndSet(null, targetParameterType);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"fallbackMessageMethods.put(targetParameterType, handlerMethod1);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (fallbackMethods.containsKey(targetParameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"ambiguousFallbackType.compareAndSet(null, targetParameterType);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"fallbackMethods.put(targetParameterType, handlerMethod1);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"}, methodFilter);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (candidateMethods.isEmpty() && candidateMessageMethods.isEmpty() && fallbackMethods.isEmpty()"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"&& fallbackMessageMethods.isEmpty()) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"findSingleSpecifMethodOnInterfacesIfProxy(methodNameToUse, candidateMessageMethods, candidateMethods);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (!candidateMethods.isEmpty() || !candidateMessageMethods.isEmpty()) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"methods.put(CANDIDATE_METHODS, candidateMethods);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"methods.put(CANDIDATE_MESSAGE_METHODS, candidateMessageMethods);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"return methods;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if ((ambiguousFallbackType.get() != null"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"|| ambiguousFallbackMessageGenericType.get() != null)"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"&& ServiceActivator.class.equals(annotationType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"/*"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"* When there are ambiguous fallback methods,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"* a Service Activator can finally fallback to RequestReplyExchanger.exchange(m)."
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"* Ambiguous means > 1 method that takes the same payload type, or > 1 method"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"* that takes a Message with the same generic type."
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"*/"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"List<Method> frameworkMethods = new ArrayList<>();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Class<?>[] allInterfaces = org.springframework.util.ClassUtils.getAllInterfacesForClass(targetClass);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"for (Class<?> iface : allInterfaces) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (""org.springframework.integration.gateway.RequestReplyExchanger"".equals(iface.getName())) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"frameworkMethods.add(targetClass.getMethod(""exchange"", Message.class));"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"LOGGER.debug(this.targetObject.getClass() +"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,""": Ambiguous fallback methods; using RequestReplyExchanger.exchange()"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"catch (Exception e) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"// should never happen (but would fall through to errors below)"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (frameworkMethods.size() == 1) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Method frameworkMethod = org.springframework.util.ClassUtils.getMostSpecificMethod("
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"frameworkMethods.get(0), this.targetObject.getClass());"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"HandlerMethod theHandlerMethod = createHandlerMethod(frameworkMethod);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"methods.put(CANDIDATE_METHODS, Collections.singletonMap(Object.class, theHandlerMethod));"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Assert.state(!fallbackMethods.isEmpty() || !fallbackMessageMethods.isEmpty(),"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"() -> ""Target object of type ["" + this.targetObject.getClass() +"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"""] has no eligible methods for handling Messages."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Assert.isNull(ambiguousFallbackType.get(),"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"() -> ""Found ambiguous parameter type ["" + ambiguousFallbackType +"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"""] for method match: "" + fallbackMethods.values());"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Assert.isNull(ambiguousFallbackMessageGenericType.get(),"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"() -> ""Found ambiguous parameter type ["""
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"+ ambiguousFallbackMessageGenericType"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"+ ""] for method match: """
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"+ fallbackMethods.values());"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"methods.put(CANDIDATE_METHODS, fallbackMethods);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"methods.put(CANDIDATE_MESSAGE_METHODS, fallbackMessageMethods);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"private void findSingleSpecifMethodOnInterfacesIfProxy(final String methodName,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Map<Class<?>, HandlerMethod> candidateMessageMethods,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"throw new IllegalStateException(""Ambiguous method "" + methodName + "" on "" + this.targetObject);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"}, method12 -> method12.getName().equals(methodName));"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"theMethod = org.springframework.util.ClassUtils"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,".getMostSpecificMethod(theMethod, this.targetObject.getClass());"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"else if (org.springframework.util.ClassUtils.isCglibProxyClass(targetClass)"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"|| targetClass.getSimpleName().contains(""$MockitoMock$"")) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"match = ClassUtils.findClosestMatch(payloadType, candidates, true);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (mappingAnnotation != null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Class<? extends Annotation> annotationType = mappingAnnotation.annotationType();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (annotationType.equals(Payload.class)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"sb.append(""payload"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"String qualifierExpression = (String) AnnotationUtils.getValue(mappingAnnotation);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (StringUtils.hasText(qualifierExpression)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"sb.append(""."")"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,".append(qualifierExpression);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (!StringUtils.hasText(qualifierExpression)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"this.setExclusiveTargetParameterType(parameterTypeDescriptor, methodParameter);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (annotationType.equals(Payloads.class)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Assert.isTrue(this.canProcessMessageList,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"""The @Payloads annotation can only be applied "" +"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"""if method handler canProcessMessageList."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Assert.isTrue(Collection.class.isAssignableFrom(parameterType),"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"""The @Payloads annotation can only be applied to a Collection-typed parameter."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"sb.append(""messages.![payload"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"String qualifierExpression = ((Payloads) mappingAnnotation).value();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"sb.append(""]"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"else if (annotationType.equals(Headers.class)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Assert.isTrue(Map.class.isAssignableFrom(parameterType),"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"""The @Headers annotation can only be applied to a Map-typed parameter."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"sb.append(""headers"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"else if (annotationType.equals(Header.class)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"sb.append(this.determineHeaderExpression(mappingAnnotation, methodParameter));"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"else if (parameterTypeDescriptor.isAssignableTo(MESSAGE_TYPE_DESCRIPTOR)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"this.messageMethod = true;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"sb.append(""message"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"else if (this.canProcessMessageList &&"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"(parameterTypeDescriptor.isAssignableTo(MESSAGE_LIST_TYPE_DESCRIPTOR)"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"|| parameterTypeDescriptor.isAssignableTo(MESSAGE_ARRAY_TYPE_DESCRIPTOR))) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"sb.append(""messages"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"else if (Collection.class.isAssignableFrom(parameterType) || parameterType.isArray()) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (this.canProcessMessageList) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"sb.append(""messages.![payload]"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"else if (Iterator.class.isAssignableFrom(parameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Type type = method.getGenericParameterTypes()[i];"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Type parameterizedType = null;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (type instanceof ParameterizedType) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"parameterizedType = ((ParameterizedType) type).getActualTypeArguments()[0];"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (parameterizedType instanceof ParameterizedType) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"parameterizedType = ((ParameterizedType) parameterizedType).getRawType();"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (parameterizedType != null && Message.class.isAssignableFrom((Class<?>) parameterizedType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"sb.append(""messages.iterator()"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"sb.append(""messages.![payload].iterator()"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"sb.append(""payload.iterator()"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"else if (Map.class.isAssignableFrom(parameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (Properties.class.isAssignableFrom(parameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"sb.append(""payload instanceof T(java.util.Map) or """
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"+ ""(payload instanceof T(String) and payload.contains('=')) ? payload : headers"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"sb.append(""(payload instanceof T(java.util.Map) ? payload : headers)"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"Assert.isTrue(!hasUnqualifiedMapParameter,"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"""Found more than one Map typed parameter without any qualification. """
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"+ ""Consider using @Payload or @Headers on at least one of the parameters."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"hasUnqualifiedMapParameter = true;"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (hasUnqualifiedMapParameter) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (this.targetParameterType != null && Map.class.isAssignableFrom(this.targetParameterType)) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"throw new IllegalArgumentException("
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"""Unable to determine payload matching parameter due to ambiguous Map typed parameters. """
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"+ ""Consider adding the @Payload and or @Headers annotations as appropriate."");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"sb.append("")"");"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"if (this.targetParameterTypeDescriptor == null) {"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"this.targetParameterTypeDescriptor = TypeDescriptor.valueOf(Void.class);"
"b4273dd6627cce57e9b2c78ae36491432065c649","ae3aaf17ba0819fedcb31ac1c18fec2701ce630a","deleted",1,"return sb.toString();"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"HandlerMethod newHandlerMethod = new HandlerMethod(method, this.canProcessMessageList);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"StandardEvaluationContext context = getEvaluationContext();"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return methods"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".stream()"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".anyMatch(candidate ->"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"typeConverter.canConvert(TypeDescriptor.valueOf(candidate.getReturnType()), this.expectedType));"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"result = invokeExpression(candidate.expression, parameters);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return getEvaluationContext()"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private synchronized void initialize() {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (isProvidedMessageHandlerFactoryBean()) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"LOGGER.info(""Overriding default instance of MessageHandlerMethodFactory with provided one."");"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.messageHandlerMethodFactory ="
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"getBeanFactory()"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".getBean("
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.canProcessMessageList"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"? IntegrationContextUtils.LIST_MESSAGE_HANDLER_FACTORY_BEAN_NAME"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,": IntegrationContextUtils.MESSAGE_HANDLER_FACTORY_BEAN_NAME,"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"MessageHandlerMethodFactory.class);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"configureLocalMessageHandlerFactory();"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"prepareEvaluationContext();"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.initialized = true;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"}"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private boolean isProvidedMessageHandlerFactoryBean() {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"BeanFactory beanFactory = getBeanFactory();"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return beanFactory != null"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"&& beanFactory.containsBean("
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,": IntegrationContextUtils.MESSAGE_HANDLER_FACTORY_BEAN_NAME);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private void initializeHandler(HandlerMethod candidate) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"ExpressionParser parser;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (candidate.useSpelInvoker == null) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"parser = EXPRESSION_PARSER_DEFAULT;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"String compilerMode = resolveExpression(candidate.useSpelInvoker.compilerMode()).toUpperCase();"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"parser = !StringUtils.hasText(compilerMode)"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"? EXPRESSION_PARSER_DEFAULT"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,": SPEL_COMPILERS.get(SpelCompilerMode.valueOf(compilerMode));"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"candidate.expression = parser.parseExpression(candidate.expressionString);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (!this.useSpelInvoker && !candidate.spelOnly) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"candidate.setInvocableHandlerMethod(createInvocableHandlerMethod(candidate.method));"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"candidate.initialized = true;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private void configureLocalMessageHandlerFactory() {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"MessageConverter messageConverter = new ConfigurableCompositeMessageConverter();"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"PayloadExpressionArgumentResolver payloadExpressionArgumentResolver = new PayloadExpressionArgumentResolver();"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"PayloadsArgumentResolver payloadsArgumentResolver = new PayloadsArgumentResolver();"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"customArgumentResolvers.add(new NullAwarePayloadArgumentResolver(messageConverter));"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"CollectionArgumentResolver collectionArgumentResolver = null;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"collectionArgumentResolver = new CollectionArgumentResolver(true);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"MapArgumentResolver mapArgumentResolver = new MapArgumentResolver();"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (beanFactory != null) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"payloadExpressionArgumentResolver.setBeanFactory(beanFactory);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"payloadsArgumentResolver.setBeanFactory(beanFactory);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"mapArgumentResolver.setBeanFactory(beanFactory);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"if (collectionArgumentResolver != null) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"collectionArgumentResolver.setBeanFactory(beanFactory);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"DefaultMessageHandlerMethodFactory localHandlerMethodFactory ="
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"(DefaultMessageHandlerMethodFactory) this.messageHandlerMethodFactory;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"localHandlerMethodFactory.setMessageConverter(messageConverter);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"localHandlerMethodFactory.setCustomArgumentResolvers(customArgumentResolvers);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"localHandlerMethodFactory.afterPropertiesSet();"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return ClassUtils.getMostSpecificMethod("
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"targetClass.getMethod(""exchange"", Message.class),"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.targetObject.getClass());"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return null;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private String resolveExpression(String value) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"Assert.isInstanceOf(String.class, evaluated, ""UseSpelInvoker.compilerMode:"");"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private final Method method;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private Expression expression;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private TypeDescriptor targetParameterTypeDescriptor;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private Class<?> targetParameterType = Void.class;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private boolean messageMethod;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private UseSpelInvoker useSpelInvoker;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private volatile boolean spelOnly;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"HandlerMethod(Method method, boolean canProcessMessageList) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.method = method;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.expressionString = generateExpression(this.method);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"void setInvocableHandlerMethod(InvocableHandlerMethod newInvocableHandlerMethod) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return this.method.toString();"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import org.springframework.beans.factory.NoSuchBeanDefinitionException;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import org.springframework.core.convert.ConversionService;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"((DefaultMessageHandlerMethodFactory) this.messageHandlerMethodFactory).setBeanFactory(beanFactory);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"@Override"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"public void setConversionService(ConversionService conversionService) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"super.setConversionService(conversionService);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (conversionService != null) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"((DefaultMessageHandlerMethodFactory) this.messageHandlerMethodFactory)"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".setConversionService(conversionService);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"}"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"/*"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"* Private constructors for internal use"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"*/"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private boolean isProvidedMessageHandlerFactoryBean() {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"BeanFactory beanFactory = getBeanFactory();"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return beanFactory != null"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"&& beanFactory.containsBean(IntegrationContextUtils.MESSAGE_HANDLER_FACTORY_BEAN_NAME);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"InvocableHandlerMethod invocableHandlerMethod = createInvocableHandlerMethod(method);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"HandlerMethod newHandlerMethod = new HandlerMethod(invocableHandlerMethod, this.canProcessMessageList);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"StandardEvaluationContext context = getEvaluationContext(false);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"for (Method candidate : methods) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (typeConverter.canConvert(TypeDescriptor.valueOf(candidate.getReturnType()), this.expectedType)) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return true;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return false;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Expression expression = candidate.expression;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"result = invokeExpression(expression, parameters);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return getEvaluationContext(true)"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private void initializeHandler(HandlerMethod candidate) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"ExpressionParser parser;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (candidate.useSpelInvoker == null) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"parser = EXPRESSION_PARSER_DEFAULT;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"String compilerMode = resolveExpression(candidate.useSpelInvoker.compilerMode(),"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""UseSpelInvoker.compilerMode:"").toUpperCase();"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"parser = !StringUtils.hasText(compilerMode)"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"? EXPRESSION_PARSER_DEFAULT"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,": SPEL_COMPILERS.get(SpelCompilerMode.valueOf(compilerMode));"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"candidate.expression = parser.parseExpression(candidate.expressionString);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"candidate.initialized = true;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"@SuppressWarnings(""deprecation"")"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private synchronized void initialize() {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (!this.initialized) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (isProvidedMessageHandlerFactoryBean()) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"LOGGER.info(""Overriding default instance of MessageHandlerMethodFactory with provided one."");"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.messageHandlerMethodFactory ="
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"beanFactory.getBean(IntegrationContextUtils.MESSAGE_HANDLER_FACTORY_BEAN_NAME,"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"MessageHandlerMethodFactory.class);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.handlerMethodsList"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".stream()"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".map(Map::values)"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".flatMap(Collection::stream)"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".forEach(handlerMethod ->"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"handlerMethod.replaceInvocableHandlerMethod("
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"createInvocableHandlerMethod(handlerMethod.invocableHandlerMethod.getMethod())));"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"else {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (beanFactory != null &&"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"beanFactory.containsBean("
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"IntegrationContextUtils.ARGUMENT_RESOLVER_MESSAGE_CONVERTER_BEAN_NAME)) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"try {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"MessageConverter messageConverter ="
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"beanFactory.getBean("
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"IntegrationContextUtils.ARGUMENT_RESOLVER_MESSAGE_CONVERTER_BEAN_NAME,"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"MessageConverter.class);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".setMessageConverter(messageConverter);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"HandlerMethodArgumentResolversHolder handlerMethodArgumentResolversHolder ="
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"beanFactory.getBean(this.canProcessMessageList"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"? IntegrationContextUtils.LIST_ARGUMENT_RESOLVERS_BEAN_NAME"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,": IntegrationContextUtils.ARGUMENT_RESOLVERS_BEAN_NAME,"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"HandlerMethodArgumentResolversHolder.class);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".setCustomArgumentResolvers("
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"handlerMethodArgumentResolversHolder.getResolvers());"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"catch (NoSuchBeanDefinitionException e) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"configureLocalMessageHandlerFactory();"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"((DefaultMessageHandlerMethodFactory) this.messageHandlerMethodFactory).afterPropertiesSet();"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"prepareEvaluationContext();"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.initialized = true;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private void configureLocalMessageHandlerFactory() {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"MessageConverter messageConverter = null;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"beanFactory.containsBean(IntegrationContextUtils.ARGUMENT_RESOLVER_MESSAGE_CONVERTER_BEAN_NAME)) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"messageConverter = beanFactory"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".getBean(IntegrationContextUtils.ARGUMENT_RESOLVER_MESSAGE_CONVERTER_BEAN_NAME,"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"messageConverter = new ConfigurableCompositeMessageConverter();"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"NullAwarePayloadArgumentResolver nullResolver = new NullAwarePayloadArgumentResolver(messageConverter);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"PayloadExpressionArgumentResolver payloadExpressionArgumentResolver = new PayloadExpressionArgumentResolver();"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (beanFactory != null) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"payloadExpressionArgumentResolver.setBeanFactory(beanFactory);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"PayloadsArgumentResolver payloadsArgumentResolver = new PayloadsArgumentResolver();"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"payloadsArgumentResolver.setBeanFactory(beanFactory);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"MapArgumentResolver mapArgumentResolver = new MapArgumentResolver();"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"mapArgumentResolver.setBeanFactory(beanFactory);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"customArgumentResolvers.add(nullResolver);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"CollectionArgumentResolver collectionArgumentResolver = new CollectionArgumentResolver(true);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"collectionArgumentResolver.setBeanFactory(beanFactory);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".setCustomArgumentResolvers(customArgumentResolvers);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Method frameworkMethod = null;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"frameworkMethod ="
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"ClassUtils.getMostSpecificMethod("
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"targetClass.getMethod(""exchange"", Message.class),"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.targetObject.getClass());"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (LOGGER.isDebugEnabled()) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"LOGGER.debug(this.targetObject.getClass() +"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,""": Ambiguous fallback methods; using RequestReplyExchanger.exchange()"");"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"break;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return frameworkMethod;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private String resolveExpression(String value, String msg) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"Assert.isInstanceOf(String.class, evaluated, msg);"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private volatile Expression expression;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private volatile TypeDescriptor targetParameterTypeDescriptor;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private volatile Class<?> targetParameterType = Void.class;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private volatile boolean messageMethod;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private volatile boolean spelOnly;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private volatile UseSpelInvoker useSpelInvoker;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"HandlerMethod(InvocableHandlerMethod invocableHandlerMethod, boolean canProcessMessageList) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.invocableHandlerMethod = invocableHandlerMethod;"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.expressionString = generateExpression(this.invocableHandlerMethod.getMethod());"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"void replaceInvocableHandlerMethod(InvocableHandlerMethod newInvocableHandlerMethod) {"
"d53433cad76a83806a3c4a65609ed3e0c60f0214","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"return this.invocableHandlerMethod.toString();"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"import org.springframework.http.converter.FormHttpMessageConverter;"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @author Artem Bilan"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"*"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private final FormHttpMessageConverter wrappedConverter = new AllEncompassingFormHttpMessageConverter();"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private MultipartFileReader<?> multipartFileReader = new DefaultMultipartFileReader();"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"Assert.notNull(multipartFileReader, ""'multipartFileReader' must not be null"");"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"+ ""Be sure to provide a 'multipartResolver' bean in the ApplicationContext."");"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"return readMultipart((MultipartHttpInputMessage) inputMessage);"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"MultiValueMap<String, Object> resultMap = new LinkedMultiValueMap<>();"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"parameterMap.forEach((key, value) -> resultMap.add((String) key, value));"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"for (Map.Entry<String, List<MultipartFile>> entry : multipartRequest.getMultiFileMap().entrySet()) {"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"List<MultipartFile> multipartFiles = entry.getValue();"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"for (MultipartFile multipartFile : multipartFiles) {"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (!multipartFile.isEmpty()) {"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"resultMap.add(entry.getKey(), this.multipartFileReader.readMultipartFile(multipartFile));"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"}"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"import java.util.Map.Entry;"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private volatile MultipartFileReader<?> multipartFileReader = new DefaultMultipartFileReader();"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private final AllEncompassingFormHttpMessageConverter wrappedConverter = new AllEncompassingFormHttpMessageConverter();"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"*"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Assert.notNull(multipartFileReader, ""multipartFileReader must not be null"");"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"+ ""Be sure to provide a 'multipartResolver' bean in the ApplicationContext."");"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"MultipartHttpInputMessage multipartInputMessage = (MultipartHttpInputMessage) inputMessage;"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return this.readMultipart(multipartInputMessage);"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"MultiValueMap<String, Object> resultMap = new LinkedMultiValueMap<String, Object>();"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"for (Entry<?, ?> entry : parameterMap.entrySet()) {"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"resultMap.add((String) entry.getKey(), entry.getValue());"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"}"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"for (Map.Entry<String, MultipartFile> entry : multipartRequest.getFileMap().entrySet()) {"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"MultipartFile multipartFile = entry.getValue();"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (multipartFile.isEmpty()) {"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"continue;"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"resultMap.add(entry.getKey(), this.multipartFileReader.readMultipartFile(multipartFile));"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"import static org.assertj.core.api.Assertions.assertThat;"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.multipart;"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"import java.nio.charset.StandardCharsets;"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"import java.util.Map;"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"import org.springframework.beans.factory.annotation.Qualifier;"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"import org.springframework.http.MediaType;"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"import org.springframework.integration.http.multipart.UploadedMultipartFile;"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"import org.springframework.messaging.Message;"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"import org.springframework.messaging.PollableChannel;"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"import org.springframework.mock.web.MockPart;"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"import org.springframework.web.multipart.MultipartResolver;"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"import org.springframework.web.multipart.support.StandardServletMultipartResolver;"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"import org.springframework.web.servlet.DispatcherServlet;"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".andExpect(content().string(""FOO""));"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".andExpect(status().isForbidden())"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".andExpect(content().string(""Error""));"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".with(httpBasic(""user"", ""user""))"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".andExpect(content().string(""bar""));"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".andExpect(status().isNotFound());"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"}"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"@Autowired"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"@Qualifier(""multiPartFilesChannel"")"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"private PollableChannel multiPartFilesChannel;"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"@Test"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"@SuppressWarnings(""unchecked"")"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"public void testMultiPartFiles() throws Exception {"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"MockPart mockPart1 = new MockPart(""a1"", ""file1"", ""ABC"".getBytes(StandardCharsets.UTF_8));"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"mockPart1.getHeaders().setContentType(MediaType.TEXT_PLAIN);"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"MockPart mockPart2 = new MockPart(""a1"", ""file2"", ""DEF"".getBytes(StandardCharsets.UTF_8));"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"mockPart2.getHeaders().setContentType(MediaType.TEXT_PLAIN);"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"this.mockMvc.perform("
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"multipart(""/multiPartFiles"")"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".part(mockPart1, mockPart2)"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".with(httpBasic(""user"", ""user"")))"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".andExpect(status().isOk());"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"Message<?> result = this.multiPartFilesChannel.receive(10_000);"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"assertThat(result)"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".isNotNull()"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".extracting(Message::getPayload)"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".satisfies((payload) ->"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"assertThat((Map<String, ?>) payload)"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".hasSize(1)"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".extracting((map) -> map.get(""a1""))"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".asList()"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".hasSize(2)"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".satisfies((list) -> {"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"assertThat(list)"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".element(0)"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".extracting((file) ->"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"((UploadedMultipartFile) file).getOriginalFilename())"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".isEqualTo(""file1"");"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".element(1)"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".isEqualTo(""file2"");"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"}));"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"@Bean"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"public IntegrationFlow multiPartFilesFlow() {"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"return IntegrationFlows"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".from(Http.inboundChannelAdapter(""/multiPartFiles""))"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".channel((c) -> c.queue(""multiPartFilesChannel""))"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,".get();"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"@Bean(name = DispatcherServlet.MULTIPART_RESOLVER_BEAN_NAME)"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"public MultipartResolver multipartResolver() {"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","added",0,"return new StandardServletMultipartResolver();"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","deleted",1,".andExpect("
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","deleted",1,"content()"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","deleted",1,".string(""FOO""));"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","deleted",1,"status()"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","deleted",1,".isForbidden())"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","deleted",1,".string(""Error""));"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","deleted",1,".with(httpBasic(""admin"", ""admin""))"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","deleted",1,".string(""bar""));"
"2e2b49a22faef6f9bd4ab00ac8e56bc95b60cda5","6dad4732198f95435137dfedd16eabd981df7c79","deleted",1,".isNotFound());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"import org.springframework.lang.Nullable;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"protected final Log logger = LogFactory.getLog(getClass()); // NOSONAR - final"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"/**"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#ACCEPT}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"*/"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"@Deprecated"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String ACCEPT = HttpHeaders.ACCEPT;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#ACCEPT_CHARSET}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String ACCEPT_CHARSET = HttpHeaders.ACCEPT_CHARSET;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#ACCEPT_ENCODING}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String ACCEPT_ENCODING = HttpHeaders.ACCEPT_ENCODING;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#ACCEPT_LANGUAGE}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String ACCEPT_LANGUAGE = HttpHeaders.ACCEPT_LANGUAGE;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#ACCEPT_RANGES}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String ACCEPT_RANGES = HttpHeaders.ACCEPT_RANGES;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#AGE}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String AGE = HttpHeaders.AGE;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#ALLOW}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String ALLOW = HttpHeaders.ALLOW;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#AUTHORIZATION}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String AUTHORIZATION = HttpHeaders.AUTHORIZATION;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#CACHE_CONTROL}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String CACHE_CONTROL = HttpHeaders.CACHE_CONTROL;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#CONNECTION}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String CONNECTION = HttpHeaders.CONNECTION;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#CONTENT_ENCODING}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String CONTENT_ENCODING = HttpHeaders.CONTENT_ENCODING;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#CONTENT_LANGUAGE}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String CONTENT_LANGUAGE = HttpHeaders.CONTENT_LANGUAGE;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#CONTENT_LENGTH}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String CONTENT_LENGTH = HttpHeaders.CONTENT_LENGTH;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#CONTENT_LOCATION}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String CONTENT_LOCATION = HttpHeaders.CONTENT_LOCATION;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#CONTENT_RANGE}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String CONTENT_RANGE = HttpHeaders.CONTENT_RANGE;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#CONTENT_TYPE}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String CONTENT_TYPE = HttpHeaders.CONTENT_TYPE;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#CONTENT_DISPOSITION}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String CONTENT_DISPOSITION = HttpHeaders.CONTENT_DISPOSITION;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#COOKIE}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String COOKIE = HttpHeaders.COOKIE;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#DATE}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String DATE = HttpHeaders.DATE;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#ETAG}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String ETAG = HttpHeaders.ETAG;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#EXPECT}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String EXPECT = HttpHeaders.EXPECT;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#EXPIRES}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String EXPIRES = HttpHeaders.EXPIRES;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#FROM}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String FROM = HttpHeaders.FROM;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#HOST}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String HOST = HttpHeaders.HOST;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#IF_MATCH}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String IF_MATCH = HttpHeaders.IF_MATCH;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#IF_MODIFIED_SINCE}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String IF_MODIFIED_SINCE = HttpHeaders.IF_MODIFIED_SINCE;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#IF_NONE_MATCH}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String IF_NONE_MATCH = HttpHeaders.IF_NONE_MATCH;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#IF_RANGE}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String IF_RANGE = HttpHeaders.IF_RANGE;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#IF_UNMODIFIED_SINCE}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String IF_UNMODIFIED_SINCE = HttpHeaders.IF_UNMODIFIED_SINCE;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#LAST_MODIFIED}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String LAST_MODIFIED = HttpHeaders.LAST_MODIFIED;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#LOCATION}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String LOCATION = HttpHeaders.LOCATION;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#MAX_FORWARDS}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String MAX_FORWARDS = HttpHeaders.MAX_FORWARDS;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#PRAGMA}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String PRAGMA = HttpHeaders.PRAGMA;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#PROXY_AUTHENTICATE}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String PROXY_AUTHENTICATE = HttpHeaders.PROXY_AUTHENTICATE;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#PROXY_AUTHORIZATION}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String PROXY_AUTHORIZATION = HttpHeaders.PROXY_AUTHORIZATION;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#RANGE}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String RANGE = HttpHeaders.RANGE;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#REFERER}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String REFERER = HttpHeaders.REFERER;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#RETRY_AFTER}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String RETRY_AFTER = HttpHeaders.RETRY_AFTER;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#SERVER}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String SERVER = HttpHeaders.SERVER;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#SET_COOKIE}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String SET_COOKIE = HttpHeaders.SET_COOKIE;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#TE}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String TE = HttpHeaders.TE;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#TRAILER}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String TRAILER = HttpHeaders.TRAILER;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#UPGRADE}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String UPGRADE = HttpHeaders.UPGRADE;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#USER_AGENT}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String USER_AGENT = HttpHeaders.USER_AGENT;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#VARY}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String VARY = HttpHeaders.VARY;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#VIA}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String VIA = HttpHeaders.VIA;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#WARNING}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String WARNING = HttpHeaders.WARNING;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#WWW_AUTHENTICATE}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String WWW_AUTHENTICATE = HttpHeaders.WWW_AUTHENTICATE;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @deprecated since 5.2 in favor of {@link HttpHeaders#TRANSFER_ENCODING}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String TRANSFER_ENCODING = HttpHeaders.TRANSFER_ENCODING;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public static final String CONTENT_MD5 = ""Content-MD5"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private static final String ACCEPT_LOWER = ""accept"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private static final String ACCEPT_CHARSET_LOWER = ""accept-charset"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private static final String ALLOW_LOWER = ""allow"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private static final String CACHE_CONTROL_LOWER = ""cache-control"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private static final String CONTENT_LENGTH_LOWER = ""content-length"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private static final String CONTENT_TYPE_LOWER = ""content-type"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private static final String DATE_LOWER = ""date"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private static final String ETAG_LOWER = ""etag"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private static final String EXPIRES_LOWER = ""expires"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private static final String IF_MODIFIED_SINCE_LOWER = ""if-modified-since"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private static final String IF_NONE_MATCH_LOWER = ""if-none-match"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private static final String IF_UNMODIFIED_SINCE_LOWER = ""if-unmodified-since"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private static final String LAST_MODIFIED_LOWER = ""last-modified"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private static final String LOCATION_LOWER = ""location"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private static final String PRAGMA_LOWER = ""pragma"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.ACCEPT,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.ACCEPT_CHARSET,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.ACCEPT_ENCODING,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.ACCEPT_LANGUAGE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.ACCEPT_RANGES,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.AUTHORIZATION,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.CACHE_CONTROL,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.CONNECTION,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.CONTENT_LENGTH,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.CONTENT_TYPE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.COOKIE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.DATE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.EXPECT,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.FROM,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.HOST,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.IF_MATCH,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.IF_MODIFIED_SINCE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.IF_NONE_MATCH,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.IF_RANGE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.IF_UNMODIFIED_SINCE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.MAX_FORWARDS,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.PRAGMA,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.PROXY_AUTHORIZATION,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.RANGE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.REFERER,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.TE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.UPGRADE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.USER_AGENT,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.VIA,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.WARNING"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.AGE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.ALLOW,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.CONTENT_ENCODING,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.CONTENT_LANGUAGE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.CONTENT_LOCATION,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.CONTENT_RANGE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.CONTENT_DISPOSITION,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.TRANSFER_ENCODING,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.ETAG,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.EXPIRES,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.LAST_MODIFIED,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.LOCATION,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.PROXY_AUTHENTICATE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.RETRY_AFTER,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.SERVER,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.SET_COOKIE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.TRAILER,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.VARY,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.WARNING,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.WWW_AUTHENTICATE"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private static final Set<String> HTTP_RESPONSE_HEADER_NAMES_LOWER = new HashSet<>();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private static final String[] HTTP_RESPONSE_HEADER_NAMES_INBOUND_EXCLUSIONS ="
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"{ HttpHeaders.CONTENT_LENGTH, HttpHeaders.TRANSFER_ENCODING };"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"protected static final DateTimeFormatter[] DATE_FORMATS = {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"DateTimeFormatter.ofPattern(""EEE MMM dd HH:mm:ss yyyy"", Locale.US).withZone(ZoneId.of(""GMT"")) // NOSONAR"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public void setOutboundHeaderNames(String... outboundHeaderNames) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"this.outboundHeaderNames ="
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"outboundHeaderNames != null"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"? Arrays.copyOf(outboundHeaderNames, outboundHeaderNames.length)"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,": new String[0];"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public void setInboundHeaderNames(String... inboundHeaderNames) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"this.inboundHeaderNames ="
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"inboundHeaderNames != null"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"? Arrays.copyOf(inboundHeaderNames, inboundHeaderNames.length)"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"@Override"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public void afterPropertiesSet() {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (this.beanFactory != null) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"this.conversionService = IntegrationUtils.getConversionService(this.beanFactory);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"Object value = entry.getValue();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (value != null && shouldMapOutboundHeader(lowerName)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (!HTTP_REQUEST_HEADER_NAMES_LOWER.contains(lowerName) &&"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"!HTTP_RESPONSE_HEADER_NAMES_LOWER.contains(lowerName) &&"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"!MessageHeaders.CONTENT_TYPE.equalsIgnoreCase(name)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"// prefix the user-defined header names if not already prefixed"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"name ="
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"StringUtils.startsWithIgnoreCase(name, this.userDefinedHeaderPrefix)"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"? name"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,": this.userDefinedHeaderPrefix + name;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (this.logger.isDebugEnabled()) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"this.logger.debug(MessageFormat.format(""setting headerName=[{0}], value={1}"", name, value));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"setHttpHeader(target, name, value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private void setHttpHeader(HttpHeaders target, String name, Object value) { // NOSONAR"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"switch (name.toLowerCase()) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"case ACCEPT_LOWER:"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"setAccept(target, value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"break;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"case ACCEPT_CHARSET_LOWER:"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"setAcceptCharset(target, value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"case ALLOW_LOWER:"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"setAllow(target, value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"case CACHE_CONTROL_LOWER:"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"setCacheControl(target, value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"case CONTENT_LENGTH_LOWER:"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"setContentLength(target, value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"case ""contenttype"": // Lower case for MessageHeaders.CONTENT_TYPE"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"setContentType(target, value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"case DATE_LOWER:"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"setDate(target, value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"case ETAG_LOWER:"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"setETag(target, value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"case EXPIRES_LOWER:"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"setExpires(target, value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"case IF_MODIFIED_SINCE_LOWER:"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"setIfModifiedSince(target, value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"case IF_UNMODIFIED_SINCE_LOWER:"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"setIfUnmodifiedSince(target, value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"case IF_NONE_MATCH_LOWER:"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"setIfNoneMatch(target, value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"case LAST_MODIFIED_LOWER:"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"setLastModified(target, value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"case LOCATION_LOWER:"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"setLocation(target, value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"case PRAGMA_LOWER:"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"setPragma(target, value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"default:"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (value instanceof String) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.set(name, (String) value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"else if (value instanceof String[]) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.addAll(name, Arrays.asList((String[]) value));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"else if (value instanceof Iterable<?>) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"setIterableHeader(target, name, value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"setPlainHeader(target, name, value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private void setAccept(HttpHeaders target, Object value) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"Collection<?> valuesToAccept = valueToCollection(value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (!CollectionUtils.isEmpty(valuesToAccept)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"List<MediaType> acceptableMediaTypes = new ArrayList<>();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"for (Object type : valuesToAccept) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (type instanceof MediaType) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"acceptableMediaTypes.add((MediaType) type);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"else if (type instanceof String) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"acceptableMediaTypes.addAll(MediaType.parseMediaTypes((String) type));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"else {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"throwIllegalArgumentForUnexpectedValue("
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"""Expected MediaType or String value for 'Accept' header value, but received: "", type);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setAccept(acceptableMediaTypes);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private void setAcceptCharset(HttpHeaders target, Object value) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"Collection<?> valuesToConvert = valueToCollection(value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (!CollectionUtils.isEmpty(valuesToConvert)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"List<Charset> acceptableCharsets = new ArrayList<>();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"for (Object charset : valuesToConvert) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (charset instanceof Charset) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"acceptableCharsets.add((Charset) charset);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"else if (charset instanceof String) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"String[] charsets = StringUtils.delimitedListToStringArray((String) charset, "","", "" "");"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"for (String charset2 : charsets) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"acceptableCharsets.add(Charset.forName(charset2));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"""Expected Charset or String value for 'Accept-Charset' header value, but received: "","
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"charset);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setAcceptCharset(acceptableCharsets);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private void setAllow(HttpHeaders target, Object value) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"Set<HttpMethod> allowedMethods = new HashSet<>();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"for (Object method : valuesToConvert) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (method instanceof HttpMethod) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"allowedMethods.add((HttpMethod) method);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"else if (method instanceof String) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"String[] methods = StringUtils.delimitedListToStringArray((String) method, "","", "" "");"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"for (String method2 : methods) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"allowedMethods.add(HttpMethod.valueOf(method2));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"""Expected HttpMethod or String value for 'Allow' header value, but received: "", method);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setAllow(allowedMethods);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private Collection<?> valueToCollection(Object value) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"Collection<?> valuesToConvert;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (value instanceof Collection<?>) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"valuesToConvert = (Collection<?>) value;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"else if (value.getClass().isArray()) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"valuesToConvert = Arrays.asList(ObjectUtils.toObjectArray(value));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"valuesToConvert = Collections.singleton(value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"return valuesToConvert;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private void setCacheControl(HttpHeaders target, Object value) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setCacheControl((String) value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"""Expected String value for 'Cache-Control' header value, but received: "", value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private void setContentLength(HttpHeaders target, Object value) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (value instanceof Number) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setContentLength(((Number) value).longValue());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"else if (value instanceof String) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setContentLength(Long.parseLong((String) value));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"""Expected Number or String value for 'Content-Length' header value, but received: "", value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private void setContentType(HttpHeaders target, Object value) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (value instanceof MediaType) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setContentType((MediaType) value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setContentType(MediaType.parseMediaType((String) value));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"""Expected MediaType or String value for 'Content-Type' header value, but received: "", value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private void setDate(HttpHeaders target, Object value) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (value instanceof Date) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setDate(((Date) value).getTime());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"else if (value instanceof Number) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setDate(((Number) value).longValue());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"try {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setDate(Long.parseLong((String) value));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"catch (@SuppressWarnings(UNUSED) NumberFormatException e) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setDate(getFirstDate((String) value, HttpHeaders.DATE));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"""Expected Date, Number, or String value for 'Date' header value, but received: "", value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private void setETag(HttpHeaders target, Object value) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setETag((String) value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"throwIllegalArgumentForUnexpectedValue(""Expected String value for 'ETag' header value, but received: "","
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private void setExpires(HttpHeaders target, Object value) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setExpires(((Date) value).getTime());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setExpires(((Number) value).longValue());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setExpires(Long.parseLong((String) value));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setExpires(getFirstDate((String) value, HttpHeaders.EXPIRES));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"""Expected Date, Number, or String value for 'Expires' header value, but received: "", value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private void setIfModifiedSince(HttpHeaders target, Object value) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setIfModifiedSince(((Date) value).getTime());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setIfModifiedSince(((Number) value).longValue());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setIfModifiedSince(Long.parseLong((String) value));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setIfModifiedSince(getFirstDate((String) value, HttpHeaders.IF_MODIFIED_SINCE));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"""Expected Date, Number, or String value for 'If-Modified-Since' header value, but received: "","
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private void setIfUnmodifiedSince(HttpHeaders target, Object value) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setIfUnmodifiedSince(((Date) value).getTime());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setIfUnmodifiedSince(((Number) value).longValue());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setIfUnmodifiedSince(Long.parseLong((String) value));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setIfUnmodifiedSince(getFirstDate((String) value, HttpHeaders.IF_UNMODIFIED_SINCE));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"""Expected Date, Number, or String value for 'If-Unmodified-Since' header value, but received: "","
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private void setIfNoneMatch(HttpHeaders target, Object value) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"List<String> ifNoneMatchList = new ArrayList<>();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"for (Object match : valuesToAccept) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (match instanceof String) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"ifNoneMatchList.add((String) match);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"""Expected String value for 'If-None-Match' header value, but received: "", value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (!ifNoneMatchList.isEmpty()) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setIfNoneMatch(ifNoneMatchList);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private void setLastModified(HttpHeaders target, Object value) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setLastModified(((Date) value).getTime());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setLastModified(((Number) value).longValue());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setLastModified(Long.parseLong((String) value));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setLastModified(getFirstDate((String) value, HttpHeaders.LAST_MODIFIED));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"""Expected Date, Number, or String value for 'Last-Modified' header value, but received: "", value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private void setLocation(HttpHeaders target, Object value) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (value instanceof URI) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setLocation((URI) value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setLocation(new URI((String) value));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"catch (URISyntaxException e) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"throw new IllegalArgumentException(e);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"""Expected URI or String value for 'Location' header value, but received: "", value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private void setPragma(HttpHeaders target, Object value) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.setPragma((String) value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"throwIllegalArgumentForUnexpectedValue(""Expected String value for 'Pragma' header value, but received: "","
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private void throwIllegalArgumentForUnexpectedValue(String message, @Nullable Object value) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"throw new IllegalArgumentException(message + (value != null ? value.getClass() : null));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private void setIterableHeader(HttpHeaders target, String name, Object value) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"for (Object next : (Iterable<?>) value) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"String convertedValue;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (next instanceof String) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"convertedValue = (String) next;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"convertedValue = convertToString(value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.add(name, convertedValue);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"this.logger.warn(""Element of the header '"" + name + ""' with value '"" + value +"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private void setPlainHeader(HttpHeaders target, String name, Object value) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"String convertedValue = convertToString(value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (StringUtils.hasText(convertedValue)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"target.set(name, convertedValue);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"this.logger.warn(""Header '"" + name + ""' with value '"" + value +"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"""' will not be set since it is not a String and no Converter is available. "" +"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"""Consider registering a Converter with ConversionService (e.g., <int:converter>)"");"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* Map from an HttpHeaders instance to integration MessageHeaders."
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* Depending on which type of adapter is using this mapper, the HttpHeaders might be"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* from an HTTP request (inbound adapter) or from an HTTP response (outbound adapter)."
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"public Map<String, Object> toHeaders(HttpHeaders source) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"this.logger.debug(""inboundHeaderNames="" + Arrays.toString(this.inboundHeaderNames));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"Map<String, Object> target = new HashMap<>();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"Set<String> headerNames = source.keySet();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"for (String name : headerNames) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"String lowerName = name.toLowerCase();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (shouldMapInboundHeader(lowerName)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (!HTTP_REQUEST_HEADER_NAMES_LOWER.contains(lowerName)"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"&& !HTTP_RESPONSE_HEADER_NAMES_LOWER.contains(lowerName)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"populateUserDefinedHeader(source, target, name);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"populateStandardHeader(source, target, name);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"return target;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private void populateUserDefinedHeader(HttpHeaders source, Map<String, Object> target, String name) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"String prefixedName = StringUtils.startsWithIgnoreCase(name, this.userDefinedHeaderPrefix)"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"Object value = source.containsKey(prefixedName)"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"? getHttpHeader(source, prefixedName)"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,": getHttpHeader(source, name);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (value != null) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"setMessageHeader(target, name, value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private void populateStandardHeader(HttpHeaders source, Map<String, Object> target, String name) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"Object value = getHttpHeader(source, name);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"setMessageHeader(target,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"HttpHeaders.CONTENT_TYPE.equalsIgnoreCase(name) ? MessageHeaders.CONTENT_TYPE : name, value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"protected Object getHttpHeader(HttpHeaders source, String name) { // NOSONAR"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"return source.getAccept();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"return source.getAcceptCharset();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"return source.getAllow();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"String cacheControl = source.getCacheControl();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"return (StringUtils.hasText(cacheControl)) ? cacheControl : null;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"long contentLength = source.getContentLength();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"return (contentLength > -1) ? contentLength : null;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"case CONTENT_TYPE_LOWER:"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"return source.getContentType();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"long date = source.getDate();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"return (date > -1) ? date : null;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"String eTag = source.getETag();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"return (StringUtils.hasText(eTag)) ? eTag : null;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"return source.getIfNoneMatch();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"long modifiedSince = source.getIfModifiedSince();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"return (modifiedSince > -1) ? modifiedSince : null;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"long unmodifiedSince = source.getIfUnmodifiedSince();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"return (unmodifiedSince > -1) ? unmodifiedSince : null;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"long lastModified = source.getLastModified();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"return (lastModified > -1) ? lastModified : null;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"return source.getLocation();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"String pragma = source.getPragma();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"return (StringUtils.hasText(pragma)) ? pragma : null;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"return source.get(name);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private boolean shouldMapOutboundHeader(String headerName) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"String[] outboundHeaderNamesLower = this.outboundHeaderNamesLowerWithContentType;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (this.isDefaultInboundMapper) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"/*"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* When using the default response header name list, suppress the"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* mapping of exclusions for specific headers."
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (containsElementIgnoreCase(this.excludedInboundStandardResponseHeaderNames, headerName)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"this.logger"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,".debug(MessageFormat.format(""headerName=[{0}] WILL NOT be mapped (excluded)"", headerName));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"return false;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"else if (this.isDefaultOutboundMapper) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"outboundHeaderNamesLower = this.outboundHeaderNamesLowerWithContentType;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* When using the default request header name list, suppress the"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (containsElementIgnoreCase(this.excludedOutboundStandardRequestHeaderNames, headerName)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"return shouldMapHeader(headerName, outboundHeaderNamesLower);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"protected final boolean shouldMapInboundHeader(String headerName) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"return shouldMapHeader(headerName, this.inboundHeaderNamesLower);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @param headerName the header name (lower cased)."
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @param patterns the patterns (lower cased)."
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"* @return true if should be mapped."
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private boolean shouldMapHeader(String headerName, String[] patterns) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (patterns != null && patterns.length > 0) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"for (String pattern : patterns) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (matchHeaderForPattern(headerName, pattern)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"return true;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"this.logger.debug(MessageFormat.format(""headerName=[{0}] WILL NOT be mapped"", headerName));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"private boolean matchHeaderForPattern(String headerName, String pattern) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (PatternMatchUtils.simpleMatch(pattern, headerName)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"this.logger.debug(MessageFormat.format(""headerName=[{0}] WILL be mapped, matched pattern={1}"","
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"headerName, pattern));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"else if (HTTP_REQUEST_HEADER_NAME_PATTERN.equals(pattern)"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"&& HTTP_REQUEST_HEADER_NAMES_LOWER.contains(headerName)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"else if (HTTP_RESPONSE_HEADER_NAME_PATTERN.equals(pattern)"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"&& HTTP_RESPONSE_HEADER_NAMES_LOWER.contains(headerName)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"@Nullable"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"protected static boolean containsElementIgnoreCase(String[] headerNames, String name) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"for (String headerName : headerNames) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"if (headerName.equalsIgnoreCase(name)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","added",0,"protected static long getFirstDate(String headerValue, String headerName) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"import java.time.Instant;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"protected final Log logger = LogFactory.getLog(getClass());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String ACCEPT = ""Accept"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String ACCEPT_CHARSET = ""Accept-Charset"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String ACCEPT_ENCODING = ""Accept-Encoding"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String ACCEPT_LANGUAGE = ""Accept-Language"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String ACCEPT_RANGES = ""Accept-Ranges"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String AGE = ""Age"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String ALLOW = ""Allow"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String AUTHORIZATION = ""Authorization"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String CACHE_CONTROL = ""Cache-Control"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String CONNECTION = ""Connection"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String CONTENT_ENCODING = ""Content-Encoding"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String CONTENT_LANGUAGE = ""Content-Language"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String CONTENT_LENGTH = ""Content-Length"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String CONTENT_LOCATION = ""Content-Location"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String CONTENT_MD5 = ""Content-MD5"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String CONTENT_RANGE = ""Content-Range"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String CONTENT_TYPE = ""Content-Type"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String CONTENT_DISPOSITION = ""Content-Disposition"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String COOKIE = ""Cookie"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String DATE = ""Date"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String ETAG = ""ETag"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String EXPECT = ""Expect"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String EXPIRES = ""Expires"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String FROM = ""From"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String HOST = ""Host"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String IF_MATCH = ""If-Match"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String IF_MODIFIED_SINCE = ""If-Modified-Since"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String IF_NONE_MATCH = ""If-None-Match"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String IF_RANGE = ""If-Range"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String IF_UNMODIFIED_SINCE = ""If-Unmodified-Since"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String LAST_MODIFIED = ""Last-Modified"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String LOCATION = ""Location"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String MAX_FORWARDS = ""Max-Forwards"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String PRAGMA = ""Pragma"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String PROXY_AUTHENTICATE = ""Proxy-Authenticate"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String PROXY_AUTHORIZATION = ""Proxy-Authorization"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String RANGE = ""Range"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String REFERER = ""Referer"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String RETRY_AFTER = ""Retry-After"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String SERVER = ""Server"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String SET_COOKIE = ""Set-Cookie"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String TE = ""TE"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String TRAILER = ""Trailer"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String UPGRADE = ""Upgrade"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String USER_AGENT = ""User-Agent"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String VARY = ""Vary"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String VIA = ""Via"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String WARNING = ""Warning"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String WWW_AUTHENTICATE = ""WWW-Authenticate"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public static final String TRANSFER_ENCODING = ""Transfer-Encoding"";"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"ACCEPT,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"ACCEPT_CHARSET,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"ACCEPT_ENCODING,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"ACCEPT_LANGUAGE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"ACCEPT_RANGES,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"AUTHORIZATION,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"CACHE_CONTROL,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"CONNECTION,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"CONTENT_LENGTH,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"CONTENT_TYPE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"COOKIE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"DATE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"EXPECT,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"FROM,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"HOST,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"IF_MATCH,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"IF_MODIFIED_SINCE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"IF_NONE_MATCH,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"IF_RANGE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"IF_UNMODIFIED_SINCE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"MAX_FORWARDS,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"PRAGMA,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"PROXY_AUTHORIZATION,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"RANGE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"REFERER,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"TE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"UPGRADE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"USER_AGENT,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"VIA,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"WARNING"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"AGE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"ALLOW,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"CONTENT_ENCODING,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"CONTENT_LANGUAGE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"CONTENT_LOCATION,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"CONTENT_RANGE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"CONTENT_DISPOSITION,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"TRANSFER_ENCODING,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"ETAG,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"EXPIRES,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"LAST_MODIFIED,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"LOCATION,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"PROXY_AUTHENTICATE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"RETRY_AFTER,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"SERVER,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"SET_COOKIE,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"TRAILER,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"VARY,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"WARNING,"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"WWW_AUTHENTICATE"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private static final Set<String> HTTP_RESPONSE_HEADER_NAMES_LOWER = new HashSet<String>();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private static final String[] HTTP_RESPONSE_HEADER_NAMES_INBOUND_EXCLUSIONS = new String[] {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"CONTENT_LENGTH, TRANSFER_ENCODING"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"};"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"// Copy of 'org.springframework.http.HttpHeaders#GMT'"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private static final ZoneId GMT = ZoneId.of(""GMT"");"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"// Copy of 'org.springframework.http.HttpHeaders#DATE_FORMATTER'"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"protected static final DateTimeFormatter DATE_FORMATTER ="
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"DateTimeFormatter.ofPattern(""EEE, dd MMM yyyy HH:mm:ss zzz"", Locale.US).withZone(GMT);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"protected static final DateTimeFormatter[] DATE_FORMATS = new DateTimeFormatter[] {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"DateTimeFormatter.ofPattern(""EEE MMM dd HH:mm:ss yyyy"", Locale.US).withZone(GMT)"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public void setOutboundHeaderNames(String[] outboundHeaderNames) { //NOSONAR - false positive"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"this.outboundHeaderNames = outboundHeaderNames != null ?"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Arrays.copyOf(outboundHeaderNames, outboundHeaderNames.length) : new String[0];"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public void setInboundHeaderNames(String[] inboundHeaderNames) { //NOSONAR - false positive"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"this.inboundHeaderNames = inboundHeaderNames != null ?"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Arrays.copyOf(inboundHeaderNames, inboundHeaderNames.length) : new String[0];"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (shouldMapOutboundHeader(lowerName)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Object value = entry.getValue();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (value != null) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (!HTTP_REQUEST_HEADER_NAMES_LOWER.contains(lowerName) &&"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"!HTTP_RESPONSE_HEADER_NAMES_LOWER.contains(lowerName) &&"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"!MessageHeaders.CONTENT_TYPE.equalsIgnoreCase(name)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"// prefix the user-defined header names if not already prefixed"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"name ="
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"StringUtils.startsWithIgnoreCase(name, this.userDefinedHeaderPrefix)"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"? name"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,": this.userDefinedHeaderPrefix + name;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"}"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (this.logger.isDebugEnabled()) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"this.logger.debug(MessageFormat.format(""setting headerName=[{0}], value={1}"", name, value));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"setHttpHeader(target, name, value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"/**"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* Map from an HttpHeaders instance to integration MessageHeaders."
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* Depending on which type of adapter is using this mapper, the HttpHeaders might be"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* from an HTTP request (inbound adapter) or from an HTTP response (outbound adapter)."
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"*/"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"@Override"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public Map<String, Object> toHeaders(HttpHeaders source) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"this.logger.debug(MessageFormat.format(""inboundHeaderNames={0}"","
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"CollectionUtils.arrayToList(this.inboundHeaderNames)));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Map<String, Object> target = new HashMap<>();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Set<String> headerNames = source.keySet();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"for (String name : headerNames) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"String lowerName = name.toLowerCase();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (shouldMapInboundHeader(lowerName)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (!HTTP_REQUEST_HEADER_NAMES_LOWER.contains(lowerName)"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"&& !HTTP_RESPONSE_HEADER_NAMES_LOWER.contains(lowerName)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"String prefixedName = StringUtils.startsWithIgnoreCase(name, this.userDefinedHeaderPrefix)"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Object value = source.containsKey(prefixedName)"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"? getHttpHeader(source, prefixedName)"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,": getHttpHeader(source, name);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"setMessageHeader(target, name, value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Object value = getHttpHeader(source, name);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (CONTENT_TYPE.equalsIgnoreCase(name)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"name = MessageHeaders.CONTENT_TYPE;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return target;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"public void afterPropertiesSet() {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (this.beanFactory != null) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"this.conversionService = IntegrationUtils.getConversionService(this.beanFactory);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"protected final boolean containsElementIgnoreCase(String[] headerNames, String name) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"for (String headerName : headerNames) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (headerName.equalsIgnoreCase(name)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return true;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return false;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private boolean shouldMapOutboundHeader(String headerName) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"String[] outboundHeaderNamesLower = this.outboundHeaderNamesLowerWithContentType;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (this.isDefaultInboundMapper) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"/*"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* When using the default response header name list, suppress the"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* mapping of exclusions for specific headers."
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (containsElementIgnoreCase(this.excludedInboundStandardResponseHeaderNames, headerName)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"this.logger"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,".debug(MessageFormat.format(""headerName=[{0}] WILL NOT be mapped (excluded)"", headerName));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (this.isDefaultOutboundMapper) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"outboundHeaderNamesLower = this.outboundHeaderNamesLowerWithContentType;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* When using the default request header name list, suppress the"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (containsElementIgnoreCase(this.excludedOutboundStandardRequestHeaderNames, headerName)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return shouldMapHeader(headerName, outboundHeaderNamesLower);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"protected final boolean shouldMapInboundHeader(String headerName) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return shouldMapHeader(headerName, this.inboundHeaderNamesLower);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* @param headerName the header name (lower cased)."
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* @param patterns the patterns (lower cased)."
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"* @return true if should be mapped."
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private boolean shouldMapHeader(String headerName, String[] patterns) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (patterns != null && patterns.length > 0) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"for (String pattern : patterns) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (PatternMatchUtils.simpleMatch(pattern, headerName)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"this.logger.debug(MessageFormat.format(""headerName=[{0}] WILL be mapped, matched pattern={1}"","
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"headerName, pattern));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (HTTP_REQUEST_HEADER_NAME_PATTERN.equals(pattern)"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"&& HTTP_REQUEST_HEADER_NAMES_LOWER.contains(headerName)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (HTTP_RESPONSE_HEADER_NAME_PATTERN.equals(pattern)"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"&& HTTP_RESPONSE_HEADER_NAMES_LOWER.contains(headerName)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"this.logger.debug(MessageFormat.format(""headerName=[{0}] WILL NOT be mapped"", headerName));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"private void setHttpHeader(HttpHeaders target, String name, Object value) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (ACCEPT.equalsIgnoreCase(name)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (value instanceof Collection<?>) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Collection<?> values = (Collection<?>) value;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (!CollectionUtils.isEmpty(values)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"List<MediaType> acceptableMediaTypes = new ArrayList<>();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"for (Object type : values) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (type instanceof MediaType) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"acceptableMediaTypes.add((MediaType) type);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (type instanceof String) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"acceptableMediaTypes.addAll(MediaType.parseMediaTypes((String) type));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Class<?> clazz = (type != null) ? type.getClass() : null;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"throw new IllegalArgumentException("
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"""Expected MediaType or String value for 'Accept' header value, but received: """
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"+ clazz);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setAccept(acceptableMediaTypes);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (value instanceof MediaType) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setAccept(Collections.singletonList((MediaType) value));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (value instanceof String[]) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"for (String next : (String[]) value) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"acceptableMediaTypes.add(MediaType.parseMediaType(next));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (value instanceof String) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setAccept(MediaType.parseMediaTypes((String) value));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Class<?> clazz = (value != null) ? value.getClass() : null;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"""Expected MediaType or String value for 'Accept' header value, but received: "" + clazz);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (ACCEPT_CHARSET.equalsIgnoreCase(name)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"List<Charset> acceptableCharsets = new ArrayList<>();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"for (Object charset : values) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (charset instanceof Charset) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"acceptableCharsets.add((Charset) charset);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (charset instanceof String) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"acceptableCharsets.add(Charset.forName((String) charset));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Class<?> clazz = (charset != null) ? charset.getClass() : null;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"""Expected Charset or String value for 'Accept-Charset' header value, but received: """
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setAcceptCharset(acceptableCharsets);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (value instanceof Charset[] || value instanceof String[]) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Object[] values = ObjectUtils.toObjectArray(value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (value instanceof Charset) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setAcceptCharset(Collections.singletonList((Charset) value));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"String[] charsets = StringUtils.commaDelimitedListToStringArray((String) value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"for (String charset : charsets) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"acceptableCharsets.add(Charset.forName(charset.trim()));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"""Expected Charset or String value for 'Accept-Charset' header value, but received: "" + clazz);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (ALLOW.equalsIgnoreCase(name)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Set<HttpMethod> allowedMethods = new HashSet<>();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"for (Object method : values) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (method instanceof HttpMethod) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"allowedMethods.add((HttpMethod) method);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (method instanceof String) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"allowedMethods.add(HttpMethod.valueOf((String) method));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Class<?> clazz = (method != null) ? method.getClass() : null;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"""Expected HttpMethod or String value for 'Allow' header value, but received: """
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setAllow(allowedMethods);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (value instanceof HttpMethod) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setAllow(Collections.singleton((HttpMethod) value));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (value instanceof HttpMethod[]) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Collections.addAll(allowedMethods, (HttpMethod[]) value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (value instanceof String || value instanceof String[]) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"String[] values = (value instanceof String[]) ? (String[]) value"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,": StringUtils.commaDelimitedListToStringArray((String) value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"for (String next : values) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"allowedMethods.add(HttpMethod.valueOf(next.trim()));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"""Expected HttpMethod or String value for 'Allow' header value, but received: "" + clazz);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (CACHE_CONTROL.equalsIgnoreCase(name)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (value instanceof String) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setCacheControl((String) value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"""Expected String value for 'Cache-Control' header value, but received: "" + clazz);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (CONTENT_LENGTH.equalsIgnoreCase(name)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (value instanceof Number) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setContentLength(((Number) value).longValue());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setContentLength(Long.parseLong((String) value));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"""Expected Number or String value for 'Content-Length' header value, but received: "" + clazz);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (MessageHeaders.CONTENT_TYPE.equalsIgnoreCase(name)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (value instanceof MediaType) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setContentType((MediaType) value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setContentType(MediaType.parseMediaType((String) value));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"""Expected MediaType or String value for 'Content-Type' header value, but received: "" + clazz);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (DATE.equalsIgnoreCase(name)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (value instanceof Date) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setDate(((Date) value).getTime());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (value instanceof Number) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setDate(((Number) value).longValue());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"try {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setDate(Long.parseLong((String) value));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"catch (@SuppressWarnings(UNUSED) NumberFormatException e) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setDate(getFirstDate((String) value, DATE));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"""Expected Date, Number, or String value for 'Date' header value, but received: "" + clazz);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (ETAG.equalsIgnoreCase(name)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setETag((String) value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"""Expected String value for 'ETag' header value, but received: "" + clazz);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (EXPIRES.equalsIgnoreCase(name)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setExpires(((Date) value).getTime());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setExpires(((Number) value).longValue());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setExpires(Long.parseLong((String) value));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setExpires(getFirstDate((String) value, EXPIRES));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"""Expected Date, Number, or String value for 'Expires' header value, but received: "" + clazz);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (IF_MODIFIED_SINCE.equalsIgnoreCase(name)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setIfModifiedSince(((Date) value).getTime());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setIfModifiedSince(((Number) value).longValue());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setIfModifiedSince(Long.parseLong((String) value));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setIfModifiedSince(getFirstDate((String) value, IF_MODIFIED_SINCE));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"""Expected Date, Number, or String value for 'If-Modified-Since' header value, but received: """
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (IF_UNMODIFIED_SINCE.equalsIgnoreCase(name)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"String ifUnmodifiedSinceValue;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"ifUnmodifiedSinceValue = formatDate(((Date) value).getTime());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"ifUnmodifiedSinceValue = formatDate(((Number) value).longValue());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"ifUnmodifiedSinceValue = formatDate(Long.parseLong((String) value));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"long longValue = getFirstDate((String) value, IF_UNMODIFIED_SINCE);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"ifUnmodifiedSinceValue = formatDate(longValue);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"""Expected Date, Number, or String value for 'If-Unmodified-Since' header value, but received: """
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.set(IF_UNMODIFIED_SINCE, ifUnmodifiedSinceValue);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (IF_NONE_MATCH.equalsIgnoreCase(name)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setIfNoneMatch((String) value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"String delmitedString = StringUtils.arrayToCommaDelimitedString((String[]) value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setIfNoneMatch(delmitedString);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (value instanceof Collection) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"List<String> ifNoneMatchList = new ArrayList<>();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"for (Object next : values) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (next instanceof String) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"ifNoneMatchList.add((String) next);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Class<?> clazz = (next != null) ? next.getClass() : null;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"""Expected String value for 'If-None-Match' header value, but received: "" + clazz);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setIfNoneMatch(ifNoneMatchList);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (LAST_MODIFIED.equalsIgnoreCase(name)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setLastModified(((Date) value).getTime());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setLastModified(((Number) value).longValue());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setLastModified(Long.parseLong((String) value));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setLastModified(getFirstDate((String) value, LAST_MODIFIED));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"""Expected Date, Number, or String value for 'Last-Modified' header value, but received: """
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (LOCATION.equalsIgnoreCase(name)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (value instanceof URI) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setLocation((URI) value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setLocation(new URI((String) value));"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"catch (URISyntaxException e) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"throw new IllegalArgumentException(e);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"""Expected URI or String value for 'Location' header value, but received: "" + clazz);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (PRAGMA.equalsIgnoreCase(name)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.setPragma((String) value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"""Expected String value for 'Pragma' header value, but received: "" + clazz);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.set(name, (String) value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.add(name, next);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (value instanceof Iterable<?>) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"for (Object next : (Iterable<?>) value) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"String convertedValue;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"convertedValue = (String) next;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"convertedValue = convertToString(value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"if (StringUtils.hasText(convertedValue)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.add(name, convertedValue);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"this.logger.warn(""Element of the header '"" + name + ""' with value '"" + value +"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"""' will not be set since it is not a String and no Converter is available. "" +"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"""Consider registering a Converter with ConversionService (e.g., <int:converter>)"");"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"String convertedValue = convertToString(value);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"target.set(name, convertedValue);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"this.logger.warn(""Header '"" + name + ""' with value '"" + value +"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"protected Object getHttpHeader(HttpHeaders source, String name) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return source.getAccept();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return source.getAcceptCharset();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return source.getAllow();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"String cacheControl = source.getCacheControl();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return (StringUtils.hasText(cacheControl)) ? cacheControl : null;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"long contentLength = source.getContentLength();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return (contentLength > -1) ? contentLength : null;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"else if (CONTENT_TYPE.equalsIgnoreCase(name)) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return source.getContentType();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"long date = source.getDate();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return (date > -1) ? date : null;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"String eTag = source.getETag();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return (StringUtils.hasText(eTag)) ? eTag : null;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"catch (Exception e) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"this.logger.debug(e.getMessage());"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"// According to RFC 2616"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return null;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return source.getIfNoneMatch();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"long modifiedSince = source.getIfModifiedSince();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return (modifiedSince > -1) ? modifiedSince : null;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"String unmodifiedSince = source.getFirst(IF_UNMODIFIED_SINCE);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return unmodifiedSince != null ? getFirstDate(unmodifiedSince, IF_UNMODIFIED_SINCE) : null;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"long lastModified = source.getLastModified();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return (lastModified > -1) ? lastModified : null;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return source.getLocation();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"String pragma = source.getPragma();"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return (StringUtils.hasText(pragma)) ? pragma : null;"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return source.get(name);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"protected long getFirstDate(String headerValue, String headerName) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"protected static String formatDate(long date) {"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"Instant instant = Instant.ofEpochMilli(date);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"ZonedDateTime zonedDateTime = ZonedDateTime.ofInstant(instant, GMT);"
"cff67ccdb4f091fbf9fb400e5a63a96eb1fcecf0","ed4f443c4bcd8f096c76f68745a8951156118ae2","deleted",1,"return DATE_FORMATTER.format(zonedDateTime);"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import org.springframework.integration.handler.DiscardingMessageHandler;"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import org.springframework.messaging.MessageChannel;"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import org.springframework.util.Assert;"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import reactor.core.publisher.Mono;"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"public abstract class AbstractMessageSplitter extends AbstractReplyProducingMessageHandler"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"implements DiscardingMessageHandler {"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"private MessageChannel discardChannel;"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"private String discardChannelName;"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"/**"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* Specify a channel where rejected Messages should be sent. If the discard"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* channel is null (the default), rejected Messages will be dropped."
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* A ""Rejected Message"" means that split function has returned an empty result (but not null):"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* no items to iterate for sending."
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* @param discardChannel The discard channel."
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* @since 5.2"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"*/"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"public void setDiscardChannel(MessageChannel discardChannel) {"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.discardChannel = discardChannel;"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"}"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* Specify a channel bean name (resolved to {@link MessageChannel} lazily)"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* where rejected Messages should be sent. If the discard"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"* @param discardChannelName The discard channel bean name."
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"public void setDiscardChannelName(String discardChannelName) {"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"Assert.hasText(discardChannelName, ""'discardChannelName' must not be empty"");"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.discardChannelName = discardChannelName;"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"@Override"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"public MessageChannel getDiscardChannel() {"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"if (this.discardChannel == null) {"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"String channelName = this.discardChannelName;"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"if (channelName != null) {"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.discardChannel = getChannelResolver().resolveDestination(channelName);"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.discardChannelName = null;"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"return this.discardChannel;"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"protected void doInit() {"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"Assert.state(!(this.discardChannelName != null && this.discardChannel != null),"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"""'discardChannelName' and 'discardChannel' are mutually exclusive."");"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"Object result = splitMessage(message);"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"MessageChannel discardingChannel = getDiscardChannel();"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"if (discardingChannel != null) {"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.messagingTemplate.send(discardingChannel, message);"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"return flux"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,".map(messageBuilderFunction)"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,".switchIfEmpty("
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"Mono.defer(() -> {"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"return Mono.empty();"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"}));"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"public abstract class AbstractMessageSplitter extends AbstractReplyProducingMessageHandler {"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"Object result = this.splitMessage(message);"
"818be4cbe80688639ebcac1c06e155d67d0e8829","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"return flux.map(messageBuilderFunction);"
"818be4cbe80688639ebcac1c06e155d67d0e8829","27604d3707fba623150cccf17ae1b621c3eaf8c9","added",0,"Assert.isTrue(hasChild ^ hasReference,"
"818be4cbe80688639ebcac1c06e155d67d0e8829","27604d3707fba623150cccf17ae1b621c3eaf8c9","added",0,"""Exactly one of 'xpath-expression' or 'xpath-expression-ref' is required."");"
"818be4cbe80688639ebcac1c06e155d67d0e8829","27604d3707fba623150cccf17ae1b621c3eaf8c9","added",0,"IntegrationNamespaceUtils.setReferenceIfAttributeDefined(builder, element, ""doc-builder-factory"","
"818be4cbe80688639ebcac1c06e155d67d0e8829","27604d3707fba623150cccf17ae1b621c3eaf8c9","added",0,"""documentBuilder"");"
"818be4cbe80688639ebcac1c06e155d67d0e8829","27604d3707fba623150cccf17ae1b621c3eaf8c9","added",0,"IntegrationNamespaceUtils.setValueIfAttributeDefined(builder, element, ""discard-channel"", ""discardChannelName"");"
"818be4cbe80688639ebcac1c06e155d67d0e8829","27604d3707fba623150cccf17ae1b621c3eaf8c9","deleted",1,"Assert.isTrue(hasChild ^ hasReference, ""Exactly one of 'xpath-expression' or 'xpath-expression-ref' is required."");"
"818be4cbe80688639ebcac1c06e155d67d0e8829","27604d3707fba623150cccf17ae1b621c3eaf8c9","deleted",1,"IntegrationNamespaceUtils.setReferenceIfAttributeDefined(builder, element, ""doc-builder-factory"", ""documentBuilder"");"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"import java.lang.reflect.AnnotatedElement;"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"import org.springframework.core.annotation.MergedAnnotation;"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"import org.springframework.core.annotation.MergedAnnotations;"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"import org.springframework.lang.Nullable;"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"return this.channels.computeIfAbsent(method,"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"method1 -> {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"String channelName = getAnnotationValue(method, this.channelAttributeName);"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"if (channelName == null) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"channelName = getAnnotationValue(method.getDeclaringClass(), this.channelAttributeName);"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"}"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"return StringUtils.hasText(channelName) ? channelName : null;"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"});"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"return this.payloadExpressions.computeIfAbsent(method,"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"Expression payloadExpression = null;"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"MergedAnnotation<Payload> payloadMergedAnnotation ="
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"MergedAnnotations.from(method, MergedAnnotations.SearchStrategy.EXHAUSTIVE)"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,".get(Payload.class);"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"if (payloadMergedAnnotation.isPresent()) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"String payloadExpressionString = payloadMergedAnnotation.getString(""expression"");"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"if (!StringUtils.hasText(payloadExpressionString)) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"payloadExpression = RETURN_VALUE_EXPRESSION;"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"else {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"payloadExpression = EXPRESSION_PARSER.parseExpression(payloadExpressionString);"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"Annotation[][] annotationArray = method.getParameterAnnotations();"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"for (int i = 0; i < annotationArray.length; i++) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"Annotation[] parameterAnnotations = annotationArray[i];"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"payloadMergedAnnotation = MergedAnnotations.from(parameterAnnotations).get(Payload.class);"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"Assert.state(payloadExpression == null,"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"""@Payload can be used at most once on a @Publisher method, "" +"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"""either at method-level or on a single parameter"");"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"Assert.state("""".equals(payloadMergedAnnotation.getString(""expression"")),"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"""@Payload on a parameter for a @Publisher method may not contain an 'expression'"");"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"payloadExpression ="
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"EXPRESSION_PARSER.parseExpression(""#"" + ARGUMENT_MAP_VARIABLE_NAME + ""["" + i + ""]"");"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"if (payloadExpression == null ||"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"RETURN_VALUE_EXPRESSION.getExpressionString()"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,".equals(payloadExpression.getExpressionString())) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"Assert.isTrue(!void.class.equals(method.getReturnType()),"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"""When defining @Publisher on a void-returning method, an explicit payload "" +"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"""expression that does not rely upon a #return value is required."");"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"return payloadExpression;"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"return this.headersExpressions.computeIfAbsent(method,"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"Map<String, Expression> headerExpressions = new HashMap<>();"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"String[] parameterNames = this.parameterNameDiscoverer.getParameterNames(method);"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"MergedAnnotation<Header> headerMergedAnnotation ="
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"MergedAnnotations.from(parameterAnnotations).get(Header.class);"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"if (headerMergedAnnotation.isPresent()) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"String name ="
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"headerMergedAnnotation"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,".getString(""name"");"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"if (!StringUtils.hasText(name)) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"if (parameterNames != null) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"name = parameterNames[i];"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"name = method.getName() + "".arg#"" + i;"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"headerExpressions.put(name,"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"EXPRESSION_PARSER.parseExpression('#' + ARGUMENT_MAP_VARIABLE_NAME + '[' + i + ']'));"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"return headerExpressions;"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"@Nullable"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"private String getAnnotationValue(AnnotatedElement element, String attributeName) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"MergedAnnotations mergedAnnotations ="
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"MergedAnnotations.from(element, MergedAnnotations.SearchStrategy.EXHAUSTIVE);"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"String value = null;"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"MergedAnnotation<? extends Annotation> mergedAnnotation = mergedAnnotations.get(annotationType);"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"if (mergedAnnotation.isPresent()) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"""The ["" + element + ""] contains more than one publisher annotation"");"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","added",0,"value = mergedAnnotation.getString(attributeName);"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"import java.util.stream.Collectors;"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"import org.springframework.core.annotation.AnnotatedElementUtils;"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"import org.springframework.core.annotation.AnnotationUtils;"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"return this.channels.computeIfAbsent(method, method1 -> {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"String channelName = getAnnotationValue(method, this.channelAttributeName, String.class);"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"if (channelName == null) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"channelName = getAnnotationValue(method.getDeclaringClass(), this.channelAttributeName, String.class);"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"}"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"return StringUtils.hasText(channelName) ? channelName : null;"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"});"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"return this.payloadExpressions.computeIfAbsent(method, method1 -> {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"Expression payloadExpression = null;"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"Annotation methodPayloadAnnotation = AnnotationUtils.findAnnotation(method, Payload.class);"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"if (methodPayloadAnnotation != null) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"String payloadExpressionString = getAnnotationValue(methodPayloadAnnotation, null, String.class);"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"if (!StringUtils.hasText(payloadExpressionString)) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"payloadExpression = RETURN_VALUE_EXPRESSION;"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"else {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"payloadExpression = EXPRESSION_PARSER.parseExpression(payloadExpressionString);"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"Annotation[][] annotationArray = method.getParameterAnnotations();"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"for (int i = 0; i < annotationArray.length; i++) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"Annotation[] parameterAnnotations = annotationArray[i];"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"for (Annotation currentAnnotation : parameterAnnotations) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"if (Payload.class.equals(currentAnnotation.annotationType())) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"Assert.state(payloadExpression == null,"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"""@Payload can be used at most once on a @Publisher method, "" +"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"""either at method-level or on a single parameter"");"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"Assert.state("""".equals(AnnotationUtils.getValue(AnnotationUtils.synthesizeAnnotation(currentAnnotation, null))),"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"""@Payload on a parameter for a @Publisher method may not contain an expression"");"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"payloadExpression ="
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"EXPRESSION_PARSER.parseExpression(""#"" + ARGUMENT_MAP_VARIABLE_NAME + ""["" + i + ""]"");"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"if (payloadExpression == null ||"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"RETURN_VALUE_EXPRESSION.getExpressionString().equals(payloadExpression.getExpressionString())) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"Assert.isTrue(!void.class.equals(method.getReturnType()),"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"""When defining @Publisher on a void-returning method, an explicit payload "" +"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"""expression that does not rely upon a #return value is required."");"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"return payloadExpression;"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"@Override"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"@Deprecated"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"public String getPayloadExpression(Method method) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"return getExpressionForPayload(method)"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,".getExpressionString();"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"return this.headersExpressions.computeIfAbsent(method, method1 -> {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"Map<String, Expression> headerExpressions = new HashMap<>();"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"String[] parameterNames = this.parameterNameDiscoverer.getParameterNames(method);"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"if (Header.class.equals(currentAnnotation.annotationType())) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"String name = getAnnotationValue(currentAnnotation, null, String.class);"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"if (!StringUtils.hasText(name)) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"name = parameterNames[i];"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"headerExpressions.put(name,"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"EXPRESSION_PARSER.parseExpression(""#"" + ARGUMENT_MAP_VARIABLE_NAME + ""["" + i + ""]""));"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"return headerExpressions;"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"public Map<String, String> getHeaderExpressions(Method method) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"return getExpressionsForHeaders(method)"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,".entrySet()"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,".stream()"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,".collect(Collectors.toMap(Map.Entry::getKey, e -> e.getValue().getExpressionString()));"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"private <T> T getAnnotationValue(Method method, String attributeName, Class<T> expectedType) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"T value = null;"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"Annotation annotation = AnnotatedElementUtils.findMergedAnnotation(method, annotationType);"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"if (annotation != null) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"""method ["" + method + ""] contains more than one publisher annotation"");"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"value = getAnnotationValue(annotation, attributeName, expectedType);"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"return value;"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"private <T> T getAnnotationValue(Class<?> clazz, String attributeName, Class<T> expectedType) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"for (Class<? extends Annotation> annotationType : this.annotationTypes) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"Annotation annotation = AnnotatedElementUtils.findMergedAnnotation(clazz, annotationType);"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"if (value != null) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"throw new IllegalStateException("
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"""class ["" + clazz + ""] contains more than one publisher annotation"");"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"@SuppressWarnings(""unchecked"")"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"private <T> T getAnnotationValue(Annotation annotation, String attributeName, Class<T> expectedType) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"Object valueAsObject = (attributeName == null) ?"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"AnnotationUtils.getValue(AnnotationUtils.synthesizeAnnotation(annotation, null)) :"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"AnnotationUtils.getValue(annotation, attributeName);"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"if (valueAsObject != null) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"if (expectedType.isAssignableFrom(valueAsObject.getClass())) {"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"value = (T) valueAsObject;"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"throw new IllegalArgumentException(""expected type ["" + expectedType.getName() +"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"""] for attribute '"" + attributeName + ""' on publisher annotation ["" +"
"9780a6c893251dc073f5ef7a8ff6bc5441f0f55f","929e14a32067752087a8c7ff1e0898a95502d0b2","deleted",1,"annotation.annotationType() + ""], but actual type was ["" + valueAsObject.getClass() + ""]"");"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"import static org.assertj.core.api.Assertions.assertThatExceptionOfType;"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"import org.springframework.messaging.MessagingException;"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"* @author Artem Bilan"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"*"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"CachingSessionFactory<String> cache = new CachingSessionFactory<>(factory);"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"CachingSessionFactory<Object> ccf = new CachingSessionFactory<>(factory);"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"RemoteFileTemplate<Object> template = new RemoteFileTemplate<>(ccf);"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"assertThatExceptionOfType(MessagingException.class)"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,".isThrownBy(() ->"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"template.get(new GenericMessage<>(""foo""),"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"stream -> {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"throw new RuntimeException(""bar"");"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"}))"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,".withCauseInstanceOf(RuntimeException.class)"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,".withMessageContaining(""bar"");"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"private static class TestSessionFactory implements SessionFactory<String> {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"private static class TestSession implements Session<String> {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"public boolean remove(String path) {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"public String[] list(String path) {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"public void read(String source, OutputStream outputStream) {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"public void write(InputStream inputStream, String destination) {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"public void append(InputStream inputStream, String destination) {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"public boolean mkdir(String directory) {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"public boolean rmdir(String directory) {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"public void rename(String pathFrom, String pathTo) {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"public boolean exists(String path) {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"public String[] listNames(String path) {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"public InputStream readRaw(String source) {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"public boolean finalizeRaw() {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"@Override"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"public String getHostPort() {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"return null;"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"}"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"import static org.assertj.core.api.Assertions.fail;"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"import java.io.IOException;"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"import org.springframework.integration.file.remote.InputStreamCallback;"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"CachingSessionFactory<String> cache = new CachingSessionFactory<String>(factory);"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"CachingSessionFactory<Object> ccf = new CachingSessionFactory<Object>(factory);"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"RemoteFileTemplate<Object> template = new RemoteFileTemplate<Object>(ccf);"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"try {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"template.get(new GenericMessage<String>(""foo""), (InputStreamCallback) stream -> {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"throw new RuntimeException(""bar"");"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"});"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"fail(""Expected exception"");"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"}"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"catch (Exception e) {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"assertThat(e.getCause()).isInstanceOf(RuntimeException.class);"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"assertThat(e.getCause().getMessage()).isEqualTo(""bar"");"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"private class TestSessionFactory implements SessionFactory<String> {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"private class TestSession implements Session<String> {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"public boolean remove(String path) throws IOException {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"public String[] list(String path) throws IOException {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"public void read(String source, OutputStream outputStream) throws IOException {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"public void write(InputStream inputStream, String destination) throws IOException {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"public void append(InputStream inputStream, String destination) throws IOException {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"public boolean mkdir(String directory) throws IOException {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"public boolean rmdir(String directory) throws IOException {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"public void rename(String pathFrom, String pathTo) throws IOException {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"public boolean exists(String path) throws IOException {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"public String[] listNames(String path) throws IOException {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"public InputStream readRaw(String source) throws IOException {"
"a756e6334dcb442c90f6c1bdbd754c20293ef55b","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"public boolean finalizeRaw() throws IOException {"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"private Executor sendingTaskExecutor = Executors.newFixedThreadPool(1);"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"this.mailReceiver.cancelPing();"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"}"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"@Override"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"public void destroy() {"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"super.destroy();"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"this.mailReceiver.destroy();"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"// If we're running with the default executor, shut it down."
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (isRunning()) {"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"try {"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"ImapIdleChannelAdapter.this.idleTask.run();"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"logger.debug(""Task completed successfully. Re-scheduling it again right away."");"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"catch (Exception e) { //run again after a delay"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (logger.isWarnEnabled()) {"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"logger.warn(""Failed to execute IDLE task. Will attempt to resubmit in """
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"+ ImapIdleChannelAdapter.this.reconnectDelay + "" milliseconds."", e);"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"ImapIdleChannelAdapter.this.receivingTaskTrigger.delayNextExecution();"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"publishException(e);"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"logger.debug(""waiting for mail"");"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"ImapIdleChannelAdapter.this.mailReceiver.waitForNewMessages();"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"Folder folder = ImapIdleChannelAdapter.this.mailReceiver.getFolder();"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (folder != null && folder.isOpen() && isRunning()) {"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"Object[] mailMessages = ImapIdleChannelAdapter.this.mailReceiver.receive();"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (logger.isDebugEnabled()) {"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"logger.debug(""received "" + mailMessages.length + "" mail messages"");"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"for (Object mailMessage : mailMessages) {"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"Runnable messageSendingTask = createMessageSendingTask(mailMessage);"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"ImapIdleChannelAdapter.this.sendingTaskExecutor.execute(messageSendingTask);"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"catch (MessagingException e) {"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"logger.warn(""error occurred in idle task"", e);"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (ImapIdleChannelAdapter.this.shouldReconnectAutomatically) {"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"throw new IllegalStateException(""Failure in 'idle' task. Will resubmit."", e);"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"else {"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"throw new org.springframework.messaging.MessagingException("
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"""Failure in 'idle' task. Will NOT resubmit."", e);"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"private Executor sendingTaskExecutor;"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (this.sendingTaskExecutor == null) {"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.sendingTaskExecutor = Executors.newFixedThreadPool(1);"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"}"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"try {"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.mailReceiver.destroy();"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"catch (Exception e) {"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"throw new IllegalStateException("
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"""Failure during the destruction of Mail receiver: "" + this.mailReceiver, e);"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"/*"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"* If we're running with the default executor, shut it down."
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"*/"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.sendingTaskExecutor = null;"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"ImapIdleChannelAdapter.this.idleTask.run();"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"logger.debug(""Task completed successfully. Re-scheduling it again right away."");"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"catch (Exception e) { //run again after a delay"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (logger.isWarnEnabled()) {"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"logger.warn(""Failed to execute IDLE task. Will attempt to resubmit in """
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"+ ImapIdleChannelAdapter.this.reconnectDelay + "" milliseconds."", e);"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"ImapIdleChannelAdapter.this.receivingTaskTrigger.delayNextExecution();"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"publishException(e);"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"final TaskScheduler scheduler = getTaskScheduler();"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Assert.notNull(scheduler, ""'taskScheduler' must not be null"");"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"* The following shouldn't be necessary because doStart() will have ensured we have"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"* one. But, just in case..."
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Assert.state(ImapIdleChannelAdapter.this.sendingTaskExecutor != null,"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"""'sendingTaskExecutor' must not be null"");"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"logger.debug(""waiting for mail"");"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"ImapIdleChannelAdapter.this.mailReceiver.waitForNewMessages();"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Folder folder = ImapIdleChannelAdapter.this.mailReceiver.getFolder();"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (folder != null && folder.isOpen()) {"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Object[] mailMessages = ImapIdleChannelAdapter.this.mailReceiver.receive();"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (logger.isDebugEnabled()) {"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"logger.debug(""received "" + mailMessages.length + "" mail messages"");"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"for (Object mailMessage : mailMessages) {"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Runnable messageSendingTask = createMessageSendingTask(mailMessage);"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"ImapIdleChannelAdapter.this.sendingTaskExecutor.execute(messageSendingTask);"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"catch (MessagingException e) {"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"logger.warn(""error occurred in idle task"", e);"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (ImapIdleChannelAdapter.this.shouldReconnectAutomatically) {"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"throw new IllegalStateException(""Failure in 'idle' task. Will resubmit."", e);"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"else {"
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"throw new org.springframework.messaging.MessagingException("
"6d0757a08a75828eea408e68a9284cebb6e602fd","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"""Failure in 'idle' task. Will NOT resubmit."", e);"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"import org.springframework.integration.config.ExpressionFactoryBean;"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"final Map<String, Object> gatewayAttributes = new HashMap<>();"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"private void headers(Element element, Map<String, Object> gatewayAttributes) {"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"List<Map<String, Object>> headers = new ArrayList<>(headerElements.size());"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"Map<String, Object> header = new HashMap<>();"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"gatewayAttributes.put(""defaultHeaders"", headers.toArray(new Map<?, ?>[0]));"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"Map<String, BeanDefinition> methodMetadataMap = new ManagedMap<>();"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"String payloadExpression = methodElement.getAttribute(""payload-expression"");"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"Assert.state(!hasMapper || !StringUtils.hasText(payloadExpression),"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"if (StringUtils.hasText(payloadExpression)) {"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"methodMetadataBuilder.addPropertyValue(""payloadExpression"","
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"BeanDefinitionBuilder.genericBeanDefinition(ExpressionFactoryBean.class)"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,".addConstructorArgValue(payloadExpression)"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,".getBeanDefinition());"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"}"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"Map<String, Object> headerExpressions = new ManagedMap<>();"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"final Map<String, Object> gatewayAttributes = new HashMap<String, Object>();"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"@SuppressWarnings(""rawtypes"")"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"private void headers(final Element element, final Map<String, Object> gatewayAttributes) {"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"List<Map<String, Object>> headers = new ArrayList<Map<String, Object>>(headerElements.size());"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"Map<String, Object> header = new HashMap<String, Object>();"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"gatewayAttributes.put(""defaultHeaders"", headers.toArray(new Map[0]));"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"Map<String, BeanDefinition> methodMetadataMap = new ManagedMap<String, BeanDefinition>();"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"Assert.state(!hasMapper || !StringUtils.hasText(element.getAttribute(""payload-expression"")),"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"IntegrationNamespaceUtils.setValueIfAttributeDefined(methodMetadataBuilder, methodElement,"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"""payload-expression"");"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"Map<String, Object> headerExpressions = new ManagedMap<String, Object>();"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"import org.springframework.lang.Nullable;"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"* @author Artem Bilan"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"*"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"private final Map<String, Expression> headerExpressions = new HashMap<>();"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"private Expression payloadExpression;"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"private String requestChannelName;"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"private String replyChannelName;"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"private String requestTimeout;"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"private String replyTimeout;"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"@Nullable"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"public Expression getPayloadExpression() {"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"public void setPayloadExpression(Expression payloadExpression) {"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"public void setHeaderExpressions(@Nullable Map<String, Expression> headerExpressions) {"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"this.headerExpressions.clear();"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"if (headerExpressions != null) {"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"this.headerExpressions.putAll(headerExpressions);"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"}"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"private volatile String payloadExpression;"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"private volatile String requestChannelName;"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"private volatile String replyChannelName;"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"private volatile String requestTimeout;"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"private volatile String replyTimeout;"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"private volatile Map<String, Expression> headerExpressions = new HashMap<String, Expression>();"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"public String getPayloadExpression() {"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"public void setPayloadExpression(String payloadExpression) {"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"public void setHeaderExpressions(Map<String, Expression> headerExpressions) {"
"29bebdba97fdf069e371a79d627de538831f9b42","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"this.headerExpressions = headerExpressions;"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"import static org.assertj.core.api.Assertions.assertThatExceptionOfType;"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"import static org.assertj.core.api.Assertions.assertThatIllegalArgumentException;"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"import java.util.UUID;"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"import org.junit.jupiter.api.BeforeEach;"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"import org.junit.jupiter.api.Disabled;"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"import org.junit.jupiter.api.Test;"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"import org.junit.jupiter.api.io.TempDir;"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"import org.springframework.context.support.GenericApplicationContext;"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"static final String SAMPLE_CONTENT = ""HelloWorld\näöüß"";"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"@TempDir"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"File tempDir;"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"@BeforeEach"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"void setup() throws IOException {"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"outputDirectory = new File(tempDir, ""outputDirectory"");"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"sourceFile = new File(tempDir, ""sourceFile"");"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"FileCopyUtils.copy(SAMPLE_CONTENT.getBytes(DEFAULT_ENCODING),"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"new FileOutputStream(sourceFile, false));"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"this.handler = new FileWritingMessageHandler(this.outputDirectory);"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"this.handler.setBeanFactory(mock(BeanFactory.class));"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"this.handler.setApplicationContext(new GenericApplicationContext());"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"this.handler.afterPropertiesSet();"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"}"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"@Test"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"assertThatExceptionOfType(MessageHandlingException.class)"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,".isThrownBy(() -> this.handler.handleMessage(new GenericMessage<>(99)));"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"handler.handleMessage(new GenericMessage<>(""test""));"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"@Disabled(""INT-3289: doesn't fail on all OS"")"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"assertThatIllegalArgumentException()"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,".isThrownBy(handler::afterPropertiesSet)"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,".withMessageContaining(""[/foo] could not be created"");"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"public void deleteSourceFileWithInputStreamPayloadAndFileInstanceHeader() throws Exception {"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"public void deleteSourceFileWithInputStreamPayloadAndFilePathHeader() throws Exception {"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"public void customFileNameGenerator() {"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"File outFile = new File(tempDir, ""/outputDirectory/"" + message.getHeaders().getId().toString() + "".msg"");"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"File outFile ="
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"new File(tempDir, ""/outputDirectory/"" + message.getHeaders().getId().toString() + "".msg.writing"");"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"File tempFolder = new File(tempDir, UUID.randomUUID().toString());"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"handler.handleMessage(new GenericMessage<>(""foo""));"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"handler.handleMessage(new GenericMessage<>(""bar""));"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"handler.handleMessage(new GenericMessage<>(""baz""));"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"handler.handleMessage(new GenericMessage<>(""qux"".getBytes())); // change of payload type forces flush"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"handler.trigger(new GenericMessage<>(Matcher.quoteReplacement(file.getAbsolutePath())));"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"handler.trigger(new GenericMessage<>(""foo""));"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"File file = new File(this.tempDir, ""foo.txt"");"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","added",0,"return (File) result.getPayload();"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"import org.junit.Ignore;"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"import org.junit.Rule;"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"import org.junit.Test;"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"import org.junit.rules.TemporaryFolder;"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"static final String SAMPLE_CONTENT = ""HelloWorld\n????"";"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"@Rule"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"public TemporaryFolder temp = new TemporaryFolder() {"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"@Override"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"public void create() throws IOException {"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"super.create();"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"outputDirectory = temp.newFolder(""outputDirectory"");"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"handler = new FileWritingMessageHandler(outputDirectory);"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"handler.setBeanFactory(mock(BeanFactory.class));"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"handler.afterPropertiesSet();"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"sourceFile = temp.newFile(""sourceFile"");"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"FileCopyUtils.copy(SAMPLE_CONTENT.getBytes(DEFAULT_ENCODING),"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"new FileOutputStream(sourceFile, false));"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"}"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"};"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"@Test(expected = MessageHandlingException.class)"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"this.handler.handleMessage(new GenericMessage<>(99));"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"assertThat(this.outputDirectory.listFiles()[0]).isNull();"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"handler.handleMessage(new GenericMessage<String>(""test""));"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"@Ignore(""INT-3289: doesn't fail on all OS"")"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"try {"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"fail(""Expected exception"");"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"catch (IllegalArgumentException e) {"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"assertThat(e.getMessage()).contains(""[/foo] could not be created"");"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"public void deleteSourceFileWithInputstreamPayloadAndFileInstanceHeader() throws Exception {"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"public void deleteSourceFileWithInputstreamPayloadAndFilePathHeader() throws Exception {"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"public void customFileNameGenerator() throws Exception {"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"File outFile = temp.newFile(""/outputDirectory/"" + message.getHeaders().getId().toString() + "".msg"");"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"File outFile = temp.newFile(""/outputDirectory/"" + message.getHeaders().getId().toString() + "".msg.writing"");"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"File tempFolder = this.temp.newFolder();"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"handler.handleMessage(new GenericMessage<String>(""foo""));"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"handler.handleMessage(new GenericMessage<String>(""bar""));"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"handler.handleMessage(new GenericMessage<String>(""baz""));"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"handler.handleMessage(new GenericMessage<byte[]>(""qux"".getBytes())); // change of payload type forces flush"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"handler.trigger(new GenericMessage<String>(Matcher.quoteReplacement(file.getAbsolutePath())));"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"handler.trigger(new GenericMessage<String>(""foo""));"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"File file = new File(this.temp.newFolder(), ""foo.txt"");"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"File destFile = (File) result.getPayload();"
"0f5bd4a40aabcd7c485207a58bcc51e5fd936c66","5fe7ee6b6cc94d1f14c56303acd8693f448b88e1","deleted",1,"return destFile;"
"d13752b40bb9ef9e1aeeb2b3f026950eb1088ccb","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import org.springframework.integration.handler.ReactiveMessageHandlerAdapter;"
"d13752b40bb9ef9e1aeeb2b3f026950eb1088ccb","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"import org.springframework.messaging.ReactiveMessageHandler;"
"d13752b40bb9ef9e1aeeb2b3f026950eb1088ccb","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"public void setHandler(Object handler) {"
"d13752b40bb9ef9e1aeeb2b3f026950eb1088ccb","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"Assert.isTrue(handler instanceof MessageHandler || handler instanceof ReactiveMessageHandler,"
"d13752b40bb9ef9e1aeeb2b3f026950eb1088ccb","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"""'handler' must be an instance of 'MessageHandler' or 'ReactiveMessageHandler'"");"
"d13752b40bb9ef9e1aeeb2b3f026950eb1088ccb","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"if (handler instanceof ReactiveMessageHandler) {"
"d13752b40bb9ef9e1aeeb2b3f026950eb1088ccb","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.handler = new ReactiveMessageHandlerAdapter((ReactiveMessageHandler) handler);"
"d13752b40bb9ef9e1aeeb2b3f026950eb1088ccb","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"}"
"d13752b40bb9ef9e1aeeb2b3f026950eb1088ccb","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"else {"
"d13752b40bb9ef9e1aeeb2b3f026950eb1088ccb","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.handler = (MessageHandler) handler;"
"d13752b40bb9ef9e1aeeb2b3f026950eb1088ccb","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"if (!(this.handler instanceof ReactiveMessageHandlerAdapter)) {"
"d13752b40bb9ef9e1aeeb2b3f026950eb1088ccb","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"adviceChain();"
"d13752b40bb9ef9e1aeeb2b3f026950eb1088ccb","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"else if (!CollectionUtils.isEmpty(this.adviceChain)) {"
"d13752b40bb9ef9e1aeeb2b3f026950eb1088ccb","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"LOGGER.warn(""the advice chain cannot be applied to a 'ReactiveMessageHandler'"");"
"d13752b40bb9ef9e1aeeb2b3f026950eb1088ccb","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"if (this.handler instanceof ReactiveMessageHandlerAdapter) {"
"d13752b40bb9ef9e1aeeb2b3f026950eb1088ccb","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.endpoint = new ReactiveStreamsConsumer(channel,"
"d13752b40bb9ef9e1aeeb2b3f026950eb1088ccb","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"((ReactiveMessageHandlerAdapter) this.handler).getDelegate());"
"d13752b40bb9ef9e1aeeb2b3f026950eb1088ccb","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","added",0,"this.endpoint = new ReactiveStreamsConsumer(channel, this.handler);"
"d13752b40bb9ef9e1aeeb2b3f026950eb1088ccb","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"public void setHandler(MessageHandler handler) {"
"d13752b40bb9ef9e1aeeb2b3f026950eb1088ccb","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"Assert.notNull(handler, ""handler must not be null"");"
"d13752b40bb9ef9e1aeeb2b3f026950eb1088ccb","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"this.handler = handler;"
"d13752b40bb9ef9e1aeeb2b3f026950eb1088ccb","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"adviceChain();"
"d13752b40bb9ef9e1aeeb2b3f026950eb1088ccb","39a8486ac82362582c48bfd36e4ea5e36aac1ab9","deleted",1,"this.endpoint = new ReactiveStreamsConsumer(channel, this.handler);"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"* Copyright 2002-2020 the original author or authors."
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"BeanDefinitionBuilder builder = BeanDefinitionBuilder.genericBeanDefinition(getGatewayClassName(element));"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"ManagedMap<String, Object> uriVariableExpressions = new ManagedMap<>();"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"IntegrationNamespaceUtils.setValueIfAttributeDefined(builder, element, ""encoding-mode"");"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"postProcessGateway(builder, element, parserContext);"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"IntegrationNamespaceUtils.configureHeaderMapper(element, builder, parserContext,"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"DefaultSoapHeaderMapper.class, null);"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","deleted",1,"* Copyright 2002-2019 the original author or authors."
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","deleted",1,"BeanDefinitionBuilder builder = BeanDefinitionBuilder.genericBeanDefinition(this.getGatewayClassName(element));"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","deleted",1,"ManagedMap<String, Object> uriVariableExpressions = new ManagedMap<String, Object>();"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","deleted",1,"this.postProcessGateway(builder, element, parserContext);"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","deleted",1,"IntegrationNamespaceUtils.configureHeaderMapper(element, builder, parserContext, DefaultSoapHeaderMapper.class, null);"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"* Copyright 2002-2020 the original author or authors."
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"import static org.assertj.core.api.Assertions.assertThatExceptionOfType;"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"import org.junit.jupiter.api.Test;"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"import org.springframework.test.context.junit.jupiter.SpringJUnitConfig;"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"import org.springframework.web.util.DefaultUriBuilderFactory;"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"@SpringJUnitConfig"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"AbstractEndpoint endpoint = context.getBean(""gatewayWithCustomSourceExtractorAndMessageFactory"","
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"AbstractEndpoint.class);"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"AbstractEndpoint endpoint = this.context.getBean(""gatewayWithCustomFaultMessageResolver"","
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"handler.handleMessage(new GenericMessage<>(""foo""));"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"channel.send(new GenericMessage<>(""foo""));"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"assertThat("
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"TestUtils.getPropertyValue(handler, ""uriFactory.encodingMode"","
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"DefaultUriBuilderFactory.EncodingMode.class))"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,".isEqualTo(DefaultUriBuilderFactory.EncodingMode.NONE);"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"@Test"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"assertThatExceptionOfType(BeanDefinitionParsingException.class)"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,".isThrownBy(() ->"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"new ClassPathXmlApplicationContext(""invalidGatewayWithBothUriAndDestinationProvider.xml"","
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"getClass()));"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","added",0,"new ClassPathXmlApplicationContext(""invalidGatewayWithNeitherUriNorDestinationProvider.xml"","
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","deleted",1,"* Copyright 2002-2019 the original author or authors."
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","deleted",1,"import org.junit.Test;"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","deleted",1,"import org.junit.runner.RunWith;"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","deleted",1,"import org.springframework.test.context.junit4.SpringRunner;"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","deleted",1,"@RunWith(SpringRunner.class)"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","deleted",1,"AbstractEndpoint endpoint = context.getBean(""gatewayWithCustomSourceExtractorAndMessageFactory"", AbstractEndpoint.class);"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","deleted",1,"AbstractEndpoint endpoint = this.context.getBean(""gatewayWithCustomFaultMessageResolver"", AbstractEndpoint.class);"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","deleted",1,"handler.handleMessage(new GenericMessage<String>(""foo""));"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","deleted",1,"channel.send(new GenericMessage<String>(""foo""));"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","deleted",1,"@SuppressWarnings(""unchecked"")"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","deleted",1,"assertThat(TestUtils.getPropertyValue(handler, ""encodeUri"", Boolean.class)).isFalse();"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","deleted",1,"@Test(expected = BeanDefinitionParsingException.class)"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","deleted",1,"new ClassPathXmlApplicationContext(""invalidGatewayWithBothUriAndDestinationProvider.xml"", this.getClass())"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","deleted",1,".close();"
"50ac603d6c14563c1c46330be5915d32c8570fa5","9f5cdfa27d8e1bb41539992febd22aaf0bcda231","deleted",1,"new ClassPathXmlApplicationContext(""invalidGatewayWithNeitherUriNorDestinationProvider.xml"", this.getClass())"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"* Copyright 2013-2020 the original author or authors."
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"import java.nio.charset.Charset;"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"import java.nio.charset.StandardCharsets;"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"import org.springframework.core.io.Resource;"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"* The {@link SessionFactory} for acquiring remote file Sessions."
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"private String temporaryFileSuffix = "".writing"";"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"private boolean autoCreateDirectory = false;"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"private boolean useTemporaryFileName = true;"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"private ExpressionEvaluatingMessageProcessor<String> directoryExpressionProcessor;"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"private ExpressionEvaluatingMessageProcessor<String> temporaryDirectoryExpressionProcessor;"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"private ExpressionEvaluatingMessageProcessor<String> fileNameProcessor;"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"private FileNameGenerator fileNameGenerator = new DefaultFileNameGenerator();"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"private boolean fileNameGeneratorSet;"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"private Charset charset = StandardCharsets.UTF_8;"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"private String remoteFileSeparator = ""/"";"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"private boolean hasExplicitlySetSuffix;"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"private BeanFactory beanFactory;"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"this.charset = Charset.forName(charset);"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"public String append(Message<?> message) {"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"public String append(Message<?> message, String subDirectory) {"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"public String send(Message<?> message, String subDirectory, FileExistsMode... mode) {"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"private String send(Message<?> message, String subDirectory, FileExistsMode mode) {"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"public boolean exists(String path) {"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"public boolean remove(String path) {"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"public void rename(String fromPath, String toPath) {"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"public boolean get(String remotePath, InputStreamCallback callback) {"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"if (e instanceof MessagingException) { // NOSONAR"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"byte[] bytes;"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"else if (payload instanceof Resource) {"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"Resource resource = (Resource) payload;"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"dataInputStream = resource.getInputStream();"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"String filename = resource.getFilename();"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"name = filename != null ? filename : ""Resource payload"";"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","added",0,"}"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"* Copyright 2013-2019 the original author or authors."
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"* the {@link SessionFactory} for acquiring remote file Sessions."
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"private volatile String temporaryFileSuffix = "".writing"";"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"private volatile boolean autoCreateDirectory = false;"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"private volatile boolean useTemporaryFileName = true;"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"private volatile ExpressionEvaluatingMessageProcessor<String> directoryExpressionProcessor;"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"private volatile ExpressionEvaluatingMessageProcessor<String> temporaryDirectoryExpressionProcessor;"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"private volatile ExpressionEvaluatingMessageProcessor<String> fileNameProcessor;"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"private volatile FileNameGenerator fileNameGenerator = new DefaultFileNameGenerator();"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"private volatile boolean fileNameGeneratorSet;"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"private volatile String charset = ""UTF-8"";"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"private volatile String remoteFileSeparator = ""/"";"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"private volatile boolean hasExplicitlySetSuffix;"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"private volatile BeanFactory beanFactory;"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"this.charset = charset;"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"public String append(final Message<?> message) {"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"public String append(final Message<?> message, String subDirectory) {"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"public String send(final Message<?> message, String subDirectory, FileExistsMode... mode) {"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"private String send(final Message<?> message, final String subDirectory, final FileExistsMode mode) {"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"public boolean exists(final String path) {"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"public boolean remove(final String path) {"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"public void rename(final String fromPath, final String toPath) {"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"public boolean get(final String remotePath, final InputStreamCallback callback) {"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"@SuppressWarnings(""rawtypes"")"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"if (e instanceof MessagingException) {"
"6d5690fd58a0dff89ba0349e2324bd98f82d8a39","1d002bfc4784117f55b14ec5095f2a5c9426e910","deleted",1,"byte[] bytes = null;"
"2d9a5f60f48330e03e5a24ddc887560d6d02b514","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"private PollableChannel inputChannel;"
"2d9a5f60f48330e03e5a24ddc887560d6d02b514","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"private long receiveTimeout = DEFAULT_RECEIVE_TIMEOUT;"
"2d9a5f60f48330e03e5a24ddc887560d6d02b514","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"@Override"
"2d9a5f60f48330e03e5a24ddc887560d6d02b514","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"protected Object getReceiveMessageSource() {"
"2d9a5f60f48330e03e5a24ddc887560d6d02b514","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"return this.inputChannel;"
"2d9a5f60f48330e03e5a24ddc887560d6d02b514","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"}"
"2d9a5f60f48330e03e5a24ddc887560d6d02b514","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"protected void setReceiveMessageSource(Object source) {"
"2d9a5f60f48330e03e5a24ddc887560d6d02b514","180d57c418bd65ea17a9d021208d45cfe067eaee","added",0,"this.inputChannel = (PollableChannel) source;"
"2d9a5f60f48330e03e5a24ddc887560d6d02b514","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"private final PollableChannel inputChannel;"
"2d9a5f60f48330e03e5a24ddc887560d6d02b514","180d57c418bd65ea17a9d021208d45cfe067eaee","deleted",1,"private volatile long receiveTimeout = DEFAULT_RECEIVE_TIMEOUT;"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","55eb3ae05da3a71139f2b9883ebff7b23babbf7b","added",0,"* Copyright 2002-2020 the original author or authors."
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","55eb3ae05da3a71139f2b9883ebff7b23babbf7b","added",0,"import static org.assertj.core.api.Assertions.assertThatIllegalArgumentException;"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","55eb3ae05da3a71139f2b9883ebff7b23babbf7b","added",0,"import org.junit.jupiter.api.Test;"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","55eb3ae05da3a71139f2b9883ebff7b23babbf7b","added",0,"* @author Artem Bilan"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","55eb3ae05da3a71139f2b9883ebff7b23babbf7b","added",0,"public void testIdOverwritten() {"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","55eb3ae05da3a71139f2b9883ebff7b23babbf7b","added",0,"int value = 123;"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","55eb3ae05da3a71139f2b9883ebff7b23babbf7b","added",0,"Map<String, Object> map = new HashMap<>();"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","55eb3ae05da3a71139f2b9883ebff7b23babbf7b","added",0,"@Test"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","55eb3ae05da3a71139f2b9883ebff7b23babbf7b","added",0,"assertThatIllegalArgumentException()"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","55eb3ae05da3a71139f2b9883ebff7b23babbf7b","added",0,".isThrownBy(() -> headers.get(""test"", String.class))"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","55eb3ae05da3a71139f2b9883ebff7b23babbf7b","added",0,".withMessageContaining("
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","55eb3ae05da3a71139f2b9883ebff7b23babbf7b","added",0,"""Expected [class java.lang.String] but actual type is [class java.lang.Integer]"");"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","55eb3ae05da3a71139f2b9883ebff7b23babbf7b","added",0,"map.put(""key2"", 123);"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","55eb3ae05da3a71139f2b9883ebff7b23babbf7b","deleted",1,"* Copyright 2002-2019 the original author or authors."
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","55eb3ae05da3a71139f2b9883ebff7b23babbf7b","deleted",1,"import org.junit.Test;"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","55eb3ae05da3a71139f2b9883ebff7b23babbf7b","deleted",1,"public void testIdOverwritten() throws Exception {"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","55eb3ae05da3a71139f2b9883ebff7b23babbf7b","deleted",1,"Integer value = new Integer(123);"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","55eb3ae05da3a71139f2b9883ebff7b23babbf7b","deleted",1,"Map<String, Object> map = new HashMap<String, Object>();"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","55eb3ae05da3a71139f2b9883ebff7b23babbf7b","deleted",1,"@Test(expected = IllegalArgumentException.class)"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","55eb3ae05da3a71139f2b9883ebff7b23babbf7b","deleted",1,"assertThat(headers.get(""test"", String.class)).isEqualTo(value);"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","55eb3ae05da3a71139f2b9883ebff7b23babbf7b","deleted",1,"map.put(""key2"", new Integer(123));"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* Copyright 2002-2020 the original author or authors."
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"import java.net.NetworkInterface;"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"import org.junit.jupiter.api.condition.EnabledOnJre;"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"import org.junit.jupiter.api.condition.JRE;"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"@EnabledOnJre(JRE.JAVA_8)"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"NetworkInterface nic = this.multicastRule.getNic();"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"if (nic != null) {"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"adapter.setLocalAddress(nic.getName());"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"}"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"DatagramSocket datagramSocket = new DatagramSocket(0, nic.getInetAddresses().nextElement());"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"public void testMulticastSender() {"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"handler.setLocalAddress(nic.getName());"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"* Copyright 2002-2019 the original author or authors."
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"import java.net.Inet4Address;"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"String nic = this.multicastRule.getNic();"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"adapter.setLocalAddress(nic);"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"DatagramSocket datagramSocket = new DatagramSocket(0, Inet4Address.getByName(nic));"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"public void testMulticastSender() throws Exception {"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"handler.setLocalAddress(nic);"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"import org.springframework.lang.Nullable;"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"try (Socket socket = new Socket(InetAddress.getByName(""localhost""), port)) {"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* @param port the port for socket"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"@Nullable"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"public static NetworkInterface chooseANic(boolean multicast) throws Exception {"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"NetworkInterface networkInterface = interfaces.nextElement();"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"if (!networkInterface.isLoopback()"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"&& (!multicast || networkInterface.supportsMulticast())"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"&& !networkInterface.getName().contains(""vboxnet"")"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"&& networkInterface.getInetAddresses().hasMoreElements()) {"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return networkInterface;"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"public static void waitListening(AbstractInternetProtocolReceivingChannelAdapter adapter) {"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"await(""Adapter not listening"").atMost(Duration.ofSeconds(10)).until(adapter::isListening);"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"import java.net.Inet4Address;"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"Socket socket = null;"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"try {"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"socket = new Socket(InetAddress.getByName(""localhost""), port);"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"finally {"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"if (socket != null) {"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"socket.close();"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"}"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"catch (IOException e2) {"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"Socket socket = new Socket(InetAddress.getByName(""localhost""), port);"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"* @param port"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"public static String chooseANic(boolean multicast) throws Exception {"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"NetworkInterface intface = interfaces.nextElement();"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"if (intface.isLoopback() || (multicast && !intface.supportsMulticast())"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"|| intface.getName().contains(""vboxnet"")) {"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"continue;"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"for (Enumeration<InetAddress> inetAddr = intface.getInetAddresses(); inetAddr.hasMoreElements(); ) {"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"InetAddress nextElement = inetAddr.nextElement();"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"if (nextElement instanceof Inet4Address) {"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return nextElement.getHostAddress();"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"public static void waitListening(AbstractInternetProtocolReceivingChannelAdapter adapter) throws Exception {"
"3f5aba2cb9ee326795491e8e444dc90cac71a3dc","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"await(""Adapter not listening"").atMost(Duration.ofSeconds(10)).until(() -> adapter.isListening());"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"import org.springframework.amqp.core.ReturnedMessage;"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"/**"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"* Build Spring message object based on the provided returned AMQP message info."
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"* @param message the returned AMQP message"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"* @param replyCode the returned message reason code"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"* @param replyText the returned message reason text"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"* @param exchange the exchange the message returned from"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"* @param returnedRoutingKey the routing key for returned message"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"* @param converter the converter to deserialize body of the returned AMQP message"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"* @return the Spring message which represents a returned AMQP message"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"* @deprecated since 5.4 in favor of {@link #buildReturnedMessage(ReturnedMessage, MessageConverter)}"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"*/"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"@Deprecated"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"return buildReturnedMessage(new ReturnedMessage(message, replyCode, replyText, exchange, returnedRoutingKey),"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"converter);"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"}"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"protected Message<?> buildReturnedMessage(ReturnedMessage returnedMessage, MessageConverter converter) {"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"org.springframework.amqp.core.Message amqpMessage = returnedMessage.getMessage();"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"Object returnedObject = converter.fromMessage(amqpMessage);"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"Map<String, ?> headers = getHeaderMapper().toHeadersFromReply(amqpMessage.getMessageProperties());"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,".setHeader(AmqpHeaders.RETURN_REPLY_CODE, returnedMessage.getReplyCode())"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,".setHeader(AmqpHeaders.RETURN_REPLY_TEXT, returnedMessage.getReplyText())"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,".setHeader(AmqpHeaders.RETURN_EXCHANGE, returnedMessage.getExchange())"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,".setHeader(AmqpHeaders.RETURN_ROUTING_KEY, returnedMessage.getRoutingKey());"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"Message<?> message = builder.build();"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"message = this.errorMessageStrategy.buildErrorMessage(new ReturnedAmqpMessageException("
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"message, amqpMessage, returnedMessage.getReplyCode(), returnedMessage.getReplyText(),"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"returnedMessage.getExchange(), returnedMessage.getRoutingKey()), null);"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","added",0,"return message;"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"Object returnedObject = converter.fromMessage(message);"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"Map<String, ?> headers = getHeaderMapper().toHeadersFromReply(message.getMessageProperties());"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,".setHeader(AmqpHeaders.RETURN_REPLY_CODE, replyCode)"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,".setHeader(AmqpHeaders.RETURN_REPLY_TEXT, replyText)"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,".setHeader(AmqpHeaders.RETURN_EXCHANGE, exchange)"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,".setHeader(AmqpHeaders.RETURN_ROUTING_KEY, returnedRoutingKey);"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"Message<?> returnedMessage = builder.build();"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"returnedMessage = this.errorMessageStrategy.buildErrorMessage(new ReturnedAmqpMessageException("
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"returnedMessage, message, replyCode, replyText, exchange, returnedRoutingKey), null);"
"ea546c52d0c248a7ee3b5ce1102117101da2681b","0a1306cd1b11bfbdbd35768815595885b0e1e6ff","deleted",1,"return returnedMessage;"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* Copyright 2002-2020 the original author or authors."
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* @author Artem Bilan"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"*"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* Protected by lifecycleLock"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"@Override"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"protected void doStart() {"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"String beanName = getComponentName();"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"checkTaskExecutor((beanName == null ? """" : beanName + ""-"") + getComponentType());"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.taskExecutor.execute(this);"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"}"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"/**"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* Creates a default task executor if none was supplied."
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"* @param threadName The thread name."
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"*/"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"protected void checkTaskExecutor(final String threadName) {"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"if (isActive() && this.taskExecutor == null) {"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.taskExecutor ="
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"Executors.newFixedThreadPool(this.poolSize,"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"(runner) -> {"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"Thread thread = new Thread(runner);"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"thread.setName(threadName);"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"thread.setDaemon(true);"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"return thread;"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"});"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"protected void doStop() {"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"if (!this.taskExecutorSet && this.taskExecutor != null) {"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"((ExecutorService) this.taskExecutor).shutdown();"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","added",0,"this.taskExecutor = null;"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"* Copyright 2002-2019 the original author or authors."
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"import java.util.concurrent.ThreadFactory;"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"private volatile boolean active;"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"/**"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"* Protected by lifecycleLock"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"*/"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"@Override"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"protected void doStart() {"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"if (!this.active) {"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"this.active = true;"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"String beanName = this.getComponentName();"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"checkTaskExecutor((beanName == null ? """" : beanName + ""-"") + this.getComponentType());"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"this.taskExecutor.execute(this);"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"}"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"* Creates a default task executor if none was supplied."
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"*"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"* @param threadName The thread name."
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"protected void checkTaskExecutor(final String threadName) {"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"if (this.active && this.taskExecutor == null) {"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"Executor executor = Executors.newFixedThreadPool(this.poolSize, new ThreadFactory() {"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"public Thread newThread(Runnable runner) {"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"Thread thread = new Thread(runner);"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"thread.setName(threadName);"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"thread.setDaemon(true);"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return thread;"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"});"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"this.taskExecutor = executor;"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"protected void doStop() {"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"this.active = false;"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"if (!this.taskExecutorSet && this.taskExecutor != null) {"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"((ExecutorService) this.taskExecutor).shutdown();"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"this.taskExecutor = null;"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"* @return the active"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"public boolean isActive() {"
"0331933c168f9096195999592a7f169d39f238d2","ced1a05df2b47daf629416b342d6eb00c7a11258","deleted",1,"return this.active;"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"* Copyright 2002-2020 the original author or authors."
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"* @author Artem Bilan"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"*"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"* Protected by lifecycleLock"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"@Override"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"protected void doStart() {"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"String beanName = getComponentName();"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"checkTaskExecutor((beanName == null ? """" : beanName + ""-"") + getComponentType());"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"this.taskExecutor.execute(this);"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"}"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"/**"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"* Creates a default task executor if none was supplied."
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"* @param threadName The thread name."
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"*/"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"protected void checkTaskExecutor(final String threadName) {"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"if (isActive() && this.taskExecutor == null) {"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"this.taskExecutor ="
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"Executors.newFixedThreadPool(this.poolSize,"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"(runner) -> {"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"Thread thread = new Thread(runner);"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"thread.setName(threadName);"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"thread.setDaemon(true);"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"return thread;"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"});"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"protected void doStop() {"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"if (!this.taskExecutorSet && this.taskExecutor != null) {"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"((ExecutorService) this.taskExecutor).shutdown();"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","added",0,"this.taskExecutor = null;"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"* Copyright 2002-2019 the original author or authors."
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"import java.util.concurrent.ThreadFactory;"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"private volatile boolean active;"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"/**"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"* Protected by lifecycleLock"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"*/"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"@Override"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"protected void doStart() {"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"if (!this.active) {"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"this.active = true;"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"String beanName = this.getComponentName();"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"checkTaskExecutor((beanName == null ? """" : beanName + ""-"") + this.getComponentType());"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"this.taskExecutor.execute(this);"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"}"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"* Creates a default task executor if none was supplied."
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"*"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"* @param threadName The thread name."
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"protected void checkTaskExecutor(final String threadName) {"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"if (this.active && this.taskExecutor == null) {"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"Executor executor = Executors.newFixedThreadPool(this.poolSize, new ThreadFactory() {"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"public Thread newThread(Runnable runner) {"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"Thread thread = new Thread(runner);"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"thread.setName(threadName);"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"thread.setDaemon(true);"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"return thread;"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"});"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"this.taskExecutor = executor;"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"protected void doStop() {"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"this.active = false;"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"if (!this.taskExecutorSet && this.taskExecutor != null) {"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"((ExecutorService) this.taskExecutor).shutdown();"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"this.taskExecutor = null;"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"* @return the active"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"public boolean isActive() {"
"0331933c168f9096195999592a7f169d39f238d2","3e9dd90f101a9748dd145a93eeeb021b7c10ad2e","deleted",1,"return this.active;"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"* Copyright 2002-2021 the original author or authors."
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import org.springframework.core.log.LogAccessor;"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private static final LogAccessor LOGGER = new LogAccessor(LogFactory.getLog(MessagingMethodInvokerHelper.class));"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private final String displayString;"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private final boolean requiresReply;"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private boolean useSpelInvoker;"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.displayString = buildDisplayString(targetObject, method);"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.displayString = buildDisplayString(targetObject, methodName);"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private String buildDisplayString(Object targetObject, Object targetMethod) {"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"StringBuilder sb ="
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"new StringBuilder(targetObject.getClass().getName())"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,".append('.');"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"sb.append(((Method) targetMethod).getName());"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"sb.append(targetMethod);"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"return sb.append(']').toString();"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"LOGGER.info(() -> ""Failed to invoke [ "" + handlerMethod.invocableHandlerMethod +"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""] with provided arguments [ "" + parameters + "" ]. \n"" +"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""Falling back to SpEL invocation for expression [ "" +"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"expression.getExpressionString() + "" ]"");"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"catch (Exception ex) {"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"LOGGER.debug(ex, ""Failed to convert from JSON"");"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"findSingleSpecificMethodOnInterfacesIfProxy(candidateMessageMethods, candidateMethods);"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"LOGGER.debug(ex, ""Method ["" + methodToProcess + ""] is not eligible for Message handling."");"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"private void findSingleSpecificMethodOnInterfacesIfProxy(Map<Class<?>, HandlerMethod> candidateMessageMethods,"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"sb.append(')');"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"this.targetParameterTypeDescriptor + ""] and ["" + targetParameterType + ""].\n"" +"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"""Consider annotating one of the parameters with '@Payload'."");"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"* Copyright 2002-2020 the original author or authors."
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import org.apache.commons.logging.Log;"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private static final Log LOGGER = LogFactory.getLog(MessagingMethodInvokerHelper.class);"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private volatile String displayString;"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private volatile boolean requiresReply;"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private boolean useSpelInvoker;"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"setDisplayString(targetObject, method);"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"setDisplayString(targetObject, methodName);"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private void setDisplayString(Object targetObject, Object targetMethod) {"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"StringBuilder sb = new StringBuilder(targetObject.getClass().getName());"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"sb.append(""."")"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".append(((Method) targetMethod).getName());"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".append(targetMethod);"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.displayString = sb.toString() + ""]"";"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (LOGGER.isInfoEnabled()) {"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"LOGGER.info(""Failed to invoke [ "" + handlerMethod.invocableHandlerMethod +"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""] with provided arguments [ "" + parameters + "" ]. \n"" +"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"""Falling back to SpEL invocation for expression [ "" +"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"expression.getExpressionString() + "" ]"");"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"}"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"catch (Exception e) {"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"LOGGER.debug(""Failed to convert from JSON"", e);"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"findSingleSpecifMethodOnInterfacesIfProxy(candidateMessageMethods, candidateMethods);"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"if (LOGGER.isDebugEnabled()) {"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"LOGGER.debug(""Method ["" + methodToProcess + ""] is not eligible for Message handling."", e);"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"private void findSingleSpecifMethodOnInterfacesIfProxy(Map<Class<?>, HandlerMethod> candidateMessageMethods,"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"sb.append("")"");"
"9d8393eb3eb70d2f1ff3243fc77f660813d34ad6","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"this.targetParameterTypeDescriptor + ""] and ["" + targetParameterType + ""]"");"
"482673a15932553e7bd069c37b707ad9b701c904","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"* Copyright 2002-2021 the original author or authors."
"482673a15932553e7bd069c37b707ad9b701c904","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"TcpConnectionSupport wrapped = wrapConnection(connection);"
"482673a15932553e7bd069c37b707ad9b701c904","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"if (wrapped.equals(connection)) {"
"482673a15932553e7bd069c37b707ad9b701c904","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"connection.setSenders(getSenders());"
"482673a15932553e7bd069c37b707ad9b701c904","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"connection = wrapped;"
"482673a15932553e7bd069c37b707ad9b701c904","c25367cfd3f771e0c2cff570f0253c95e473f33d","added",0,"}"
"482673a15932553e7bd069c37b707ad9b701c904","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"* Copyright 2002-2020 the original author or authors."
"482673a15932553e7bd069c37b707ad9b701c904","c25367cfd3f771e0c2cff570f0253c95e473f33d","deleted",1,"connection = wrapConnection(connection);"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","added",0,"* Copyright 2002-2021 the original author or authors."
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","added",0,"import static org.assertj.core.api.Assertions.assertThatExceptionOfType;"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","added",0,"import java.nio.charset.StandardCharsets;"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","added",0,"import org.junit.jupiter.api.Test;"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","added",0,"import org.springframework.test.context.junit.jupiter.SpringJUnitConfig;"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","added",0,"@SpringJUnitConfig"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","added",0,"assertThat(handlerAccessor.getPropertyValue(""charset"")).isEqualTo(StandardCharsets.UTF_8);"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","added",0,"public void fullConfig() {"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","added",0,"HttpRequestExecutingMessageHandler handler ="
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","added",0,"(HttpRequestExecutingMessageHandler) endpointAccessor.getPropertyValue(""handler"");"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","added",0,"assertThat(handlerAccessor.getPropertyValue(""extractResponseBody"")).isEqualTo(false);"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","added",0,"handler.handleMessage(new GenericMessage<>(""foo""));"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","added",0,"assertThatExceptionOfType(BeanDefinitionParsingException.class)"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","added",0,".isThrownBy(() ->"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","added",0,"new ClassPathXmlApplicationContext(""HttpOutboundGatewayWithinChainTests-fail-context.xml"","
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","added",0,"getClass()))"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","added",0,".withMessageContaining(""'request-channel' attribute isn't allowed for a nested"");"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","added",0,"public boolean hasError(ClientHttpResponse response) {"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","added",0,"public void handleError(ClientHttpResponse response) {"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,"* Copyright 2002-2020 the original author or authors."
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,"import static org.assertj.core.api.Assertions.fail;"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,"import java.io.IOException;"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,"import java.nio.charset.Charset;"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,"import org.junit.Test;"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,"import org.junit.runner.RunWith;"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,"import org.springframework.beans.BeansException;"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,"import org.springframework.test.context.ContextConfiguration;"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,"import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,"@RunWith(SpringJUnit4ClassRunner.class)"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,"@ContextConfiguration"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,"assertThat(handlerAccessor.getPropertyValue(""charset"")).isEqualTo(Charset.forName(""UTF-8""));"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,"public void fullConfig() throws Exception {"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,"HttpRequestExecutingMessageHandler handler = (HttpRequestExecutingMessageHandler) endpointAccessor.getPropertyValue(""handler"");"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,"handler.handleMessage(new GenericMessage<String>(""foo""));"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,"try {"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,"new ClassPathXmlApplicationContext(""HttpOutboundGatewayWithinChainTests-fail-context.xml"", this.getClass())"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,".close();"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,"fail(""Expected BeanDefinitionParsingException"");"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,"}"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,"catch (BeansException e) {"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,"assertThat(e instanceof BeanDefinitionParsingException).isTrue();"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,"assertThat(e.getMessage().contains(""'request-channel' attribute isn't allowed for a nested"")).isTrue();"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,"public boolean hasError(ClientHttpResponse response) throws IOException {"
"27e1f3a6365b7c7f7d292b341155d88fbd5073c2","1363b2699e6a01a48d8b18e808bb2574714cb8ed","deleted",1,"public void handleError(ClientHttpResponse response) throws IOException {"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"import org.junit.jupiter.api.Test;"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"import org.springframework.beans.factory.support.BeanDefinitionRegistry;"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"private static MessagingAnnotationPostProcessor prepareMessagingAnnotationPostProcessor("
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"postProcessor.postProcessBeanDefinitionRegistry((BeanDefinitionRegistry) context.getBeanFactory());"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"postProcessor.postProcessBeanFactory(context.getBeanFactory());"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"import static org.assertj.core.api.Assertions.assertThatIllegalArgumentException;"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"import org.junit.Test;"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"@Test"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"public void testPostProcessorWithoutBeanFactory() {"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"MessagingAnnotationPostProcessor postProcessor ="
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"new MessagingAnnotationPostProcessor();"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"assertThatIllegalArgumentException()"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,".isThrownBy(postProcessor::afterPropertiesSet);"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"}"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"private MessagingAnnotationPostProcessor prepareMessagingAnnotationPostProcessor("
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"postProcessor.setBeanFactory(context.getBeanFactory());"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"postProcessor.afterPropertiesSet();"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"* Copyright 2002-2022 the original author or authors."
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"import org.junit.jupiter.api.AfterEach;"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"import org.junit.jupiter.api.BeforeEach;"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"import org.junit.jupiter.api.Test;"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"import org.springframework.beans.factory.support.BeanDefinitionRegistry;"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"private final MessagingAnnotationPostProcessor postProcessor = new MessagingAnnotationPostProcessor();"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"@BeforeEach"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"this.postProcessor.postProcessBeanDefinitionRegistry((BeanDefinitionRegistry) this.context.getBeanFactory());"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"this.postProcessor.postProcessBeanFactory(this.context.getBeanFactory());"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"this.postProcessor.afterSingletonsInstantiated();"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"@AfterEach"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"* Copyright 2002-2019 the original author or authors."
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"import org.junit.After;"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"import org.junit.Before;"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"import org.junit.Test;"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"@Before"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"@After"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"MessagingAnnotationPostProcessor postProcessor = new MessagingAnnotationPostProcessor();"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"postProcessor.setBeanFactory(context.getBeanFactory());"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"postProcessor.afterPropertiesSet();"
"ca138c0c061c12ab5fef516fb97c1ade2744ba5f","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"postProcessor.afterSingletonsInstantiated();"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"/*"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"* Copyright 2014-2019 the original author or authors."
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"*"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"* Licensed under the Apache License, Version 2.0 (the ""License"");"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"* you may not use this file except in compliance with the License."
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"* You may obtain a copy of the License at"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"*      https://www.apache.org/licenses/LICENSE-2.0"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"* Unless required by applicable law or agreed to in writing, software"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"* distributed under the License is distributed on an ""AS IS"" BASIS,"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"* See the License for the specific language governing permissions and"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"* limitations under the License."
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"*/"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"package org.springframework.integration.sftp.session;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"import java.util.concurrent.atomic.AtomicInteger;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"import com.jcraft.jsch.Session;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"/**"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"* A wrapper for a JSch session that maintains a channel count and"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"* physically disconnects when the last channel is closed."
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"* @author Gary Russell"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"* @since 3.0"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"class JSchSessionWrapper {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"private final Session session;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"private final AtomicInteger channels = new AtomicInteger();"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"JSchSessionWrapper(Session session) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"this.session = session;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"}"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"public void addChannel() {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"this.channels.incrementAndGet();"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"public void close() {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"if (this.channels.decrementAndGet() <= 0) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"this.session.disconnect();"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"public final Session getSession() {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"return this.session;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"public boolean isConnected() {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"return this.session.isConnected();"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"import java.util.stream.Stream;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"import java.util.stream.StreamSupport;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"import org.apache.sshd.sftp.SftpModuleProperties;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"import org.apache.sshd.sftp.client.SftpClient;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"import org.apache.sshd.sftp.common.SftpConstants;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"import org.apache.sshd.sftp.common.SftpException;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"import org.springframework.util.PatternMatchUtils;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"import org.springframework.util.StringUtils;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"public class SftpSession implements Session<SftpClient.DirEntry> {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"private final SftpClient sftpClient;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"public SftpSession(SftpClient sftpClient) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"Assert.notNull(sftpClient, ""'sftpClient' must not be null"");"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"this.sftpClient = sftpClient;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"this.sftpClient.remove(path);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"return true;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"public SftpClient.DirEntry[] list(String path) throws IOException {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"return doList(path)"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,".toArray(SftpClient.DirEntry[]::new);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,".map(SftpClient.DirEntry::getFilename)"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,".toArray(String[]::new);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"}"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"public Stream<SftpClient.DirEntry> doList(String path) throws IOException {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"String remotePath = StringUtils.trimTrailingCharacter(StringUtils.trimLeadingCharacter(path, '/'), '/');"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"String remoteDir = remotePath;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"int lastIndex = remotePath.lastIndexOf('/');"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"if (lastIndex > 0) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"remoteDir = remoteDir.substring(0, lastIndex);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"String remoteFile = lastIndex > 0 ? remotePath.substring(lastIndex + 1) : null;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"boolean isPattern = remoteFile != null && remoteFile.contains(""*"");"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"if (!isPattern && remoteFile != null) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"SftpClient.Attributes attributes = this.sftpClient.lstat(path);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"if (!attributes.isDirectory()) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"return Stream.of(new SftpClient.DirEntry(remoteFile, path, attributes));"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"else {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"remoteDir = remotePath;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"return StreamSupport.stream(this.sftpClient.readDir(remoteDir).spliterator(), false)"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,".filter((entry) -> !isPattern || PatternMatchUtils.simpleMatch(remoteFile, entry.getFilename()));"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"InputStream is = this.sftpClient.read(source);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"FileCopyUtils.copy(is, os);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"return this.sftpClient.read(source);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"synchronized (this.sftpClient) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"OutputStream outputStream = this.sftpClient.write(destination);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"FileCopyUtils.copy(inputStream, outputStream);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"OutputStream outputStream ="
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"this.sftpClient.write(destination, SftpClient.OpenMode.Create, SftpClient.OpenMode.Append);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"try {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"this.sftpClient.close();"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"catch (IOException ex) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"throw new UncheckedIOException(""failed to close an SFTP client"", ex);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"return this.sftpClient.isOpen();"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"this.sftpClient.rename(pathFrom, pathTo, SftpClient.CopyMode.Overwrite);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"this.sftpClient.mkdir(remoteDirectory);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"this.sftpClient.rmdir(remoteDirectory);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"this.sftpClient.lstat(path);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"if (ex instanceof SftpException sftpException &&"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"SftpConstants.SSH_FX_NO_SUCH_FILE == sftpException.getStatus()) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"throw new UncheckedIOException(""Cannot check 'lstat' for path "" + path, ex);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"if (!this.sftpClient.isOpen()) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"Duration initializationTimeout ="
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"SftpModuleProperties.SFTP_CHANNEL_OPEN_TIMEOUT.getRequired(this.sftpClient.getSession());"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"this.sftpClient.getClientChannel().open().verify(initializationTimeout);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"close();"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"throw new UncheckedIOException(""failed to connect an SFTP client"", ex);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"public SftpClient getClientInstance() {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"return this.sftpClient;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"return this.sftpClient.getSession().getConnectAddress().toString();"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"this.sftpClient.canonicalPath("""");"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","added",0,"catch (@SuppressWarnings(""unused"") Exception ex) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"import java.util.ArrayList;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"import java.util.List;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"import java.util.Vector;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"import org.apache.commons.logging.Log;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"import org.apache.commons.logging.LogFactory;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"import com.jcraft.jsch.ChannelSftp;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"import com.jcraft.jsch.ChannelSftp.LsEntry;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"import com.jcraft.jsch.JSchException;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"import com.jcraft.jsch.SftpATTRS;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"import com.jcraft.jsch.SftpException;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"public class SftpSession implements Session<LsEntry> {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"private static final Log LOGGER = LogFactory.getLog(SftpSession.class);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"private static final String SESSION_IS_NOT_CONNECTED = ""session is not connected"";"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"private static final Duration DEFAULT_CHANNEL_CONNECT_TIMEOUT = Duration.ofSeconds(5);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"private final com.jcraft.jsch.Session jschSession;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"private final JSchSessionWrapper wrapper;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"private int channelConnectTimeout = (int) DEFAULT_CHANNEL_CONNECT_TIMEOUT.toMillis();"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"private volatile ChannelSftp channel;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"private volatile boolean closed;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"public SftpSession(com.jcraft.jsch.Session jschSession) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"Assert.notNull(jschSession, ""jschSession must not be null"");"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"this.jschSession = jschSession;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"this.wrapper = null;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"}"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"public SftpSession(JSchSessionWrapper wrapper) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"Assert.notNull(wrapper, ""wrapper must not be null"");"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"this.jschSession = wrapper.getSession();"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"this.wrapper = wrapper;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"/**"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"* Set the connect timeout."
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"* @param timeout the timeout to set."
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"* @since 5.2"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"*/"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"public void setChannelConnectTimeout(Duration timeout) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"Assert.notNull(timeout, ""'timeout' cannot be null"");"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"this.channelConnectTimeout = (int) timeout.toMillis();"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"Assert.state(this.channel != null, SESSION_IS_NOT_CONNECTED);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"try {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"this.channel.rm(path);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"return true;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"catch (SftpException ex) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"throw new IOException(""Failed to remove file."", ex);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"public LsEntry[] list(String path) throws IOException {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"Vector<?> lsEntries = this.channel.ls(path); // NOSONAR (Vector)"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"if (lsEntries != null) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"LsEntry[] entries = new LsEntry[lsEntries.size()];"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"for (int i = 0; i < lsEntries.size(); i++) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"Object next = lsEntries.get(i);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"Assert.state(next instanceof LsEntry, ""expected only LsEntry instances from channel.ls()"");"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"entries[i] = (LsEntry) next;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"return entries;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"throw new IOException(""Failed to list files"", ex);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"return new LsEntry[0];"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"LsEntry[] entries = this.list(path);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"List<String> names = new ArrayList<>();"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"for (LsEntry entry : entries) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"String fileName = entry.getFilename();"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"SftpATTRS attrs = entry.getAttrs();"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"if (!attrs.isDir() && !attrs.isLink()) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"names.add(fileName);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"return names.toArray(new String[0]);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"InputStream is = this.channel.get(source);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"FileCopyUtils.copy(is, os);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"throw new IOException(""failed to read file "" + source, ex);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"return this.channel.get(source);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"this.channel.put(inputStream, destination);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"throw new IOException(""failed to write file"", ex);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"this.channel.put(inputStream, destination, ChannelSftp.APPEND);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"this.closed = true;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"if (this.wrapper != null) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"if (this.channel != null) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"this.channel.disconnect();"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"this.wrapper.close();"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"else {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"if (this.jschSession.isConnected()) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"this.jschSession.disconnect();"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"return !this.closed && this.jschSession.isConnected();"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"this.channel.rename(pathFrom, pathTo);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"catch (SftpException sftpex) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"if (LOGGER.isDebugEnabled()) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"LOGGER.debug(""Initial File rename failed, possibly because file already exists. "" +"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"""Will attempt to delete file: "" + pathTo + "" and execute rename again."");"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"remove(pathTo);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"LOGGER.debug(""Delete file: "" + pathTo + "" succeeded. Will attempt rename again"");"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"catch (IOException ioex) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"IOException exception = new IOException(""Failed to delete file "" + pathTo, sftpex);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"exception.addSuppressed(ioex);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"throw exception;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"// attempt to rename again"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"catch (SftpException sftpex2) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"IOException exception ="
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"new IOException(""failed to rename from "" + pathFrom + "" to "" + pathTo, sftpex);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"exception.addSuppressed(sftpex2);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"LOGGER.debug(""File: "" + pathFrom + "" was successfully renamed to "" + pathTo);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"this.channel.mkdir(remoteDirectory);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"if (ex.id != ChannelSftp.SSH_FX_FAILURE || !exists(remoteDirectory)) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"throw new IOException(""failed to create remote directory '"" + remoteDirectory + ""'."", ex);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"this.channel.rmdir(remoteDirectory);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"throw new IOException(""failed to remove remote directory '"" + remoteDirectory + ""'."", ex);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"this.channel.lstat(path);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"if (ex.id == ChannelSftp.SSH_FX_NO_SUCH_FILE) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"throw new UncheckedIOException(""Cannot check 'lstat' for path "" + path,"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"new IOException(ex));"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"if (!this.jschSession.isConnected()) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"this.jschSession.connect();"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"this.channel = (ChannelSftp) this.jschSession.openChannel(""sftp"");"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"if (this.channel != null && !this.channel.isConnected()) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"this.channel.connect(this.channelConnectTimeout);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"catch (JSchException e) {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"this.close();"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"throw new IllegalStateException(""failed to connect"", e);"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"public ChannelSftp getClientInstance() {"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"return this.channel;"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"return this.jschSession.getHost() + ':' + this.jschSession.getPort();"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"this.channel.lstat(this.channel.getHome());"
"4aa2f91bd9ae023a59cc2e9eb5622420cf0a038e","5aa0bcadf8b3a26f18f095520f984bf91bc60b7b","deleted",1,"catch (@SuppressWarnings(""unused"") Exception e) {"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"* Copyright 2002-2022 the original author or authors."
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"import org.junit.jupiter.api.Test;"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"import org.springframework.integration.config.MessagingAnnotationPostProcessor;"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"try (GenericApplicationContext context = TestUtils.createTestApplicationContext()) {"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"context.registerBeanDefinition(""postProcessor"","
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"new RootBeanDefinition(MessagingAnnotationPostProcessor.class));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"RootBeanDefinition channelDefinition = new RootBeanDefinition(DirectChannel.class);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"context.registerBeanDefinition(""input"", channelDefinition);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"RootBeanDefinition testBeanDefinition = new RootBeanDefinition(TestBean.class);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"testBeanDefinition.getConstructorArgumentValues().addGenericArgumentValue(1);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"context.registerBeanDefinition(""testBean"", testBeanDefinition);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"context.refresh();"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"TestBean testBean = (TestBean) context.getBean(""testBean"");"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"MessageChannel channel = (MessageChannel) context.getBean(""input"");"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"channel.send(new GenericMessage<>(""test-1""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"channel.send(new GenericMessage<>(""test-2""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"channel.send(new GenericMessage<>(""test-3""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"channel.send(new GenericMessage<>(""test-4""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"channel.send(new GenericMessage<>(""test-5""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"List<Integer> calls = testBean.calls;"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"assertThat(calls.size()).isEqualTo(5);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"assertThat(calls.get(0).intValue()).isEqualTo(1);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"assertThat(calls.get(1).intValue()).isEqualTo(2);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"assertThat(calls.get(2).intValue()).isEqualTo(3);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"assertThat(calls.get(3).intValue()).isEqualTo(4);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"assertThat(calls.get(4).intValue()).isEqualTo(5);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"}"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"BeanDefinitionBuilder channelBuilder = BeanDefinitionBuilder.rootBeanDefinition(DirectChannel.class);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"channelBuilder.addConstructorArgValue(null);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"RootBeanDefinition channelDefinition = (RootBeanDefinition) channelBuilder.getBeanDefinition();"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"testBeanDefinition.getConstructorArgumentValues().addGenericArgumentValue(2);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"channel.send(new GenericMessage<>(""test-6""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"channel.send(new GenericMessage<>(""test-7""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"channel.send(new GenericMessage<>(""test-8""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"channel.send(new GenericMessage<>(""test-9""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"channel.send(new GenericMessage<>(""test-10""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"assertThat(testBean.calls.size()).isEqualTo(10);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"assertThat(testBean.calls.get(0).intValue()).isEqualTo(1);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"assertThat(testBean.calls.get(1).intValue()).isEqualTo(1);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"assertThat(testBean.calls.get(2).intValue()).isEqualTo(2);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"assertThat(testBean.calls.get(3).intValue()).isEqualTo(2);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"assertThat(testBean.calls.get(4).intValue()).isEqualTo(3);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"assertThat(testBean.calls.get(5).intValue()).isEqualTo(3);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"assertThat(testBean.calls.get(6).intValue()).isEqualTo(4);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"assertThat(testBean.calls.get(7).intValue()).isEqualTo(4);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"assertThat(testBean.calls.get(8).intValue()).isEqualTo(5);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"assertThat(testBean.calls.get(9).intValue()).isEqualTo(5);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"testBean.reset();"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"channel.send(new GenericMessage<>(""test-11""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"assertThat(testBean.calls.size()).isEqualTo(1);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"channelDefinition.getConstructorArgumentValues()"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,".addGenericArgumentValue(new RoundRobinLoadBalancingStrategy());"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","added",0,"testBeanDefinition.getConstructorArgumentValues().addGenericArgumentValue(1000);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"* Copyright 2002-2019 the original author or authors."
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"import org.junit.Test;"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"GenericApplicationContext context = TestUtils.createTestApplicationContext();"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"context.registerBeanDefinition(""postProcessor"", new RootBeanDefinition(MessagingAnnotationPostProcessor.class));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"RootBeanDefinition channelDefinition = new RootBeanDefinition(DirectChannel.class);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"context.registerBeanDefinition(""input"", channelDefinition);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"RootBeanDefinition testBeanDefinition = new RootBeanDefinition(TestBean.class);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"testBeanDefinition.getConstructorArgumentValues().addGenericArgumentValue(1);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"context.registerBeanDefinition(""testBean"", testBeanDefinition);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"context.refresh();"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"TestBean testBean = (TestBean) context.getBean(""testBean"");"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"MessageChannel channel = (MessageChannel) context.getBean(""input"");"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"channel.send(new GenericMessage<String>(""test-1""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"channel.send(new GenericMessage<String>(""test-2""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"channel.send(new GenericMessage<String>(""test-3""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"channel.send(new GenericMessage<String>(""test-4""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"channel.send(new GenericMessage<String>(""test-5""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"List<Integer> calls = testBean.calls;"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"assertThat(calls.size()).isEqualTo(5);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"assertThat(calls.get(0).intValue()).isEqualTo(1);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"assertThat(calls.get(1).intValue()).isEqualTo(2);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"assertThat(calls.get(2).intValue()).isEqualTo(3);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"assertThat(calls.get(3).intValue()).isEqualTo(4);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"assertThat(calls.get(4).intValue()).isEqualTo(5);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"context.close();"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"BeanDefinitionBuilder channelBuilder = BeanDefinitionBuilder.rootBeanDefinition(DirectChannel.class);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"channelBuilder.addConstructorArgValue(null);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"RootBeanDefinition channelDefinition = (RootBeanDefinition) channelBuilder.getBeanDefinition();"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"testBeanDefinition.getConstructorArgumentValues().addGenericArgumentValue(2);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"channel.send(new GenericMessage<String>(""test-6""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"channel.send(new GenericMessage<String>(""test-7""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"channel.send(new GenericMessage<String>(""test-8""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"channel.send(new GenericMessage<String>(""test-9""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"channel.send(new GenericMessage<String>(""test-10""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"assertThat(testBean.calls.size()).isEqualTo(10);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"assertThat(testBean.calls.get(0).intValue()).isEqualTo(1);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"assertThat(testBean.calls.get(1).intValue()).isEqualTo(1);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"assertThat(testBean.calls.get(2).intValue()).isEqualTo(2);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"assertThat(testBean.calls.get(3).intValue()).isEqualTo(2);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"assertThat(testBean.calls.get(4).intValue()).isEqualTo(3);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"assertThat(testBean.calls.get(5).intValue()).isEqualTo(3);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"assertThat(testBean.calls.get(6).intValue()).isEqualTo(4);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"assertThat(testBean.calls.get(7).intValue()).isEqualTo(4);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"assertThat(testBean.calls.get(8).intValue()).isEqualTo(5);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"assertThat(testBean.calls.get(9).intValue()).isEqualTo(5);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"testBean.reset();"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"channel.send(new GenericMessage<String>(""test-11""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"assertThat(testBean.calls.size()).isEqualTo(1);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"channelDefinition.getConstructorArgumentValues().addGenericArgumentValue(new RoundRobinLoadBalancingStrategy());"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","aeb8c7e3a9057905f5959135a1670d9087b5a5bb","deleted",1,"testBeanDefinition.getConstructorArgumentValues().addGenericArgumentValue(1000);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"* Copyright 2002-2022 the original author or authors."
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"import org.junit.jupiter.api.Test;"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"import org.springframework.integration.config.MessagingAnnotationPostProcessor;"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"try (GenericApplicationContext context = TestUtils.createTestApplicationContext()) {"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"context.registerBeanDefinition(""postProcessor"","
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"new RootBeanDefinition(MessagingAnnotationPostProcessor.class));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"RootBeanDefinition channelDefinition = new RootBeanDefinition(DirectChannel.class);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"context.registerBeanDefinition(""input"", channelDefinition);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"RootBeanDefinition testBeanDefinition = new RootBeanDefinition(TestBean.class);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"testBeanDefinition.getConstructorArgumentValues().addGenericArgumentValue(1);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"context.registerBeanDefinition(""testBean"", testBeanDefinition);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"context.refresh();"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"TestBean testBean = (TestBean) context.getBean(""testBean"");"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"MessageChannel channel = (MessageChannel) context.getBean(""input"");"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"channel.send(new GenericMessage<>(""test-1""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"channel.send(new GenericMessage<>(""test-2""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"channel.send(new GenericMessage<>(""test-3""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"channel.send(new GenericMessage<>(""test-4""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"channel.send(new GenericMessage<>(""test-5""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"List<Integer> calls = testBean.calls;"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"assertThat(calls.size()).isEqualTo(5);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"assertThat(calls.get(0).intValue()).isEqualTo(1);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"assertThat(calls.get(1).intValue()).isEqualTo(2);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"assertThat(calls.get(2).intValue()).isEqualTo(3);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"assertThat(calls.get(3).intValue()).isEqualTo(4);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"assertThat(calls.get(4).intValue()).isEqualTo(5);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"}"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"BeanDefinitionBuilder channelBuilder = BeanDefinitionBuilder.rootBeanDefinition(DirectChannel.class);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"channelBuilder.addConstructorArgValue(null);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"RootBeanDefinition channelDefinition = (RootBeanDefinition) channelBuilder.getBeanDefinition();"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"testBeanDefinition.getConstructorArgumentValues().addGenericArgumentValue(2);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"channel.send(new GenericMessage<>(""test-6""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"channel.send(new GenericMessage<>(""test-7""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"channel.send(new GenericMessage<>(""test-8""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"channel.send(new GenericMessage<>(""test-9""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"channel.send(new GenericMessage<>(""test-10""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"assertThat(testBean.calls.size()).isEqualTo(10);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"assertThat(testBean.calls.get(0).intValue()).isEqualTo(1);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"assertThat(testBean.calls.get(1).intValue()).isEqualTo(1);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"assertThat(testBean.calls.get(2).intValue()).isEqualTo(2);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"assertThat(testBean.calls.get(3).intValue()).isEqualTo(2);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"assertThat(testBean.calls.get(4).intValue()).isEqualTo(3);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"assertThat(testBean.calls.get(5).intValue()).isEqualTo(3);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"assertThat(testBean.calls.get(6).intValue()).isEqualTo(4);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"assertThat(testBean.calls.get(7).intValue()).isEqualTo(4);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"assertThat(testBean.calls.get(8).intValue()).isEqualTo(5);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"assertThat(testBean.calls.get(9).intValue()).isEqualTo(5);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"testBean.reset();"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"channel.send(new GenericMessage<>(""test-11""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"assertThat(testBean.calls.size()).isEqualTo(1);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"channelDefinition.getConstructorArgumentValues()"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,".addGenericArgumentValue(new RoundRobinLoadBalancingStrategy());"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","added",0,"testBeanDefinition.getConstructorArgumentValues().addGenericArgumentValue(1000);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"* Copyright 2002-2019 the original author or authors."
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"import org.junit.Test;"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"GenericApplicationContext context = TestUtils.createTestApplicationContext();"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"context.registerBeanDefinition(""postProcessor"", new RootBeanDefinition(MessagingAnnotationPostProcessor.class));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"RootBeanDefinition channelDefinition = new RootBeanDefinition(DirectChannel.class);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"context.registerBeanDefinition(""input"", channelDefinition);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"RootBeanDefinition testBeanDefinition = new RootBeanDefinition(TestBean.class);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"testBeanDefinition.getConstructorArgumentValues().addGenericArgumentValue(1);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"context.registerBeanDefinition(""testBean"", testBeanDefinition);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"context.refresh();"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"TestBean testBean = (TestBean) context.getBean(""testBean"");"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"MessageChannel channel = (MessageChannel) context.getBean(""input"");"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"channel.send(new GenericMessage<String>(""test-1""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"channel.send(new GenericMessage<String>(""test-2""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"channel.send(new GenericMessage<String>(""test-3""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"channel.send(new GenericMessage<String>(""test-4""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"channel.send(new GenericMessage<String>(""test-5""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"List<Integer> calls = testBean.calls;"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"assertThat(calls.size()).isEqualTo(5);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"assertThat(calls.get(0).intValue()).isEqualTo(1);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"assertThat(calls.get(1).intValue()).isEqualTo(2);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"assertThat(calls.get(2).intValue()).isEqualTo(3);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"assertThat(calls.get(3).intValue()).isEqualTo(4);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"assertThat(calls.get(4).intValue()).isEqualTo(5);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"context.close();"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"BeanDefinitionBuilder channelBuilder = BeanDefinitionBuilder.rootBeanDefinition(DirectChannel.class);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"channelBuilder.addConstructorArgValue(null);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"RootBeanDefinition channelDefinition = (RootBeanDefinition) channelBuilder.getBeanDefinition();"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"testBeanDefinition.getConstructorArgumentValues().addGenericArgumentValue(2);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"channel.send(new GenericMessage<String>(""test-6""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"channel.send(new GenericMessage<String>(""test-7""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"channel.send(new GenericMessage<String>(""test-8""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"channel.send(new GenericMessage<String>(""test-9""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"channel.send(new GenericMessage<String>(""test-10""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"assertThat(testBean.calls.size()).isEqualTo(10);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"assertThat(testBean.calls.get(0).intValue()).isEqualTo(1);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"assertThat(testBean.calls.get(1).intValue()).isEqualTo(1);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"assertThat(testBean.calls.get(2).intValue()).isEqualTo(2);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"assertThat(testBean.calls.get(3).intValue()).isEqualTo(2);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"assertThat(testBean.calls.get(4).intValue()).isEqualTo(3);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"assertThat(testBean.calls.get(5).intValue()).isEqualTo(3);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"assertThat(testBean.calls.get(6).intValue()).isEqualTo(4);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"assertThat(testBean.calls.get(7).intValue()).isEqualTo(4);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"assertThat(testBean.calls.get(8).intValue()).isEqualTo(5);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"assertThat(testBean.calls.get(9).intValue()).isEqualTo(5);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"testBean.reset();"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"channel.send(new GenericMessage<String>(""test-11""));"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"assertThat(testBean.calls.size()).isEqualTo(1);"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"channelDefinition.getConstructorArgumentValues().addGenericArgumentValue(new RoundRobinLoadBalancingStrategy());"
"0eb6ae172e3b848560ef2ac31af730d6e9c2b31b","00bca2d5117fb534e6ff2466fd40973a9328e596","deleted",1,"testBeanDefinition.getConstructorArgumentValues().addGenericArgumentValue(1000);"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"* Copyright 2002-2022 the original author or authors."
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"import static org.assertj.core.api.Assertions.assertThatExceptionOfType;"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"import static org.assertj.core.api.Assertions.assertThatIllegalArgumentException;"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"import org.junit.jupiter.api.Test;"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"* @author Artem Bilan"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"@Test"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"assertThatIllegalArgumentException()"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,".isThrownBy(() -> mapper.toMessage(new Object[] { ""test"", ""oops"" }));"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,".isThrownBy(() -> mapper.toMessage(new Object[] {}));"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"assertThatExceptionOfType(MessageMappingException.class)"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,".isThrownBy(() -> mapper.toMessage(new Object[] { ""test"", null }));"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"Map<String, Object> headers = new HashMap<>();"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"Map<Integer, String> headers = new HashMap<>();"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,".isThrownBy(() -> mapper.toMessage(new Object[] { ""test"", headers }));"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,".isThrownBy(() -> mapper.toMessage(new Object[] { inputMessage, null }));"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"Method method = TestService.class.getMethod(""noArgs"");"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,".isThrownBy(() -> mapper.toMessage(new Object[] { ""abc"", ""def"" }));"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"Map<String, Expression> headers = new HashMap<>();"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"Map<Integer, Object> map = new HashMap<>();"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"Map<Integer, Object> mapA = new HashMap<>();"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"Map<String, Object> mapB = new HashMap<>();"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","added",0,"@Payload(""args[0]"")"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"* Copyright 2002-2019 the original author or authors."
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"import org.junit.Test;"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"@Test(expected = IllegalArgumentException.class)"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"mapper.toMessage(new Object[] { ""test"", ""oops"" });"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"mapper.toMessage(new Object[] {});"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"@Test(expected = MessageMappingException.class)"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"mapper.toMessage(new Object[] { ""test"", null });"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"Map<String, Object> headers = new HashMap<String, Object>();"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"Map<Integer, String> headers = new HashMap<Integer, String>();"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"mapper.toMessage(new Object[] { ""test"", headers });"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"mapper.toMessage(new Object[] { inputMessage, null });"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"Method method = TestService.class.getMethod(""noArgs"", new Class<?>[] {});"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"mapper.toMessage(new Object[] { ""abc"", ""def"" });"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"Map<String, Expression> headers = new HashMap<String, Expression>();"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"Map<Integer, Object> map = new HashMap<Integer, Object>();"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"Map<Integer, Object> mapA = new HashMap<Integer, Object>();"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"Map<String, Object> mapB = new HashMap<String, Object>();"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","1f0d9d6e45276a15cc6ec925c7ce41a76476cb88","deleted",1,"@Payload(""#args[0]"")"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","d5a80421ecccc176df5f01361c9a463a47445259","added",0,"* Copyright 2002-2022 the original author or authors."
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","d5a80421ecccc176df5f01361c9a463a47445259","added",0,"import org.junit.jupiter.api.Test;"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","d5a80421ecccc176df5f01361c9a463a47445259","added",0,"import org.springframework.test.context.junit.jupiter.SpringJUnitConfig;"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","d5a80421ecccc176df5f01361c9a463a47445259","added",0,"@SpringJUnitConfig"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","d5a80421ecccc176df5f01361c9a463a47445259","added",0,"@Payload(""args[0] + args[1]"")"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","d5a80421ecccc176df5f01361c9a463a47445259","deleted",1,"* Copyright 2002-2019 the original author or authors."
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","d5a80421ecccc176df5f01361c9a463a47445259","deleted",1,"import org.junit.Test;"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","d5a80421ecccc176df5f01361c9a463a47445259","deleted",1,"import org.junit.runner.RunWith;"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","d5a80421ecccc176df5f01361c9a463a47445259","deleted",1,"import org.springframework.test.context.ContextConfiguration;"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","d5a80421ecccc176df5f01361c9a463a47445259","deleted",1,"import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","d5a80421ecccc176df5f01361c9a463a47445259","deleted",1,"@RunWith(SpringJUnit4ClassRunner.class)"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","d5a80421ecccc176df5f01361c9a463a47445259","deleted",1,"@ContextConfiguration"
"a30dc10447e8076d7cd65c55342e6955fb3cfd52","d5a80421ecccc176df5f01361c9a463a47445259","deleted",1,"@Payload(""#args[0] + #args[1]"")"
"2f1c202c20f59db2873a20fb04537f9e4da42882","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"private volatile DestinationResolver<MessageChannel> channelResolver;"
"2f1c202c20f59db2873a20fb04537f9e4da42882","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"this.conversionService ="
"2f1c202c20f59db2873a20fb04537f9e4da42882","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"this.beanFactory.getConversionService() != null"
"2f1c202c20f59db2873a20fb04537f9e4da42882","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"? this.beanFactory.getConversionService()"
"2f1c202c20f59db2873a20fb04537f9e4da42882","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,": DefaultConversionService.getSharedInstance();"
"2f1c202c20f59db2873a20fb04537f9e4da42882","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"if (this.channelResolver == null) {"
"2f1c202c20f59db2873a20fb04537f9e4da42882","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"this.channelResolver = ChannelResolverUtils.getChannelResolver(this.beanFactory);"
"2f1c202c20f59db2873a20fb04537f9e4da42882","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"}"
"2f1c202c20f59db2873a20fb04537f9e4da42882","727a554ccf86b27add0c0b3183c6df26a6c4f730","added",0,"inputChannel = getChannelResolver().resolveDestination(inputChannelName);"
"2f1c202c20f59db2873a20fb04537f9e4da42882","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"private DestinationResolver<MessageChannel> channelResolver;"
"2f1c202c20f59db2873a20fb04537f9e4da42882","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"this.conversionService = this.beanFactory.getConversionService() != null"
"2f1c202c20f59db2873a20fb04537f9e4da42882","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"? this.beanFactory.getConversionService()"
"2f1c202c20f59db2873a20fb04537f9e4da42882","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,": DefaultConversionService.getSharedInstance();"
"2f1c202c20f59db2873a20fb04537f9e4da42882","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"this.channelResolver = ChannelResolverUtils.getChannelResolver(beanFactory);"
"2f1c202c20f59db2873a20fb04537f9e4da42882","727a554ccf86b27add0c0b3183c6df26a6c4f730","deleted",1,"inputChannel = this.channelResolver.resolveDestination(inputChannelName);"
"1bec420fd1b1c0ed73672974df14ccf673630154","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"import org.springframework.integration.context.IntegrationContextUtils;"
"1bec420fd1b1c0ed73672974df14ccf673630154","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"private long replyTimeout = IntegrationContextUtils.DEFAULT_TIMEOUT;"
"1bec420fd1b1c0ed73672974df14ccf673630154","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"template.setSendTimeout(IntegrationContextUtils.DEFAULT_TIMEOUT);"
"1bec420fd1b1c0ed73672974df14ccf673630154","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","added",0,"correlator = new PollingConsumer((PollableChannel) replyChan, handler);"
"1bec420fd1b1c0ed73672974df14ccf673630154","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"private static final long DEFAULT_TIMEOUT = 1000L;"
"1bec420fd1b1c0ed73672974df14ccf673630154","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"private long replyTimeout = DEFAULT_TIMEOUT;"
"1bec420fd1b1c0ed73672974df14ccf673630154","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"template.setSendTimeout(DEFAULT_TIMEOUT);"
"1bec420fd1b1c0ed73672974df14ccf673630154","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"PollingConsumer endpoint = new PollingConsumer((PollableChannel) replyChan, handler);"
"1bec420fd1b1c0ed73672974df14ccf673630154","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"endpoint.setReceiveTimeout(this.replyTimeout);"
"1bec420fd1b1c0ed73672974df14ccf673630154","27e288be08d4ccdf4bbb3e6a5bb3776963b1dfed","deleted",1,"correlator = endpoint;"
"1bec420fd1b1c0ed73672974df14ccf673630154","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"* Copyright 2002-2023 the original author or authors."
"1bec420fd1b1c0ed73672974df14ccf673630154","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"import org.junit.jupiter.api.Test;"
"1bec420fd1b1c0ed73672974df14ccf673630154","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"assertThat(getPropertyValue(aggregator, ""messagingTemplate.sendTimeout"")).isEqualTo(30000L);"
"1bec420fd1b1c0ed73672974df14ccf673630154","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"DirectFieldAccessor processorAccessor ="
"1bec420fd1b1c0ed73672974df14ccf673630154","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","added",0,"new DirectFieldAccessor(TestUtils.getPropertyValue(releaseStrategyAdapter, ""processor.delegate""));"
"1bec420fd1b1c0ed73672974df14ccf673630154","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"* Copyright 2002-2022 the original author or authors."
"1bec420fd1b1c0ed73672974df14ccf673630154","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"import org.junit.Test;"
"1bec420fd1b1c0ed73672974df14ccf673630154","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"assertThat(getPropertyValue(aggregator, ""messagingTemplate.sendTimeout"")).isEqualTo(-1L);"
"1bec420fd1b1c0ed73672974df14ccf673630154","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,"DirectFieldAccessor processorAccessor = new DirectFieldAccessor(new DirectFieldAccessor(new DirectFieldAccessor(releaseStrategyAdapter)"
"1bec420fd1b1c0ed73672974df14ccf673630154","e6b508ca87e9f48a47be90dfe01df6625ddd6e26","deleted",1,".getPropertyValue(""processor"")).getPropertyValue(""delegate""));"
"1bec420fd1b1c0ed73672974df14ccf673630154","6817d053d9f71f23ad20b322ce28ac5c3ed6bd61","added",0,"* Copyright 2002-2023 the original author or authors."
"1bec420fd1b1c0ed73672974df14ccf673630154","6817d053d9f71f23ad20b322ce28ac5c3ed6bd61","added",0,"import org.junit.jupiter.api.Test;"
"1bec420fd1b1c0ed73672974df14ccf673630154","6817d053d9f71f23ad20b322ce28ac5c3ed6bd61","added",0,"import org.springframework.test.context.junit.jupiter.SpringJUnitConfig;"
"1bec420fd1b1c0ed73672974df14ccf673630154","6817d053d9f71f23ad20b322ce28ac5c3ed6bd61","added",0,"@SpringJUnitConfig"
"1bec420fd1b1c0ed73672974df14ccf673630154","6817d053d9f71f23ad20b322ce28ac5c3ed6bd61","added",0,"assertThat(TestUtils.getPropertyValue(router, ""messagingTemplate.sendTimeout"")).isEqualTo(30000L);"
"1bec420fd1b1c0ed73672974df14ccf673630154","6817d053d9f71f23ad20b322ce28ac5c3ed6bd61","deleted",1,"* Copyright 2002-2022 the original author or authors."
"1bec420fd1b1c0ed73672974df14ccf673630154","6817d053d9f71f23ad20b322ce28ac5c3ed6bd61","deleted",1,"import org.junit.Test;"
"1bec420fd1b1c0ed73672974df14ccf673630154","6817d053d9f71f23ad20b322ce28ac5c3ed6bd61","deleted",1,"import org.junit.runner.RunWith;"
"1bec420fd1b1c0ed73672974df14ccf673630154","6817d053d9f71f23ad20b322ce28ac5c3ed6bd61","deleted",1,"import org.springframework.test.context.ContextConfiguration;"
"1bec420fd1b1c0ed73672974df14ccf673630154","6817d053d9f71f23ad20b322ce28ac5c3ed6bd61","deleted",1,"import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;"
"1bec420fd1b1c0ed73672974df14ccf673630154","6817d053d9f71f23ad20b322ce28ac5c3ed6bd61","deleted",1,"@RunWith(SpringJUnit4ClassRunner.class)"
"1bec420fd1b1c0ed73672974df14ccf673630154","6817d053d9f71f23ad20b322ce28ac5c3ed6bd61","deleted",1,"@ContextConfiguration"
"1bec420fd1b1c0ed73672974df14ccf673630154","6817d053d9f71f23ad20b322ce28ac5c3ed6bd61","deleted",1,"assertThat(new DirectFieldAccessor("
"1bec420fd1b1c0ed73672974df14ccf673630154","6817d053d9f71f23ad20b322ce28ac5c3ed6bd61","deleted",1,"accessor.getPropertyValue(""messagingTemplate"")).getPropertyValue(""sendTimeout"")).isEqualTo(-1L);"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"/*"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"* Copyright 2002-2022 the original author or authors."
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"*"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"* Licensed under the Apache License, Version 2.0 (the ""License"");"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"* you may not use this file except in compliance with the License."
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"* You may obtain a copy of the License at"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"*      https://www.apache.org/licenses/LICENSE-2.0"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"* Unless required by applicable law or agreed to in writing, software"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"* distributed under the License is distributed on an ""AS IS"" BASIS,"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"* See the License for the specific language governing permissions and"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"* limitations under the License."
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"*/"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"package org.springframework.integration.security.config;"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"import java.util.List;"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"import org.w3c.dom.Element;"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"import org.springframework.beans.factory.config.BeanDefinition;"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"import org.springframework.beans.factory.support.BeanDefinitionBuilder;"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"import org.springframework.beans.factory.support.ManagedMap;"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"import org.springframework.beans.factory.xml.AbstractSingleBeanDefinitionParser;"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"import org.springframework.beans.factory.xml.ParserContext;"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"import org.springframework.integration.config.xml.IntegrationNamespaceUtils;"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"import org.springframework.integration.security.channel.ChannelSecurityInterceptor;"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"import org.springframework.integration.security.channel.ChannelSecurityMetadataSource;"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"import org.springframework.integration.security.channel.DefaultChannelAccessPolicy;"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"import org.springframework.util.StringUtils;"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"import org.springframework.util.xml.DomUtils;"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"/**"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"* Creates a {@link org.springframework.integration.security.channel.ChannelSecurityInterceptor}"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"* to control send and receive access, and creates a bean post-processor to apply the"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"* interceptor to {@link org.springframework.messaging.MessageChannel}s"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"* whose names match the specified patterns."
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"* @author Jonas Partner"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"* @author Mark Fisher"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"* @author Artem Bilan"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"* @deprecated since 6.0 in favor of literally"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"* {@code new AuthorizationChannelInterceptor(AuthorityAuthorizationManager.hasAnyRole())}"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"@Deprecated(since = ""6.0"")"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"public class SecuredChannelsParser extends AbstractSingleBeanDefinitionParser {"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"@Override"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"protected Class<?> getBeanClass(Element element) {"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"return ChannelSecurityInterceptor.class;"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"}"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"protected boolean shouldGenerateId() {"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"return true;"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"protected void doParse(Element element, ParserContext parserContext, BeanDefinitionBuilder builder) {"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"builder.addConstructorArgValue(this.parseSecurityMetadataSource(element, parserContext));"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"IntegrationNamespaceUtils.setReferenceIfAttributeDefined(builder, element, ""authentication-manager"");"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"IntegrationNamespaceUtils.setReferenceIfAttributeDefined(builder, element, ""access-decision-manager"");"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"private BeanDefinition parseSecurityMetadataSource(Element element, ParserContext parserContext) {"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"BeanDefinitionBuilder builder = BeanDefinitionBuilder.genericBeanDefinition(ChannelSecurityMetadataSource.class);"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"List<Element> accessPolicyElements = DomUtils.getChildElementsByTagName(element, ""access-policy"");"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"ManagedMap<String, BeanDefinition> patternMappings = new ManagedMap<String, BeanDefinition>();"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"for (Element accessPolicyElement : accessPolicyElements) {"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"String sendAccess = accessPolicyElement.getAttribute(""send-access"");"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"String receiveAccess = accessPolicyElement.getAttribute(""receive-access"");"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"if (!StringUtils.hasText(sendAccess) && !StringUtils.hasText(receiveAccess)) {"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"parserContext.getReaderContext().error("
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"""At least one of 'send-access' or 'receive-access' must be provided."", accessPolicyElement);"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"BeanDefinitionBuilder accessPolicyBuilder = BeanDefinitionBuilder.genericBeanDefinition(DefaultChannelAccessPolicy.class);"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"accessPolicyBuilder.addConstructorArgValue(sendAccess);"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"accessPolicyBuilder.addConstructorArgValue(receiveAccess);"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"accessPolicyBuilder.getBeanDefinition().setRole(BeanDefinition.ROLE_SUPPORT);"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"patternMappings.put(accessPolicyElement.getAttribute(""pattern""), accessPolicyBuilder.getBeanDefinition());"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"builder.addConstructorArgValue(patternMappings);"
"ba417de68037eb69c9f63f30a7de985bdfe77f76","24793ead190773d8ee60b2c363aaabc91ff98d1e","deleted",1,"return builder.getBeanDefinition();"
"4583afe0add8dc7ef14bc5a4c436d36129ba8c2d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"* Copyright 2002-2023 the original author or authors."
"4583afe0add8dc7ef14bc5a4c436d36129ba8c2d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"this.context.registerBean(MessagingAnnotationPostProcessor.class);"
"4583afe0add8dc7ef14bc5a4c436d36129ba8c2d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"this.context.registerEndpoint(""testEndpoint"", new TestEndpoint());"
"4583afe0add8dc7ef14bc5a4c436d36129ba8c2d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"this.context.registerEndpoint(""testEndpoint"", new FailingTestEndpoint());"
"4583afe0add8dc7ef14bc5a4c436d36129ba8c2d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"* Copyright 2002-2022 the original author or authors."
"4583afe0add8dc7ef14bc5a4c436d36129ba8c2d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"import org.springframework.beans.factory.support.BeanDefinitionRegistry;"
"4583afe0add8dc7ef14bc5a4c436d36129ba8c2d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"MessagingAnnotationPostProcessor postProcessor = new MessagingAnnotationPostProcessor();"
"4583afe0add8dc7ef14bc5a4c436d36129ba8c2d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"postProcessor.postProcessBeanDefinitionRegistry((BeanDefinitionRegistry) this.context.getBeanFactory());"
"4583afe0add8dc7ef14bc5a4c436d36129ba8c2d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"postProcessor.postProcessBeanFactory(this.context.getBeanFactory());"
"4583afe0add8dc7ef14bc5a4c436d36129ba8c2d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"postProcessor.afterSingletonsInstantiated();"
"4583afe0add8dc7ef14bc5a4c436d36129ba8c2d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"TestEndpoint endpoint = new TestEndpoint();"
"4583afe0add8dc7ef14bc5a4c436d36129ba8c2d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"postProcessor.postProcessAfterInitialization(endpoint, ""testEndpoint"");"
"4583afe0add8dc7ef14bc5a4c436d36129ba8c2d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"FailingTestEndpoint endpoint = new FailingTestEndpoint();"
"4583afe0add8dc7ef14bc5a4c436d36129ba8c2d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"* Copyright 2002-2023 the original author or authors."
"4583afe0add8dc7ef14bc5a4c436d36129ba8c2d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"this.context.registerBean(MessagingAnnotationPostProcessor.class);"
"4583afe0add8dc7ef14bc5a4c436d36129ba8c2d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","added",0,"context.registerEndpoint(""testSplitter"", splitter);"
"4583afe0add8dc7ef14bc5a4c436d36129ba8c2d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"* Copyright 2002-2022 the original author or authors."
"4583afe0add8dc7ef14bc5a4c436d36129ba8c2d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"import org.springframework.beans.factory.support.BeanDefinitionRegistry;"
"4583afe0add8dc7ef14bc5a4c436d36129ba8c2d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"MessagingAnnotationPostProcessor postProcessor = new MessagingAnnotationPostProcessor();"
"4583afe0add8dc7ef14bc5a4c436d36129ba8c2d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"postProcessor.postProcessBeanDefinitionRegistry((BeanDefinitionRegistry) this.context.getBeanFactory());"
"4583afe0add8dc7ef14bc5a4c436d36129ba8c2d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"postProcessor.postProcessBeanFactory(this.context.getBeanFactory());"
"4583afe0add8dc7ef14bc5a4c436d36129ba8c2d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"postProcessor.afterSingletonsInstantiated();"
"4583afe0add8dc7ef14bc5a4c436d36129ba8c2d","6c4245f3ca5dab4bb691423317ea8b8806148dd5","deleted",1,"postProcessor.postProcessAfterInitialization(splitter, ""testSplitter"");"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"import java.util.concurrent.Executor;"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"import org.springframework.core.task.SimpleAsyncTaskExecutor;"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"private Executor taskExecutor;"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"/**"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"* Provide a managed {@link Executor} to schedule a receiving IDLE task."
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"* @param taskExecutor the {@link Executor} to use."
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"* @since 6.2"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"*/"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"public void setTaskExecutor(Executor taskExecutor) {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"Assert.notNull(taskExecutor, ""'taskExecutor' must not be null"");"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"this.taskExecutor = taskExecutor;"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"}"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (this.taskExecutor == null) {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"this.taskExecutor = new SimpleAsyncTaskExecutor(getBeanName() + ""-"");"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"@Override"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"this.taskExecutor.execute(this::callIdle);"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"private void callIdle() {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"while (isActive()) {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"try {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"processIdle();"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"logger.debug(""Task completed successfully. Re-scheduling it again right away."");"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"catch (Exception ex) {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"publishException(ex);"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (this.shouldReconnectAutomatically"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"&& ex.getCause() instanceof jakarta.mail.MessagingException messagingException) {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"//run again after a delay"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"logger.info(messagingException,"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"() -> ""Failed to execute IDLE task. Will attempt to resubmit in """
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"+ this.reconnectDelay + "" milliseconds."");"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"delayNextIdleCall();"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"else {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"logger.warn(ex,"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"""Failed to execute IDLE task. "" +"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"""Won't resubmit since not a 'shouldReconnectAutomatically' "" +"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"""or not a 'jakarta.mail.MessagingException'"");"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"break;"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"private void processIdle() {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"logger.debug(""waiting for mail"");"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"this.mailReceiver.waitForNewMessages();"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"Folder folder = this.mailReceiver.getFolder();"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (folder != null && folder.isOpen() && isRunning()) {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"Object[] mailMessages = this.mailReceiver.receive();"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"logger.debug(() -> ""received "" + mailMessages.length + "" mail messages"");"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"for (Object mailMessage : mailMessages) {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (isRunning()) {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"this.messageSender.accept(mailMessage);"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"catch (jakarta.mail.MessagingException ex) {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"logger.warn(ex, ""error occurred in idle task"");"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"if (this.shouldReconnectAutomatically) {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"throw new IllegalStateException(""Failure in 'idle' task. Will resubmit."", ex);"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"throw new MessagingException(""Failure in 'idle' task. Will NOT resubmit."", ex);"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"private void delayNextIdleCall() {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"Thread.sleep(this.reconnectDelay);"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"catch (InterruptedException ex) {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"Thread.currentThread().interrupt();"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","added",0,"throw new IllegalStateException(ex);"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"import java.time.Instant;"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"import java.util.concurrent.atomic.AtomicBoolean;"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"import org.springframework.scheduling.TaskScheduler;"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"import org.springframework.scheduling.Trigger;"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"import org.springframework.scheduling.TriggerContext;"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"private final ExceptionAwarePeriodicTrigger receivingTaskTrigger = new ExceptionAwarePeriodicTrigger();"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"private final IdleTask idleTask = new IdleTask();"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"/*"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"* Lifecycle implementation"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"*/"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"@Override // guarded by super#lifecycleLock"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"TaskScheduler scheduler = getTaskScheduler();"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Assert.notNull(scheduler, ""'taskScheduler' must not be null"");"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.receivingTask = scheduler.schedule(new ReceivingTask(), this.receivingTaskTrigger);"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"private class ReceivingTask implements Runnable {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"ReceivingTask() {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"}"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"@Override"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"public void run() {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (isRunning()) {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"try {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"ImapIdleChannelAdapter.this.idleTask.run();"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"logger.debug(""Task completed successfully. Re-scheduling it again right away."");"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"catch (Exception ex) {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (ImapIdleChannelAdapter.this.shouldReconnectAutomatically"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"&& ex.getCause() instanceof jakarta.mail.MessagingException messagingException) {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"//run again after a delay"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"logger.info(messagingException,"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"() -> ""Failed to execute IDLE task. Will attempt to resubmit in """
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"+ ImapIdleChannelAdapter.this.reconnectDelay + "" milliseconds."");"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"ImapIdleChannelAdapter.this.receivingTaskTrigger.delayNextExecution();"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"else {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"logger.warn(ex,"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"""Failed to execute IDLE task. "" +"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"""Won't resubmit since not a 'shouldReconnectAutomatically' "" +"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"""or not a 'jakarta.mail.MessagingException'"");"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"ImapIdleChannelAdapter.this.receivingTaskTrigger.stop();"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"publishException(ex);"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"private class IdleTask implements Runnable {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"IdleTask() {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"logger.debug(""waiting for mail"");"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"ImapIdleChannelAdapter.this.mailReceiver.waitForNewMessages();"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Folder folder = ImapIdleChannelAdapter.this.mailReceiver.getFolder();"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (folder != null && folder.isOpen() && isRunning()) {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"Object[] mailMessages = ImapIdleChannelAdapter.this.mailReceiver.receive();"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"logger.debug(() -> ""received "" + mailMessages.length + "" mail messages"");"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"for (Object mailMessage : mailMessages) {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"ImapIdleChannelAdapter.this.messageSender.accept(mailMessage);"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"catch (jakarta.mail.MessagingException ex) {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"logger.warn(ex, ""error occurred in idle task"");"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (ImapIdleChannelAdapter.this.shouldReconnectAutomatically) {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"throw new IllegalStateException(""Failure in 'idle' task. Will resubmit."", ex);"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"throw new MessagingException(""Failure in 'idle' task. Will NOT resubmit."", ex);"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"private class ExceptionAwarePeriodicTrigger implements Trigger {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"private final AtomicBoolean delayNextExecution = new AtomicBoolean();"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"private final AtomicBoolean stop = new AtomicBoolean();"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"ExceptionAwarePeriodicTrigger() {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"public Instant nextExecution(TriggerContext triggerContext) {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (this.stop.getAndSet(false)) {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"return null;"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"if (this.delayNextExecution.getAndSet(false)) {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"return Instant.now().plusMillis(ImapIdleChannelAdapter.this.reconnectDelay);"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"return Instant.now();"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"void delayNextExecution() {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.delayNextExecution.set(true);"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"void stop() {"
"e4c1851c070e05ba14979851509c6312ec88d932","3817fa259882b8deef289615bed0e4a00e2b76c7","deleted",1,"this.stop.set(true);"
