fix_commit_hash,commit_hash,change_type,is_buggy_line,code_change_remove_common_tokens
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,added,0,"public static final String EXTRACONFIGLOCATIONSKEY = ""extra.config.locations"";"
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,added,0,"addContextFile(contextType, items, temp);"
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,added,0,String extraConfigFiles = System.getProperty(EXTRACONFIGLOCATIONSKEY);
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,added,0,if (extraConfigFiles != null) {
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,added,0,"String[] files = extraConfigFiles.split("" "");"
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,added,0,for (String file : files) {
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,added,0,"addContextFile(contextType, items, file);"
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,added,0,}
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,added,0,"private static void addContextFile(int contextType, ArrayList<String> items, String temp) {"
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,added,0,"if (!temp.startsWith(""#"") && temp.trim().length() > 0 && StandardConfigLocations.class.getClassLoader().getResource(temp.trim()) != null) {"
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,added,0,if (
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,added,0,contextType == ALLCONTEXTTYPE  ||
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,added,0,"((contextType == WEBCONTEXTTYPE || contextType == APPCONTEXTTYPE) && temp.indexOf(""-web-"") >= 0) ||"
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,added,0,"((contextType == SERVICECONTEXTTYPE || contextType == TESTCONTEXTTYPE || contextType == APPCONTEXTTYPE) && temp.indexOf(""-web-"") < 0 && temp.indexOf(""-test"") < 0) ||"
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,added,0,"(contextType == TESTCONTEXTTYPE && temp.indexOf(""-test"") >= 0)"
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,added,0,){
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,added,0,items.add(temp.trim());
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,"if (!temp.startsWith(""#"") && temp.trim().length() > 0 && StandardConfigLocations.class.getClassLoader().getResource(temp.trim()) != null) {"
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,if (
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,contextType == ALLCONTEXTTYPE  ||
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,"((contextType == WEBCONTEXTTYPE || contextType == APPCONTEXTTYPE) && temp.indexOf(""-web-"") >= 0) ||"
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,"((contextType == SERVICECONTEXTTYPE || contextType == TESTCONTEXTTYPE || contextType == APPCONTEXTTYPE) && temp.indexOf(""-web-"") < 0 && temp.indexOf(""-test"") < 0) ||"
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,"(contextType == TESTCONTEXTTYPE && temp.indexOf(""-test"") >= 0)"
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,){
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,items.add(temp.trim());
80ab7212bae83bde2ab6c071a8a76836118e5a8f,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,}
976827bfaa55b4184eeb54f618949801fab5900f,69877cda3b323c2da3a26f32c48e1111e61fed45,added,0,"@Value(""${automatically.merge.like.items}"")"
976827bfaa55b4184eeb54f618949801fab5900f,69877cda3b323c2da3a26f32c48e1111e61fed45,added,0,protected boolean automaticallyMergeLikeItems;
976827bfaa55b4184eeb54f618949801fab5900f,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,protected boolean automaticallyMergeLikeItems = true;
976827bfaa55b4184eeb54f618949801fab5900f,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,if (!automaticallyMergeLikeItems) {
976827bfaa55b4184eeb54f618949801fab5900f,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"throw new UnsupportedOperationException(""At this time, OrderService only supports merging like items in the cart"");"
976827bfaa55b4184eeb54f618949801fab5900f,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,}
6294e896809d53e99090c8c129f79a80558938dd,7052c0ab3292e727ef82a25889c137aea193962d,added,0,Money totalAdjustmentValue = BroadleafCurrencyUtils.getMoney(getOrder().getCurrency());
6294e896809d53e99090c8c129f79a80558938dd,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,Money totalAdjustmentValue = BroadleafCurrencyUtils.getMoney(order.getCurrency());
641c2cb43e8be200422cca45750ae174f2c5de79,653f26f092fd84f43466f04d9cfa71757e9608e2,added,0,Thread.currentThread().setContextClassLoader(this.getClass().getClassLoader());
641c2cb43e8be200422cca45750ae174f2c5de79,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.apache.tools.ant.AntClassLoader;
641c2cb43e8be200422cca45750ae174f2c5de79,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,AntClassLoader loader;
641c2cb43e8be200422cca45750ae174f2c5de79,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,loader = getProject().createClassLoader(classPath);
641c2cb43e8be200422cca45750ae174f2c5de79,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,ClassLoader classLoader = this.getClass().getClassLoader();
641c2cb43e8be200422cca45750ae174f2c5de79,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"loader.setParent(classLoader); // if this is not set, classes from the taskdef cannot be found - which is crucial for e.g. annotations."
641c2cb43e8be200422cca45750ae174f2c5de79,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,loader.setThreadContextLoader();
641c2cb43e8be200422cca45750ae174f2c5de79,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,} finally {
641c2cb43e8be200422cca45750ae174f2c5de79,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,if (loader != null) {
641c2cb43e8be200422cca45750ae174f2c5de79,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,loader.resetThreadContextLoader();
641c2cb43e8be200422cca45750ae174f2c5de79,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,loader.cleanup();
641c2cb43e8be200422cca45750ae174f2c5de79,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,}
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,added,0,import javax.persistence.MapKey;
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,added,0,"@OneToMany(mappedBy = ""category"", targetEntity = CategoryAttributeImpl.class, cascade = {CascadeType.ALL}, orphanRemoval = true)"
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,added,0,"@MapKey(name=""name"")"
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,added,0,"@AdminPresentationMap(friendlyName = ""categoryAttributesTitle"","
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,added,0,"tab = Presentation.Tab.Name.Advanced, tabOrder = Presentation.Tab.Order.Advanced,"
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,added,0,"deleteEntityUponRemove = true, forceFreeFormKeys = true, keyPropertyFriendlyName = ""ProductAttributeImpl_Attribute_Name"""
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,added,0,)
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,added,0,"protected Map<String, CategoryAttribute> categoryAttributes = new HashMap<String, CategoryAttribute>();"
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,added,0,"public Map<String, CategoryAttribute> getCategoryAttributesMap() {"
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,added,0,@Override
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,added,0,"public void setCategoryAttributesMap(Map<String, CategoryAttribute> categoryAttributes) {"
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,added,0,this.categoryAttributes = categoryAttributes;
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,added,0,}
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,added,0,public List<CategoryAttribute> getCategoryAttributes() {
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,added,0,List<CategoryAttribute> ca = new ArrayList<CategoryAttribute>(categoryAttributes.values());
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,added,0,return Collections.unmodifiableList(ca);
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,added,0,"this.categoryAttributes = new HashMap<String, CategoryAttribute>();"
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,added,0,for (CategoryAttribute categoryAttribute : categoryAttributes) {
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,added,0,"this.categoryAttributes.put(categoryAttribute.getName(), categoryAttribute);"
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentationCollection;
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,deleted,1,import org.broadleafcommerce.common.presentation.client.AddMethodType;
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,deleted,1,"@OneToMany(mappedBy = ""category"", targetEntity = CategoryAttributeImpl.class, cascade = {CascadeType.ALL})"
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,deleted,1,"@Cascade(value={org.hibernate.annotations.CascadeType.ALL, org.hibernate.annotations.CascadeType.DELETE_ORPHAN})"
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,deleted,1,"@AdminPresentationCollection(addType = AddMethodType.PERSIST, friendlyName = ""categoryAttributesTitle"","
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,deleted,1,"order = 87,"
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,deleted,1,"tab = Presentation.Tab.Name.Advanced, tabOrder = Presentation.Tab.Order.Advanced)"
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,deleted,1,protected List<CategoryAttribute> categoryAttributes  = new ArrayList<CategoryAttribute>();
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,deleted,1,public List<CategoryAttribute> getCategoryAttributes() {
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,deleted,1,this.categoryAttributes = categoryAttributes;
8f5ba210f06aebdc1db085d9094cdf5e4ab0a156,b48c5009699437454c35f75c6abf23895ce3bf10,deleted,1,}
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import org.broadleafcommerce.openadmin.dto.FieldMetadata;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"@Resource(name = ""blDynamicFieldPersistenceHandlerHelper"")"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,protected DynamicFieldPersistenceHandlerHelper dynamicFieldUtil;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"Property[] properties = dynamicFieldUtil.buildDynamicPropertyList(template.getFieldGroups(), PageTemplateImpl.class);"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (pageField == null) {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"value = """";"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,} else {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,}
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"Property[] properties = dynamicFieldUtil.buildDynamicPropertyList(page.getPageTemplate().getFieldGroups(), PageTemplateImpl.class);"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"Map<String, FieldMetadata> md = new HashMap<String, FieldMetadata>();"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,for (Property property : properties) {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"md.put(property.getName(), property.getMetadata());"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"boolean validated = helper.validate(persistencePackage.getEntity(), null, md);"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (!validated) {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,return persistencePackage.getEntity();
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import org.apache.commons.collections.CollectionUtils;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import org.broadleafcommerce.cms.field.domain.FieldEnumerationItem;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import org.broadleafcommerce.common.presentation.ConfigurationItem;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import org.broadleafcommerce.common.presentation.client.SupportedFieldType;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import org.broadleafcommerce.common.presentation.client.VisibilityEnum;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import org.broadleafcommerce.openadmin.dto.BasicFieldMetadata;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import org.broadleafcommerce.openadmin.dto.MergedPropertyType;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.Arrays;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.Comparator;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,int groupCount = 1;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,int fieldCount = 0;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,List<Property> propertiesList = new ArrayList<Property>();
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,List<FieldGroup> groups = template.getFieldGroups();
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,for (FieldGroup group : groups) {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,List<FieldDefinition> definitions = group.getFieldDefinitions();
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,for (FieldDefinition definition : definitions) {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,Property property = new Property();
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,property.setName(definition.getName());
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,BasicFieldMetadata fieldMetadata = new BasicFieldMetadata();
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,property.setMetadata(fieldMetadata);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setFieldType(definition.getFieldType());
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setMutable(true);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setInheritedFromType(PageTemplateImpl.class.getName());
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setAvailableToTypes(new String[] {PageTemplateImpl.class.getName()});
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setForeignKeyCollection(false);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setMergedPropertyType(MergedPropertyType.PRIMARY);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setLength(definition.getMaxLength());
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (definition.getFieldEnumeration() != null && !CollectionUtils.isEmpty(definition.getFieldEnumeration().getEnumerationItems())) {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,int count = definition.getFieldEnumeration().getEnumerationItems().size();
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,String[][] enumItems = new String[count][2];
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,for (int j=0;j<count;j++) {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,FieldEnumerationItem item = definition.getFieldEnumeration().getEnumerationItems().get(j);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,enumItems[j][0] = item.getName();
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,enumItems[j][1] = item.getFriendlyName();
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,}
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setEnumerationValues(enumItems);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setName(definition.getName());
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setFriendlyName(definition.getFriendlyName());
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"fieldMetadata.setSecurityLevel(definition.getSecurityLevel()==null?"""":definition.getSecurityLevel());"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setOrder(fieldCount++);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setVisibility(definition.getHiddenFlag()?VisibilityEnum.HIDDEN_ALL:VisibilityEnum.VISIBLE_ALL);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setGroup(group.getName());
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setGroupOrder(groupCount);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"fieldMetadata.setTab(""General"");"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setTabOrder(100);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setGroupCollapsed(group.getInitCollapsedFlag());
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setExplicitFieldType(SupportedFieldType.UNKNOWN);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setLargeEntry(definition.getTextAreaFlag());
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setProminent(false);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setColumnWidth(String.valueOf(definition.getColumnWidth()));
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"fieldMetadata.setBroadleafEnumeration("""");"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setReadOnly(false);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (definition.getValidationRegEx() != null) {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"Map<String, String> itemMap = new HashMap<String, String>();"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"itemMap.put(""regularExpression"", definition.getValidationRegEx());"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"itemMap.put(ConfigurationItem.ERROR_MESSAGE, definition.getValidationErrorMesageKey());"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"fieldMetadata.getValidationConfigurations().put(""org.broadleafcommerce.openadmin.server.service.persistence.validation.RegexPropertyValidator"", itemMap);"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,propertiesList.add(property);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,groupCount++;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldCount = 0;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"property.setName(""id"");"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setFieldType(SupportedFieldType.ID);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setSecondaryType(SupportedFieldType.INTEGER);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setAvailableToTypes(new String[] { PageTemplateImpl.class.getName() });
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"fieldMetadata.setName(""id"");"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"fieldMetadata.setFriendlyName(""PageTemplateCustomPersistenceHandler_ID"");"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"fieldMetadata.setSecurityLevel("""");"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setVisibility(VisibilityEnum.HIDDEN_ALL);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setLargeEntry(false);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"fieldMetadata.setColumnWidth(""*"");"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setReadOnly(true);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,Property[] properties = new Property[propertiesList.size()];
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,properties = propertiesList.toArray(properties);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"Arrays.sort(properties, new Comparator<Property>() {"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,@Override
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"public int compare(Property o1, Property o2) {"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,/*
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"* First, compare properties based on order fields"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,*/
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (o1.getMetadata().getOrder() != null && o2.getMetadata().getOrder() != null) {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,return o1.getMetadata().getOrder().compareTo(o2.getMetadata().getOrder());
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,} else if (o1.getMetadata().getOrder() != null && o2.getMetadata().getOrder() == null) {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,* Always favor fields that have an order identified
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,return -1;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,} else if (o1.getMetadata().getOrder() == null && o2.getMetadata().getOrder() != null) {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,return 1;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,} else if (o1.getMetadata().getFriendlyName() != null && o2.getMetadata().getFriendlyName() != null) {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,return o1.getMetadata().getFriendlyName().compareTo(o2.getMetadata().getFriendlyName());
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,} else {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,return o1.getName().compareTo(o2.getName());
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,});
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if(pageField==null)
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"value="""";"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,else
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import org.broadleafcommerce.openadmin.dto.FieldMetadata;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"@Resource(name = ""blDynamicFieldPersistenceHandlerHelper"")"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,protected DynamicFieldPersistenceHandlerHelper dynamicFieldUtil;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"Property[] properties = dynamicFieldUtil.buildDynamicPropertyList(structuredContentType.getStructuredContentFieldTemplate().getFieldGroups(), StructuredContentTypeImpl.class);"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (structuredContentField != null) {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,value = structuredContentField.getValue();
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,}
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,/**
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,* Invoked when {@link StructuredContent} is saved in order to fill out the dynamic form for the structured content type
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,*/
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"Property[] properties = dynamicFieldUtil.buildDynamicPropertyList(structuredContent.getStructuredContentType().getStructuredContentFieldTemplate().getFieldGroups(), StructuredContentTypeImpl.class);"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"Map<String, FieldMetadata> md = new HashMap<String, FieldMetadata>();"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,for (Property property : properties) {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"md.put(property.getName(), property.getMetadata());"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"boolean validated = helper.validate(persistencePackage.getEntity(), null, md);"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (!validated) {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,return persistencePackage.getEntity();
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import org.apache.commons.collections.CollectionUtils;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import org.broadleafcommerce.cms.field.domain.FieldEnumerationItem;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import org.broadleafcommerce.common.presentation.ConfigurationItem;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import org.broadleafcommerce.common.presentation.client.SupportedFieldType;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import org.broadleafcommerce.common.presentation.client.VisibilityEnum;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import org.broadleafcommerce.openadmin.dto.BasicFieldMetadata;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import org.broadleafcommerce.openadmin.dto.MergedPropertyType;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.Arrays;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.Comparator;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,int groupCount = 1;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,int fieldCount = 0;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,List<Property> propertiesList = new ArrayList<Property>();
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,List<FieldGroup> groups = structuredContentType.getStructuredContentFieldTemplate().getFieldGroups();
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,for (FieldGroup group : groups) {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,List<FieldDefinition> definitions = group.getFieldDefinitions();
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,for (FieldDefinition definition : definitions) {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,Property property = new Property();
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,property.setName(definition.getName());
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,BasicFieldMetadata fieldMetadata = new BasicFieldMetadata();
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,property.setMetadata(fieldMetadata);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setFieldType(definition.getFieldType());
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setMutable(true);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setInheritedFromType(StructuredContentTypeImpl.class.getName());
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setAvailableToTypes(new String[] {StructuredContentTypeImpl.class.getName()});
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setForeignKeyCollection(false);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setMergedPropertyType(MergedPropertyType.PRIMARY);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setLength(definition.getMaxLength());
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (definition.getFieldEnumeration() != null && !CollectionUtils.isEmpty(definition.getFieldEnumeration().getEnumerationItems())) {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,int count = definition.getFieldEnumeration().getEnumerationItems().size();
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,String[][] enumItems = new String[count][2];
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,for (int j=0;j<count;j++) {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,FieldEnumerationItem item = definition.getFieldEnumeration().getEnumerationItems().get(j);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,enumItems[j][0] = item.getName();
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,enumItems[j][1] = item.getFriendlyName();
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,}
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setEnumerationValues(enumItems);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setName(definition.getName());
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setFriendlyName(definition.getFriendlyName());
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"fieldMetadata.setSecurityLevel(definition.getSecurityLevel()==null?"""":definition.getSecurityLevel());"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setOrder(fieldCount++);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setVisibility(definition.getHiddenFlag()?VisibilityEnum.HIDDEN_ALL:VisibilityEnum.VISIBLE_ALL);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setGroup(group.getName());
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setGroupOrder(groupCount);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"fieldMetadata.setTab(""General"");"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setTabOrder(100);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setGroupCollapsed(group.getInitCollapsedFlag());
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setExplicitFieldType(SupportedFieldType.UNKNOWN);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setLargeEntry(definition.getTextAreaFlag());
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setProminent(false);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setColumnWidth(String.valueOf(definition.getColumnWidth()));
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"fieldMetadata.setBroadleafEnumeration("""");"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setReadOnly(false);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (definition.getValidationRegEx() != null) {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"Map<String, String> itemMap = new HashMap<String, String>();"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"itemMap.put(""regularExpression"", definition.getValidationRegEx());"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"itemMap.put(ConfigurationItem.ERROR_MESSAGE, definition.getValidationErrorMesageKey());"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"fieldMetadata.getValidationConfigurations().put(""org.broadleafcommerce.openadmin.server.service.persistence.validation.RegexPropertyValidator"", itemMap);"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,propertiesList.add(property);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,groupCount++;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldCount = 0;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"property.setName(""id"");"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setFieldType(SupportedFieldType.ID);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setSecondaryType(SupportedFieldType.INTEGER);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"fieldMetadata.setName(""id"");"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"fieldMetadata.setFriendlyName(""StructuredContentTypeCustomPersistenceHandler_ID"");"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"fieldMetadata.setSecurityLevel("""");"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setVisibility(VisibilityEnum.HIDDEN_ALL);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setLargeEntry(false);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"fieldMetadata.setColumnWidth(""*"");"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,fieldMetadata.setReadOnly(true);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,Property[] properties = new Property[propertiesList.size()];
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,properties = propertiesList.toArray(properties);
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"Arrays.sort(properties, new Comparator<Property>() {"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,@Override
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"public int compare(Property o1, Property o2) {"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,/*
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"* First, compare properties based on order fields"
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,*/
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (o1.getMetadata().getOrder() != null && o2.getMetadata().getOrder() != null) {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,return o1.getMetadata().getOrder().compareTo(o2.getMetadata().getOrder());
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,} else if (o1.getMetadata().getOrder() != null && o2.getMetadata().getOrder() == null) {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,* Always favor fields that have an order identified
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,return -1;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,} else if (o1.getMetadata().getOrder() == null && o2.getMetadata().getOrder() != null) {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,return 1;
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,} else if (o1.getMetadata().getFriendlyName() != null && o2.getMetadata().getFriendlyName() != null) {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,return o1.getMetadata().getFriendlyName().compareTo(o2.getMetadata().getFriendlyName());
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,} else {
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,return o1.getName().compareTo(o2.getName());
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,});
558c205d1c77bfa5b1b7f8d1d2da8311893db0a3,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,value = structuredContentField.getValue();
d20ee30abfd651429ded7a8b5ca1e07915715379,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,if (p.getMetadata() instanceof BasicFieldMetadata) {
d20ee30abfd651429ded7a8b5ca1e07915715379,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,((BasicFieldMetadata) p.getMetadata()).setVisibility(VisibilityEnum.VISIBLE_ALL);
d20ee30abfd651429ded7a8b5ca1e07915715379,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,entityFormProperties.add(p);
d20ee30abfd651429ded7a8b5ca1e07915715379,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,}
d20ee30abfd651429ded7a8b5ca1e07915715379,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,((BasicFieldMetadata) p.getMetadata()).setVisibility(VisibilityEnum.VISIBLE_ALL);
d20ee30abfd651429ded7a8b5ca1e07915715379,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,entityFormProperties.add(p);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import org.broadleafcommerce.openadmin.server.service.persistence.PersistenceResponse;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,public PersistenceResponse getClassMetadata(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,public PersistenceResponse getRecords(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public PersistenceResponse getRecord(PersistencePackageRequest request, String id, ClassMetadata cmd, boolean isCollectionRequest)"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public PersistenceResponse addEntity(EntityForm entityForm, String[] customCriteria)"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public PersistenceResponse updateEntity(EntityForm entityForm, String[] customCriteria)"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public PersistenceResponse removeEntity(EntityForm entityForm, String[] customCriteria)"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public PersistenceResponse getAdvancedCollectionRecord(ClassMetadata containingClassMetadata, Entity containingEntity,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public PersistenceResponse getRecordsForCollection(ClassMetadata containingClassMetadata, Entity containingEntity,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,* @return the PersistenceResponse
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public PersistenceResponse addSubCollectionEntity(EntityForm entityForm, ClassMetadata mainMetadata, Property field,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public PersistenceResponse updateSubCollectionEntity(EntityForm entityForm, ClassMetadata mainMetadata, Property field,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public PersistenceResponse removeSubCollectionEntity(ClassMetadata mainMetadata, Property field, Entity parentEntity, String itemId,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,public ClassMetadata getClassMetadata(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,public DynamicResultSet getRecords(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"public Entity getRecord(PersistencePackageRequest request, String id, ClassMetadata cmd, boolean isCollectionRequest)"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"public Entity addEntity(EntityForm entityForm, String[] customCriteria)"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"public Entity updateEntity(EntityForm entityForm, String[] customCriteria)"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"public void removeEntity(EntityForm entityForm, String[] customCriteria)"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"public Entity getAdvancedCollectionRecord(ClassMetadata containingClassMetadata, Entity containingEntity,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"public DynamicResultSet getRecordsForCollection(ClassMetadata containingClassMetadata, Entity containingEntity,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,* @return the DynamicResultSet
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"public Entity addSubCollectionEntity(EntityForm entityForm, ClassMetadata mainMetadata, Property field,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"public Entity updateSubCollectionEntity(EntityForm entityForm, ClassMetadata mainMetadata, Property field,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"public void removeSubCollectionEntity(ClassMetadata mainMetadata, Property field, Entity parentEntity, String itemId,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import org.broadleafcommerce.openadmin.server.service.persistence.PersistenceResponse;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import javax.annotation.Resource;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import javax.persistence.NoResultException;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,public PersistenceResponse getClassMetadata(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,PersistenceResponse response = inspect(request);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,ClassMetadata cmd = response.getDynamicResultSet().getClassMetaData();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,return response;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,public PersistenceResponse getRecords(PersistencePackageRequest request) throws ServiceException {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public PersistenceResponse getRecord(PersistencePackageRequest request, String id, ClassMetadata cmd, boolean isCollectionRequest)"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,PersistenceResponse response = fetch(request);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,Entity[] entities = response.getDynamicResultSet().getRecords();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public PersistenceResponse addEntity(EntityForm entityForm, String[] customCriteria)"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public PersistenceResponse updateEntity(EntityForm entityForm, String[] customCriteria)"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,Entity dynamicFormEntity = update(ppr).getEntity();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,PersistenceResponse response = update(ppr);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public PersistenceResponse removeEntity(EntityForm entityForm, String[] customCriteria)"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,return remove(ppr);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public PersistenceResponse getAdvancedCollectionRecord(ClassMetadata containingClassMetadata, Entity containingEntity,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,PersistenceResponse response;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,response = fetch(ppr);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,response.setEntity(e);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,if (response == null) {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public PersistenceResponse getRecordsForCollection(ClassMetadata containingClassMetadata, Entity containingEntity,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,PersistenceResponse response = getClassMetadata(ppr);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"PersistenceResponse response2 = getRecordsForCollection(cmd, containingEntity, p, null, null, null);"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"map.put(p.getName(), response2.getDynamicResultSet());"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public PersistenceResponse addSubCollectionEntity(EntityForm entityForm, ClassMetadata mainMetadata, Property field,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,ppr.setSectionEntityClassname(mainMetadata.getCeilingType());
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"ppr.setSectionEntityIdValue(getContextSpecificRelationshipId(mainMetadata, parentEntity, """"));"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"String sectionField = """";"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"if (sectionField.contains(""."")) {"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"sectionField = sectionField.substring(0, sectionField.lastIndexOf("".""));"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,}
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,ppr.setSectionEntityField(sectionField);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public PersistenceResponse updateSubCollectionEntity(EntityForm entityForm, ClassMetadata mainMetadata, Property field,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public PersistenceResponse removeSubCollectionEntity(ClassMetadata mainMetadata, Property field, Entity parentEntity, String itemId,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,protected PersistenceResponse add(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,protected PersistenceResponse update(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,protected PersistenceResponse inspect(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,protected PersistenceResponse remove(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,return service.remove(pkg);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,protected PersistenceResponse fetch(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,import javax.annotation.Resource;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,import javax.persistence.NoResultException;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,public ClassMetadata getClassMetadata(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,ClassMetadata cmd = inspect(request).getClassMetaData();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,return cmd;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,public DynamicResultSet getRecords(PersistencePackageRequest request) throws ServiceException {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"public Entity getRecord(PersistencePackageRequest request, String id, ClassMetadata cmd, boolean isCollectionRequest)"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,Entity[] entities = fetch(request).getRecords();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,Entity entity = entities[0];
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,return entity;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"public Entity addEntity(EntityForm entityForm, String[] customCriteria)"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"public Entity updateEntity(EntityForm entityForm, String[] customCriteria)"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,Entity dynamicFormEntity = update(ppr);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,Entity returnEntity = update(ppr);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,return returnEntity;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"public void removeEntity(EntityForm entityForm, String[] customCriteria)"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,remove(ppr);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"public Entity getAdvancedCollectionRecord(ClassMetadata containingClassMetadata, Entity containingEntity,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,Entity entity = null;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,Entity[] entities = fetch(ppr).getRecords();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,entity = entities[0];
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,entity = e;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,if (entity == null) {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"public DynamicResultSet getRecordsForCollection(ClassMetadata containingClassMetadata, Entity containingEntity,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,ClassMetadata cmd = getClassMetadata(ppr);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"DynamicResultSet drs = getRecordsForCollection(cmd, containingEntity, p, null, null, null);"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"map.put(p.getName(), drs);"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"public Entity addSubCollectionEntity(EntityForm entityForm, ClassMetadata mainMetadata, Property field,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"public Entity updateSubCollectionEntity(EntityForm entityForm, ClassMetadata mainMetadata, Property field,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"public void removeSubCollectionEntity(ClassMetadata mainMetadata, Property field, Entity parentEntity, String itemId,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,protected Entity add(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,protected Entity update(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,protected DynamicResultSet inspect(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,protected void remove(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,service.remove(pkg);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,protected DynamicResultSet fetch(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,}
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import org.broadleafcommerce.openadmin.server.service.persistence.PersistenceResponse;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import javax.annotation.Resource;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import javax.persistence.NoResultException;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,public PersistenceResponse getClassMetadata(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,PersistenceResponse response = inspect(request);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,ClassMetadata cmd = response.getDynamicResultSet().getClassMetaData();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,return response;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,public PersistenceResponse getRecords(PersistencePackageRequest request) throws ServiceException {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"public PersistenceResponse getRecord(PersistencePackageRequest request, String id, ClassMetadata cmd, boolean isCollectionRequest)"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,PersistenceResponse response = fetch(request);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,Entity[] entities = response.getDynamicResultSet().getRecords();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"public PersistenceResponse addEntity(EntityForm entityForm, String[] customCriteria)"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"public PersistenceResponse updateEntity(EntityForm entityForm, String[] customCriteria)"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,Entity dynamicFormEntity = update(ppr).getEntity();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,PersistenceResponse response = update(ppr);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"public PersistenceResponse removeEntity(EntityForm entityForm, String[] customCriteria)"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,return remove(ppr);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"public PersistenceResponse getAdvancedCollectionRecord(ClassMetadata containingClassMetadata, Entity containingEntity,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,PersistenceResponse response;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,response = fetch(ppr);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,response.setEntity(e);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,if (response == null) {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"public PersistenceResponse getRecordsForCollection(ClassMetadata containingClassMetadata, Entity containingEntity,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,PersistenceResponse response = getClassMetadata(ppr);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"PersistenceResponse response2 = getRecordsForCollection(cmd, containingEntity, p, null, null, null);"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"map.put(p.getName(), response2.getDynamicResultSet());"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"public PersistenceResponse addSubCollectionEntity(EntityForm entityForm, ClassMetadata mainMetadata, Property field,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,ppr.setSectionEntityClassname(mainMetadata.getCeilingType());
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"ppr.setSectionEntityIdValue(getContextSpecificRelationshipId(mainMetadata, parentEntity, """"));"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"String sectionField = """";"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"if (sectionField.contains(""."")) {"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"sectionField = sectionField.substring(0, sectionField.lastIndexOf("".""));"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,}
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,ppr.setSectionEntityField(sectionField);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"public PersistenceResponse updateSubCollectionEntity(EntityForm entityForm, ClassMetadata mainMetadata, Property field,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"public PersistenceResponse removeSubCollectionEntity(ClassMetadata mainMetadata, Property field, Entity parentEntity, String itemId,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,protected PersistenceResponse add(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,protected PersistenceResponse update(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,protected PersistenceResponse inspect(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,protected PersistenceResponse remove(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,return service.remove(pkg);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,protected PersistenceResponse fetch(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import javax.annotation.Resource;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import javax.persistence.NoResultException;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,public ClassMetadata getClassMetadata(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,ClassMetadata cmd = inspect(request).getClassMetaData();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,return cmd;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,public DynamicResultSet getRecords(PersistencePackageRequest request) throws ServiceException {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"public Entity getRecord(PersistencePackageRequest request, String id, ClassMetadata cmd, boolean isCollectionRequest)"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,Entity[] entities = fetch(request).getRecords();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,Entity entity = entities[0];
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,return entity;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"public Entity addEntity(EntityForm entityForm, String[] customCriteria)"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"public Entity updateEntity(EntityForm entityForm, String[] customCriteria)"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,Entity dynamicFormEntity = update(ppr);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,Entity returnEntity = update(ppr);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,return returnEntity;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"public void removeEntity(EntityForm entityForm, String[] customCriteria)"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,remove(ppr);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"public Entity getAdvancedCollectionRecord(ClassMetadata containingClassMetadata, Entity containingEntity,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,Entity entity = null;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,Entity[] entities = fetch(ppr).getRecords();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,entity = entities[0];
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,entity = e;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,if (entity == null) {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"public DynamicResultSet getRecordsForCollection(ClassMetadata containingClassMetadata, Entity containingEntity,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,ClassMetadata cmd = getClassMetadata(ppr);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"DynamicResultSet drs = getRecordsForCollection(cmd, containingEntity, p, null, null, null);"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"map.put(p.getName(), drs);"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"public Entity addSubCollectionEntity(EntityForm entityForm, ClassMetadata mainMetadata, Property field,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"public Entity updateSubCollectionEntity(EntityForm entityForm, ClassMetadata mainMetadata, Property field,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"public void removeSubCollectionEntity(ClassMetadata mainMetadata, Property field, Entity parentEntity, String itemId,"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,protected Entity add(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,protected Entity update(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,protected DynamicResultSet inspect(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,protected void remove(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,service.remove(pkg);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,protected DynamicResultSet fetch(PersistencePackageRequest request)
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,}
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,added,0,import org.broadleafcommerce.openadmin.server.service.persistence.PersistenceResponse;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,added,0,import javax.annotation.Resource;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,added,0,public PersistenceResponse inspect(PersistencePackage persistencePackage) throws ServiceException {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,added,0,"public PersistenceResponse fetch(PersistencePackage persistencePackage, CriteriaTransferObject cto) throws ServiceException {"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,added,0,public PersistenceResponse add(PersistencePackage persistencePackage) throws ServiceException {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,added,0,return new PersistenceResponse().withEntity(persistencePackage.getEntity());
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,added,0,return new PersistenceResponse().withEntity(((ValidationException) e).getEntity());
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,added,0,return new PersistenceResponse().withEntity(((ValidationException) e.getCause()).getEntity());
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,added,0,public PersistenceResponse update(PersistencePackage persistencePackage) throws ServiceException {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,added,0,public PersistenceResponse remove(PersistencePackage persistencePackage) throws ServiceException {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,added,0,return persistenceManager.remove(persistencePackage);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,import org.broadleafcommerce.openadmin.dto.DynamicResultSet;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,import javax.annotation.Resource;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,/*@Override
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,public BatchDynamicResultSet batchInspect(BatchPersistencePackage batchPersistencePackage) throws ServiceException {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,try {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,List<DynamicResultSet> dynamicResultSetList = new ArrayList<DynamicResultSet>(15);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,List<PersistencePackage> persistencePackageList;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,boolean containsCache = false;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,if (METADATA_CACHE.containsKey(batchPersistencePackage)) {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,containsCache = true;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,persistencePackageList = new ArrayList<PersistencePackage>();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,for (PersistencePackage persistencePackage : batchPersistencePackage.getPersistencePackages()) {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,if (persistencePackage.getPersistencePerspective().getUseServerSideInspectionCache()) {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,checkResultSetList: {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,for (DynamicResultSet dynamicResultSet : METADATA_CACHE.get(batchPersistencePackage).getDynamicResultSets()) {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,if (dynamicResultSet.getBatchId().equals(persistencePackage.getBatchId())) {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,dynamicResultSetList.add(dynamicResultSet);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,break checkResultSetList;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,}
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,"throw new IllegalArgumentException(""Unable to find a result for batchId("" + persistencePackage.getBatchId() + "") in cached batch result set."");"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,} else {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,persistencePackageList.add(persistencePackage);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,persistencePackageList = Arrays.asList(batchPersistencePackage.getPersistencePackages());
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,for (PersistencePackage persistencePackage : persistencePackageList) {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,DynamicResultSet resultSet = inspect(persistencePackage);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,resultSet.setBatchId(persistencePackage.getBatchId());
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,dynamicResultSetList.add(resultSet);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,"Collections.sort(dynamicResultSetList, new Comparator<DynamicResultSet>() {"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,@Override
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,"public int compare(DynamicResultSet o1, DynamicResultSet o2) {"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,return o1.getBatchId().compareTo(o2.getBatchId());
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,});
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,BatchDynamicResultSet batchResults = new BatchDynamicResultSet();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,batchResults.setDynamicResultSets(dynamicResultSetList.toArray(new DynamicResultSet[dynamicResultSetList.size()]));
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,if (!containsCache) {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,"METADATA_CACHE.put(batchPersistencePackage, batchResults);"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,return METADATA_CACHE.get(batchPersistencePackage);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,return batchResults;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,} catch (IllegalArgumentException e) {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,"LOG.error(""Problem performing batch inspect"", e);"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,"throw new ServiceException(""Problem performing batch inspect"", e);"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,}*/
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,public DynamicResultSet inspect(PersistencePackage persistencePackage) throws ServiceException {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,"public DynamicResultSet fetch(PersistencePackage persistencePackage, CriteriaTransferObject cto) throws ServiceException {"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,public Entity add(PersistencePackage persistencePackage) throws ServiceException {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,return persistencePackage.getEntity();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,return ((ValidationException) e).getEntity();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,return ((ValidationException) e.getCause()).getEntity();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,public Entity update(PersistencePackage persistencePackage) throws ServiceException {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,public void remove(PersistencePackage persistencePackage) throws ServiceException {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,persistenceManager.remove(persistencePackage);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,added,0,import org.broadleafcommerce.openadmin.server.service.persistence.PersistenceResponse;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,added,0,import javax.annotation.Resource;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,added,0,public PersistenceResponse inspect(PersistencePackage persistencePackage) throws ServiceException {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,added,0,"public PersistenceResponse fetch(PersistencePackage persistencePackage, CriteriaTransferObject cto) throws ServiceException {"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,added,0,public PersistenceResponse add(PersistencePackage persistencePackage) throws ServiceException {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,added,0,return new PersistenceResponse().withEntity(persistencePackage.getEntity());
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,added,0,return new PersistenceResponse().withEntity(((ValidationException) e).getEntity());
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,added,0,return new PersistenceResponse().withEntity(((ValidationException) e.getCause()).getEntity());
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,added,0,public PersistenceResponse update(PersistencePackage persistencePackage) throws ServiceException {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,added,0,public PersistenceResponse remove(PersistencePackage persistencePackage) throws ServiceException {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,added,0,return persistenceManager.remove(persistencePackage);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,import org.broadleafcommerce.openadmin.dto.DynamicResultSet;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,import javax.annotation.Resource;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,/*@Override
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,public BatchDynamicResultSet batchInspect(BatchPersistencePackage batchPersistencePackage) throws ServiceException {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,try {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,List<DynamicResultSet> dynamicResultSetList = new ArrayList<DynamicResultSet>(15);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,List<PersistencePackage> persistencePackageList;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,boolean containsCache = false;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,if (METADATA_CACHE.containsKey(batchPersistencePackage)) {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,containsCache = true;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,persistencePackageList = new ArrayList<PersistencePackage>();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,for (PersistencePackage persistencePackage : batchPersistencePackage.getPersistencePackages()) {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,if (persistencePackage.getPersistencePerspective().getUseServerSideInspectionCache()) {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,checkResultSetList: {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,for (DynamicResultSet dynamicResultSet : METADATA_CACHE.get(batchPersistencePackage).getDynamicResultSets()) {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,if (dynamicResultSet.getBatchId().equals(persistencePackage.getBatchId())) {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,dynamicResultSetList.add(dynamicResultSet);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,break checkResultSetList;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,}
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,"throw new IllegalArgumentException(""Unable to find a result for batchId("" + persistencePackage.getBatchId() + "") in cached batch result set."");"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,} else {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,persistencePackageList.add(persistencePackage);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,persistencePackageList = Arrays.asList(batchPersistencePackage.getPersistencePackages());
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,for (PersistencePackage persistencePackage : persistencePackageList) {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,DynamicResultSet resultSet = inspect(persistencePackage);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,resultSet.setBatchId(persistencePackage.getBatchId());
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,dynamicResultSetList.add(resultSet);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,"Collections.sort(dynamicResultSetList, new Comparator<DynamicResultSet>() {"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,@Override
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,"public int compare(DynamicResultSet o1, DynamicResultSet o2) {"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,return o1.getBatchId().compareTo(o2.getBatchId());
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,});
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,BatchDynamicResultSet batchResults = new BatchDynamicResultSet();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,batchResults.setDynamicResultSets(dynamicResultSetList.toArray(new DynamicResultSet[dynamicResultSetList.size()]));
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,if (!containsCache) {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,"METADATA_CACHE.put(batchPersistencePackage, batchResults);"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,return METADATA_CACHE.get(batchPersistencePackage);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,return batchResults;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,} catch (IllegalArgumentException e) {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,"LOG.error(""Problem performing batch inspect"", e);"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,"throw new ServiceException(""Problem performing batch inspect"", e);"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,}*/
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,public DynamicResultSet inspect(PersistencePackage persistencePackage) throws ServiceException {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,"public DynamicResultSet fetch(PersistencePackage persistencePackage, CriteriaTransferObject cto) throws ServiceException {"
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,public Entity add(PersistencePackage persistencePackage) throws ServiceException {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,return persistencePackage.getEntity();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,return ((ValidationException) e).getEntity();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,return ((ValidationException) e.getCause()).getEntity();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,public Entity update(PersistencePackage persistencePackage) throws ServiceException {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,public void remove(PersistencePackage persistencePackage) throws ServiceException {
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,persistenceManager.remove(persistencePackage);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import javax.annotation.Resource;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,ClassMetadata cmd = adminEntityService.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,Entity[] rows = adminEntityService.getRecords(toOnePpr).getDynamicResultSet().getRecords();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,ClassMetadata foreignClassMd = adminEntityService.getClassMetadata(toOnePpr).getDynamicResultSet().getClassMetaData();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,ClassMetadata collectionMetadata = adminEntityService.getClassMetadata(request).getDynamicResultSet().getClassMetaData();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,DynamicResultSet drs = adminEntityService.getRecords(ppr).getDynamicResultSet();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import javax.annotation.Resource;
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,ClassMetadata cmd = adminEntityService.getClassMetadata(ppr);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,Entity[] rows = adminEntityService.getRecords(toOnePpr).getRecords();
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,ClassMetadata foreignClassMd = adminEntityService.getClassMetadata(toOnePpr);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,ClassMetadata collectionMetadata = adminEntityService.getClassMetadata(request);
94da1b806b09c2fdd90d2ce8a36bdfc1bc7c218d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,DynamicResultSet drs = adminEntityService.getRecords(ppr);
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,"public Entity addEntity(EntityForm entityForm, String[] customCriteria)"
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,throws ServiceException {
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,"// If the entity form has dynamic forms inside of it, we need to persist those as well."
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,"// They are typically done in their own custom persistence handlers, which will get triggered"
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,// based on the criteria specific in the PersistencePackage.
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,"for (Entry<String, EntityForm> entry : entityForm.getDynamicForms().entrySet()) {"
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,DynamicEntityFormInfo info = entityForm.getDynamicFormInfo(entry.getKey());
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,customCriteria = new String[] {info.getCriteriaName()};
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,"PersistencePackageRequest subRequest = getRequestForEntityForm(entry.getValue(), customCriteria);"
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,"ppr.addSubRequest(info.getPropertyName(), subRequest);"
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,return add(ppr);
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,"public Entity updateEntity(EntityForm entityForm, String[] customCriteria)"
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,return update(ppr);
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,try {
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,return service.add(pkg);
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,} catch (ValidationException e) {
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,return e.getEntity();
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,}
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,return service.update(pkg);
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,import org.apache.commons.collections.MapUtils;
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,import org.hibernate.ejb.HibernateEntityManager;
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,import org.springframework.transaction.annotation.Transactional;
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,/**
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"* Since the entity form can have multiple dynamic forms defined within it, it should be saved as an all-or-nothing"
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,* approach and roll back when any ServiceExceptions have been thrown in any of the saves.
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,*/
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"@Transactional(value = ""blTransactionManager"", rollbackFor = {ServiceException.class})"
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"public Entity addEntity(EntityForm entityForm, String[] customCriteria) throws ServiceException {"
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,Entity returnEntity = add(ppr);
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"// Once the entity has been saved, we can utilize its id for the subsequent dynamic forms"
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,Class<?> entityClass;
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,try {
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,entityClass = Class.forName(entityForm.getEntityType());
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,} catch (ClassNotFoundException e) {
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,throw new ServiceException(e);
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,}
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"Map<String, Object> idMetadata = dynamicDaoHelper.getIdMetadata(entityClass, (HibernateEntityManager) em);"
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"String idProperty = (String) idMetadata.get(""name"");"
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,entityForm.setId(returnEntity.findProperty(idProperty).getValue());
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"Map<String, List<String>> dynamicFormValidationErrors = new HashMap<String, List<String>>();"
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"persistDynamicForms(entityForm, dynamicFormValidationErrors);"
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,//add all of the validation errors from the dynamic forms to the main entity
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,returnEntity.getValidationErrors().putAll(dynamicFormValidationErrors);
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,if (MapUtils.isNotEmpty(returnEntity.getValidationErrors())) {
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"throw new ValidationException(returnEntity, ""Validation Exception"");"
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,return returnEntity;
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"public Entity updateEntity(EntityForm entityForm, String[] customCriteria) throws ServiceException {"
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,Entity returnEntity = update(ppr);
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"//If there are any validation exceptions, throw a validation exception to ensure that the entire transaction is rolled back"
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,*
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,* @param entityForm the main form that contains the dynamic forms
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,* @param dynamicFormValidationErrors object to store validation errors that appear on dynamic forms
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,* @throws ServiceException
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"protected void persistDynamicForms(EntityForm entityForm,"
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"Map<String, List<String>> dynamicFormValidationErrors) throws ServiceException {"
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,String[] customCriteria;
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"PersistencePackageRequest ppr = getRequestForEntityForm(entry.getValue(), customCriteria);"
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,Entity dynamicFormEntity = update(ppr);
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"//if the dynamic form has failed validation, ensure they are properly added to the main entity validation"
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,//errors and keyed properly
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,if (dynamicFormEntity.isValidationFailure()) {
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"for (Entry<String, List<String>> error : dynamicFormEntity.getValidationErrors().entrySet()) {"
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"dynamicFormValidationErrors.put(info.getPropertyName() + DynamicEntityFormInfo.FIELD_SEPARATOR + error.getKey(), error.getValue());"
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,return service.add(pkg);
67e04eaf91a9e0e607731d7b98b4d7a95a3da3dd,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,return service.update(pkg);
8055947de4c14405bd60d0527ab6fad429727b9a,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import java.util.ArrayList;
8055947de4c14405bd60d0527ab6fad429727b9a,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import java.util.Arrays;
8055947de4c14405bd60d0527ab6fad429727b9a,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import java.util.LinkedHashMap;
8055947de4c14405bd60d0527ab6fad429727b9a,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import java.util.List;
8055947de4c14405bd60d0527ab6fad429727b9a,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import java.util.Map;
8055947de4c14405bd60d0527ab6fad429727b9a,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"protected Map<String, PersistencePackageRequest> subRequests = new LinkedHashMap<String, PersistencePackageRequest>();"
8055947de4c14405bd60d0527ab6fad429727b9a,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public PersistencePackageRequest addSubRequest(String infoPropertyName, PersistencePackageRequest subRequest) {"
8055947de4c14405bd60d0527ab6fad429727b9a,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"subRequests.put(infoPropertyName, subRequest);"
8055947de4c14405bd60d0527ab6fad429727b9a,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,return this;
8055947de4c14405bd60d0527ab6fad429727b9a,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,}
8055947de4c14405bd60d0527ab6fad429727b9a,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public Map<String, PersistencePackageRequest> getSubRequests() {"
8055947de4c14405bd60d0527ab6fad429727b9a,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,return subRequests;
8055947de4c14405bd60d0527ab6fad429727b9a,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public void setSubRequests(Map<String, PersistencePackageRequest> subRequests) {"
8055947de4c14405bd60d0527ab6fad429727b9a,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,this.subRequests = subRequests;
8055947de4c14405bd60d0527ab6fad429727b9a,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,import java.util.ArrayList;
8055947de4c14405bd60d0527ab6fad429727b9a,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,import java.util.Arrays;
8055947de4c14405bd60d0527ab6fad429727b9a,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,import java.util.List;
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,added,0,throw e;
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,added,0,throw (ValidationException) e.getCause();
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,/*@Override
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,public BatchDynamicResultSet batchInspect(BatchPersistencePackage batchPersistencePackage) throws ServiceException {
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,try {
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,List<DynamicResultSet> dynamicResultSetList = new ArrayList<DynamicResultSet>(15);
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,List<PersistencePackage> persistencePackageList;
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,boolean containsCache = false;
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,if (METADATA_CACHE.containsKey(batchPersistencePackage)) {
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,containsCache = true;
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,persistencePackageList = new ArrayList<PersistencePackage>();
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,for (PersistencePackage persistencePackage : batchPersistencePackage.getPersistencePackages()) {
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,if (persistencePackage.getPersistencePerspective().getUseServerSideInspectionCache()) {
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,checkResultSetList: {
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,for (DynamicResultSet dynamicResultSet : METADATA_CACHE.get(batchPersistencePackage).getDynamicResultSets()) {
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,if (dynamicResultSet.getBatchId().equals(persistencePackage.getBatchId())) {
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,dynamicResultSetList.add(dynamicResultSet);
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,break checkResultSetList;
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,}
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,"throw new IllegalArgumentException(""Unable to find a result for batchId("" + persistencePackage.getBatchId() + "") in cached batch result set."");"
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,} else {
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,persistencePackageList.add(persistencePackage);
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,persistencePackageList = Arrays.asList(batchPersistencePackage.getPersistencePackages());
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,for (PersistencePackage persistencePackage : persistencePackageList) {
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,DynamicResultSet resultSet = inspect(persistencePackage);
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,resultSet.setBatchId(persistencePackage.getBatchId());
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,dynamicResultSetList.add(resultSet);
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,"Collections.sort(dynamicResultSetList, new Comparator<DynamicResultSet>() {"
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,@Override
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,"public int compare(DynamicResultSet o1, DynamicResultSet o2) {"
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,return o1.getBatchId().compareTo(o2.getBatchId());
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,});
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,BatchDynamicResultSet batchResults = new BatchDynamicResultSet();
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,batchResults.setDynamicResultSets(dynamicResultSetList.toArray(new DynamicResultSet[dynamicResultSetList.size()]));
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,if (!containsCache) {
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,"METADATA_CACHE.put(batchPersistencePackage, batchResults);"
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,return METADATA_CACHE.get(batchPersistencePackage);
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,return batchResults;
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,} catch (IllegalArgumentException e) {
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,"LOG.error(""Problem performing batch inspect"", e);"
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,"throw new ServiceException(""Problem performing batch inspect"", e);"
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,}*/
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,"LOG.warn(""Not saving entity as it has failed validation"");"
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,return ((ValidationException) e).getEntity();
8055947de4c14405bd60d0527ab6fad429727b9a,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,return ((ValidationException) e.getCause()).getEntity();
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,added,0,throw e;
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,added,0,throw (ValidationException) e.getCause();
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,/*@Override
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,public BatchDynamicResultSet batchInspect(BatchPersistencePackage batchPersistencePackage) throws ServiceException {
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,try {
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,List<DynamicResultSet> dynamicResultSetList = new ArrayList<DynamicResultSet>(15);
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,List<PersistencePackage> persistencePackageList;
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,boolean containsCache = false;
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,if (METADATA_CACHE.containsKey(batchPersistencePackage)) {
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,containsCache = true;
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,persistencePackageList = new ArrayList<PersistencePackage>();
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,for (PersistencePackage persistencePackage : batchPersistencePackage.getPersistencePackages()) {
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,if (persistencePackage.getPersistencePerspective().getUseServerSideInspectionCache()) {
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,checkResultSetList: {
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,for (DynamicResultSet dynamicResultSet : METADATA_CACHE.get(batchPersistencePackage).getDynamicResultSets()) {
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,if (dynamicResultSet.getBatchId().equals(persistencePackage.getBatchId())) {
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,dynamicResultSetList.add(dynamicResultSet);
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,break checkResultSetList;
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,}
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,"throw new IllegalArgumentException(""Unable to find a result for batchId("" + persistencePackage.getBatchId() + "") in cached batch result set."");"
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,} else {
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,persistencePackageList.add(persistencePackage);
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,persistencePackageList = Arrays.asList(batchPersistencePackage.getPersistencePackages());
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,for (PersistencePackage persistencePackage : persistencePackageList) {
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,DynamicResultSet resultSet = inspect(persistencePackage);
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,resultSet.setBatchId(persistencePackage.getBatchId());
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,dynamicResultSetList.add(resultSet);
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,"Collections.sort(dynamicResultSetList, new Comparator<DynamicResultSet>() {"
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,@Override
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,"public int compare(DynamicResultSet o1, DynamicResultSet o2) {"
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,return o1.getBatchId().compareTo(o2.getBatchId());
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,});
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,BatchDynamicResultSet batchResults = new BatchDynamicResultSet();
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,batchResults.setDynamicResultSets(dynamicResultSetList.toArray(new DynamicResultSet[dynamicResultSetList.size()]));
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,if (!containsCache) {
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,"METADATA_CACHE.put(batchPersistencePackage, batchResults);"
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,return METADATA_CACHE.get(batchPersistencePackage);
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,return batchResults;
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,} catch (IllegalArgumentException e) {
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,"LOG.error(""Problem performing batch inspect"", e);"
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,"throw new ServiceException(""Problem performing batch inspect"", e);"
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,}*/
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,"LOG.warn(""Not saving entity as it has failed validation"");"
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,return ((ValidationException) e).getEntity();
8055947de4c14405bd60d0527ab6fad429727b9a,77bd4d3644793f3c67a8e47b76e559f7b26f84b6,deleted,1,return ((ValidationException) e.getCause()).getEntity();
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,"public PersistenceResponse addEntity(EntityForm entityForm, String[] customCriteria)"
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,throws ServiceException {
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,"// If the entity form has dynamic forms inside of it, we need to persist those as well."
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,"// They are typically done in their own custom persistence handlers, which will get triggered"
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,// based on the criteria specific in the PersistencePackage.
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,"for (Entry<String, EntityForm> entry : entityForm.getDynamicForms().entrySet()) {"
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,DynamicEntityFormInfo info = entityForm.getDynamicFormInfo(entry.getKey());
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,customCriteria = new String[] {info.getCriteriaName()};
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,"PersistencePackageRequest subRequest = getRequestForEntityForm(entry.getValue(), customCriteria);"
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,"ppr.addSubRequest(info.getPropertyName(), subRequest);"
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,return add(ppr);
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,"public PersistenceResponse updateEntity(EntityForm entityForm, String[] customCriteria)"
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,return update(ppr);
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,try {
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,return service.add(pkg);
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,} catch (ValidationException e) {
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,return e.getEntity();
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,}
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,return service.update(pkg);
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,import org.hibernate.ejb.HibernateEntityManager;
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,import org.springframework.transaction.annotation.Transactional;
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,/**
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"* Since the entity form can have multiple dynamic forms defined within it, it should be saved as an all-or-nothing"
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,* approach and roll back when any ServiceExceptions have been thrown in any of the saves.
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,*/
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"@Transactional(value = ""blTransactionManager"", rollbackFor = {ServiceException.class})"
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"public PersistenceResponse addEntity(EntityForm entityForm, String[] customCriteria) throws ServiceException {"
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,PersistenceResponse response = add(ppr);
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"// Once the entity has been saved, we can utilize its id for the subsequent dynamic forms"
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,Class<?> entityClass;
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,try {
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,entityClass = Class.forName(entityForm.getEntityType());
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,} catch (ClassNotFoundException e) {
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,throw new ServiceException(e);
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,}
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"Map<String, Object> idMetadata = dynamicDaoHelper.getIdMetadata(entityClass, (HibernateEntityManager) em);"
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"String idProperty = (String) idMetadata.get(""name"");"
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,entityForm.setId(response.getEntity().findProperty(idProperty).getValue());
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"Map<String, List<String>> dynamicFormValidationErrors = new HashMap<String, List<String>>();"
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"persistDynamicForms(entityForm, dynamicFormValidationErrors);"
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,//add all of the validation errors from the dynamic forms to the main entity
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,response.getEntity().getValidationErrors().putAll(dynamicFormValidationErrors);
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,if (MapUtils.isNotEmpty(response.getEntity().getValidationErrors())) {
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"throw new ValidationException(response.getEntity(), ""Validation Exception"");"
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,return response;
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"public PersistenceResponse updateEntity(EntityForm entityForm, String[] customCriteria) throws ServiceException {"
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,PersistenceResponse response = update(ppr);
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"//If there are any validation exceptions, throw a validation exception to ensure that the entire transaction is rolled back"
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,*
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,* @param entityForm the main form that contains the dynamic forms
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,* @param dynamicFormValidationErrors object to store validation errors that appear on dynamic forms
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,* @throws ServiceException
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"protected void persistDynamicForms(EntityForm entityForm,"
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"Map<String, List<String>> dynamicFormValidationErrors) throws ServiceException {"
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,String[] customCriteria;
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"PersistencePackageRequest ppr = getRequestForEntityForm(entry.getValue(), customCriteria);"
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,Entity dynamicFormEntity = update(ppr).getEntity();
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"//if the dynamic form has failed validation, ensure they are properly added to the main entity validation"
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,//errors and keyed properly
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,if (dynamicFormEntity.isValidationFailure()) {
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"for (Entry<String, List<String>> error : dynamicFormEntity.getValidationErrors().entrySet()) {"
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"dynamicFormValidationErrors.put(info.getPropertyName() + DynamicEntityFormInfo.FIELD_SEPARATOR + error.getKey(), error.getValue());"
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,return service.add(pkg);
e5c0d0e930271e95349fca888bcfa7547ccbd234,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,return service.update(pkg);
9c0bb9455b7ae70640477f112918a5273b47af60,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import java.util.ArrayList;
9c0bb9455b7ae70640477f112918a5273b47af60,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import java.util.Arrays;
9c0bb9455b7ae70640477f112918a5273b47af60,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import java.util.LinkedHashMap;
9c0bb9455b7ae70640477f112918a5273b47af60,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import java.util.List;
9c0bb9455b7ae70640477f112918a5273b47af60,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import java.util.Map;
9c0bb9455b7ae70640477f112918a5273b47af60,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"protected Map<String, PersistencePackageRequest> subRequests = new LinkedHashMap<String, PersistencePackageRequest>();"
9c0bb9455b7ae70640477f112918a5273b47af60,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public PersistencePackageRequest addSubRequest(String infoPropertyName, PersistencePackageRequest subRequest) {"
9c0bb9455b7ae70640477f112918a5273b47af60,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"subRequests.put(infoPropertyName, subRequest);"
9c0bb9455b7ae70640477f112918a5273b47af60,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,return this;
9c0bb9455b7ae70640477f112918a5273b47af60,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,}
9c0bb9455b7ae70640477f112918a5273b47af60,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public Map<String, PersistencePackageRequest> getSubRequests() {"
9c0bb9455b7ae70640477f112918a5273b47af60,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,return subRequests;
9c0bb9455b7ae70640477f112918a5273b47af60,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public void setSubRequests(Map<String, PersistencePackageRequest> subRequests) {"
9c0bb9455b7ae70640477f112918a5273b47af60,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,this.subRequests = subRequests;
9c0bb9455b7ae70640477f112918a5273b47af60,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,import java.util.ArrayList;
9c0bb9455b7ae70640477f112918a5273b47af60,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,import java.util.Arrays;
9c0bb9455b7ae70640477f112918a5273b47af60,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,import java.util.List;
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import java.util.ArrayList;
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import java.util.Arrays;
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import java.util.HashMap;
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import java.util.List;
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import java.util.ListIterator;
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import java.util.Map;
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import java.util.Map.Entry;
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import javax.annotation.Resource;
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import javax.persistence.EntityManager;
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import javax.persistence.NoResultException;
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import javax.persistence.PersistenceContext;
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,"public PersistenceResponse addEntity(EntityForm entityForm, String[] customCriteria) throws ServiceException {"
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,"public PersistenceResponse updateEntity(EntityForm entityForm, String[] customCriteria) throws ServiceException {"
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,return new PersistenceResponse().withEntity(e.getEntity());
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.apache.commons.collections.MapUtils;
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import java.util.ArrayList;
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import java.util.Arrays;
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import java.util.HashMap;
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import java.util.List;
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import java.util.ListIterator;
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import java.util.Map;
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import java.util.Map.Entry;
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import javax.annotation.Resource;
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import javax.persistence.EntityManager;
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import javax.persistence.NoResultException;
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import javax.persistence.PersistenceContext;
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,"public PersistenceResponse addEntity(EntityForm entityForm, String[] customCriteria)"
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,throws ServiceException {
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,"public PersistenceResponse updateEntity(EntityForm entityForm, String[] customCriteria)"
060ae29c6c44174dd9a9e5e7d4c78cd96e414a87,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,return e.getEntity();
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.GeneratedValue;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.AdminPresentation;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationClass;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.PopulateToOneFieldsEnum;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.RequiredOverride;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.client.VisibilityEnum;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.hibernate.annotations.Cache;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.hibernate.annotations.CacheConcurrencyStrategy;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.hibernate.annotations.GenericGenerator;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.hibernate.annotations.Parameter;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.hibernate.annotations.SQLDelete;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region=""blStandardElements"")"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationClass(populateToOneFields = PopulateToOneFieldsEnum.TRUE, friendlyName = ""StoreImpl_baseStore"")"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@SQLDelete(sql=""UPDATE BLC_STORE SET ARCHIVED = 'Y' WHERE STORE_ID = ?"")"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@GeneratedValue(generator= ""StoreId"")"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@GenericGenerator(
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"name=""StoreId"","
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"strategy=""org.broadleafcommerce.common.persistence.IdOverrideTableGenerator"","
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,parameters = {
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Parameter(name=""segment_value"", value=""StoreImpl""),"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Parameter(name=""entity_name"", value=""org.broadleafcommerce.core.store.domain.StoreImpl"")"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,}
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,)
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""StoreImpl_Store_ID"", visibility = VisibilityEnum.HIDDEN_ALL)"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,private Long id;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""STORE_NAME"", nullable = false)"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""StoreImpl_Store_Name"", order = Presentation.FieldOrder.NAME,"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"group = Presentation.Group.Name.General, groupOrder = Presentation.Group.Order.General,"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"prominent = true, gridOrder = 1, columnWidth = ""200px"","
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,requiredOverride = RequiredOverride.REQUIRED)
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""StoreImpl_address1"", order = Presentation.FieldOrder.ADDRESS_1,"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"group = Presentation.Group.Name.Location, groupOrder = Presentation.Group.Order.Location,"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"gridOrder = 2, columnWidth = ""200px"")"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""StoreImpl_address2"", order = Presentation.FieldOrder.ADDRESS_2,"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"gridOrder = 3, columnWidth = ""200px"")"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""StoreImpl_city"", order = Presentation.FieldOrder.CITY,"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"prominent = true, gridOrder = 4)"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""StoreImpl_State"", order = Presentation.FieldOrder.STATE,"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"prominent = true, gridOrder = 5)"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""StoreImpl_Zip"", order = Presentation.FieldOrder.ZIP,"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"prominent = true, gridOrder = 6)"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""StoreImpl_Country"", order = Presentation.FieldOrder.COUNTRY,"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"gridOrder = 7, columnWidth = ""200px"")"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""StoreImpl_Phone"", order = Presentation.FieldOrder.PHONE,"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"gridOrder = 8, columnWidth = ""200px"")"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""StoreImpl_lat"", order = Presentation.FieldOrder.LATITUDE,"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"tab = Presentation.Tab.Name.Advanced, tabOrder = Presentation.Tab.Order.Advanced,"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"group = Presentation.Group.Name.Geocoding, groupOrder = Presentation.Group.Order.Geocoding,"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"gridOrder = 9, columnWidth = ""200px"")"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""StoreImpl_lng"", order = Presentation.FieldOrder.LONGITUDE,"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"gridOrder = 10, columnWidth = ""200px"")"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Long getId() {
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,* @see org.broadleafcommerce.core.store.domain.Store#setId(java.lang.Long)
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setId(Long id) {
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static class Presentation {
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static class Tab {
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static class Name {
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"public static final String Advanced = ""StoreImpl_Advanced_Tab"";"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static class Order {
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int Advanced = 7000;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static class Group {
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"public static final String General = ""StoreImpl_Store_General"";"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"public static final String Location = ""StoreImpl_Store_Location"";"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"public static final String Geocoding = ""StoreImpl_Store_Geocoding"";"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int General = 1000;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int Location = 2000;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int Geocoding = 3000;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static class FieldOrder {
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int NAME = 1000;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int ADDRESS_1 = 2000;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int ADDRESS_2 = 3000;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int CITY = 4000;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int STATE = 5000;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int ZIP = 6000;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int COUNTRY = 7000;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int PHONE = 8000;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int LATITUDE = 9000;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int LONGITUDE = 10000;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.hibernate.annotations.Index;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,private String id;
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""STORE_NAME"")"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""STORE_NAME_INDEX"", columnNames={""STORE_NAME""})"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""STORE_CITY_INDEX"", columnNames={""STORE_CITY""})"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""STORE_STATE_INDEX"", columnNames={""STORE_STATE""})"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""STORE_ZIP_INDEX"", columnNames={""STORE_ZIP""})"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""STORE_COUNTRY_INDEX"", columnNames={""STORE_COUNTRY""})"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""STORE_LATITUDE_INDEX"", columnNames={""LATITUDE""})"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""STORE_LONGITUDE_INDEX"", columnNames={""LONGITUDE""})"
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public String getId() {
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* @see org.broadleafcommerce.core.store.domain.Store#setId(java.lang.String)
ddffc905e716ea7f9cbba3ea3436f90b51f80c55,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setId(String id) {
12e204c85fc07831aca242744768c331fedf1456,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (itemAdjustment.isAppliedToSalePrice()) {
12e204c85fc07831aca242744768c331fedf1456,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,saleAdjustmentValue = itemAdjustment.getValue();
12e204c85fc07831aca242744768c331fedf1456,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,// This will just set to a Money value of zero in the correct currency.
12e204c85fc07831aca242744768c331fedf1456,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,retailAdjustmentValue = itemAdjustment.getRetailPriceValue();
12e204c85fc07831aca242744768c331fedf1456,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,} else {
12e204c85fc07831aca242744768c331fedf1456,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,retailAdjustmentValue = itemAdjustment.getValue();
12e204c85fc07831aca242744768c331fedf1456,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,saleAdjustmentValue = itemAdjustment.getSalesPriceValue();
12e204c85fc07831aca242744768c331fedf1456,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
12e204c85fc07831aca242744768c331fedf1456,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,saleAdjustmentValue = itemAdjustment.getSalesPriceValue();
12e204c85fc07831aca242744768c331fedf1456,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,retailAdjustmentValue = itemAdjustment.getRetailPriceValue();
a123490bf8739e5f97e6b93fb3b641c528bccb6a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (itemAdjustment.isAppliedToSalePrice()) {
a123490bf8739e5f97e6b93fb3b641c528bccb6a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,saleAdjustmentValue = itemAdjustment.getValue();
a123490bf8739e5f97e6b93fb3b641c528bccb6a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,// This will just set to a Money value of zero in the correct currency.
a123490bf8739e5f97e6b93fb3b641c528bccb6a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,retailAdjustmentValue = itemAdjustment.getRetailPriceValue();
a123490bf8739e5f97e6b93fb3b641c528bccb6a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,} else {
a123490bf8739e5f97e6b93fb3b641c528bccb6a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,retailAdjustmentValue = itemAdjustment.getValue();
a123490bf8739e5f97e6b93fb3b641c528bccb6a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,saleAdjustmentValue = itemAdjustment.getSalesPriceValue();
a123490bf8739e5f97e6b93fb3b641c528bccb6a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
a123490bf8739e5f97e6b93fb3b641c528bccb6a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,saleAdjustmentValue = itemAdjustment.getSalesPriceValue();
a123490bf8739e5f97e6b93fb3b641c528bccb6a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,retailAdjustmentValue = itemAdjustment.getRetailPriceValue();
33de53e2207761cc3af391268bc06554efabbace,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.util.Map.Entry;
33de53e2207761cc3af391268bc06554efabbace,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"for (Entry<String, FieldMetadata> metadataEntry : propertiesMetadata.entrySet()) {"
33de53e2207761cc3af391268bc06554efabbace,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,FieldMetadata metadata = metadataEntry.getValue();
33de53e2207761cc3af391268bc06554efabbace,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,Property property = entity.getPMap().get(metadataEntry.getKey());
33de53e2207761cc3af391268bc06554efabbace,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"//for radio buttons, it's possible that the entity property was never populated in the first place from the POST"
33de53e2207761cc3af391268bc06554efabbace,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,//and so it will be null
33de53e2207761cc3af391268bc06554efabbace,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,String propertyName = metadataEntry.getKey();
33de53e2207761cc3af391268bc06554efabbace,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,String propertyValue = (property == null) ? null : property.getValue();
33de53e2207761cc3af391268bc06554efabbace,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"propertyName,"
33de53e2207761cc3af391268bc06554efabbace,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,propertyValue);
33de53e2207761cc3af391268bc06554efabbace,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"entity.addValidationError(propertyName, result.getErrorMessage());"
33de53e2207761cc3af391268bc06554efabbace,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,""" for property: "" + propertyName);"
33de53e2207761cc3af391268bc06554efabbace,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,for (Property property : entity.getProperties()) {
33de53e2207761cc3af391268bc06554efabbace,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,FieldMetadata metadata = propertiesMetadata.get(property.getName());
33de53e2207761cc3af391268bc06554efabbace,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"property.getName(),"
33de53e2207761cc3af391268bc06554efabbace,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,property.getValue());
33de53e2207761cc3af391268bc06554efabbace,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"entity.addValidationError(property.getName(), result.getErrorMessage());"
33de53e2207761cc3af391268bc06554efabbace,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,""" for property: "" + property.getName());"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.io.Serializable;
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.util.List;
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.util.Map;
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.util.Map.Entry;
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import javax.annotation.Resource;
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,//Don't test this field if it was not inherited from our polymorphic type
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (metadata.getInheritedFromType().equals(entity.getType()[0])) {
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,Property property = entity.getPMap().get(metadataEntry.getKey());
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"//for radio buttons, it's possible that the entity property was never populated in the first place from the POST"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,//and so it will be null
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,String propertyName = metadataEntry.getKey();
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,String propertyValue = (property == null) ? null : property.getValue();
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (metadata instanceof BasicFieldMetadata) {
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,//First execute the global field validators
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (CollectionUtils.isNotEmpty(globalEntityValidators)) {
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,for (GlobalPropertyValidator validator : globalEntityValidators) {
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"PropertyValidationResult result = validator.validate(entity,"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"instance,"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"propertiesMetadata,"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"(BasicFieldMetadata)metadata,"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"propertyName,"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,propertyValue);
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (!result.isValid()) {
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"entity.addValidationError(propertyName, result.getErrorMessage());"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,}
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,//Now execute the validators configured for this particular field
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"Map<String, Map<String, String>> validations ="
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,((BasicFieldMetadata) metadata).getValidationConfigurations();
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"for (Map.Entry<String, Map<String, String>> validation : validations.entrySet()) {"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,String validationImplementation = validation.getKey();
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"Map<String, String> configuration = validation.getValue();"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,PropertyValidator validator = null;
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,//attempt bean resolution to find the validator
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (applicationContext.containsBean(validationImplementation)) {
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"validator = applicationContext.getBean(validationImplementation, PropertyValidator.class);"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"//not a bean, attempt to instantiate the class"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (validator == null) {
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,try {
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,validator = (PropertyValidator) Class.forName(validationImplementation).newInstance();
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,} catch (Exception e) {
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,//do nothing
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"throw new PersistenceException(""Could not find validator: "" + validationImplementation +"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,""" for property: "" + propertyName);"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"configuration,"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.io.Serializable;
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.List;
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.Map;
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.Map.Entry;
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import javax.annotation.Resource;
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,Property property = entity.getPMap().get(metadataEntry.getKey());
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"//for radio buttons, it's possible that the entity property was never populated in the first place from the POST"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,//and so it will be null
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,String propertyName = metadataEntry.getKey();
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,String propertyValue = (property == null) ? null : property.getValue();
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (metadata instanceof BasicFieldMetadata) {
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,//First execute the global field validators
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (CollectionUtils.isNotEmpty(globalEntityValidators)) {
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,for (GlobalPropertyValidator validator : globalEntityValidators) {
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"instance,"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"propertiesMetadata,"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"(BasicFieldMetadata)metadata,"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"propertyName,"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,propertyValue);
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,//Now execute the validators configured for this particular field
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"Map<String, Map<String, String>> validations ="
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,((BasicFieldMetadata) metadata).getValidationConfigurations();
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"for (Map.Entry<String, Map<String, String>> validation : validations.entrySet()) {"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,String validationImplementation = validation.getKey();
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"Map<String, String> configuration = validation.getValue();"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,PropertyValidator validator = null;
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,//attempt bean resolution to find the validator
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (applicationContext.containsBean(validationImplementation)) {
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"validator = applicationContext.getBean(validationImplementation, PropertyValidator.class);"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,}
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"//not a bean, attempt to instantiate the class"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (validator == null) {
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,try {
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,validator = (PropertyValidator) Class.forName(validationImplementation).newInstance();
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,} catch (Exception e) {
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,//do nothing
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"throw new PersistenceException(""Could not find validator: "" + validationImplementation +"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,""" for property: "" + propertyName);"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"PropertyValidationResult result = validator.validate(entity,"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"configuration,"
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (!result.isValid()) {
d3cf056535ca2ab1519f242d5e866209aee8d664,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"entity.addValidationError(propertyName, result.getErrorMessage());"
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import java.util.ArrayList;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import java.util.Arrays;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import java.util.HashMap;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import java.util.List;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import java.util.ListIterator;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import java.util.Map;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import java.util.Map.Entry;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import javax.annotation.Resource;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import javax.persistence.EntityManager;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import javax.persistence.NoResultException;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import javax.persistence.PersistenceContext;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import org.broadleafcommerce.common.persistence.EntityConfiguration;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import org.springframework.beans.factory.NoSuchBeanDefinitionException;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"@Resource(name = ""blEntityConfiguration"")"
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,protected EntityConfiguration entityConfiguration;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,Class<?> listClass = Class.forName(fmd.getCollectionCeilingEntity());
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"//try to find an override, if available"
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,List<Class<?>> testClasses = new ArrayList<Class<?>>();
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,testClasses.add(listClass);
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,if (!listClass.isInterface()) {
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,testClasses.addAll(Arrays.asList(listClass.getInterfaces()));
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,}
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,String overrideClass = listClass.getName();
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,for (Class<?> clazz : testClasses) {
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,try {
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,overrideClass = entityConfiguration.lookupEntityClass(clazz.getName()).getName();
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,break;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,} catch (NoSuchBeanDefinitionException e) {
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,//no override defined
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,ppr.getEntity().setType(new String[] { overrideClass });
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import java.util.ArrayList;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import java.util.Arrays;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import java.util.HashMap;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import java.util.List;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import java.util.ListIterator;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import java.util.Map;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import java.util.Map.Entry;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import javax.annotation.Resource;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import javax.persistence.EntityManager;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import javax.persistence.NoResultException;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import javax.persistence.PersistenceContext;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,ppr.getEntity().setType(new String[] { fmd.getCollectionCeilingEntity() });
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import java.util.ArrayList;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import java.util.Arrays;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import java.util.HashMap;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import java.util.List;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import java.util.ListIterator;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import java.util.Map;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import java.util.Map.Entry;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import javax.annotation.Resource;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import javax.persistence.EntityManager;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import javax.persistence.NoResultException;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import javax.persistence.PersistenceContext;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import org.broadleafcommerce.common.persistence.EntityConfiguration;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import org.springframework.beans.factory.NoSuchBeanDefinitionException;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,"@Resource(name = ""blEntityConfiguration"")"
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,protected EntityConfiguration entityConfiguration;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,Class<?> listClass = Class.forName(fmd.getCollectionCeilingEntity());
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,"//try to find an override, if available"
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,List<Class<?>> testClasses = new ArrayList<Class<?>>();
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,testClasses.add(listClass);
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,if (!listClass.isInterface()) {
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,testClasses.addAll(Arrays.asList(listClass.getInterfaces()));
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,}
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,String overrideClass = listClass.getName();
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,for (Class<?> clazz : testClasses) {
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,try {
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,overrideClass = entityConfiguration.lookupEntityClass(clazz.getName()).getName();
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,break;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,} catch (NoSuchBeanDefinitionException e) {
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,//no override defined
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,ppr.getEntity().setType(new String[] { overrideClass });
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import java.util.ArrayList;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import java.util.Arrays;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import java.util.HashMap;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import java.util.List;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import java.util.ListIterator;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import java.util.Map;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import java.util.Map.Entry;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import javax.annotation.Resource;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import javax.persistence.EntityManager;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import javax.persistence.NoResultException;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import javax.persistence.PersistenceContext;
24714644d74ab1f558ae96d66ed3d7cb8b1b1465,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,ppr.getEntity().setType(new String[] { fmd.getCollectionCeilingEntity() });
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.io.Serializable;
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.util.List;
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.util.Map;
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import javax.annotation.Resource;
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,for (Property property : entity.getProperties()) {
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,FieldMetadata metadata = propertiesMetadata.get(property.getName());
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (metadata instanceof BasicFieldMetadata) {
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,//First execute the global field validators
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (CollectionUtils.isNotEmpty(globalEntityValidators)) {
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,for (GlobalPropertyValidator validator : globalEntityValidators) {
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"instance,"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"propertiesMetadata,"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"(BasicFieldMetadata)metadata,"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"property.getName(),"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,property.getValue());
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"entity.addValidationError(property.getName(), result.getErrorMessage());"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,//Now execute the validators configured for this particular field
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"Map<String, Map<String, String>> validations ="
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,((BasicFieldMetadata) metadata).getValidationConfigurations();
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"for (Map.Entry<String, Map<String, String>> validation : validations.entrySet()) {"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,String validationImplementation = validation.getKey();
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"Map<String, String> configuration = validation.getValue();"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,PropertyValidator validator = null;
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,//attempt bean resolution to find the validator
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (applicationContext.containsBean(validationImplementation)) {
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"validator = applicationContext.getBean(validationImplementation, PropertyValidator.class);"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,}
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"//not a bean, attempt to instantiate the class"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (validator == null) {
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,try {
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,validator = (PropertyValidator) Class.forName(validationImplementation).newInstance();
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,} catch (Exception e) {
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,//do nothing
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"throw new PersistenceException(""Could not find validator: "" + validationImplementation +"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,""" for property: "" + property.getName());"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"PropertyValidationResult result = validator.validate(entity,"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"configuration,"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (!result.isValid()) {
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.io.Serializable;
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.ArrayList;
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.List;
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.Map;
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.Map.Entry;
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import javax.annotation.Resource;
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,List<String> types = getTypeHierarchy(entity);
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"for (Entry<String, FieldMetadata> metadataEntry : propertiesMetadata.entrySet()) {"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,FieldMetadata metadata = metadataEntry.getValue();
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,//Don't test this field if it was not inherited from our polymorphic type (or supertype)
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (types.contains(metadata.getInheritedFromType())) {
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,Property property = entity.getPMap().get(metadataEntry.getKey());
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"//for radio buttons, it's possible that the entity property was never populated in the first place from the POST"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,//and so it will be null
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,String propertyName = metadataEntry.getKey();
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,String propertyValue = (property == null) ? null : property.getValue();
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (metadata instanceof BasicFieldMetadata) {
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,//First execute the global field validators
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (CollectionUtils.isNotEmpty(globalEntityValidators)) {
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,for (GlobalPropertyValidator validator : globalEntityValidators) {
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"PropertyValidationResult result = validator.validate(entity,"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"instance,"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"propertiesMetadata,"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"(BasicFieldMetadata)metadata,"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"propertyName,"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,propertyValue);
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (!result.isValid()) {
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"entity.addValidationError(propertyName, result.getErrorMessage());"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,}
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,//Now execute the validators configured for this particular field
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"Map<String, Map<String, String>> validations ="
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,((BasicFieldMetadata) metadata).getValidationConfigurations();
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"for (Map.Entry<String, Map<String, String>> validation : validations.entrySet()) {"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,String validationImplementation = validation.getKey();
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"Map<String, String> configuration = validation.getValue();"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,PropertyValidator validator = null;
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,//attempt bean resolution to find the validator
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (applicationContext.containsBean(validationImplementation)) {
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"validator = applicationContext.getBean(validationImplementation, PropertyValidator.class);"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"//not a bean, attempt to instantiate the class"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (validator == null) {
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,try {
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,validator = (PropertyValidator) Class.forName(validationImplementation).newInstance();
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,} catch (Exception e) {
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,//do nothing
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"throw new PersistenceException(""Could not find validator: "" + validationImplementation +"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,""" for property: "" + propertyName);"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"configuration,"
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,protected List<String> getTypeHierarchy(Entity entity) {
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,List<String> types = new ArrayList<String>();
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,Class<?> myType;
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,myType = Class.forName(entity.getType()[0]);
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,} catch (ClassNotFoundException e) {
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,throw new RuntimeException(e);
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,types.add(myType.getName());
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,boolean eof = false;
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,while (!eof) {
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,myType = myType.getSuperclass();
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (myType != null && !myType.getName().equals(Object.class.getName())) {
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,} else {
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,eof = true;
918e2a44f91d5d1e6811962449c880d129e9885c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,return types;
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.io.Serializable;
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.util.ArrayList;
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.util.List;
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.util.Map;
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.util.Map.Entry;
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import javax.annotation.Resource;
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,List<String> types = getTypeHierarchy(entity);
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"for (Entry<String, FieldMetadata> metadataEntry : propertiesMetadata.entrySet()) {"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,FieldMetadata metadata = metadataEntry.getValue();
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,//Don't test this field if it was not inherited from our polymorphic type (or supertype)
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (types.contains(metadata.getInheritedFromType())) {
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,Property property = entity.getPMap().get(metadataEntry.getKey());
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"//for radio buttons, it's possible that the entity property was never populated in the first place from the POST"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,//and so it will be null
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,String propertyName = metadataEntry.getKey();
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,String propertyValue = (property == null) ? null : property.getValue();
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (metadata instanceof BasicFieldMetadata) {
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,//First execute the global field validators
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (CollectionUtils.isNotEmpty(globalEntityValidators)) {
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,for (GlobalPropertyValidator validator : globalEntityValidators) {
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"PropertyValidationResult result = validator.validate(entity,"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"instance,"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"propertiesMetadata,"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"(BasicFieldMetadata)metadata,"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"propertyName,"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,propertyValue);
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (!result.isValid()) {
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"entity.addValidationError(propertyName, result.getErrorMessage());"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,}
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,//Now execute the validators configured for this particular field
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"Map<String, Map<String, String>> validations ="
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,((BasicFieldMetadata) metadata).getValidationConfigurations();
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"for (Map.Entry<String, Map<String, String>> validation : validations.entrySet()) {"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,String validationImplementation = validation.getKey();
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"Map<String, String> configuration = validation.getValue();"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,PropertyValidator validator = null;
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,//attempt bean resolution to find the validator
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (applicationContext.containsBean(validationImplementation)) {
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"validator = applicationContext.getBean(validationImplementation, PropertyValidator.class);"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"//not a bean, attempt to instantiate the class"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (validator == null) {
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,try {
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,validator = (PropertyValidator) Class.forName(validationImplementation).newInstance();
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,} catch (Exception e) {
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,//do nothing
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"throw new PersistenceException(""Could not find validator: "" + validationImplementation +"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,""" for property: "" + propertyName);"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"configuration,"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,protected List<String> getTypeHierarchy(Entity entity) {
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,List<String> types = new ArrayList<String>();
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,Class<?> myType;
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,myType = Class.forName(entity.getType()[0]);
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,} catch (ClassNotFoundException e) {
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,throw new RuntimeException(e);
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,types.add(myType.getName());
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,boolean eof = false;
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,while (!eof) {
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,myType = myType.getSuperclass();
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (myType != null && !myType.getName().equals(Object.class.getName())) {
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,} else {
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,eof = true;
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,return types;
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.io.Serializable;
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.List;
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.Map;
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import javax.annotation.Resource;
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,for (Property property : entity.getProperties()) {
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,FieldMetadata metadata = propertiesMetadata.get(property.getName());
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (metadata instanceof BasicFieldMetadata) {
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,//First execute the global field validators
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (CollectionUtils.isNotEmpty(globalEntityValidators)) {
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,for (GlobalPropertyValidator validator : globalEntityValidators) {
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"PropertyValidationResult result = validator.validate(entity,"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"instance,"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"propertiesMetadata,"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"(BasicFieldMetadata)metadata,"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"property.getName(),"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,property.getValue());
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (!result.isValid()) {
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"entity.addValidationError(property.getName(), result.getErrorMessage());"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,}
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,//Now execute the validators configured for this particular field
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"Map<String, Map<String, String>> validations ="
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,((BasicFieldMetadata) metadata).getValidationConfigurations();
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"for (Map.Entry<String, Map<String, String>> validation : validations.entrySet()) {"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,String validationImplementation = validation.getKey();
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"Map<String, String> configuration = validation.getValue();"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,PropertyValidator validator = null;
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,//attempt bean resolution to find the validator
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (applicationContext.containsBean(validationImplementation)) {
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"validator = applicationContext.getBean(validationImplementation, PropertyValidator.class);"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"//not a bean, attempt to instantiate the class"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (validator == null) {
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,try {
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,validator = (PropertyValidator) Class.forName(validationImplementation).newInstance();
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,} catch (Exception e) {
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,//do nothing
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"throw new PersistenceException(""Could not find validator: "" + validationImplementation +"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,""" for property: "" + property.getName());"
9cdf578ba32b2134399228012d9f1634062b381b,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"configuration,"
d09b56a388dbf0bf5c3696243fcf6839b349c382,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import org.apache.commons.lang3.StringUtils;
d09b56a388dbf0bf5c3696243fcf6839b349c382,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,String entityType = entityForm.getEntityType();
d09b56a388dbf0bf5c3696243fcf6839b349c382,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,if (StringUtils.isEmpty(entityType)) {
d09b56a388dbf0bf5c3696243fcf6839b349c382,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,entityType = entityForm.getCeilingEntityClassname();
d09b56a388dbf0bf5c3696243fcf6839b349c382,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,}
d09b56a388dbf0bf5c3696243fcf6839b349c382,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,entity.setType(new String[] { entityType });
d09b56a388dbf0bf5c3696243fcf6839b349c382,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,entity.setType(new String[] { entityForm.getEntityType() });
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.io.Serializable;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.lang.reflect.Field;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.lang.reflect.InvocationTargetException;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.lang.reflect.Method;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.lang.reflect.ParameterizedType;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.math.BigDecimal;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.sql.Timestamp;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.text.DecimalFormat;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.text.NumberFormat;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.text.SimpleDateFormat;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.util.ArrayList;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.util.Calendar;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.util.Collection;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.util.Collections;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.util.Comparator;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.util.Date;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.util.HashMap;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.util.List;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.util.Locale;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.util.Map;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.util.Map.Entry;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.util.StringTokenizer;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import javax.annotation.Resource;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import javax.persistence.criteria.CriteriaBuilder;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import javax.persistence.criteria.From;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import javax.persistence.criteria.Path;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import javax.persistence.criteria.Predicate;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,"entityValidatorService.validate(entity, populatedInstance, mergedProperties, this);"
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.io.Serializable;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.lang.reflect.Field;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.lang.reflect.InvocationTargetException;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.lang.reflect.Method;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.lang.reflect.ParameterizedType;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.math.BigDecimal;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.sql.Timestamp;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.text.DecimalFormat;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.text.NumberFormat;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.text.SimpleDateFormat;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.util.ArrayList;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.util.Calendar;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.util.Collection;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.util.Collections;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.util.Comparator;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.util.Date;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.util.HashMap;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.util.List;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.util.Locale;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.util.Map;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.util.Map.Entry;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.util.StringTokenizer;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import javax.annotation.Resource;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import javax.persistence.criteria.CriteriaBuilder;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import javax.persistence.criteria.From;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import javax.persistence.criteria.Path;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import javax.persistence.criteria.Predicate;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,"entityValidatorService.validate(entity, populatedInstance, mergedProperties);"
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.io.Serializable;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.lang.reflect.Field;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.lang.reflect.InvocationTargetException;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.lang.reflect.Method;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.lang.reflect.ParameterizedType;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.math.BigDecimal;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.sql.Timestamp;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.text.DecimalFormat;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.text.NumberFormat;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.text.SimpleDateFormat;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.util.ArrayList;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.util.Calendar;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.util.Collection;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.util.Collections;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.util.Comparator;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.util.Date;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.util.HashMap;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.util.List;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.util.Locale;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.util.Map;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.util.Map.Entry;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import java.util.StringTokenizer;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import javax.annotation.Resource;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import javax.persistence.criteria.CriteriaBuilder;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import javax.persistence.criteria.From;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import javax.persistence.criteria.Path;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import javax.persistence.criteria.Predicate;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"entityValidatorService.validate(entity, populatedInstance, mergedProperties, this);"
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.io.Serializable;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.lang.reflect.Field;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.lang.reflect.InvocationTargetException;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.lang.reflect.Method;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.lang.reflect.ParameterizedType;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.math.BigDecimal;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.sql.Timestamp;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.text.DecimalFormat;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.text.NumberFormat;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.text.SimpleDateFormat;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.ArrayList;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.Calendar;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.Collection;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.Collections;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.Comparator;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.Date;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.HashMap;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.List;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.Locale;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.Map;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.Map.Entry;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import java.util.StringTokenizer;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import javax.annotation.Resource;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import javax.persistence.criteria.CriteriaBuilder;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import javax.persistence.criteria.From;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import javax.persistence.criteria.Path;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import javax.persistence.criteria.Predicate;
d09b56a388dbf0bf5c3696243fcf6839b349c382,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"entityValidatorService.validate(entity, populatedInstance, mergedProperties);"
cb5ef790a1180ea23bffe54227699c26a61f58ed,69877cda3b323c2da3a26f32c48e1111e61fed45,added,0,import javax.annotation.Resource;
cb5ef790a1180ea23bffe54227699c26a61f58ed,69877cda3b323c2da3a26f32c48e1111e61fed45,added,0,"//FIXME: After the change to cascading the deletion on PaymentResponseItems, this test does not work but for a really"
cb5ef790a1180ea23bffe54227699c26a61f58ed,69877cda3b323c2da3a26f32c48e1111e61fed45,added,0,//strange reason; the list of PaymentResponseItems is getting removed from the Hibernate session for some really weird
cb5ef790a1180ea23bffe54227699c26a61f58ed,69877cda3b323c2da3a26f32c48e1111e61fed45,added,0,"//reason. This only occurs sometimes, so it is probably due to the somewhat random ordering that TestNG puts around tests"
cb5ef790a1180ea23bffe54227699c26a61f58ed,69877cda3b323c2da3a26f32c48e1111e61fed45,added,0,"//    @Test(groups = {""deleteOrderForCustomer""}, dependsOnGroups = {""readOrder""})"
cb5ef790a1180ea23bffe54227699c26a61f58ed,69877cda3b323c2da3a26f32c48e1111e61fed45,added,0,//    @Transactional
cb5ef790a1180ea23bffe54227699c26a61f58ed,69877cda3b323c2da3a26f32c48e1111e61fed45,added,0,//    public void deleteOrderForCustomer(){
cb5ef790a1180ea23bffe54227699c26a61f58ed,69877cda3b323c2da3a26f32c48e1111e61fed45,added,0,//        Order order = orderDao.readOrderById(orderId);
cb5ef790a1180ea23bffe54227699c26a61f58ed,69877cda3b323c2da3a26f32c48e1111e61fed45,added,0,//        assert order != null;
cb5ef790a1180ea23bffe54227699c26a61f58ed,69877cda3b323c2da3a26f32c48e1111e61fed45,added,0,//        assert order.getId() != null;
cb5ef790a1180ea23bffe54227699c26a61f58ed,69877cda3b323c2da3a26f32c48e1111e61fed45,added,0,//        orderDao.delete(order);
cb5ef790a1180ea23bffe54227699c26a61f58ed,69877cda3b323c2da3a26f32c48e1111e61fed45,added,0,//    }
cb5ef790a1180ea23bffe54227699c26a61f58ed,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import javax.annotation.Resource;
cb5ef790a1180ea23bffe54227699c26a61f58ed,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = {""deleteOrderForCustomer""}, dependsOnGroups = {""readOrder""})"
cb5ef790a1180ea23bffe54227699c26a61f58ed,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,@Transactional
cb5ef790a1180ea23bffe54227699c26a61f58ed,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void deleteOrderForCustomer(){
cb5ef790a1180ea23bffe54227699c26a61f58ed,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,Order order = orderDao.readOrderById(orderId);
cb5ef790a1180ea23bffe54227699c26a61f58ed,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert order != null;
cb5ef790a1180ea23bffe54227699c26a61f58ed,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert order.getId() != null;
cb5ef790a1180ea23bffe54227699c26a61f58ed,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,orderDao.delete(order);
cb5ef790a1180ea23bffe54227699c26a61f58ed,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,}
4fc0930fc80313e16ae4ad80cc6c0c8dd1390b2e,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import org.apache.commons.lang3.StringUtils;
4fc0930fc80313e16ae4ad80cc6c0c8dd1390b2e,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,String entityType = entityForm.getEntityType();
4fc0930fc80313e16ae4ad80cc6c0c8dd1390b2e,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,if (StringUtils.isEmpty(entityType)) {
4fc0930fc80313e16ae4ad80cc6c0c8dd1390b2e,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,entityType = entityForm.getCeilingEntityClassname();
4fc0930fc80313e16ae4ad80cc6c0c8dd1390b2e,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,}
4fc0930fc80313e16ae4ad80cc6c0c8dd1390b2e,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,entity.setType(new String[] { entityType });
4fc0930fc80313e16ae4ad80cc6c0c8dd1390b2e,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,entity.setType(new String[] { entityForm.getEntityType() });
0cb011d65e9a003de3e113098069d59e5bf878d2,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,import javax.annotation.Resource;
0cb011d65e9a003de3e113098069d59e5bf878d2,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.springframework.stereotype.Component;
0cb011d65e9a003de3e113098069d59e5bf878d2,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import javax.annotation.Resource;
0cb011d65e9a003de3e113098069d59e5bf878d2,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"@Component(""blHeadProcessor"")"
0cb011d65e9a003de3e113098069d59e5bf878d2,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.springframework.stereotype.Service;
0cb011d65e9a003de3e113098069d59e5bf878d2,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"@Service(""blHeadProcessorExtensionManager"")"
5ccb5e284dd98fd1266b34e70e8816db2c928b42,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.common.web.BroadleafRequestCustomerResolverImpl;
5ccb5e284dd98fd1266b34e70e8816db2c928b42,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,return (Customer) BroadleafRequestCustomerResolverImpl.getRequestCustomerResolver().getCustomer(request);
5ccb5e284dd98fd1266b34e70e8816db2c928b42,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,return (Customer) BroadleafRequestCustomerResolverImpl.getRequestCustomerResolver().getCustomer();
5ccb5e284dd98fd1266b34e70e8816db2c928b42,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,BroadleafRequestCustomerResolverImpl.getRequestCustomerResolver().setCustomer(customer);
5ccb5e284dd98fd1266b34e70e8816db2c928b42,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import org.broadleafcommerce.common.web.BroadleafRequestContext;
5ccb5e284dd98fd1266b34e70e8816db2c928b42,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import org.broadleafcommerce.profile.web.core.security.CustomerStateRequestProcessor;
5ccb5e284dd98fd1266b34e70e8816db2c928b42,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import org.springframework.web.context.request.ServletWebRequest;
5ccb5e284dd98fd1266b34e70e8816db2c928b42,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,return getCustomer(new ServletWebRequest(request));
5ccb5e284dd98fd1266b34e70e8816db2c928b42,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"return (Customer) request.getAttribute(CustomerStateRequestProcessor.getCustomerRequestAttributeName(), WebRequest.SCOPE_REQUEST);"
5ccb5e284dd98fd1266b34e70e8816db2c928b42,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,/**
5ccb5e284dd98fd1266b34e70e8816db2c928b42,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,* Utilizes the current BroadleafRequestContext to lookup a customer from the request.
5ccb5e284dd98fd1266b34e70e8816db2c928b42,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,* @return
5ccb5e284dd98fd1266b34e70e8816db2c928b42,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,*/
5ccb5e284dd98fd1266b34e70e8816db2c928b42,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,WebRequest request = BroadleafRequestContext.getBroadleafRequestContext().getWebRequest();
5ccb5e284dd98fd1266b34e70e8816db2c928b42,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"request.setAttribute(CustomerStateRequestProcessor.getCustomerRequestAttributeName(), customer, WebRequest.SCOPE_REQUEST);"
5ccb5e284dd98fd1266b34e70e8816db2c928b42,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.common.web.BroadleafRequestCustomerResolverImpl;
5ccb5e284dd98fd1266b34e70e8816db2c928b42,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,customer = (Customer) BroadleafRequestCustomerResolverImpl.getRequestCustomerResolver().getCustomer(request);
5ccb5e284dd98fd1266b34e70e8816db2c928b42,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,return BroadleafRequestCustomerResolverImpl.getRequestCustomerResolver().getCustomerRequestAttributeName();
5ccb5e284dd98fd1266b34e70e8816db2c928b42,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"protected static String customerRequestAttributeName = ""customer"";"
5ccb5e284dd98fd1266b34e70e8816db2c928b42,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"customer = (Customer) request.getAttribute(customerRequestAttributeName, WebRequest.SCOPE_REQUEST);"
5ccb5e284dd98fd1266b34e70e8816db2c928b42,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,return customerRequestAttributeName;
5ccb5e284dd98fd1266b34e70e8816db2c928b42,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,}
5ccb5e284dd98fd1266b34e70e8816db2c928b42,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,public static void setCustomerRequestAttributeName(String customerRequestAttributeName) {
5ccb5e284dd98fd1266b34e70e8816db2c928b42,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,CustomerStateRequestProcessor.customerRequestAttributeName = customerRequestAttributeName;
c31fc65bbeb60697071a72f85490d39f6eba76da,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,protected boolean copyCartWhenSpecifiedStateChanges = false;
c31fc65bbeb60697071a72f85490d39f6eba76da,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,/**
c31fc65bbeb60697071a72f85490d39f6eba76da,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* Gets whether or not the cart should be copied to a new cart and then repriced if
c31fc65bbeb60697071a72f85490d39f6eba76da,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* {@link UpdateCartService#validateCart(Order)} throws an IllegalArgumentException
c31fc65bbeb60697071a72f85490d39f6eba76da,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,*
c31fc65bbeb60697071a72f85490d39f6eba76da,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* @return the copyCartWhenSpecifiedStateChanges
c31fc65bbeb60697071a72f85490d39f6eba76da,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,*/
c31fc65bbeb60697071a72f85490d39f6eba76da,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,public boolean isCopyCartWhenSpecifiedStateChanges() {
c31fc65bbeb60697071a72f85490d39f6eba76da,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,return copyCartWhenSpecifiedStateChanges;
c31fc65bbeb60697071a72f85490d39f6eba76da,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,}
c31fc65bbeb60697071a72f85490d39f6eba76da,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* @param copyCartWhenSpecifiedStateChanges whether or not the old cart should be copied to a new cart and then repriced
c31fc65bbeb60697071a72f85490d39f6eba76da,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,public void setCopyCartWhenSpecifiedStateChanges(boolean copyCartWhenSpecifiedStateChanges) {
c31fc65bbeb60697071a72f85490d39f6eba76da,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,this.copyCartWhenSpecifiedStateChanges = copyCartWhenSpecifiedStateChanges;
c31fc65bbeb60697071a72f85490d39f6eba76da,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,protected static boolean copyCartWhenSpecifiedStateChanges = false;
ebbbdd578cec820fb0622a743cdf416f0de74f28,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"@Resource(name = ""blCustomerStateRequestProcessor"")"
ebbbdd578cec820fb0622a743cdf416f0de74f28,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,protected CustomerStateRequestProcessor customerStateRequestProcessor;
ebbbdd578cec820fb0622a743cdf416f0de74f28,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,Customer anonymousCustomer = customerStateRequestProcessor.resolveAnonymousCustomer(request);
ebbbdd578cec820fb0622a743cdf416f0de74f28,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"Customer anonymousCustomer = (Customer) request.getAttribute(CustomerStateRequestProcessor.ANONYMOUS_CUSTOMER_SESSION_ATTRIBUTE_NAME, WebRequest.SCOPE_GLOBAL_SESSION);"
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,added,0,import org.broadleafcommerce.common.util.TransactionUtils;
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,added,0,"TransactionStatus status = TransactionUtils.createTransaction(""saveOrder"","
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,added,0,"TransactionDefinition.PROPAGATION_REQUIRED, transactionManager);"
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,added,0,"TransactionUtils.finalizeTransaction(status, transactionManager, false);"
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,added,0,"TransactionUtils.finalizeTransaction(status, transactionManager, true);"
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,added,0,"status = TransactionUtils.createTransaction(""saveOrder"","
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.springframework.transaction.support.DefaultTransactionDefinition;
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,DefaultTransactionDefinition def = new DefaultTransactionDefinition();
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"def.setName(""saveOrder"");"
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,def.setPropagationBehavior(TransactionDefinition.PROPAGATION_REQUIRED);
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,TransactionStatus status = transactionManager.getTransaction(def);
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"finalizeTransaction(status, false);"
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"finalizeTransaction(status, true);"
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,def = new DefaultTransactionDefinition();
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,status = transactionManager.getTransaction(def);
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"protected void finalizeTransaction(TransactionStatus status, boolean isError) {"
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,boolean isActive = false;
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,try {
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,if (!status.isRollbackOnly()) {
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,isActive = true;
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,}
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,} catch (Exception e) {
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,//do nothing
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,if (isActive) {
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,if (isError) {
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,transactionManager.rollback(status);
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,} else {
cc898fba7b53c01406d3d5b0f9392a86dccd1905,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,transactionManager.commit(status);
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,added,0,import org.broadleafcommerce.common.util.TransactionUtils;
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,added,0,"TransactionStatus status = TransactionUtils.createTransaction(""readProducts"","
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,added,0,"TransactionDefinition.PROPAGATION_REQUIRED, transactionManager, true);"
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,added,0,"TransactionUtils.finalizeTransaction(status, transactionManager, false);"
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,added,0,"TransactionUtils.finalizeTransaction(status, transactionManager, true);"
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,import org.broadleafcommerce.common.classloader.release.ThreadLocalManager;
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,import org.springframework.transaction.support.DefaultTransactionDefinition;
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,DefaultTransactionDefinition def = new DefaultTransactionDefinition();
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,"def.setName(""saveOrder"");"
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,def.setReadOnly(true);
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,def.setPropagationBehavior(TransactionDefinition.PROPAGATION_REQUIRED);
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,TransactionStatus status = transactionManager.getTransaction(def);
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,"finalizeTransaction(status, false);"
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,"finalizeTransaction(status, true);"
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,"protected void finalizeTransaction(TransactionStatus status, boolean isError) {"
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,boolean isActive = false;
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,try {
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,if (!status.isRollbackOnly()) {
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,isActive = true;
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,}
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,} catch (Exception e) {
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,//do nothing
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,if (isActive) {
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,if (isError) {
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,transactionManager.rollback(status);
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,} else {
cc898fba7b53c01406d3d5b0f9392a86dccd1905,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,transactionManager.commit(status);
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* @return
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"PromotionQualifier addPromotionQualifier(PromotableCandidateItemOffer itemOffer, OfferItemCriteria itemCriteria, int qtyToMarkAsQualifier);"
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"void addPromotionQualifier(PromotableCandidateItemOffer itemOffer, OfferItemCriteria itemCriteria, int qtyToMarkAsQualifier);"
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"public PromotionQualifier addPromotionQualifier(PromotableCandidateItemOffer itemOffer, OfferItemCriteria itemCriteria, int qtyToMarkAsQualifier) {"
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return pq;
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"public void addPromotionQualifier(PromotableCandidateItemOffer itemOffer, OfferItemCriteria itemCriteria, int qtyToMarkAsQualifier) {"
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.apache.commons.collections.CollectionUtils;
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.core.offer.service.discount.PromotionQualifier;
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.core.order.domain.OrderItem;
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import java.util.Map.Entry;
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"protected boolean markTargets(PromotableCandidateItemOffer itemOffer, PromotableOrder order, OrderItem relatedQualifier) {"
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,// We want to find the root of the related qualifier so we can appropriately walk the tree later
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,OrderItem relatedQualifierRoot = null;
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (relatedQualifier != null) {
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,relatedQualifierRoot = relatedQualifier;
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,while (relatedQualifierRoot.getParentOrderItem() != null) {
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,relatedQualifierRoot = relatedQualifierRoot.getParentOrderItem();
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"// We need to make sure that this item is either a parent, child, or the same as the qualifier root"
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,OrderItem thisItem = priceDetail.getPromotableOrderItem().getOrderItem();
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (!relatedQualifierRoot.isAParentOf(thisItem) && !thisItem.isAParentOf(relatedQualifierRoot) &&
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,!thisItem.equals(relatedQualifierRoot)) {
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,continue;
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,/**
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"* When the {@link Offer#getRequiresRelatedTargetAndQualifiers()} flag is set to true, we must make sure that we"
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"* identify qualifiers and targets together, as they must be related to each other based on the"
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* {@link OrderItem#getParentOrderItem()} / {@link OrderItem#getChildOrderItems()} attributes.
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,*
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* @param itemOffer
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* @param order
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* @return whether or not a suitable qualifier/target pair was found and marked
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,*/
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"protected boolean markRelatedQualifiersAndTargets(PromotableCandidateItemOffer itemOffer, PromotableOrder order) {"
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"for (Entry<OfferItemCriteria, List<PromotableOrderItem>> entry : itemOffer.getCandidateQualifiersMap().entrySet()) {"
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,OfferItemCriteria itemCriteria = entry.getKey();
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,List<PromotableOrderItem> promotableItems = entry.getValue();
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,List<PromotableOrderItemPriceDetail> priceDetails = buildPriceDetailListFromOrderItems(promotableItems);
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"Collections.sort(priceDetails, getQualifierItemComparator(itemOffer.getOffer().getApplyDiscountToSalePrice()));"
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,// Calculate the number of qualifiers needed that will not receive the promotion.
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,// These will be reserved first before the target is assigned.
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,int qualifierQtyNeeded = itemCriteria.getQuantity();
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,for (PromotableOrderItemPriceDetail detail : priceDetails) {
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,OrderItem oi = detail.getPromotableOrderItem().getOrderItem();
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (qualifierQtyNeeded > 0) {
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,int itemQtyAvailableToBeUsedAsQualifier = detail.getQuantityAvailableToBeUsedAsQualifier(itemOffer);
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (itemQtyAvailableToBeUsedAsQualifier > 0) {
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"// We have found a qualifier that meets this offer criteria. First, we'll save some state that we"
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,// might need in the future.
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,OfferItemCriteria previousQualifierCriteria = null;
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,for (PromotionQualifier possibleQualifier : detail.getPromotionQualifiers()) {
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (possibleQualifier.getPromotion().equals(itemOffer.getOffer())) {
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,previousQualifierCriteria = possibleQualifier.getItemCriteria();
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,break;
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,// Go ahead and mark this item as a qualifier
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"int qtyToMarkAsQualifier = Math.min(qualifierQtyNeeded, itemQtyAvailableToBeUsedAsQualifier);"
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,qualifierQtyNeeded -= qtyToMarkAsQualifier;
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"PromotionQualifier pq = detail.addPromotionQualifier(itemOffer, itemCriteria, qtyToMarkAsQualifier);"
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"// Now, we need to see if there exists a target(s) that is suitable for this qualifier due to"
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,// the relationship flag.
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"if (!markTargets(itemOffer, order, oi)) {"
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"// If we didn't find a target, we need to roll back how we marked this item as a qualifier."
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,qualifierQtyNeeded += qtyToMarkAsQualifier;
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (pq.getQuantity() == qtyToMarkAsQualifier) {
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,detail.getPromotionQualifiers().remove(pq);
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,} else {
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,pq.setItemCriteria(previousQualifierCriteria);
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,pq.setQuantity(pq.getQuantity() - qtyToMarkAsQualifier);
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (qualifierQtyNeeded == 0) {
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (qualifierQtyNeeded != 0) {
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return false;
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return true;
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,boolean qualifiersFound = false;
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,boolean targetsFound = false;
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (itemOffer.getOffer().getRequiresRelatedTargetAndQualifiers()) {
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"boolean qualifiersAndTargetsFound = markRelatedQualifiersAndTargets(itemOffer, order);"
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,qualifiersFound = qualifiersAndTargetsFound;
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,targetsFound = qualifiersAndTargetsFound;
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"qualifiersFound = markQualifiers(itemOffer, order);"
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"targetsFound = markTargets(itemOffer, order, null);"
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.springframework.util.CollectionUtils;
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"protected boolean markTargets(PromotableCandidateItemOffer itemOffer, PromotableOrder order) {"
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"boolean qualifiersFound = markQualifiers(itemOffer, order);"
b89d95db4fb73909601a156ac6ba05c6cc835332,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"boolean targetsFound = markTargets(itemOffer, order);"
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import org.apache.commons.collections.CollectionUtils;
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import org.broadleafcommerce.core.offer.service.discount.PromotionQualifier;
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import org.broadleafcommerce.core.order.domain.OrderItem;
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import java.util.Map.Entry;
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"protected boolean markTargets(PromotableCandidateItemOffer itemOffer, PromotableOrder order, OrderItem relatedQualifier) {"
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,// We want to find the root of the related qualifier so we can appropriately walk the tree later
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,OrderItem relatedQualifierRoot = null;
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,if (relatedQualifier != null) {
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,relatedQualifierRoot = relatedQualifier;
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,while (relatedQualifierRoot.getParentOrderItem() != null) {
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,relatedQualifierRoot = relatedQualifierRoot.getParentOrderItem();
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,}
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"// We need to make sure that this item is either a parent, child, or the same as the qualifier root"
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,OrderItem thisItem = priceDetail.getPromotableOrderItem().getOrderItem();
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,if (!relatedQualifierRoot.isAParentOf(thisItem) && !thisItem.isAParentOf(relatedQualifierRoot) &&
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,!thisItem.equals(relatedQualifierRoot)) {
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,continue;
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,/**
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"* When the {@link Offer#getRequiresRelatedTargetAndQualifiers()} flag is set to true, we must make sure that we"
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"* identify qualifiers and targets together, as they must be related to each other based on the"
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,* {@link OrderItem#getParentOrderItem()} / {@link OrderItem#getChildOrderItems()} attributes.
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,*
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,* @param itemOffer
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,* @param order
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,* @return whether or not a suitable qualifier/target pair was found and marked
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,*/
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"protected boolean markRelatedQualifiersAndTargets(PromotableCandidateItemOffer itemOffer, PromotableOrder order) {"
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"for (Entry<OfferItemCriteria, List<PromotableOrderItem>> entry : itemOffer.getCandidateQualifiersMap().entrySet()) {"
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,OfferItemCriteria itemCriteria = entry.getKey();
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,List<PromotableOrderItem> promotableItems = entry.getValue();
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,List<PromotableOrderItemPriceDetail> priceDetails = buildPriceDetailListFromOrderItems(promotableItems);
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"Collections.sort(priceDetails, getQualifierItemComparator(itemOffer.getOffer().getApplyDiscountToSalePrice()));"
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,// Calculate the number of qualifiers needed that will not receive the promotion.
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,// These will be reserved first before the target is assigned.
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,int qualifierQtyNeeded = itemCriteria.getQuantity();
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,for (PromotableOrderItemPriceDetail detail : priceDetails) {
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,OrderItem oi = detail.getPromotableOrderItem().getOrderItem();
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,if (qualifierQtyNeeded > 0) {
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,int itemQtyAvailableToBeUsedAsQualifier = detail.getQuantityAvailableToBeUsedAsQualifier(itemOffer);
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,if (itemQtyAvailableToBeUsedAsQualifier > 0) {
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"// We have found a qualifier that meets this offer criteria. First, we'll save some state that we"
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,// might need in the future.
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,OfferItemCriteria previousQualifierCriteria = null;
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,for (PromotionQualifier possibleQualifier : detail.getPromotionQualifiers()) {
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,if (possibleQualifier.getPromotion().equals(itemOffer.getOffer())) {
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,previousQualifierCriteria = possibleQualifier.getItemCriteria();
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,break;
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,// Go ahead and mark this item as a qualifier
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"int qtyToMarkAsQualifier = Math.min(qualifierQtyNeeded, itemQtyAvailableToBeUsedAsQualifier);"
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,qualifierQtyNeeded -= qtyToMarkAsQualifier;
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"PromotionQualifier pq = detail.addPromotionQualifier(itemOffer, itemCriteria, qtyToMarkAsQualifier);"
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"// Now, we need to see if there exists a target(s) that is suitable for this qualifier due to"
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,// the relationship flag.
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"if (!markTargets(itemOffer, order, oi)) {"
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"// If we didn't find a target, we need to roll back how we marked this item as a qualifier."
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,qualifierQtyNeeded += qtyToMarkAsQualifier;
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,if (pq.getQuantity() == qtyToMarkAsQualifier) {
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,detail.getPromotionQualifiers().remove(pq);
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,} else {
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,pq.setItemCriteria(previousQualifierCriteria);
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,pq.setQuantity(pq.getQuantity() - qtyToMarkAsQualifier);
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,if (qualifierQtyNeeded == 0) {
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,if (qualifierQtyNeeded != 0) {
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,return false;
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,return true;
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,boolean qualifiersFound = false;
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,boolean targetsFound = false;
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,if (itemOffer.getOffer().getRequiresRelatedTargetAndQualifiers()) {
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"boolean qualifiersAndTargetsFound = markRelatedQualifiersAndTargets(itemOffer, order);"
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,qualifiersFound = qualifiersAndTargetsFound;
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,targetsFound = qualifiersAndTargetsFound;
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"qualifiersFound = markQualifiers(itemOffer, order);"
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"targetsFound = markTargets(itemOffer, order, null);"
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,import org.springframework.util.CollectionUtils;
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"protected boolean markTargets(PromotableCandidateItemOffer itemOffer, PromotableOrder order) {"
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"boolean qualifiersFound = markQualifiers(itemOffer, order);"
b89d95db4fb73909601a156ac6ba05c6cc835332,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"boolean targetsFound = markTargets(itemOffer, order);"
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,import org.apache.commons.collections.CollectionUtils;
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,import org.broadleafcommerce.core.offer.service.discount.PromotionQualifier;
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,import org.broadleafcommerce.core.order.domain.OrderItem;
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,import java.util.Map.Entry;
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,"protected boolean markTargets(PromotableCandidateItemOffer itemOffer, PromotableOrder order, OrderItem relatedQualifier) {"
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,// We want to find the root of the related qualifier so we can appropriately walk the tree later
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,OrderItem relatedQualifierRoot = null;
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,if (relatedQualifier != null) {
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,relatedQualifierRoot = relatedQualifier;
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,while (relatedQualifierRoot.getParentOrderItem() != null) {
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,relatedQualifierRoot = relatedQualifierRoot.getParentOrderItem();
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,}
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,"// We need to make sure that this item is either a parent, child, or the same as the qualifier root"
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,OrderItem thisItem = priceDetail.getPromotableOrderItem().getOrderItem();
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,if (!relatedQualifierRoot.isAParentOf(thisItem) && !thisItem.isAParentOf(relatedQualifierRoot) &&
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,!thisItem.equals(relatedQualifierRoot)) {
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,continue;
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,/**
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,"* When the {@link Offer#getRequiresRelatedTargetAndQualifiers()} flag is set to true, we must make sure that we"
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,"* identify qualifiers and targets together, as they must be related to each other based on the"
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,* {@link OrderItem#getParentOrderItem()} / {@link OrderItem#getChildOrderItems()} attributes.
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,*
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,* @param itemOffer
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,* @param order
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,* @return whether or not a suitable qualifier/target pair was found and marked
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,*/
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,"protected boolean markRelatedQualifiersAndTargets(PromotableCandidateItemOffer itemOffer, PromotableOrder order) {"
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,"for (Entry<OfferItemCriteria, List<PromotableOrderItem>> entry : itemOffer.getCandidateQualifiersMap().entrySet()) {"
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,OfferItemCriteria itemCriteria = entry.getKey();
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,List<PromotableOrderItem> promotableItems = entry.getValue();
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,List<PromotableOrderItemPriceDetail> priceDetails = buildPriceDetailListFromOrderItems(promotableItems);
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,"Collections.sort(priceDetails, getQualifierItemComparator(itemOffer.getOffer().getApplyDiscountToSalePrice()));"
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,// Calculate the number of qualifiers needed that will not receive the promotion.
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,// These will be reserved first before the target is assigned.
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,int qualifierQtyNeeded = itemCriteria.getQuantity();
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,for (PromotableOrderItemPriceDetail detail : priceDetails) {
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,OrderItem oi = detail.getPromotableOrderItem().getOrderItem();
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,if (qualifierQtyNeeded > 0) {
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,int itemQtyAvailableToBeUsedAsQualifier = detail.getQuantityAvailableToBeUsedAsQualifier(itemOffer);
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,if (itemQtyAvailableToBeUsedAsQualifier > 0) {
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,"// We have found a qualifier that meets this offer criteria. First, we'll save some state that we"
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,// might need in the future.
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,OfferItemCriteria previousQualifierCriteria = null;
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,for (PromotionQualifier possibleQualifier : detail.getPromotionQualifiers()) {
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,if (possibleQualifier.getPromotion().equals(itemOffer.getOffer())) {
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,previousQualifierCriteria = possibleQualifier.getItemCriteria();
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,break;
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,// Go ahead and mark this item as a qualifier
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,"int qtyToMarkAsQualifier = Math.min(qualifierQtyNeeded, itemQtyAvailableToBeUsedAsQualifier);"
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,qualifierQtyNeeded -= qtyToMarkAsQualifier;
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,"PromotionQualifier pq = detail.addPromotionQualifier(itemOffer, itemCriteria, qtyToMarkAsQualifier);"
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,"// Now, we need to see if there exists a target(s) that is suitable for this qualifier due to"
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,// the relationship flag.
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,"if (!markTargets(itemOffer, order, oi)) {"
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,"// If we didn't find a target, we need to roll back how we marked this item as a qualifier."
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,qualifierQtyNeeded += qtyToMarkAsQualifier;
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,if (pq.getQuantity() == qtyToMarkAsQualifier) {
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,detail.getPromotionQualifiers().remove(pq);
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,} else {
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,pq.setItemCriteria(previousQualifierCriteria);
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,pq.setQuantity(pq.getQuantity() - qtyToMarkAsQualifier);
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,if (qualifierQtyNeeded == 0) {
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,if (qualifierQtyNeeded != 0) {
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,return false;
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,return true;
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,boolean qualifiersFound = false;
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,boolean targetsFound = false;
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,if (itemOffer.getOffer().getRequiresRelatedTargetAndQualifiers()) {
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,"boolean qualifiersAndTargetsFound = markRelatedQualifiersAndTargets(itemOffer, order);"
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,qualifiersFound = qualifiersAndTargetsFound;
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,targetsFound = qualifiersAndTargetsFound;
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,"qualifiersFound = markQualifiers(itemOffer, order);"
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,"targetsFound = markTargets(itemOffer, order, null);"
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,import org.springframework.util.CollectionUtils;
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,"protected boolean markTargets(PromotableCandidateItemOffer itemOffer, PromotableOrder order) {"
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,"boolean qualifiersFound = markQualifiers(itemOffer, order);"
b89d95db4fb73909601a156ac6ba05c6cc835332,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,"boolean targetsFound = markTargets(itemOffer, order);"
63fbd9cf0e68a367c947b8ca8fb30c0585b02366,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"public Serializable createPopulatedInstance(Serializable instance, Entity entity,"
63fbd9cf0e68a367c947b8ca8fb30c0585b02366,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"Map<String, FieldMetadata> unfilteredProperties, Boolean setId) throws ValidationException {"
63fbd9cf0e68a367c947b8ca8fb30c0585b02366,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"return createPopulatedInstance(instance, entity, unfilteredProperties, setId, true);"
63fbd9cf0e68a367c947b8ca8fb30c0585b02366,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,}
63fbd9cf0e68a367c947b8ca8fb30c0585b02366,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,@Override
63fbd9cf0e68a367c947b8ca8fb30c0585b02366,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"Map<String, FieldMetadata> unfilteredProperties, Boolean setId, Boolean validateUnsubmittedProperties) throws ValidationException {"
63fbd9cf0e68a367c947b8ca8fb30c0585b02366,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"validate(entity, instance, mergedProperties, validateUnsubmittedProperties);"
63fbd9cf0e68a367c947b8ca8fb30c0585b02366,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"instance = createPopulatedInstance(instance, entity, mergedProperties, false, persistencePackage.isValidateUnsubmittedProperties());"
63fbd9cf0e68a367c947b8ca8fb30c0585b02366,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"return validate(entity, populatedInstance, mergedProperties, true);"
63fbd9cf0e68a367c947b8ca8fb30c0585b02366,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"public boolean validate(Entity entity, Serializable populatedInstance, Map<String, FieldMetadata> mergedProperties,"
63fbd9cf0e68a367c947b8ca8fb30c0585b02366,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,boolean validateUnsubmittedProperties) {
63fbd9cf0e68a367c947b8ca8fb30c0585b02366,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"entityValidatorService.validate(entity, populatedInstance, mergedProperties, validateUnsubmittedProperties);"
63fbd9cf0e68a367c947b8ca8fb30c0585b02366,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"public Serializable createPopulatedInstance(Serializable instance, Entity entity, Map<String, FieldMetadata> unfilteredProperties, Boolean setId) throws ValidationException {"
63fbd9cf0e68a367c947b8ca8fb30c0585b02366,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"validate(entity, instance, mergedProperties);"
63fbd9cf0e68a367c947b8ca8fb30c0585b02366,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"instance = createPopulatedInstance(instance, entity, mergedProperties, false);"
63fbd9cf0e68a367c947b8ca8fb30c0585b02366,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"entityValidatorService.validate(entity, populatedInstance, mergedProperties);"
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import java.util.Currency;
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import java.util.HashMap;
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import java.util.Map;
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import java.util.TimeZone;
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import javax.servlet.http.HttpServletRequest;
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import javax.servlet.http.HttpServletResponse;
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.common.classloader.release.ThreadLocalManager;
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,this.webRequest = new ServletWebRequest(request);
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (webRequest instanceof ServletWebRequest) {
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,this.request = ((ServletWebRequest) webRequest).getRequest();
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,setResponse(((ServletWebRequest) webRequest).getResponse());
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import org.broadleafcommerce.common.classloader.release.ThreadLocalManager;
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import javax.servlet.http.HttpServletRequest;
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import javax.servlet.http.HttpServletResponse;
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import java.util.Currency;
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import java.util.HashMap;
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import java.util.Map;
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import java.util.TimeZone;
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (webRequest == null) {
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,setWebRequest(new ServletWebRequest(request));
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,}
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (this.request == null) {
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (webRequest instanceof ServletWebRequest) {
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,setRequest(((ServletWebRequest) webRequest).getRequest());
fc7f05dbdeacb4b369e80599b65ad23cb4b63db2,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,setResponse(((ServletWebRequest) webRequest).getResponse());
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.io.Serializable;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.lang.reflect.Field;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.lang.reflect.InvocationTargetException;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.lang.reflect.Method;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.lang.reflect.ParameterizedType;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.math.BigDecimal;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.sql.Timestamp;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.text.DecimalFormat;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.text.NumberFormat;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.text.SimpleDateFormat;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.util.ArrayList;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.util.Calendar;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.util.Collection;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.util.Collections;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.util.Comparator;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.util.Date;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.util.HashMap;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.util.List;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.util.Locale;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.util.Map;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.util.Map.Entry;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import java.util.StringTokenizer;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import javax.annotation.Resource;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import javax.persistence.criteria.CriteriaBuilder;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import javax.persistence.criteria.From;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import javax.persistence.criteria.Path;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,import javax.persistence.criteria.Predicate;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,"Collection collection = (Collection) fieldManager.getFieldValue(foreignInstance, foreignKey.getOriginatingField());"
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,added,0,collection.remove(instance);
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.io.Serializable;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.lang.reflect.Field;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.lang.reflect.InvocationTargetException;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.lang.reflect.Method;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.lang.reflect.ParameterizedType;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.math.BigDecimal;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.sql.Timestamp;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.text.DecimalFormat;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.text.NumberFormat;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.text.SimpleDateFormat;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.util.ArrayList;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.util.Calendar;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.util.Collection;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.util.Collections;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.util.Comparator;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.util.Date;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.util.HashMap;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.util.List;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.util.Locale;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.util.Map;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.util.Map.Entry;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import java.util.StringTokenizer;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import javax.annotation.Resource;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import javax.persistence.criteria.CriteriaBuilder;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import javax.persistence.criteria.From;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import javax.persistence.criteria.Path;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,import javax.persistence.criteria.Predicate;
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,"Collection collection = (Collection) fieldManager.getFieldValue(instance, property.getName());"
144680e9ac6a69a34b954adc6841768c28b81aeb,c8c764b456d52bdbea69567c3b0b66f188c1e953,deleted,1,collection.remove(foreignInstance);
f4eeb23940944a32d5ddd3d6ea534798c55cfa34,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (saleAdjustmentPrice.lessThanOrEqual(retailAdjustmentPrice)) {
f4eeb23940944a32d5ddd3d6ea534798c55cfa34,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (saleAdjustmentPrice.lessThan(retailAdjustmentPrice)) {
fe17993761e226be070c82026d96ca1e08bf85d5,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,fulfillmentGroupOfferProcessor.calculateFulfillmentGroupTotal(promotableOrder);
fe17993761e226be070c82026d96ca1e08bf85d5,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,orderOfferProcessor.synchronizeAdjustmentsAndPrices(promotableOrder);
fe17993761e226be070c82026d96ca1e08bf85d5,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,fulfillmentGroupOfferProcessor.calculateFulfillmentGroupTotal(promotableOrder);
fe17993761e226be070c82026d96ca1e08bf85d5,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,orderOfferProcessor.synchronizeAdjustmentsAndPrices(promotableOrder);
fe17993761e226be070c82026d96ca1e08bf85d5,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,if (skuSalePrice != null && !skuSalePrice.getAmount().equals(salePrice)) {
fe17993761e226be070c82026d96ca1e08bf85d5,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,if (!skuRetailPrice.getAmount().equals(retailPrice)) {
fe17993761e226be070c82026d96ca1e08bf85d5,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,if (skuSalePrice != null && !skuSalePrice.equals(salePrice)) {
fe17993761e226be070c82026d96ca1e08bf85d5,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,if (!skuRetailPrice.equals(retailPrice)) {
fe17993761e226be070c82026d96ca1e08bf85d5,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,import java.lang.reflect.Method;
fe17993761e226be070c82026d96ca1e08bf85d5,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,import java.math.BigDecimal;
fe17993761e226be070c82026d96ca1e08bf85d5,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,import java.util.ArrayList;
fe17993761e226be070c82026d96ca1e08bf85d5,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,import java.util.HashMap;
fe17993761e226be070c82026d96ca1e08bf85d5,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,import java.util.List;
fe17993761e226be070c82026d96ca1e08bf85d5,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,import java.util.Map;
fe17993761e226be070c82026d96ca1e08bf85d5,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,boolean retailPriceOverride = false;
fe17993761e226be070c82026d96ca1e08bf85d5,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,for (OrderItemPriceDetail oipd : getOrderItemPriceDetails()) {
fe17993761e226be070c82026d96ca1e08bf85d5,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,if (oipd.getUseSalePrice() == false) {
fe17993761e226be070c82026d96ca1e08bf85d5,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,retailPriceOverride = true;
fe17993761e226be070c82026d96ca1e08bf85d5,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,break;
fe17993761e226be070c82026d96ca1e08bf85d5,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,}
fe17993761e226be070c82026d96ca1e08bf85d5,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,if (allowSalesPrice && !retailPriceOverride) {
fe17993761e226be070c82026d96ca1e08bf85d5,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,import java.lang.reflect.Method;
fe17993761e226be070c82026d96ca1e08bf85d5,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,import java.math.BigDecimal;
fe17993761e226be070c82026d96ca1e08bf85d5,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,import java.util.ArrayList;
fe17993761e226be070c82026d96ca1e08bf85d5,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,import java.util.HashMap;
fe17993761e226be070c82026d96ca1e08bf85d5,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,import java.util.List;
fe17993761e226be070c82026d96ca1e08bf85d5,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,import java.util.Map;
fe17993761e226be070c82026d96ca1e08bf85d5,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,if (allowSalesPrice) {
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public Long getId();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public void setId(Long id);
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public Double getRating();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public void setRating(Double newRating);
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public Customer getCustomer();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public void setCustomer(Customer customer);
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public Date getRatingSubmittedDate();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public void setRatingSubmittedDate(Date ratingSubmittedDate);
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public RatingSummary getRatingSummary();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public void setRatingSummary(RatingSummary ratingSummary);
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,Long getId();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,Double getRating();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,void setRating(Double newRating);
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,Customer getCustomer();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,Date getRatingSubmittedDate();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,RatingSummary getRatingSummary();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public Long getId();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public void setId(Long id);
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public RatingType getRatingType();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public void setRatingType(RatingType ratingType);
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public String getItemId();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public void setItemId(String itemId);
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public Integer getNumberOfRatings();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public Integer getNumberOfReviews();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public Double getAverageRating();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public void resetAverageRating();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public List<ReviewDetail> getReviews();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public void setReviews(List<ReviewDetail> reviews);
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public List<RatingDetail> getRatings();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public void setRatings(List<RatingDetail> ratings);
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,Long getId();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,RatingType getRatingType();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,String getItemId();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,Integer getNumberOfRatings();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,Integer getNumberOfReviews();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,Double getAverageRating();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,void resetAverageRating();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,List<ReviewDetail> getReviews();
ce893c709164fac816da561fb3ab6e6ca2c48c0e,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,List<RatingDetail> getRatings();
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return isTotalitarianFgOfferApplied() || isTotalitarianItemOfferApplied() || isTotalitarianOrderOfferApplied();
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,@Override
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public boolean isTotalitarianOrderOfferApplied() {
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return true;
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return false;
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public boolean isTotalitarianItemOfferApplied() {
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,for (PromotableOrderItemPriceDetail itemPriceDetail : getAllPromotableOrderItemPriceDetails()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (itemPriceDetail.isTotalitarianOfferApplied()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public boolean isTotalitarianFgOfferApplied() {
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,for (PromotableFulfillmentGroup fg : getFulfillmentGroups()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (fg.isTotalitarianOfferApplied()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,boolean totalitarianOfferApplied = false;
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,totalitarianOfferApplied = true;
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,break;
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (!totalitarianOfferApplied) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (PromotableOrderItemPriceDetail itemPriceDetail : getAllPromotableOrderItemPriceDetails()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,totalitarianOfferApplied = itemPriceDetail.isTotalitarianOfferApplied();
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (PromotableFulfillmentGroup fg : getFulfillmentGroups()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (fg.isTotalitarianOfferApplied()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return true;
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,}
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return totalitarianOfferApplied;
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (isTotalitarianOfferApplied()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return false;
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,added,0,return isTotalitarianFgOfferApplied() || isTotalitarianItemOfferApplied() || isTotalitarianOrderOfferApplied();
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,added,0,}
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,added,0,@Override
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,added,0,public boolean isTotalitarianOrderOfferApplied() {
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,added,0,return true;
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,added,0,return false;
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,added,0,public boolean isTotalitarianItemOfferApplied() {
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,added,0,for (PromotableOrderItemPriceDetail itemPriceDetail : getAllPromotableOrderItemPriceDetails()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,added,0,if (itemPriceDetail.isTotalitarianOfferApplied()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,added,0,public boolean isTotalitarianFgOfferApplied() {
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,added,0,for (PromotableFulfillmentGroup fg : getFulfillmentGroups()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,added,0,if (fg.isTotalitarianOfferApplied()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,boolean totalitarianOfferApplied = false;
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,totalitarianOfferApplied = true;
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,break;
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,if (!totalitarianOfferApplied) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,for (PromotableOrderItemPriceDetail itemPriceDetail : getAllPromotableOrderItemPriceDetails()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,totalitarianOfferApplied = itemPriceDetail.isTotalitarianOfferApplied();
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,for (PromotableFulfillmentGroup fg : getFulfillmentGroups()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,if (fg.isTotalitarianOfferApplied()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,return true;
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,}
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,return totalitarianOfferApplied;
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,if (isTotalitarianOfferApplied()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,return false;
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,added,0,return isTotalitarianFgOfferApplied() || isTotalitarianItemOfferApplied() || isTotalitarianOrderOfferApplied();
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,added,0,}
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,added,0,@Override
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,added,0,public boolean isTotalitarianOrderOfferApplied() {
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,added,0,return true;
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,added,0,return false;
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,added,0,public boolean isTotalitarianItemOfferApplied() {
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,added,0,for (PromotableOrderItemPriceDetail itemPriceDetail : getAllPromotableOrderItemPriceDetails()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,added,0,if (itemPriceDetail.isTotalitarianOfferApplied()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,added,0,public boolean isTotalitarianFgOfferApplied() {
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,added,0,for (PromotableFulfillmentGroup fg : getFulfillmentGroups()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,added,0,if (fg.isTotalitarianOfferApplied()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,deleted,1,boolean totalitarianOfferApplied = false;
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,deleted,1,totalitarianOfferApplied = true;
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,deleted,1,break;
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,deleted,1,if (!totalitarianOfferApplied) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,deleted,1,for (PromotableOrderItemPriceDetail itemPriceDetail : getAllPromotableOrderItemPriceDetails()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,deleted,1,totalitarianOfferApplied = itemPriceDetail.isTotalitarianOfferApplied();
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,deleted,1,for (PromotableFulfillmentGroup fg : getFulfillmentGroups()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,deleted,1,if (fg.isTotalitarianOfferApplied()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,deleted,1,return true;
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,deleted,1,}
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,deleted,1,return totalitarianOfferApplied;
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,deleted,1,if (isTotalitarianOfferApplied()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,deleted,1,return false;
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (orderOffer.isTotalitarian() || promotableOrder.isTotalitarianItemOfferApplied()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"// We continue because this could be the first offer and marked as totalitarian, but not as good as an"
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,// item offer. There could be other order offers that are not totalitarian that also qualify.
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,continue;
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (orderOffer.isTotalitarian()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,continue;
e7a899ea7bb28bdc856bb322a75f40bff590562a,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,if (orderOffer.isTotalitarian() || promotableOrder.isTotalitarianItemOfferApplied()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"// We continue because this could be the first offer and marked as totalitarian, but not as good as an"
e7a899ea7bb28bdc856bb322a75f40bff590562a,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,// item offer. There could be other order offers that are not totalitarian that also qualify.
e7a899ea7bb28bdc856bb322a75f40bff590562a,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,continue;
e7a899ea7bb28bdc856bb322a75f40bff590562a,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (orderOffer.isTotalitarian()) {
e7a899ea7bb28bdc856bb322a75f40bff590562a,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,continue;
424b91fc8bed0fd8675162f9d9a1a20c21534777,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"protected boolean markTargets(PromotableCandidateItemOffer itemOffer, PromotableOrder order, OrderItem relatedQualifier) {"
424b91fc8bed0fd8675162f9d9a1a20c21534777,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"return markTargets(itemOffer, order, relatedQualifier, false);"
424b91fc8bed0fd8675162f9d9a1a20c21534777,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
424b91fc8bed0fd8675162f9d9a1a20c21534777,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"protected boolean markTargets(PromotableCandidateItemOffer itemOffer, PromotableOrder order, OrderItem relatedQualifier,"
424b91fc8bed0fd8675162f9d9a1a20c21534777,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,boolean checkOnly) {
424b91fc8bed0fd8675162f9d9a1a20c21534777,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (!checkOnly) {
424b91fc8bed0fd8675162f9d9a1a20c21534777,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"priceDetail.addPromotionDiscount(itemOffer, itemOffer.getOffer().getTargetItemCriteria(), qtyToMarkAsTarget);"
424b91fc8bed0fd8675162f9d9a1a20c21534777,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,itemOffer.addUse();
424b91fc8bed0fd8675162f9d9a1a20c21534777,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,int curQualifier = 0;
424b91fc8bed0fd8675162f9d9a1a20c21534777,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,curQualifier++;
424b91fc8bed0fd8675162f9d9a1a20c21534777,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"// the relationship flag. If we are on the last qualifier required for this offer, we want to"
424b91fc8bed0fd8675162f9d9a1a20c21534777,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"// actually go ahead and mark the target that we'll be using. Otherwise, we just want to check"
424b91fc8bed0fd8675162f9d9a1a20c21534777,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,// that there is an eligible target(s) and continue on.
424b91fc8bed0fd8675162f9d9a1a20c21534777,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,boolean lastQualifier = curQualifier == itemOffer.getCandidateQualifiersMap().entrySet().size();
424b91fc8bed0fd8675162f9d9a1a20c21534777,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"if (!markTargets(itemOffer, order, oi, !lastQualifier)) {"
424b91fc8bed0fd8675162f9d9a1a20c21534777,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"protected boolean markTargets(PromotableCandidateItemOffer itemOffer, PromotableOrder order, OrderItem relatedQualifier) {"
424b91fc8bed0fd8675162f9d9a1a20c21534777,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"priceDetail.addPromotionDiscount(itemOffer, itemOffer.getOffer().getTargetItemCriteria(), qtyToMarkAsTarget);"
424b91fc8bed0fd8675162f9d9a1a20c21534777,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,itemOffer.addUse();
424b91fc8bed0fd8675162f9d9a1a20c21534777,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// the relationship flag.
424b91fc8bed0fd8675162f9d9a1a20c21534777,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"if (!markTargets(itemOffer, order, oi)) {"
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,import org.hibernate.annotations.GenericGenerator;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,import org.hibernate.annotations.Parameter;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,import javax.persistence.Column;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,import javax.persistence.Entity;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,import javax.persistence.GeneratedValue;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,import javax.persistence.Id;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,import javax.persistence.Inheritance;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,import javax.persistence.InheritanceType;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,import javax.persistence.JoinColumn;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,import javax.persistence.ManyToOne;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,import javax.persistence.Table;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region = ""blCategories"")"
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,@Id
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,"@GeneratedValue(generator = ""CategoryProductId"")"
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,@GenericGenerator(
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,"name = ""CategoryProductId"","
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,"strategy = ""org.broadleafcommerce.common.persistence.IdOverrideTableGenerator"","
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,parameters = {
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,"@Parameter(name = ""segment_value"", value = ""CategoryProductXrefImpl""),"
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,"@Parameter(name = ""entity_name"", value = ""org.broadleafcommerce.core.catalog.domain.CategoryProductXrefImpl"")"
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,})
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,"@Column(name = ""CATEGORY_PRODUCT_ID"")"
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,protected Long id;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,"@ManyToOne(targetEntity = CategoryImpl.class, optional = false)"
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,"@JoinColumn(name = ""CATEGORY_ID"", nullable = false)"
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,protected Category category = new CategoryImpl();
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,/** The product. */
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,"@ManyToOne(targetEntity = ProductImpl.class, optional = false)"
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,"@JoinColumn(name = ""PRODUCT_ID"", nullable = false)"
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,protected Product product = new ProductImpl();
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,@Override
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,return category;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,this.category = category;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,return product;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,this.product = product;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,}
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,public Long getId() {
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,return id;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,public void setId(Long id) {
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,this.id = id;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,if (this == o) return true;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,if (!(o instanceof CategoryProductXrefImpl)) return false;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,CategoryProductXrefImpl that = (CategoryProductXrefImpl) o;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,if (category != null ? !category.equals(that.category) : that.category != null) return false;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,if (displayOrder != null ? !displayOrder.equals(that.displayOrder) : that.displayOrder != null) return false;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,if (id != null ? !id.equals(that.id) : that.id != null) return false;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,if (product != null ? !product.equals(that.product) : that.product != null) return false;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,return true;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,int result = id != null ? id.hashCode() : 0;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,result = 31 * result + (category != null ? category.hashCode() : 0);
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,result = 31 * result + (product != null ? product.hashCode() : 0);
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,added,0,result = 31 * result + (displayOrder != null ? displayOrder.hashCode() : 0);
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,import javax.persistence.Column;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,import javax.persistence.EmbeddedId;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,import javax.persistence.Entity;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,import javax.persistence.Inheritance;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,import javax.persistence.InheritanceType;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,import javax.persistence.Table;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,import org.apache.commons.lang3.builder.EqualsBuilder;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region=""blStandardElements"")"
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,@EmbeddedId
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,CategoryProductXrefPK categoryProductXref = new CategoryProductXrefPK();
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,public CategoryProductXrefPK getCategoryProductXref() {
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,return categoryProductXref;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,}
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,public void setCategoryProductXref(CategoryProductXrefPK categoryProductXref) {
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,this.categoryProductXref = categoryProductXref;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,/* (non-Javadoc)
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,* @see org.broadleafcommerce.core.catalog.domain.CategoryProductXref#getDisplayOrder()
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,*/
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,* @see org.broadleafcommerce.core.catalog.domain.CategoryProductXref#setDisplayOrder(java.lang.Integer)
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,/**
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,* @return
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,* @see org.broadleafcommerce.core.catalog.domain.CategoryProductXrefImpl.CategoryProductXrefPK#getCategory()
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,return categoryProductXref.getCategory();
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,* @param category
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,* @see org.broadleafcommerce.core.catalog.domain.CategoryProductXrefImpl.CategoryProductXrefPK#setCategory(org.broadleafcommerce.core.catalog.domain.Category)
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,categoryProductXref.setCategory(category);
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,* @see org.broadleafcommerce.core.catalog.domain.CategoryProductXrefImpl.CategoryProductXrefPK#getProduct()
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,return categoryProductXref.getProduct();
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,* @param product
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,* @see org.broadleafcommerce.core.catalog.domain.CategoryProductXrefImpl.CategoryProductXrefPK#setProduct(org.broadleafcommerce.core.catalog.domain.Product)
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,categoryProductXref.setProduct(product);
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,if (o instanceof CategoryProductXrefImpl) {
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,CategoryProductXrefImpl that = (CategoryProductXrefImpl) o;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,return new EqualsBuilder()
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,".append(categoryProductXref, that.categoryProductXref)"
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,.build();
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,return false;
004929d84fb98e7ef2a6964dfba0258761e27686,dc89225aeb0806ee2fe5246ce20c3cee065d1245,deleted,1,int result = categoryProductXref != null ? categoryProductXref.hashCode() : 0;
405bfd63c1a2c4b4689df40a0f820e795fce572a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,@Override
405bfd63c1a2c4b4689df40a0f820e795fce572a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if ((promotion.isUnlimitedUsePerOrder()) || (itemOffer.getUses() < promotion.getMaxUsesPerOrder())) {
405bfd63c1a2c4b4689df40a0f820e795fce572a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if ((promotion.getMaxUses() == 0) || (itemOffer.getUses() < promotion.getMaxUses())) {
70acd4406bbba63b932739a08c70d01d6148440f,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,strVal = getDecimalFormatter().format(key);
70acd4406bbba63b932739a08c70d01d6148440f,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,strVal = decimalFormat.format(key);
70acd4406bbba63b932739a08c70d01d6148440f,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,strVal = decimalFormat.format(((BigDecimal) key).doubleValue());
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,import org.apache.solr.client.solrj.SolrServer;
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,Object[] pack = saveState();
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,optimizeIndex(SolrContext.getReindexServer());
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,restoreState(pack);
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,"String deleteQuery = shs.getNamespaceFieldName() + "":(\"""" + shs.getCurrentNamespace() + ""\"")"";"
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,"buildIncrementalIndex(page, pageSize, true);"
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,}
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,@Override
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,"public void buildIncrementalIndex(int page, int pageSize, boolean useReindexServer) throws ServiceException {"
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,SolrServer server = useReindexServer ? SolrContext.getReindexServer() : SolrContext.getServer();
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,server.add(documents);
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,server.commit();
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,public Object[] saveState() {
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,return new Object[] {
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,"BroadleafRequestContext.getBroadleafRequestContext(),"
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,"SkuPricingConsiderationContext.getSkuPricingConsiderationContext(),"
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,"SkuPricingConsiderationContext.getSkuPricingService(),"
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,SkuActiveDateConsiderationContext.getSkuActiveDatesService()
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,};
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,"@SuppressWarnings(""rawtypes"")"
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,public void restoreState(Object[] pack) {
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,BroadleafRequestContext.setBroadleafRequestContext((BroadleafRequestContext) pack[0]);
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,SkuPricingConsiderationContext.setSkuPricingConsiderationContext((HashMap) pack[1]);
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,SkuPricingConsiderationContext.setSkuPricingService((DynamicSkuPricingService) pack[2]);
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,SkuActiveDateConsiderationContext.setSkuActiveDatesService((DynamicSkuActiveDatesService) pack[3]);
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,"public void optimizeIndex(SolrServer server) throws ServiceException, IOException {"
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,try {
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,if (LOG.isDebugEnabled()) {
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,"LOG.debug(""Optimizing the index..."");"
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,server.optimize();
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,} catch (SolrServerException e) {
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,"throw new ServiceException(""Could not optimize index"", e);"
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,// Populate the reindex core with the necessary information
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,BroadleafRequestContext savedContext = BroadleafRequestContext.getBroadleafRequestContext();
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,HashMap savedPricing = SkuPricingConsiderationContext.getSkuPricingConsiderationContext();
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,DynamicSkuPricingService savedPricingService = SkuPricingConsiderationContext.getSkuPricingService();
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,DynamicSkuActiveDatesService savedActiveDateServcie = SkuActiveDateConsiderationContext.getSkuActiveDatesService();
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,try {
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,if (LOG.isDebugEnabled()) {
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,"LOG.debug(""Optimizing the index..."");"
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,}
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,SolrContext.getReindexServer().optimize();
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,} catch (SolrServerException e) {
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,"throw new ServiceException(""Could not rebuild index"", e);"
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,"// Restore the current context, regardless of whether an exception happened or not"
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,BroadleafRequestContext.setBroadleafRequestContext(savedContext);
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,SkuPricingConsiderationContext.setSkuPricingConsiderationContext(savedPricing);
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,SkuPricingConsiderationContext.setSkuPricingService(savedPricingService);
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,SkuActiveDateConsiderationContext.setSkuActiveDatesService(savedActiveDateServcie);
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,"String deleteQuery = ""*:*"";"
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,SolrContext.getReindexServer().add(documents);
6e4817e9be99e77f9661ea1f0172a2f90fd48c13,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,SolrContext.getReindexServer().commit();
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"protected HashMap<OfferItemCriteria, List<PromotableOrderItem>> candidateQualifiersMap ="
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"new HashMap<OfferItemCriteria, List<PromotableOrderItem>>();"
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"protected HashMap<OfferItemCriteria, List<PromotableOrderItem>> candidateTargetsMap ="
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected List<PromotableOrderItem> legacyCandidateTargets = new ArrayList<PromotableOrderItem>();
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,for (OfferItemCriteria itemCriteria : getCandidateQualifiersMap().keySet()) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,List<PromotableOrderItem> candidateTargets = getCandidateTargetsMap().get(itemCriteria);
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,for (PromotableOrderItem promotableOrderItem : candidateTargets) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,returnQty += promotableOrderItem.getQuantity();
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"public HashMap<OfferItemCriteria, List<PromotableOrderItem>> getCandidateTargetsMap() {"
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return candidateTargetsMap;
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"public void setCandidateTargetsMap(HashMap<OfferItemCriteria, List<PromotableOrderItem>> candidateItemsMap) {"
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.candidateTargetsMap = candidateItemsMap;
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,@Override
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public List<PromotableOrderItem> getLegacyCandidateTargets() {
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return legacyCandidateTargets;
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setLegacyCandidateTargets(List<PromotableOrderItem> candidateTargets) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.legacyCandidateTargets = candidateTargets;
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"protected HashMap<OfferItemCriteria, List<PromotableOrderItem>> candidateQualifiersMap = new HashMap<OfferItemCriteria, List<PromotableOrderItem>>();"
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected List<PromotableOrderItem> candidateTargets = new ArrayList<PromotableOrderItem>();
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,/**
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* This method determines how much the customer might save using this promotion for the
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* purpose of sorting promotions with the same priority. The assumption is that any possible
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* target specified for BOGO style offers are of equal or lesser value. We are using
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* a calculation based on the qualifiers here strictly for rough comparative purposes.
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,*
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"* If two promotions have the same priority, the one with the highest potential savings"
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* will be used as the tie-breaker to determine the order to apply promotions.
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* This method makes a good approximation of the promotion value as determining the exact value
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* would require all permutations of promotions to be run resulting in a costly
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* operation.
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* @return
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,*/
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public Money calculatePotentialSavings() {
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Money savings = new Money(0D);
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,int maxUses = calculateMaximumNumberOfUses();
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,int appliedCount = 0;
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (PromotableOrderItem chgItem : candidateTargets) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// TODO:  BCP - Transferred the original logic but it looks like there is a bug here
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,//        when a targetItemCriteria has a quantity > 1.
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"int qtyToReceiveSavings = Math.min(chgItem.getQuantity(), maxUses);"
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"savings = savings.add(calculateSavingsForOrderItem(chgItem, qtyToReceiveSavings));"
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,appliedCount = appliedCount + qtyToReceiveSavings;
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (appliedCount >= maxUses) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return savings;
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,}
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (PromotableOrderItem promotableOrderItem : candidateTargets) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,returnQty += promotableOrderItem.getQuantity();
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public List<PromotableOrderItem> getCandidateTargets() {
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return candidateTargets;
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setCandidateTargets(List<PromotableOrderItem> candidateTargets) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.candidateTargets = candidateTargets;
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"protected HashMap<OfferItemCriteria, List<PromotableOrderItem>> candidateQualifiersMap ="
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"new HashMap<OfferItemCriteria, List<PromotableOrderItem>>();"
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"protected HashMap<OfferItemCriteria, List<PromotableOrderItem>> candidateTargetsMap ="
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,protected List<PromotableOrderItem> legacyCandidateTargets = new ArrayList<PromotableOrderItem>();
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,for (OfferItemCriteria itemCriteria : getCandidateQualifiersMap().keySet()) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,List<PromotableOrderItem> candidateTargets = getCandidateTargetsMap().get(itemCriteria);
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,for (PromotableOrderItem promotableOrderItem : candidateTargets) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,returnQty += promotableOrderItem.getQuantity();
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,}
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"public HashMap<OfferItemCriteria, List<PromotableOrderItem>> getCandidateTargetsMap() {"
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,return candidateTargetsMap;
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"public void setCandidateTargetsMap(HashMap<OfferItemCriteria, List<PromotableOrderItem>> candidateItemsMap) {"
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,this.candidateTargetsMap = candidateItemsMap;
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,@Override
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,public List<PromotableOrderItem> getLegacyCandidateTargets() {
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,return legacyCandidateTargets;
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,public void setLegacyCandidateTargets(List<PromotableOrderItem> candidateTargets) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,this.legacyCandidateTargets = candidateTargets;
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"protected HashMap<OfferItemCriteria, List<PromotableOrderItem>> candidateQualifiersMap = new HashMap<OfferItemCriteria, List<PromotableOrderItem>>();"
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,protected List<PromotableOrderItem> candidateTargets = new ArrayList<PromotableOrderItem>();
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,/**
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* This method determines how much the customer might save using this promotion for the
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* purpose of sorting promotions with the same priority. The assumption is that any possible
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* target specified for BOGO style offers are of equal or lesser value. We are using
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* a calculation based on the qualifiers here strictly for rough comparative purposes.
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,*
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"* If two promotions have the same priority, the one with the highest potential savings"
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* will be used as the tie-breaker to determine the order to apply promotions.
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* This method makes a good approximation of the promotion value as determining the exact value
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* would require all permutations of promotions to be run resulting in a costly
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* operation.
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* @return
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,*/
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,public Money calculatePotentialSavings() {
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,Money savings = new Money(0D);
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,int maxUses = calculateMaximumNumberOfUses();
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,int appliedCount = 0;
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,for (PromotableOrderItem chgItem : candidateTargets) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,// TODO:  BCP - Transferred the original logic but it looks like there is a bug here
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,//        when a targetItemCriteria has a quantity > 1.
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"int qtyToReceiveSavings = Math.min(chgItem.getQuantity(), maxUses);"
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"savings = savings.add(calculateSavingsForOrderItem(chgItem, qtyToReceiveSavings));"
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,appliedCount = appliedCount + qtyToReceiveSavings;
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (appliedCount >= maxUses) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,return savings;
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,}
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,for (PromotableOrderItem promotableOrderItem : candidateTargets) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,returnQty += promotableOrderItem.getQuantity();
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,public List<PromotableOrderItem> getCandidateTargets() {
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,return candidateTargets;
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,public void setCandidateTargets(List<PromotableOrderItem> candidateTargets) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,this.candidateTargets = candidateTargets;
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"void addPromotionDiscount(PromotableCandidateItemOffer itemOffer, OfferItemCriteria itemCriteria, int qtyToMarkAsTarget);"
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import java.util.Set;
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"void addPromotionDiscount(PromotableCandidateItemOffer itemOffer, Set<OfferItemCriteria> itemCriteria, int qtyToMarkAsTarget);"
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"public void addPromotionDiscount(PromotableCandidateItemOffer itemOffer, OfferItemCriteria itemCriteria, int qtyToMarkAsTarget) {"
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import java.util.Set;
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"public void addPromotionDiscount(PromotableCandidateItemOffer itemOffer, Set<OfferItemCriteria> itemCriteria, int qtyToMarkAsTarget) {"
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (!candidate.getLegacyCandidateTargets().contains(promotableOrderItem)) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,candidate.getLegacyCandidateTargets().add(promotableOrderItem);
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,candidateOffer.getCandidateTargetsMap().putAll(candidates.getCandidateTargetsMap());
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,for (PromotableOrderItem item : itemOffer.getLegacyCandidateTargets()) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (itemOffer.getCandidateTargetsMap().keySet().isEmpty()) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return false;
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,for (OfferItemCriteria itemCriteria : itemOffer.getCandidateTargetsMap().keySet()) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,List<PromotableOrderItem> promotableItems = itemOffer.getCandidateTargetsMap().get(itemCriteria);
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,List<PromotableOrderItemPriceDetail> priceDetails = buildPriceDetailListFromOrderItems(promotableItems);
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"Collections.sort(priceDetails, getTargetItemComparator(itemOffer.getOffer().getApplyDiscountToSalePrice()));"
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,int targetQtyNeeded = itemCriteria.getQuantity();
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,for (PromotableOrderItemPriceDetail detail : priceDetails) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,int itemQtyAvailableToBeUsedAsTarget = detail.getQuantityAvailableToBeUsedAsTarget(itemOffer);
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"int qtyToMarkAsTarget = Math.min(targetQtyNeeded, itemQtyAvailableToBeUsedAsTarget);"
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,targetQtyNeeded -= qtyToMarkAsTarget;
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"detail.addPromotionDiscount(itemOffer, itemCriteria, qtyToMarkAsTarget);"
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (targetQtyNeeded == 0) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,break;
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (targetQtyNeeded != 0) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return true;
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (!candidate.getCandidateTargets().contains(promotableOrderItem)) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,candidate.getCandidateTargets().add(promotableOrderItem);
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,candidateOffer.getCandidateTargets().addAll(candidates.getCandidateTargets());
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (PromotableOrderItem item : itemOffer.getCandidateTargets()) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,List<PromotableOrderItem> promotableItems = itemOffer.getCandidateTargets();
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,List<PromotableOrderItemPriceDetail> priceDetails = buildPriceDetailListFromOrderItems(promotableItems);
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,int receiveQtyNeeded = 0;
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (OfferItemCriteria targetCriteria : itemOffer.getOffer().getTargetItemCriteria()) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,receiveQtyNeeded += targetCriteria.getQuantity();
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"Collections.sort(priceDetails, getTargetItemComparator(promotion.getApplyDiscountToSalePrice()));"
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (PromotableOrderItemPriceDetail priceDetail : priceDetails) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (receiveQtyNeeded > 0) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,int itemQtyAvailableToBeUsedAsTarget = priceDetail.getQuantityAvailableToBeUsedAsTarget(itemOffer);
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"int qtyToMarkAsTarget = Math.min(receiveQtyNeeded, itemQtyAvailableToBeUsedAsTarget);"
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,receiveQtyNeeded -= qtyToMarkAsTarget;
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"priceDetail.addPromotionDiscount(itemOffer, itemOffer.getOffer().getTargetItemCriteria(), qtyToMarkAsTarget);"
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (receiveQtyNeeded == 0) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,itemOffer.addUse();
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,break;
3802dfff4bdd00594cbfc5c297f2e712360397c4,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return (receiveQtyNeeded == 0);
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,if (!candidate.getLegacyCandidateTargets().contains(promotableOrderItem)) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,candidate.getLegacyCandidateTargets().add(promotableOrderItem);
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,candidateOffer.getCandidateTargetsMap().putAll(candidates.getCandidateTargetsMap());
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,for (PromotableOrderItem item : itemOffer.getLegacyCandidateTargets()) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,if (itemOffer.getCandidateTargetsMap().keySet().isEmpty()) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,return false;
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,for (OfferItemCriteria itemCriteria : itemOffer.getCandidateTargetsMap().keySet()) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,List<PromotableOrderItem> promotableItems = itemOffer.getCandidateTargetsMap().get(itemCriteria);
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,List<PromotableOrderItemPriceDetail> priceDetails = buildPriceDetailListFromOrderItems(promotableItems);
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,"Collections.sort(priceDetails, getTargetItemComparator(itemOffer.getOffer().getApplyDiscountToSalePrice()));"
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,int targetQtyNeeded = itemCriteria.getQuantity();
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,for (PromotableOrderItemPriceDetail detail : priceDetails) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,int itemQtyAvailableToBeUsedAsTarget = detail.getQuantityAvailableToBeUsedAsTarget(itemOffer);
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,"int qtyToMarkAsTarget = Math.min(targetQtyNeeded, itemQtyAvailableToBeUsedAsTarget);"
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,targetQtyNeeded -= qtyToMarkAsTarget;
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,"detail.addPromotionDiscount(itemOffer, itemCriteria, qtyToMarkAsTarget);"
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,if (targetQtyNeeded == 0) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,break;
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,}
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,if (targetQtyNeeded != 0) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,return true;
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,if (!candidate.getCandidateTargets().contains(promotableOrderItem)) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,candidate.getCandidateTargets().add(promotableOrderItem);
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,candidateOffer.getCandidateTargets().addAll(candidates.getCandidateTargets());
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,for (PromotableOrderItem item : itemOffer.getCandidateTargets()) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,List<PromotableOrderItem> promotableItems = itemOffer.getCandidateTargets();
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,List<PromotableOrderItemPriceDetail> priceDetails = buildPriceDetailListFromOrderItems(promotableItems);
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,int receiveQtyNeeded = 0;
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,for (OfferItemCriteria targetCriteria : itemOffer.getOffer().getTargetItemCriteria()) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,receiveQtyNeeded += targetCriteria.getQuantity();
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,"Collections.sort(priceDetails, getTargetItemComparator(promotion.getApplyDiscountToSalePrice()));"
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,for (PromotableOrderItemPriceDetail priceDetail : priceDetails) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,if (receiveQtyNeeded > 0) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,int itemQtyAvailableToBeUsedAsTarget = priceDetail.getQuantityAvailableToBeUsedAsTarget(itemOffer);
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,"int qtyToMarkAsTarget = Math.min(receiveQtyNeeded, itemQtyAvailableToBeUsedAsTarget);"
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,receiveQtyNeeded -= qtyToMarkAsTarget;
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,"priceDetail.addPromotionDiscount(itemOffer, itemOffer.getOffer().getTargetItemCriteria(), qtyToMarkAsTarget);"
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,if (receiveQtyNeeded == 0) {
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,itemOffer.addUse();
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,break;
3802dfff4bdd00594cbfc5c297f2e712360397c4,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,return (receiveQtyNeeded == 0);
3802dfff4bdd00594cbfc5c297f2e712360397c4,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,assertTrue(candidates.isMatchedQualifier() && candidates.getCandidateQualifiersMap().size() == 1 &&
3802dfff4bdd00594cbfc5c297f2e712360397c4,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,candidates.getCandidateQualifiersMap().values().iterator().next().size() == 2 &&
3802dfff4bdd00594cbfc5c297f2e712360397c4,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,candidates.isMatchedTarget() && candidates.getCandidateTargetsMap().size() == 1 &&
3802dfff4bdd00594cbfc5c297f2e712360397c4,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,candidates.getCandidateTargetsMap().values().iterator().next().size() == 2);
3802dfff4bdd00594cbfc5c297f2e712360397c4,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,assertTrue(candidates.isMatchedQualifier() && candidates.getCandidateQualifiersMap().size() == 1 && candidates.getCandidateQualifiersMap().values().iterator().next().size() == 2 && candidates.isMatchedTarget() && candidates.getCandidateTargets().size() == 2);
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected Long orderPaymentId;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""ORDER_PAYMENT_REFERENCE_NUMBER"")"
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Index(name=""PAYMENTLOG_REFERENCE_INDEX"", columnNames={""ORDER_PAYMENT_REFERENCE_NUMBER""})"
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected String orderPaymentReferenceNumber;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return orderPaymentId;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.orderPaymentId = paymentInfoId;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return orderPaymentReferenceNumber;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.orderPaymentReferenceNumber = paymentInfoReferenceNumber;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public PaymentTransactionType getTransactionType() {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return PaymentTransactionType.getInstance(transactionType);
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setTransactionType(PaymentTransactionType transactionType) {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,result = prime * result + ((orderPaymentId == null) ? 0 : orderPaymentId.hashCode());
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,result = prime * result + ((orderPaymentReferenceNumber == null) ? 0 : orderPaymentReferenceNumber.hashCode());
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (orderPaymentId == null) {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (other.orderPaymentId != null) {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,} else if (!orderPaymentId.equals(other.orderPaymentId)) {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (orderPaymentReferenceNumber == null) {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (other.orderPaymentReferenceNumber != null) {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,} else if (!orderPaymentReferenceNumber.equals(other.orderPaymentReferenceNumber)) {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.core.payment.service.type.TransactionType;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected Long paymentInfoId;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""PAYMENT_INFO_REFERENCE_NUMBER"")"
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""PAYMENTLOG_REFERENCE_INDEX"", columnNames={""PAYMENT_INFO_REFERENCE_NUMBER""})"
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected String paymentInfoReferenceNumber;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return paymentInfoId;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.paymentInfoId = paymentInfoId;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return paymentInfoReferenceNumber;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.paymentInfoReferenceNumber = paymentInfoReferenceNumber;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public TransactionType getTransactionType() {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return TransactionType.getInstance(transactionType);
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setTransactionType(TransactionType transactionType) {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,result = prime * result + ((paymentInfoId == null) ? 0 : paymentInfoId.hashCode());
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,result = prime * result + ((paymentInfoReferenceNumber == null) ? 0 : paymentInfoReferenceNumber.hashCode());
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (paymentInfoId == null) {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (other.paymentInfoId != null) {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,} else if (!paymentInfoId.equals(other.paymentInfoId)) {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (paymentInfoReferenceNumber == null) {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (other.paymentInfoReferenceNumber != null) {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,} else if (!paymentInfoReferenceNumber.equals(other.paymentInfoReferenceNumber)) {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@ManyToOne(targetEntity = PaymentTransactionImpl.class)
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@JoinColumn(name = ""PAYMENT_TRANSACTION_ID"", referencedColumnName = ""PAYMENT_TRANSACTION_ID"", insertable = false, updatable = false)"
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected PaymentTransaction paymentTransaction;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"return BroadleafCurrencyUtils.getMoney(transactionAmount, getPaymentTransaction().getOrderPayment().getCurrency());"
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"return remainingBalance == null ? null : BroadleafCurrencyUtils.getMoney(remainingBalance, getPaymentTransaction().getOrderPayment().getCurrency());"
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public PaymentTransaction getPaymentTransaction() {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return paymentTransaction;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setPaymentTransaction(PaymentTransaction paymentTransaction) {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.paymentTransaction = paymentTransaction;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.currency.domain.BroadleafCurrency;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.currency.domain.BroadleafCurrencyImpl;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.core.payment.service.type.TransactionType;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""REFERENCE_NUMBER"")"
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""PAYRESPONSE_REFERENCE_INDEX"", columnNames={""REFERENCE_NUMBER""})"
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""PaymentResponseItemImpl_Response_Ref_Number"", order = 10, group = ""PaymentResponseItemImpl_Payment_Response"", readOnly = true)"
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected String referenceNumber;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""ORDER_PAYMENT_ID"")"
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""PAYRESPONSE_ORDERPAYMENT_INDEX"", columnNames={""ORDER_PAYMENT_ID""})"
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(excluded = true, readOnly = true)"
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected Long paymentInfoId;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""PAYMENT_INFO_REFERENCE_NUMBER"")"
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""PAYRESPONSE_REFERENCE_INDEX"", columnNames={""PAYMENT_INFO_REFERENCE_NUMBER""})"
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""PaymentResponseItemImpl_Payment_Ref_Number"", order = 17, group = ""PaymentResponseItemImpl_Payment_Response"", readOnly = true)"
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected String paymentInfoReferenceNumber;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@ManyToOne(targetEntity = BroadleafCurrencyImpl.class)
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@JoinColumn(name = ""CURRENCY_CODE"")"
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""PaymentResponseItemImpl_currency"", order = 2, group = ""PaymentLogImpl_Payment_Log"", readOnly = true)"
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected BroadleafCurrency currency;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@ManyToOne(targetEntity = PaymentInfoImpl.class)
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@JoinColumn(name = ""PAYMENT_INFO_REFERENCE_NUMBER"", referencedColumnName = ""REFERENCE_NUMBER"", insertable = false, updatable = false)"
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected PaymentInfo paymentInfo;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@Override
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public String getReferenceNumber() {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return referenceNumber;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,}
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setReferenceNumber(String referenceNumber) {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.referenceNumber = referenceNumber;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@Deprecated
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Money getAmountPaid() {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"return BroadleafCurrencyUtils.getMoney(amountPaid, getCurrency());"
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setAmountPaid(Money amountPaid) {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.amountPaid = Money.toAmount(amountPaid);
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"return BroadleafCurrencyUtils.getMoney(transactionAmount, getCurrency());"
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public String getCvvCode() {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return cvvCode;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setCvvCode(String cvvCode) {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.cvvCode = cvvCode;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"return remainingBalance == null ? null : BroadleafCurrencyUtils.getMoney(remainingBalance, getCurrency());"
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public TransactionType getTransactionType() {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return TransactionType.getInstance(transactionType);
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setTransactionType(TransactionType transactionType) {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.transactionType = transactionType.getType();
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Long getPaymentInfoId() {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return paymentInfoId;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setPaymentInfoId(Long paymentInfoId) {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.paymentInfoId = paymentInfoId;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public BroadleafCurrency getCurrency() {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return currency;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setCurrency(BroadleafCurrency currency) {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.currency = currency;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public String getPaymentInfoReferenceNumber() {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return paymentInfoReferenceNumber;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setPaymentInfoReferenceNumber(String paymentInfoReferenceNumber) {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.paymentInfoReferenceNumber = paymentInfoReferenceNumber;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public PaymentInfo getPaymentInfo() {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return paymentInfo;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setPaymentInfo(PaymentInfo paymentInfo) {
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.paymentInfo = paymentInfo;
223f0270e357e6ea2806ecd3a08da895b8590a39,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"sb.append(""reference number: "").append(this.getReferenceNumber()).append(""\n"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,/*
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* #%L
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* BroadleafCommerce Framework
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* %%
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* Copyright (C) 2009 - 2013 Broadleaf Commerce
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"* Licensed under the Apache License, Version 2.0 (the ""License"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* you may not use this file except in compliance with the License.
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* You may obtain a copy of the License at
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,*
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,*       http://www.apache.org/licenses/LICENSE-2.0
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"* Unless required by applicable law or agreed to in writing, software"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"* distributed under the License is distributed on an ""AS IS"" BASIS,"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* See the License for the specific language governing permissions and
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* limitations under the License.
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* #L%
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,*/
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,package org.broadleafcommerce.core.payment.service.type;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,import org.broadleafcommerce.common.BroadleafEnumerationType;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,import java.io.Serializable;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,import java.util.LinkedHashMap;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,import java.util.Map;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,/**
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* An extendible enumeration of payment info types.
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* @author jfischer
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public class PaymentInfoType implements Serializable, BroadleafEnumerationType {"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,private static final long serialVersionUID = 1L;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"private static final Map<String, PaymentInfoType> TYPES = new LinkedHashMap<String, PaymentInfoType>();"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final PaymentInfoType GIFT_CARD = new PaymentInfoType(""GIFT_CARD"", ""Gift Card"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final PaymentInfoType CREDIT_CARD = new PaymentInfoType(""CREDIT_CARD"", ""Credit Card"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final PaymentInfoType BANK_ACCOUNT = new PaymentInfoType(""BANK_ACCOUNT"", ""Bank Account"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final PaymentInfoType PAYPAL = new PaymentInfoType(""PAYPAL"", ""PayPal"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final PaymentInfoType CHECK = new PaymentInfoType(""CHECK"", ""Check"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final PaymentInfoType ELECTRONIC_CHECK = new PaymentInfoType(""ELECTRONIC_CHECK"", ""Electronic Check"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final PaymentInfoType WIRE = new PaymentInfoType(""WIRE"", ""Wire Transfer"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final PaymentInfoType MONEY_ORDER = new PaymentInfoType(""MONEY_ORDER"", ""Money Order"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final PaymentInfoType CUSTOMER_CREDIT = new PaymentInfoType(""CUSTOMER_CREDIT"", ""Customer Credit"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final PaymentInfoType COD = new PaymentInfoType(""COD"", ""Collect On Delivery"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,@Deprecated
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final PaymentInfoType ACCOUNT = new PaymentInfoType(""ACCOUNT"", ""Account"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public static PaymentInfoType getInstance(final String type) {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return TYPES.get(type);
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,}
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,private String type;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,private String friendlyType;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public PaymentInfoType() {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,//do nothing
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public PaymentInfoType(final String type, final String friendlyType) {"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,this.friendlyType = friendlyType;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,setType(type);
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public String getType() {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return type;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public String getFriendlyType() {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return friendlyType;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,private void setType(final String type) {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,this.type = type;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,if (!TYPES.containsKey(type)) {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"TYPES.put(type, this);"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,@Override
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public int hashCode() {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,final int prime = 31;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,int result = 1;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,result = prime * result + ((type == null) ? 0 : type.hashCode());
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return result;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public boolean equals(Object obj) {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,if (this == obj)
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return true;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,if (obj == null)
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return false;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,if (getClass() != obj.getClass())
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,PaymentInfoType other = (PaymentInfoType) obj;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,if (type == null) {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,if (other.type != null)
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,} else if (!type.equals(other.type))
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,/*
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* #%L
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* BroadleafCommerce Framework
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* %%
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* Copyright (C) 2009 - 2013 Broadleaf Commerce
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"* Licensed under the Apache License, Version 2.0 (the ""License"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* you may not use this file except in compliance with the License.
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* You may obtain a copy of the License at
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,*
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,*       http://www.apache.org/licenses/LICENSE-2.0
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"* Unless required by applicable law or agreed to in writing, software"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"* distributed under the License is distributed on an ""AS IS"" BASIS,"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* See the License for the specific language governing permissions and
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* limitations under the License.
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* #L%
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,*/
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,package org.broadleafcommerce.core.payment.service.type;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,import org.broadleafcommerce.common.BroadleafEnumerationType;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,import java.io.Serializable;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,import java.util.LinkedHashMap;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,import java.util.Map;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,/**
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* An extendible enumeration of payment transaction types.
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* @author jfischer
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public class TransactionType implements Serializable, BroadleafEnumerationType {"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,private static final long serialVersionUID = 1L;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"private static final Map<String, TransactionType> TYPES = new LinkedHashMap<String, TransactionType>();"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final TransactionType AUTHORIZE = new TransactionType(""AUTHORIZE"", ""Authorize"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final TransactionType DEBIT = new TransactionType(""DEBIT"", ""Debit"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final TransactionType AUTHORIZEANDDEBIT = new TransactionType(""AUTHORIZEANDDEBIT"", ""Authorize and Debit"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final TransactionType CREDIT = new TransactionType(""CREDIT"", ""Credit"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final TransactionType VOIDPAYMENT = new TransactionType(""VOIDPAYMENT"", ""Void Payment"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final TransactionType BALANCE = new TransactionType(""BALANCE"", ""Balance"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final TransactionType REVERSEAUTHORIZE = new TransactionType(""REVERSEAUTHORIZE"", ""Reverse Authorize"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final TransactionType PARTIALPAYMENT = new TransactionType(""PARTIALPAYMENT"", ""Partial Payment"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public static TransactionType getInstance(final String type) {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return TYPES.get(type);
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,}
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,private String type;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,private String friendlyType;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public TransactionType() {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,//do nothing
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public TransactionType(final String type, final String friendlyType) {"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,this.friendlyType = friendlyType;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,setType(type);
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public String getType() {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return type;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public String getFriendlyType() {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return friendlyType;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,private void setType(final String type) {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,this.type = type;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,if (!TYPES.containsKey(type)) {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"TYPES.put(type, this);"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,@Override
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public int hashCode() {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,final int prime = 31;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,int result = 1;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,result = prime * result + ((type == null) ? 0 : type.hashCode());
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return result;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public boolean equals(Object obj) {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,if (this == obj)
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return true;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,if (obj == null)
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return false;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,if (getClass() != obj.getClass())
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,TransactionType other = (TransactionType) obj;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,if (type == null) {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,if (other.type != null)
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,} else if (!type.equals(other.type))
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,/*
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* #%L
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* BroadleafCommerce Framework
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* %%
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* Copyright (C) 2009 - 2013 Broadleaf Commerce
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"* Licensed under the Apache License, Version 2.0 (the ""License"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* you may not use this file except in compliance with the License.
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* You may obtain a copy of the License at
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,*
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,*       http://www.apache.org/licenses/LICENSE-2.0
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"* Unless required by applicable law or agreed to in writing, software"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"* distributed under the License is distributed on an ""AS IS"" BASIS,"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* See the License for the specific language governing permissions and
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* limitations under the License.
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* #L%
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,*/
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,package org.broadleafcommerce.core.payment.service.workflow;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,import org.broadleafcommerce.common.BroadleafEnumerationType;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,import java.io.Serializable;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,import java.util.LinkedHashMap;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,import java.util.Map;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,/**
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* An extendible enumeration of payment action types.
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* @author jfischer
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public class PaymentActionType implements Serializable, BroadleafEnumerationType {"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,private static final long serialVersionUID = 1L;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"private static final Map<String, PaymentActionType> TYPES = new LinkedHashMap<String, PaymentActionType>();"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final PaymentActionType AUTHORIZE = new PaymentActionType(""AUTHORIZE"", ""Authorize"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final PaymentActionType DEBIT = new PaymentActionType(""DEBIT"", ""Debit"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final PaymentActionType AUTHORIZEANDDEBIT = new PaymentActionType(""AUTHORIZEANDDEBIT"", ""Authorize and Debit"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final PaymentActionType CREDIT = new PaymentActionType(""CREDIT"", ""Credit"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final PaymentActionType VOID = new PaymentActionType(""VOID"", ""Void"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final PaymentActionType BALANCE = new PaymentActionType(""BALANCE"", ""Check Balance"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final PaymentActionType REVERSEAUTHORIZE = new PaymentActionType(""REVERSEAUTHORIZE"", ""Reverse Authorize"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final PaymentActionType PARTIALPAYMENT = new PaymentActionType(""PARTIALPAYMENT"", ""Partial Payment"");"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public static PaymentActionType getInstance(final String type) {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return TYPES.get(type);
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,}
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,private String type;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,private String friendlyType;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public PaymentActionType() {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,//do nothing
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public PaymentActionType(final String type, final String friendlyType) {"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,this.friendlyType = friendlyType;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,setType(type);
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public String getType() {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return type;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public String getFriendlyType() {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return friendlyType;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,private void setType(final String type) {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,this.type = type;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,if (!TYPES.containsKey(type)) {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"TYPES.put(type, this);"
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,@Override
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public int hashCode() {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,final int prime = 31;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,int result = 1;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,result = prime * result + ((type == null) ? 0 : type.hashCode());
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return result;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public boolean equals(Object obj) {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,if (this == obj)
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return true;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,if (obj == null)
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return false;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,if (getClass() != obj.getClass())
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,PaymentActionType other = (PaymentActionType) obj;
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,if (type == null) {
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,if (other.type != null)
223f0270e357e6ea2806ecd3a08da895b8590a39,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,} else if (!type.equals(other.type))
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,/*
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* #%L
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* BroadleafCommerce Framework
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* %%
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* Copyright (C) 2009 - 2013 Broadleaf Commerce
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"* Licensed under the Apache License, Version 2.0 (the ""License"");"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* you may not use this file except in compliance with the License.
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* You may obtain a copy of the License at
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,*
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,*       http://www.apache.org/licenses/LICENSE-2.0
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"* Unless required by applicable law or agreed to in writing, software"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"* distributed under the License is distributed on an ""AS IS"" BASIS,"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* See the License for the specific language governing permissions and
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* limitations under the License.
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* #L%
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,*/
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,package org.broadleafcommerce.core.payment.domain;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.currency.util.BroadleafCurrencyUtils;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.money.Money;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentation;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.presentation.client.SupportedFieldType;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.profile.core.domain.Customer;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.profile.core.domain.CustomerImpl;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.hibernate.annotations.BatchSize;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.hibernate.annotations.GenericGenerator;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.hibernate.annotations.Index;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.hibernate.annotations.Parameter;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import java.math.BigDecimal;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import java.util.Date;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import java.util.HashMap;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import java.util.Map;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.CollectionTable;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Column;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.ElementCollection;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Entity;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.GeneratedValue;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Id;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Inheritance;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.InheritanceType;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.JoinColumn;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.ManyToOne;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.MapKeyColumn;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Table;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Temporal;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.TemporalType;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Transient;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@Entity
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@Inheritance(strategy = InheritanceType.JOINED)
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Table(name = ""BLC_PAYMENT_RESPONSE_ITEM"")"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public class PaymentResponseItemImpl implements PaymentResponseItem {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,private static final long serialVersionUID = 1L;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@Id
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@GeneratedValue(generator = ""PaymentResponseItemId"")"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@GenericGenerator(
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"name=""PaymentResponseItemId"","
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"strategy=""org.broadleafcommerce.common.persistence.IdOverrideTableGenerator"","
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,parameters = {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Parameter(name=""segment_value"", value=""PaymentResponseItemImpl""),"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Parameter(name=""entity_name"", value=""org.broadleafcommerce.core.payment.domain.PaymentResponseItemImpl"")"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,}
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,)
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""PAYMENT_RESPONSE_ITEM_ID"")"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected Long id;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""USER_NAME"", nullable=false)"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""PaymentResponseItemImpl_User_Name"", order = 1, group = ""PaymentResponseItemImpl_Payment_Response"", readOnly = true)"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected String userName;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""AMOUNT_PAID"", precision=19, scale=5)"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""PaymentResponseItemImpl_Amount"", order = 2, group = ""PaymentResponseItemImpl_Payment_Response"", readOnly = true, prominent = true, gridOrder = 200, fieldType = SupportedFieldType.MONEY)"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected BigDecimal amountPaid;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""TRANSACTION_AMOUNT"", precision=19, scale=5)"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""PaymentResponseItemImpl_Transaction_Amount"", order = 2, group = ""PaymentResponseItemImpl_Payment_Response"", readOnly = true)"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected BigDecimal transactionAmount;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""AUTHORIZATION_CODE"")"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""PaymentResponseItemImpl_Authorization_Code"", order = 3, group = ""PaymentResponseItemImpl_Payment_Response"", readOnly = true)"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected String authorizationCode;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""MIDDLEWARE_RESPONSE_CODE"")"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""PaymentResponseItemImpl_Middleware_Response_Code"", order = 4, group = ""PaymentResponseItemImpl_Payment_Response"", readOnly = true)"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected String middlewareResponseCode;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""MIDDLEWARE_RESPONSE_TEXT"")"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""PaymentResponseItemImpl_Middleware_Response_Text"", order = 5, group = ""PaymentResponseItemImpl_Payment_Response"", readOnly = true)"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected String middlewareResponseText;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""PROCESSOR_RESPONSE_CODE"")"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""PaymentResponseItemImpl_Processor_Response_Code"", order = 6, group = ""PaymentResponseItemImpl_Payment_Response"", readOnly = true)"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected String processorResponseCode;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""PROCESSOR_RESPONSE_TEXT"")"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""PaymentResponseItemImpl_Processor_Response_Text"", order = 7, group = ""PaymentResponseItemImpl_Payment_Response"", readOnly = true)"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected String processorResponseText;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""IMPLEMENTOR_RESPONSE_CODE"")"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""PaymentResponseItemImpl_Implementer_Response_Code"", order = 8, group = ""PaymentResponseItemImpl_Payment_Response"", readOnly = true)"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected String implementorResponseCode;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""IMPLEMENTOR_RESPONSE_TEXT"")"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""PaymentResponseItemImpl_Implementer_Response_Text"", order = 9, group = ""PaymentResponseItemImpl_Payment_Response"", readOnly = true)"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected String implementorResponseText;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""TRANSACTION_SUCCESS"")"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""PaymentResponseItemImpl_Transaction_Successful"", order = 11, group = ""PaymentResponseItemImpl_Payment_Response"", readOnly = true, prominent = true, gridOrder = 300)"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected Boolean transactionSuccess = false;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""TRANSACTION_TIMESTAMP"", nullable=false)"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@Temporal(TemporalType.TIMESTAMP)
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""PaymentResponseItemImpl_Transaction_Time"", order = 12, group = ""PaymentResponseItemImpl_Payment_Response"", readOnly = true, prominent = true, gridOrder = 100)"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected Date transactionTimestamp;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""TRANSACTION_ID"")"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""PaymentResponseItemImpl_Transaction_Id"", order = 13, group = ""PaymentResponseItemImpl_Payment_Response"", readOnly = true)"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected String transactionId;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""AVS_CODE"")"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""PaymentResponseItemImpl_AVS_Code"", order = 14, group = ""PaymentResponseItemImpl_Payment_Response"", readOnly = true)"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected String avsCode;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@Transient
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected String cvvCode;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""REMAINING_BALANCE"", precision=19, scale=5)"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""PaymentResponseItemImpl_Remaining_Balance"", order = 15, group = ""PaymentResponseItemImpl_Payment_Response"", readOnly = true)"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected BigDecimal remainingBalance;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""TRANSACTION_TYPE"", nullable=false)"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""PAYRESPONSE_TRANTYPE_INDEX"", columnNames={""TRANSACTION_TYPE""})"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""PaymentResponseItemImpl_Transaction_Type"", order = 16, group = ""PaymentResponseItemImpl_Payment_Response"", readOnly = true, prominent = true, gridOrder = 400)"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected String transactionType;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@ElementCollection
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@MapKeyColumn(name=""FIELD_NAME"")"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name=""FIELD_VALUE"")"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@CollectionTable(name=""BLC_PAYMENT_ADDITIONAL_FIELDS"", joinColumns=@JoinColumn(name=""PAYMENT_RESPONSE_ITEM_ID""))"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@BatchSize(size = 50)
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"protected Map<String, String> additionalFields = new HashMap<String, String>();"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@ManyToOne(targetEntity = CustomerImpl.class)
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@JoinColumn(name = ""CUSTOMER_ID"")"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""PAYRESPONSE_CUSTOMER_INDEX"", columnNames={""CUSTOMER_ID""})"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected Customer customer;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@ManyToOne(targetEntity = PaymentTransactionImpl.class)
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@JoinColumn(name = ""PAYMENT_TRANSACTION_ID"", referencedColumnName = ""PAYMENT_TRANSACTION_ID"", insertable = false, updatable = false)"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected PaymentTransaction paymentTransaction;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@Override
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public String getAuthorizationCode() {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return authorizationCode;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setAuthorizationCode(String authorizationCode) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.authorizationCode = authorizationCode;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public String getMiddlewareResponseCode() {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return middlewareResponseCode;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setMiddlewareResponseCode(String middlewareResponseCode) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.middlewareResponseCode = middlewareResponseCode;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public String getMiddlewareResponseText() {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return middlewareResponseText;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setMiddlewareResponseText(String middlewareResponseText) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.middlewareResponseText = middlewareResponseText;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public String getProcessorResponseCode() {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return processorResponseCode;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setProcessorResponseCode(String processorResponseCode) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.processorResponseCode = processorResponseCode;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public String getProcessorResponseText() {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return processorResponseText;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setProcessorResponseText(String processorResponseText) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.processorResponseText = processorResponseText;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Money getTransactionAmount() {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"return BroadleafCurrencyUtils.getMoney(transactionAmount, getPaymentTransaction().getOrderPayment().getCurrency());"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setTransactionAmount(Money transactionAmount) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.transactionAmount = Money.toAmount(transactionAmount);
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Boolean getTransactionSuccess() {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (transactionSuccess == null) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return Boolean.FALSE;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,} else {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return transactionSuccess;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setTransactionSuccess(Boolean transactionSuccess) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.transactionSuccess = transactionSuccess;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Date getTransactionTimestamp() {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return transactionTimestamp;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setTransactionTimestamp(Date transactionTimestamp) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.transactionTimestamp = transactionTimestamp;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public String getImplementorResponseCode() {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return implementorResponseCode;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setImplementorResponseCode(String implementorResponseCode) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.implementorResponseCode = implementorResponseCode;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public String getImplementorResponseText() {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return implementorResponseText;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setImplementorResponseText(String implementorResponseText) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.implementorResponseText = implementorResponseText;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public String getTransactionId() {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return transactionId;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setTransactionId(String transactionId) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.transactionId = transactionId;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public String getAvsCode() {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return avsCode;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setAvsCode(String avsCode) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.avsCode = avsCode;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Money getRemainingBalance() {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"return remainingBalance == null ? null : BroadleafCurrencyUtils.getMoney(remainingBalance, getPaymentTransaction().getOrderPayment().getCurrency());"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setRemainingBalance(Money remainingBalance) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.remainingBalance = remainingBalance==null?null:Money.toAmount(remainingBalance);
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"public Map<String, String> getAdditionalFields() {"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return additionalFields;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"public void setAdditionalFields(Map<String, String> additionalFields) {"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.additionalFields = additionalFields;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Long getId() {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return id;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setId(Long id) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.id = id;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public String getUserName() {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return userName;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setUserName(String userName) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.userName = userName;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Customer getCustomer() {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return customer;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setCustomer(Customer customer) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.customer = customer;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public PaymentTransaction getPaymentTransaction() {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return paymentTransaction;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setPaymentTransaction(PaymentTransaction paymentTransaction) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.paymentTransaction = paymentTransaction;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public String toString() {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,StringBuilder sb = new StringBuilder();
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"sb.append(PaymentResponseItem.class.getName()).append(""\n"");"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"sb.append(""auth code: "").append(this.getAuthorizationCode()).append(""\n"");"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"sb.append(""implementor response code: "").append(this.getImplementorResponseCode()).append(""\n"");"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"sb.append(""implementor response text: "").append(this.getImplementorResponseText()).append(""\n"");"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"sb.append(""middleware response code: "").append(this.getMiddlewareResponseCode()).append(""\n"");"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"sb.append(""middleware response text: "").append(this.getMiddlewareResponseText()).append(""\n"");"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"sb.append(""processor response code: "").append(this.getProcessorResponseCode()).append(""\n"");"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"sb.append(""processor response text: "").append(this.getProcessorResponseText()).append(""\n"");"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"sb.append(""transaction id: "").append(this.getTransactionId()).append(""\n"");"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"sb.append(""avs code: "").append(this.getAvsCode()).append(""\n"");"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (remainingBalance != null) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"sb.append(""remaining balance: "").append(this.getRemainingBalance());"
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return sb.toString();
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public int hashCode() {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,final int prime = 31;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,int result = 1;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,result = prime * result + ((transactionId == null) ? 0 : transactionId.hashCode());
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return result;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public boolean equals(Object obj) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (this == obj) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return true;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (obj == null) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return false;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (getClass() != obj.getClass()) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,PaymentResponseItemImpl other = (PaymentResponseItemImpl) obj;
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (id != null && other.id != null) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return id.equals(other.id);
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (transactionId == null) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (other.transactionId != null) {
64b3fe4bfd2df996c52af4e6cfe8720041675bb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,} else if (!transactionId.equals(other.transactionId)) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.core.offer.service.OfferServiceExtensionManager;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.core.order.domain.dto.OrderItemHolder;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import java.util.HashMap;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import java.util.Map;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"public class ItemOfferProcessorImpl extends OrderOfferProcessorImpl implements ItemOfferProcessor, ItemOfferMarkTargets {"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"offerServiceUtilities.applyAdjustmentsForItemPriceDetails(itemOffer, itemPriceDetails);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"offerServiceUtilities.applyOrderItemAdjustment(itemOffer, itemPriceDetail);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* Call out to extension managers.
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* Returns true if the core processing should still be performed for the passed in offer.
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,*
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"protected Boolean applyItemOfferExtension(PromotableOrder order,"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,PromotableCandidateItemOffer itemOffer) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"Map<String, Object> contextMap = new HashMap<String, Object>();"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (extensionManager != null) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"extensionManager.getProxy().applyItemOffer(order, itemOffer, contextMap);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (contextMap.get(OfferServiceExtensionManager.STOP_PROCESSING) != null) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,// Returning false
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return !Boolean.TRUE.equals(contextMap.get(OfferServiceExtensionManager.STOP_PROCESSING));
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return Boolean.TRUE;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"if (applyItemOfferExtension(order, itemOffer)) {"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"if (offerServiceUtilities.itemOfferCanBeApplied(itemOffer, order.getAllPromotableOrderItemPriceDetails())) {"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"applyItemQualifiersAndTargets(itemOffer, order);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (itemOffer.isLegacyOffer()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"applyLegacyAdjustments(order, itemOffer);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,} else {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"applyAdjustments(order, itemOffer);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"int qualifierQtyNeeded = offerServiceUtilities.markQualifiersForCriteria(itemOffer, itemCriteria, priceDetails);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"public boolean markTargets(PromotableCandidateItemOffer itemOffer, PromotableOrder order, OrderItem relatedQualifier,"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,OrderItem relatedQualifierRoot = offerServiceUtilities.findRelatedQualifierRoot(relatedQualifier);
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"offerServiceUtilities.sortTargetItemDetails(priceDetails, itemOffer.getOffer().getApplyDiscountToSalePrice());"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"targetQtyNeeded = offerServiceUtilities.markTargetsForCriteria(itemOffer, relatedQualifier, checkOnly, promotion, relatedQualifierRoot, itemCriteria, priceDetails, targetQtyNeeded);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,OrderItemHolder orderItemHolder = new OrderItemHolder(null);
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"int qualifierQtyNeeded = offerServiceUtilities.markRelatedQualifiersAndTargetsForItemCriteria(itemOffer, order,"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"orderItemHolder, itemCriteria, priceDetails, this);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"return markTargets(itemOffer, order, orderItemHolder.getOrderItem(), false);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,/**
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* Provide an opportunity to for modules to override the potentialSavingsCalculation
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* @param itemOffer
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* @param item
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* @param quantity
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* @return
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,*/
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"protected Money calculatePotentialSavingsForOrderItem(PromotableCandidateItemOffer itemOffer,"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"PromotableOrderItem item, int quantity) {"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"Map<String,Object> contextMap = new HashMap<String,Object>();"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"extensionManager.getProxy().calculatePotentialSavings(itemOffer, item, quantity, contextMap);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"// If the extensionHandler added a savings element to the map, then return it"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"Object o = contextMap.get(""savings"");"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (o != null && o instanceof Money) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return (Money) o;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"// If the extensionHandler added a quantity element to the map, then return it"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"o = contextMap.get(""quantity"");"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (o != null && o instanceof Integer) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,quantity = ((Integer) o).intValue();
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"return itemOffer.calculateSavingsForOrderItem(item, quantity);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"Money itemSavings = calculatePotentialSavingsForOrderItem(itemOffer, item, discount.getQuantity());"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,potentialSavings = potentialSavings.add(itemSavings);
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected void restPriceDetails(PromotableOrderItem item) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,item.resetPriceDetails();
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,extensionManager.getProxy().resetPriceDetails(item);
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,extensionManager.getProxy().chooseSaleOrRetailAdjustments(order);
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.core.offer.service.discount.PromotionQualifier;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOrderItemPriceDetailAdjustment;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import java.util.Comparator;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public class ItemOfferProcessorImpl extends OrderOfferProcessorImpl implements ItemOfferProcessor {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,/**
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* Private method used by applyAdjustments to create an OrderItemAdjustment from a CandidateOrderOffer
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* and associates the OrderItemAdjustment to the OrderItem.
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,*
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* @param orderOffer a CandidateOrderOffer to apply to an Order
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,*/
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"protected void applyOrderItemAdjustment(PromotableCandidateItemOffer itemOffer, PromotableOrderItemPriceDetail itemPriceDetail) {"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"PromotableOrderItemPriceDetailAdjustment promotableOrderItemPriceDetailAdjustment = promotableItemFactory.createPromotableOrderItemPriceDetailAdjustment(itemOffer, itemPriceDetail);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,itemPriceDetail.addCandidateItemPriceDetailAdjustment(promotableOrderItemPriceDetailAdjustment);
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,}
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (PromotableOrderItemPriceDetail itemPriceDetail : itemPriceDetails) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (PromotionDiscount discount : itemPriceDetail.getPromotionDiscounts()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (discount.getPromotion().equals(itemOffer.getOffer())) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (itemOffer.getOffer().isTotalitarianOffer() || !itemOffer.getOffer().isCombinableWithOtherOffers()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// We've decided to apply this adjustment but if it doesn't actually reduce
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// the value of the item
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"if (adjustmentIsNotGoodEnoughToBeApplied(itemOffer, itemPriceDetail)) {"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,break;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"applyOrderItemAdjustment(itemOffer, itemPriceDetail);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* The adjustment might not be better than the sale price.
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* @param itemOffer
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* @param detail
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* @return
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"protected boolean adjustmentIsNotGoodEnoughToBeApplied(PromotableCandidateItemOffer itemOffer,"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,PromotableOrderItemPriceDetail detail) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (!itemOffer.getOffer().getApplyDiscountToSalePrice()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Money salePrice = detail.getPromotableOrderItem().getSalePriceBeforeAdjustments();
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Money retailPrice = detail.getPromotableOrderItem().getRetailPriceBeforeAdjustments();
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"Money savings = itemOffer.calculateSavingsForOrderItem(detail.getPromotableOrderItem(), 1);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (salePrice != null) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (salePrice.lessThan(retailPrice.subtract(savings))) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// Not good enough
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return true;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return false;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* Return false if a totalitarian offer has already been applied and this order already has
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* item adjustments.
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"protected boolean itemOfferCanBeApplied(PromotableOrder order, PromotableCandidateItemOffer itemOffer) {"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (PromotableOrderItemPriceDetail detail : order.getAllPromotableOrderItemPriceDetails()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (PromotableOrderItemPriceDetailAdjustment adjustment : detail.getCandidateItemAdjustments()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (adjustment.isTotalitarian() || itemOffer.getOffer().isTotalitarianOffer()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// A totalitarian offer has already been applied or this offer is totalitarian
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// and another offer was already applied.
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,} else if (itemOffer.isLegacyOffer()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,continue;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,} else if (!adjustment.isCombinable() || !itemOffer.getOffer().isCombinableWithOtherOffers()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// A nonCombinable offer has been applied or this is a non-combinable offer
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// and adjustments have already been applied.
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"if (itemOfferCanBeApplied(order, itemOffer)) {"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"applyItemQualifiersAndTargets(itemOffer, order);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (itemOffer.isLegacyOffer()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"applyLegacyAdjustments(order, itemOffer);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,} else {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"applyAdjustments(order, itemOffer);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"Collections.sort(priceDetails, getQualifierItemComparator(itemOffer.getOffer().getApplyDiscountToSalePrice()));"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// Calculate the number of qualifiers needed that will not receive the promotion.
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// These will be reserved first before the target is assigned.
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,int qualifierQtyNeeded = itemCriteria.getQuantity();
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (PromotableOrderItemPriceDetail detail : priceDetails) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// Mark Qualifiers
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (qualifierQtyNeeded > 0) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,int itemQtyAvailableToBeUsedAsQualifier = detail.getQuantityAvailableToBeUsedAsQualifier(itemOffer);
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (itemQtyAvailableToBeUsedAsQualifier > 0) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"int qtyToMarkAsQualifier = Math.min(qualifierQtyNeeded, itemQtyAvailableToBeUsedAsQualifier);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,qualifierQtyNeeded -= qtyToMarkAsQualifier;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"detail.addPromotionQualifier(itemOffer, itemCriteria, qtyToMarkAsQualifier);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (qualifierQtyNeeded == 0) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"protected boolean markTargets(PromotableCandidateItemOffer itemOffer, PromotableOrder order, OrderItem relatedQualifier,"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,OrderItem relatedQualifierRoot = null;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (relatedQualifier != null) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,relatedQualifierRoot = relatedQualifier;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,while (relatedQualifierRoot.getParentOrderItem() != null) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,relatedQualifierRoot = relatedQualifierRoot.getParentOrderItem();
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"Collections.sort(priceDetails, getTargetItemComparator(itemOffer.getOffer().getApplyDiscountToSalePrice()));"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (PromotableOrderItemPriceDetail priceDetail : priceDetails) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"// We need to make sure that this item is either a parent, child, or the same as the qualifier root"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,OrderItem thisItem = priceDetail.getPromotableOrderItem().getOrderItem();
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (!relatedQualifierRoot.isAParentOf(thisItem) && !thisItem.isAParentOf(relatedQualifierRoot) &&
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,!thisItem.equals(relatedQualifierRoot)) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,int itemQtyAvailableToBeUsedAsTarget = priceDetail.getQuantityAvailableToBeUsedAsTarget(itemOffer);
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (itemQtyAvailableToBeUsedAsTarget > 0) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (promotion.isUnlimitedUsePerOrder() || (itemOffer.getUses() < promotion.getMaxUsesPerOrder())) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"int qtyToMarkAsTarget = Math.min(targetQtyNeeded, itemQtyAvailableToBeUsedAsTarget);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,targetQtyNeeded -= qtyToMarkAsTarget;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (!checkOnly) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"priceDetail.addPromotionDiscount(itemOffer, itemCriteria, qtyToMarkAsTarget);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (targetQtyNeeded == 0) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,OrderItem relatedOrderItem = null;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,OrderItem oi = detail.getPromotableOrderItem().getOrderItem();
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"// We have found a qualifier that meets this offer criteria. First, we'll save some state that we"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// might need in the future.
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,OfferItemCriteria previousQualifierCriteria = null;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (PromotionQualifier possibleQualifier : detail.getPromotionQualifiers()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (possibleQualifier.getPromotion().equals(itemOffer.getOffer())) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,previousQualifierCriteria = possibleQualifier.getItemCriteria();
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// Go ahead and mark this item as a qualifier
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"PromotionQualifier pq = detail.addPromotionQualifier(itemOffer, itemCriteria, qtyToMarkAsQualifier);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"// Now, we need to see if there exists a target(s) that is suitable for this qualifier due to"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"// the relationship flag. If we are on the last qualifier required for this offer, we want to"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"// actually go ahead and mark the target that we'll be using. Otherwise, we just want to check"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// that there is an eligible target(s) and continue on.
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"if (markTargets(itemOffer, order, oi, true)) {"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// We found a target. Let's save this related order item used as the qualifier in case
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// we succeed
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,relatedOrderItem = oi;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"// If we didn't find a target, we need to roll back how we marked this item as a qualifier."
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,qualifierQtyNeeded += qtyToMarkAsQualifier;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (pq.getQuantity() == qtyToMarkAsQualifier) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,detail.getPromotionQualifiers().remove(pq);
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,pq.setItemCriteria(previousQualifierCriteria);
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,pq.setQuantity(pq.getQuantity() - qtyToMarkAsQualifier);
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"return markTargets(itemOffer, order, relatedOrderItem, false);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"* Used in {@link #applyItemQualifiersAndTargets(PromotableCandidateItemOffer, PromotableOrder)} allow for customized"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* sorting for which qualifier items should be attempted to be used first for a promotion. Default behavior
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"* is to sort descending, so higher-value items are attempted to be qualified first."
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* @param applyToSalePrice - whether or not the Comparator should use the sale price for comparison
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected Comparator<PromotableOrderItemPriceDetail> getQualifierItemComparator(final boolean applyToSalePrice) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return new Comparator<PromotableOrderItemPriceDetail>() {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,@Override
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"public int compare(PromotableOrderItemPriceDetail o1, PromotableOrderItemPriceDetail o2) {"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Money price = o1.getPromotableOrderItem().getPriceBeforeAdjustments(applyToSalePrice);
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Money price2 = o2.getPromotableOrderItem().getPriceBeforeAdjustments(applyToSalePrice);
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// highest amount first
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return price2.compareTo(price);
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,};
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* <p>
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* sorting for which target items the promotion should be attempted to be applied to first. Default behavior is to
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"* sort descending, so higher-value items get the promotion over lesser-valued items."
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* </p>
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"* Note: By default, both the {@link #getQualifierItemComparator(boolean)} and this target comparator are sorted"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* in descending order.  This means that higher-valued items can be paired with higher-valued items and lower-valued
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* items can be paired with lower-valued items. This also ensures that you will <b>not</b> have the scenario where 2
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* lower-valued items can be used to qualify a higher-valued target.
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected Comparator<PromotableOrderItemPriceDetail> getTargetItemComparator(final boolean applyToSalePrice) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,potentialSavings = potentialSavings.add(
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"itemOffer.calculateSavingsForOrderItem(item, discount.getQuantity()));"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,//qualifiedOrderOffers = removeTrailingNotCombinableOrderOffers(qualifiedOrderOffers);
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* Gets rid of totalitarian and nonCombinable item offers that can't possibly be applied.
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* @param qualifiedItemOffers
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,private void removeTrailingNonCombinableOrTotalitarianOffers(List<PromotableCandidateItemOffer> qualifiedItemOffers) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,boolean first = true;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Iterator<PromotableCandidateItemOffer> offerIterator = qualifiedItemOffers.iterator();
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (offerIterator.hasNext()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// ignore the first one.
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,offerIterator.next();
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,while (offerIterator.hasNext()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,PromotableCandidateItemOffer itemOffer = offerIterator.next();
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (itemOffer.getOffer().isTotalitarianOffer()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// Remove Totalitarian offers that aren't the first offer.
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,offerIterator.remove();
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (!itemOffer.isLegacyOffer() && !itemOffer.getOffer().isCombinableWithOtherOffers()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// Remove nonCombinable offers that aren't the first offer
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import org.broadleafcommerce.core.offer.service.OfferServiceExtensionManager;
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import org.broadleafcommerce.core.order.domain.dto.OrderItemHolder;
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import java.util.HashMap;
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import java.util.Map;
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"public class ItemOfferProcessorImpl extends OrderOfferProcessorImpl implements ItemOfferProcessor, ItemOfferMarkTargets {"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"offerServiceUtilities.applyAdjustmentsForItemPriceDetails(itemOffer, itemPriceDetails);"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"offerServiceUtilities.applyOrderItemAdjustment(itemOffer, itemPriceDetail);"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,* Call out to extension managers.
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,* Returns true if the core processing should still be performed for the passed in offer.
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,*
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"protected Boolean applyItemOfferExtension(PromotableOrder order,"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,PromotableCandidateItemOffer itemOffer) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"Map<String, Object> contextMap = new HashMap<String, Object>();"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,if (extensionManager != null) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"extensionManager.getProxy().applyItemOffer(order, itemOffer, contextMap);"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,if (contextMap.get(OfferServiceExtensionManager.STOP_PROCESSING) != null) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,// Returning false
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,return !Boolean.TRUE.equals(contextMap.get(OfferServiceExtensionManager.STOP_PROCESSING));
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,return Boolean.TRUE;
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"if (applyItemOfferExtension(order, itemOffer)) {"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"if (offerServiceUtilities.itemOfferCanBeApplied(itemOffer, order.getAllPromotableOrderItemPriceDetails())) {"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"applyItemQualifiersAndTargets(itemOffer, order);"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,if (itemOffer.isLegacyOffer()) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"applyLegacyAdjustments(order, itemOffer);"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,} else {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"applyAdjustments(order, itemOffer);"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,}
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"int qualifierQtyNeeded = offerServiceUtilities.markQualifiersForCriteria(itemOffer, itemCriteria, priceDetails);"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"public boolean markTargets(PromotableCandidateItemOffer itemOffer, PromotableOrder order, OrderItem relatedQualifier,"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,OrderItem relatedQualifierRoot = offerServiceUtilities.findRelatedQualifierRoot(relatedQualifier);
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"offerServiceUtilities.sortTargetItemDetails(priceDetails, itemOffer.getOffer().getApplyDiscountToSalePrice());"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"targetQtyNeeded = offerServiceUtilities.markTargetsForCriteria(itemOffer, relatedQualifier, checkOnly, promotion, relatedQualifierRoot, itemCriteria, priceDetails, targetQtyNeeded);"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,OrderItemHolder orderItemHolder = new OrderItemHolder(null);
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"int qualifierQtyNeeded = offerServiceUtilities.markRelatedQualifiersAndTargetsForItemCriteria(itemOffer, order,"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"orderItemHolder, itemCriteria, priceDetails, this);"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"return markTargets(itemOffer, order, orderItemHolder.getOrderItem(), false);"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,/**
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,* Provide an opportunity to for modules to override the potentialSavingsCalculation
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,* @param itemOffer
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,* @param item
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,* @param quantity
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,* @return
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,*/
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"protected Money calculatePotentialSavingsForOrderItem(PromotableCandidateItemOffer itemOffer,"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"PromotableOrderItem item, int quantity) {"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"Map<String,Object> contextMap = new HashMap<String,Object>();"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"extensionManager.getProxy().calculatePotentialSavings(itemOffer, item, quantity, contextMap);"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"// If the extensionHandler added a savings element to the map, then return it"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"Object o = contextMap.get(""savings"");"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,if (o != null && o instanceof Money) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,return (Money) o;
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"// If the extensionHandler added a quantity element to the map, then return it"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"o = contextMap.get(""quantity"");"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,if (o != null && o instanceof Integer) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,quantity = ((Integer) o).intValue();
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"return itemOffer.calculateSavingsForOrderItem(item, quantity);"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"Money itemSavings = calculatePotentialSavingsForOrderItem(itemOffer, item, discount.getQuantity());"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,potentialSavings = potentialSavings.add(itemSavings);
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,protected void restPriceDetails(PromotableOrderItem item) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,item.resetPriceDetails();
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,extensionManager.getProxy().resetPriceDetails(item);
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,extensionManager.getProxy().chooseSaleOrRetailAdjustments(order);
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,import org.broadleafcommerce.core.offer.service.discount.PromotionQualifier;
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOrderItemPriceDetailAdjustment;
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,import java.util.Comparator;
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,public class ItemOfferProcessorImpl extends OrderOfferProcessorImpl implements ItemOfferProcessor {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,/**
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* Private method used by applyAdjustments to create an OrderItemAdjustment from a CandidateOrderOffer
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* and associates the OrderItemAdjustment to the OrderItem.
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,*
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* @param orderOffer a CandidateOrderOffer to apply to an Order
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,*/
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"protected void applyOrderItemAdjustment(PromotableCandidateItemOffer itemOffer, PromotableOrderItemPriceDetail itemPriceDetail) {"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"PromotableOrderItemPriceDetailAdjustment promotableOrderItemPriceDetailAdjustment = promotableItemFactory.createPromotableOrderItemPriceDetailAdjustment(itemOffer, itemPriceDetail);"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,itemPriceDetail.addCandidateItemPriceDetailAdjustment(promotableOrderItemPriceDetailAdjustment);
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,}
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,for (PromotableOrderItemPriceDetail itemPriceDetail : itemPriceDetails) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,for (PromotionDiscount discount : itemPriceDetail.getPromotionDiscounts()) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (discount.getPromotion().equals(itemOffer.getOffer())) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (itemOffer.getOffer().isTotalitarianOffer() || !itemOffer.getOffer().isCombinableWithOtherOffers()) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,// We've decided to apply this adjustment but if it doesn't actually reduce
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,// the value of the item
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"if (adjustmentIsNotGoodEnoughToBeApplied(itemOffer, itemPriceDetail)) {"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,break;
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"applyOrderItemAdjustment(itemOffer, itemPriceDetail);"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* The adjustment might not be better than the sale price.
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* @param itemOffer
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* @param detail
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* @return
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"protected boolean adjustmentIsNotGoodEnoughToBeApplied(PromotableCandidateItemOffer itemOffer,"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,PromotableOrderItemPriceDetail detail) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (!itemOffer.getOffer().getApplyDiscountToSalePrice()) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,Money salePrice = detail.getPromotableOrderItem().getSalePriceBeforeAdjustments();
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,Money retailPrice = detail.getPromotableOrderItem().getRetailPriceBeforeAdjustments();
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"Money savings = itemOffer.calculateSavingsForOrderItem(detail.getPromotableOrderItem(), 1);"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (salePrice != null) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (salePrice.lessThan(retailPrice.subtract(savings))) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,// Not good enough
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,return true;
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,return false;
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* Return false if a totalitarian offer has already been applied and this order already has
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* item adjustments.
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"protected boolean itemOfferCanBeApplied(PromotableOrder order, PromotableCandidateItemOffer itemOffer) {"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,for (PromotableOrderItemPriceDetail detail : order.getAllPromotableOrderItemPriceDetails()) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,for (PromotableOrderItemPriceDetailAdjustment adjustment : detail.getCandidateItemAdjustments()) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (adjustment.isTotalitarian() || itemOffer.getOffer().isTotalitarianOffer()) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,// A totalitarian offer has already been applied or this offer is totalitarian
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,// and another offer was already applied.
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,} else if (itemOffer.isLegacyOffer()) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,continue;
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,} else if (!adjustment.isCombinable() || !itemOffer.getOffer().isCombinableWithOtherOffers()) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,// A nonCombinable offer has been applied or this is a non-combinable offer
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,// and adjustments have already been applied.
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"if (itemOfferCanBeApplied(order, itemOffer)) {"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"applyItemQualifiersAndTargets(itemOffer, order);"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (itemOffer.isLegacyOffer()) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"applyLegacyAdjustments(order, itemOffer);"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,} else {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"applyAdjustments(order, itemOffer);"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"Collections.sort(priceDetails, getQualifierItemComparator(itemOffer.getOffer().getApplyDiscountToSalePrice()));"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,// Calculate the number of qualifiers needed that will not receive the promotion.
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,// These will be reserved first before the target is assigned.
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,int qualifierQtyNeeded = itemCriteria.getQuantity();
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,for (PromotableOrderItemPriceDetail detail : priceDetails) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,// Mark Qualifiers
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (qualifierQtyNeeded > 0) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,int itemQtyAvailableToBeUsedAsQualifier = detail.getQuantityAvailableToBeUsedAsQualifier(itemOffer);
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (itemQtyAvailableToBeUsedAsQualifier > 0) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"int qtyToMarkAsQualifier = Math.min(qualifierQtyNeeded, itemQtyAvailableToBeUsedAsQualifier);"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,qualifierQtyNeeded -= qtyToMarkAsQualifier;
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"detail.addPromotionQualifier(itemOffer, itemCriteria, qtyToMarkAsQualifier);"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (qualifierQtyNeeded == 0) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"protected boolean markTargets(PromotableCandidateItemOffer itemOffer, PromotableOrder order, OrderItem relatedQualifier,"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,OrderItem relatedQualifierRoot = null;
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (relatedQualifier != null) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,relatedQualifierRoot = relatedQualifier;
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,while (relatedQualifierRoot.getParentOrderItem() != null) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,relatedQualifierRoot = relatedQualifierRoot.getParentOrderItem();
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"Collections.sort(priceDetails, getTargetItemComparator(itemOffer.getOffer().getApplyDiscountToSalePrice()));"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,for (PromotableOrderItemPriceDetail priceDetail : priceDetails) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"// We need to make sure that this item is either a parent, child, or the same as the qualifier root"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,OrderItem thisItem = priceDetail.getPromotableOrderItem().getOrderItem();
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (!relatedQualifierRoot.isAParentOf(thisItem) && !thisItem.isAParentOf(relatedQualifierRoot) &&
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,!thisItem.equals(relatedQualifierRoot)) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,int itemQtyAvailableToBeUsedAsTarget = priceDetail.getQuantityAvailableToBeUsedAsTarget(itemOffer);
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (itemQtyAvailableToBeUsedAsTarget > 0) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (promotion.isUnlimitedUsePerOrder() || (itemOffer.getUses() < promotion.getMaxUsesPerOrder())) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"int qtyToMarkAsTarget = Math.min(targetQtyNeeded, itemQtyAvailableToBeUsedAsTarget);"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,targetQtyNeeded -= qtyToMarkAsTarget;
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (!checkOnly) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"priceDetail.addPromotionDiscount(itemOffer, itemCriteria, qtyToMarkAsTarget);"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (targetQtyNeeded == 0) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,OrderItem relatedOrderItem = null;
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,OrderItem oi = detail.getPromotableOrderItem().getOrderItem();
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"// We have found a qualifier that meets this offer criteria. First, we'll save some state that we"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,// might need in the future.
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,OfferItemCriteria previousQualifierCriteria = null;
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,for (PromotionQualifier possibleQualifier : detail.getPromotionQualifiers()) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (possibleQualifier.getPromotion().equals(itemOffer.getOffer())) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,previousQualifierCriteria = possibleQualifier.getItemCriteria();
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,// Go ahead and mark this item as a qualifier
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"PromotionQualifier pq = detail.addPromotionQualifier(itemOffer, itemCriteria, qtyToMarkAsQualifier);"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"// Now, we need to see if there exists a target(s) that is suitable for this qualifier due to"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"// the relationship flag. If we are on the last qualifier required for this offer, we want to"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"// actually go ahead and mark the target that we'll be using. Otherwise, we just want to check"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,// that there is an eligible target(s) and continue on.
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"if (markTargets(itemOffer, order, oi, true)) {"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,// We found a target. Let's save this related order item used as the qualifier in case
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,// we succeed
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,relatedOrderItem = oi;
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"// If we didn't find a target, we need to roll back how we marked this item as a qualifier."
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,qualifierQtyNeeded += qtyToMarkAsQualifier;
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (pq.getQuantity() == qtyToMarkAsQualifier) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,detail.getPromotionQualifiers().remove(pq);
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,pq.setItemCriteria(previousQualifierCriteria);
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,pq.setQuantity(pq.getQuantity() - qtyToMarkAsQualifier);
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"return markTargets(itemOffer, order, relatedOrderItem, false);"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"* Used in {@link #applyItemQualifiersAndTargets(PromotableCandidateItemOffer, PromotableOrder)} allow for customized"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* sorting for which qualifier items should be attempted to be used first for a promotion. Default behavior
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"* is to sort descending, so higher-value items are attempted to be qualified first."
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* @param applyToSalePrice - whether or not the Comparator should use the sale price for comparison
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,protected Comparator<PromotableOrderItemPriceDetail> getQualifierItemComparator(final boolean applyToSalePrice) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,return new Comparator<PromotableOrderItemPriceDetail>() {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,@Override
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"public int compare(PromotableOrderItemPriceDetail o1, PromotableOrderItemPriceDetail o2) {"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,Money price = o1.getPromotableOrderItem().getPriceBeforeAdjustments(applyToSalePrice);
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,Money price2 = o2.getPromotableOrderItem().getPriceBeforeAdjustments(applyToSalePrice);
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,// highest amount first
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,return price2.compareTo(price);
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,};
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* <p>
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* sorting for which target items the promotion should be attempted to be applied to first. Default behavior is to
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"* sort descending, so higher-value items get the promotion over lesser-valued items."
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* </p>
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"* Note: By default, both the {@link #getQualifierItemComparator(boolean)} and this target comparator are sorted"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* in descending order.  This means that higher-valued items can be paired with higher-valued items and lower-valued
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* items can be paired with lower-valued items. This also ensures that you will <b>not</b> have the scenario where 2
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* lower-valued items can be used to qualify a higher-valued target.
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,protected Comparator<PromotableOrderItemPriceDetail> getTargetItemComparator(final boolean applyToSalePrice) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,potentialSavings = potentialSavings.add(
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"itemOffer.calculateSavingsForOrderItem(item, discount.getQuantity()));"
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,//qualifiedOrderOffers = removeTrailingNotCombinableOrderOffers(qualifiedOrderOffers);
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* Gets rid of totalitarian and nonCombinable item offers that can't possibly be applied.
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* @param qualifiedItemOffers
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,private void removeTrailingNonCombinableOrTotalitarianOffers(List<PromotableCandidateItemOffer> qualifiedItemOffers) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,boolean first = true;
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,Iterator<PromotableCandidateItemOffer> offerIterator = qualifiedItemOffers.iterator();
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (offerIterator.hasNext()) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,// ignore the first one.
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,offerIterator.next();
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,while (offerIterator.hasNext()) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,PromotableCandidateItemOffer itemOffer = offerIterator.next();
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (itemOffer.getOffer().isTotalitarianOffer()) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,// Remove Totalitarian offers that aren't the first offer.
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,offerIterator.remove();
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (!itemOffer.isLegacyOffer() && !itemOffer.getOffer().isCombinableWithOtherOffers()) {
38b662428724049fdb2d87211483b490450c7004,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,// Remove nonCombinable offers that aren't the first offer
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.core.offer.service.OfferServiceUtilities;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Resource(name = ""blOrderItemDao"")"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected OrderItemDao orderItemDao;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Resource(name = ""blOfferServiceUtilities"")"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected OfferServiceUtilities offerServiceUtilities;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"Map<OrderItem, PromotableOrderItem> promotableItemMap = offerServiceUtilities.buildPromotableItemMap(promotableOrder);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,List<OrderItem> orderItemList = offerServiceUtilities.buildOrderItemList(order);
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"offerServiceUtilities.updatePriceDetail(existingDetail, priceDetail);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"offerServiceUtilities.updatePriceDetail(newPriceDetail, priceDetail);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"offerServiceUtilities.removeUnmatchedPriceDetails(unmatchedDetailsMap, pdIterator);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"offerServiceUtilities.removeUnmatchedQualifiers(unmatchedQualifiersMap, qIterator);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"Map<Long, OrderItemPriceDetailAdjustment> itemAdjustmentMap ="
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,offerServiceUtilities.buildItemDetailAdjustmentMap(itemDetail);
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (extensionManager != null) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,extensionManager.getProxy().synchronizeAdjustmentsAndPrices(promotableOrder);
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public OfferServiceUtilities getOfferServiceUtilities() {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return offerServiceUtilities;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setOfferServiceUtilities(OfferServiceUtilities offerServiceUtilities) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.offerServiceUtilities = offerServiceUtilities;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.core.order.domain.OrderItemContainer;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Resource(name = ""blOrderItemDao"")"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected OrderItemDao orderItemDao;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected List<OrderItem> buildOrderItemList(Order order) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,List<OrderItem> orderItemList = new ArrayList<OrderItem>();
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (OrderItem currentItem : order.getOrderItems()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (currentItem instanceof OrderItemContainer) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,OrderItemContainer container = (OrderItemContainer) currentItem;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (container.isPricingAtContainerLevel()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,orderItemList.add(currentItem);
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,} else {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (OrderItem containedItem : container.getOrderItems()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,orderItemList.add(containedItem);
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,}
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return orderItemList;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"Map<OrderItem, PromotableOrderItem> promotableItemMap = buildPromotableItemMap(promotableOrder);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,List<OrderItem> orderItemList = buildOrderItemList(order);
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"protected Map<OrderItem, PromotableOrderItem> buildPromotableItemMap(PromotableOrder promotableOrder) {"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"Map<OrderItem, PromotableOrderItem> promotableItemMap = new HashMap<OrderItem, PromotableOrderItem>();"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (PromotableOrderItem item : promotableOrder.getDiscountableOrderItems()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"promotableItemMap.put(item.getOrderItem(), item);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return promotableItemMap;
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"updatePriceDetail(existingDetail, priceDetail);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"updatePriceDetail(newPriceDetail, priceDetail);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,while (pdIterator.hasNext()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,OrderItemPriceDetail currentDetail = pdIterator.next();
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (unmatchedDetailsMap.containsKey(currentDetail.getId())) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,pdIterator.remove();
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,while (qIterator.hasNext()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,OrderItemQualifier currentQualifier = qIterator.next();
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (unmatchedQualifiersMap.containsKey(currentQualifier.getId())) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,qIterator.remove();
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"protected void updatePriceDetail(OrderItemPriceDetail itemDetail,"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,PromotableOrderItemPriceDetail promotableDetail) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"Map<Long, OrderItemPriceDetailAdjustment> itemAdjustmentMap = buildItemDetailAdjustmentMap(itemDetail);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (itemDetail.getQuantity() != promotableDetail.getQuantity()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,itemDetail.setQuantity(promotableDetail.getQuantity());
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (promotableDetail.isAdjustmentsFinalized()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,itemDetail.setUseSalePrice(promotableDetail.useSaleAdjustments());
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (PromotableOrderItemPriceDetailAdjustment adjustment : promotableDetail.getCandidateItemAdjustments()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,OrderItemPriceDetailAdjustment itemAdjustment = itemAdjustmentMap.remove(adjustment.getOfferId());
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (itemAdjustment != null) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// Update existing adjustment
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (!itemAdjustment.getValue().equals(adjustment.getAdjustmentValue())) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"updateItemAdjustment(itemAdjustment, adjustment);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// Add a new adjustment
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,OrderItemPriceDetailAdjustment newItemAdjustment = offerDao.createOrderItemPriceDetailAdjustment();
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"newItemAdjustment.init(itemDetail, adjustment.getOffer(), null);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"updateItemAdjustment(newItemAdjustment, adjustment);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,itemDetail.getOrderItemPriceDetailAdjustments().add(newItemAdjustment);
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (itemAdjustmentMap.size() > 0) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// Remove adjustments that were on the order item but no longer needed.
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,List<Long> adjustmentIdsToRemove = new ArrayList<Long>();
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (OrderItemPriceDetailAdjustment adjustmentToRemove : itemAdjustmentMap.values()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,adjustmentIdsToRemove.add(adjustmentToRemove.getOffer().getId());
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Iterator<OrderItemPriceDetailAdjustment> iterator = itemDetail.getOrderItemPriceDetailAdjustments().iterator();
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,while (iterator.hasNext()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,OrderItemPriceDetailAdjustment adj = iterator.next();
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (adjustmentIdsToRemove.contains(adj.getOffer().getId())) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,iterator.remove();
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"protected void updateItemAdjustment(OrderItemPriceDetailAdjustment itemAdjustment,"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,PromotableOrderItemPriceDetailAdjustment promotableAdjustment) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,itemAdjustment.setValue(promotableAdjustment.getAdjustmentValue());
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,itemAdjustment.setSalesPriceValue(promotableAdjustment.getSaleAdjustmentValue());
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,itemAdjustment.setRetailPriceValue(promotableAdjustment.getRetailAdjustmentValue());
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,itemAdjustment.setAppliedToSalePrice(promotableAdjustment.isAppliedToSalePrice());
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"protected Map<Long, OrderItemPriceDetailAdjustment> buildItemDetailAdjustmentMap(OrderItemPriceDetail itemDetail) {"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"Map<Long, OrderItemPriceDetailAdjustment> itemAdjustmentMap = new HashMap<Long, OrderItemPriceDetailAdjustment>();"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (OrderItemPriceDetailAdjustment adjustment : itemDetail.getOrderItemPriceDetailAdjustments()) {
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"itemAdjustmentMap.put(adjustment.getOffer().getId(), adjustment);"
38b662428724049fdb2d87211483b490450c7004,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return itemAdjustmentMap;
38b662428724049fdb2d87211483b490450c7004,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl();
38b662428724049fdb2d87211483b490450c7004,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,offerServiceUtilities.setOfferDao(offerDaoMock);
38b662428724049fdb2d87211483b490450c7004,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl());
38b662428724049fdb2d87211483b490450c7004,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,orderProcessor.setOfferServiceUtilities(offerServiceUtilities);
38b662428724049fdb2d87211483b490450c7004,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,ItemOfferProcessorImpl itemProcessor = new ItemOfferProcessorImpl();
38b662428724049fdb2d87211483b490450c7004,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,itemProcessor.setOfferServiceUtilities(offerServiceUtilities);
38b662428724049fdb2d87211483b490450c7004,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,import org.broadleafcommerce.core.offer.service.processor.ItemOfferProcessor;
38b662428724049fdb2d87211483b490450c7004,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,ItemOfferProcessor itemProcessor = new ItemOfferProcessorImpl();
38b662428724049fdb2d87211483b490450c7004,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,import org.broadleafcommerce.core.offer.service.OfferServiceUtilitiesImpl;
38b662428724049fdb2d87211483b490450c7004,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl();
38b662428724049fdb2d87211483b490450c7004,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,offerServiceUtilities.setOfferDao(offerDaoMock);
38b662428724049fdb2d87211483b490450c7004,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl());
38b662428724049fdb2d87211483b490450c7004,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,orderProcessor.setOfferServiceUtilities(offerServiceUtilities);
38b662428724049fdb2d87211483b490450c7004,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,ItemOfferProcessorImpl itemProcessor = new ItemOfferProcessorImpl();
38b662428724049fdb2d87211483b490450c7004,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,itemProcessor.setOfferServiceUtilities(offerServiceUtilities);
38b662428724049fdb2d87211483b490450c7004,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,ItemOfferProcessor itemProcessor = new ItemOfferProcessorImpl();
754550252e8aa20c5fd0f821d2ff3feb2e46ad08,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,//check to see if there's a method call on this field
754550252e8aa20c5fd0f821d2ff3feb2e46ad08,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"int methodPos = field.lastIndexOf(""."");"
754550252e8aa20c5fd0f821d2ff3feb2e46ad08,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,int parenthesisPos = -1;
754550252e8aa20c5fd0f821d2ff3feb2e46ad08,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,if (methodPos >= 0) {
754550252e8aa20c5fd0f821d2ff3feb2e46ad08,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"parenthesisPos = field.indexOf(""()"", methodPos);"
754550252e8aa20c5fd0f821d2ff3feb2e46ad08,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,}
754550252e8aa20c5fd0f821d2ff3feb2e46ad08,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,if (methodPos >= 0 && parenthesisPos >= 0) {
754550252e8aa20c5fd0f821d2ff3feb2e46ad08,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"field = field.substring(0, methodPos);"
772099afea972a0d3ca92a498f0f6d49e35e833a,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,import org.thymeleaf.standard.expression.Expression;
772099afea972a0d3ca92a498f0f6d49e35e833a,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,import org.thymeleaf.standard.expression.StandardExpressions;
772099afea972a0d3ca92a498f0f6d49e35e833a,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,Expression expression = (Expression) StandardExpressions.getExpressionParser(arguments.getConfiguration())
772099afea972a0d3ca92a498f0f6d49e35e833a,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,".parseExpression(arguments.getConfiguration(), arguments, element.getAttributeValue(attributeName));"
772099afea972a0d3ca92a498f0f6d49e35e833a,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,"Object component = expression.execute(arguments.getConfiguration(), arguments);"
772099afea972a0d3ca92a498f0f6d49e35e833a,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.thymeleaf.standard.expression.StandardExpressionProcessor;
772099afea972a0d3ca92a498f0f6d49e35e833a,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,"Object component = StandardExpressionProcessor.processExpression(arguments, element.getAttributeValue(attributeName));"
835be7ddb39160d76d05921e12f8f219edc158af,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,@AdminPresentation(excluded = true)
835be7ddb39160d76d05921e12f8f219edc158af,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,import org.broadleafcommerce.common.presentation.client.SupportedFieldType;
835be7ddb39160d76d05921e12f8f219edc158af,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,@AdminPresentation(
835be7ddb39160d76d05921e12f8f219edc158af,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"friendlyName = ""AdminUserImpl_Admin_Password"","
835be7ddb39160d76d05921e12f8f219edc158af,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"order = 3,"
835be7ddb39160d76d05921e12f8f219edc158af,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"group = ""AdminUserImpl_User"","
835be7ddb39160d76d05921e12f8f219edc158af,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"fieldType = SupportedFieldType.PASSWORD,"
835be7ddb39160d76d05921e12f8f219edc158af,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,validationConfigurations={
835be7ddb39160d76d05921e12f8f219edc158af,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,@ValidationConfiguration(
835be7ddb39160d76d05921e12f8f219edc158af,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"validationImplementation = ""org.broadleafcommerce.openadmin.server.service.persistence.validation.MatchesFieldValidator"","
835be7ddb39160d76d05921e12f8f219edc158af,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,configurationItems = {
835be7ddb39160d76d05921e12f8f219edc158af,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"@ConfigurationItem(itemName = ConfigurationItem.ERROR_MESSAGE, itemValue = ""passwordNotMatchError""),"
835be7ddb39160d76d05921e12f8f219edc158af,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"@ConfigurationItem(itemName=""otherField"", itemValue=""passwordConfirm"")"
835be7ddb39160d76d05921e12f8f219edc158af,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,}
835be7ddb39160d76d05921e12f8f219edc158af,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,)
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.core.order.service.MergeCartService;
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.core.order.service.call.MergeCartResponse;
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.core.order.service.exception.RemoveFromCartException;
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.core.pricing.service.exception.PricingException;
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* Ensures that the customer's current cart is available to the request.
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,*
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"* Also invokes blMergeCartProcessor"" if the user has just logged in."
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"* Genericized version of the CartStateFilter. This was made to facilitate reuse between Servlet Filters, Portlet Filters"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* and Spring MVC interceptors. Spring has an easy way of converting HttpRequests and PortletRequests into WebRequests
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* via <br />
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"private String mergeCartResponseKey = ""bl_merge_cart_response"";"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"@Resource(name = ""blMergeCartService"")"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,private MergeCartService mergeCartService;
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"@Resource(name = ""blCustomerStateRequestProcessor"")"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,protected CustomerStateRequestProcessor customerStateRequestProcessor;
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"protected static String cartRequestAttributeName = ""cart"";"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"Customer customer = (Customer) request.getAttribute(CustomerStateRequestProcessor.getCustomerRequestAttributeName(),"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,WebRequest.SCOPE_REQUEST);
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (customer == null) {
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,return;
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,}
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,Order cart = null;
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"if (mergeCartNeeded(customer, request)) {"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"LOG.trace(""Merge cart required, calling mergeCart "" + customer.getId());"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"cart = mergeCart(customer, request);"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,} else {
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,cart = orderService.findCartForCustomer(customer);
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (cart == null) {
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,cart = orderService.getNullOrder();
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,updateCartService.updateAndValidateCart(cart);
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"request.setAttribute(cartRequestAttributeName, cart, WebRequest.SCOPE_REQUEST);"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,// Setup cart for content rule processing
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"Map<String, Object> ruleMap = (Map<String, Object>) request.getAttribute(BLC_RULE_MAP_PARAM, WebRequest.SCOPE_REQUEST);"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (ruleMap == null) {
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"ruleMap = new HashMap<String, Object>();"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"ruleMap.put(""order"", cart);"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"// Leaving the following line in for backwards compatibility, but all rules should use order as the"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,// variable name.
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"ruleMap.put(""cart"", cart);"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"request.setAttribute(BLC_RULE_MAP_PARAM, ruleMap, WebRequest.SCOPE_REQUEST);"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"public boolean mergeCartNeeded(Customer customer, WebRequest request) {"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,Customer anonymousCustomer = customerStateRequestProcessor.resolveAnonymousCustomer(request);
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,return (anonymousCustomer != null && customer.getId() != null && !customer.getId().equals(anonymousCustomer.getId()));
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"public Order mergeCart(Customer customer, WebRequest request) {"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,MergeCartResponse mergeCartResponse;
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,try {
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,Order cart = orderService.findCartForCustomer(anonymousCustomer);
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"mergeCartResponse = mergeCartService.mergeCart(customer, cart);"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,} catch (PricingException e) {
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,throw new RuntimeException(e);
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,} catch (RemoveFromCartException e) {
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"request.setAttribute(mergeCartResponseKey, mergeCartResponse, WebRequest.SCOPE_GLOBAL_SESSION);"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,return mergeCartResponse.getOrder();
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,public static String getCartRequestAttributeName() {
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,return cartRequestAttributeName;
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,public static void setCartRequestAttributeName(String cartRequestAttributeName) {
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,CartStateRequestProcessor.cartRequestAttributeName = cartRequestAttributeName;
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import org.broadleafcommerce.core.order.service.call.UpdateCartResponse;
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"* Genericized version of the CartStateFilter. This was made to facilitate reuse between Servlet Filters, Portlet Filters and Spring MVC interceptors. Spring has an easy way of converting HttpRequests and PortletRequests into WebRequests via <br />"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,protected boolean copyCartWhenSpecifiedStateChanges = false;
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"protected static String cartRequestAttributeName = ""cart"";"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"Customer customer = (Customer) request.getAttribute(CustomerStateRequestProcessor.getCustomerRequestAttributeName(), WebRequest.SCOPE_REQUEST);"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (customer != null) {
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"LOG.trace(""Looking up cart for customer "" + customer.getId());"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,}
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,Order cart = orderService.findCartForCustomer(customer);
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (cart == null) {
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,cart = orderService.getNullOrder();
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,} else {
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,try {
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,updateCartService.validateCart(cart);
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,} catch (IllegalArgumentException e) {
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (copyCartWhenSpecifiedStateChanges) {
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,UpdateCartResponse updateCartResponse = updateCartService.copyCartToCurrentContext(cart);
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"request.setAttribute(""updateCartResponse"", updateCartResponse, WebRequest.SCOPE_REQUEST);"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,orderService.cancelOrder(cart);
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,cart = orderService.createNewCartForCustomer(customer);
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"request.setAttribute(cartRequestAttributeName, cart, WebRequest.SCOPE_REQUEST);"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,// Setup cart for content rule processing
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"Map<String, Object> ruleMap = (Map<String, Object>) request.getAttribute(BLC_RULE_MAP_PARAM, WebRequest.SCOPE_REQUEST);"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (ruleMap == null) {
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"ruleMap = new HashMap<String, Object>();"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"ruleMap.put(""order"", cart);"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"// Leaving the following line in for backwards compatibility, but all rules should use order as the"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,// variable name.
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"ruleMap.put(""cart"", cart);"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"request.setAttribute(BLC_RULE_MAP_PARAM, ruleMap, WebRequest.SCOPE_REQUEST);"
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,public static String getCartRequestAttributeName() {
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,return cartRequestAttributeName;
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,public static void setCartRequestAttributeName(String cartRequestAttributeName) {
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,CartStateRequestProcessor.cartRequestAttributeName = cartRequestAttributeName;
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,/**
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,* Gets whether or not the cart should be copied to a new cart and then repriced if
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,* {@link UpdateCartService#validateCart(Order)} throws an IllegalArgumentException
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,*
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,* @return the copyCartWhenSpecifiedStateChanges
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,*/
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,public boolean isCopyCartWhenSpecifiedStateChanges() {
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,return copyCartWhenSpecifiedStateChanges;
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,* @param copyCartWhenSpecifiedStateChanges whether or not the old cart should be copied to a new cart and then repriced
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,public void setCopyCartWhenSpecifiedStateChanges(boolean copyCartWhenSpecifiedStateChanges) {
66308746563e98e27d8bbce48d03fca2d47941db,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,this.copyCartWhenSpecifiedStateChanges = copyCartWhenSpecifiedStateChanges;
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,import org.broadleafcommerce.core.order.service.MergeCartService;
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,import org.broadleafcommerce.core.order.service.call.MergeCartResponse;
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,import org.broadleafcommerce.core.order.service.exception.RemoveFromCartException;
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,import org.broadleafcommerce.core.pricing.service.exception.PricingException;
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,* Ensures that the customer's current cart is available to the request.
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,*
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,"* Also invokes blMergeCartProcessor"" if the user has just logged in."
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,"* Genericized version of the CartStateFilter. This was made to facilitate reuse between Servlet Filters, Portlet Filters"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,* and Spring MVC interceptors. Spring has an easy way of converting HttpRequests and PortletRequests into WebRequests
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,* via <br />
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,"private String mergeCartResponseKey = ""bl_merge_cart_response"";"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,"@Resource(name = ""blMergeCartService"")"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,private MergeCartService mergeCartService;
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,"@Resource(name = ""blCustomerStateRequestProcessor"")"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,protected CustomerStateRequestProcessor customerStateRequestProcessor;
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,"protected static String cartRequestAttributeName = ""cart"";"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,"Customer customer = (Customer) request.getAttribute(CustomerStateRequestProcessor.getCustomerRequestAttributeName(),"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,WebRequest.SCOPE_REQUEST);
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,if (customer == null) {
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,return;
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,}
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,Order cart = null;
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,"if (mergeCartNeeded(customer, request)) {"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,"LOG.trace(""Merge cart required, calling mergeCart "" + customer.getId());"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,"cart = mergeCart(customer, request);"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,} else {
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,cart = orderService.findCartForCustomer(customer);
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,if (cart == null) {
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,cart = orderService.getNullOrder();
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,updateCartService.updateAndValidateCart(cart);
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,"request.setAttribute(cartRequestAttributeName, cart, WebRequest.SCOPE_REQUEST);"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,// Setup cart for content rule processing
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,"Map<String, Object> ruleMap = (Map<String, Object>) request.getAttribute(BLC_RULE_MAP_PARAM, WebRequest.SCOPE_REQUEST);"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,if (ruleMap == null) {
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,"ruleMap = new HashMap<String, Object>();"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,"ruleMap.put(""order"", cart);"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,"// Leaving the following line in for backwards compatibility, but all rules should use order as the"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,// variable name.
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,"ruleMap.put(""cart"", cart);"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,"request.setAttribute(BLC_RULE_MAP_PARAM, ruleMap, WebRequest.SCOPE_REQUEST);"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,"public boolean mergeCartNeeded(Customer customer, WebRequest request) {"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,Customer anonymousCustomer = customerStateRequestProcessor.resolveAnonymousCustomer(request);
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,return (anonymousCustomer != null && customer.getId() != null && !customer.getId().equals(anonymousCustomer.getId()));
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,"public Order mergeCart(Customer customer, WebRequest request) {"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,MergeCartResponse mergeCartResponse;
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,try {
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,Order cart = orderService.findCartForCustomer(anonymousCustomer);
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,"mergeCartResponse = mergeCartService.mergeCart(customer, cart);"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,} catch (PricingException e) {
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,throw new RuntimeException(e);
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,} catch (RemoveFromCartException e) {
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,"request.setAttribute(mergeCartResponseKey, mergeCartResponse, WebRequest.SCOPE_GLOBAL_SESSION);"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,return mergeCartResponse.getOrder();
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,public static String getCartRequestAttributeName() {
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,return cartRequestAttributeName;
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,public static void setCartRequestAttributeName(String cartRequestAttributeName) {
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,added,0,CartStateRequestProcessor.cartRequestAttributeName = cartRequestAttributeName;
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,import org.broadleafcommerce.core.order.service.call.UpdateCartResponse;
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,"* Genericized version of the CartStateFilter. This was made to facilitate reuse between Servlet Filters, Portlet Filters and Spring MVC interceptors. Spring has an easy way of converting HttpRequests and PortletRequests into WebRequests via <br />"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,protected boolean copyCartWhenSpecifiedStateChanges = false;
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,"protected static String cartRequestAttributeName = ""cart"";"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,"Customer customer = (Customer) request.getAttribute(CustomerStateRequestProcessor.getCustomerRequestAttributeName(), WebRequest.SCOPE_REQUEST);"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,if (customer != null) {
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,"LOG.trace(""Looking up cart for customer "" + customer.getId());"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,}
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,Order cart = orderService.findCartForCustomer(customer);
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,if (cart == null) {
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,cart = orderService.getNullOrder();
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,} else {
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,try {
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,updateCartService.validateCart(cart);
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,} catch (IllegalArgumentException e) {
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,if (copyCartWhenSpecifiedStateChanges) {
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,UpdateCartResponse updateCartResponse = updateCartService.copyCartToCurrentContext(cart);
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,"request.setAttribute(""updateCartResponse"", updateCartResponse, WebRequest.SCOPE_REQUEST);"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,orderService.cancelOrder(cart);
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,cart = orderService.createNewCartForCustomer(customer);
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,"request.setAttribute(cartRequestAttributeName, cart, WebRequest.SCOPE_REQUEST);"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,// Setup cart for content rule processing
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,"Map<String, Object> ruleMap = (Map<String, Object>) request.getAttribute(BLC_RULE_MAP_PARAM, WebRequest.SCOPE_REQUEST);"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,if (ruleMap == null) {
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,"ruleMap = new HashMap<String, Object>();"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,"ruleMap.put(""order"", cart);"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,"// Leaving the following line in for backwards compatibility, but all rules should use order as the"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,// variable name.
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,"ruleMap.put(""cart"", cart);"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,"request.setAttribute(BLC_RULE_MAP_PARAM, ruleMap, WebRequest.SCOPE_REQUEST);"
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,public static String getCartRequestAttributeName() {
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,return cartRequestAttributeName;
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,public static void setCartRequestAttributeName(String cartRequestAttributeName) {
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,CartStateRequestProcessor.cartRequestAttributeName = cartRequestAttributeName;
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,/**
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,* Gets whether or not the cart should be copied to a new cart and then repriced if
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,* {@link UpdateCartService#validateCart(Order)} throws an IllegalArgumentException
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,*
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,* @return the copyCartWhenSpecifiedStateChanges
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,*/
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,public boolean isCopyCartWhenSpecifiedStateChanges() {
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,return copyCartWhenSpecifiedStateChanges;
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,* @param copyCartWhenSpecifiedStateChanges whether or not the old cart should be copied to a new cart and then repriced
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,public void setCopyCartWhenSpecifiedStateChanges(boolean copyCartWhenSpecifiedStateChanges) {
66308746563e98e27d8bbce48d03fca2d47941db,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,this.copyCartWhenSpecifiedStateChanges = copyCartWhenSpecifiedStateChanges;
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,import org.broadleafcommerce.common.presentation.client.SupportedFieldType;
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"@AdminPresentation(friendlyName = ""AdminUserImpl_Admin_Name"", gridOrder = 1000, order = 1000,"
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"group = ""AdminUserImpl_User"", prominent = true)"
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"@AdminPresentation(friendlyName = ""AdminUserImpl_Admin_Login"", gridOrder = 2000, order = 2000,"
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"@Column(name = ""PASSWORD"")"
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,@AdminPresentation(
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"friendlyName = ""AdminUserImpl_Admin_Password"", order = 6000,"
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"group = ""AdminUserImpl_User"","
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"fieldType = SupportedFieldType.PASSWORD,"
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,validationConfigurations = { @ValidationConfiguration(
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"validationImplementation = ""org.broadleafcommerce.openadmin.server.service.persistence.validation.MatchesFieldValidator"","
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,configurationItems = {
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"@ConfigurationItem(itemName = ConfigurationItem.ERROR_MESSAGE, itemValue = ""passwordNotMatchError""),"
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"@ConfigurationItem(itemName = ""otherField"", itemValue = ""passwordConfirm"")"
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,}
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,)
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,})
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"@AdminPresentation(friendlyName = ""AdminUserImpl_Admin_Email_Address"", order = 3000, group = ""AdminUserImpl_User"")"
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"@AdminPresentation(friendlyName = ""AdminUserImpl_Phone_Number"", order = 5000, group = ""AdminUserImpl_User"")"
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"@AdminPresentation(friendlyName = ""AdminUserImpl_Active_Status"","
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"order = 4000, group = ""AdminUserImpl_User"")"
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"@AdminPresentation(friendlyName = ""AdminUserImpl_Admin_Name"", order = 1, group = ""AdminUserImpl_User"", prominent = true,"
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,validationConfigurations = { @ValidationConfiguration(
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"validationImplementation = ""org.broadleafcommerce.openadmin.server.service.persistence.validation.RegexPropertyValidator"","
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"configurationItems = { @ConfigurationItem(itemName = ""regularExpression"", itemValue = ""\\w+""),"
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"@ConfigurationItem(itemName = ConfigurationItem.ERROR_MESSAGE, itemValue = ""Only word characters are allowed"") }"
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,) })
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"@AdminPresentation(friendlyName = ""AdminUserImpl_Admin_Login"", order=2, group = ""AdminUserImpl_User"", prominent=true)"
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"@Column(name = ""PASSWORD"", nullable=false)"
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,@AdminPresentation(excluded = true)
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"@AdminPresentation(friendlyName = ""AdminUserImpl_Admin_Email_Address"", order=4, group = ""AdminUserImpl_User"")"
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"@AdminPresentation(friendlyName = ""AdminUserImpl_Phone_Number"", order=5, group = ""AdminUserImpl_User"")"
f7135e6ef676ab5135dfbc7573f38ad38f86c298,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"@AdminPresentation(friendlyName = ""AdminUserImpl_Active_Status"", order=6, group = ""AdminUserImpl_User"")"
9a1ae1678f43cd4b706fd2a302879c0f42dc4637,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.profile.web.core.CustomerState;
9a1ae1678f43cd4b706fd2a302879c0f42dc4637,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,Customer customer = CustomerState.getCustomer();
9a1ae1678f43cd4b706fd2a302879c0f42dc4637,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"LOG.warn(""No customer was found on the current request, no cart will be added to the current request. Ensure that the"""
9a1ae1678f43cd4b706fd2a302879c0f42dc4637,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"+ "" blCustomerStateFilter occurs prior to the blCartStateFilter"");"
9a1ae1678f43cd4b706fd2a302879c0f42dc4637,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (LOG.isDebugEnabled()) {
9a1ae1678f43cd4b706fd2a302879c0f42dc4637,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"LOG.debug(""Merge cart required, calling mergeCart "" + customer.getId());"
9a1ae1678f43cd4b706fd2a302879c0f42dc4637,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,Customer anonymousCustomer = CustomerStateRequestProcessor.getAnonymousCustomer(request);
9a1ae1678f43cd4b706fd2a302879c0f42dc4637,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"@Resource(name = ""blCustomerStateRequestProcessor"")"
9a1ae1678f43cd4b706fd2a302879c0f42dc4637,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,protected CustomerStateRequestProcessor customerStateRequestProcessor;
9a1ae1678f43cd4b706fd2a302879c0f42dc4637,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"Customer customer = (Customer) request.getAttribute(CustomerStateRequestProcessor.getCustomerRequestAttributeName(),"
9a1ae1678f43cd4b706fd2a302879c0f42dc4637,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,WebRequest.SCOPE_REQUEST);
9a1ae1678f43cd4b706fd2a302879c0f42dc4637,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (LOG.isTraceEnabled()) {
9a1ae1678f43cd4b706fd2a302879c0f42dc4637,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"LOG.trace(""Merge cart required, calling mergeCart "" + customer.getId());"
9a1ae1678f43cd4b706fd2a302879c0f42dc4637,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,Customer anonymousCustomer = customerStateRequestProcessor.resolveAnonymousCustomer(request);
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"//If there is no Customer object in session, AND no customer id in session, create a new customer"
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,//and store the entire customer in session (don't persist to DB just yet)
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,customer = customerService.createNewCustomer();
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"request.setAttribute(getAnonymousCustomerSessionAttributeName(), customer, WebRequest.SCOPE_GLOBAL_SESSION);"
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* Returns the anonymous customer that was saved in session. This first checks for a full customer in session (meaning
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* that the customer has not already been persisted) and returns that. If there is no full customer in session (and
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* there is instead just an anonymous customer ID) then this will look up the customer from the database using that and
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* return it.
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* @param request the current request
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* @return the anonymous customer in session or null if there is no anonymous customer represented in session
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* @see {@link #getAnonymousCustomerSessionAttributeName()}
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* @see {@link #getAnonymousCustomerIdSessionAttributeName()}
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,public Customer getAnonymousCustomer(WebRequest request) {
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"Customer anonymousCustomer = (Customer) request.getAttribute(getAnonymousCustomerSessionAttributeName(),"
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,WebRequest.SCOPE_GLOBAL_SESSION);
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (anonymousCustomer == null) {
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"//Customer is not in session, see if we have just a customer ID in session (the anonymous customer might have"
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,//already been persisted)
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"Long customerId = (Long) request.getAttribute(getAnonymousCustomerIdSessionAttributeName(), WebRequest.SCOPE_GLOBAL_SESSION);"
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (customerId != null) {
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"//we have a customer ID in session, look up the customer from the database to ensure we have an up-to-date"
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,//customer to store in CustomerState
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,anonymousCustomer = customerService.readCustomerById(customerId);
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,}
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,return anonymousCustomer;
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* <p>Returns the session attribute to store the anonymous customer ID. This session attribute should be used to track
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* date in regards to Hibernate (specifically with lists).</p>
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"* <p>So, once Broadleaf detects that the session-based {@link Customer} has been persisted, it should remove the session-based"
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* {@link Customer} and then utilize just the customer ID from session.</p>
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"//Customer is not in session, see if we have just a customer ID in session (the anonymous customer might have"
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,//already been persisted)
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"Long customerId = (Long) request.getAttribute(getAnonymousCustomerIdSessionAttributeName(), WebRequest.SCOPE_GLOBAL_SESSION);"
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (customerId != null) {
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"//we have a customer ID in session, look up the customer from the database to ensure we have an up-to-date"
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,//customer to store in CustomerState
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,customer = customerService.readCustomerById(customerId);
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,}
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"//If there is no Customer object in session, AND no customer id in session, create a new customer"
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,//and store the entire customer in session (don't persist to DB just yet)
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (customer == null) {
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,customer = customerService.createNewCustomer();
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"request.setAttribute(getAnonymousCustomerSessionAttributeName(), customer, WebRequest.SCOPE_GLOBAL_SESSION);"
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,* Returns the anonymous customer that was saved in session or null if none exists.
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,* @param request - the current request
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,* @return the anonymous customer that has not been persisted in the database but is available as a session object
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,public static Customer getAnonymousCustomer(WebRequest request) {
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"return (Customer) request.getAttribute(getAnonymousCustomerSessionAttributeName(), WebRequest.SCOPE_GLOBAL_SESSION);"
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,* Returns the session attribute to store the anonymous customer ID. This session attribute should be used to track
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,* date in regards to Hibernate (specifically with lists).
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"* So, once Broadleaf detects that the session-based {@link Customer} has been persisted, it should remove the session-based"
1a6d6be66f52087fa0cf544aa5aa8416da867475,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,* {@link Customer} and then utilize just the customer ID from session.
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,import org.broadleafcommerce.profile.core.domain.Customer;
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,import org.springframework.security.core.authority.SimpleGrantedAuthority;
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,import javax.annotation.Resource;
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,/**
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,* This class is being un-deprecated because we want the query for the customer to happen through Hibernate instead of
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,"* through raw JDBC, which is the case when <sec:jdbc-user-service /> is used. We need the query to go through Hibernate"
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,* so that we are able to attach the necessary filters in certain circumstances.
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,*
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,* @author Andre Azzolini (apazzolini)
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,*/
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,"@Resource(name = ""blCustomerService"")"
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,"@Resource(name = ""blRoleService"")"
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,Customer customer = customerService.readCustomerByUsername(username);
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,"return new User(username, customer.getPassword(), true, true, !customer.isPasswordChangeRequired(), true, grantedAuthorities);"
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,boolean roleUserFound = false;
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,grantedAuthorities.add(new SimpleGrantedAuthority(role.getRoleName()));
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,"if (role.getRoleName().equals(""ROLE_USER"")) {"
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,roleUserFound = true;
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,}
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,if (!roleUserFound) {
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,"grantedAuthorities.add(new SimpleGrantedAuthority(""ROLE_USER""));"
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,import org.springframework.security.core.authority.GrantedAuthorityImpl;
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,import javax.annotation.Resource;
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,@Deprecated
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,"@Resource(name=""blCustomerService"")"
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,"@Resource(name=""blRoleService"")"
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,protected boolean forcePasswordChange = false;
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,public void setForcePasswordChange(boolean forcePasswordChange) {
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,this.forcePasswordChange = forcePasswordChange;
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,}
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,org.broadleafcommerce.profile.core.domain.Customer customer = customerService.readCustomerByUsername(username);
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,User returnUser = null;
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,boolean pwChangeRequired = customer.isPasswordChangeRequired();
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,if (pwChangeRequired) {
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,if (forcePasswordChange) {
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,"returnUser = new User(username, customer.getPassword(), true, true, !customer.isPasswordChangeRequired(), true, grantedAuthorities);"
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,} else {
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,"grantedAuthorities.add(new GrantedAuthorityImpl(""ROLE_PASSWORD_CHANGE_REQUIRED""));"
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,"returnUser = new User(username, customer.getPassword(), true, true, true, true, grantedAuthorities);"
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,return returnUser;
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,public void setCustomerService(CustomerService customerService) {
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,this.customerService = customerService;
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,"grantedAuthorities.add(new GrantedAuthorityImpl(""ROLE_USER""));"
3fa70f6e08f986cf647a64a85e09e7a398307cb0,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,grantedAuthorities.add(new GrantedAuthorityImpl(role.getRoleName()));
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,* #%L
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,* BroadleafCommerce Profile
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,* %%
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,* Copyright (C) 2009 - 2013 Broadleaf Commerce
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,*
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,*       http://www.apache.org/licenses/LICENSE-2.0
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,* #L%
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,import org.broadleafcommerce.profile.core.domain.Customer;
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,import org.springframework.security.core.authority.SimpleGrantedAuthority;
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,import javax.annotation.Resource;
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,/**
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,* This class is being un-deprecated because we want the query for the customer to happen through Hibernate instead of
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,"* through raw JDBC, which is the case when <sec:jdbc-user-service /> is used. We need the query to go through Hibernate"
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,* so that we are able to attach the necessary filters in certain circumstances.
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,* @author Andre Azzolini (apazzolini)
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,* @author Phillip Verheyden (phillipuniverse)
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,*/
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,"@Resource(name = ""blCustomerService"")"
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,"@Resource(name = ""blRoleService"")"
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,@Override
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,Customer customer = customerService.readCustomerByUsername(username);
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,"return new CustomerUserDetails(customer.getId(), username, customer.getPassword(), !customer.isDeactivated(), true, !customer.isPasswordChangeRequired(), true, grantedAuthorities);"
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,boolean roleUserFound = false;
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,grantedAuthorities.add(new SimpleGrantedAuthority(role.getRoleName()));
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,"if (role.getRoleName().equals(""ROLE_USER"")) {"
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,roleUserFound = true;
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,}
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,if (!roleUserFound) {
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,"grantedAuthorities.add(new SimpleGrantedAuthority(""ROLE_USER""));"
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,* Copyright 2008-2013 the original author or authors.
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,*
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,*        http://www.apache.org/licenses/LICENSE-2.0
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,import org.springframework.security.core.authority.GrantedAuthorityImpl;
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,import org.springframework.security.core.userdetails.User;
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,import javax.annotation.Resource;
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,@Deprecated
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,"@Resource(name=""blCustomerService"")"
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,"@Resource(name=""blRoleService"")"
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,protected boolean forcePasswordChange = false;
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,public void setForcePasswordChange(boolean forcePasswordChange) {
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,this.forcePasswordChange = forcePasswordChange;
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,}
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,org.broadleafcommerce.profile.core.domain.Customer customer = customerService.readCustomerByUsername(username);
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,User returnUser = null;
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,boolean pwChangeRequired = customer.isPasswordChangeRequired();
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,if (pwChangeRequired) {
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,if (forcePasswordChange) {
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,"returnUser = new User(username, customer.getPassword(), true, true, !customer.isPasswordChangeRequired(), true, grantedAuthorities);"
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,} else {
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,"grantedAuthorities.add(new GrantedAuthorityImpl(""ROLE_PASSWORD_CHANGE_REQUIRED""));"
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,"returnUser = new User(username, customer.getPassword(), true, true, true, true, grantedAuthorities);"
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,return returnUser;
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,public void setCustomerService(CustomerService customerService) {
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,this.customerService = customerService;
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,"grantedAuthorities.add(new GrantedAuthorityImpl(""ROLE_USER""));"
0006af0a508d85e5272619e42d84de6cd274ba65,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,grantedAuthorities.add(new GrantedAuthorityImpl(role.getRoleName()));
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,/**
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,* Validates the form DTO against the passed in map of propertyErrors
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,*
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"* @see #validate(EntityForm, Entity, Errors)"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,* @param form
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,* @param propertyErrors
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,* @param errors
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,* @return
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,*/
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"public boolean validate(EntityForm form, Map<String, List<String>> propertyErrors, Errors errors) {"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (propertyErrors == null || propertyErrors.isEmpty()) {
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,return true;
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,}
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"for (Map.Entry<String, List<String>> pe : propertyErrors.entrySet()) {"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,for (String errorMessage : pe.getValue()) {
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,String unserializedFieldName = pe.getKey();
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,String serializedFieldName = JSCompatibilityHelper.encode(unserializedFieldName);
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"* Rather than just use errors.rejectValue directly, we need to instantiate the FieldError object ourself"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,* and add it to the binding result. This is so that we can resolve the actual rejected value ourselves
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"* rather than rely on Spring to do it for us. If we rely on Spring, Spring will attempt to resolve something"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"* like fields['defaultSku__name'] immediately (at the time of invoking errors.rejectValue). At that point,"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"* the field names within the EntityForm are still in their unserialized state, and thus Spring would only"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,* find fields['defaultSku.name'] and there would be an empty string for the rejected value. Then on the
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"* frontend, Thymeleaf's th:field processor relies on Spring's BindingResult to provide the value that"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,* was actually rejected so you can get blank form fields.
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"* With this implementation, we avoid all of those additional problems because we are referencing the"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,* field that is being rejected along with providing our own method for getting the rejected value
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,Field field = null;
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"if (StringUtils.contains(unserializedFieldName, DynamicEntityFormInfo.FIELD_SEPARATOR)) {"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"String[] fieldInfo = unserializedFieldName.split(""\\"" + DynamicEntityFormInfo.FIELD_SEPARATOR);"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,field = form.getDynamicForm(fieldInfo[0]).getFields().get(fieldInfo[1]);
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,} else if (form.getFields().get(unserializedFieldName) != null) {
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,field = form.getFields().get(unserializedFieldName);
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"//If the submitted field was a radio button but has validation associated with it, that radio field"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,//will have never been submitted in the POST and thus will not have ever been attached to the EntityForm.
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,//We still want to notate the fact that there was a validation failure on that field
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,String value = (field != null) ? field.getValue() : null;
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"String[] errorCodes = ((AbstractBindingResult) errors).resolveMessageCodes(errorMessage, serializedFieldName);"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"FieldError fieldError = new FieldError(""entityForm"", String.format(""fields[%s].value"", serializedFieldName),"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"value, false, errorCodes, null, errorMessage);"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,((AbstractBindingResult) errors).addError(fieldError);
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,return false;
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"return validate(form, entity.getValidationErrors(), errors);"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,boolean result = true;
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,result = false;
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"for (Map.Entry<String, List<String>> propertyErrors : entity.getValidationErrors().entrySet()) {"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,for (String errorMessage : propertyErrors.getValue()) {
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,String unserializedFieldName = propertyErrors.getKey();
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,String serializedFieldName = JSCompatibilityHelper.encode(unserializedFieldName);
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,/**
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"* Rather than just use errors.rejectValue directly, we need to instantiate the FieldError object ourself"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,* and add it to the binding result. This is so that we can resolve the actual rejected value ourselves
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"* rather than rely on Spring to do it for us. If we rely on Spring, Spring will attempt to resolve something"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"* like fields['defaultSku__name'] immediately (at the time of invoking errors.rejectValue). At that point,"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"* the field names within the EntityForm are still in their unserialized state, and thus Spring would only"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,* find fields['defaultSku.name'] and there would be an empty string for the rejected value. Then on the
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"* frontend, Thymeleaf's th:field processor relies on Spring's BindingResult to provide the value that"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,* was actually rejected so you can get blank form fields.
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,*
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"* With this implementation, we avoid all of those additional problems because we are referencing the"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,* field that is being rejected along with providing our own method for getting the rejected value
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,*/
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,Field field = null;
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"if (StringUtils.contains(unserializedFieldName, DynamicEntityFormInfo.FIELD_SEPARATOR)) {"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"String[] fieldInfo = unserializedFieldName.split(""\\"" + DynamicEntityFormInfo.FIELD_SEPARATOR);"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,field = form.getDynamicForm(fieldInfo[0]).getFields().get(fieldInfo[1]);
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,} else if (form.getFields().get(unserializedFieldName) != null) {
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,field = form.getFields().get(unserializedFieldName);
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,}
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"//If the submitted field was a radio button but has validation associated with it, that radio field"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,//will have never been submitted in the POST and thus will not have ever been attached to the EntityForm.
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,//We still want to notate the fact that there was a validation failure on that field
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,String value = (field != null) ? field.getValue() : null;
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"String[] errorCodes = ((AbstractBindingResult) errors).resolveMessageCodes(errorMessage, serializedFieldName);"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,FieldError fieldError = new FieldError(
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"""entityForm"", String.format(""fields[%s].value"", serializedFieldName),"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"value, false,"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"errorCodes, null, errorMessage);"
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,((AbstractBindingResult) errors).addError(fieldError);
9c359e175a80609d8947837ee882a9905707a86c,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,return result;
16da79612b347004ec7ffaef034ba3c42d5d986e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.apache.commons.logging.Log;
16da79612b347004ec7ffaef034ba3c42d5d986e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.apache.commons.logging.LogFactory;
16da79612b347004ec7ffaef034ba3c42d5d986e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.common.RequestDTOImpl;
16da79612b347004ec7ffaef034ba3c42d5d986e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.common.exception.SiteNotFoundException;
16da79612b347004ec7ffaef034ba3c42d5d986e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.common.web.exception.HaltFilterChainException;
16da79612b347004ec7ffaef034ba3c42d5d986e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.springframework.stereotype.Component;
16da79612b347004ec7ffaef034ba3c42d5d986e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.springframework.web.context.request.ServletWebRequest;
16da79612b347004ec7ffaef034ba3c42d5d986e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.springframework.web.filter.OncePerRequestFilter;
16da79612b347004ec7ffaef034ba3c42d5d986e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,} catch (HaltFilterChainException e) {
16da79612b347004ec7ffaef034ba3c42d5d986e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,return;
16da79612b347004ec7ffaef034ba3c42d5d986e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import org.apache.commons.logging.Log;
16da79612b347004ec7ffaef034ba3c42d5d986e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import org.apache.commons.logging.LogFactory;
16da79612b347004ec7ffaef034ba3c42d5d986e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import org.broadleafcommerce.common.RequestDTOImpl;
16da79612b347004ec7ffaef034ba3c42d5d986e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import org.broadleafcommerce.common.exception.SiteNotFoundException;
16da79612b347004ec7ffaef034ba3c42d5d986e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import org.springframework.stereotype.Component;
16da79612b347004ec7ffaef034ba3c42d5d986e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import org.springframework.web.context.request.ServletWebRequest;
16da79612b347004ec7ffaef034ba3c42d5d986e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import org.springframework.web.filter.OncePerRequestFilter;
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"public static final String OVERRIDE_CUSTOMER_SESSION_ATTR_NAME = ""_blc_overrideCustomerId"";"
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"Long overrideId = (Long) request.getAttribute(OVERRIDE_CUSTOMER_SESSION_ATTR_NAME, WebRequest.SCOPE_GLOBAL_SESSION);"
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (overrideId != null) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,customer = customerService.readCustomerById(overrideId);
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,} else {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,Authentication authentication = SecurityContextHolder.getContext().getAuthentication();
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if ((authentication != null) && !(authentication instanceof AnonymousAuthenticationToken)) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,String userName = authentication.getName();
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,customer = (Customer) BroadleafRequestCustomerResolverImpl.getRequestCustomerResolver().getCustomer(request);
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (userName != null && (customer == null || !userName.equals(customer.getUsername()))) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,// can only get here if the authenticated user does not match the user in session
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,customer = customerService.readCustomerByUsername(userName);
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (logger.isDebugEnabled() && customer != null) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"logger.debug(""Customer found by username "" + userName);"
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,}
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (customer != null) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"ApplicationEvent lastPublishedEvent = (ApplicationEvent) request.getAttribute(LAST_PUBLISHED_EVENT_SESSION_ATTRIBUTED_NAME, WebRequest.SCOPE_REQUEST);"
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (authentication instanceof RememberMeAuthenticationToken) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,// set transient property of customer
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,customer.setCookied(true);
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,boolean publishRememberMeEvent = true;
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (lastPublishedEvent != null && lastPublishedEvent instanceof CustomerAuthenticatedFromCookieEvent) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,CustomerAuthenticatedFromCookieEvent cookieEvent = (CustomerAuthenticatedFromCookieEvent) lastPublishedEvent;
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (userName.equals(cookieEvent.getCustomer().getUsername())) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,publishRememberMeEvent = false;
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (publishRememberMeEvent) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"CustomerAuthenticatedFromCookieEvent cookieEvent = new CustomerAuthenticatedFromCookieEvent(customer, this.getClass().getName());"
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,eventPublisher.publishEvent(cookieEvent);
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"request.setAttribute(LAST_PUBLISHED_EVENT_SESSION_ATTRIBUTED_NAME, cookieEvent, WebRequest.SCOPE_REQUEST);"
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,} else if (authentication instanceof UsernamePasswordAuthenticationToken) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,customer.setLoggedIn(true);
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,boolean publishLoggedInEvent = true;
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (lastPublishedEvent != null && lastPublishedEvent instanceof CustomerLoggedInEvent) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,CustomerLoggedInEvent loggedInEvent = (CustomerLoggedInEvent) lastPublishedEvent;
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (userName.equals(loggedInEvent.getCustomer().getUsername())) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,publishLoggedInEvent= false;
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (publishLoggedInEvent) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"CustomerLoggedInEvent loggedInEvent = new CustomerLoggedInEvent(customer, this.getClass().getName());"
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,eventPublisher.publishEvent(loggedInEvent);
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"request.setAttribute(LAST_PUBLISHED_EVENT_SESSION_ATTRIBUTED_NAME, loggedInEvent, WebRequest.SCOPE_REQUEST);"
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,customer = resolveAuthenticatedCustomer(authentication);
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,Authentication authentication = SecurityContextHolder.getContext().getAuthentication();
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if ((authentication != null) && !(authentication instanceof AnonymousAuthenticationToken)) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,String userName = authentication.getName();
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,customer = (Customer) BroadleafRequestCustomerResolverImpl.getRequestCustomerResolver().getCustomer(request);
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (userName != null && (customer == null || !userName.equals(customer.getUsername()))) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,// can only get here if the authenticated user does not match the user in session
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,customer = customerService.readCustomerByUsername(userName);
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (logger.isDebugEnabled() && customer != null) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"logger.debug(""Customer found by username "" + userName);"
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,}
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (customer != null) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"ApplicationEvent lastPublishedEvent = (ApplicationEvent) request.getAttribute(LAST_PUBLISHED_EVENT_SESSION_ATTRIBUTED_NAME, WebRequest.SCOPE_REQUEST);"
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (authentication instanceof RememberMeAuthenticationToken) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,// set transient property of customer
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,customer.setCookied(true);
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,boolean publishRememberMeEvent = true;
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (lastPublishedEvent != null && lastPublishedEvent instanceof CustomerAuthenticatedFromCookieEvent) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,CustomerAuthenticatedFromCookieEvent cookieEvent = (CustomerAuthenticatedFromCookieEvent) lastPublishedEvent;
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (userName.equals(cookieEvent.getCustomer().getUsername())) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,publishRememberMeEvent = false;
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (publishRememberMeEvent) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"CustomerAuthenticatedFromCookieEvent cookieEvent = new CustomerAuthenticatedFromCookieEvent(customer, this.getClass().getName());"
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,eventPublisher.publishEvent(cookieEvent);
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"request.setAttribute(LAST_PUBLISHED_EVENT_SESSION_ATTRIBUTED_NAME, cookieEvent, WebRequest.SCOPE_REQUEST);"
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,} else if (authentication instanceof UsernamePasswordAuthenticationToken) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,customer.setLoggedIn(true);
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,boolean publishLoggedInEvent = true;
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (lastPublishedEvent != null && lastPublishedEvent instanceof CustomerLoggedInEvent) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,CustomerLoggedInEvent loggedInEvent = (CustomerLoggedInEvent) lastPublishedEvent;
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (userName.equals(loggedInEvent.getCustomer().getUsername())) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,publishLoggedInEvent= false;
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (publishLoggedInEvent) {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"CustomerLoggedInEvent loggedInEvent = new CustomerLoggedInEvent(customer, this.getClass().getName());"
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,eventPublisher.publishEvent(loggedInEvent);
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"request.setAttribute(LAST_PUBLISHED_EVENT_SESSION_ATTRIBUTED_NAME, loggedInEvent, WebRequest.SCOPE_REQUEST);"
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,} else {
6b62298b7b67abab5bf8cd9d823321fc6469848c,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,customer = resolveAuthenticatedCustomer(authentication);
a85039f2a4afa1a11945ad31f709b0cbec7004b7,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,if (!order.getShippingOverride()) {
a85039f2a4afa1a11945ad31f709b0cbec7004b7,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"Money totalFulfillmentCharges = BroadleafCurrencyUtils.getMoney(BigDecimal.ZERO, order.getCurrency());"
a85039f2a4afa1a11945ad31f709b0cbec7004b7,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,for (FulfillmentGroup fulfillmentGroup : order.getFulfillmentGroups()) {
a85039f2a4afa1a11945ad31f709b0cbec7004b7,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,if (fulfillmentGroup != null) {
a85039f2a4afa1a11945ad31f709b0cbec7004b7,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,fulfillmentGroup = fulfillmentPricingService.calculateCostForFulfillmentGroup(fulfillmentGroup);
a85039f2a4afa1a11945ad31f709b0cbec7004b7,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,if (fulfillmentGroup.getFulfillmentPrice() != null) {
a85039f2a4afa1a11945ad31f709b0cbec7004b7,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,totalFulfillmentCharges = totalFulfillmentCharges.add(fulfillmentGroup.getFulfillmentPrice());
a85039f2a4afa1a11945ad31f709b0cbec7004b7,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,}
a85039f2a4afa1a11945ad31f709b0cbec7004b7,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,order.setTotalFulfillmentCharges(totalFulfillmentCharges);
a85039f2a4afa1a11945ad31f709b0cbec7004b7,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,context.setSeedData(order);
a85039f2a4afa1a11945ad31f709b0cbec7004b7,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"Money totalFulfillmentCharges = BroadleafCurrencyUtils.getMoney(BigDecimal.ZERO, order.getCurrency());"
a85039f2a4afa1a11945ad31f709b0cbec7004b7,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,for (FulfillmentGroup fulfillmentGroup : order.getFulfillmentGroups()) {
a85039f2a4afa1a11945ad31f709b0cbec7004b7,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,if (fulfillmentGroup != null) {
a85039f2a4afa1a11945ad31f709b0cbec7004b7,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,fulfillmentGroup = fulfillmentPricingService.calculateCostForFulfillmentGroup(fulfillmentGroup);
a85039f2a4afa1a11945ad31f709b0cbec7004b7,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,if (fulfillmentGroup.getFulfillmentPrice() != null) {
a85039f2a4afa1a11945ad31f709b0cbec7004b7,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,totalFulfillmentCharges = totalFulfillmentCharges.add(fulfillmentGroup.getFulfillmentPrice());
a85039f2a4afa1a11945ad31f709b0cbec7004b7,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,order.setTotalFulfillmentCharges(totalFulfillmentCharges);
a85039f2a4afa1a11945ad31f709b0cbec7004b7,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,context.setSeedData(order);
78c606965ff3dcec35ce98c78f2694eb8e6cce47,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"Money totalFulfillmentCharges = BroadleafCurrencyUtils.getMoney(BigDecimal.ZERO, order.getCurrency());"
78c606965ff3dcec35ce98c78f2694eb8e6cce47,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,for (FulfillmentGroup fulfillmentGroup : order.getFulfillmentGroups()) {
78c606965ff3dcec35ce98c78f2694eb8e6cce47,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,if (fulfillmentGroup != null) {
78c606965ff3dcec35ce98c78f2694eb8e6cce47,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,if (!fulfillmentGroup.getShippingOverride()) {
78c606965ff3dcec35ce98c78f2694eb8e6cce47,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,}
78c606965ff3dcec35ce98c78f2694eb8e6cce47,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,if (fulfillmentGroup.getFulfillmentPrice() != null) {
78c606965ff3dcec35ce98c78f2694eb8e6cce47,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,totalFulfillmentCharges = totalFulfillmentCharges.add(fulfillmentGroup.getFulfillmentPrice());
78c606965ff3dcec35ce98c78f2694eb8e6cce47,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,order.setTotalFulfillmentCharges(totalFulfillmentCharges);
78c606965ff3dcec35ce98c78f2694eb8e6cce47,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,context.setSeedData(order);
78c606965ff3dcec35ce98c78f2694eb8e6cce47,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,if (!order.getShippingOverride()) {
78c606965ff3dcec35ce98c78f2694eb8e6cce47,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"Money totalFulfillmentCharges = BroadleafCurrencyUtils.getMoney(BigDecimal.ZERO, order.getCurrency());"
78c606965ff3dcec35ce98c78f2694eb8e6cce47,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,for (FulfillmentGroup fulfillmentGroup : order.getFulfillmentGroups()) {
78c606965ff3dcec35ce98c78f2694eb8e6cce47,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,if (fulfillmentGroup != null) {
78c606965ff3dcec35ce98c78f2694eb8e6cce47,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,if (fulfillmentGroup.getFulfillmentPrice() != null) {
78c606965ff3dcec35ce98c78f2694eb8e6cce47,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,totalFulfillmentCharges = totalFulfillmentCharges.add(fulfillmentGroup.getFulfillmentPrice());
78c606965ff3dcec35ce98c78f2694eb8e6cce47,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,}
78c606965ff3dcec35ce98c78f2694eb8e6cce47,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,order.setTotalFulfillmentCharges(totalFulfillmentCharges);
78c606965ff3dcec35ce98c78f2694eb8e6cce47,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,context.setSeedData(order);
1e81fd49204740f48cd6fa2e97b948a2c61ea599,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,fg1.setType(FulfillmentType.PHYSICAL_SHIP);
1e81fd49204740f48cd6fa2e97b948a2c61ea599,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,fg2.setType(FulfillmentType.PHYSICAL_SHIP);
1e81fd49204740f48cd6fa2e97b948a2c61ea599,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,fg1.setType(FulfillmentType.SHIPPING);
1e81fd49204740f48cd6fa2e97b948a2c61ea599,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,fg2.setType(FulfillmentType.SHIPPING);
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"//If there is no Customer object in session, AND no customer id in session, create a new customer"
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,//and store the entire customer in session (don't persist to DB just yet)
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,customer = customerService.createNewCustomer();
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"request.setAttribute(getAnonymousCustomerSessionAttributeName(), customer, WebRequest.SCOPE_GLOBAL_SESSION);"
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* Returns the anonymous customer that was saved in session. This first checks for a full customer in session (meaning
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* that the customer has not already been persisted) and returns that. If there is no full customer in session (and
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* there is instead just an anonymous customer ID) then this will look up the customer from the database using that and
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* return it.
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* @param request the current request
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* @return the anonymous customer in session or null if there is no anonymous customer represented in session
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* @see {@link #getAnonymousCustomerSessionAttributeName()}
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* @see {@link #getAnonymousCustomerIdSessionAttributeName()}
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,public Customer getAnonymousCustomer(WebRequest request) {
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"Customer anonymousCustomer = (Customer) request.getAttribute(getAnonymousCustomerSessionAttributeName(),"
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,WebRequest.SCOPE_GLOBAL_SESSION);
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (anonymousCustomer == null) {
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"//Customer is not in session, see if we have just a customer ID in session (the anonymous customer might have"
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,//already been persisted)
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"Long customerId = (Long) request.getAttribute(getAnonymousCustomerIdSessionAttributeName(), WebRequest.SCOPE_GLOBAL_SESSION);"
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (customerId != null) {
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"//we have a customer ID in session, look up the customer from the database to ensure we have an up-to-date"
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,//customer to store in CustomerState
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,anonymousCustomer = customerService.readCustomerById(customerId);
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,}
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,return anonymousCustomer;
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* <p>Returns the session attribute to store the anonymous customer ID. This session attribute should be used to track
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* date in regards to Hibernate (specifically with lists).</p>
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"* <p>So, once Broadleaf detects that the session-based {@link Customer} has been persisted, it should remove the session-based"
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* {@link Customer} and then utilize just the customer ID from session.</p>
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"//Customer is not in session, see if we have just a customer ID in session (the anonymous customer might have"
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,//already been persisted)
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"Long customerId = (Long) request.getAttribute(getAnonymousCustomerIdSessionAttributeName(), WebRequest.SCOPE_GLOBAL_SESSION);"
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (customerId != null) {
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"//we have a customer ID in session, look up the customer from the database to ensure we have an up-to-date"
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,//customer to store in CustomerState
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,customer = customerService.readCustomerById(customerId);
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,}
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"//If there is no Customer object in session, AND no customer id in session, create a new customer"
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,//and store the entire customer in session (don't persist to DB just yet)
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (customer == null) {
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,customer = customerService.createNewCustomer();
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"request.setAttribute(getAnonymousCustomerSessionAttributeName(), customer, WebRequest.SCOPE_GLOBAL_SESSION);"
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,* Returns the anonymous customer that was saved in session or null if none exists.
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,* @param request - the current request
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,* @return the anonymous customer that has not been persisted in the database but is available as a session object
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,public static Customer getAnonymousCustomer(WebRequest request) {
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"return (Customer) request.getAttribute(getAnonymousCustomerSessionAttributeName(), WebRequest.SCOPE_GLOBAL_SESSION);"
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,* Returns the session attribute to store the anonymous customer ID. This session attribute should be used to track
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,* date in regards to Hibernate (specifically with lists).
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"* So, once Broadleaf detects that the session-based {@link Customer} has been persisted, it should remove the session-based"
f2e2ca5db03d4386f59c5fd129fe65acae3d90dd,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,* {@link Customer} and then utilize just the customer ID from session.
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.apache.commons.collections.CollectionUtils;
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"protected PromotableOrderItemPriceDetail split(int discountQty, Long offerId, boolean hasQualifiers) {"
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (hasQualifiers) {
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,Iterator<PromotionQualifier> qualifiers = promotionQualifiers.iterator();
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,while (qualifiers.hasNext()) {
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,PromotionQualifier currentQualifier = qualifiers.next();
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,Long qualifierOfferId = currentQualifier.getPromotion().getId();
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (qualifierOfferId.equals(offerId) && currentQualifier.getQuantity() <= splitItemQty) {
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,// Remove this one from the original detail
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,qualifiers.remove();
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,newDetail.getPromotionQualifiers().add(currentQualifier);
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,} else {
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,PromotionQualifier newQualifier = currentQualifier.split(splitItemQty);
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,newDetail.getPromotionQualifiers().add(newQualifier);
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"return this.split(discount.getQuantity(), offerId, !CollectionUtils.isEmpty(discount.getCandidateItemOffer().getOffer().getQualifyingItemCriteria()));"
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"protected PromotableOrderItemPriceDetail split(int discountQty, Long offerId) {"
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Iterator<PromotionQualifier> qualifiers = promotionQualifiers.iterator();
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,while (qualifiers.hasNext()) {
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,PromotionQualifier currentQualifier = qualifiers.next();
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Long qualifierOfferId = currentQualifier.getPromotion().getId();
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (qualifierOfferId.equals(offerId) && currentQualifier.getQuantity() <= splitItemQty) {
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// Remove this one from the original detail
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,qualifiers.remove();
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,newDetail.getPromotionQualifiers().add(currentQualifier);
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,} else {
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,PromotionQualifier newQualifier = currentQualifier.split(splitItemQty);
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,newDetail.getPromotionQualifiers().add(newQualifier);
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,}
307ce1f953eb0603ada67f312472f1d0e53ac6b2,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"return this.split(discount.getQuantity(), offerId);"
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.apache.commons.collections.CollectionUtils;
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"protected PromotableOrderItemPriceDetail split(int discountQty, Long offerId, boolean hasQualifiers) {"
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (hasQualifiers) {
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,Iterator<PromotionQualifier> qualifiers = promotionQualifiers.iterator();
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,while (qualifiers.hasNext()) {
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,PromotionQualifier currentQualifier = qualifiers.next();
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,Long qualifierOfferId = currentQualifier.getPromotion().getId();
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (qualifierOfferId.equals(offerId) && currentQualifier.getQuantity() <= splitItemQty) {
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,// Remove this one from the original detail
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,qualifiers.remove();
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,newDetail.getPromotionQualifiers().add(currentQualifier);
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,} else {
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,PromotionQualifier newQualifier = currentQualifier.split(splitItemQty);
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,newDetail.getPromotionQualifiers().add(newQualifier);
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"return this.split(discount.getQuantity(), offerId, !CollectionUtils.isEmpty(discount.getCandidateItemOffer().getOffer().getQualifyingItemCriteria()));"
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"protected PromotableOrderItemPriceDetail split(int discountQty, Long offerId) {"
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Iterator<PromotionQualifier> qualifiers = promotionQualifiers.iterator();
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,while (qualifiers.hasNext()) {
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,PromotionQualifier currentQualifier = qualifiers.next();
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Long qualifierOfferId = currentQualifier.getPromotion().getId();
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (qualifierOfferId.equals(offerId) && currentQualifier.getQuantity() <= splitItemQty) {
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// Remove this one from the original detail
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,qualifiers.remove();
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,newDetail.getPromotionQualifiers().add(currentQualifier);
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,} else {
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,PromotionQualifier newQualifier = currentQualifier.split(splitItemQty);
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,newDetail.getPromotionQualifiers().add(newQualifier);
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,}
a181e0954b9abe93377d83571dcb8f55ea708c12,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"return this.split(discount.getQuantity(), offerId);"
c0de2e6325496392935cf5992d385d4fbdb6f0eb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (OfferDiscountType.FIX_PRICE.equals(offer.getDiscountType())) {
c0de2e6325496392935cf5992d385d4fbdb6f0eb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"// Choosing an arbitrary large value.    The retail / sale price will be less than this,"
c0de2e6325496392935cf5992d385d4fbdb6f0eb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,// so the offer will not get selected.
c0de2e6325496392935cf5992d385d4fbdb6f0eb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return BigDecimal.valueOf(Integer.MAX_VALUE);
c0de2e6325496392935cf5992d385d4fbdb6f0eb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,} else {
c0de2e6325496392935cf5992d385d4fbdb6f0eb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return BigDecimal.ZERO;
c0de2e6325496392935cf5992d385d4fbdb6f0eb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
c0de2e6325496392935cf5992d385d4fbdb6f0eb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return BigDecimal.ZERO;
c957ffc12223adca029813c5ac86113aa5b8f812,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,request.setCustomCriteria(fmd.getCustomCriteria());
c957ffc12223adca029813c5ac86113aa5b8f812,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,this.additionalForeignKeys.addAll(Arrays.asList(additionalForeignKeys));
c957ffc12223adca029813c5ac86113aa5b8f812,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,this.customCriteria.addAll(Arrays.asList(customCriteria));
c957ffc12223adca029813c5ac86113aa5b8f812,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,this.additionalForeignKeys = Arrays.asList(additionalForeignKeys);
c957ffc12223adca029813c5ac86113aa5b8f812,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,this.customCriteria = Arrays.asList(customCriteria);
20b9326f672cf1b59e9ce22bb4f920a5ced97fca,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,request.setCustomCriteria(fmd.getCustomCriteria());
20b9326f672cf1b59e9ce22bb4f920a5ced97fca,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,this.additionalForeignKeys.addAll(Arrays.asList(additionalForeignKeys));
20b9326f672cf1b59e9ce22bb4f920a5ced97fca,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,this.customCriteria.addAll(Arrays.asList(customCriteria));
20b9326f672cf1b59e9ce22bb4f920a5ced97fca,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,this.additionalForeignKeys = Arrays.asList(additionalForeignKeys);
20b9326f672cf1b59e9ce22bb4f920a5ced97fca,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,this.customCriteria = Arrays.asList(customCriteria);
ba097eaf86c33f75bd554d97d7ca493610c2f2bc,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,"List<Long> productIds = BLCCollectionUtils.collectList(skus, new TypedTransformer<Long>() {"
ba097eaf86c33f75bd554d97d7ca493610c2f2bc,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,return ((Sku) input).getProduct().getId();
ba097eaf86c33f75bd554d97d7ca493610c2f2bc,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,"solrIndexDao.populateProductCatalogStructure(productIds, SolrIndexCachedOperation.getCache());"
ba097eaf86c33f75bd554d97d7ca493610c2f2bc,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,"solrIndexDao.populateProductCatalogStructure(Arrays.asList(product.getId()), SolrIndexCachedOperation.getCache());"
ba097eaf86c33f75bd554d97d7ca493610c2f2bc,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,int page = 0;
ba097eaf86c33f75bd554d97d7ca493610c2f2bc,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,while ((page * pageSize) < numItemsToIndex) {
ba097eaf86c33f75bd554d97d7ca493610c2f2bc,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,"buildIncrementalIndex(page, pageSize);"
ba097eaf86c33f75bd554d97d7ca493610c2f2bc,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,page++;
ba097eaf86c33f75bd554d97d7ca493610c2f2bc,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,}
ba097eaf86c33f75bd554d97d7ca493610c2f2bc,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,"List<Long> skuIds = BLCCollectionUtils.collectList(skus, new TypedTransformer<Long>() {"
ba097eaf86c33f75bd554d97d7ca493610c2f2bc,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,return ((Sku) input).getId();
ba097eaf86c33f75bd554d97d7ca493610c2f2bc,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,"solrIndexDao.populateProductCatalogStructure(skuIds, SolrIndexCachedOperation.getCache());"
ba097eaf86c33f75bd554d97d7ca493610c2f2bc,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,"solrIndexDao.populateProductCatalogStructure(Arrays.asList(sku.getId()), SolrIndexCachedOperation.getCache());"
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationCollection;
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationOperationTypes;
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.client.AddMethodType;
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.client.OperationType;
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.client.SupportedFieldType;
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""AdminPermissionImpl_Name"", order = 3000, group = ""AdminPermissionImpl_Permission"")"
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""AdminPermissionImpl_Permission_Type"", order = 3000,"
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"group = ""AdminPermissionImpl_Permission"","
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"prominent = true, gridOrder = 2000,"
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"fieldType = SupportedFieldType.BROADLEAF_ENUMERATION,"
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"broadleafEnumeration = ""org.broadleafcommerce.openadmin.server.security.service.type.PermissionType"")"
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""AdminPermissionImpl_Description"", order = 1000, group = ""AdminPermissionImpl_Permission"","
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"prominent = true, gridOrder = 2000)"
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@AdminPresentation(excluded = true)
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationCollection(addType = AddMethodType.LOOKUP, friendlyName = ""entityPermissionsTitle"","
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,order = 2000)
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationCollection(addType = AddMethodType.LOOKUP, friendlyName = ""childPermissionsTitle"","
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"order = 1000,"
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"manyToField = ""allParentPermissions"","
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,operationTypes = @AdminPresentationOperationTypes(removeType = OperationType.NONDESTRUCTIVEREMOVE))
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@ManyToMany(fetch = FetchType.LAZY, targetEntity = AdminPermissionImpl.class)"
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@JoinTable(name = ""BLC_ADMIN_PERMISSION_XREF"", joinColumns = @JoinColumn(name = ""CHILD_PERMISSION_ID"", referencedColumnName = ""ADMIN_PERMISSION_ID""), inverseJoinColumns = @JoinColumn(name = ""ADMIN_PERMISSION_ID"", referencedColumnName = ""ADMIN_PERMISSION_ID""))"
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region = ""blStandardElements"")"
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@BatchSize(size = 50)
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected List<AdminPermission> allParentPermissions = new ArrayList<AdminPermission>();
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""AdminPermissionImpl_Is_Friendly"","
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"order = 4000, group = ""AdminPermissionImpl_Permission"")"
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@Override
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public List<AdminPermission> getAllParentPermissions() {
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return allParentPermissions;
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,}
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.hibernate.annotations.Index;
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""ADMINPERM_NAME_INDEX"", columnNames={""NAME""})"
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""ADMINPERM_TYPE_INDEX"", columnNames={""PERMISSION_TYPE""})"
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""AdminPermissionImpl_Description"", order=2, group = ""AdminPermissionImpl_Permission"", prominent=true)"
68a3e8c318041310fcf4f9d8cd5eab5df9bba1bb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@AdminPresentation(visibility = VisibilityEnum.HIDDEN_ALL)
3491cd11c7b1694cf48f747610ab3b9fbcc25c80,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,brc.getAdditionalProperties().putAll(entityExtensionManagers);
3491cd11c7b1694cf48f747610ab3b9fbcc25c80,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,Site site = siteResolver.resolveSite(request);
3491cd11c7b1694cf48f747610ab3b9fbcc25c80,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,Site site = siteResolver.resolveSite(request);
3491cd11c7b1694cf48f747610ab3b9fbcc25c80,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,brc.getAdditionalProperties().putAll(entityExtensionManagers);
0c21b421c1d9c38444c820eea84cad34979e3b37,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,if (!(obj instanceof OrderItemPriceDetailAdjustmentImpl)) {
0c21b421c1d9c38444c820eea84cad34979e3b37,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,if (getClass() != obj.getClass()) {
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.core.order.domain.Order;
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.core.order.service.OrderLockManager;
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.core.order.service.OrderService;
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.core.web.order.CartState;
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import java.io.IOException;
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,*
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* <p>
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"* This filter is also responsible for establishing a session-wide lock for operations that require a lock, indicated"
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"* by {@link #requestRequiresLock(ServletRequest)}. By default, this is configured for all POST requests. Requests that"
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* are marked as requiring a lock will execute strictly serially as defined by the configured {@link OrderLockManager}.
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* </p>
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* @author Andre Azzolini (apazzolini)
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"@Component(""blCartStateFilter"")"
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,protected static final Log LOG = LogFactory.getLog(CartStateFilter.class);
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"@Resource(name = ""blOrderLockManager"")"
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,protected OrderLockManager orderLockManager;
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"@Resource(name = ""blOrderService"")"
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,protected OrderService orderService;
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)"
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"throws IOException, ServletException {"
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"cartStateProcessor.process(new ServletWebRequest((HttpServletRequest) request, (HttpServletResponse) response));"
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (!requestRequiresLock(request)) {
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"chain.doFilter(request, response);"
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,return;
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,}
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,Order order = CartState.getCart();
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (LOG.isTraceEnabled()) {
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"LOG.trace(""Thread["" + Thread.currentThread().getId() + ""] attempting to lock order["" + order.getId() + ""]"");"
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,Object lockObject = orderLockManager.acquireLock(order);
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"LOG.trace(""Thread["" + Thread.currentThread().getId() + ""] grabbed lock for order["" + order.getId() + ""]"");"
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,try {
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"// When we have a hold of the lock for the order, we want to reload the order from the database."
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,// This is because a different thread could have modified the order in between the time we initially
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"// read it for this thread and now, resulting in the order being stale. Additionally, we want to make"
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,// sure we detach the order from the EntityManager and forcefully reload the order.
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,CartState.setCart(orderService.reloadOrder(order));
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,} finally {
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,orderLockManager.releaseLock(lockObject);
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"LOG.trace(""Thread["" + Thread.currentThread().getId() + ""] released lock for order["" + order.getId() +""]"");"
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,protected boolean requestRequiresLock(ServletRequest request) {
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (request instanceof HttpServletRequest) {
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"return ((HttpServletRequest) request).getMethod().equalsIgnoreCase(""post"");"
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,return false;
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import java.io.IOException;
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"@Component(""blCartStateFilter"")"
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,/** Logger for this class and subclasses */
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,protected final Log LOG = LogFactory.getLog(getClass());
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"@SuppressWarnings(""unchecked"")"
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {"
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"cartStateProcessor.process(new ServletWebRequest((HttpServletRequest) request, (HttpServletResponse)response));"
45d0986e93dd528abc97be1303c3c7bbe0655d9b,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"chain.doFilter(request, response);"
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.core.order.domain.Order;
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.core.order.service.OrderLockManager;
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.core.order.service.OrderService;
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.core.web.order.CartState;
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import java.io.IOException;
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,*
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* <p>
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"* This filter is also responsible for establishing a session-wide lock for operations that require a lock, indicated"
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"* by {@link #requestRequiresLock(ServletRequest)}. By default, this is configured for all POST requests. Requests that"
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* are marked as requiring a lock will execute strictly serially as defined by the configured {@link OrderLockManager}.
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* </p>
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* @author Andre Azzolini (apazzolini)
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"@Component(""blCartStateFilter"")"
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,protected static final Log LOG = LogFactory.getLog(CartStateFilter.class);
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"@Resource(name = ""blOrderLockManager"")"
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,protected OrderLockManager orderLockManager;
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"@Resource(name = ""blOrderService"")"
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,protected OrderService orderService;
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)"
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"throws IOException, ServletException {"
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"cartStateProcessor.process(new ServletWebRequest((HttpServletRequest) request, (HttpServletResponse) response));"
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (!requestRequiresLock(request)) {
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"chain.doFilter(request, response);"
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,return;
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,}
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,Order order = CartState.getCart();
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (LOG.isTraceEnabled()) {
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"LOG.trace(""Thread["" + Thread.currentThread().getId() + ""] attempting to lock order["" + order.getId() + ""]"");"
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,Object lockObject = orderLockManager.acquireLock(order);
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"LOG.trace(""Thread["" + Thread.currentThread().getId() + ""] grabbed lock for order["" + order.getId() + ""]"");"
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,try {
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"// When we have a hold of the lock for the order, we want to reload the order from the database."
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,// This is because a different thread could have modified the order in between the time we initially
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"// read it for this thread and now, resulting in the order being stale. Additionally, we want to make"
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,// sure we detach the order from the EntityManager and forcefully reload the order.
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,CartState.setCart(orderService.reloadOrder(order));
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,} finally {
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,orderLockManager.releaseLock(lockObject);
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"LOG.trace(""Thread["" + Thread.currentThread().getId() + ""] released lock for order["" + order.getId() +""]"");"
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,protected boolean requestRequiresLock(ServletRequest request) {
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (request instanceof HttpServletRequest) {
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"return ((HttpServletRequest) request).getMethod().equalsIgnoreCase(""post"");"
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,return false;
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import java.io.IOException;
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"@Component(""blCartStateFilter"")"
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,/** Logger for this class and subclasses */
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,protected final Log LOG = LogFactory.getLog(getClass());
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"@SuppressWarnings(""unchecked"")"
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {"
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"cartStateProcessor.process(new ServletWebRequest((HttpServletRequest) request, (HttpServletResponse)response));"
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"chain.doFilter(request, response);"
1b1902dbaae10669d12afea101dfc64b8d8b28bc,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,}
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,import org.apache.commons.collections.CollectionUtils;
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,import org.broadleafcommerce.core.offer.service.discount.ItemOfferQtyOneComparator;
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,boolean isNewFormat = CollectionUtils.isNotEmpty(offer.getQualifyingItemCriteria()) || CollectionUtils.isNotEmpty(offer.getTargetItemCriteria());
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,"Money savings = itemOffer.calculateSavingsForOrderItem(item, item.getQuantity());"
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,potentialSavings = potentialSavings.add(savings);
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,if (itemOffer.getUses() == 0) {
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,itemOffer.setPotentialSavingsQtyOne(potentialSavings);
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,} else {
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,itemOffer.setPotentialSavingsQtyOne(potentialSavings.divide(itemOffer.getUses()));
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,}
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,if (offers.size() > 1) {
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,List<PromotableCandidateItemOffer> qtyOneOffers = new ArrayList<PromotableCandidateItemOffer>(offers);
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,"Collections.sort(qtyOneOffers, ItemOfferQtyOneComparator.INSTANCE);"
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,// We only want to add this additional list when the qty of one list is not identical to the original one
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,for (int i = 0; i < qtyOneOffers.size(); i++) {
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,if (qtyOneOffers.get(i) != offers.get(i)) {
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,listOfOfferLists.add(qtyOneOffers);
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,break;
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,for (PromotableCandidateItemOffer offer : offerList) {
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,offer.resetUses();
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,for (PromotableCandidateItemOffer offer : bestOfferList) {
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,import org.springframework.util.CollectionUtils;
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,boolean isNewFormat = !CollectionUtils.isEmpty(offer.getQualifyingItemCriteria()) || !CollectionUtils.isEmpty(offer.getTargetItemCriteria());
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,potentialSavings = potentialSavings.add(
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,"itemOffer.calculateSavingsForOrderItem(item, item.getQuantity()));"
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,// This line is commented out because we are no longer creating legacy offers.
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,//assertTrue(qualifiedOffers.size() == 2 && qualifiedOffers.get(0).getOffer().equals(offers.get(0)) && qualifiedOffers.get(1).getOffer().equals(offers.get(0)));
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,count = count + (detail.getOrderItemPriceDetailAdjustments().size() * detail.getQuantity());
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,assertTrue(qualifiedOffers.size() == 2 && qualifiedOffers.get(0).getOffer().equals(offers.get(0)) && qualifiedOffers.get(1).getOffer().equals(offers.get(0)));
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,count = count + detail.getOrderItemPriceDetailAdjustments().size();
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,// This line is commented out because we are no longer creating legacy offers.
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,//assertTrue(qualifiedOffers.size() == 2 && qualifiedOffers.get(0).getOffer().equals(offers.get(0)) && qualifiedOffers.get(1).getOffer().equals(offers.get(0)));
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,count = count + (detail.getOrderItemPriceDetailAdjustments().size() * detail.getQuantity());
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,assertTrue(qualifiedOffers.size() == 2 && qualifiedOffers.get(0).getOffer().equals(offers.get(0)) && qualifiedOffers.get(1).getOffer().equals(offers.get(0)));
9870fe8a8bb7b59f794f5bf6486265088b58c6c8,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,count = count + detail.getOrderItemPriceDetailAdjustments().size();
0ef93d97e9be1eea9ed69c85f4ffb49728a71e6a,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,"offerService.applyAndSaveOffersToOrder(offers, order);"
0ef93d97e9be1eea9ed69c85f4ffb49728a71e6a,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,"offerService.applyOffersToOrder(offers, order);"
0ef93d97e9be1eea9ed69c85f4ffb49728a71e6a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"offerService.applyAndSaveOffersToOrder(offers, promotableOrder.getOrder());"
0ef93d97e9be1eea9ed69c85f4ffb49728a71e6a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"offerService.applyOffersToOrder(offers, promotableOrder.getOrder());"
0ef93d97e9be1eea9ed69c85f4ffb49728a71e6a,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"offerService.applyAndSaveOffersToOrder(offers, order);"
0ef93d97e9be1eea9ed69c85f4ffb49728a71e6a,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"offerService.applyAndSaveOffersToOrder(offerListWithOneOffer, order);"
0ef93d97e9be1eea9ed69c85f4ffb49728a71e6a,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"offerService.applyAndSaveOffersToOrder(offerListWithTwoOffers, order);"
0ef93d97e9be1eea9ed69c85f4ffb49728a71e6a,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"offerService.applyAndSaveOffersToOrder(offerList, order);"
0ef93d97e9be1eea9ed69c85f4ffb49728a71e6a,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"offerService.applyOffersToOrder(offers, order);"
0ef93d97e9be1eea9ed69c85f4ffb49728a71e6a,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"offerService.applyOffersToOrder(offerListWithOneOffer, order);"
0ef93d97e9be1eea9ed69c85f4ffb49728a71e6a,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"offerService.applyOffersToOrder(offerListWithTwoOffers, order);"
0ef93d97e9be1eea9ed69c85f4ffb49728a71e6a,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"offerService.applyOffersToOrder(offerList, order);"
0ef93d97e9be1eea9ed69c85f4ffb49728a71e6a,23b534a090d87626cfa98ef3e87005691e33eb13,added,0,import javax.annotation.Resource;
0ef93d97e9be1eea9ed69c85f4ffb49728a71e6a,23b534a090d87626cfa98ef3e87005691e33eb13,added,0,"offerService.applyAndSaveOffersToOrder(offers, order);"
0ef93d97e9be1eea9ed69c85f4ffb49728a71e6a,23b534a090d87626cfa98ef3e87005691e33eb13,added,0,"offerService.applyAndSaveFulfillmentGroupOffersToOrder(offers, order);"
0ef93d97e9be1eea9ed69c85f4ffb49728a71e6a,23b534a090d87626cfa98ef3e87005691e33eb13,deleted,1,import javax.annotation.Resource;
0ef93d97e9be1eea9ed69c85f4ffb49728a71e6a,23b534a090d87626cfa98ef3e87005691e33eb13,deleted,1,"offerService.applyOffersToOrder(offers, order);"
0ef93d97e9be1eea9ed69c85f4ffb49728a71e6a,23b534a090d87626cfa98ef3e87005691e33eb13,deleted,1,"offerService.applyFulfillmentGroupOffersToOrder(offers, order);"
252ddfc499bb01cbad282fd1dd94b94ae9dc9d47,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.common.util.BLCRequestUtils;
252ddfc499bb01cbad282fd1dd94b94ae9dc9d47,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,@Override
252ddfc499bb01cbad282fd1dd94b94ae9dc9d47,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (BLCRequestUtils.isOKtoUseSession(request)) {
252ddfc499bb01cbad282fd1dd94b94ae9dc9d47,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"request.setAttribute(mergeCartResponseKey, mergeCartResponse, WebRequest.SCOPE_GLOBAL_SESSION);"
252ddfc499bb01cbad282fd1dd94b94ae9dc9d47,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,}
252ddfc499bb01cbad282fd1dd94b94ae9dc9d47,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"request.setAttribute(mergeCartResponseKey, mergeCartResponse, WebRequest.SCOPE_GLOBAL_SESSION);"
7a893070ade0bc70e7dede658a6e8e84b3d5534d,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,if (fmd.getAddMethodType().equals(AddMethodType.LOOKUP) ||
7a893070ade0bc70e7dede658a6e8e84b3d5534d,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,fmd.getAddMethodType().equals(AddMethodType.LOOKUP_FOR_UPDATE)) {
7a893070ade0bc70e7dede658a6e8e84b3d5534d,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,if (fmd.getAddMethodType().equals(AddMethodType.LOOKUP_FOR_UPDATE)) {
7a893070ade0bc70e7dede658a6e8e84b3d5534d,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,ppr.setUpdateLookupType(true);
7a893070ade0bc70e7dede658a6e8e84b3d5534d,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,}
7a893070ade0bc70e7dede658a6e8e84b3d5534d,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,if (request.isUpdateLookupType()) {
7a893070ade0bc70e7dede658a6e8e84b3d5534d,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,if (pkg.getSectionCrumbs() != null && pkg.getSectionCrumbs().length > 0) {
7a893070ade0bc70e7dede658a6e8e84b3d5534d,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,SectionCrumb sc = pkg.getSectionCrumbs()[0];
7a893070ade0bc70e7dede658a6e8e84b3d5534d,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,if (StringUtils.isNotBlank(sc.getSectionIdentifier())) {
7a893070ade0bc70e7dede658a6e8e84b3d5534d,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,pkg.setSecurityCeilingEntityFullyQualifiedClassname(sc.getSectionIdentifier());
7a893070ade0bc70e7dede658a6e8e84b3d5534d,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,return service.update(pkg);
7a893070ade0bc70e7dede658a6e8e84b3d5534d,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,} else {
7a893070ade0bc70e7dede658a6e8e84b3d5534d,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,return service.add(pkg);
7a893070ade0bc70e7dede658a6e8e84b3d5534d,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,try {
7a893070ade0bc70e7dede658a6e8e84b3d5534d,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,return service.remove(pkg);
7a893070ade0bc70e7dede658a6e8e84b3d5534d,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,} catch (ValidationException e) {
7a893070ade0bc70e7dede658a6e8e84b3d5534d,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,return new PersistenceResponse().withEntity(e.getEntity());
7a893070ade0bc70e7dede658a6e8e84b3d5534d,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,if (fmd.getAddMethodType().equals(AddMethodType.LOOKUP)) {
7a893070ade0bc70e7dede658a6e8e84b3d5534d,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,return service.add(pkg);
7a893070ade0bc70e7dede658a6e8e84b3d5534d,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,return service.remove(pkg);
5faaef7988093a3baa5364e5bf1d1193e9085023,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,Money amountDiff = orderAdjustmentTotal.subtract(totalOrderAdjustmentDistributed);
5faaef7988093a3baa5364e5bf1d1193e9085023,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,return Math.round(Math.abs(numUnits));
5faaef7988093a3baa5364e5bf1d1193e9085023,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,Money amountDiff = totalOrderAdjustmentDistributed.subtract(orderAdjustmentTotal);
5faaef7988093a3baa5364e5bf1d1193e9085023,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return Math.round(numUnits);
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,import org.broadleafcommerce.openadmin.dto.CriteriaTransferObject;
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,/**
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,* Thin layer on top of {@link DynamicEntityService#add(org.broadleafcommerce.openadmin.dto.PersistencePackage)} that
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,* swallows all {@link ValidationException}s that could be thrown and still just returns a {@link PersistenceResponse}
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,* with the {@link Entity} that failed validation.
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,*
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,* @param request
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,* @return
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,* @throws ServiceException if there were exceptions other than a {@link ValidationException} that was thrown as a
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,* result of the attempted add
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,*/
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,public Entity add(PersistencePackageRequest request) throws ServiceException;
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,* Thin layer on top of {@link DynamicEntityService#update(org.broadleafcommerce.openadmin.dto.PersistencePackage)}
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,* result of the attempted update
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,public Entity update(PersistencePackageRequest request) throws ServiceException;
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,* Thin layer on top of {@link DynamicEntityService#inspect(org.broadleafcommerce.openadmin.dto.PersistencePackage)}
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,* @throws ServiceException
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,public DynamicResultSet inspect(PersistencePackageRequest request) throws ServiceException;
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,* Thin layer on top of {@link DynamicEntityService#remove(org.broadleafcommerce.openadmin.dto.PersistencePackage)}
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,public void remove(PersistencePackageRequest request) throws ServiceException;
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,"* Thin layer on top of {@link DynamicEntityService#fetch(org.broadleafcommerce.openadmin.dto.PersistencePackage, org.broadleafcommerce.openadmin.dto.CriteriaTransferObject)}."
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,* This will glean and create a {@link CriteriaTransferObject} from {@link PersistencePackageRequest#getFilterAndSortCriteria()}
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,* to pass to {@link DynamicEntityService}.
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,public DynamicResultSet fetch(PersistencePackageRequest request) throws ServiceException;
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,added,0,}
e018c3436940c1e521b5bc653b70fd2706787aa7,189b8c00bc2cf3811df372ce5898c3013769d716,deleted,1,}
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import java.util.ArrayList;
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import java.util.Arrays;
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import java.util.HashMap;
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import java.util.List;
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import java.util.ListIterator;
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import java.util.Map;
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import java.util.Map.Entry;
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import javax.annotation.Resource;
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import javax.persistence.EntityManager;
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import javax.persistence.NoResultException;
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import javax.persistence.PersistenceContext;
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,@Override
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,public Entity add(PersistencePackageRequest request)
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,public Entity update(PersistencePackageRequest request)
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,public DynamicResultSet inspect(PersistencePackageRequest request)
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,public void remove(PersistencePackageRequest request)
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,public DynamicResultSet fetch(PersistencePackageRequest request)
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import java.util.ArrayList;
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import java.util.Arrays;
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import java.util.HashMap;
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import java.util.List;
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import java.util.ListIterator;
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import java.util.Map;
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import java.util.Map.Entry;
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import javax.annotation.Resource;
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import javax.persistence.EntityManager;
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import javax.persistence.NoResultException;
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import javax.persistence.PersistenceContext;
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,protected Entity add(PersistencePackageRequest request)
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,protected Entity update(PersistencePackageRequest request)
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,protected DynamicResultSet inspect(PersistencePackageRequest request)
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,protected void remove(PersistencePackageRequest request)
e018c3436940c1e521b5bc653b70fd2706787aa7,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,protected DynamicResultSet fetch(PersistencePackageRequest request)
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import java.util.ArrayList;
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import java.util.Arrays;
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import java.util.HashMap;
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import java.util.List;
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import java.util.ListIterator;
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import java.util.Map;
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import java.util.Map.Entry;
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import javax.annotation.Resource;
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import javax.persistence.EntityManager;
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import javax.persistence.NoResultException;
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import javax.persistence.PersistenceContext;
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,@Override
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,public Entity add(PersistencePackageRequest request)
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,public Entity update(PersistencePackageRequest request)
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,public DynamicResultSet inspect(PersistencePackageRequest request)
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,public void remove(PersistencePackageRequest request)
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,public DynamicResultSet fetch(PersistencePackageRequest request)
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,import java.util.ArrayList;
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,import java.util.Arrays;
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,import java.util.HashMap;
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,import java.util.List;
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,import java.util.ListIterator;
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,import java.util.Map;
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,import java.util.Map.Entry;
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,import javax.annotation.Resource;
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,import javax.persistence.EntityManager;
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,import javax.persistence.NoResultException;
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,import javax.persistence.PersistenceContext;
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,protected Entity add(PersistencePackageRequest request)
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,protected Entity update(PersistencePackageRequest request)
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,protected DynamicResultSet inspect(PersistencePackageRequest request)
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,protected void remove(PersistencePackageRequest request)
e018c3436940c1e521b5bc653b70fd2706787aa7,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,protected DynamicResultSet fetch(PersistencePackageRequest request)
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,/*
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* #%L
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* BroadleafCommerce Common Libraries
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* %%
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* Copyright (C) 2009 - 2013 Broadleaf Commerce
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"* Licensed under the Apache License, Version 2.0 (the ""License"");"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* you may not use this file except in compliance with the License.
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* You may obtain a copy of the License at
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,*
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,*       http://www.apache.org/licenses/LICENSE-2.0
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"* Unless required by applicable law or agreed to in writing, software"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"* distributed under the License is distributed on an ""AS IS"" BASIS,"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* See the License for the specific language governing permissions and
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* limitations under the License.
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* #L%
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,*/
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,package org.broadleafcommerce.common.util.sql;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.apache.tools.ant.types.Environment;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.apache.tools.ant.types.PropertySet;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.hibernate.cfg.Configuration;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.hibernate.tool.hbm2x.Exporter;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import java.io.File;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import java.util.Properties;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,/**
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* This is a re-worked version from Hibernate tools
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* @author jfischer
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public abstract class ExporterTask {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,// refactor out so not dependent on Ant ?
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,protected HibernateToolTask parent;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,Properties properties;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,File destdir;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,Configuration configuration;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,String outputFileName = null;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public ExporterTask(HibernateToolTask parent) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,this.parent = parent;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,this.properties = new Properties();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,}
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,/*final*/ public void execute() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,Exporter exporter = configureExporter(createExporter() );
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,exporter.start();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,protected abstract Exporter createExporter();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public File getDestdir() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,return destdir;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public void setDestdir(File destdir) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,this.destdir = destdir;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public void addConfiguredPropertySet(PropertySet ps) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,properties.putAll(ps.getProperties());
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public void addConfiguredProperty(Environment.Variable property) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"properties.put(property.getKey(), property.getValue());"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public Configuration getConfiguration() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,return configuration;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public void setConfiguration(Configuration configuration) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,this.configuration = configuration;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* File out put name (default: empty)
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public void setOutputFileName(String fileName) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,outputFileName = fileName;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,abstract String getName();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,abstract Exporter configureExporter(Exporter exporter);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,/*
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* #%L
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* BroadleafCommerce Common Libraries
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* %%
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* Copyright (C) 2009 - 2013 Broadleaf Commerce
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"* Licensed under the Apache License, Version 2.0 (the ""License"");"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* you may not use this file except in compliance with the License.
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* You may obtain a copy of the License at
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,*
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,*       http://www.apache.org/licenses/LICENSE-2.0
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"* Unless required by applicable law or agreed to in writing, software"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"* distributed under the License is distributed on an ""AS IS"" BASIS,"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* See the License for the specific language governing permissions and
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* limitations under the License.
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* #L%
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,*/
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,package org.broadleafcommerce.common.util.sql;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.hibernate.tool.hbm2x.Exporter;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.hibernate.tool.hbm2x.Hbm2DDLExporter;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,/**
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* This is a re-worked version from Hibernate tools
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* @author jfischer
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public class Hbm2DDLExporterTask extends ExporterTask {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,boolean exportToDatabase = true;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,boolean scriptToConsole = true;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,boolean schemaUpdate = false;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"String delimiter = "";"";"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,boolean drop = false;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,boolean create = true;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,boolean format = false;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,private boolean haltOnError = false;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public Hbm2DDLExporterTask(HibernateToolTask parent) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,super(parent);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,}
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public String getName() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"return ""hbm2ddl (Generates database schema)"";"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,protected Exporter configureExporter(Exporter exp) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,Hbm2DDLExporter exporter = (Hbm2DDLExporter) exp;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,exporter.setExport(exportToDatabase);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,exporter.setConsole(scriptToConsole);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,exporter.setUpdate(schemaUpdate);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,exporter.setDelimiter(delimiter);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,exporter.setDrop(drop);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,exporter.setCreate(create);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,exporter.setFormat(format);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,exporter.setOutputFileName(outputFileName);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,exporter.setHaltonerror(haltOnError);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,return exporter;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,protected Exporter createExporter() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"Hbm2DDLExporter exporter = new Hbm2DDLExporter(getConfiguration(), getDestdir());"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public void setExport(boolean export) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,exportToDatabase = export;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* Run SchemaUpdate instead of SchemaExport
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public void setUpdate(boolean update) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,this.schemaUpdate = update;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* Output sql to console ? (default true)
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public void setConsole(boolean console) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,this.scriptToConsole = console;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* Format the generated sql
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public void setFormat(boolean format) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,this.format = format;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public void setDrop(boolean drop) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,this.drop = drop;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public void setCreate(boolean create) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,this.create = create;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public void setDelimiter(String delimiter) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,this.delimiter = delimiter;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public String getDelimiter() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,return delimiter;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public void setHaltonerror(boolean haltOnError) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,this.haltOnError  = haltOnError;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,/*
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* #%L
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* BroadleafCommerce Common Libraries
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* %%
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* Copyright (C) 2009 - 2013 Broadleaf Commerce
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"* Licensed under the Apache License, Version 2.0 (the ""License"");"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* you may not use this file except in compliance with the License.
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* You may obtain a copy of the License at
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,*
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,*       http://www.apache.org/licenses/LICENSE-2.0
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"* Unless required by applicable law or agreed to in writing, software"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"* distributed under the License is distributed on an ""AS IS"" BASIS,"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* See the License for the specific language governing permissions and
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* limitations under the License.
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* #L%
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,*/
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,package org.broadleafcommerce.common.util.sql;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.apache.commons.lang.StringUtils;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.apache.tools.ant.BuildException;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.apache.tools.ant.Project;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.apache.tools.ant.Task;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.apache.tools.ant.types.Path;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.broadleafcommerce.common.extensibility.context.MergeFileSystemAndClassPathXMLApplicationContext;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.broadleafcommerce.common.extensibility.context.StandardConfigLocations;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.broadleafcommerce.common.extensibility.jpa.ConfigurationOnlyState;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.hibernate.MappingNotFoundException;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.hibernate.tool.ant.ConfigurationTask;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import java.io.BufferedReader;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import java.io.BufferedWriter;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import java.io.File;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import java.io.FileReader;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import java.io.FileWriter;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import java.io.FilenameFilter;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import java.util.ArrayList;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import java.util.Iterator;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import java.util.LinkedHashMap;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import java.util.List;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,/**
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* This is a re-worked version from Hibernate tools
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* @author jfischer
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public class HibernateToolTask extends Task {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public HibernateToolTask() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,super();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,}
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"@SuppressWarnings(""rawtypes"")"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,protected List configurationTasks = new ArrayList();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,protected File destDir;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,protected List generators = new ArrayList();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,protected List<Task> appContexts = new ArrayList<Task>();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,protected Path classPath;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,protected boolean combinePersistenceUnits = true;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,protected boolean refineFileNames = true;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public ExporterTask createHbm2DDL() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,ExporterTask generator = new Hbm2DDLExporterTask(this);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,addGenerator( generator );
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,return generator;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public ClassPathApplicationContextTask createClassPathApplicationContext() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,ClassPathApplicationContextTask task = new ClassPathApplicationContextTask();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,appContexts.add(task);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,return task;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public FileSystemApplicationContextTask createFileSystemApplicationContext() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,FileSystemApplicationContextTask task = new FileSystemApplicationContextTask();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public JPAConfigurationTask createJPAConfiguration() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,JPAConfigurationTask task = new JPAConfigurationTask();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,addConfiguration(task);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"@SuppressWarnings(""unchecked"")"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,protected boolean addConfiguration(ConfigurationTask config) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,return configurationTasks.add(config);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,protected boolean addGenerator(ExporterTask generator) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,return generators.add(generator);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* Set the classpath to be used when running the Java class
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* @param s an Ant Path object containing the classpath.
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public void setClasspath(Path s) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,classPath = s;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* Adds a path to the classpath.
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* @return created classpath
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public Path createClasspath() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,classPath = new Path(getProject() );
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,return classPath;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,@Override
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public void execute() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,MergeFileSystemAndClassPathXMLApplicationContext mergeContext;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,try {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,ConfigurationOnlyState state = new ConfigurationOnlyState();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,state.setConfigurationOnly(true);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,ConfigurationOnlyState.setState(state);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,Thread.currentThread().setContextClassLoader(this.getClass().getClassLoader());
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,// launch the service merge application context to get the entity configuration for the entire framework
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,String[] contexts = StandardConfigLocations.retrieveAll(StandardConfigLocations.TESTCONTEXTTYPE);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"LinkedHashMap<String, MergeFileSystemAndClassPathXMLApplicationContext.ResourceType> locations = new LinkedHashMap<String, MergeFileSystemAndClassPathXMLApplicationContext.ResourceType>();"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,for (String context : contexts) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"locations.put(context, MergeFileSystemAndClassPathXMLApplicationContext.ResourceType.CLASSPATH);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,for (Task task : appContexts) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,if (task instanceof ClassPathApplicationContextTask) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"locations.put(((ClassPathApplicationContextTask) task).getPath(), MergeFileSystemAndClassPathXMLApplicationContext.ResourceType.CLASSPATH);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,} else if (task instanceof FileSystemApplicationContextTask) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"locations.put(((FileSystemApplicationContextTask) task).getPath(), MergeFileSystemAndClassPathXMLApplicationContext.ResourceType.FILESYSTEM);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"mergeContext = new MergeFileSystemAndClassPathXMLApplicationContext(locations, null);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,} catch (Exception e) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"throw new BuildException(e, getLocation());"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,} finally {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,ConfigurationOnlyState.setState(null);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,int count = 1;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,ExporterTask generatorTask = null;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,for (Object configuration : configurationTasks) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,JPAConfigurationTask configurationTask = (JPAConfigurationTask) configuration;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"log(""Executing Hibernate Tool with a "" + configurationTask.getDescription());"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,Iterator iterator = generators.iterator();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,while (iterator.hasNext()) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,generatorTask = (ExporterTask) iterator.next();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"log(count++ + "". task: "" + generatorTask.getName());"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"generatorTask.setOutputFileName(configurationTask.getDialect() + ""_"" + configurationTask.getPersistenceUnit() + "".sql"");"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,generatorTask.setDestdir(destDir);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,generatorTask.setConfiguration(configurationTask.createConfiguration(mergeContext));
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,generatorTask.execute();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,} catch (RuntimeException re) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"reportException(re, count, generatorTask);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,if (combinePersistenceUnits) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,ArrayList<File> combine = new ArrayList<File>();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,File[] sqlFiles = destDir.listFiles(new SqlFileFilter());
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,for (File file : sqlFiles) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,if (file.getName().startsWith(configurationTask.getDialect())){
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,combine.add(file);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,combineFiles(combine);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,combine.clear();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,if (refineFileNames) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,String filename = file.getName();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"String[] starters = {""org.hibernate.dialect."", ""org.broadleafcommerce.profile.util.sql.""};"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,for (String starter : starters) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,if (filename.startsWith(starter)) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"String newFileName = filename.substring(starter.length(), filename.length());"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"file.renameTo(new File(destDir, newFileName));"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,private void combineFiles(ArrayList<File> combine) throws Exception {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,Iterator<File> itr = combine.iterator();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,File startFile = itr.next();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,while(itr.hasNext()) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,File nextFile = itr.next();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,BufferedWriter writer = null;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,BufferedReader reader = null;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,try{
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"writer = new BufferedWriter(new FileWriter(startFile, true));"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,reader = new BufferedReader(new FileReader(nextFile));
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,boolean eof = false;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,String temp = null;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,while (!eof) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,temp = reader.readLine();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,if (temp == null) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,eof = true;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,} else {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,writer.write(temp);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"writer.write(""\n"");"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,if (writer != null) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,try{ writer.close(); } catch (Throwable e) {};
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,if (reader != null) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,try{ reader.close(); } catch (Throwable e) {};
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,nextFile.delete();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,} catch (Throwable e) {}
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"private void reportException(Throwable re, int count, ExporterTask generatorTask) {"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"log(""An exception occurred while running exporter #"" + count + "":"" + generatorTask.getName(), Project.MSG_ERR);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"log(""To get the full stack trace run ant with -verbose"", Project.MSG_ERR);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"log(re.toString(), Project.MSG_ERR);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,String ex = new String();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,Throwable cause = re.getCause();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,while(cause!=null) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"ex += cause.toString() + ""\n"";"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,if(cause==cause.getCause()) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,break; // we reached the top.
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,cause=cause.getCause();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,if(StringUtils.isNotEmpty(ex)) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"log(ex, Project.MSG_ERR);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,String newbieMessage = getProbableSolutionOrCause(re);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,if(newbieMessage!=null) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,log(newbieMessage);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,if(re instanceof BuildException) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,throw (BuildException)re;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"throw new BuildException(re, getLocation());"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,private String getProbableSolutionOrCause(Throwable re) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,if(re==null) return null;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,if(re instanceof MappingNotFoundException) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,MappingNotFoundException mnf = (MappingNotFoundException)re;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"if(""resource"".equals(mnf.getType())) {"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"return ""A "" + mnf.getType() + "" located at "" + mnf.getPath() + "" was not found.\n"" +"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"""Check the following:\n"" +"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"""\n"" +"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"""1) Is the spelling/casing correct ?\n"" +"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"""2) Is "" + mnf.getPath() + "" available via the classpath ?\n"" +"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"""3) Does it actually exist ?\n"";"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"""2) Do you permission to access "" + mnf.getPath() + "" ?\n"" +"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,if(re instanceof ClassNotFoundException || re instanceof NoClassDefFoundError) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"return ""A class were not found in the classpath of the Ant task.\n"" +"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"""Ensure that the classpath contains the classes needed for Hibernate and your code are in the classpath.\n"";"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,if(re instanceof UnsupportedClassVersionError) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"return ""You are most likely running the ant task with a JRE that is older than the JRE required to use the classes.\n"" +"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"""e.g. running with JRE 1.3 or 1.4 when using JDK 1.5 annotations is not possible.\n"" +"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"""Ensure that you are using a correct JRE."";"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,if(re.getCause()!=re) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,return getProbableSolutionOrCause( re.getCause() );
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,return null;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public File getDestdir() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,return destDir;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public void setDestdir(File destDir) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,this.destDir = destDir;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public boolean isCombinePersistenceUnits() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,return combinePersistenceUnits;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public void setCombinePersistenceUnits(boolean combinePersistenceUnits) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,this.combinePersistenceUnits = combinePersistenceUnits;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public boolean isRefineFileNames() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,return refineFileNames;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public void setRefineFileNames(boolean refineFileNames) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,this.refineFileNames = refineFileNames;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,private class SqlFileFilter implements FilenameFilter {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"public boolean accept(File dir, String name) {"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"return name.endsWith("".sql"");"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,/*
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,* #%L
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,* BroadleafCommerce Common Libraries
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,* %%
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,* Copyright (C) 2009 - 2013 Broadleaf Commerce
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"* Licensed under the Apache License, Version 2.0 (the ""License"");"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,* you may not use this file except in compliance with the License.
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,* You may obtain a copy of the License at
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,*
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,*       http://www.apache.org/licenses/LICENSE-2.0
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"* Unless required by applicable law or agreed to in writing, software"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"* distributed under the License is distributed on an ""AS IS"" BASIS,"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,* See the License for the specific language governing permissions and
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,* limitations under the License.
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,* #L%
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,*/
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,package org.broadleafcommerce.common.util.sql;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,import org.apache.commons.lang.StringUtils;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,import org.apache.tools.ant.BuildException;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,import org.apache.tools.ant.Project;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,import org.apache.tools.ant.Task;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,import org.apache.tools.ant.types.Path;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,import org.broadleafcommerce.common.extensibility.context.MergeFileSystemAndClassPathXMLApplicationContext;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,import org.broadleafcommerce.common.extensibility.context.StandardConfigLocations;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,import org.broadleafcommerce.common.extensibility.jpa.ConfigurationOnlyState;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,import org.hibernate.MappingNotFoundException;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,import org.hibernate.tool.ant.ConfigurationTask;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,import java.io.BufferedReader;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,import java.io.BufferedWriter;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,import java.io.File;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,import java.io.FileReader;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,import java.io.FileWriter;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,import java.io.FilenameFilter;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,import java.util.ArrayList;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,import java.util.Iterator;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,import java.util.LinkedHashMap;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,import java.util.List;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,/**
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,* This is a re-worked version from Hibernate tools
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,* @author jfischer
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,public class HibernateToolTask extends Task {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,public HibernateToolTask() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,super();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,}
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"@SuppressWarnings(""rawtypes"")"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,protected List configurationTasks = new ArrayList();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,protected File destDir;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,protected List generators = new ArrayList();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,protected List<Task> appContexts = new ArrayList<Task>();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,protected Path classPath;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,protected boolean combinePersistenceUnits = true;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,protected boolean refineFileNames = true;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,public ExporterTask createHbm2DDL() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,ExporterTask generator = new Hbm2DDLExporterTask(this);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,addGenerator( generator );
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,return generator;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,public ClassPathApplicationContextTask createClassPathApplicationContext() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,ClassPathApplicationContextTask task = new ClassPathApplicationContextTask();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,appContexts.add(task);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,return task;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,public FileSystemApplicationContextTask createFileSystemApplicationContext() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,FileSystemApplicationContextTask task = new FileSystemApplicationContextTask();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,public JPAConfigurationTask createJPAConfiguration() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,JPAConfigurationTask task = new JPAConfigurationTask();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,addConfiguration(task);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"@SuppressWarnings(""unchecked"")"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,protected boolean addConfiguration(ConfigurationTask config) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,return configurationTasks.add(config);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,protected boolean addGenerator(ExporterTask generator) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,return generators.add(generator);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,* Set the classpath to be used when running the Java class
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,* @param s an Ant Path object containing the classpath.
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,public void setClasspath(Path s) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,classPath = s;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,* Adds a path to the classpath.
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,* @return created classpath
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,public Path createClasspath() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,classPath = new Path(getProject() );
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,return classPath;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,@Override
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,public void execute() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,MergeFileSystemAndClassPathXMLApplicationContext mergeContext;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,try {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,ConfigurationOnlyState state = new ConfigurationOnlyState();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,state.setConfigurationOnly(true);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,ConfigurationOnlyState.setState(state);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,Thread.currentThread().setContextClassLoader(this.getClass().getClassLoader());
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,// launch the service merge application context to get the entity configuration for the entire framework
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,String[] contexts = StandardConfigLocations.retrieveAll(StandardConfigLocations.TESTCONTEXTTYPE);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"LinkedHashMap<String, MergeFileSystemAndClassPathXMLApplicationContext.ResourceType> locations = new LinkedHashMap<String, MergeFileSystemAndClassPathXMLApplicationContext.ResourceType>();"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,for (String context : contexts) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"locations.put(context, MergeFileSystemAndClassPathXMLApplicationContext.ResourceType.CLASSPATH);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,for (Task task : appContexts) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,if (task instanceof ClassPathApplicationContextTask) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"locations.put(((ClassPathApplicationContextTask) task).getPath(), MergeFileSystemAndClassPathXMLApplicationContext.ResourceType.CLASSPATH);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,} else if (task instanceof FileSystemApplicationContextTask) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"locations.put(((FileSystemApplicationContextTask) task).getPath(), MergeFileSystemAndClassPathXMLApplicationContext.ResourceType.FILESYSTEM);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"mergeContext = new MergeFileSystemAndClassPathXMLApplicationContext(locations, null);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,} catch (Exception e) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"throw new BuildException(e, getLocation());"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,} finally {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,ConfigurationOnlyState.setState(null);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,int count = 1;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,ExporterTask generatorTask = null;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,for (Object configuration : configurationTasks) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,JPAConfigurationTask configurationTask = (JPAConfigurationTask) configuration;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"log(""Executing Hibernate Tool with a "" + configurationTask.getDescription());"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,Iterator iterator = generators.iterator();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,while (iterator.hasNext()) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,generatorTask = (ExporterTask) iterator.next();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"log(count++ + "". task: "" + generatorTask.getName());"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"generatorTask.setOutputFileName(configurationTask.getDialect() + ""_"" + configurationTask.getPersistenceUnit() + "".sql"");"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,generatorTask.setDestdir(destDir);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,generatorTask.setConfiguration(configurationTask.createConfiguration(mergeContext));
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,generatorTask.execute();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,} catch (RuntimeException re) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"reportException(re, count, generatorTask);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,if (combinePersistenceUnits) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,ArrayList<File> combine = new ArrayList<File>();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,File[] sqlFiles = destDir.listFiles(new SqlFileFilter());
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,for (File file : sqlFiles) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,if (file.getName().startsWith(configurationTask.getDialect())){
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,combine.add(file);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,combineFiles(combine);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,combine.clear();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,if (refineFileNames) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,String filename = file.getName();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"String[] starters = {""org.hibernate.dialect."", ""org.broadleafcommerce.profile.util.sql.""};"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,for (String starter : starters) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,if (filename.startsWith(starter)) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"String newFileName = filename.substring(starter.length(), filename.length());"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"file.renameTo(new File(destDir, newFileName));"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,private void combineFiles(ArrayList<File> combine) throws Exception {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,Iterator<File> itr = combine.iterator();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,File startFile = itr.next();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,while(itr.hasNext()) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,File nextFile = itr.next();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,BufferedWriter writer = null;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,BufferedReader reader = null;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,try{
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"writer = new BufferedWriter(new FileWriter(startFile, true));"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,reader = new BufferedReader(new FileReader(nextFile));
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,boolean eof = false;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,String temp = null;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,while (!eof) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,temp = reader.readLine();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,if (temp == null) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,eof = true;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,} else {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,writer.write(temp);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"writer.write(""\n"");"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,if (writer != null) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,try{ writer.close(); } catch (Throwable e) {};
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,if (reader != null) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,try{ reader.close(); } catch (Throwable e) {};
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,nextFile.delete();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,} catch (Throwable e) {}
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"private void reportException(Throwable re, int count, ExporterTask generatorTask) {"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"log(""An exception occurred while running exporter #"" + count + "":"" + generatorTask.getName(), Project.MSG_ERR);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"log(""To get the full stack trace run ant with -verbose"", Project.MSG_ERR);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"log(re.toString(), Project.MSG_ERR);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,String ex = new String();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,Throwable cause = re.getCause();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,while(cause!=null) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"ex += cause.toString() + ""\n"";"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,if(cause==cause.getCause()) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,break; // we reached the top.
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,cause=cause.getCause();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,if(StringUtils.isNotEmpty(ex)) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"log(ex, Project.MSG_ERR);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,String newbieMessage = getProbableSolutionOrCause(re);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,if(newbieMessage!=null) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,log(newbieMessage);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,if(re instanceof BuildException) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,throw (BuildException)re;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"throw new BuildException(re, getLocation());"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,private String getProbableSolutionOrCause(Throwable re) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,if(re==null) return null;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,if(re instanceof MappingNotFoundException) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,MappingNotFoundException mnf = (MappingNotFoundException)re;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"if(""resource"".equals(mnf.getType())) {"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"return ""A "" + mnf.getType() + "" located at "" + mnf.getPath() + "" was not found.\n"" +"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"""Check the following:\n"" +"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"""\n"" +"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"""1) Is the spelling/casing correct ?\n"" +"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"""2) Is "" + mnf.getPath() + "" available via the classpath ?\n"" +"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"""3) Does it actually exist ?\n"";"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"""2) Do you permission to access "" + mnf.getPath() + "" ?\n"" +"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,if(re instanceof ClassNotFoundException || re instanceof NoClassDefFoundError) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"return ""A class were not found in the classpath of the Ant task.\n"" +"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"""Ensure that the classpath contains the classes needed for Hibernate and your code are in the classpath.\n"";"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,if(re instanceof UnsupportedClassVersionError) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"return ""You are most likely running the ant task with a JRE that is older than the JRE required to use the classes.\n"" +"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"""e.g. running with JRE 1.3 or 1.4 when using JDK 1.5 annotations is not possible.\n"" +"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"""Ensure that you are using a correct JRE."";"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,if(re.getCause()!=re) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,return getProbableSolutionOrCause( re.getCause() );
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,return null;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,public File getDestdir() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,return destDir;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,public void setDestdir(File destDir) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,this.destDir = destDir;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,public boolean isCombinePersistenceUnits() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,return combinePersistenceUnits;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,public void setCombinePersistenceUnits(boolean combinePersistenceUnits) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,this.combinePersistenceUnits = combinePersistenceUnits;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,public boolean isRefineFileNames() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,return refineFileNames;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,public void setRefineFileNames(boolean refineFileNames) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,this.refineFileNames = refineFileNames;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,private class SqlFileFilter implements FilenameFilter {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"public boolean accept(File dir, String name) {"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,b8a1641218de8a7b24390425a40307e70ab3a3ba,deleted,1,"return name.endsWith("".sql"");"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,/*
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* #%L
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* BroadleafCommerce Common Libraries
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* %%
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* Copyright (C) 2009 - 2013 Broadleaf Commerce
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"* Licensed under the Apache License, Version 2.0 (the ""License"");"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* you may not use this file except in compliance with the License.
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* You may obtain a copy of the License at
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,*
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,*       http://www.apache.org/licenses/LICENSE-2.0
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"* Unless required by applicable law or agreed to in writing, software"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"* distributed under the License is distributed on an ""AS IS"" BASIS,"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* See the License for the specific language governing permissions and
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* limitations under the License.
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* #L%
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,*/
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,package org.broadleafcommerce.common.util.sql;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.apache.tools.ant.BuildException;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.broadleafcommerce.common.extensibility.context.MergeFileSystemAndClassPathXMLApplicationContext;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.broadleafcommerce.common.extensibility.jpa.MergePersistenceUnitManager;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.hibernate.HibernateException;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.hibernate.cfg.Configuration;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.hibernate.internal.util.ReflectHelper;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.hibernate.tool.ant.ConfigurationTask;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import org.xml.sax.EntityResolver;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import javax.persistence.spi.PersistenceUnitInfo;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import java.lang.reflect.Method;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import java.util.HashMap;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import java.util.Map;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,import java.util.Properties;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,/**
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* This is a re-worked version from Hibernate tools
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,* @author jfischer
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public class JPAConfigurationTask extends ConfigurationTask {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,private String persistenceUnit;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,private String dialect;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,private String url;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,private String userName;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,private String password;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,private String driverClassName;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public JPAConfigurationTask() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"setDescription(""JPA Configuration"");"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,}
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,protected Configuration createConfiguration(MergeFileSystemAndClassPathXMLApplicationContext mergeContext) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,try {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"PersistenceUnitInfo unitInfo = ((MergePersistenceUnitManager) mergeContext.getBean(""blPersistenceUnitManager"")).obtainPersistenceUnitInfo(persistenceUnit);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"Map<Object, Object> overrides = new HashMap<Object, Object>();"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,Properties p = getProperties();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,if(p!=null) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,overrides.putAll( p );
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"overrides.put(""hibernate.dialect"",dialect);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"if (this.url != null && ! ""null"".equalsIgnoreCase(this.url)) {"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"overrides.put(""hibernate.connection.url"", this.url);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"if (this.userName != null && ! ""null"".equalsIgnoreCase(this.userName)) {"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"overrides.put(""hibernate.connection.username"", this.userName);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,if (this.password == null) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"//This is for situations like HSQLDB that, by default, use no password"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"overrides.put(""hibernate.connection.password"", """");"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"} else if (! ""null"".equalsIgnoreCase(this.password)) {"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"//This allows you to specify a password or the word ""null"" to not set this property at all"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"overrides.put(""hibernate.connection.password"", this.password);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"if (this.driverClassName != null && ! ""null"".equalsIgnoreCase(this.driverClassName)) {"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"overrides.put(""hibernate.connection.driver_class"", this.driverClassName);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"Class<?> clazz = ReflectHelper.classForName(""org.hibernate.ejb.Ejb3Configuration"", JPAConfigurationTask.class);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,Object ejb3cfg = clazz.newInstance();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,if(entityResolver!=null) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"Class<?> resolver = ReflectHelper.classForName(entityResolver, this.getClass());"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,Object object = resolver.newInstance();
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"Method method = clazz.getMethod(""setEntityResolver"", new Class[] { EntityResolver.class });"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"method.invoke(ejb3cfg, new Object[] { object } );"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"Method method = clazz.getMethod(""configure"", new Class[] { PersistenceUnitInfo.class, Map.class });"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"if ( method.invoke(ejb3cfg, new Object[] { unitInfo, overrides } ) == null ) {"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"throw new BuildException(""Persistence unit not found: '"" + persistenceUnit + ""'."");"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"method = clazz.getMethod(""getHibernateConfiguration"", new Class[0]);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"return (Configuration) method.invoke(ejb3cfg, (Object[])null);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,catch(HibernateException he) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,throw new BuildException(he);
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,catch(BuildException be) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,throw be;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,catch(Exception t) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,"throw new BuildException(""Problems in creating a configuration for JPA. Have you remembered to add hibernate EntityManager jars to the classpath ?"",t);"
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,protected void doConfiguration(Configuration configuration) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,protected void validateParameters() throws BuildException {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public String getPersistenceUnit() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,return persistenceUnit;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public void setPersistenceUnit(String persistenceUnit) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,this.persistenceUnit = persistenceUnit;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public String getDialect() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,return dialect;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public void setDialect(String dialect) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,this.dialect = dialect;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public String getUrl() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,return url;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public void setUrl(String url) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,this.url = url;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public String getUserName() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,return userName;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public void setUserName(String userName) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,this.userName = userName;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public String getPassword() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,return password;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public void setPassword(String password) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,this.password = password;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public String getDriverClassName() {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,return driverClassName;
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,public void setDriverClassName(String driverClassName) {
d7afd3d6f9c4c9fffe3bde06d42343a610236708,653f26f092fd84f43466f04d9cfa71757e9608e2,deleted,1,this.driverClassName = driverClassName;
55ebeb48c143d2ea04b8814fe7635dc7ec75bf66,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.apache.commons.lang3.time.FastDateFormat;
55ebeb48c143d2ea04b8814fe7635dc7ec75bf66,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"private static final FastDateFormat CONTENT_DATE_FORMATTER = FastDateFormat.getInstance(""yyyyMMddHHmm"");"
55ebeb48c143d2ea04b8814fe7635dc7ec75bf66,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"private static final FastDateFormat CONTENT_DATE_DISPLAY_FORMATTER = FastDateFormat.getInstance(""MM/dd/yyyy"");"
55ebeb48c143d2ea04b8814fe7635dc7ec75bf66,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"private static final FastDateFormat CONTENT_DATE_DISPLAY_HOURS_FORMATTER = FastDateFormat.getInstance(""h"");"
55ebeb48c143d2ea04b8814fe7635dc7ec75bf66,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"private static final FastDateFormat CONTENT_DATE_DISPLAY_MINUTES_FORMATTER = FastDateFormat.getInstance(""mm"");"
55ebeb48c143d2ea04b8814fe7635dc7ec75bf66,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"private static final FastDateFormat CONTENT_DATE_PARSE_FORMAT = FastDateFormat.getInstance(""MM/dd/yyyy hh:mm aa"");"
55ebeb48c143d2ea04b8814fe7635dc7ec75bf66,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import java.text.SimpleDateFormat;
55ebeb48c143d2ea04b8814fe7635dc7ec75bf66,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"private static final SimpleDateFormat CONTENT_DATE_FORMATTER = new SimpleDateFormat(""yyyyMMddHHmm"");"
55ebeb48c143d2ea04b8814fe7635dc7ec75bf66,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"private static final SimpleDateFormat CONTENT_DATE_DISPLAY_FORMATTER = new SimpleDateFormat(""MM/dd/yyyy"");"
55ebeb48c143d2ea04b8814fe7635dc7ec75bf66,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"private static final SimpleDateFormat CONTENT_DATE_DISPLAY_HOURS_FORMATTER = new SimpleDateFormat(""h"");"
55ebeb48c143d2ea04b8814fe7635dc7ec75bf66,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"private static final SimpleDateFormat CONTENT_DATE_DISPLAY_MINUTES_FORMATTER = new SimpleDateFormat(""mm"");"
55ebeb48c143d2ea04b8814fe7635dc7ec75bf66,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"private static final SimpleDateFormat CONTENT_DATE_PARSE_FORMAT = new SimpleDateFormat(""MM/dd/yyyy hh:mm aa"");"
89961ae5138ab579cdaf5732ddfa4202ad31efd4,8ecb846dc0086d78fd52547459197a73d8d2d009,added,0,import org.broadleafcommerce.core.order.service.call.AddToCartItem;
89961ae5138ab579cdaf5732ddfa4202ad31efd4,8ecb846dc0086d78fd52547459197a73d8d2d009,deleted,1,import org.broadleafcommerce.core.web.order.model.AddToCartItem;
c06881d52e593ac08113a8b20774b740bf2b796d,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,// Added retailPrice check since a null salePrice is not a reliable way to determine that prices have
c06881d52e593ac08113a8b20774b740bf2b796d,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,// been initialized.
c06881d52e593ac08113a8b20774b740bf2b796d,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,if (salePrice == null && retailPrice == null) {
c06881d52e593ac08113a8b20774b740bf2b796d,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,if (salePrice == null) {
f9dec5ed1dcdbcc96dd047eacc9aea8eff9d2703,cdabda4e8cf99961c44011e9e015e13617026637,added,0,@Override
f9dec5ed1dcdbcc96dd047eacc9aea8eff9d2703,cdabda4e8cf99961c44011e9e015e13617026637,added,0,public void createRegisteredCustomerRoles(Customer customer) {
f9dec5ed1dcdbcc96dd047eacc9aea8eff9d2703,cdabda4e8cf99961c44011e9e015e13617026637,deleted,1,/**
f9dec5ed1dcdbcc96dd047eacc9aea8eff9d2703,cdabda4e8cf99961c44011e9e015e13617026637,deleted,1,* Subclassed implementations can assign unique roles for various customer types
f9dec5ed1dcdbcc96dd047eacc9aea8eff9d2703,cdabda4e8cf99961c44011e9e015e13617026637,deleted,1,*
f9dec5ed1dcdbcc96dd047eacc9aea8eff9d2703,cdabda4e8cf99961c44011e9e015e13617026637,deleted,1,* @param customer
f9dec5ed1dcdbcc96dd047eacc9aea8eff9d2703,cdabda4e8cf99961c44011e9e015e13617026637,deleted,1,*/
f9dec5ed1dcdbcc96dd047eacc9aea8eff9d2703,cdabda4e8cf99961c44011e9e015e13617026637,deleted,1,protected void createRegisteredCustomerRoles(Customer customer) {
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.common.extension.ExtensionResultHolder;
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.common.extension.currency.CurrencyResolverExtensionManager;
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"@Resource(name = ""blCurrencyResolverExtensionManager"")"
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,protected CurrencyResolverExtensionManager extensionManager;
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,BroadleafCurrency desiredCurrency = null;
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"desiredCurrency = (BroadleafCurrency) request.getAttribute(CURRENCY_VAR, WebRequest.SCOPE_REQUEST);"
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"if (desiredCurrency == null && BLCRequestUtils.getURLorHeaderParameter(request, CURRENCY_CODE_PARAM) != null) {"
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,desiredCurrency = broadleafCurrencyService.findCurrencyByCode(currencyCode);
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"LOG.trace(""Attempt to find currency by param "" + currencyCode + "" resulted in "" + desiredCurrency);"
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (desiredCurrency == null && BLCRequestUtils.isOKtoUseSession(request)) {
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"desiredCurrency = (BroadleafCurrency) request.getAttribute(CURRENCY_VAR, WebRequest.SCOPE_GLOBAL_SESSION);"
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (desiredCurrency == null) {
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,desiredCurrency = locale.getDefaultCurrency();
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,// 5) Lookup default currency from DB
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,BroadleafCurrency defaultCurrency = broadleafCurrencyService.findDefaultBroadleafCurrency();
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,desiredCurrency = defaultCurrency;
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,}
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"// For an out-of-box installation, only one currency is supported, so even though we have a"
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"// desired currency, we may not have any prices that support it."
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,BroadleafCurrency currencyToUse = defaultCurrency;
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,// Allow extension managers (like enterprise pricing) to indicate whether additional currency support is
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,// available.
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (extensionManager != null) {
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,ExtensionResultHolder<BroadleafCurrency> resultHolder = new ExtensionResultHolder<BroadleafCurrency>();
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"extensionManager.getProxy().overrideCurrency(desiredCurrency, defaultCurrency, resultHolder);"
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (resultHolder != null && resultHolder.getResult() != null) {
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,currencyToUse = resultHolder.getResult();
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"request.setAttribute(CURRENCY_VAR, currencyToUse, WebRequest.SCOPE_GLOBAL_SESSION);"
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,return currencyToUse;
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,BroadleafCurrency currency = null;
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"currency = (BroadleafCurrency) request.getAttribute(CURRENCY_VAR, WebRequest.SCOPE_REQUEST);"
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"if (currency == null && BLCRequestUtils.getURLorHeaderParameter(request, CURRENCY_CODE_PARAM) != null) {"
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,currency = broadleafCurrencyService.findCurrencyByCode(currencyCode);
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"LOG.trace(""Attempt to find currency by param "" + currencyCode + "" resulted in "" + currency);"
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (currency == null && BLCRequestUtils.isOKtoUseSession(request)) {
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"currency = (BroadleafCurrency) request.getAttribute(CURRENCY_VAR, WebRequest.SCOPE_GLOBAL_SESSION);"
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (currency == null) {
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,currency = locale.getDefaultCurrency();
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,// 5) Check default currency from DB
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,currency = broadleafCurrencyService.findDefaultBroadleafCurrency();
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"request.setAttribute(CURRENCY_VAR, currency, WebRequest.SCOPE_GLOBAL_SESSION);"
babdb67b850b35b071bc9c7d34b409a0bcef476d,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,return currency;
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,protected final Object LOCK_OBJECT = new Object();
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,protected boolean IS_LOCKED = false;
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,"@Value(""${solr.index.errorOnConcurrentReIndex}"")"
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,protected boolean errorOnConcurrentReIndex = false;
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,public boolean isReindexInProcess() {
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,synchronized (LOCK_OBJECT) {
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,return IS_LOCKED;
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,}
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,@Override
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,"public void rebuildIndex() throws ServiceException, IOException {"
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,if (IS_LOCKED) {
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,if (errorOnConcurrentReIndex) {
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,"throw new IllegalStateException(""More than one thread attempting to concurrently reindex Solr."");"
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,} else {
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,"LOG.warn(""There is more than one thread attempting to concurrently """
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,"+ ""reindex Solr. Failing additional threads gracefully. Check your configuration."");"
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,return;
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,IS_LOCKED = true;
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,"LOG.info(""Rebuilding the solr index..."");"
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,StopWatch s = new StopWatch();
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,"// If we are in single core mode, we have to delete the documents before reindexing"
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,if (SolrContext.isSingleCoreMode()) {
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,SolrIndexServiceImpl.this.deleteAllDocuments();
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,Object[] pack = saveState();
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,try {
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,final Long numProducts = productDao.readCountAllActiveProducts();
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,if (LOG.isDebugEnabled()) {
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,"LOG.debug(""There are "" + numProducts + "" total products"");"
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,performCachedOperation(new SolrIndexCachedOperation.CacheOperation() {
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,public void execute() throws ServiceException {
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,int page = 0;
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,while ((page * pageSize) < numProducts) {
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,"buildIncrementalIndex(page, pageSize);"
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,page++;
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,});
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,optimizeIndex(SolrContext.getReindexServer());
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,} finally {
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,restoreState(pack);
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,// Swap the active and the reindex cores
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,shs.swapActiveCores();
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,"// If we are not in single core mode, we delete the documents for the unused core after swapping"
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,if (!SolrContext.isSingleCoreMode()) {
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,deleteAllDocuments();
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,"LOG.info(String.format(""Finished building index in %s"", s.toLapString()));"
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,added,0,IS_LOCKED = false;
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,"public void rebuildIndex() throws ServiceException, IOException {"
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,"LOG.info(""Rebuilding the solr index..."");"
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,StopWatch s = new StopWatch();
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,"// If we are in single core mode, we have to delete the documents before reindexing"
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,if (SolrContext.isSingleCoreMode()) {
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,SolrIndexServiceImpl.this.deleteAllDocuments();
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,Object[] pack = saveState();
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,final Long numProducts = productDao.readCountAllActiveProducts();
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,if (LOG.isDebugEnabled()) {
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,"LOG.debug(""There are "" + numProducts + "" total products"");"
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,performCachedOperation(new SolrIndexCachedOperation.CacheOperation() {
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,@Override
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,public void execute() throws ServiceException {
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,int page = 0;
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,while ((page * pageSize) < numProducts) {
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,"buildIncrementalIndex(page, pageSize);"
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,page++;
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,}
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,});
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,optimizeIndex(SolrContext.getReindexServer());
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,} finally {
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,restoreState(pack);
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,// Swap the active and the reindex cores
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,shs.swapActiveCores();
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,"// If we are not in single core mode, we delete the documents for the unused core after swapping"
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,if (!SolrContext.isSingleCoreMode()) {
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,deleteAllDocuments();
50307c8adfa3ec6ff2d6d0f3ce361c4a004b25b2,ed01d2f6de8de5b6fc1df8a59d5ed5f451b4a027,deleted,1,"LOG.info(String.format(""Finished building index in %s"", s.toLapString()));"
1c43b7a4fe73f3e198ffbfdf1fa7f956afc6083a,2f5a9cee706bff484552f959dbc4d4a5d03d17eb,added,0,query.addFilterQuery(valueString);
1c43b7a4fe73f3e198ffbfdf1fa7f956afc6083a,2f5a9cee706bff484552f959dbc4d4a5d03d17eb,added,0,if (range.getMaxValue() != null) {
1c43b7a4fe73f3e198ffbfdf1fa7f956afc6083a,2f5a9cee706bff484552f959dbc4d4a5d03d17eb,added,0,} else {
1c43b7a4fe73f3e198ffbfdf1fa7f956afc6083a,2f5a9cee706bff484552f959dbc4d4a5d03d17eb,added,0,}
1c43b7a4fe73f3e198ffbfdf1fa7f956afc6083a,2f5a9cee706bff484552f959dbc4d4a5d03d17eb,added,0,"sb.append("" "" + getSolrRangeFunctionString(range.getMinValue(), range.getMaxValue()));"
1c43b7a4fe73f3e198ffbfdf1fa7f956afc6083a,2f5a9cee706bff484552f959dbc4d4a5d03d17eb,added,0,"protected String getSolrRangeFunctionString(BigDecimal minValue, BigDecimal maxValue) {"
1c43b7a4fe73f3e198ffbfdf1fa7f956afc6083a,2f5a9cee706bff484552f959dbc4d4a5d03d17eb,added,0,StringBuilder sb = new StringBuilder();
1c43b7a4fe73f3e198ffbfdf1fa7f956afc6083a,2f5a9cee706bff484552f959dbc4d4a5d03d17eb,added,0,"sb.append("" u="").append(maxValue.toPlainString());"
1c43b7a4fe73f3e198ffbfdf1fa7f956afc6083a,2f5a9cee706bff484552f959dbc4d4a5d03d17eb,added,0,return sb.toString();
1c43b7a4fe73f3e198ffbfdf1fa7f956afc6083a,2f5a9cee706bff484552f959dbc4d4a5d03d17eb,deleted,1,StringBuilder sb = new StringBuilder();
1c43b7a4fe73f3e198ffbfdf1fa7f956afc6083a,2f5a9cee706bff484552f959dbc4d4a5d03d17eb,deleted,1,"sb.append(""("").append(valueString).append("")"");"
1c43b7a4fe73f3e198ffbfdf1fa7f956afc6083a,2f5a9cee706bff484552f959dbc4d4a5d03d17eb,deleted,1,query.addFilterQuery(sb.toString());
1c43b7a4fe73f3e198ffbfdf1fa7f956afc6083a,2f5a9cee706bff484552f959dbc4d4a5d03d17eb,deleted,1,if (range.getMaxValue() != null)
1c43b7a4fe73f3e198ffbfdf1fa7f956afc6083a,2f5a9cee706bff484552f959dbc4d4a5d03d17eb,deleted,1,else
1c43b7a4fe73f3e198ffbfdf1fa7f956afc6083a,2f5a9cee706bff484552f959dbc4d4a5d03d17eb,deleted,1,"sb.append("" ""+getSolrRangeFunctionString(range.getMinValue(), range.getMaxValue()));"
1c43b7a4fe73f3e198ffbfdf1fa7f956afc6083a,2f5a9cee706bff484552f959dbc4d4a5d03d17eb,deleted,1,"protected String getSolrRangeFunctionString(BigDecimal minValue, BigDecimal maxValue) {"
1c43b7a4fe73f3e198ffbfdf1fa7f956afc6083a,2f5a9cee706bff484552f959dbc4d4a5d03d17eb,deleted,1,"sb.append("" u="").append(maxValue.toPlainString());"
1c43b7a4fe73f3e198ffbfdf1fa7f956afc6083a,2f5a9cee706bff484552f959dbc4d4a5d03d17eb,deleted,1,return sb.toString();
1c43b7a4fe73f3e198ffbfdf1fa7f956afc6083a,2f5a9cee706bff484552f959dbc4d4a5d03d17eb,deleted,1,}
b652d67d56691cebb6a87de01e674ca9f2745e6b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"ApplicationEvent lastPublishedEvent = (ApplicationEvent) BLCRequestUtils.getSessionAttributeIfOk(request, LAST_PUBLISHED_EVENT_SESSION_ATTRIBUTED_NAME);"
b652d67d56691cebb6a87de01e674ca9f2745e6b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"BLCRequestUtils.setSessionAttributeIfOk(request, LAST_PUBLISHED_EVENT_SESSION_ATTRIBUTED_NAME, cookieEvent);"
b652d67d56691cebb6a87de01e674ca9f2745e6b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,publishLoggedInEvent = false;
b652d67d56691cebb6a87de01e674ca9f2745e6b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"BLCRequestUtils.setSessionAttributeIfOk(request, LAST_PUBLISHED_EVENT_SESSION_ATTRIBUTED_NAME, loggedInEvent);"
b652d67d56691cebb6a87de01e674ca9f2745e6b,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,}
b652d67d56691cebb6a87de01e674ca9f2745e6b,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"ApplicationEvent lastPublishedEvent = (ApplicationEvent) request.getAttribute(LAST_PUBLISHED_EVENT_SESSION_ATTRIBUTED_NAME, WebRequest.SCOPE_REQUEST);"
b652d67d56691cebb6a87de01e674ca9f2745e6b,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"request.setAttribute(LAST_PUBLISHED_EVENT_SESSION_ATTRIBUTED_NAME, cookieEvent, WebRequest.SCOPE_REQUEST);"
b652d67d56691cebb6a87de01e674ca9f2745e6b,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,publishLoggedInEvent= false;
b652d67d56691cebb6a87de01e674ca9f2745e6b,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"request.setAttribute(LAST_PUBLISHED_EVENT_SESSION_ATTRIBUTED_NAME, loggedInEvent, WebRequest.SCOPE_REQUEST);"
b652d67d56691cebb6a87de01e674ca9f2745e6b,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,}
0b72e35803ff5b193ea70ea5b26eb96e1c4968d1,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import javax.annotation.Resource;
0b72e35803ff5b193ea70ea5b26eb96e1c4968d1,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,protected OrderDao orderDao;
0b72e35803ff5b193ea70ea5b26eb96e1c4968d1,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import javax.annotation.Resource;
0b72e35803ff5b193ea70ea5b26eb96e1c4968d1,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,private OrderDao orderDao;
0b72e35803ff5b193ea70ea5b26eb96e1c4968d1,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,private boolean updatePrices = true;
0b72e35803ff5b193ea70ea5b26eb96e1c4968d1,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (updatePrices) {
0b72e35803ff5b193ea70ea5b26eb96e1c4968d1,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,order = orderDao.updatePrices(order);
0b72e35803ff5b193ea70ea5b26eb96e1c4968d1,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,}
0b72e35803ff5b193ea70ea5b26eb96e1c4968d1,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,public boolean isUpdatePrices() {
0b72e35803ff5b193ea70ea5b26eb96e1c4968d1,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,return updatePrices;
0b72e35803ff5b193ea70ea5b26eb96e1c4968d1,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,public void setUpdatePrices(boolean updatePrices) {
0b72e35803ff5b193ea70ea5b26eb96e1c4968d1,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,this.updatePrices = updatePrices;
0b72e35803ff5b193ea70ea5b26eb96e1c4968d1,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,added,0,import javax.annotation.Resource;
0b72e35803ff5b193ea70ea5b26eb96e1c4968d1,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,added,0,protected OrderDao orderDao;
0b72e35803ff5b193ea70ea5b26eb96e1c4968d1,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,import javax.annotation.Resource;
0b72e35803ff5b193ea70ea5b26eb96e1c4968d1,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,private OrderDao orderDao;
0b72e35803ff5b193ea70ea5b26eb96e1c4968d1,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,private boolean updatePrices = true;
0b72e35803ff5b193ea70ea5b26eb96e1c4968d1,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,if (updatePrices) {
0b72e35803ff5b193ea70ea5b26eb96e1c4968d1,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,order = orderDao.updatePrices(order);
0b72e35803ff5b193ea70ea5b26eb96e1c4968d1,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,}
0b72e35803ff5b193ea70ea5b26eb96e1c4968d1,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,public boolean isUpdatePrices() {
0b72e35803ff5b193ea70ea5b26eb96e1c4968d1,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,return updatePrices;
0b72e35803ff5b193ea70ea5b26eb96e1c4968d1,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,public void setUpdatePrices(boolean updatePrices) {
0b72e35803ff5b193ea70ea5b26eb96e1c4968d1,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,this.updatePrices = updatePrices;
45b052a6f144b2efab2b01dbc7eb670893bc5d25,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,// If there is no more sale price (because it got removed) then detect that case as well
45b052a6f144b2efab2b01dbc7eb670893bc5d25,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,if (skuSalePrice == null && salePrice != null) {
45b052a6f144b2efab2b01dbc7eb670893bc5d25,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,baseSalePrice = null;
45b052a6f144b2efab2b01dbc7eb670893bc5d25,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,salePrice = null;
45b052a6f144b2efab2b01dbc7eb670893bc5d25,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,updated = true;
45b052a6f144b2efab2b01dbc7eb670893bc5d25,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,}
45b052a6f144b2efab2b01dbc7eb670893bc5d25,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,if (returnPrice != null) {
45b052a6f144b2efab2b01dbc7eb670893bc5d25,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,salePrice = returnPrice.add(fee.getAmount()).getAmount();
45b052a6f144b2efab2b01dbc7eb670893bc5d25,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,@Override
45b052a6f144b2efab2b01dbc7eb670893bc5d25,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,salePrice = returnPrice.add(fee.getAmount()).getAmount();
6e207b6b2ab148a7d7dbd97d657c63c9713181d9,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import org.broadleafcommerce.core.order.domain.DiscreteOrderItem;
6e207b6b2ab148a7d7dbd97d657c63c9713181d9,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,order.updatePrices();
6e207b6b2ab148a7d7dbd97d657c63c9713181d9,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,((DiscreteOrderItem) order.getOrderItems().get(0)).getSku().setSalePrice(new Money(1D));
6e207b6b2ab148a7d7dbd97d657c63c9713181d9,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,((DiscreteOrderItem) order.getOrderItems().get(1)).getSku().setSalePrice(new Money(1D));
6e207b6b2ab148a7d7dbd97d657c63c9713181d9,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,((DiscreteOrderItem) order.getOrderItems().get(1)).getSku().setSalePrice(new Money(10D));
6e207b6b2ab148a7d7dbd97d657c63c9713181d9,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,((DiscreteOrderItem) order.getOrderItems().get(1)).getSku().setSalePrice(null);
6e207b6b2ab148a7d7dbd97d657c63c9713181d9,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,order.getOrderItems().get(0).setSalePrice(new Money(1D));
6e207b6b2ab148a7d7dbd97d657c63c9713181d9,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,order.getOrderItems().get(1).setSalePrice(new Money(1D));
6e207b6b2ab148a7d7dbd97d657c63c9713181d9,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,order.getOrderItems().get(1).setSalePrice(new Money(10D));
6e207b6b2ab148a7d7dbd97d657c63c9713181d9,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,order.getOrderItems().get(1).setSalePrice(null);
106b2a588c30fd5d9a1f232f451d34955e9bb48e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.springframework.web.filter.OncePerRequestFilter;
106b2a588c30fd5d9a1f232f451d34955e9bb48e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,public class CartStateFilter extends OncePerRequestFilter implements Ordered {
106b2a588c30fd5d9a1f232f451d34955e9bb48e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"public void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain chain)"
106b2a588c30fd5d9a1f232f451d34955e9bb48e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"cartStateProcessor.process(new ServletWebRequest(request, response));"
106b2a588c30fd5d9a1f232f451d34955e9bb48e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import org.springframework.web.filter.GenericFilterBean;
106b2a588c30fd5d9a1f232f451d34955e9bb48e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import javax.servlet.ServletResponse;
106b2a588c30fd5d9a1f232f451d34955e9bb48e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,public class CartStateFilter extends GenericFilterBean implements  Ordered {
106b2a588c30fd5d9a1f232f451d34955e9bb48e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)"
106b2a588c30fd5d9a1f232f451d34955e9bb48e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"cartStateProcessor.process(new ServletWebRequest((HttpServletRequest) request, (HttpServletResponse) response));"
6ef5eab7e272fc2b72a9022a0c178d830fc707fc,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import org.apache.commons.lang3.ArrayUtils;
6ef5eab7e272fc2b72a9022a0c178d830fc707fc,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"if (ArrayUtils.contains(p.getMetadata().getAvailableToTypes(), containingEntity.getType()[0])"
6ef5eab7e272fc2b72a9022a0c178d830fc707fc,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,&& p.getMetadata() instanceof CollectionMetadata) {
6ef5eab7e272fc2b72a9022a0c178d830fc707fc,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,if (p.getMetadata() instanceof CollectionMetadata) {
530232fc212c232d9cab4dca5fc4ff1762683375,1b397c5267574a2aa47352245db66860acb1f75e,added,0,if (toConvert != null) {
530232fc212c232d9cab4dca5fc4ff1762683375,1b397c5267574a2aa47352245db66860acb1f75e,added,0,"toConvert = toConvert.replaceAll("" "", ""-"");"
530232fc212c232d9cab4dca5fc4ff1762683375,1b397c5267574a2aa47352245db66860acb1f75e,added,0,"if (toConvert.matches("".*?\\W.*?"")) {"
530232fc212c232d9cab4dca5fc4ff1762683375,1b397c5267574a2aa47352245db66860acb1f75e,added,0,//remove all non-word characters
530232fc212c232d9cab4dca5fc4ff1762683375,1b397c5267574a2aa47352245db66860acb1f75e,added,0,"String result = toConvert.replaceAll(""[^\\w-]+"", """");"
530232fc212c232d9cab4dca5fc4ff1762683375,1b397c5267574a2aa47352245db66860acb1f75e,added,0,//uncapitalizes the first letter of the url key
530232fc212c232d9cab4dca5fc4ff1762683375,1b397c5267574a2aa47352245db66860acb1f75e,added,0,return StringUtils.uncapitalize(result);
530232fc212c232d9cab4dca5fc4ff1762683375,1b397c5267574a2aa47352245db66860acb1f75e,added,0,} else {
530232fc212c232d9cab4dca5fc4ff1762683375,1b397c5267574a2aa47352245db66860acb1f75e,added,0,return StringUtils.uncapitalize(toConvert);
530232fc212c232d9cab4dca5fc4ff1762683375,1b397c5267574a2aa47352245db66860acb1f75e,added,0,}
530232fc212c232d9cab4dca5fc4ff1762683375,1b397c5267574a2aa47352245db66860acb1f75e,added,0,return toConvert;
530232fc212c232d9cab4dca5fc4ff1762683375,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"if (toConvert.matches("".*?\\W.*?"")) {"
530232fc212c232d9cab4dca5fc4ff1762683375,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,//remove all non-word characters
530232fc212c232d9cab4dca5fc4ff1762683375,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"String result = toConvert.replaceAll(""\\W"","""");"
530232fc212c232d9cab4dca5fc4ff1762683375,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,//uncapitalizes the first letter of the url key
530232fc212c232d9cab4dca5fc4ff1762683375,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,return StringUtils.uncapitalize(result);
530232fc212c232d9cab4dca5fc4ff1762683375,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,} else {
530232fc212c232d9cab4dca5fc4ff1762683375,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,return StringUtils.uncapitalize(toConvert);
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.AdminPresentation;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationClass;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationCollection;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationMap;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.PopulateToOneFieldsEnum;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.hibernate.annotations.BatchSize;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.hibernate.annotations.CacheConcurrencyStrategy;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.hibernate.annotations.Cascade;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.hibernate.annotations.Index;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.hibernate.annotations.Where;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.CascadeType;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.Column;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.Embedded;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.Entity;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.EntityListeners;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.FetchType;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.Id;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.Inheritance;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.InheritanceType;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.JoinColumn;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.ManyToOne;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.MapKey;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.OneToMany;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.Table;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.Transient;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@DirectCopyTransformMember(templateTokens = DirectCopyTransformTypes.PREVIEW, skipOverlaps = true),"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""CustomerImpl_First_Name"", order = 2000, group = ""CustomerImpl_Customer"","
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""CustomerImpl_Last_Name"", order = 3000, group = ""CustomerImpl_Customer"","
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Index(name = ""CUSTOMER_CHALLENGE_INDEX"", columnNames = { ""CHALLENGE_QUESTION_ID"" })"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""CustomerImpl_Customer_Receive_Email"", order = 1000,"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""CustomerImpl_Customer_Deactivated"", order = 3000,"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"tab = Presentation.Tab.Name.Advanced, tabOrder = Presentation.Tab.Order.Advanced)"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""CustomerImpl_Customer_Locale"", order = 4000,"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"excluded = true, visibility = VisibilityEnum.GRID_HIDDEN)"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@OneToMany(fetch = FetchType.EAGER, mappedBy = ""customer"", targetEntity = CustomerAttributeImpl.class, cascade = { CascadeType.ALL }, orphanRemoval = true)"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Cache(usage = CacheConcurrencyStrategy.NONSTRICT_READ_WRITE, region = ""blStandardElements"")"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@MapKey(name = ""name"")"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@OneToMany(mappedBy = ""customer"", targetEntity = CustomerAddressImpl.class, cascade = { CascadeType.ALL })"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Cascade(value = { org.hibernate.annotations.CascadeType.ALL, org.hibernate.annotations.CascadeType.DELETE_ORPHAN })"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region = ""blStandardElements"")"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@OneToMany(mappedBy = ""customer"", targetEntity = CustomerPhoneImpl.class, cascade = { CascadeType.ALL })"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@OneToMany(mappedBy = ""customer"", targetEntity = CustomerPaymentImpl.class, cascade = { CascadeType.ALL })"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected List<CustomerPayment> customerPayments = new ArrayList<CustomerPayment>();
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,for (CustomerAddress entry : customerAddresses) {
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"for (Map.Entry<String, CustomerAttribute> entry : customerAttributes.entrySet()) {"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"cloned.getCustomerAttributes().put(entry.getKey(), clonedEntry);"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,for (CustomerPayment entry : customerPayments) {
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,for (CustomerPhone entry : customerPhones) {
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.presentation.*;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.hibernate.annotations.*;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.CascadeType;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.*;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Entity;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Table;
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@DirectCopyTransformMember(templateTokens = DirectCopyTransformTypes.PREVIEW, skipOverlaps=true),"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""CustomerImpl_First_Name"", order = 2000, group = ""CustomerImpl_Customer"","
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""CustomerImpl_Last_Name"", order = 3000, group = ""CustomerImpl_Customer"","
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""CUSTOMER_CHALLENGE_INDEX"", columnNames={""CHALLENGE_QUESTION_ID""})"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""CustomerImpl_Customer_Receive_Email"",order=1000,"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""CustomerImpl_Customer_Deactivated"", order=3000,"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"tab = Presentation.Tab.Name.Advanced, tabOrder = Presentation.Tab.Order.Advanced)"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""CustomerImpl_Customer_Locale"",order=4000,"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"excluded = true, visibility = VisibilityEnum.GRID_HIDDEN)"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@OneToMany(mappedBy = ""customer"", targetEntity = CustomerAttributeImpl.class, cascade = { CascadeType.ALL }, orphanRemoval = true)"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Cache(usage=CacheConcurrencyStrategy.NONSTRICT_READ_WRITE, region=""blStandardElements"")"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@MapKey(name=""name"")"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"tab = Presentation.Tab.Name.Advanced, tabOrder = Presentation.Tab.Order.Advanced"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,)
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@OneToMany(mappedBy = ""customer"", targetEntity = CustomerAddressImpl.class, cascade = {CascadeType.ALL})"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Cascade(value={org.hibernate.annotations.CascadeType.ALL, org.hibernate.annotations.CascadeType.DELETE_ORPHAN})"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region=""blStandardElements"")"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@OneToMany(mappedBy = ""customer"", targetEntity = CustomerPhoneImpl.class, cascade = {CascadeType.ALL})"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@OneToMany(mappedBy = ""customer"", targetEntity = CustomerPaymentImpl.class, cascade = {CascadeType.ALL})"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected List<CustomerPayment> customerPayments  = new ArrayList<CustomerPayment>();
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,for(CustomerAddress entry : customerAddresses){
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"for(Map.Entry<String, CustomerAttribute> entry : customerAttributes.entrySet()){"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"cloned.getCustomerAttributes().put(entry.getKey(),clonedEntry);"
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,for(CustomerPayment entry : customerPayments){
900c49f6b22ea1440b8c3d6003b969bef0c1ef9b,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,for(CustomerPhone entry : customerPhones){
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.*;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.hibernate.annotations.*;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.CascadeType;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.*;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.Entity;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.Table;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@DirectCopyTransformMember(templateTokens = DirectCopyTransformTypes.PREVIEW, skipOverlaps=true),"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""CustomerImpl_First_Name"", order = 2000, group = ""CustomerImpl_Customer"","
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""CustomerImpl_Last_Name"", order = 3000, group = ""CustomerImpl_Customer"","
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Index(name=""CUSTOMER_CHALLENGE_INDEX"", columnNames={""CHALLENGE_QUESTION_ID""})"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""CustomerImpl_Customer_Receive_Email"",order=1000,"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""CustomerImpl_Customer_Deactivated"", order=3000,"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"tab = Presentation.Tab.Name.Advanced, tabOrder = Presentation.Tab.Order.Advanced)"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""CustomerImpl_Customer_Locale"",order=4000,"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"excluded = true, visibility = VisibilityEnum.GRID_HIDDEN)"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@OneToMany(mappedBy = ""customer"", targetEntity = CustomerAttributeImpl.class, cascade = { CascadeType.ALL }, orphanRemoval = true)"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Cache(usage=CacheConcurrencyStrategy.NONSTRICT_READ_WRITE, region=""blStandardElements"")"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@MapKey(name=""name"")"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"tab = Presentation.Tab.Name.Advanced, tabOrder = Presentation.Tab.Order.Advanced"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,)
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@OneToMany(mappedBy = ""customer"", targetEntity = CustomerAddressImpl.class, cascade = {CascadeType.ALL})"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Cascade(value={org.hibernate.annotations.CascadeType.ALL, org.hibernate.annotations.CascadeType.DELETE_ORPHAN})"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region=""blStandardElements"")"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@OneToMany(mappedBy = ""customer"", targetEntity = CustomerPhoneImpl.class, cascade = {CascadeType.ALL})"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@OneToMany(mappedBy = ""customer"", targetEntity = CustomerPaymentImpl.class, cascade = {CascadeType.ALL})"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected List<CustomerPayment> customerPayments  = new ArrayList<CustomerPayment>();
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,for(CustomerAddress entry : customerAddresses){
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"for(Map.Entry<String, CustomerAttribute> entry : customerAttributes.entrySet()){"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"cloned.getCustomerAttributes().put(entry.getKey(),clonedEntry);"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,for(CustomerPayment entry : customerPayments){
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,for(CustomerPhone entry : customerPhones){
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentation;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentationClass;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentationCollection;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentationMap;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.presentation.PopulateToOneFieldsEnum;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.hibernate.annotations.BatchSize;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.hibernate.annotations.CacheConcurrencyStrategy;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.hibernate.annotations.Cascade;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.hibernate.annotations.Index;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.hibernate.annotations.Where;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.CascadeType;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Column;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Embedded;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Entity;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.EntityListeners;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.FetchType;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Id;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Inheritance;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.InheritanceType;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.JoinColumn;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.ManyToOne;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.MapKey;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.OneToMany;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Table;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Transient;
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@DirectCopyTransformMember(templateTokens = DirectCopyTransformTypes.PREVIEW, skipOverlaps = true),"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""CustomerImpl_First_Name"", order = 2000, group = ""CustomerImpl_Customer"","
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""CustomerImpl_Last_Name"", order = 3000, group = ""CustomerImpl_Customer"","
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name = ""CUSTOMER_CHALLENGE_INDEX"", columnNames = { ""CHALLENGE_QUESTION_ID"" })"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""CustomerImpl_Customer_Receive_Email"", order = 1000,"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""CustomerImpl_Customer_Deactivated"", order = 3000,"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"tab = Presentation.Tab.Name.Advanced, tabOrder = Presentation.Tab.Order.Advanced)"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""CustomerImpl_Customer_Locale"", order = 4000,"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"excluded = true, visibility = VisibilityEnum.GRID_HIDDEN)"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@OneToMany(fetch = FetchType.EAGER, mappedBy = ""customer"", targetEntity = CustomerAttributeImpl.class, cascade = { CascadeType.ALL }, orphanRemoval = true)"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Cache(usage = CacheConcurrencyStrategy.NONSTRICT_READ_WRITE, region = ""blStandardElements"")"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@MapKey(name = ""name"")"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@OneToMany(mappedBy = ""customer"", targetEntity = CustomerAddressImpl.class, cascade = { CascadeType.ALL })"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Cascade(value = { org.hibernate.annotations.CascadeType.ALL, org.hibernate.annotations.CascadeType.DELETE_ORPHAN })"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region = ""blStandardElements"")"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@OneToMany(mappedBy = ""customer"", targetEntity = CustomerPhoneImpl.class, cascade = { CascadeType.ALL })"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@OneToMany(mappedBy = ""customer"", targetEntity = CustomerPaymentImpl.class, cascade = { CascadeType.ALL })"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected List<CustomerPayment> customerPayments = new ArrayList<CustomerPayment>();
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,for (CustomerAddress entry : customerAddresses) {
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"for (Map.Entry<String, CustomerAttribute> entry : customerAttributes.entrySet()) {"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"cloned.getCustomerAttributes().put(entry.getKey(), clonedEntry);"
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,for (CustomerPayment entry : customerPayments) {
8390ed7f8a85cecc7190d8d02946b3958aafb150,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,for (CustomerPhone entry : customerPhones) {
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.AdminPresentation;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationClass;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationCollection;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationMap;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.PopulateToOneFieldsEnum;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.hibernate.annotations.BatchSize;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.hibernate.annotations.CacheConcurrencyStrategy;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.hibernate.annotations.Cascade;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.hibernate.annotations.Index;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.hibernate.annotations.Where;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.CascadeType;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.Column;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.Embedded;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.Entity;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.EntityListeners;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.FetchType;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.Id;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.Inheritance;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.InheritanceType;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.JoinColumn;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.ManyToOne;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.MapKey;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.OneToMany;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.Table;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.Transient;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@DirectCopyTransformMember(templateTokens = DirectCopyTransformTypes.PREVIEW, skipOverlaps = true),"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""CustomerImpl_First_Name"", order = 2000, group = ""CustomerImpl_Customer"","
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""CustomerImpl_Last_Name"", order = 3000, group = ""CustomerImpl_Customer"","
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Index(name = ""CUSTOMER_CHALLENGE_INDEX"", columnNames = { ""CHALLENGE_QUESTION_ID"" })"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""CustomerImpl_Customer_Receive_Email"", order = 1000,"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""CustomerImpl_Customer_Deactivated"", order = 3000,"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"tab = Presentation.Tab.Name.Advanced, tabOrder = Presentation.Tab.Order.Advanced)"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""CustomerImpl_Customer_Locale"", order = 4000,"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"excluded = true, visibility = VisibilityEnum.GRID_HIDDEN)"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@OneToMany(fetch = FetchType.EAGER, mappedBy = ""customer"", targetEntity = CustomerAttributeImpl.class, cascade = { CascadeType.ALL }, orphanRemoval = true)"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Cache(usage = CacheConcurrencyStrategy.NONSTRICT_READ_WRITE, region = ""blStandardElements"")"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@MapKey(name = ""name"")"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@OneToMany(mappedBy = ""customer"", targetEntity = CustomerAddressImpl.class, cascade = { CascadeType.ALL })"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Cascade(value = { org.hibernate.annotations.CascadeType.ALL, org.hibernate.annotations.CascadeType.DELETE_ORPHAN })"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region = ""blStandardElements"")"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@OneToMany(mappedBy = ""customer"", targetEntity = CustomerPhoneImpl.class, cascade = { CascadeType.ALL })"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@OneToMany(mappedBy = ""customer"", targetEntity = CustomerPaymentImpl.class, cascade = { CascadeType.ALL })"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected List<CustomerPayment> customerPayments = new ArrayList<CustomerPayment>();
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,for (CustomerAddress entry : customerAddresses) {
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"for (Map.Entry<String, CustomerAttribute> entry : customerAttributes.entrySet()) {"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"cloned.getCustomerAttributes().put(entry.getKey(), clonedEntry);"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,for (CustomerPayment entry : customerPayments) {
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,for (CustomerPhone entry : customerPhones) {
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.presentation.*;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.hibernate.annotations.*;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.CascadeType;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.*;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Entity;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Table;
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@DirectCopyTransformMember(templateTokens = DirectCopyTransformTypes.PREVIEW, skipOverlaps=true),"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""CustomerImpl_First_Name"", order = 2000, group = ""CustomerImpl_Customer"","
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""CustomerImpl_Last_Name"", order = 3000, group = ""CustomerImpl_Customer"","
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""CUSTOMER_CHALLENGE_INDEX"", columnNames={""CHALLENGE_QUESTION_ID""})"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""CustomerImpl_Customer_Receive_Email"",order=1000,"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""CustomerImpl_Customer_Deactivated"", order=3000,"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"tab = Presentation.Tab.Name.Advanced, tabOrder = Presentation.Tab.Order.Advanced)"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""CustomerImpl_Customer_Locale"",order=4000,"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"excluded = true, visibility = VisibilityEnum.GRID_HIDDEN)"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@OneToMany(mappedBy = ""customer"", targetEntity = CustomerAttributeImpl.class, cascade = { CascadeType.ALL }, orphanRemoval = true)"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Cache(usage=CacheConcurrencyStrategy.NONSTRICT_READ_WRITE, region=""blStandardElements"")"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@MapKey(name=""name"")"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"tab = Presentation.Tab.Name.Advanced, tabOrder = Presentation.Tab.Order.Advanced"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,)
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@OneToMany(mappedBy = ""customer"", targetEntity = CustomerAddressImpl.class, cascade = {CascadeType.ALL})"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Cascade(value={org.hibernate.annotations.CascadeType.ALL, org.hibernate.annotations.CascadeType.DELETE_ORPHAN})"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region=""blStandardElements"")"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@OneToMany(mappedBy = ""customer"", targetEntity = CustomerPhoneImpl.class, cascade = {CascadeType.ALL})"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@OneToMany(mappedBy = ""customer"", targetEntity = CustomerPaymentImpl.class, cascade = {CascadeType.ALL})"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected List<CustomerPayment> customerPayments  = new ArrayList<CustomerPayment>();
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,for(CustomerAddress entry : customerAddresses){
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"for(Map.Entry<String, CustomerAttribute> entry : customerAttributes.entrySet()){"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"cloned.getCustomerAttributes().put(entry.getKey(),clonedEntry);"
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,for(CustomerPayment entry : customerPayments){
f1ef776ba650368ca472daae6945aae729a50cb3,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,for(CustomerPhone entry : customerPhones){
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.common.currency.domain.BroadleafRequestedCurrencyDto;
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,public BroadleafRequestedCurrencyDto resolveCurrency(HttpServletRequest request);
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,public BroadleafRequestedCurrencyDto resolveCurrency(WebRequest request);
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import org.broadleafcommerce.common.currency.domain.BroadleafCurrency;
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,public BroadleafCurrency resolveCurrency(HttpServletRequest request);
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,public BroadleafCurrency resolveCurrency(WebRequest request);
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.common.currency.domain.BroadleafRequestedCurrencyDto;
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,public BroadleafRequestedCurrencyDto resolveCurrency(HttpServletRequest request) {
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,public BroadleafRequestedCurrencyDto resolveCurrency(WebRequest request) {
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"BroadleafRequestedCurrencyDto dto = new BroadleafRequestedCurrencyDto(currencyToUse, desiredCurrency);"
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,return dto;
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import org.broadleafcommerce.common.extension.ExtensionResultHolder;
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import org.broadleafcommerce.common.extension.currency.CurrencyResolverExtensionManager;
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"@Resource(name = ""blCurrencyResolverExtensionManager"")"
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,protected CurrencyResolverExtensionManager extensionManager;
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,public BroadleafCurrency resolveCurrency(HttpServletRequest request) {
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,public BroadleafCurrency resolveCurrency(WebRequest request) {
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,// Allow extension managers (like enterprise pricing) to indicate whether additional currency support is
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,// available.
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (extensionManager != null) {
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,ExtensionResultHolder<BroadleafCurrency> resultHolder = new ExtensionResultHolder<BroadleafCurrency>();
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"extensionManager.getProxy().overrideCurrency(desiredCurrency, defaultCurrency, resultHolder);"
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (resultHolder != null && resultHolder.getResult() != null) {
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,currencyToUse = resultHolder.getResult();
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,}
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,return currencyToUse;
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.common.currency.domain.BroadleafRequestedCurrencyDto;
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,BroadleafRequestedCurrencyDto currencyDto = currencyResolver.resolveCurrency(request);
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (currencyDto != null) {
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,brc.setBroadleafCurrency(currencyDto.getCurrencyToUse());
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,brc.setRequestedBroadleafCurrency(currencyDto.getRequestedCurrency());
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,}
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import org.broadleafcommerce.common.currency.domain.BroadleafCurrency;
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,BroadleafCurrency currency = currencyResolver.resolveCurrency(request);
39139aff4164e7fe4726259f4926e4db96a2271e,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,brc.setBroadleafCurrency(currency);
534723a52e50da6cc9ee8a9e5655b437d1db6cac,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.springframework.web.filter.OncePerRequestFilter;
534723a52e50da6cc9ee8a9e5655b437d1db6cac,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import java.io.IOException;
534723a52e50da6cc9ee8a9e5655b437d1db6cac,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,public class CustomerStateFilter extends OncePerRequestFilter implements Ordered {
534723a52e50da6cc9ee8a9e5655b437d1db6cac,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"public void doFilterInternal(HttpServletRequest baseRequest, HttpServletResponse baseResponse, FilterChain chain) throws IOException, ServletException {"
534723a52e50da6cc9ee8a9e5655b437d1db6cac,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"ServletWebRequest request = new ServletWebRequest(baseRequest, baseResponse);"
534723a52e50da6cc9ee8a9e5655b437d1db6cac,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,try {
534723a52e50da6cc9ee8a9e5655b437d1db6cac,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,customerStateProcessor.process(request);
534723a52e50da6cc9ee8a9e5655b437d1db6cac,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"chain.doFilter(baseRequest, baseResponse);"
534723a52e50da6cc9ee8a9e5655b437d1db6cac,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,} finally {
534723a52e50da6cc9ee8a9e5655b437d1db6cac,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,customerStateProcessor.postProcess(request);
534723a52e50da6cc9ee8a9e5655b437d1db6cac,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,}
534723a52e50da6cc9ee8a9e5655b437d1db6cac,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,@Override
534723a52e50da6cc9ee8a9e5655b437d1db6cac,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,protected boolean shouldNotFilterErrorDispatch() {
534723a52e50da6cc9ee8a9e5655b437d1db6cac,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,return false;
534723a52e50da6cc9ee8a9e5655b437d1db6cac,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import org.springframework.web.filter.GenericFilterBean;
534723a52e50da6cc9ee8a9e5655b437d1db6cac,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import javax.servlet.ServletRequest;
534723a52e50da6cc9ee8a9e5655b437d1db6cac,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import javax.servlet.ServletResponse;
534723a52e50da6cc9ee8a9e5655b437d1db6cac,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import java.io.IOException;
534723a52e50da6cc9ee8a9e5655b437d1db6cac,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,public class CustomerStateFilter extends GenericFilterBean implements Ordered {
534723a52e50da6cc9ee8a9e5655b437d1db6cac,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"public void doFilter(ServletRequest baseRequest, ServletResponse baseResponse, FilterChain chain) throws IOException, ServletException {"
534723a52e50da6cc9ee8a9e5655b437d1db6cac,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"customerStateProcessor.process(new ServletWebRequest((HttpServletRequest) baseRequest, (HttpServletResponse)baseResponse));"
534723a52e50da6cc9ee8a9e5655b437d1db6cac,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"chain.doFilter(baseRequest, baseResponse);"
944d8c5274ac9b5f46abb09e9d3e9aca65cd000d,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,protected boolean updateSalePrice() {
944d8c5274ac9b5f46abb09e9d3e9aca65cd000d,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,}
944d8c5274ac9b5f46abb09e9d3e9aca65cd000d,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,if (skuSalePrice == null) {
944d8c5274ac9b5f46abb09e9d3e9aca65cd000d,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,protected boolean updateRetailPrice() {
944d8c5274ac9b5f46abb09e9d3e9aca65cd000d,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,private boolean updateSalePrice() {
944d8c5274ac9b5f46abb09e9d3e9aca65cd000d,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,} else {
944d8c5274ac9b5f46abb09e9d3e9aca65cd000d,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,private boolean updateRetailPrice() {
844767fcd4198a37cd5f1415a465ef9d8c32995e,6558449642df426ae19cc33e9eddc3e94a573139,added,0,import java.util.Collections;
844767fcd4198a37cd5f1415a465ef9d8c32995e,6558449642df426ae19cc33e9eddc3e94a573139,added,0,"protected static final Map<BatchPersistencePackage, BatchDynamicResultSet> METADATA_CACHE = Collections.synchronizedMap(new LRUMap<BatchPersistencePackage, BatchDynamicResultSet>(1000));"
844767fcd4198a37cd5f1415a465ef9d8c32995e,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,import org.apache.commons.collections.MapUtils;
844767fcd4198a37cd5f1415a465ef9d8c32995e,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,import org.broadleafcommerce.common.exception.ExceptionHelper;
844767fcd4198a37cd5f1415a465ef9d8c32995e,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,import org.hibernate.exception.LockAcquisitionException;
844767fcd4198a37cd5f1415a465ef9d8c32995e,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,import org.springframework.transaction.annotation.Transactional;
844767fcd4198a37cd5f1415a465ef9d8c32995e,6558449642df426ae19cc33e9eddc3e94a573139,deleted,1,"protected static final Map<BatchPersistencePackage, BatchDynamicResultSet> METADATA_CACHE = MapUtils.synchronizedMap(new LRUMap<BatchPersistencePackage, BatchDynamicResultSet>(100, 1000));"
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"private static final String LAST_PUBLISHED_EVENT_CLASS_SESSION_ATTRIBUTE_NAME = ""_blc_lastPublishedEventClass"";"
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"private static final String LAST_PUBLISHED_EVENT_USERNAME_SESSION_ATTRIBUTE_NAME = ""_blc_lastPublishedEventUsername"";"
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"String lastPublishedEventClass = (String) BLCRequestUtils.getSessionAttributeIfOk(request, LAST_PUBLISHED_EVENT_CLASS_SESSION_ATTRIBUTE_NAME);"
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"String eventUsername = (String) BLCRequestUtils.getSessionAttributeIfOk(request, LAST_PUBLISHED_EVENT_USERNAME_SESSION_ATTRIBUTE_NAME);"
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (CustomerAuthenticatedFromCookieEvent.class.getName().equals(lastPublishedEventClass)) {
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (userName.equals(eventUsername)) {
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"CustomerAuthenticatedFromCookieEvent cookieEvent = new CustomerAuthenticatedFromCookieEvent(customer, this.getClass().getName());"
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"publishEvent(cookieEvent, request, CustomerAuthenticatedFromCookieEvent.class.getName(), userName);"
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,}
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (CustomerLoggedInEvent.class.getName().equals(lastPublishedEventClass)) {
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"publishEvent(loggedInEvent, request, CustomerLoggedInEvent.class.getName(), userName);"
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"protected void publishEvent(ApplicationEvent event, WebRequest request, String eventClass, String username) {"
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,eventPublisher.publishEvent(event);
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"BLCRequestUtils.setSessionAttributeIfOk(request, LAST_PUBLISHED_EVENT_CLASS_SESSION_ATTRIBUTE_NAME, eventClass);"
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"BLCRequestUtils.setSessionAttributeIfOk(request, LAST_PUBLISHED_EVENT_USERNAME_SESSION_ATTRIBUTE_NAME, username);"
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"private static final String LAST_PUBLISHED_EVENT_SESSION_ATTRIBUTED_NAME = ""_blc_lastPublishedEvent"";"
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"ApplicationEvent lastPublishedEvent = (ApplicationEvent) BLCRequestUtils.getSessionAttributeIfOk(request, LAST_PUBLISHED_EVENT_SESSION_ATTRIBUTED_NAME);"
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (lastPublishedEvent != null && lastPublishedEvent instanceof CustomerAuthenticatedFromCookieEvent) {
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,CustomerAuthenticatedFromCookieEvent cookieEvent = (CustomerAuthenticatedFromCookieEvent) lastPublishedEvent;
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (userName.equals(cookieEvent.getCustomer().getUsername())) {
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"CustomerAuthenticatedFromCookieEvent cookieEvent = new CustomerAuthenticatedFromCookieEvent(customer, this.getClass().getName());"
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,eventPublisher.publishEvent(cookieEvent);
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"BLCRequestUtils.setSessionAttributeIfOk(request, LAST_PUBLISHED_EVENT_SESSION_ATTRIBUTED_NAME, cookieEvent);"
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,}
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (lastPublishedEvent != null && lastPublishedEvent instanceof CustomerLoggedInEvent) {
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,CustomerLoggedInEvent loggedInEvent = (CustomerLoggedInEvent) lastPublishedEvent;
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (userName.equals(loggedInEvent.getCustomer().getUsername())) {
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,eventPublisher.publishEvent(loggedInEvent);
7c7c120cd447855776431dfbde3bdae932dde10f,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"BLCRequestUtils.setSessionAttributeIfOk(request, LAST_PUBLISHED_EVENT_SESSION_ATTRIBUTED_NAME, loggedInEvent);"
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"private static final String LAST_PUBLISHED_EVENT_CLASS_SESSION_ATTRIBUTE_NAME = ""_blc_lastPublishedEventClass"";"
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"private static final String LAST_PUBLISHED_EVENT_USERNAME_SESSION_ATTRIBUTE_NAME = ""_blc_lastPublishedEventUsername"";"
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"String lastPublishedEventClass = (String) BLCRequestUtils.getSessionAttributeIfOk(request, LAST_PUBLISHED_EVENT_CLASS_SESSION_ATTRIBUTE_NAME);"
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"String eventUsername = (String) BLCRequestUtils.getSessionAttributeIfOk(request, LAST_PUBLISHED_EVENT_USERNAME_SESSION_ATTRIBUTE_NAME);"
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (CustomerAuthenticatedFromCookieEvent.class.getName().equals(lastPublishedEventClass)) {
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (userName.equals(eventUsername)) {
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"CustomerAuthenticatedFromCookieEvent cookieEvent = new CustomerAuthenticatedFromCookieEvent(customer, this.getClass().getName());"
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"publishEvent(cookieEvent, request, CustomerAuthenticatedFromCookieEvent.class.getName(), userName);"
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,}
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,if (CustomerLoggedInEvent.class.getName().equals(lastPublishedEventClass)) {
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"publishEvent(loggedInEvent, request, CustomerLoggedInEvent.class.getName(), userName);"
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"protected void publishEvent(ApplicationEvent event, WebRequest request, String eventClass, String username) {"
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,eventPublisher.publishEvent(event);
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"BLCRequestUtils.setSessionAttributeIfOk(request, LAST_PUBLISHED_EVENT_CLASS_SESSION_ATTRIBUTE_NAME, eventClass);"
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"BLCRequestUtils.setSessionAttributeIfOk(request, LAST_PUBLISHED_EVENT_USERNAME_SESSION_ATTRIBUTE_NAME, username);"
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"private static final String LAST_PUBLISHED_EVENT_SESSION_ATTRIBUTED_NAME = ""_blc_lastPublishedEvent"";"
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"ApplicationEvent lastPublishedEvent = (ApplicationEvent) BLCRequestUtils.getSessionAttributeIfOk(request, LAST_PUBLISHED_EVENT_SESSION_ATTRIBUTED_NAME);"
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (lastPublishedEvent != null && lastPublishedEvent instanceof CustomerAuthenticatedFromCookieEvent) {
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,CustomerAuthenticatedFromCookieEvent cookieEvent = (CustomerAuthenticatedFromCookieEvent) lastPublishedEvent;
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (userName.equals(cookieEvent.getCustomer().getUsername())) {
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"CustomerAuthenticatedFromCookieEvent cookieEvent = new CustomerAuthenticatedFromCookieEvent(customer, this.getClass().getName());"
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,eventPublisher.publishEvent(cookieEvent);
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"BLCRequestUtils.setSessionAttributeIfOk(request, LAST_PUBLISHED_EVENT_SESSION_ATTRIBUTED_NAME, cookieEvent);"
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,}
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (lastPublishedEvent != null && lastPublishedEvent instanceof CustomerLoggedInEvent) {
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,CustomerLoggedInEvent loggedInEvent = (CustomerLoggedInEvent) lastPublishedEvent;
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,if (userName.equals(loggedInEvent.getCustomer().getUsername())) {
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,eventPublisher.publishEvent(loggedInEvent);
dae7d653fa7c324c19e16c6577dc04aa5eee7671,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"BLCRequestUtils.setSessionAttributeIfOk(request, LAST_PUBLISHED_EVENT_SESSION_ATTRIBUTED_NAME, loggedInEvent);"
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,// These actions will start greyed out and unable to be clicked until a specific row has been selected
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,protected List<ListGridAction> modalRowActions = new ArrayList<ListGridAction>();
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,protected String listGridSelectType;
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,public enum SelectType {
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"SINGLE_SELECT,"
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"MULTI_SELECT,"
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,}
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,/**
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,* Grabs a filtered list of row actions filtered by whether or not they match the same readonly state as the listgrid
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,* and are thus shown on the screen
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,*/
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"@SuppressWarnings(""unchecked"")"
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,public List<ListGridAction> getActiveModalRowActions() {
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"return (List<ListGridAction>) CollectionUtils.select(getModalRowActions(), new TypedPredicate<ListGridAction>() {"
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,@Override
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,public boolean eval(ListGridAction action) {
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,return action.getForListGridReadOnly().equals(getReadOnly());
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,});
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,public void addModalRowAction(ListGridAction action) {
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,getModalRowActions().add(action);
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,public void removeAllModalRowActions() {
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,getModalRowActions().clear();
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,public ListGridAction findModalRowAction(String actionId) {
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,for (ListGridAction action : getModalRowActions()) {
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,if (action.getActionId().equals(actionId)) {
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,return action;
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,return null;
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,public void setListGridSelectType(SelectType listGridSelectType) {
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,this.listGridSelectType = listGridSelectType.toString().toLowerCase();
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,public void setListGridSelectTypeString(String listGridSelectType) {
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,this.listGridSelectType = listGridSelectType;
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,public List<ListGridAction> getModalRowActions() {
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,return modalRowActions;
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,public void setModalRowActions(List<ListGridAction> modalRowActions) {
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,this.modalRowActions = modalRowActions;
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,public String getListGridSelectType() {
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,return listGridSelectType;
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"INLINE,"
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"INLINEMULTI,"
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import org.broadleafcommerce.openadmin.web.form.component.ListGridAction;
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,boolean modalSingleSelectable = false;
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,boolean modalMultiSelectable = false;
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,modalSingleSelectable = true;
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,} else {
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,modalMultiSelectable = true;
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,if (modalSingleSelectable) {
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,listGrid.addModalRowAction(DefaultListGridActions.SINGLE_SELECT);
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,}
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,listGrid.setListGridSelectType(ListGrid.SelectType.SINGLE_SELECT);
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,if (modalMultiSelectable) {
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,listGrid.addModalRowAction(DefaultListGridActions.MULTI_SELECT);
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,listGrid.setListGridSelectType(ListGrid.SelectType.MULTI_SELECT);
61206d52ed07433b1cf72326c7925c3648327657,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,listGrid.setListGridType(ListGrid.Type.INLINE);
d43e5ea14a0cdb117793e04a688d2bbcb9e16917,72845c3269dc77fbef5e81a155ea2b074d0aeace,added,0,public ExtensionResultStatusType startBatchEvent(List<Product> products) {
d43e5ea14a0cdb117793e04a688d2bbcb9e16917,72845c3269dc77fbef5e81a155ea2b074d0aeace,added,0,public ExtensionResultStatusType endBatchEvent() {
d43e5ea14a0cdb117793e04a688d2bbcb9e16917,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,public ExtensionResultStatusType endProductBatch(List<Product> products) {
d43e5ea14a0cdb117793e04a688d2bbcb9e16917,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,public ExtensionResultStatusType closeContexts() {
d43e5ea14a0cdb117793e04a688d2bbcb9e16917,72845c3269dc77fbef5e81a155ea2b074d0aeace,added,0,extensionManager.getProxy().startBatchEvent(products);
d43e5ea14a0cdb117793e04a688d2bbcb9e16917,72845c3269dc77fbef5e81a155ea2b074d0aeace,added,0,extensionManager.getProxy().endBatchEvent();
d43e5ea14a0cdb117793e04a688d2bbcb9e16917,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,extensionManager.getProxy().endProductBatch(products);
d43e5ea14a0cdb117793e04a688d2bbcb9e16917,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,extensionManager.getProxy().closeContexts();
d43e5ea14a0cdb117793e04a688d2bbcb9e16917,72845c3269dc77fbef5e81a155ea2b074d0aeace,added,0,* Perform actions at the start of a batch to improve performance of Solr search for the list of batch products.
d43e5ea14a0cdb117793e04a688d2bbcb9e16917,72845c3269dc77fbef5e81a155ea2b074d0aeace,added,0,"* For example we want to get, in bulk, the SkuPriceData for each product and save these in memory by default."
d43e5ea14a0cdb117793e04a688d2bbcb9e16917,72845c3269dc77fbef5e81a155ea2b074d0aeace,added,0,public ExtensionResultStatusType startBatchEvent(List<Product> products);
d43e5ea14a0cdb117793e04a688d2bbcb9e16917,72845c3269dc77fbef5e81a155ea2b074d0aeace,added,0,"* Perform actions to end a batch event, such as closing any Contexts that have been previously created."
d43e5ea14a0cdb117793e04a688d2bbcb9e16917,72845c3269dc77fbef5e81a155ea2b074d0aeace,added,0,public ExtensionResultStatusType endBatchEvent();
d43e5ea14a0cdb117793e04a688d2bbcb9e16917,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,"* To improve performance of Solr search for the list of batch products.  For example we want to get, in bulk,"
d43e5ea14a0cdb117793e04a688d2bbcb9e16917,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,* the SkuPriceData for each product and save these in memory by default.
d43e5ea14a0cdb117793e04a688d2bbcb9e16917,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,public ExtensionResultStatusType endProductBatch(List<Product> products);
d43e5ea14a0cdb117793e04a688d2bbcb9e16917,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,* Close any Contexts that have been previously created.
d43e5ea14a0cdb117793e04a688d2bbcb9e16917,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,public ExtensionResultStatusType closeContexts();
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import org.broadleafcommerce.openadmin.dto.GroupMetadata;
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import org.broadleafcommerce.openadmin.dto.TabMetadata;
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,public static final Integer DEFAULT_COLUMN = 0;
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,FieldGroup fieldGroup = findGroup(groupName);
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,Tab tab = findTab(tabName);
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,if (tab == null) {
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,tab = new Tab();
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,tab.setTitle(tabName);
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,tab.setOrder(tabOrder);
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,tabs.add(tab);
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,}
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,fieldGroup = tab.findGroup(groupName);
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,if (fieldGroup == null) {
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,fieldGroup = new FieldGroup();
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,fieldGroup.setTitle(groupName);
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,fieldGroup.setOrder(groupOrder);
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,tab.getFieldGroups().add(fieldGroup);
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,private FieldGroup findGroup(String groupName) {
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,FieldGroup fieldGroup = null;
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,for (Tab tab : tabs) {
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,if (fieldGroup != null) {
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,break;
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,return fieldGroup;
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public void addListGrid(ListGrid listGrid, String tabName, Integer tabOrder, String groupName, Integer groupOrder) {"
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"groupName = context.getMessageSource().getMessage(groupName, null, groupName, context.getJavaLocale());"
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,fieldGroup.getListGrids().add(listGrid);
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,} else if (fieldGroup == null && tab != null){
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,tab.getListGrids().add(listGrid);
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,} else {
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,public String addTabFromTabMetadata(TabMetadata tabMetadata) {
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,Tab newTab = new Tab();
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,newTab.setTitle(tabMetadata.getTabName());
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,newTab.setOrder(tabMetadata.getTabOrder());
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,BroadleafRequestContext context = BroadleafRequestContext.getBroadleafRequestContext();
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,if (context != null && context.getMessageSource() != null) {
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"newTab.setTitle(context.getMessageSource().getMessage(tabMetadata.getTabName(), null, tabMetadata.getTabName(), context.getJavaLocale()));"
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,tabs.add(newTab);
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,return newTab.getTitle();
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public void addGroupFromGroupMetadata(GroupMetadata groupMetadata, String processedTabName) {"
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,FieldGroup newGroup = new FieldGroup();
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,newGroup.setTitle(groupMetadata.getGroupName());
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,newGroup.setOrder(groupMetadata.getGroupOrder());
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,newGroup.setColumn(groupMetadata.getColumn());
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,newGroup.setIsBorderless(groupMetadata.getBorderless());
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,newGroup.setToolTip(groupMetadata.getTooltip());
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,newGroup.setCollapsed(groupMetadata.getCollapsed());
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"newGroup.setTitle(context.getMessageSource().getMessage(groupMetadata.getGroupName(), null, groupMetadata.getGroupName(), context.getJavaLocale()));"
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"newGroup.setToolTip(context.getMessageSource().getMessage(groupMetadata.getTooltip(), null, groupMetadata.getTooltip(), context.getJavaLocale()));"
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,Tab tab = findTab(processedTabName);
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,if (groupMetadata.getColumn() != DEFAULT_COLUMN) {
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,tab.setIsMultiColumn(true);
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,tab.getFieldGroups().add(newGroup);
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,Tab tab = findTab(tabName);
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,if (tab == null) {
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,tab = new Tab();
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,tab.setTitle(tabName);
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,tab.setOrder(tabOrder);
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,tabs.add(tab);
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,}
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,FieldGroup fieldGroup = tab.findGroup(groupName);
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,fieldGroup = new FieldGroup();
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,fieldGroup.setTitle(groupName);
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,fieldGroup.setOrder(groupOrder);
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,tab.getFieldGroups().add(fieldGroup);
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"public void addListGrid(ListGrid listGrid, String tabName, Integer tabOrder) {"
2489d3609b635cdab1b6ce0d55c1b891a612f054,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,tab.getListGrids().add(listGrid);
9282867d22f399646f9b5fb9aff8f986aeacb101,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"order = OfferAdminPresentation.GroupOrder.Amount),"
9282867d22f399646f9b5fb9aff8f986aeacb101,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"@AdminGroupPresentation(name = OfferAdminPresentation.GroupName.Codes,"
9282867d22f399646f9b5fb9aff8f986aeacb101,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"order = OfferAdminPresentation.GroupOrder.Codes, borderless = true)"
9282867d22f399646f9b5fb9aff8f986aeacb101,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"order = OfferAdminPresentation.GroupOrder.Description),"
9282867d22f399646f9b5fb9aff8f986aeacb101,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"@AdminGroupPresentation(order = OfferAdminPresentation.GroupOrder.Codes, borderless = true)"
97768729dbccd6c1dabe1e628cddc69ae2dcc869,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,"public void addListGrid(ListGrid listGrid, String tabName, Integer tabOrder, String groupName) {"
97768729dbccd6c1dabe1e628cddc69ae2dcc869,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,"public void addListGrid(ListGrid listGrid, String tabName, Integer tabOrder, String groupName, Integer groupOrder) {"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,/*
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,* #%L
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,* BroadleafCommerce Framework
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,* %%
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,* Copyright (C) 2009 - 2013 Broadleaf Commerce
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"* Licensed under the Apache License, Version 2.0 (the ""License"");"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,* you may not use this file except in compliance with the License.
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,* You may obtain a copy of the License at
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,*
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,*       http://www.apache.org/licenses/LICENSE-2.0
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"* Unless required by applicable law or agreed to in writing, software"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"* distributed under the License is distributed on an ""AS IS"" BASIS,"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,* See the License for the specific language governing permissions and
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,* limitations under the License.
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,* #L%
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,*/
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,package org.broadleafcommerce.core.order.domain;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@Entity
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@DiscriminatorColumn(name = ""TYPE"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@Inheritance(strategy = InheritanceType.JOINED)
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Table(name = ""BLC_FULFILLMENT_GROUP_ITEM"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Cache(usage=CacheConcurrencyStrategy.NONSTRICT_READ_WRITE, region=""blOrderElements"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@AdminPresentationMergeOverrides(
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,{
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeOverride(name = """", mergeEntries ="
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.READONLY,"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,booleanOverrideValue = true))
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,}
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,)
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"public class FulfillmentGroupItemImpl implements FulfillmentGroupItem, Cloneable, CurrencyCodeIdentifiable {"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,private static final Log LOG = LogFactory.getLog(FulfillmentGroupItemImpl.class);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,private static final long serialVersionUID = 1L;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@Id
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@GeneratedValue(generator = ""FulfillmentGroupItemId"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@GenericGenerator(
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"name=""FulfillmentGroupItemId"","
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"strategy=""org.broadleafcommerce.common.persistence.IdOverrideTableGenerator"","
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,parameters = {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Parameter(name=""segment_value"", value=""FulfillmentGroupItemImpl""),"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Parameter(name=""entity_name"", value=""org.broadleafcommerce.core.order.domain.FulfillmentGroupItemImpl"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""FULFILLMENT_GROUP_ITEM_ID"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected Long id;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@ManyToOne(targetEntity = FulfillmentGroupImpl.class, optional=false)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@JoinColumn(name = ""FULFILLMENT_GROUP_ID"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Index(name=""FGITEM_FG_INDEX"", columnNames={""FULFILLMENT_GROUP_ID""})"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected FulfillmentGroup fulfillmentGroup;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,//this needs to stay OrderItem in order to provide backwards compatibility for those implementations that place a BundleOrderItem
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@ManyToOne(targetEntity = OrderItemImpl.class, optional=false)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@JoinColumn(name = ""ORDER_ITEM_ID"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Order_Item"", prominent = true, order = 1000, gridOrder = 1000)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@AdminPresentationToOneLookup()
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected OrderItem orderItem;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""QUANTITY"", nullable=false)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Quantity"", prominent = true, order = 2000, gridOrder = 2000)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected int quantity;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""STATUS"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Index(name=""FGITEM_STATUS_INDEX"", columnNames={""STATUS""})"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Status"", prominent = true, order = 3000, gridOrder = 3000)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,private String status;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@OneToMany(fetch = FetchType.LAZY, targetEntity = TaxDetailImpl.class, cascade = { CascadeType.ALL }, orphanRemoval = true)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@JoinTable(name = ""BLC_FG_ITEM_TAX_XREF"", joinColumns = @JoinColumn(name = ""FULFILLMENT_GROUP_ITEM_ID""), inverseJoinColumns = @JoinColumn(name = ""TAX_DETAIL_ID""))"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected List<TaxDetail> taxes = new ArrayList<TaxDetail>();
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""TOTAL_ITEM_TAX"", precision=19, scale=5)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Total_Item_Tax"", order=4000, fieldType=SupportedFieldType.MONEY)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected BigDecimal totalTax;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""TOTAL_ITEM_AMOUNT"", precision = 19, scale = 5)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Total_Item_Amount"", order = 5000, fieldType = SupportedFieldType.MONEY)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected BigDecimal totalItemAmount;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""TOTAL_ITEM_TAXABLE_AMOUNT"", precision = 19, scale = 5)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Total_Item_Taxable_Amount"", order = 6000, fieldType = SupportedFieldType.MONEY)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected BigDecimal totalItemTaxableAmount;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""PRORATED_ORDER_ADJ"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Prorated_Adjustment"", order = 7000, fieldType = SupportedFieldType.MONEY)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected BigDecimal proratedOrderAdjustment;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@Override
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Long getId() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return id;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setId(Long id) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.id = id;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public FulfillmentGroup getFulfillmentGroup() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return fulfillmentGroup;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setFulfillmentGroup(FulfillmentGroup fulfillmentGroup) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.fulfillmentGroup = fulfillmentGroup;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public OrderItem getOrderItem() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return orderItem;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setOrderItem(OrderItem orderItem) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.orderItem = orderItem;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public int getQuantity() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return quantity;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setQuantity(int quantity) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.quantity = quantity;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Money getRetailPrice() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return orderItem.getRetailPrice();
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Money getSalePrice() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return orderItem.getSalePrice();
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Money getPrice() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return orderItem.getAveragePrice();
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected Money convertToMoney(BigDecimal amount) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"return amount == null ? null : BroadleafCurrencyUtils.getMoney(amount, orderItem.getOrder().getCurrency());"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Money getTotalItemAmount() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return convertToMoney(totalItemAmount);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setTotalItemAmount(Money amount) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,totalItemAmount = amount.getAmount();
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Money getProratedOrderAdjustmentAmount() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return convertToMoney(proratedOrderAdjustment);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setProratedOrderAdjustmentAmount(Money proratedOrderAdjustment) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.proratedOrderAdjustment = proratedOrderAdjustment.getAmount();
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Money getTotalItemTaxableAmount() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return convertToMoney(totalItemTaxableAmount);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setTotalItemTaxableAmount(Money taxableAmount) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,totalItemTaxableAmount = taxableAmount.getAmount();
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public FulfillmentGroupStatusType getStatus() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return FulfillmentGroupStatusType.getInstance(this.status);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setStatus(FulfillmentGroupStatusType status) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.status = status.getType();
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void removeAssociations() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (getFulfillmentGroup() != null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,getFulfillmentGroup().getFulfillmentGroupItems().remove(this);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,setFulfillmentGroup(null);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,setOrderItem(null);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public List<TaxDetail> getTaxes() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return taxes;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setTaxes(List<TaxDetail> taxes) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.taxes = taxes;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Money getTotalTax() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"return totalTax == null ? null : BroadleafCurrencyUtils.getMoney(totalTax, getFulfillmentGroup().getOrder().getCurrency());"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setTotalTax(Money totalTax) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.totalTax = Money.toAmount(totalTax);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public String getCurrencyCode() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return ((CurrencyCodeIdentifiable) fulfillmentGroup).getCurrencyCode();
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"public void checkCloneable(FulfillmentGroupItem fulfillmentGroupItem) throws CloneNotSupportedException, SecurityException, NoSuchMethodException {"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"Method cloneMethod = fulfillmentGroupItem.getClass().getMethod(""clone"", new Class[]{});"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"if (cloneMethod.getDeclaringClass().getName().startsWith(""org.broadleafcommerce"") && !orderItem.getClass().getName().startsWith(""org.broadleafcommerce"")) {"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,//subclass is not implementing the clone method
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"throw new CloneNotSupportedException(""Custom extensions and implementations should implement clone in order to guarantee split and merge operations are performed accurately"");"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public FulfillmentGroupItem clone() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,//this is likely an extended class - instantiate from the fully qualified name via reflection
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,FulfillmentGroupItem clonedFulfillmentGroupItem;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,try {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,clonedFulfillmentGroupItem = (FulfillmentGroupItem) Class.forName(this.getClass().getName()).newInstance();
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,checkCloneable(clonedFulfillmentGroupItem);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,} catch (CloneNotSupportedException e) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"LOG.warn(""Clone implementation missing in inheritance hierarchy outside of Broadleaf: "" + clonedFulfillmentGroupItem.getClass().getName(), e);"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,clonedFulfillmentGroupItem.setFulfillmentGroup(getFulfillmentGroup());
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,clonedFulfillmentGroupItem.setOrderItem(getOrderItem());
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,clonedFulfillmentGroupItem.setQuantity(getQuantity());
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,clonedFulfillmentGroupItem.setTotalItemAmount(getTotalItemAmount());
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,clonedFulfillmentGroupItem.setTotalItemTaxableAmount(getTotalItemTaxableAmount());
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (getStatus() != null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,clonedFulfillmentGroupItem.setStatus(getStatus());
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,} catch (Exception e) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,throw new RuntimeException(e);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return clonedFulfillmentGroupItem;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public boolean getHasProratedOrderAdjustments() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (proratedOrderAdjustment != null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return (proratedOrderAdjustment.compareTo(BigDecimal.ZERO) == 0);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return false;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public boolean equals(Object obj) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (this == obj) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return true;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (obj == null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (!getClass().isAssignableFrom(obj.getClass())) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,FulfillmentGroupItemImpl other = (FulfillmentGroupItemImpl) obj;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (id != null && other.id != null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return id.equals(other.id);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (orderItem == null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (other.orderItem != null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,} else if (!orderItem.equals(other.orderItem)) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public int hashCode() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,final int prime = 31;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,int result = 1;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,result = prime * result + ((orderItem == null) ? 0 : orderItem.hashCode());
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return result;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,/*
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* #%L
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* BroadleafCommerce Framework
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* %%
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* Copyright (C) 2009 - 2013 Broadleaf Commerce
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"* Licensed under the Apache License, Version 2.0 (the ""License"");"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* you may not use this file except in compliance with the License.
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* You may obtain a copy of the License at
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,*
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,*       http://www.apache.org/licenses/LICENSE-2.0
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"* Unless required by applicable law or agreed to in writing, software"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"* distributed under the License is distributed on an ""AS IS"" BASIS,"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* See the License for the specific language governing permissions and
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* limitations under the License.
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* #L%
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,*/
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,package org.broadleafcommerce.core.order.domain;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@Entity
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@DiscriminatorColumn(name = ""TYPE"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@Inheritance(strategy = InheritanceType.JOINED)
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Table(name = ""BLC_FULFILLMENT_GROUP_ITEM"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Cache(usage=CacheConcurrencyStrategy.NONSTRICT_READ_WRITE, region=""blOrderElements"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@AdminPresentationMergeOverrides(
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,{
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeOverride(name = """", mergeEntries ="
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.READONLY,"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,booleanOverrideValue = true))
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,}
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,)
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"public class FulfillmentGroupItemImpl implements FulfillmentGroupItem, Cloneable, CurrencyCodeIdentifiable {"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,private static final Log LOG = LogFactory.getLog(FulfillmentGroupItemImpl.class);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,private static final long serialVersionUID = 1L;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@Id
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@GeneratedValue(generator = ""FulfillmentGroupItemId"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@GenericGenerator(
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"name=""FulfillmentGroupItemId"","
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"strategy=""org.broadleafcommerce.common.persistence.IdOverrideTableGenerator"","
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,parameters = {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Parameter(name=""segment_value"", value=""FulfillmentGroupItemImpl""),"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Parameter(name=""entity_name"", value=""org.broadleafcommerce.core.order.domain.FulfillmentGroupItemImpl"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""FULFILLMENT_GROUP_ITEM_ID"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected Long id;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@ManyToOne(targetEntity = FulfillmentGroupImpl.class, optional=false)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@JoinColumn(name = ""FULFILLMENT_GROUP_ID"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""FGITEM_FG_INDEX"", columnNames={""FULFILLMENT_GROUP_ID""})"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected FulfillmentGroup fulfillmentGroup;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,//this needs to stay OrderItem in order to provide backwards compatibility for those implementations that place a BundleOrderItem
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@ManyToOne(targetEntity = OrderItemImpl.class, optional=false)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@JoinColumn(name = ""ORDER_ITEM_ID"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Order_Item"", prominent = true, order = 1000, gridOrder = 1000)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@AdminPresentationToOneLookup()
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected OrderItem orderItem;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""QUANTITY"", nullable=false)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Quantity"", prominent = true, order = 2000, gridOrder = 2000)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected int quantity;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""STATUS"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""FGITEM_STATUS_INDEX"", columnNames={""STATUS""})"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Status"", prominent = true, order = 3000, gridOrder = 3000)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,private String status;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@OneToMany(fetch = FetchType.LAZY, targetEntity = TaxDetailImpl.class, cascade = { CascadeType.ALL }, orphanRemoval = true)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@JoinTable(name = ""BLC_FG_ITEM_TAX_XREF"", joinColumns = @JoinColumn(name = ""FULFILLMENT_GROUP_ITEM_ID""), inverseJoinColumns = @JoinColumn(name = ""TAX_DETAIL_ID""))"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected List<TaxDetail> taxes = new ArrayList<TaxDetail>();
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""TOTAL_ITEM_TAX"", precision=19, scale=5)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Total_Item_Tax"", order=4000, fieldType=SupportedFieldType.MONEY)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected BigDecimal totalTax;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""TOTAL_ITEM_AMOUNT"", precision = 19, scale = 5)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Total_Item_Amount"", order = 5000, fieldType = SupportedFieldType.MONEY)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected BigDecimal totalItemAmount;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""TOTAL_ITEM_TAXABLE_AMOUNT"", precision = 19, scale = 5)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Total_Item_Taxable_Amount"", order = 6000, fieldType = SupportedFieldType.MONEY)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected BigDecimal totalItemTaxableAmount;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""PRORATED_ORDER_ADJ"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Prorated_Adjustment"", order = 7000, fieldType = SupportedFieldType.MONEY)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected BigDecimal proratedOrderAdjustment;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@Override
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Long getId() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return id;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setId(Long id) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.id = id;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public FulfillmentGroup getFulfillmentGroup() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return fulfillmentGroup;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setFulfillmentGroup(FulfillmentGroup fulfillmentGroup) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.fulfillmentGroup = fulfillmentGroup;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public OrderItem getOrderItem() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return orderItem;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setOrderItem(OrderItem orderItem) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.orderItem = orderItem;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public int getQuantity() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return quantity;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setQuantity(int quantity) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.quantity = quantity;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Money getRetailPrice() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return orderItem.getRetailPrice();
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Money getSalePrice() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return orderItem.getSalePrice();
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Money getPrice() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return orderItem.getAveragePrice();
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected Money convertToMoney(BigDecimal amount) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"return amount == null ? null : BroadleafCurrencyUtils.getMoney(amount, orderItem.getOrder().getCurrency());"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Money getTotalItemAmount() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return convertToMoney(totalItemAmount);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setTotalItemAmount(Money amount) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,totalItemAmount = amount.getAmount();
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Money getProratedOrderAdjustmentAmount() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return convertToMoney(proratedOrderAdjustment);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setProratedOrderAdjustmentAmount(Money proratedOrderAdjustment) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.proratedOrderAdjustment = proratedOrderAdjustment.getAmount();
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Money getTotalItemTaxableAmount() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return convertToMoney(totalItemTaxableAmount);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setTotalItemTaxableAmount(Money taxableAmount) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,totalItemTaxableAmount = taxableAmount.getAmount();
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public FulfillmentGroupStatusType getStatus() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return FulfillmentGroupStatusType.getInstance(this.status);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setStatus(FulfillmentGroupStatusType status) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.status = status.getType();
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void removeAssociations() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (getFulfillmentGroup() != null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,getFulfillmentGroup().getFulfillmentGroupItems().remove(this);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,setFulfillmentGroup(null);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,setOrderItem(null);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public List<TaxDetail> getTaxes() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return taxes;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setTaxes(List<TaxDetail> taxes) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.taxes = taxes;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Money getTotalTax() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"return totalTax == null ? null : BroadleafCurrencyUtils.getMoney(totalTax, getFulfillmentGroup().getOrder().getCurrency());"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setTotalTax(Money totalTax) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.totalTax = Money.toAmount(totalTax);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public String getCurrencyCode() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return ((CurrencyCodeIdentifiable) fulfillmentGroup).getCurrencyCode();
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"public void checkCloneable(FulfillmentGroupItem fulfillmentGroupItem) throws CloneNotSupportedException, SecurityException, NoSuchMethodException {"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"Method cloneMethod = fulfillmentGroupItem.getClass().getMethod(""clone"", new Class[]{});"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"if (cloneMethod.getDeclaringClass().getName().startsWith(""org.broadleafcommerce"") && !orderItem.getClass().getName().startsWith(""org.broadleafcommerce"")) {"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,//subclass is not implementing the clone method
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"throw new CloneNotSupportedException(""Custom extensions and implementations should implement clone in order to guarantee split and merge operations are performed accurately"");"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public FulfillmentGroupItem clone() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,//this is likely an extended class - instantiate from the fully qualified name via reflection
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,FulfillmentGroupItem clonedFulfillmentGroupItem;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,try {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,clonedFulfillmentGroupItem = (FulfillmentGroupItem) Class.forName(this.getClass().getName()).newInstance();
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,checkCloneable(clonedFulfillmentGroupItem);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,} catch (CloneNotSupportedException e) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"LOG.warn(""Clone implementation missing in inheritance hierarchy outside of Broadleaf: "" + clonedFulfillmentGroupItem.getClass().getName(), e);"
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,clonedFulfillmentGroupItem.setFulfillmentGroup(getFulfillmentGroup());
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,clonedFulfillmentGroupItem.setOrderItem(getOrderItem());
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,clonedFulfillmentGroupItem.setQuantity(getQuantity());
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,clonedFulfillmentGroupItem.setTotalItemAmount(getTotalItemAmount());
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,clonedFulfillmentGroupItem.setTotalItemTaxableAmount(getTotalItemTaxableAmount());
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (getStatus() != null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,clonedFulfillmentGroupItem.setStatus(getStatus());
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,} catch (Exception e) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,throw new RuntimeException(e);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return clonedFulfillmentGroupItem;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public boolean getHasProratedOrderAdjustments() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (proratedOrderAdjustment != null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return (proratedOrderAdjustment.compareTo(BigDecimal.ZERO) == 0);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return false;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public boolean equals(Object obj) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (this == obj) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return true;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (obj == null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (!getClass().isAssignableFrom(obj.getClass())) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,FulfillmentGroupItemImpl other = (FulfillmentGroupItemImpl) obj;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (id != null && other.id != null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return id.equals(other.id);
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (orderItem == null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (other.orderItem != null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,} else if (!orderItem.equals(other.orderItem)) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public int hashCode() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,final int prime = 31;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,int result = 1;
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,result = prime * result + ((orderItem == null) ? 0 : orderItem.hashCode());
046d82d9156b354d71ab08d74593fdaff1ad0d71,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return result;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,/*
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,* #%L
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,* BroadleafCommerce Framework
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,* %%
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,* Copyright (C) 2009 - 2013 Broadleaf Commerce
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"* Licensed under the Apache License, Version 2.0 (the ""License"");"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,* you may not use this file except in compliance with the License.
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,* You may obtain a copy of the License at
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,*
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,*       http://www.apache.org/licenses/LICENSE-2.0
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"* Unless required by applicable law or agreed to in writing, software"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"* distributed under the License is distributed on an ""AS IS"" BASIS,"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,* See the License for the specific language governing permissions and
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,* limitations under the License.
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,* #L%
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,*/
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,package org.broadleafcommerce.core.order.domain;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,@Entity
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@DiscriminatorColumn(name = ""TYPE"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,@Inheritance(strategy = InheritanceType.JOINED)
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@Table(name = ""BLC_FULFILLMENT_GROUP_ITEM"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@Cache(usage=CacheConcurrencyStrategy.NONSTRICT_READ_WRITE, region=""blOrderElements"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,@AdminPresentationMergeOverrides(
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,{
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@AdminPresentationMergeOverride(name = """", mergeEntries ="
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.READONLY,"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,booleanOverrideValue = true))
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,}
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,)
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"public class FulfillmentGroupItemImpl implements FulfillmentGroupItem, Cloneable, CurrencyCodeIdentifiable {"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,private static final Log LOG = LogFactory.getLog(FulfillmentGroupItemImpl.class);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,private static final long serialVersionUID = 1L;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,@Id
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@GeneratedValue(generator = ""FulfillmentGroupItemId"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,@GenericGenerator(
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"name=""FulfillmentGroupItemId"","
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"strategy=""org.broadleafcommerce.common.persistence.IdOverrideTableGenerator"","
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,parameters = {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@Parameter(name=""segment_value"", value=""FulfillmentGroupItemImpl""),"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@Parameter(name=""entity_name"", value=""org.broadleafcommerce.core.order.domain.FulfillmentGroupItemImpl"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@Column(name = ""FULFILLMENT_GROUP_ITEM_ID"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,protected Long id;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@ManyToOne(targetEntity = FulfillmentGroupImpl.class, optional=false)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@JoinColumn(name = ""FULFILLMENT_GROUP_ID"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@Index(name=""FGITEM_FG_INDEX"", columnNames={""FULFILLMENT_GROUP_ID""})"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,protected FulfillmentGroup fulfillmentGroup;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,//this needs to stay OrderItem in order to provide backwards compatibility for those implementations that place a BundleOrderItem
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@ManyToOne(targetEntity = OrderItemImpl.class, optional=false)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@JoinColumn(name = ""ORDER_ITEM_ID"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Order_Item"", prominent = true, order = 1000, gridOrder = 1000)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,@AdminPresentationToOneLookup()
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,protected OrderItem orderItem;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@Column(name = ""QUANTITY"", nullable=false)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Quantity"", prominent = true, order = 2000, gridOrder = 2000)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,protected int quantity;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@Column(name = ""STATUS"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@Index(name=""FGITEM_STATUS_INDEX"", columnNames={""STATUS""})"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Status"", prominent = true, order = 3000, gridOrder = 3000)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,private String status;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@OneToMany(fetch = FetchType.LAZY, targetEntity = TaxDetailImpl.class, cascade = { CascadeType.ALL }, orphanRemoval = true)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@JoinTable(name = ""BLC_FG_ITEM_TAX_XREF"", joinColumns = @JoinColumn(name = ""FULFILLMENT_GROUP_ITEM_ID""), inverseJoinColumns = @JoinColumn(name = ""TAX_DETAIL_ID""))"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,protected List<TaxDetail> taxes = new ArrayList<TaxDetail>();
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@Column(name = ""TOTAL_ITEM_TAX"", precision=19, scale=5)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Total_Item_Tax"", order=4000, fieldType=SupportedFieldType.MONEY)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,protected BigDecimal totalTax;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@Column(name = ""TOTAL_ITEM_AMOUNT"", precision = 19, scale = 5)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Total_Item_Amount"", order = 5000, fieldType = SupportedFieldType.MONEY)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,protected BigDecimal totalItemAmount;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@Column(name = ""TOTAL_ITEM_TAXABLE_AMOUNT"", precision = 19, scale = 5)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Total_Item_Taxable_Amount"", order = 6000, fieldType = SupportedFieldType.MONEY)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,protected BigDecimal totalItemTaxableAmount;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@Column(name = ""PRORATED_ORDER_ADJ"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Prorated_Adjustment"", order = 7000, fieldType = SupportedFieldType.MONEY)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,protected BigDecimal proratedOrderAdjustment;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,@Override
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public Long getId() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,return id;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public void setId(Long id) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,this.id = id;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public FulfillmentGroup getFulfillmentGroup() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,return fulfillmentGroup;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public void setFulfillmentGroup(FulfillmentGroup fulfillmentGroup) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,this.fulfillmentGroup = fulfillmentGroup;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public OrderItem getOrderItem() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,return orderItem;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public void setOrderItem(OrderItem orderItem) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,this.orderItem = orderItem;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public int getQuantity() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,return quantity;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public void setQuantity(int quantity) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,this.quantity = quantity;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public Money getRetailPrice() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,return orderItem.getRetailPrice();
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public Money getSalePrice() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,return orderItem.getSalePrice();
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public Money getPrice() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,return orderItem.getAveragePrice();
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,protected Money convertToMoney(BigDecimal amount) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"return amount == null ? null : BroadleafCurrencyUtils.getMoney(amount, orderItem.getOrder().getCurrency());"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public Money getTotalItemAmount() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,return convertToMoney(totalItemAmount);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public void setTotalItemAmount(Money amount) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,totalItemAmount = amount.getAmount();
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public Money getProratedOrderAdjustmentAmount() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,return convertToMoney(proratedOrderAdjustment);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public void setProratedOrderAdjustmentAmount(Money proratedOrderAdjustment) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,this.proratedOrderAdjustment = proratedOrderAdjustment.getAmount();
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public Money getTotalItemTaxableAmount() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,return convertToMoney(totalItemTaxableAmount);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public void setTotalItemTaxableAmount(Money taxableAmount) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,totalItemTaxableAmount = taxableAmount.getAmount();
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public FulfillmentGroupStatusType getStatus() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,return FulfillmentGroupStatusType.getInstance(this.status);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public void setStatus(FulfillmentGroupStatusType status) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,this.status = status.getType();
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public void removeAssociations() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,if (getFulfillmentGroup() != null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,getFulfillmentGroup().getFulfillmentGroupItems().remove(this);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,setFulfillmentGroup(null);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,setOrderItem(null);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public List<TaxDetail> getTaxes() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,return taxes;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public void setTaxes(List<TaxDetail> taxes) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,this.taxes = taxes;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public Money getTotalTax() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"return totalTax == null ? null : BroadleafCurrencyUtils.getMoney(totalTax, getFulfillmentGroup().getOrder().getCurrency());"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public void setTotalTax(Money totalTax) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,this.totalTax = Money.toAmount(totalTax);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public String getCurrencyCode() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,return ((CurrencyCodeIdentifiable) fulfillmentGroup).getCurrencyCode();
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"public void checkCloneable(FulfillmentGroupItem fulfillmentGroupItem) throws CloneNotSupportedException, SecurityException, NoSuchMethodException {"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"Method cloneMethod = fulfillmentGroupItem.getClass().getMethod(""clone"", new Class[]{});"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"if (cloneMethod.getDeclaringClass().getName().startsWith(""org.broadleafcommerce"") && !orderItem.getClass().getName().startsWith(""org.broadleafcommerce"")) {"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,//subclass is not implementing the clone method
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"throw new CloneNotSupportedException(""Custom extensions and implementations should implement clone in order to guarantee split and merge operations are performed accurately"");"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public FulfillmentGroupItem clone() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,//this is likely an extended class - instantiate from the fully qualified name via reflection
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,FulfillmentGroupItem clonedFulfillmentGroupItem;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,try {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,clonedFulfillmentGroupItem = (FulfillmentGroupItem) Class.forName(this.getClass().getName()).newInstance();
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,checkCloneable(clonedFulfillmentGroupItem);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,} catch (CloneNotSupportedException e) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"LOG.warn(""Clone implementation missing in inheritance hierarchy outside of Broadleaf: "" + clonedFulfillmentGroupItem.getClass().getName(), e);"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,clonedFulfillmentGroupItem.setFulfillmentGroup(getFulfillmentGroup());
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,clonedFulfillmentGroupItem.setOrderItem(getOrderItem());
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,clonedFulfillmentGroupItem.setQuantity(getQuantity());
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,clonedFulfillmentGroupItem.setTotalItemAmount(getTotalItemAmount());
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,clonedFulfillmentGroupItem.setTotalItemTaxableAmount(getTotalItemTaxableAmount());
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,if (getStatus() != null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,clonedFulfillmentGroupItem.setStatus(getStatus());
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,} catch (Exception e) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,throw new RuntimeException(e);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,return clonedFulfillmentGroupItem;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public boolean getHasProratedOrderAdjustments() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,if (proratedOrderAdjustment != null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,return (proratedOrderAdjustment.compareTo(BigDecimal.ZERO) == 0);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,return false;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public boolean equals(Object obj) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,if (this == obj) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,return true;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,if (obj == null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,if (!getClass().isAssignableFrom(obj.getClass())) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,FulfillmentGroupItemImpl other = (FulfillmentGroupItemImpl) obj;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,if (id != null && other.id != null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,return id.equals(other.id);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,if (orderItem == null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,if (other.orderItem != null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,} else if (!orderItem.equals(other.orderItem)) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public int hashCode() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,final int prime = 31;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,int result = 1;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,result = prime * result + ((orderItem == null) ? 0 : orderItem.hashCode());
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,return result;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,/*
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* #%L
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* BroadleafCommerce Framework
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* %%
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* Copyright (C) 2009 - 2013 Broadleaf Commerce
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"* Licensed under the Apache License, Version 2.0 (the ""License"");"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* you may not use this file except in compliance with the License.
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* You may obtain a copy of the License at
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,*
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,*       http://www.apache.org/licenses/LICENSE-2.0
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"* Unless required by applicable law or agreed to in writing, software"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"* distributed under the License is distributed on an ""AS IS"" BASIS,"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* See the License for the specific language governing permissions and
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* limitations under the License.
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* #L%
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,*/
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,package org.broadleafcommerce.core.order.domain;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,@Entity
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@DiscriminatorColumn(name = ""TYPE"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,@Inheritance(strategy = InheritanceType.JOINED)
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@Table(name = ""BLC_FULFILLMENT_GROUP_ITEM"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@Cache(usage=CacheConcurrencyStrategy.NONSTRICT_READ_WRITE, region=""blOrderElements"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,@AdminPresentationMergeOverrides(
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,{
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@AdminPresentationMergeOverride(name = """", mergeEntries ="
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.READONLY,"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,booleanOverrideValue = true))
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,}
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,)
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"public class FulfillmentGroupItemImpl implements FulfillmentGroupItem, Cloneable, CurrencyCodeIdentifiable {"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,private static final Log LOG = LogFactory.getLog(FulfillmentGroupItemImpl.class);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,private static final long serialVersionUID = 1L;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,@Id
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@GeneratedValue(generator = ""FulfillmentGroupItemId"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,@GenericGenerator(
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"name=""FulfillmentGroupItemId"","
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"strategy=""org.broadleafcommerce.common.persistence.IdOverrideTableGenerator"","
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,parameters = {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@Parameter(name=""segment_value"", value=""FulfillmentGroupItemImpl""),"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@Parameter(name=""entity_name"", value=""org.broadleafcommerce.core.order.domain.FulfillmentGroupItemImpl"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@Column(name = ""FULFILLMENT_GROUP_ITEM_ID"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,protected Long id;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@ManyToOne(targetEntity = FulfillmentGroupImpl.class, optional=false)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@JoinColumn(name = ""FULFILLMENT_GROUP_ID"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@Index(name=""FGITEM_FG_INDEX"", columnNames={""FULFILLMENT_GROUP_ID""})"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,protected FulfillmentGroup fulfillmentGroup;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,//this needs to stay OrderItem in order to provide backwards compatibility for those implementations that place a BundleOrderItem
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@ManyToOne(targetEntity = OrderItemImpl.class, optional=false)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@JoinColumn(name = ""ORDER_ITEM_ID"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Order_Item"", prominent = true, order = 1000, gridOrder = 1000)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,@AdminPresentationToOneLookup()
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,protected OrderItem orderItem;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@Column(name = ""QUANTITY"", nullable=false)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Quantity"", prominent = true, order = 2000, gridOrder = 2000)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,protected int quantity;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@Column(name = ""STATUS"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@Index(name=""FGITEM_STATUS_INDEX"", columnNames={""STATUS""})"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Status"", prominent = true, order = 3000, gridOrder = 3000)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,private String status;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@OneToMany(fetch = FetchType.LAZY, targetEntity = TaxDetailImpl.class, cascade = { CascadeType.ALL }, orphanRemoval = true)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@JoinTable(name = ""BLC_FG_ITEM_TAX_XREF"", joinColumns = @JoinColumn(name = ""FULFILLMENT_GROUP_ITEM_ID""), inverseJoinColumns = @JoinColumn(name = ""TAX_DETAIL_ID""))"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,protected List<TaxDetail> taxes = new ArrayList<TaxDetail>();
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@Column(name = ""TOTAL_ITEM_TAX"", precision=19, scale=5)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Total_Item_Tax"", order=4000, fieldType=SupportedFieldType.MONEY)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,protected BigDecimal totalTax;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@Column(name = ""TOTAL_ITEM_AMOUNT"", precision = 19, scale = 5)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Total_Item_Amount"", order = 5000, fieldType = SupportedFieldType.MONEY)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,protected BigDecimal totalItemAmount;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@Column(name = ""TOTAL_ITEM_TAXABLE_AMOUNT"", precision = 19, scale = 5)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Total_Item_Taxable_Amount"", order = 6000, fieldType = SupportedFieldType.MONEY)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,protected BigDecimal totalItemTaxableAmount;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@Column(name = ""PRORATED_ORDER_ADJ"")"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupItemImpl_Prorated_Adjustment"", order = 7000, fieldType = SupportedFieldType.MONEY)"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,protected BigDecimal proratedOrderAdjustment;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,@Override
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public Long getId() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return id;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public void setId(Long id) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,this.id = id;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public FulfillmentGroup getFulfillmentGroup() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return fulfillmentGroup;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public void setFulfillmentGroup(FulfillmentGroup fulfillmentGroup) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,this.fulfillmentGroup = fulfillmentGroup;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public OrderItem getOrderItem() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return orderItem;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public void setOrderItem(OrderItem orderItem) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,this.orderItem = orderItem;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public int getQuantity() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return quantity;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public void setQuantity(int quantity) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,this.quantity = quantity;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public Money getRetailPrice() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return orderItem.getRetailPrice();
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public Money getSalePrice() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return orderItem.getSalePrice();
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public Money getPrice() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return orderItem.getAveragePrice();
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,protected Money convertToMoney(BigDecimal amount) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"return amount == null ? null : BroadleafCurrencyUtils.getMoney(amount, orderItem.getOrder().getCurrency());"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public Money getTotalItemAmount() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return convertToMoney(totalItemAmount);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public void setTotalItemAmount(Money amount) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,totalItemAmount = amount.getAmount();
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public Money getProratedOrderAdjustmentAmount() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return convertToMoney(proratedOrderAdjustment);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public void setProratedOrderAdjustmentAmount(Money proratedOrderAdjustment) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,this.proratedOrderAdjustment = proratedOrderAdjustment.getAmount();
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public Money getTotalItemTaxableAmount() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return convertToMoney(totalItemTaxableAmount);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public void setTotalItemTaxableAmount(Money taxableAmount) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,totalItemTaxableAmount = taxableAmount.getAmount();
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public FulfillmentGroupStatusType getStatus() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return FulfillmentGroupStatusType.getInstance(this.status);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public void setStatus(FulfillmentGroupStatusType status) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,this.status = status.getType();
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public void removeAssociations() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,if (getFulfillmentGroup() != null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,getFulfillmentGroup().getFulfillmentGroupItems().remove(this);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,setFulfillmentGroup(null);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,setOrderItem(null);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public List<TaxDetail> getTaxes() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return taxes;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public void setTaxes(List<TaxDetail> taxes) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,this.taxes = taxes;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public Money getTotalTax() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"return totalTax == null ? null : BroadleafCurrencyUtils.getMoney(totalTax, getFulfillmentGroup().getOrder().getCurrency());"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public void setTotalTax(Money totalTax) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,this.totalTax = Money.toAmount(totalTax);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public String getCurrencyCode() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return ((CurrencyCodeIdentifiable) fulfillmentGroup).getCurrencyCode();
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"public void checkCloneable(FulfillmentGroupItem fulfillmentGroupItem) throws CloneNotSupportedException, SecurityException, NoSuchMethodException {"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"Method cloneMethod = fulfillmentGroupItem.getClass().getMethod(""clone"", new Class[]{});"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"if (cloneMethod.getDeclaringClass().getName().startsWith(""org.broadleafcommerce"") && !orderItem.getClass().getName().startsWith(""org.broadleafcommerce"")) {"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,//subclass is not implementing the clone method
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"throw new CloneNotSupportedException(""Custom extensions and implementations should implement clone in order to guarantee split and merge operations are performed accurately"");"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public FulfillmentGroupItem clone() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,//this is likely an extended class - instantiate from the fully qualified name via reflection
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,FulfillmentGroupItem clonedFulfillmentGroupItem;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,try {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,clonedFulfillmentGroupItem = (FulfillmentGroupItem) Class.forName(this.getClass().getName()).newInstance();
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,checkCloneable(clonedFulfillmentGroupItem);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,} catch (CloneNotSupportedException e) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"LOG.warn(""Clone implementation missing in inheritance hierarchy outside of Broadleaf: "" + clonedFulfillmentGroupItem.getClass().getName(), e);"
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,clonedFulfillmentGroupItem.setFulfillmentGroup(getFulfillmentGroup());
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,clonedFulfillmentGroupItem.setOrderItem(getOrderItem());
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,clonedFulfillmentGroupItem.setQuantity(getQuantity());
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,clonedFulfillmentGroupItem.setTotalItemAmount(getTotalItemAmount());
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,clonedFulfillmentGroupItem.setTotalItemTaxableAmount(getTotalItemTaxableAmount());
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,if (getStatus() != null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,clonedFulfillmentGroupItem.setStatus(getStatus());
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,} catch (Exception e) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,throw new RuntimeException(e);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return clonedFulfillmentGroupItem;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public boolean getHasProratedOrderAdjustments() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,if (proratedOrderAdjustment != null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return (proratedOrderAdjustment.compareTo(BigDecimal.ZERO) == 0);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return false;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public boolean equals(Object obj) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,if (this == obj) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return true;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,if (obj == null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,if (!getClass().isAssignableFrom(obj.getClass())) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,FulfillmentGroupItemImpl other = (FulfillmentGroupItemImpl) obj;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,if (id != null && other.id != null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return id.equals(other.id);
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,if (orderItem == null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,if (other.orderItem != null) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,} else if (!orderItem.equals(other.orderItem)) {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public int hashCode() {
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,final int prime = 31;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,int result = 1;
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,result = prime * result + ((orderItem == null) ? 0 : orderItem.hashCode());
046d82d9156b354d71ab08d74593fdaff1ad0d71,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return result;
4b076569f8c9851adfd87b756af9c3f643778513,f7f3ca2c1196f3df086281c689109c153833a776,added,0,import org.broadleafcommerce.common.util.StringUtil;
4b076569f8c9851adfd87b756af9c3f643778513,f7f3ca2c1196f3df086281c689109c153833a776,added,0,"//this branch of the code just puts a placeholder ""tabErrors"", to avoid errprProcessor parsing errors, and"
4b076569f8c9851adfd87b756af9c3f643778513,f7f3ca2c1196f3df086281c689109c153833a776,added,0,"//avoids checking on tabs, fieldGroups or fields (which for translations are empty), thus skipping any warning"
4b076569f8c9851adfd87b756af9c3f643778513,f7f3ca2c1196f3df086281c689109c153833a776,added,0,String fieldName = StringUtil.extractFieldNameFromExpression(fieldExpression);
4b076569f8c9851adfd87b756af9c3f643778513,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,//TODO: research what else can be sent from this stage
4b076569f8c9851adfd87b756af9c3f643778513,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,String fieldName = extractFieldName(err);
4b076569f8c9851adfd87b756af9c3f643778513,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,"String fieldName = fieldExpression.substring(fieldExpression.indexOf('[') + 1, fieldExpression.lastIndexOf(']'));"
c8315836dbe8ea32a8c33a354dac54cde478160f,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,if (ArrayUtils.isEmpty(entities)) {
c8315836dbe8ea32a8c33a354dac54cde478160f,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,throw new EntityNotFoundException();
c8315836dbe8ea32a8c33a354dac54cde478160f,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,}
c8315836dbe8ea32a8c33a354dac54cde478160f,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.springframework.util.Assert;
c8315836dbe8ea32a8c33a354dac54cde478160f,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import javax.persistence.NoResultException;
c8315836dbe8ea32a8c33a354dac54cde478160f,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,if (entities == null || entities.length != 1) throw new EntityNotFoundException();
c8315836dbe8ea32a8c33a354dac54cde478160f,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,if (response == null) {
c8315836dbe8ea32a8c33a354dac54cde478160f,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"throw new NoResultException(String.format(""Could not find record for class [%s], field [%s], main entity id "" +"
c8315836dbe8ea32a8c33a354dac54cde478160f,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"""[%s], collection entity id [%s]"", containingClassMetadata.getCeilingType(),"
c8315836dbe8ea32a8c33a354dac54cde478160f,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"collectionProperty.getName(), containingEntityId, collectionItemId));"
c8315836dbe8ea32a8c33a354dac54cde478160f,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,}
ff893984acd47a21cf3088161bb4722da89f50dd,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,import org.broadleafcommerce.common.presentation.client.AdornedTargetAddMethodType;
ff893984acd47a21cf3088161bb4722da89f50dd,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,if (atcmd.getAdornedTargetAddMethodType().equals(AdornedTargetAddMethodType.SELECTIZE_LOOKUP)) {
ff893984acd47a21cf3088161bb4722da89f50dd,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,selectize = true;
ff893984acd47a21cf3088161bb4722da89f50dd,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,}
ff893984acd47a21cf3088161bb4722da89f50dd,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.common.util.BLCRequestUtils;
ff893984acd47a21cf3088161bb4722da89f50dd,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.common.util.BLCSystemProperty;
ff893984acd47a21cf3088161bb4722da89f50dd,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.GroupMetadata;
ff893984acd47a21cf3088161bb4722da89f50dd,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.ListGridAction;
ff893984acd47a21cf3088161bb4722da89f50dd,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.Tab;
a0d0037225d81f96edbf341786815865c3d0ef5a,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,if (tabMetadataMap != null) {
a0d0037225d81f96edbf341786815865c3d0ef5a,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,Set<String> tabMetadataKeySet = tabMetadataMap.keySet();
a0d0037225d81f96edbf341786815865c3d0ef5a,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,for (String tabKey : tabMetadataKeySet) {
a0d0037225d81f96edbf341786815865c3d0ef5a,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,TabMetadata tabMetadata = tabMetadataMap.get(tabKey);
a0d0037225d81f96edbf341786815865c3d0ef5a,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,String processedTabName = ef.addTabFromTabMetadata(tabMetadata);
a0d0037225d81f96edbf341786815865c3d0ef5a,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,Set<String> groupMetadataKeySet = tabMetadata.getGroupMetadata().keySet();
a0d0037225d81f96edbf341786815865c3d0ef5a,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,for (String groupKey : groupMetadataKeySet) {
a0d0037225d81f96edbf341786815865c3d0ef5a,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,"ef.addGroupFromGroupMetadata(tabMetadata.getGroupMetadata().get(groupKey), processedTabName);"
a0d0037225d81f96edbf341786815865c3d0ef5a,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,}
a0d0037225d81f96edbf341786815865c3d0ef5a,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,Set<String> tabMetadataKeySet = tabMetadataMap.keySet();
a0d0037225d81f96edbf341786815865c3d0ef5a,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,for (String tabKey : tabMetadataKeySet) {
a0d0037225d81f96edbf341786815865c3d0ef5a,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,TabMetadata tabMetadata = tabMetadataMap.get(tabKey);
a0d0037225d81f96edbf341786815865c3d0ef5a,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,String processedTabName = ef.addTabFromTabMetadata(tabMetadata);
a0d0037225d81f96edbf341786815865c3d0ef5a,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,Set<String> groupMetadataKeySet = tabMetadata.getGroupMetadata().keySet();
a0d0037225d81f96edbf341786815865c3d0ef5a,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,for (String groupKey : groupMetadataKeySet) {
a0d0037225d81f96edbf341786815865c3d0ef5a,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,"ef.addGroupFromGroupMetadata(tabMetadata.getGroupMetadata().get(groupKey), processedTabName);"
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,if (bcm.getAddMethodType().equals(AddMethodType.SELECTIZE_LOOKUP)) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,Property p = cmd.getPMap().get(bcm.getSelectizeVisibleField());
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,if (p != null) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"Field hf = createHeaderField(p, md);"
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,headerFields.add(hf);
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,}
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,} else {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,for (Property p : cmd.getProperties()) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,if (p.getMetadata() instanceof BasicFieldMetadata) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,BasicFieldMetadata md = (BasicFieldMetadata) p.getMetadata();
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,if (md.isProminent() != null && md.isProminent()
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"&& !ArrayUtils.contains(getGridHiddenVisibilities(), md.getVisibility())) {"
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,if (atcmd.getAdornedTargetAddMethodType().equals(AdornedTargetAddMethodType.SELECTIZE_LOOKUP)) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,selectize = true;
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,Property p = cmd.getPMap().get(atcmd.getSelectizeVisibleField());
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,for (String fieldName : atcmd.getGridVisibleFields()) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,Property p = cmd.getPMap().get(fieldName);
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,if (selectize && (type == ListGrid.Type.ADORNED || type == ListGrid.Type.ADORNED_WITH_FORM)) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"message += "" Please configure 'selectizeVisibleField' in your @AdminPresentationAdornedTargetCollection configuration"";"
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,} else if (type == ListGrid.Type.ADORNED || type == ListGrid.Type.ADORNED_WITH_FORM) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,} else if (selectize && type == ListGrid.Type.BASIC) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"message += "" Please configure 'selectizeVisibleField' in your @AdminPresentationCollection configuration"";"
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,for (Property p : cmd.getProperties()) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,if (p.getMetadata() instanceof BasicFieldMetadata) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,if (md.isProminent() != null && md.isProminent()
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"&& !ArrayUtils.contains(getGridHiddenVisibilities(), md.getVisibility())) {"
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"Field hf = createHeaderField(p, md);"
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,headerFields.add(hf);
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,for (String fieldName : atcmd.getGridVisibleFields()) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,Property p = cmd.getPMap().get(fieldName);
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,BasicFieldMetadata md = (BasicFieldMetadata) p.getMetadata();
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,if (atcmd.getAdornedTargetAddMethodType().equals(AdornedTargetAddMethodType.SELECTIZE_LOOKUP)) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,selectize = true;
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,}
77c9ca44f193c81a0f9cf3918470865aa0c7e681,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,if (type == ListGrid.Type.ADORNED || type == ListGrid.Type.ADORNED_WITH_FORM) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,added,0,if (bcm.getAddMethodType().equals(AddMethodType.SELECTIZE_LOOKUP)) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,added,0,Property p = cmd.getPMap().get(bcm.getSelectizeVisibleField());
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,added,0,if (p != null) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,added,0,"Field hf = createHeaderField(p, md);"
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,added,0,headerFields.add(hf);
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,added,0,}
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,added,0,} else {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,added,0,for (Property p : cmd.getProperties()) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,added,0,if (p.getMetadata() instanceof BasicFieldMetadata) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,added,0,BasicFieldMetadata md = (BasicFieldMetadata) p.getMetadata();
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,added,0,if (md.isProminent() != null && md.isProminent()
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,added,0,"&& !ArrayUtils.contains(getGridHiddenVisibilities(), md.getVisibility())) {"
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,added,0,if (atcmd.getAdornedTargetAddMethodType().equals(AdornedTargetAddMethodType.SELECTIZE_LOOKUP)) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,added,0,selectize = true;
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,added,0,Property p = cmd.getPMap().get(atcmd.getSelectizeVisibleField());
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,added,0,for (String fieldName : atcmd.getGridVisibleFields()) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,added,0,Property p = cmd.getPMap().get(fieldName);
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,added,0,if (selectize && (type == ListGrid.Type.ADORNED || type == ListGrid.Type.ADORNED_WITH_FORM)) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,added,0,"message += "" Please configure 'selectizeVisibleField' in your @AdminPresentationAdornedTargetCollection configuration"";"
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,added,0,} else if (type == ListGrid.Type.ADORNED || type == ListGrid.Type.ADORNED_WITH_FORM) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,added,0,} else if (selectize && type == ListGrid.Type.BASIC) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,added,0,"message += "" Please configure 'selectizeVisibleField' in your @AdminPresentationCollection configuration"";"
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,deleted,1,for (Property p : cmd.getProperties()) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,deleted,1,if (p.getMetadata() instanceof BasicFieldMetadata) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,deleted,1,if (md.isProminent() != null && md.isProminent()
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,deleted,1,"&& !ArrayUtils.contains(getGridHiddenVisibilities(), md.getVisibility())) {"
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,deleted,1,"Field hf = createHeaderField(p, md);"
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,deleted,1,headerFields.add(hf);
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,deleted,1,for (String fieldName : atcmd.getGridVisibleFields()) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,deleted,1,Property p = cmd.getPMap().get(fieldName);
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,deleted,1,BasicFieldMetadata md = (BasicFieldMetadata) p.getMetadata();
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,deleted,1,if (atcmd.getAdornedTargetAddMethodType().equals(AdornedTargetAddMethodType.SELECTIZE_LOOKUP)) {
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,deleted,1,selectize = true;
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,deleted,1,}
77c9ca44f193c81a0f9cf3918470865aa0c7e681,f82f5a619ac18c39c34c767f4c62c2b7f355226d,deleted,1,if (type == ListGrid.Type.ADORNED || type == ListGrid.Type.ADORNED_WITH_FORM) {
3422021bdfef764010bc47145e149ac2e6a63064,97768729dbccd6c1dabe1e628cddc69ae2dcc869,added,0,if (drs.getUnselectedTabMetadata().get(EntityForm.DEFAULT_TAB_NAME) != null) {
3422021bdfef764010bc47145e149ac2e6a63064,97768729dbccd6c1dabe1e628cddc69ae2dcc869,added,0,"entityForm.addListGrid(listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ORDER, fmd.getGroup(), true);"
3422021bdfef764010bc47145e149ac2e6a63064,97768729dbccd6c1dabe1e628cddc69ae2dcc869,added,0,} else {
3422021bdfef764010bc47145e149ac2e6a63064,97768729dbccd6c1dabe1e628cddc69ae2dcc869,added,0,"entityForm.addListGrid(listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ORDER, fmd.getGroup(), false);"
3422021bdfef764010bc47145e149ac2e6a63064,97768729dbccd6c1dabe1e628cddc69ae2dcc869,added,0,}
3422021bdfef764010bc47145e149ac2e6a63064,97768729dbccd6c1dabe1e628cddc69ae2dcc869,deleted,1,"entityForm.addListGrid(listGrid, EntityForm.DEFAULT_TAB_NAME, EntityForm.DEFAULT_TAB_ORDER, fmd.getGroup());"
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import org.broadleafcommerce.openadmin.dto.ClassMetadata;
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,// Add new group for the field to be placed into
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"// If group exists, this code will not run"
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,fieldGroup = new FieldGroup();
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,fieldGroup.setTitle(groupName);
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,fieldGroup.setOrder(groupOrder);
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,tab.getFieldGroups().add(fieldGroup);
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public void addListGrid(ClassMetadata cmd, ListGrid listGrid, String tabName, Integer tabOrder, String groupName, boolean isTabPresent) {"
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,// Check CMD for Tab/Group name overrides so that Tabs/Groups can be properly found by their display names
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"Map<String, TabMetadata> tabMetadataMap = cmd.getTabAndGroupMetadata();"
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,for (String tabKey : tabMetadataMap.keySet()) {
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,if (tabKey.equals(tabName)) {
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,tabName = tabMetadataMap.get(tabKey).getTabName();
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,}
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"Map<String, GroupMetadata> groupMetadataMap = tabMetadataMap.get(tabKey).getGroupMetadata();"
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,for (String groupKey : groupMetadataMap.keySet()) {
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,if (groupKey.equals(groupName)) {
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,groupName = groupMetadataMap.get(groupKey).getGroupName();
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,break;
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,// Tabs/Groups should be looked up and referenced by their display name
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,} else if (fieldGroup == null && tab != null) {
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,import org.broadleafcommerce.common.audit.Auditable;
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,fieldGroup = tab.findGroup(groupName);
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,if (fieldGroup == null) {
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,fieldGroup = new FieldGroup();
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,fieldGroup.setTitle(groupName);
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,fieldGroup.setOrder(groupOrder);
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,tab.getFieldGroups().add(fieldGroup);
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,}
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"public void addListGrid(ListGrid listGrid, String tabName, Integer tabOrder, String groupName, boolean isTabPresent) {"
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,// Tabs should be looked up and referenced by their display name
f3a09dcc83980fc39641a68cc78121429236a358,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,} else if (fieldGroup == null && tab != null){
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,import org.broadleafcommerce.openadmin.dto.ClassMetadata;
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,// Add new group for the field to be placed into
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,"// If group exists, this code will not run"
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,fieldGroup = new FieldGroup();
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,fieldGroup.setTitle(groupName);
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,fieldGroup.setOrder(groupOrder);
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,tab.getFieldGroups().add(fieldGroup);
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,"public void addListGrid(ClassMetadata cmd, ListGrid listGrid, String tabName, Integer tabOrder, String groupName, boolean isTabPresent) {"
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,// Check CMD for Tab/Group name overrides so that Tabs/Groups can be properly found by their display names
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,"Map<String, TabMetadata> tabMetadataMap = cmd.getTabAndGroupMetadata();"
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,for (String tabKey : tabMetadataMap.keySet()) {
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,if (tabKey.equals(tabName)) {
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,tabName = tabMetadataMap.get(tabKey).getTabName();
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,}
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,"Map<String, GroupMetadata> groupMetadataMap = tabMetadataMap.get(tabKey).getGroupMetadata();"
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,for (String groupKey : groupMetadataMap.keySet()) {
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,if (groupKey.equals(groupName)) {
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,groupName = groupMetadataMap.get(groupKey).getGroupName();
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,break;
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,// Tabs/Groups should be looked up and referenced by their display name
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,} else if (fieldGroup == null && tab != null) {
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.common.audit.Auditable;
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,fieldGroup = tab.findGroup(groupName);
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,if (fieldGroup == null) {
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,fieldGroup = new FieldGroup();
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,fieldGroup.setTitle(groupName);
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,fieldGroup.setOrder(groupOrder);
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,tab.getFieldGroups().add(fieldGroup);
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,}
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,"public void addListGrid(ListGrid listGrid, String tabName, Integer tabOrder, String groupName, boolean isTabPresent) {"
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,// Tabs should be looked up and referenced by their display name
f3a09dcc83980fc39641a68cc78121429236a358,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,} else if (fieldGroup == null && tab != null){
0f5008328a9e23b8abf5561c68076c0bbaff9a5c,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"protected void setEntityFormFields(ClassMetadata cmd, EntityForm ef, List<Property> properties) {"
0f5008328a9e23b8abf5561c68076c0bbaff9a5c,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"ef.addField(cmd, f, fmd.getGroup(), fmd.getGroupOrder(), fmd.getTab(), fmd.getTabOrder());"
0f5008328a9e23b8abf5561c68076c0bbaff9a5c,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"setEntityFormFields(cmd, ef, Arrays.asList(cmd.getProperties()));"
0f5008328a9e23b8abf5561c68076c0bbaff9a5c,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"setEntityFormFields(collectionMetadata, ef, entityFormProperties);"
0f5008328a9e23b8abf5561c68076c0bbaff9a5c,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"ef.addHiddenField(collectionMetadata, f);"
0f5008328a9e23b8abf5561c68076c0bbaff9a5c,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"ef.addMapKeyField(cmd, keyField);"
0f5008328a9e23b8abf5561c68076c0bbaff9a5c,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"setEntityFormFields(cmd, ef, mapFormProperties);"
0f5008328a9e23b8abf5561c68076c0bbaff9a5c,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"ef.addHiddenField(cmd, f);"
0f5008328a9e23b8abf5561c68076c0bbaff9a5c,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"protected void setEntityFormFields(EntityForm ef, List<Property> properties) {"
0f5008328a9e23b8abf5561c68076c0bbaff9a5c,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"ef.addField(f, fmd.getGroup(), fmd.getGroupOrder(), fmd.getTab(), fmd.getTabOrder());"
0f5008328a9e23b8abf5561c68076c0bbaff9a5c,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"setEntityFormFields(ef, Arrays.asList(cmd.getProperties()));"
0f5008328a9e23b8abf5561c68076c0bbaff9a5c,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"setEntityFormFields(ef, entityFormProperties);"
0f5008328a9e23b8abf5561c68076c0bbaff9a5c,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,ef.addHiddenField(f);
0f5008328a9e23b8abf5561c68076c0bbaff9a5c,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,ef.addMapKeyField(keyField);
0f5008328a9e23b8abf5561c68076c0bbaff9a5c,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"setEntityFormFields(ef, mapFormProperties);"
4a359d28ec089de1562278c40da23b97d44df4b4,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,} else if (!(URLHandlerDTO.class.isAssignableFrom(handler.getClass()))) {
4a359d28ec089de1562278c40da23b97d44df4b4,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,} else if (!(handler.getClass().isAssignableFrom(URLHandlerDTO.class))) {
8ebcb4ea977fb7c1bd9ece8ace8d558e52d841c4,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"Path xRefCategoriesCategoryId = root.get(""allParentCategoryXrefs"").get(""category"").get(""id"");"
8ebcb4ea977fb7c1bd9ece8ace8d558e52d841c4,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,return xRefCategoriesCategoryId.as(Long.class).in(directValues);
8ebcb4ea977fb7c1bd9ece8ace8d558e52d841c4,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,}));
8ebcb4ea977fb7c1bd9ece8ace8d558e52d841c4,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,import org.broadleafcommerce.openadmin.server.service.persistence.module.criteria.FieldPath;
8ebcb4ea977fb7c1bd9ece8ace8d558e52d841c4,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,".withFieldPath(new FieldPath().withTargetProperty(""allParentCategoryXrefs.category.id""))"
8ebcb4ea977fb7c1bd9ece8ace8d558e52d841c4,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,return explicitPath.as(Long.class).in(directValues);
8ebcb4ea977fb7c1bd9ece8ace8d558e52d841c4,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,})
8ebcb4ea977fb7c1bd9ece8ace8d558e52d841c4,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,);
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,/**
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,"* Detects whether or not the current cloned entity is an extension of an entity in Broadleaf, and if so, if the"
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,* extension itself does not implement clone.
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,*
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,* @param cloned the cloned entity instance
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,* @throws CloneNotSupportedException thrown if the entity is an extension and is does not implement clone
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,*/
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,protected void validateClone(Object cloned) throws CloneNotSupportedException {
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,Method cloneMethod;
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,try {
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,"cloneMethod = cloned.getClass().getMethod(""createOrRetrieveCopyInstance"", new Class[]{MultiTenantCopyContext.class});"
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,} catch (NoSuchMethodException e) {
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,throw ExceptionHelper.refineException(e);
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,}
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,boolean cloneMethodLocal = false;
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,for (String prefix : BROADLEAF_PACKAGE_PREFIXES) {
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,if (cloneMethod.getDeclaringClass().getName().startsWith(prefix)) {
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,cloneMethodLocal = true;
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,break;
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,boolean cloneClassLocal = false;
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,if (cloned.getClass().getName().startsWith(prefix)) {
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,cloneClassLocal = true;
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,if (cloneMethodLocal && !cloneClassLocal) {
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,//subclass is not implementing the clone method
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,"throw new CloneNotSupportedException(""The system is attempting to clone "" + cloned.getClass().getName() +"
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,""" and has determined the custom extension does not implement clone. This class should implement "" +"
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,"""clone, and inside first call super.clone() to get back an instance of your class ("" + cloned.getClass().getName() +"
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,"""), and then finish populating this instance with your custom fields before passing back the finished object."");"
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,/**
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,"* Detects whether or not the current cloned entity is an extension of an entity in Broadleaf, and if so, if the"
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,* extension itself does not implement clone.
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,*
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,* @param cloned the cloned entity instance
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,* @throws CloneNotSupportedException thrown if the entity is an extension and is does not implement clone
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,*/
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,public void validateClone(Object cloned) throws CloneNotSupportedException {
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,Method cloneMethod;
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,try {
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,"cloneMethod = cloned.getClass().getMethod(""createOrRetrieveCopyInstance"", new Class[]{MultiTenantCopyContext.class});"
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,} catch (NoSuchMethodException e) {
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,throw ExceptionHelper.refineException(e);
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,}
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,boolean cloneMethodLocal = false;
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,for (String prefix : BROADLEAF_PACKAGE_PREFIXES) {
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,if (cloneMethod.getDeclaringClass().getName().startsWith(prefix)) {
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,cloneMethodLocal = true;
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,break;
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,boolean cloneClassLocal = false;
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,if (cloned.getClass().getName().startsWith(prefix)) {
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,cloneClassLocal = true;
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,if (cloneMethodLocal && !cloneClassLocal) {
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,//subclass is not implementing the clone method
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,"throw new CloneNotSupportedException(""The system is attempting to clone "" + cloned.getClass().getName() +"
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,""" and has determined the custom extension does not implement clone. This class should implement "" +"
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,"""clone, and inside first call super.clone() to get back an instance of your class ("" + cloned.getClass().getName() +"
b441e3381f1794da9ef05c1ae90f122ac6daf1b3,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,"""), and then finish populating this instance with your custom fields before passing back the finished object."");"
a13be2d28410422ea098d4789c02b1cfa45b0f2f,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import org.broadleafcommerce.core.catalog.service.SearchFieldInfo;
a13be2d28410422ea098d4789c02b1cfa45b0f2f,a4d551eb8e80d433566d7a54761750db6313563b,added,0,searchableFieldTypes.add(SearchFieldInfo.SEARCH_FIELD_SOLR_FIELD_TYPE.get(fieldType));
a13be2d28410422ea098d4789c02b1cfa45b0f2f,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,if (fieldType.equals(SearchFieldType.STRING)) {
a13be2d28410422ea098d4789c02b1cfa45b0f2f,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,searchableFieldTypes.add(FieldType.TEXT);
a13be2d28410422ea098d4789c02b1cfa45b0f2f,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,} else if (fieldType.equals(SearchFieldType.BOOLEAN)) {
a13be2d28410422ea098d4789c02b1cfa45b0f2f,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,searchableFieldTypes.add(FieldType.BOOLEAN);
a13be2d28410422ea098d4789c02b1cfa45b0f2f,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,} else if (fieldType.equals(SearchFieldType.DATE)) {
a13be2d28410422ea098d4789c02b1cfa45b0f2f,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,searchableFieldTypes.add(FieldType.DATE);
a13be2d28410422ea098d4789c02b1cfa45b0f2f,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,} else if (fieldType.equals(SearchFieldType.DECIMAL)) {
a13be2d28410422ea098d4789c02b1cfa45b0f2f,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,searchableFieldTypes.add(FieldType.DOUBLE);
a13be2d28410422ea098d4789c02b1cfa45b0f2f,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,} else if (fieldType.equals(SearchFieldType.INTEGER)) {
a13be2d28410422ea098d4789c02b1cfa45b0f2f,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,searchableFieldTypes.add(FieldType.INT);
a13be2d28410422ea098d4789c02b1cfa45b0f2f,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,} else if (fieldType.equals(SearchFieldType.MONEY)) {
a13be2d28410422ea098d4789c02b1cfa45b0f2f,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,searchableFieldTypes.add(FieldType.PRICE);
a13be2d28410422ea098d4789c02b1cfa45b0f2f,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,}
a13be2d28410422ea098d4789c02b1cfa45b0f2f,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"public class FieldImpl implements Field, AdminMainEntity {"
a13be2d28410422ea098d4789c02b1cfa45b0f2f,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,if (searchable == null) {
a13be2d28410422ea098d4789c02b1cfa45b0f2f,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,return false;
a13be2d28410422ea098d4789c02b1cfa45b0f2f,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,}
a13be2d28410422ea098d4789c02b1cfa45b0f2f,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,import org.broadleafcommerce.common.extensibility.jpa.copy.DirectCopyTransform;
a13be2d28410422ea098d4789c02b1cfa45b0f2f,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,import org.broadleafcommerce.common.extensibility.jpa.copy.DirectCopyTransformMember;
a13be2d28410422ea098d4789c02b1cfa45b0f2f,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,import org.broadleafcommerce.common.extensibility.jpa.copy.DirectCopyTransformTypes;
a13be2d28410422ea098d4789c02b1cfa45b0f2f,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,import java.io.Serializable;
a13be2d28410422ea098d4789c02b1cfa45b0f2f,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,@DirectCopyTransform({
a13be2d28410422ea098d4789c02b1cfa45b0f2f,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,@DirectCopyTransformMember(templateTokens = DirectCopyTransformTypes.MULTITENANT_SITE)
a13be2d28410422ea098d4789c02b1cfa45b0f2f,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,})
a13be2d28410422ea098d4789c02b1cfa45b0f2f,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,"public class FieldImpl implements Field, Serializable, AdminMainEntity {"
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,added,0,"public ExtensionResultStatusType modifySolrQuery(SolrQuery query, String qualifiedSolrQuery,"
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,added,0,"List<SearchFacetDTO> facets, SearchCriteria searchCriteria, String defaultSort) {"
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,added,0,"public ExtensionResultStatusType getCategoryId(Category category, Long[] returnContainer) {"
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,import org.apache.solr.common.SolrInputDocument;
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,import org.broadleafcommerce.common.locale.domain.Locale;
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,import org.broadleafcommerce.core.catalog.domain.Product;
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,import org.broadleafcommerce.core.catalog.domain.Sku;
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,import java.lang.reflect.InvocationTargetException;
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,import java.util.Collection;
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,import java.util.Map;
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,@Override
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,"public ExtensionResultStatusType addPropertyValues(Product product, Field field, FieldType fieldType,"
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,"Map<String, Object> values, String propertyName, List<Locale> locales) throws IllegalAccessException, InvocationTargetException, NoSuchMethodException {"
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,return ExtensionResultStatusType.NOT_HANDLED;
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,}
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,"public ExtensionResultStatusType addPropertyValues(Sku sku, Field field, FieldType fieldType,"
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,"public ExtensionResultStatusType modifySolrQuery(SolrQuery query, String qualifiedSolrQuery, List<SearchFacetDTO> facets, SearchCriteria searchCriteria, String defaultSort) {"
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,"public ExtensionResultStatusType attachAdditionalBasicFields(Product product, SolrInputDocument document, SolrHelperService shs) {"
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,"public ExtensionResultStatusType attachAdditionalBasicFields(Sku sku, SolrInputDocument document, SolrHelperService shs) {"
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,"public ExtensionResultStatusType getSolrDocumentId(SolrInputDocument document, Product product, String[] returnContainer) {"
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,"public ExtensionResultStatusType getSolrDocumentId(SolrInputDocument document, Sku product, String[] returnContainer) {"
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,"public ExtensionResultStatusType getCategoryId(Category category, Long[] returnContainer) {"
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,"public ExtensionResultStatusType getCategoryId(Long category, Long[] returnContainer) {"
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,"public ExtensionResultStatusType getProductId(Product product, Long[] returnContainer) {"
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,"public ExtensionResultStatusType getSkuId(Sku sku, Long[] returnContainer) {"
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,"public ExtensionResultStatusType modifyBuiltDocuments(Collection<SolrInputDocument> documents, List<Product> products, List<Field> fields, List<Locale> locales) {"
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,public ExtensionResultStatusType startBatchEvent(List<Product> products) {
a3d8ed840d9f522b079e7b9e0494019cdc070eff,72845c3269dc77fbef5e81a155ea2b074d0aeace,deleted,1,public ExtensionResultStatusType endBatchEvent() {
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"List<Long> productIds = BLCCollectionUtils.collectList(indexables, new TypedTransformer<Long>() {"
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,@Override
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public Long transform(Object input) {
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,return shs.getCurrentProductId((Indexable) input);
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,});
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"solrIndexDao.populateProductCatalogStructure(Arrays.asList(shs.getCurrentProductId(indexable)), SolrIndexCachedOperation.getCache());"
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,Long cacheKey = this.shs.getCurrentProductId(indexable); // current
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (!cache.getParentCategoriesByProduct().containsKey(cacheKey)) {
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,cacheKey = sandBoxHelper.getOriginalId(cacheKey); // parent
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,cacheKey = shs.getIndexableId(indexable); // master
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,}
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (cache.getParentCategoriesByProduct().containsKey(cacheKey)) {
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,for (Long categoryId : cache.getParentCategoriesByProduct().get(cacheKey)) {
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"String displayOrderKey = categoryId + ""-"" + cacheKey;"
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,List<Long> productIds = new ArrayList<Long>();
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (useSku) {
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,for (Sku sku : (List<Sku>) indexables) {
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,productIds.add(sku.getProduct().getId());
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,} else {
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"productIds = BLCCollectionUtils.collectList(indexables, new TypedTransformer<Long>() {"
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,@Override
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public Long transform(Object input) {
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,return shs.getIndexableId((Product) input);
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,}
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,});
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"solrIndexDao.populateProductCatalogStructure(Arrays.asList(((Sku) indexable).getProduct().getId()), SolrIndexCachedOperation.getCache());"
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"solrIndexDao.populateProductCatalogStructure(Arrays.asList(indexable.getId()), SolrIndexCachedOperation.getCache());"
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,Long originalId = null;
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,originalId = sandBoxHelper.getOriginalId(((Sku) indexable).getProduct().getId());
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,originalId = (originalId == null) ? indexable.getId() : originalId;
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,originalId = sandBoxHelper.getOriginalId(indexable);
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (cache.getParentCategoriesByProduct().containsKey(originalId)) {
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,for (Long categoryId : cache.getParentCategoriesByProduct().get(originalId)) {
b6bca92dc0528e57c7737aea1a01841336f4e38c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"String displayOrderKey = categoryId + ""-"" + originalId;"
13131b390f8cd7c4d9b2602654a9bd3704609855,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,* @param indexables the list of items to index
13131b390f8cd7c4d9b2602654a9bd3704609855,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"* @param solrServer if non-null, adds and commits the indexed documents to the server. If this is null, this will"
13131b390f8cd7c4d9b2602654a9bd3704609855,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,* simply return the documents that were built from <b>indexables</b>
13131b390f8cd7c4d9b2602654a9bd3704609855,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,* @return the {@link SolrInputDocument}s that were built from the given <b>indexables</b>
13131b390f8cd7c4d9b2602654a9bd3704609855,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public Collection<SolrInputDocument> buildIncrementalIndex(List<? extends Indexable> indexables, SolrServer solrServer) throws ServiceException;"
13131b390f8cd7c4d9b2602654a9bd3704609855,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* @param skus
13131b390f8cd7c4d9b2602654a9bd3704609855,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* @param useReindexServer
13131b390f8cd7c4d9b2602654a9bd3704609855,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public void buildIncrementalIndex(List<? extends Indexable> indexables, SolrServer solrServer) throws ServiceException;"
13131b390f8cd7c4d9b2602654a9bd3704609855,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public Collection<SolrInputDocument> buildIncrementalIndex(List<? extends Indexable> indexables, SolrServer solrServer) throws ServiceException {"
13131b390f8cd7c4d9b2602654a9bd3704609855,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (!CollectionUtils.isEmpty(documents) && solrServer != null) {
13131b390f8cd7c4d9b2602654a9bd3704609855,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (LOG.isDebugEnabled()) {
13131b390f8cd7c4d9b2602654a9bd3704609855,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"LOG.debug(String.format(""Built incremental product index - pageSize: [%s] in [%s]"", indexables.size(), s.toLapString()));"
13131b390f8cd7c4d9b2602654a9bd3704609855,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,}
13131b390f8cd7c4d9b2602654a9bd3704609855,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,return documents;
13131b390f8cd7c4d9b2602654a9bd3704609855,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public void buildIncrementalIndex(List<? extends Indexable> indexables, SolrServer solrServer) throws ServiceException {"
13131b390f8cd7c4d9b2602654a9bd3704609855,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (!CollectionUtils.isEmpty(documents)) {
13131b390f8cd7c4d9b2602654a9bd3704609855,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (LOG.isDebugEnabled()) {
13131b390f8cd7c4d9b2602654a9bd3704609855,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"LOG.debug(String.format(""Built incremental product index - pageSize: [%s] in [%s]"", indexables.size(), s.toLapString()));"
13131b390f8cd7c4d9b2602654a9bd3704609855,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,}
13131b390f8cd7c4d9b2602654a9bd3704609855,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,added,0,"public Collection<SolrInputDocument> buildIncrementalIndex(List<? extends Indexable> indexables, SolrServer solrServer) throws ServiceException {"
13131b390f8cd7c4d9b2602654a9bd3704609855,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,added,0,if (!CollectionUtils.isEmpty(documents) && solrServer != null) {
13131b390f8cd7c4d9b2602654a9bd3704609855,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,added,0,if (LOG.isDebugEnabled()) {
13131b390f8cd7c4d9b2602654a9bd3704609855,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,added,0,"LOG.debug(String.format(""Built incremental product index - pageSize: [%s] in [%s]"", indexables.size(), s.toLapString()));"
13131b390f8cd7c4d9b2602654a9bd3704609855,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,added,0,}
13131b390f8cd7c4d9b2602654a9bd3704609855,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,added,0,return documents;
13131b390f8cd7c4d9b2602654a9bd3704609855,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,"public void buildIncrementalIndex(List<? extends Indexable> indexables, SolrServer solrServer) throws ServiceException {"
13131b390f8cd7c4d9b2602654a9bd3704609855,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,if (!CollectionUtils.isEmpty(documents)) {
13131b390f8cd7c4d9b2602654a9bd3704609855,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,if (LOG.isDebugEnabled()) {
13131b390f8cd7c4d9b2602654a9bd3704609855,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,"LOG.debug(String.format(""Built incremental product index - pageSize: [%s] in [%s]"", indexables.size(), s.toLapString()));"
13131b390f8cd7c4d9b2602654a9bd3704609855,43a8dc6bed524e48c1dffdf94b069cc751e7cdac,deleted,1,}
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,CatalogStructure cache = SolrIndexCachedOperation.getCache();
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,if (cache == null) {
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,"LOG.warn(""Consider using SolrIndexService.performCachedOperation() in combination with "" +"
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,"""SolrIndexService.buildIncrementalIndex() for better caching performance during solr indexing"");"
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,}
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,// Add the namespace and ID fields for this product
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,"document.addField(shs.getNamespaceFieldName(), shs.getCurrentNamespace());"
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,"document.addField(shs.getIdFieldName(), shs.getSolrDocumentId(document, indexable));"
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,"document.addField(shs.getIndexableIdFieldName(), shs.getIndexableId(indexable));"
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,"extensionManager.getProxy().attachAdditionalBasicFields(indexable, document, shs);"
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,Long cacheKey = this.shs.getCurrentProductId(indexable); // current
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,if (!cache.getParentCategoriesByProduct().containsKey(cacheKey)) {
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,cacheKey = sandBoxHelper.getOriginalId(cacheKey); // parent
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,cacheKey = shs.getIndexableId(indexable); // master
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,// TODO: figure this out more generally; this doesn't work for CMS content
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,// The explicit categories are the ones defined by the product itself
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,if (cache.getParentCategoriesByProduct().containsKey(cacheKey)) {
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,for (Long categoryId : cache.getParentCategoriesByProduct().get(cacheKey)) {
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,"document.addField(shs.getExplicitCategoryFieldName(), shs.getCategoryId(categoryId));"
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,String categorySortFieldName = shs.getCategorySortFieldName(shs.getCategoryId(categoryId));
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,"String displayOrderKey = categoryId + ""-"" + cacheKey;"
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,"Long displayOrder = convertDisplayOrderToLong(cache, displayOrderKey);"
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,if (document.getField(categorySortFieldName) == null) {
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,"document.addField(categorySortFieldName, displayOrder);"
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,// This is the entire tree of every category defined on the product
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,"buildFullCategoryHierarchy(document, cache, categoryId, new HashSet<Long>());"
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,import java.util.Arrays;
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,boolean cacheOperationManaged = false;
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,try {
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,CatalogStructure cache = SolrIndexCachedOperation.getCache();
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,if (cache != null) {
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,cacheOperationManaged = true;
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,} else {
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,cache = new CatalogStructure();
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,SolrIndexCachedOperation.setCache(cache);
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,"solrIndexDao.populateProductCatalogStructure(Arrays.asList(shs.getCurrentProductId(indexable)), SolrIndexCachedOperation.getCache());"
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,}
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,// Add the namespace and ID fields for this product
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,"document.addField(shs.getNamespaceFieldName(), shs.getCurrentNamespace());"
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,"document.addField(shs.getIdFieldName(), shs.getSolrDocumentId(document, indexable));"
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,"document.addField(shs.getIndexableIdFieldName(), shs.getIndexableId(indexable));"
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,"extensionManager.getProxy().attachAdditionalBasicFields(indexable, document, shs);"
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,Long cacheKey = this.shs.getCurrentProductId(indexable); // current
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,cacheKey = sandBoxHelper.getOriginalId(cacheKey); // parent
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,if (!cache.getParentCategoriesByProduct().containsKey(cacheKey)) {
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,cacheKey = shs.getIndexableId(indexable); // master
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,// TODO: figure this out more generally; this doesn't work for CMS content
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,// The explicit categories are the ones defined by the product itself
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,if (cache.getParentCategoriesByProduct().containsKey(cacheKey)) {
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,for (Long categoryId : cache.getParentCategoriesByProduct().get(cacheKey)) {
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,"document.addField(shs.getExplicitCategoryFieldName(), shs.getCategoryId(categoryId));"
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,String categorySortFieldName = shs.getCategorySortFieldName(shs.getCategoryId(categoryId));
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,"String displayOrderKey = categoryId + ""-"" + cacheKey;"
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,"Long displayOrder = convertDisplayOrderToLong(cache, displayOrderKey);"
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,if (document.getField(categorySortFieldName) == null) {
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,"document.addField(categorySortFieldName, displayOrder);"
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,// This is the entire tree of every category defined on the product
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,"buildFullCategoryHierarchy(document, cache, categoryId, new HashSet<Long>());"
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,} finally {
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,if (!cacheOperationManaged) {
76f4733440a25727e214c08a859a21c961a0b360,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,SolrIndexCachedOperation.clearCache();
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,CatalogStructure cache = SolrIndexCachedOperation.getCache();
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (cache == null) {
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"LOG.warn(""Consider using SolrIndexService.performCachedOperation() in combination with "" +"
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"""SolrIndexService.buildIncrementalIndex() for better caching performance during solr indexing"");"
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,}
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,// Add the namespace and ID fields for this product
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"document.addField(shs.getNamespaceFieldName(), shs.getCurrentNamespace());"
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"document.addField(shs.getIdFieldName(), shs.getSolrDocumentId(document, indexable));"
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"document.addField(shs.getIndexableIdFieldName(), shs.getIndexableId(indexable));"
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"extensionManager.getProxy().attachAdditionalBasicFields(indexable, document, shs);"
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,Long cacheKey = this.shs.getCurrentProductId(indexable); // current
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (!cache.getParentCategoriesByProduct().containsKey(cacheKey)) {
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,cacheKey = sandBoxHelper.getOriginalId(cacheKey); // parent
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,cacheKey = shs.getIndexableId(indexable); // master
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,// TODO: figure this out more generally; this doesn't work for CMS content
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,// The explicit categories are the ones defined by the product itself
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (cache.getParentCategoriesByProduct().containsKey(cacheKey)) {
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,for (Long categoryId : cache.getParentCategoriesByProduct().get(cacheKey)) {
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"document.addField(shs.getExplicitCategoryFieldName(), shs.getCategoryId(categoryId));"
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,String categorySortFieldName = shs.getCategorySortFieldName(shs.getCategoryId(categoryId));
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"String displayOrderKey = categoryId + ""-"" + cacheKey;"
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"Long displayOrder = convertDisplayOrderToLong(cache, displayOrderKey);"
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (document.getField(categorySortFieldName) == null) {
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"document.addField(categorySortFieldName, displayOrder);"
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,// This is the entire tree of every category defined on the product
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"buildFullCategoryHierarchy(document, cache, categoryId, new HashSet<Long>());"
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import java.util.Arrays;
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,boolean cacheOperationManaged = false;
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,try {
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,CatalogStructure cache = SolrIndexCachedOperation.getCache();
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (cache != null) {
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,cacheOperationManaged = true;
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,} else {
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,cache = new CatalogStructure();
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,SolrIndexCachedOperation.setCache(cache);
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"solrIndexDao.populateProductCatalogStructure(Arrays.asList(shs.getCurrentProductId(indexable)), SolrIndexCachedOperation.getCache());"
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,}
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,// Add the namespace and ID fields for this product
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"document.addField(shs.getNamespaceFieldName(), shs.getCurrentNamespace());"
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"document.addField(shs.getIdFieldName(), shs.getSolrDocumentId(document, indexable));"
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"document.addField(shs.getIndexableIdFieldName(), shs.getIndexableId(indexable));"
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"extensionManager.getProxy().attachAdditionalBasicFields(indexable, document, shs);"
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,Long cacheKey = this.shs.getCurrentProductId(indexable); // current
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,cacheKey = sandBoxHelper.getOriginalId(cacheKey); // parent
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (!cache.getParentCategoriesByProduct().containsKey(cacheKey)) {
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,cacheKey = shs.getIndexableId(indexable); // master
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,// TODO: figure this out more generally; this doesn't work for CMS content
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,// The explicit categories are the ones defined by the product itself
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (cache.getParentCategoriesByProduct().containsKey(cacheKey)) {
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,for (Long categoryId : cache.getParentCategoriesByProduct().get(cacheKey)) {
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"document.addField(shs.getExplicitCategoryFieldName(), shs.getCategoryId(categoryId));"
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,String categorySortFieldName = shs.getCategorySortFieldName(shs.getCategoryId(categoryId));
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"String displayOrderKey = categoryId + ""-"" + cacheKey;"
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"Long displayOrder = convertDisplayOrderToLong(cache, displayOrderKey);"
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (document.getField(categorySortFieldName) == null) {
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"document.addField(categorySortFieldName, displayOrder);"
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,// This is the entire tree of every category defined on the product
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"buildFullCategoryHierarchy(document, cache, categoryId, new HashSet<Long>());"
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,} finally {
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (!cacheOperationManaged) {
76f4733440a25727e214c08a859a21c961a0b360,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,SolrIndexCachedOperation.clearCache();
1014e7ffdbd5751648bdb99a4d14572632e1d2c0,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,if (cache != null && !cache.getParentCategoriesByProduct().containsKey(cacheKey)) {
1014e7ffdbd5751648bdb99a4d14572632e1d2c0,b6bca92dc0528e57c7737aea1a01841336f4e38c,added,0,if (cache != null && cache.getParentCategoriesByProduct().containsKey(cacheKey)) {
1014e7ffdbd5751648bdb99a4d14572632e1d2c0,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,if (!cache.getParentCategoriesByProduct().containsKey(cacheKey)) {
1014e7ffdbd5751648bdb99a4d14572632e1d2c0,b6bca92dc0528e57c7737aea1a01841336f4e38c,deleted,1,if (cache.getParentCategoriesByProduct().containsKey(cacheKey)) {
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,return filterIndexableSkus(skus);
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,} else {
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"return productDao.readAllActiveProducts(page, pageSize);"
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,}
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public List<Sku> filterIndexableSkus(List<Sku> skus) {
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,ArrayList<Sku> skusToIndex = new ArrayList<Sku>();
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (CollectionUtils.isNotEmpty(skus)) {
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,for (Sku sku : skus) {
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"//If the sku is not active, don't index it..."
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (!sku.isActive()) {
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,continue;
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,//If this is the default sku and the product has product options
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,//and is not allowed to be sold without product options
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (sku.getDefaultProduct() != null
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,&& !sku.getProduct().getCanSellWithoutOptions()
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,&& !sku.getProduct().getAdditionalSkus().isEmpty()) {
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (sku.getDefaultProduct() instanceof ProductBundle) {
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,skusToIndex.add(sku);
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,return skusToIndex;
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,ArrayList<Sku> skusToIndex = new ArrayList<Sku>();
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (skus != null && !skus.isEmpty()) {
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,for (Sku sku : skus) {
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"//If the sku is not active, don't index it..."
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (!sku.isActive()) {
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,continue;
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,}
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,//If this is the default sku and the product has product options
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,//and is not allowed to be sold without product options
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (sku.getDefaultProduct() != null
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,&& !sku.getProduct().getCanSellWithoutOptions()
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,&& !sku.getProduct().getAdditionalSkus().isEmpty()) {
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (sku.getDefaultProduct() instanceof ProductBundle) {
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,skusToIndex.add(sku);
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,return skusToIndex;
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,} else {
e4833d4db2a0be820b49d9c0f1a944200380af86,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"return productDao.readAllActiveProducts(page, pageSize);"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void beforeCount() {
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,// By default we want to do nothing here
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,}
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,@Override
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void afterCount() {
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void beforeRead() {
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void afterRead() {
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void beforeBuild() {
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void afterBuild() {
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.broadleafcommerce.common.exception.ServiceException;
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import java.io.IOException;
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public void beforeIndexOperation() throws ServiceException {
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"LOG.info(""Deleting the reindex core prior to rebuilding the index"");"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,indexService.deleteAllNamespaceDocuments(getSolrServerForIndexing());
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public void afterIndexOperation() throws ServiceException, IOException {"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,indexService.optimizeIndex(getSolrServerForIndexing());
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,// Swap the active and the reindex cores
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,shs.swapActiveCores();
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void beforeCount() {
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,// By default we want to do nothing here
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,}
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,@Override
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void afterCount() {
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void beforeRead() {
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void afterRead() {
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void beforeBuild() {
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void afterBuild() {
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.broadleafcommerce.common.exception.ServiceException;
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import java.io.IOException;
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public void beforeIndexOperation() {
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,// unimplemented
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public void afterIndexOperation() throws ServiceException, IOException {"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,indexService.optimizeIndex(getSolrServerForIndexing());
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,*  are executed in order during different phases of {@link SolrIndexService#executeSolrIndexOperation(SolrIndexOperation)}.
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"* Executes before the count, this is where any filters or setup for counting can be taken care of"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void beforeCount();
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,/**
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"* Executes after the count, this is where any filters or cleanup for counting can be taken care of"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,*/
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void afterCount();
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"* Executes before the read, this is where any filters or setup for reading can be taken care of"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void beforeRead();
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"* Executes after the read, this is where any filters or cleanup for reading can be taken care of"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void afterRead();
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"* Executes before building each page, this is where any filters or setup for building can be taken care of"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void beforeBuild();
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"* Executes after building each page, this is where any filters or cleanup for building can be taken care of"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void afterBuild();
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import java.io.IOException;
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,*  are executed in order during different phases of {@link SolrIndexService#rebuildIndex(SolrIndexOperation)}.
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* Any processing that is required to be performed prior to the index operation executing
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public void beforeIndexOperation() throws ServiceException;
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* After this index operation is complete, usually does a {@link SolrIndexService#optimizeIndex(SolrServer)}"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public void afterIndexOperation() throws ServiceException, IOException;"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,/**
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,* Executed before we do any indexing when rebuilding the current index. Usually this handles deleting the current index.
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,*
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,* @throws ServiceException
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,*/
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void preIndexing() throws ServiceException;
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,* Handles all the indexing for the current index rebuild. This is where all of the SolrIndexOperation's need to be executed and the index needs to be built.
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,* This is the method that should be overridden to specify which operations should be run to build the correct index.
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,* @throws IOException
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public void doIndexing() throws IOException, ServiceException;"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,* Executed after we do any indexing when rebuilding the current index. Usually this handles optimizing the index and swapping the cores.
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public void postIndexing() throws IOException, ServiceException;"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,* Creates the Core SolrIndexOperation for rebuilding the current index. This is the primary index operation used to rebuild the index.
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,* @return a SolrIndexOperation capable of rebuilding the current index
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public SolrIndexOperation getCoreIndexOperation();
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,* Executes the given SolrIndexOperation to properly rebuild the index
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,* @param operation the SolrIndexOperation that is to be executed
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public void executeSolrIndexOperation(SolrIndexOperation operation) throws ServiceException, IOException;"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public void rebuildIndex(SolrIndexOperation process) throws ServiceException, IOException;"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"LOG.info(""Rebuilding the solr index..."");"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,StopWatch s = new StopWatch();
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,try{
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,preIndexing();
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,doIndexing();
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,} finally {
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,postIndexing();
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,}
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"LOG.info(String.format(""Finished building index in %s"", s.toLapString()));"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,@Override
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void preIndexing() throws ServiceException {
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,deleteAllNamespaceDocuments(SolrContext.getReindexServer());
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public void doIndexing() throws IOException, ServiceException {"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,executeSolrIndexOperation(getCoreIndexOperation());
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public void postIndexing() throws IOException, ServiceException {"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,// this is required to be at the very very very end after rebuilding the whole index
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,optimizeIndex(SolrContext.getReindexServer());
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,// Swap the active and the reindex cores
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,shs.swapActiveCores();
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public SolrIndexOperation getCoreIndexOperation() {
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"return new GlobalSolrFullReIndexOperation(this, shs, errorOnConcurrentReIndex) {"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,};
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public void executeSolrIndexOperation(final SolrIndexOperation operation) throws ServiceException, IOException {"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,final Long numItemsToIndex;
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,try {
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,operation.beforeCount();
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,numItemsToIndex = operation.countIndexables();
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,operation.afterCount();
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,List<? extends Indexable> indexables;
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,operation.beforeRead();
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"indexables = operation.readIndexables(page, pageSize);"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,operation.afterRead();
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,operation.beforeBuild();
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,operation.buildPage(indexables);
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,operation.afterBuild();
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"rebuildIndex(new GlobalSolrFullReIndexOperation(this, shs, errorOnConcurrentReIndex) {"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,});
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public void rebuildIndex(final SolrIndexOperation operation) throws ServiceException, IOException {"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,operation.beforeIndexOperation();
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,final Long numItemsToIndex = operation.countIndexables();
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,operation.afterIndexOperation();
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"List<? extends Indexable> indexables = operation.readIndexables(page, pageSize);"
c50b5075f6626870f0cbc367e9c4d113d9ecba33,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,operation.buildPage(indexables);
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,import org.broadleafcommerce.common.presentation.*;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,import org.hibernate.annotations.*;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,import javax.persistence.CascadeType;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,import javax.persistence.*;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,import javax.persistence.Entity;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,import javax.persistence.Table;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"group = AdminUserAdminPresentation.GroupName.User, prominent = true, defaultValue = ""My Name"")"
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"group = AdminUserAdminPresentation.GroupName.User, prominent = true, defaultValue = ""New Admin User"")"
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"@AdminPresentation(friendlyName = ""AdminUserImpl_Admin_Email_Address"", order = 3000, group = AdminUserAdminPresentation.GroupName.User, defaultValue = ""my-email@website.com"")"
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentation;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentationCollection;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentationOperationTypes;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import org.broadleafcommerce.common.presentation.ConfigurationItem;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import org.broadleafcommerce.common.presentation.ValidationConfiguration;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import org.hibernate.annotations.BatchSize;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import org.hibernate.annotations.CacheConcurrencyStrategy;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import org.hibernate.annotations.GenericGenerator;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import org.hibernate.annotations.Index;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import javax.persistence.CascadeType;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import javax.persistence.Column;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import javax.persistence.Entity;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import javax.persistence.FetchType;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import javax.persistence.GeneratedValue;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import javax.persistence.Id;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import javax.persistence.Inheritance;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import javax.persistence.InheritanceType;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import javax.persistence.JoinColumn;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import javax.persistence.JoinTable;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import javax.persistence.ManyToMany;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import javax.persistence.ManyToOne;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import javax.persistence.MapKey;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import javax.persistence.OneToMany;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import javax.persistence.Table;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,import javax.persistence.Transient;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,"group = AdminUserAdminPresentation.GroupName.User, prominent = true)"
57cacd1b385c19a275b9d5fb6f618a90badb20fb,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,"@AdminPresentation(friendlyName = ""AdminUserImpl_Admin_Email_Address"", order = 3000, group = AdminUserAdminPresentation.GroupName.User)"
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.*;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.hibernate.annotations.*;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.CascadeType;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.*;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.Entity;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.Table;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"group = AdminUserAdminPresentation.GroupName.User, prominent = true, defaultValue = ""My Name"")"
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"group = AdminUserAdminPresentation.GroupName.User, prominent = true, defaultValue = ""New Admin User"")"
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""AdminUserImpl_Admin_Email_Address"", order = 3000, group = AdminUserAdminPresentation.GroupName.User, defaultValue = ""my-email@website.com"")"
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentation;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentationCollection;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentationOperationTypes;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.presentation.ConfigurationItem;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.presentation.ValidationConfiguration;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.hibernate.annotations.BatchSize;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.hibernate.annotations.CacheConcurrencyStrategy;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.hibernate.annotations.GenericGenerator;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.hibernate.annotations.Index;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.CascadeType;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Column;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Entity;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.FetchType;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.GeneratedValue;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Id;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Inheritance;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.InheritanceType;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.JoinColumn;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.JoinTable;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.ManyToMany;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.ManyToOne;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.MapKey;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.OneToMany;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Table;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Transient;
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"group = AdminUserAdminPresentation.GroupName.User, prominent = true)"
57cacd1b385c19a275b9d5fb6f618a90badb20fb,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""AdminUserImpl_Admin_Email_Address"", order = 3000, group = AdminUserAdminPresentation.GroupName.User)"
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,import org.broadleafcommerce.core.search.dao.SearchFacetDao;
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,import org.broadleafcommerce.core.search.dao.SearchFieldDao;
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,import org.broadleafcommerce.core.search.domain.SearchFacet;
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,import org.broadleafcommerce.core.search.domain.SearchField;
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"@Resource(name = ""blSearchFacetDao"")"
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,protected SearchFacetDao searchFacetDao;
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"@Resource(name = ""blSearchFieldDao"")"
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,protected SearchFieldDao searchFieldDao;
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,// Determine if field is searchable (check if it has a search field entry in BLC_SEARCH_FIELD)
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,SearchField searchField = searchFieldDao.readSearchFieldForField(field);
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"// If we find a SearchField entry for this field, then this field is searchable"
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (searchField != null) {
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,List<FieldType> searchableFieldTypes = searchField.getSearchableFieldTypes();
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"// For each of its search field types, get the property values, and add a field to the document for each property value"
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,// Determine if field is faceted (check if it has a search facet entry in BLC_SEARCH_FACET)
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,SearchFacet searchFacet = searchFacetDao.readSearchFacetForField(field);
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"// If we find a SearchFacet entry for this field, then this field is faceted"
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (searchFacet != null) {
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"// Get the FacetFieldType for the SearchFacet, get the property values, and add a field to the document for each property value"
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,FieldType facetType = FieldType.getInstance(searchFacet.getFacetFieldType());
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (facetType != null) {
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"Map<String, Object> propertyValues = getPropertyValues(indexable, field, facetType, locales);"
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,// Build out the field for every prefix
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"for (Entry<String, Object> entry : propertyValues.entrySet()) {"
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,String prefix = entry.getKey();
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"prefix = StringUtils.isBlank(prefix) ? prefix : prefix + ""_"";"
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"String solrFacetPropertyName = shs.getPropertyNameForFieldFacet(field, prefix, facetType);"
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,Object value = entry.getValue();
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (!addedProperties.contains(solrFacetPropertyName)) {
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"document.addField(solrFacetPropertyName, value);"
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,}
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (field.getSearchable()) {
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,List<FieldType> searchableFieldTypes = shs.getSearchableFieldTypes(field);
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,FieldType facetType = field.getFacetFieldType();
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (facetType != null) {
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"Map<String, Object> propertyValues = getPropertyValues(indexable, field, facetType, locales);"
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,// Build out the field for every prefix
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"for (Entry<String, Object> entry : propertyValues.entrySet()) {"
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,String prefix = entry.getKey();
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"prefix = StringUtils.isBlank(prefix) ? prefix : prefix + ""_"";"
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"String solrFacetPropertyName = shs.getPropertyNameForFieldFacet(field, prefix);"
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,Object value = entry.getValue();
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (!addedProperties.contains(solrFacetPropertyName)) {
4e4f61a16121b6ab1b18b99886dd0f4de637f089,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"document.addField(solrFacetPropertyName, value);"
c838964f6095049ed0e0079d9962754ce32fa1e5,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,} else if (SearchFieldInfo.SEARCH_FIELD_SOLR_FIELD_TYPE.get(fieldType.getType()) != null) {
c838964f6095049ed0e0079d9962754ce32fa1e5,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,adminInstance.setFacetFieldType(SearchFieldInfo.SEARCH_FIELD_SOLR_FIELD_TYPE.get(fieldType.getType()).getType());
c838964f6095049ed0e0079d9962754ce32fa1e5,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,} else if (SearchFieldInfo.SEARCH_FIELD_SOLR_FIELD_TYPE.get(fieldType) != null) {
c838964f6095049ed0e0079d9962754ce32fa1e5,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,adminInstance.setFacetFieldType(SearchFieldInfo.SEARCH_FIELD_SOLR_FIELD_TYPE.get(fieldType).getType());
c838964f6095049ed0e0079d9962754ce32fa1e5,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,searchableFieldTypes.add(SearchFieldInfo.SEARCH_FIELD_SOLR_FIELD_TYPE.get(fieldType.getType()));
c838964f6095049ed0e0079d9962754ce32fa1e5,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,searchableFieldTypes.add(SearchFieldInfo.SEARCH_FIELD_SOLR_FIELD_TYPE.get(fieldType));
c838964f6095049ed0e0079d9962754ce32fa1e5,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,/**
c838964f6095049ed0e0079d9962754ce32fa1e5,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* Gets the abbreviation for this search field
c838964f6095049ed0e0079d9962754ce32fa1e5,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,*
c838964f6095049ed0e0079d9962754ce32fa1e5,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* @return
c838964f6095049ed0e0079d9962754ce32fa1e5,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,*/
c838964f6095049ed0e0079d9962754ce32fa1e5,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,public String getAbbreviation();
c838964f6095049ed0e0079d9962754ce32fa1e5,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* Sets the abbreviation for this search field
c838964f6095049ed0e0079d9962754ce32fa1e5,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* @param abbreviation
c838964f6095049ed0e0079d9962754ce32fa1e5,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,public void setAbbreviation(String abbreviation);
c838964f6095049ed0e0079d9962754ce32fa1e5,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"@Column(name = ""ABBREVIATION"")"
c838964f6095049ed0e0079d9962754ce32fa1e5,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"@AdminPresentation(friendlyName = ""SearchFieldImpl_abbreviation"", group = ""SearchFieldImpl_description"","
c838964f6095049ed0e0079d9962754ce32fa1e5,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"order = 2000, prominent = true, gridOrder = 2000)"
c838964f6095049ed0e0079d9962754ce32fa1e5,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,protected String abbreviation;
c838964f6095049ed0e0079d9962754ce32fa1e5,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,@Override
c838964f6095049ed0e0079d9962754ce32fa1e5,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,public String getAbbreviation() {
c838964f6095049ed0e0079d9962754ce32fa1e5,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,return abbreviation;
c838964f6095049ed0e0079d9962754ce32fa1e5,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,}
c838964f6095049ed0e0079d9962754ce32fa1e5,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,public void setAbbreviation(String abbreviation) {
c838964f6095049ed0e0079d9962754ce32fa1e5,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,this.abbreviation = abbreviation;
c838964f6095049ed0e0079d9962754ce32fa1e5,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,cloned.setAbbreviation(abbreviation);
4a629845e667041e13039624a0c26a7c707adc8b,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,if (tabMetadataMap != null) {
4a629845e667041e13039624a0c26a7c707adc8b,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,for (String tabKey : tabMetadataMap.keySet()) {
4a629845e667041e13039624a0c26a7c707adc8b,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,"Map<String, GroupMetadata> groupMetadataMap = tabMetadataMap.get(tabKey).getGroupMetadata();"
4a629845e667041e13039624a0c26a7c707adc8b,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,for (String groupKey : groupMetadataMap.keySet()) {
4a629845e667041e13039624a0c26a7c707adc8b,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,if (groupKey.equals(groupName) || groupMetadataMap.get(groupKey).getGroupName().equals(groupName)) {
4a629845e667041e13039624a0c26a7c707adc8b,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,groupName = groupMetadataMap.get(groupKey).getGroupName();
4a629845e667041e13039624a0c26a7c707adc8b,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,groupFound = true;
4a629845e667041e13039624a0c26a7c707adc8b,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,break;
4a629845e667041e13039624a0c26a7c707adc8b,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,}
4a629845e667041e13039624a0c26a7c707adc8b,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,if (groupFound) {
4a629845e667041e13039624a0c26a7c707adc8b,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,if (tabKey.equals(tabName) || tabMetadataMap.get(tabKey).getTabName().equals(tabName)) {
4a629845e667041e13039624a0c26a7c707adc8b,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,tabName = tabMetadataMap.get(tabKey).getTabName();
4a629845e667041e13039624a0c26a7c707adc8b,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,deleted,1,for (String tabKey : tabMetadataMap.keySet()) {
4a629845e667041e13039624a0c26a7c707adc8b,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,deleted,1,"Map<String, GroupMetadata> groupMetadataMap = tabMetadataMap.get(tabKey).getGroupMetadata();"
4a629845e667041e13039624a0c26a7c707adc8b,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,deleted,1,for (String groupKey : groupMetadataMap.keySet()) {
4a629845e667041e13039624a0c26a7c707adc8b,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,deleted,1,if (groupKey.equals(groupName) || groupMetadataMap.get(groupKey).getGroupName().equals(groupName)) {
4a629845e667041e13039624a0c26a7c707adc8b,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,deleted,1,groupName = groupMetadataMap.get(groupKey).getGroupName();
4a629845e667041e13039624a0c26a7c707adc8b,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,deleted,1,groupFound = true;
4a629845e667041e13039624a0c26a7c707adc8b,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,deleted,1,}
4a629845e667041e13039624a0c26a7c707adc8b,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,deleted,1,if (groupFound) {
4a629845e667041e13039624a0c26a7c707adc8b,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,deleted,1,break;
4a629845e667041e13039624a0c26a7c707adc8b,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,deleted,1,if (tabKey.equals(tabName) || tabMetadataMap.get(tabKey).getTabName().equals(tabName)) {
4a629845e667041e13039624a0c26a7c707adc8b,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,deleted,1,tabName = tabMetadataMap.get(tabKey).getTabName();
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,FieldType fieldType = FieldType.getInstance(adminInstance.getField().getFieldType());
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,adminInstance.setFacetFieldType(fieldType.getType());
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.core.catalog.service.SearchFieldInfo;
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.core.search.service.type.SearchFieldType;
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,SearchFieldType fieldType = SearchFieldType.getInstance(adminInstance.getField().getFieldType());
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,if (fieldType.equals(SearchFieldType.STRING)) {
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,adminInstance.setFacetFieldType(FieldType.STRING.getType());
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,} else if (SearchFieldInfo.SEARCH_FIELD_SOLR_FIELD_TYPE.get(fieldType.getType()) != null) {
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,adminInstance.setFacetFieldType(SearchFieldInfo.SEARCH_FIELD_SOLR_FIELD_TYPE.get(fieldType.getType()).getType());
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,}
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,added,0,FieldType fieldType = FieldType.getInstance(adminInstance.getField().getFieldType());
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,added,0,searchableFieldTypes.add(fieldType);
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import org.broadleafcommerce.core.catalog.service.SearchFieldInfo;
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import org.broadleafcommerce.core.search.service.type.SearchFieldType;
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,SearchFieldType fieldType = SearchFieldType.getInstance(adminInstance.getField().getFieldType());
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,searchableFieldTypes.add(SearchFieldInfo.SEARCH_FIELD_SOLR_FIELD_TYPE.get(fieldType.getType()));
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,FieldType fieldType = FieldType.getInstance(adminInstance.getField().getFieldType());
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,searchableFieldTypes.add(fieldType);
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.core.catalog.service.SearchFieldInfo;
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.core.search.service.type.SearchFieldType;
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,SearchFieldType fieldType = SearchFieldType.getInstance(adminInstance.getField().getFieldType());
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,searchableFieldTypes.add(SearchFieldInfo.SEARCH_FIELD_SOLR_FIELD_TYPE.get(fieldType.getType()));
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,/*
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* #%L
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* BroadleafCommerce Framework
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* %%
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* Copyright (C) 2009 - 2015 Broadleaf Commerce
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"* Licensed under the Apache License, Version 2.0 (the ""License"");"
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* you may not use this file except in compliance with the License.
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* You may obtain a copy of the License at
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,*
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,*       http://www.apache.org/licenses/LICENSE-2.0
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"* Unless required by applicable law or agreed to in writing, software"
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"* distributed under the License is distributed on an ""AS IS"" BASIS,"
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* See the License for the specific language governing permissions and
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* limitations under the License.
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* #L%
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,*/
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,package org.broadleafcommerce.core.catalog.service;
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.core.search.domain.solr.FieldType;
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.core.search.service.type.SearchFieldType;
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import java.util.HashMap;
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import java.util.Map;
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,/**
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* @author Chad Harchar (charchar)
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,public class SearchFieldInfo {
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,protected SearchFieldInfo(){
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,//Protected constructor to hide the implicit public one.
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,}
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"public static final Map<String, FieldType> SEARCH_FIELD_SOLR_FIELD_TYPE = new HashMap<String, FieldType>();"
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,static {
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"SEARCH_FIELD_SOLR_FIELD_TYPE.put(SearchFieldType.BOOLEAN.getType(), FieldType.BOOLEAN);"
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"SEARCH_FIELD_SOLR_FIELD_TYPE.put(SearchFieldType.DATE.getType(), FieldType.DATE);"
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"SEARCH_FIELD_SOLR_FIELD_TYPE.put(SearchFieldType.DECIMAL.getType(), FieldType.DOUBLE);"
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"SEARCH_FIELD_SOLR_FIELD_TYPE.put(SearchFieldType.INTEGER.getType(), FieldType.INT);"
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"SEARCH_FIELD_SOLR_FIELD_TYPE.put(SearchFieldType.MONEY.getType(), FieldType.PRICE);"
95282cc26adada35adba83169075f4349f87630c,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"SEARCH_FIELD_SOLR_FIELD_TYPE.put(SearchFieldType.STRING.getType(), FieldType.TEXT);"
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"broadleafEnumeration = ""org.broadleafcommerce.core.search.domain.solr.FieldType"","
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"broadleafEnumeration = ""org.broadleafcommerce.core.search.service.type.SearchFieldType"","
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,/*
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* #%L
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* BroadleafCommerce Framework
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* %%
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* Copyright (C) 2009 - 2015 Broadleaf Commerce
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"* Licensed under the Apache License, Version 2.0 (the ""License"");"
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* you may not use this file except in compliance with the License.
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* You may obtain a copy of the License at
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,*
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,*       http://www.apache.org/licenses/LICENSE-2.0
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"* Unless required by applicable law or agreed to in writing, software"
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"* distributed under the License is distributed on an ""AS IS"" BASIS,"
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* See the License for the specific language governing permissions and
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* limitations under the License.
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* #L%
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,*/
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,package org.broadleafcommerce.core.search.service.type;
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import org.apache.commons.lang3.builder.EqualsBuilder;
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import org.broadleafcommerce.common.BroadleafEnumerationType;
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import java.io.Serializable;
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import java.util.HashMap;
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import java.util.Map;
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,/**
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* @author Chad Harchar (charchar)
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"public class SearchFieldType implements Serializable, BroadleafEnumerationType {"
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,private static final long serialVersionUID = 1L;
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"private static final Map<String, SearchFieldType> TYPES = new HashMap<String, SearchFieldType>();"
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"//standard persistence field types, which can be persisted as custom fields in an attribute map"
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"public static final SearchFieldType BOOLEAN = new SearchFieldType(""BOOLEAN"", ""Boolean"");"
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"public static final SearchFieldType INTEGER = new SearchFieldType(""INTEGER"", ""Integer"");"
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"public static final SearchFieldType MONEY = new SearchFieldType(""MONEY"", ""Money"");"
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"public static final SearchFieldType DECIMAL = new SearchFieldType(""DECIMAL"", ""Decimal"");"
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"public static final SearchFieldType DATE = new SearchFieldType(""DATE"", ""Date"");"
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"public static final SearchFieldType STRING = new SearchFieldType(""STRING"", ""Text"");"
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,public static SearchFieldType getInstance(final String type) {
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,return TYPES.get(type);
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,}
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,private String type;
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,private String friendlyType;
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,public SearchFieldType() {
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,//do nothing
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"public SearchFieldType(final String type, final String friendlyType) {"
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,this.friendlyType = friendlyType;
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,setType(type);
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,@Override
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,public String getType() {
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,return type;
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,public String getFriendlyType() {
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,return friendlyType;
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,private void setType(final String type) {
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,this.type = type;
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,if (!TYPES.containsKey(type)) {
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"TYPES.put(type, this);"
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,public int hashCode() {
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,final int prime = 31;
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,int result = 1;
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,result = prime * result + ((type == null) ? 0 : type.hashCode());
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,return result;
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,public boolean equals(Object obj) {
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,if (obj != null && getClass().isAssignableFrom(obj.getClass())) {
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,SearchFieldType other = (SearchFieldType) obj;
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,return new EqualsBuilder()
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,".append(type, other.type)"
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,.build();
95282cc26adada35adba83169075f4349f87630c,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,return false;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,import org.broadleafcommerce.common.extension.ExtensionResultStatusType;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,ExtensionResultStatusType result = ExtensionResultStatusType.NOT_HANDLED;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"result = extensionManager.getProxy().addtoSearchableFields(persistencePackage, adminInstance);"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,}
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,if (result.equals(ExtensionResultStatusType.NOT_HANDLED) && adminInstance.getFacetFieldType() == null) {
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"// if we don't have a facetFieldType set, then set a default value"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,adminInstance.setFacetFieldType(FieldType.STRING.getType());
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,FieldType fieldType = FieldType.getInstance(adminInstance.getField().getFieldType());
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,adminInstance.setFacetFieldType(fieldType.getType());
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"extensionManager.getProxy().addtoSearchableFields(persistencePackage, adminInstance);"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import org.broadleafcommerce.common.extension.ExtensionResultStatusType;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import org.broadleafcommerce.common.presentation.client.OperationType;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import org.broadleafcommerce.common.presentation.client.PersistencePerspectiveItemType;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import org.broadleafcommerce.core.search.domain.SearchFieldImpl;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import org.broadleafcommerce.core.search.domain.SearchFieldTypeImpl;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import org.broadleafcommerce.openadmin.dto.ForeignKey;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import org.broadleafcommerce.openadmin.dto.OperationTypes;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import org.broadleafcommerce.openadmin.dto.Property;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import org.broadleafcommerce.openadmin.dto.SectionCrumb;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import org.broadleafcommerce.openadmin.server.service.persistence.PersistenceManager;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import org.broadleafcommerce.openadmin.server.service.persistence.PersistenceManagerFactory;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import org.thymeleaf.util.ListUtils;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,ExtensionResultStatusType result = ExtensionResultStatusType.NOT_HANDLED;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,if (extensionManager != null) {
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"result = extensionManager.getProxy().addtoSearchableFields(persistencePackage, adminInstance);"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,}
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,if (result.equals(ExtensionResultStatusType.NOT_HANDLED)) {
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,// If there is no searchable field types then we need to add a default as String
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,if (ListUtils.isEmpty(adminInstance.getSearchableFieldTypes())) {
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"PersistencePackage pp = createPersistencePackage(adminInstance, FieldType.STRING);"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,PersistenceManager pm = PersistenceManagerFactory.getPersistenceManager();
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,pm.add(pp);
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"protected PersistencePackage createPersistencePackage(SearchField searchField, FieldType fieldType) {"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,PersistencePackage pp = new PersistencePackage();
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,pp.setCeilingEntityFullyQualifiedClassname(SearchFieldTypeImpl.class.getName());
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,pp.setSecurityCeilingEntityFullyQualifiedClassname(SearchFieldTypeImpl.class.getName());
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"pp.setSectionEntityField(""searchableFieldTypes"");"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"PersistencePerspective perspective = new PersistencePerspective(new OperationTypes(OperationType.BASIC, OperationType.BASIC, OperationType.BASIC,"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"OperationType.BASIC, OperationType.BASIC), new String[]{}, new ForeignKey[]{});"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"ForeignKey foreignKey = new ForeignKey(""searchField"", SearchFieldImpl.class.getName());"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,foreignKey.setOriginatingField(pp.getSectionEntityField());
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"foreignKey.setDisplayValueProperty(""name"");"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"perspective.addPersistencePerspectiveItem(PersistencePerspectiveItemType.FOREIGNKEY, foreignKey);"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,pp.setPersistencePerspective(perspective);
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,Entity entity = new Entity();
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"entity.setType(new String[] { ""org.broadleafcommerce.core.search.domain.SearchFieldTypeImpl"" });"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,List<Property> properties = new ArrayList<Property>();
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,{
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,Property prop = new Property();
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"prop.setName(""searchField"");"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,prop.setValue(String.valueOf(searchField.getId()));
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,prop.setIsDirty(true);
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,properties.add(prop);
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"prop.setName(""searchableFieldType"");"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,prop.setValue(fieldType.getType());
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,entity.setProperties(properties.toArray(new Property[properties.size()]));
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,pp.setEntity(entity);
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,pp.setRequestingEntityName(searchField.getField().getFriendlyName());
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,SectionCrumb section = new SectionCrumb();
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,section.setSectionIdentifier(SearchFieldImpl.class.getName());
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,section.setSectionId(String.valueOf(searchField.getId()));
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,pp.setSectionCrumbs(new SectionCrumb[] { section });
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,return pp;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,FieldType fieldType = FieldType.getInstance(adminInstance.getField().getFieldType());
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,List<FieldType> searchableFieldTypes = new ArrayList<FieldType>();
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,searchableFieldTypes.add(fieldType);
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,adminInstance.setSearchableFieldTypes(searchableFieldTypes);
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,if (extensionManager != null) {
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"extensionManager.getProxy().addtoSearchableFields(persistencePackage, adminInstance);"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,* Gets the searchConfigs. Note that a concrete implementation or usage of this class is not available
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* Sets the searchableFieldTypes
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,*
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* @see #getSearchableFieldTypes()
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* @param searchableFieldTypes
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* @deprecated this is now part of SearchField
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,*/
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,@Deprecated
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,public void setSearchableFieldTypes(List<FieldType> searchableFieldTypes);
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,/**
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"* Gets the dynamic searchable field types. For example, in solr, if you wanted to index a field as both"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"* text and string, you would have two searchable field types, String and Text"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* @return the searchable types for this field
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,public List<FieldType> getSearchableFieldTypes();
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* Gets the {@org.broadleafcommerce.core.search.service.type.FieldType} of this field.  This is used by
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* SearchField and SearchFacet to determine searchableFieldTypes and facetFieldType respectively.
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* @return
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,public String getFieldType();
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* Sets the {@org.broadleafcommerce.core.search.service.type.FieldType} of this field.  This is used by
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* @param fieldType
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,public void setFieldType(String fieldType);
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,* Gets the searchConfigs. Note that a concrete implementation or usage of this class is not available
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,// This is a broadleaf enumeration
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,@Deprecated
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,@ElementCollection
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"@CollectionTable(name=""BLC_FIELD_SEARCH_TYPES"", joinColumns=@JoinColumn(name=""FIELD_ID""))"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"@Column(name=""SEARCHABLE_FIELD_TYPE"")"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"@Cascade(value={org.hibernate.annotations.CascadeType.MERGE, org.hibernate.annotations.CascadeType.PERSIST})"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region=""blStandardElements"")"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,@BatchSize(size = 50)
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,protected List<String> searchableFieldTypes = new ArrayList<String>();
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"@Column(name = ""FIELD_TYPE"")"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"@AdminPresentation(friendlyName = ""FieldImpl_Field_Type"", order = 4, prominent = true, gridOrder = 4,"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"fieldType = SupportedFieldType.BROADLEAF_ENUMERATION,"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"broadleafEnumeration = ""org.broadleafcommerce.core.search.domain.solr.FieldType"","
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,requiredOverride = RequiredOverride.REQUIRED)
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,protected String fieldType;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,@Override
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,public List<FieldType> getSearchableFieldTypes() {
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,List<FieldType> fieldTypes = new ArrayList<FieldType>();
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,for (String fieldType : searchableFieldTypes) {
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,fieldTypes.add(FieldType.getInstance(fieldType));
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,}
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,return fieldTypes;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,public void setSearchableFieldTypes(List<FieldType> searchableFieldTypes) {
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,List<String> fieldTypes = new ArrayList<String>();
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,for (FieldType fieldType : searchableFieldTypes) {
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,fieldTypes.add(fieldType.getType());
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,this.searchableFieldTypes = fieldTypes;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,public String getFieldType() {
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,return fieldType;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,public void setFieldType(String fieldType) {
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,this.fieldType = fieldType;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,for (String entry : searchableFieldTypes) {
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,((FieldImpl) cloned).searchableFieldTypes.add(entry);
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,public List<SearchFieldType> getSearchableFieldTypes();
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,public void setSearchableFieldTypes(List<SearchFieldType> searchableFieldTypes);
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import org.broadleafcommerce.core.search.domain.solr.FieldType;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,public List<FieldType> getSearchableFieldTypes();
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,public void setSearchableFieldTypes(List<FieldType> searchableFieldTypes);
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationCollection;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import javax.persistence.CascadeType;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import javax.persistence.FetchType;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import javax.persistence.OneToMany;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"@OneToMany(fetch = FetchType.LAZY, mappedBy = ""searchField"", targetEntity = SearchFieldTypeImpl.class, cascade = CascadeType.ALL)"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"@AdminPresentationCollection(friendlyName = ""SearchFieldImpl_Searchable_Field_Types"", order = 1000)"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,protected List<SearchFieldType> searchableFieldTypes = new ArrayList<SearchFieldType>();
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,public List<SearchFieldType> getSearchableFieldTypes() {
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,return searchableFieldTypes;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,public void setSearchableFieldTypes(List<SearchFieldType> searchableFieldTypes) {
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,this.searchableFieldTypes = searchableFieldTypes;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,for(SearchFieldType entry : searchableFieldTypes){
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,cloned.getSearchableFieldTypes().add(entry.createOrRetrieveCopyInstance(context).getClone());
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import javax.persistence.ElementCollection;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,@ElementCollection
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"@CollectionTable(name=""BLC_SEARCH_FIELD_TYPES"", joinColumns=@JoinColumn(name=""SEARCH_FIELD_ID""))"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"@Column(name=""SEARCHABLE_FIELD_TYPE"")"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"@Cascade(value={org.hibernate.annotations.CascadeType.MERGE, org.hibernate.annotations.CascadeType.PERSIST})"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,protected List<String> searchableFieldTypes = new ArrayList<String>();
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,public List<FieldType> getSearchableFieldTypes() {
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,List<FieldType> fieldTypes = new ArrayList<FieldType>();
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,for (String fieldType : searchableFieldTypes) {
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,fieldTypes.add(FieldType.getInstance(fieldType));
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,}
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,return fieldTypes;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,public void setSearchableFieldTypes(List<FieldType> searchableFieldTypes) {
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,List<String> fieldTypes = new ArrayList<String>();
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,for (FieldType fieldType : searchableFieldTypes) {
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,fieldTypes.add(fieldType.getType());
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,this.searchableFieldTypes = fieldTypes;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,for(String entry : searchableFieldTypes){
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,cloned.getSearchableFieldTypes().add(FieldType.getInstance(entry));
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,import org.broadleafcommerce.core.search.domain.SearchFieldType;
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,List<SearchFieldType> searchableFieldTypes = searchField.getSearchableFieldTypes();
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,for (SearchFieldType sft : searchableFieldTypes) {
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,FieldType fieldType = FieldType.getInstance(sft.getSearchableFieldType());
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"Map<String, Object> propertyValues = getPropertyValues(indexable, field, fieldType, locales);"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"String solrPropertyName = shs.getPropertyNameForFieldSearchable(field, fieldType, prefix);"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,List<FieldType> searchableFieldTypes = searchField.getSearchableFieldTypes();
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,for (FieldType sft : searchableFieldTypes) {
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"Map<String, Object> propertyValues = getPropertyValues(indexable, field, sft, locales);"
7a0d4f76efcfd116f44e09f547c506a7855e8a8e,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"String solrPropertyName = shs.getPropertyNameForFieldSearchable(field, sft, prefix);"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,/*
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* #%L
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* BroadleafCommerce Framework
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* %%
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* Copyright (C) 2009 - 2015 Broadleaf Commerce
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"* Licensed under the Apache License, Version 2.0 (the ""License"");"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* you may not use this file except in compliance with the License.
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* You may obtain a copy of the License at
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,*
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,*       http://www.apache.org/licenses/LICENSE-2.0
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"* Unless required by applicable law or agreed to in writing, software"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"* distributed under the License is distributed on an ""AS IS"" BASIS,"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* See the License for the specific language governing permissions and
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* limitations under the License.
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* #L%
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,*/
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,package org.broadleafcommerce.core.catalog.dao;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.apache.commons.logging.Log;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.apache.commons.logging.LogFactory;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.common.exception.ServiceException;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.common.extension.ExtensionResultStatusType;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.core.search.domain.SearchFacet;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.core.search.domain.solr.FieldType;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.openadmin.dto.Entity;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.openadmin.dto.FieldMetadata;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.openadmin.dto.PersistencePackage;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.openadmin.dto.PersistencePerspective;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.openadmin.server.dao.DynamicEntityDao;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.openadmin.server.service.handler.CustomPersistenceHandlerAdapter;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.openadmin.server.service.persistence.module.RecordHelper;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.springframework.stereotype.Component;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import java.util.Map;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import javax.annotation.Resource;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,/**
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* @author Chad Harchar (charchar)
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@Component(""blSearchFacetCustomPersistenceHandler"")"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,public class SearchFacetCustomPersistenceHandler extends CustomPersistenceHandlerAdapter {
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,private static final Log LOG = LogFactory.getLog(SearchFacetRangeCustomPersistenceHandler.class);
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@Resource(name = ""blSearchFacetCustomPersistenceHandlerExtensionManager"")"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,protected SearchFacetCustomPersistenceHandlerExtensionManager extensionManager;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,@Override
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,public Boolean canHandleAdd(PersistencePackage persistencePackage) {
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,String ceilingEntityFullyQualifiedClassname = persistencePackage.getCeilingEntityFullyQualifiedClassname();
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,return SearchFacet.class.getName().equals(ceilingEntityFullyQualifiedClassname);
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,}
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,public Boolean canHandleUpdate(PersistencePackage persistencePackage) {
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,return canHandleAdd(persistencePackage);
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"public Entity update(PersistencePackage persistencePackage, DynamicEntityDao dynamicEntityDao, RecordHelper helper) throws ServiceException {"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,Entity entity = persistencePackage.getEntity();
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,try {
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,PersistencePerspective persistencePerspective = persistencePackage.getPersistencePerspective();
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"Map<String, FieldMetadata> adminProperties = helper.getSimpleMergedProperties(SearchFacet.class.getName(), persistencePerspective);"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"Object primaryKey = helper.getPrimaryKey(entity, adminProperties);"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"SearchFacet adminInstance = (SearchFacet) dynamicEntityDao.retrieve(Class.forName(entity.getType()[0]), primaryKey);"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"return getEntity(persistencePackage, dynamicEntityDao, helper, entity, adminProperties, adminInstance);"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,} catch (Exception e) {
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"throw new ServiceException(""Unable to perform update for entity: "" + SearchFacet.class.getName(), e);"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"protected Entity getEntity(PersistencePackage persistencePackage, DynamicEntityDao dynamicEntityDao, RecordHelper helper, Entity entity, Map<String, FieldMetadata> adminProperties, SearchFacet adminInstance) throws ServiceException {"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"adminInstance = (SearchFacet) helper.createPopulatedInstance(adminInstance, entity, adminProperties, false);"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,adminInstance = dynamicEntityDao.merge(adminInstance);
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,ExtensionResultStatusType result = ExtensionResultStatusType.NOT_HANDLED;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,if (extensionManager != null) {
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"result = extensionManager.getProxy().addtoSearchableFields(persistencePackage, adminInstance);"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,if (result.equals(ExtensionResultStatusType.NOT_HANDLED) && adminInstance.getFacetFieldType() == null) {
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"// if we don't have a facetFieldType set, then set a default value"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,adminInstance.setFacetFieldType(FieldType.STRING.getType());
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,if(adminInstance.getLabel() == null) {
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"adminInstance.setLabel(entity.getPMap().get(""field"").getDisplayValue());"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"Entity adminEntity = helper.getRecord(adminProperties, adminInstance, null, null);"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,return adminEntity;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"public Entity add(PersistencePackage persistencePackage, DynamicEntityDao dynamicEntityDao, RecordHelper helper) throws ServiceException {"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,SearchFacet adminInstance = (SearchFacet) Class.forName(entity.getType()[0]).newInstance();
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"throw new ServiceException(""Unable to perform add for entity: "" + SearchFacet.class.getName(), e);"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,/*
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* #%L
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* BroadleafCommerce Framework
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* %%
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* Copyright (C) 2009 - 2015 Broadleaf Commerce
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"* Licensed under the Apache License, Version 2.0 (the ""License"");"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* you may not use this file except in compliance with the License.
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* You may obtain a copy of the License at
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,*
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,*       http://www.apache.org/licenses/LICENSE-2.0
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"* Unless required by applicable law or agreed to in writing, software"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"* distributed under the License is distributed on an ""AS IS"" BASIS,"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* See the License for the specific language governing permissions and
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* limitations under the License.
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* #L%
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,*/
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,package org.broadleafcommerce.core.catalog.dao;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.common.exception.ServiceException;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.common.extension.ExtensionHandler;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.common.extension.ExtensionResultStatusType;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.core.search.domain.SearchFacet;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.openadmin.dto.PersistencePackage;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,/**
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* @author Chad Harchar (charchar)
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,public interface SearchFacetCustomPersistenceHandlerExtensionHandler extends ExtensionHandler {
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"ExtensionResultStatusType addtoSearchableFields(PersistencePackage persistencePackage, SearchFacet SearchFacet) throws ServiceException;"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,}
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,/*
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* #%L
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* BroadleafCommerce Framework
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* %%
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* Copyright (C) 2009 - 2015 Broadleaf Commerce
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"* Licensed under the Apache License, Version 2.0 (the ""License"");"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* you may not use this file except in compliance with the License.
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* You may obtain a copy of the License at
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,*
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,*       http://www.apache.org/licenses/LICENSE-2.0
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"* Unless required by applicable law or agreed to in writing, software"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"* distributed under the License is distributed on an ""AS IS"" BASIS,"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* See the License for the specific language governing permissions and
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* limitations under the License.
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* #L%
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,*/
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,package org.broadleafcommerce.core.catalog.dao;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.common.extension.ExtensionManager;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.springframework.stereotype.Service;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,/**
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* @author Chad Harchar (charchar)
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@Service(""blSearchFacetCustomPersistenceHandlerExtensionManager"")"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,public class SearchFacetCustomPersistenceHandlerExtensionManager extends ExtensionManager<SearchFacetCustomPersistenceHandlerExtensionHandler> {
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,public SearchFacetCustomPersistenceHandlerExtensionManager() {
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,super(SearchFacetCustomPersistenceHandlerExtensionHandler.class);
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,}
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,import org.broadleafcommerce.common.presentation.RequiredOverride;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,import org.broadleafcommerce.common.presentation.client.SupportedFieldType;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,import org.broadleafcommerce.core.search.domain.solr.FieldType;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"groupOrder = 1000, prominent = true, translatable = true, gridOrder = 1000, requiredOverride = RequiredOverride.REQUIRED)"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"prominent = true, gridOrder = 2000, requiredOverride = RequiredOverride.REQUIRED)"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"@Column(name = ""FACET_FIELD_TYPE"")"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"@AdminPresentation(friendlyName = ""SearchFacetImpl_facetFieldType"", group = ""SearchFacetImpl_description"", order = 4, prominent = true, gridOrder = 4,"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"fieldType = SupportedFieldType.BROADLEAF_ENUMERATION,"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"broadleafEnumeration = ""org.broadleafcommerce.core.search.domain.solr.FieldType"","
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"requiredOverride = RequiredOverride.REQUIRED,"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"defaultValue = ""t"")"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,protected String facetFieldType;
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"groupOrder = 1000, prominent = true, translatable = true, gridOrder = 1000,"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"tab = ""SearchFacetImpl_Advanced_tab"", tabOrder = 2000)"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"prominent = true, gridOrder = 2000)"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@Column(name = ""FACET_FIELD_TYPE"")"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@AdminPresentation(friendlyName = ""FieldImpl_facetFieldType"", group = ""FieldImpl_general"", excluded = true)"
6167cc84a655b259dc9341da5f86de36f94704c0,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,protected String facetFieldType;
11d10e592d86a461b99691b9888f3fb099728933,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"List<SearchFacetDTO> facets, SearchCriteria searchCriteria, String defaultSort) {"
11d10e592d86a461b99691b9888f3fb099728933,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"@Override public ExtensionResultStatusType modifySolrQueryField(SearchField searchField, StringBuilder query, String solrFieldName) {"
11d10e592d86a461b99691b9888f3fb099728933,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public ExtensionResultStatusType getCategoryId(Category category, Long[] returnContainer) {"
11d10e592d86a461b99691b9888f3fb099728933,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.broadleafcommerce.common.extension.ExtensionResultHolder;
11d10e592d86a461b99691b9888f3fb099728933,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import java.math.BigDecimal;
11d10e592d86a461b99691b9888f3fb099728933,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"List<SearchFacetDTO> facets, SearchCriteria searchCriteria, String defaultSort) {"
11d10e592d86a461b99691b9888f3fb099728933,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,@Override
11d10e592d86a461b99691b9888f3fb099728933,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public ExtensionResultStatusType getCategoryId(Category category, Long[] returnContainer) {"
11d10e592d86a461b99691b9888f3fb099728933,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public ExtensionResultStatusType accumulateGlobalBoostValue(SearchField searchField, ExtensionResultHolder<BigDecimal> globalBoost) {"
11d10e592d86a461b99691b9888f3fb099728933,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public ExtensionResultStatusType appendToBoostQueryIfApplicable(SolrQuery query, SearchField searchField, StringBuilder queryBuilder) {"
11d10e592d86a461b99691b9888f3fb099728933,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,return ExtensionResultStatusType.NOT_HANDLED;
11d10e592d86a461b99691b9888f3fb099728933,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,}
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,* @param isViewCollectionItem
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,"String parentId, boolean isViewCollectionItem)"
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,"String parentId, boolean isViewCollectionItem, EntityForm ef)"
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,String parentId)
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,"String parentId, EntityForm ef)"
ceedc74f28b3435d15b855745e7beaf9b712aade,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import java.util.Collections;
ceedc74f28b3435d15b855745e7beaf9b712aade,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"String parentId, boolean isViewCollectionItem)"
ceedc74f28b3435d15b855745e7beaf9b712aade,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"return buildAdornedListForm(adornedMd, adornedList, parentId, isViewCollectionItem, ef);"
ceedc74f28b3435d15b855745e7beaf9b712aade,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"String parentId, boolean isViewCollectionItem, EntityForm ef)"
ceedc74f28b3435d15b855745e7beaf9b712aade,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,if (isViewCollectionItem) {
ceedc74f28b3435d15b855745e7beaf9b712aade,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"Collections.addAll(entityFormProperties, collectionMetadata.getProperties());"
ceedc74f28b3435d15b855745e7beaf9b712aade,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,} else {
ceedc74f28b3435d15b855745e7beaf9b712aade,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,// We want our entity form to only render the maintained adorned target fields
ceedc74f28b3435d15b855745e7beaf9b712aade,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,for (String targetFieldName : adornedMd.getMaintainedAdornedTargetFields()) {
ceedc74f28b3435d15b855745e7beaf9b712aade,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,Property p = collectionMetadata.getPMap().get(targetFieldName);
ceedc74f28b3435d15b855745e7beaf9b712aade,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,if (p.getMetadata() instanceof BasicFieldMetadata) {
ceedc74f28b3435d15b855745e7beaf9b712aade,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,((BasicFieldMetadata) p.getMetadata()).setVisibility(VisibilityEnum.VISIBLE_ALL);
ceedc74f28b3435d15b855745e7beaf9b712aade,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,entityFormProperties.add(p);
ceedc74f28b3435d15b855745e7beaf9b712aade,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,}
ceedc74f28b3435d15b855745e7beaf9b712aade,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,String parentId)
ceedc74f28b3435d15b855745e7beaf9b712aade,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"return buildAdornedListForm(adornedMd, adornedList, parentId, ef);"
ceedc74f28b3435d15b855745e7beaf9b712aade,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"String parentId, EntityForm ef)"
ceedc74f28b3435d15b855745e7beaf9b712aade,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,// We want our entity form to only render the maintained adorned target fields
ceedc74f28b3435d15b855745e7beaf9b712aade,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,for (String targetFieldName : adornedMd.getMaintainedAdornedTargetFields()) {
ceedc74f28b3435d15b855745e7beaf9b712aade,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,Property p = collectionMetadata.getPMap().get(targetFieldName);
ceedc74f28b3435d15b855745e7beaf9b712aade,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,if (p.getMetadata() instanceof BasicFieldMetadata) {
ceedc74f28b3435d15b855745e7beaf9b712aade,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,((BasicFieldMetadata) p.getMetadata()).setVisibility(VisibilityEnum.VISIBLE_ALL);
ceedc74f28b3435d15b855745e7beaf9b712aade,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,entityFormProperties.add(p);
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import java.util.Collections;
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,"String parentId, boolean isViewCollectionItem)"
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,"return buildAdornedListForm(adornedMd, adornedList, parentId, isViewCollectionItem, ef);"
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,"String parentId, boolean isViewCollectionItem, EntityForm ef)"
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,if (isViewCollectionItem) {
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,"Collections.addAll(entityFormProperties, collectionMetadata.getProperties());"
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,} else {
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,// We want our entity form to only render the maintained adorned target fields
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,for (String targetFieldName : adornedMd.getMaintainedAdornedTargetFields()) {
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,Property p = collectionMetadata.getPMap().get(targetFieldName);
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,if (p.getMetadata() instanceof BasicFieldMetadata) {
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,((BasicFieldMetadata) p.getMetadata()).setVisibility(VisibilityEnum.VISIBLE_ALL);
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,entityFormProperties.add(p);
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,}
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,String parentId)
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,"return buildAdornedListForm(adornedMd, adornedList, parentId, ef);"
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,"String parentId, EntityForm ef)"
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,// We want our entity form to only render the maintained adorned target fields
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,for (String targetFieldName : adornedMd.getMaintainedAdornedTargetFields()) {
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,Property p = collectionMetadata.getPMap().get(targetFieldName);
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,if (p.getMetadata() instanceof BasicFieldMetadata) {
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,((BasicFieldMetadata) p.getMetadata()).setVisibility(VisibilityEnum.VISIBLE_ALL);
ceedc74f28b3435d15b855745e7beaf9b712aade,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,entityFormProperties.add(p);
d45a6b95ea39c6f18d8a2ec40cb798a2265b3982,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,".withFieldPath(new FieldPath().withTargetProperty(""allParentCategoryXrefs.id""))"
d45a6b95ea39c6f18d8a2ec40cb798a2265b3982,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,//We want to limit the product we find to those who have a CategoryProductXref that
d45a6b95ea39c6f18d8a2ec40cb798a2265b3982,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"//is unarchived, is the defaultReference, and is the selected filter category. We"
d45a6b95ea39c6f18d8a2ec40cb798a2265b3982,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,//do this in a subquery to avoid an additional join that would cause duplicate query
d45a6b95ea39c6f18d8a2ec40cb798a2265b3982,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,//results.
d45a6b95ea39c6f18d8a2ec40cb798a2265b3982,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"sub.select(subRoot.get(""id"").as(Long.class));"
d45a6b95ea39c6f18d8a2ec40cb798a2265b3982,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,".withFieldPath(new FieldPath().withTargetProperty(""allParentCategoryXrefs.category.id""))"
d45a6b95ea39c6f18d8a2ec40cb798a2265b3982,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"//the property to be matched against (allParentCategoryXrefs.category.id) comes as ""explicitPath"""
d45a6b95ea39c6f18d8a2ec40cb798a2265b3982,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"//the specifics of what values are acceptable (those given as filter values, that in addition are defaults)"
d45a6b95ea39c6f18d8a2ec40cb798a2265b3982,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,//are resolved in a sub-query
d45a6b95ea39c6f18d8a2ec40cb798a2265b3982,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"sub.select(subRoot.get(""category"").get(""id"").as(Long.class));"
d45a6b95ea39c6f18d8a2ec40cb798a2265b3982,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"root.fetch(""defaultCategory"", JoinType.LEFT);"
dc8954d52726c185c0eb4263be637eff52415cc3,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"tabOrder = 2000,"
dc8954d52726c185c0eb4263be637eff52415cc3,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,visibility = VisibilityEnum.GRID_HIDDEN)
dc8954d52726c185c0eb4263be637eff52415cc3,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,tabOrder = 2000)
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,import org.broadleafcommerce.common.sandbox.SandBoxHelper;
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,import org.broadleafcommerce.common.util.BLCCollectionUtils;
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,import org.broadleafcommerce.common.util.TypedTransformer;
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,import org.hibernate.ejb.QueryHints;
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,import javax.persistence.TypedQuery;
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,import javax.persistence.criteria.CriteriaQuery;
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"@Resource(name=""blSandBoxHelper"")"
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,protected SandBoxHelper sandBoxHelper;
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"List<Long> transformedValues = BLCCollectionUtils.collectList(filterValues, new TypedTransformer<Long>() {"
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,@Override
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,public Long transform(Object input) {
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,return Long.parseLong(((String) input));
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,}
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,});
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,CriteriaBuilder builder = dynamicEntityDao.getStandardEntityManager().getCriteriaBuilder();
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,CriteriaQuery<Long> criteria = builder.createQuery(Long.class);
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,Root<CategoryProductXrefImpl> root = criteria.from(CategoryProductXrefImpl.class);
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"criteria.select(root.get(""product"").get(""id"").as(Long.class));"
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,List<Predicate> restrictions = new ArrayList<Predicate>();
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"restrictions.add(builder.equal(root.get(""defaultReference""), Boolean.TRUE));"
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"restrictions.add(root.get(""category"").get(""id"").in(transformedValues));"
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,//archived?
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"QueryUtils.notArchived(builder, restrictions, root, ""archiveStatus"");"
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,criteria.where(restrictions.toArray(new Predicate[restrictions.size()]));
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,TypedQuery<Long> query = dynamicEntityDao.getStandardEntityManager().createQuery(criteria);
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,final List<Long> productIds = query.getResultList();
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,if (productIds.size() <= 800) {
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,FilterMapping filterMapping = new FilterMapping()
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,".withFieldPath(new FieldPath().withTargetProperty(""id""))"
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,.withPredicateProvider(new PredicateProvider() {
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"public Predicate buildPredicate(CriteriaBuilder builder, FieldPathBuilder fieldPathBuilder,"
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"From root, String ceilingEntity, String fullPropertyName,"
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"Path explicitPath, List directValues) {"
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"return explicitPath.in(sandBoxHelper.mergeCloneIds(ProductImpl.class,"
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,productIds.toArray(new Long[productIds.size()])));
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,)
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,);
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,cto.getAdditionalFilterMappings().add(filterMapping);
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,} else {
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"String joined = StringUtils.join(transformedValues, ',');"
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"LOG.warn(String.format(""Skipping default category filtering for product fetch query since there are "" +"
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"""more than 800 products found to belong to the selected default categories(%s). This is a "" +"
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"""filter query limitation."", joined));"
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,FilterMapping filterMapping = new FilterMapping()
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,".withFieldPath(new FieldPath().withTargetProperty(""allParentCategoryXrefs.id""))"
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,.withPredicateProvider(new PredicateProvider() {
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,@Override
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"public Predicate buildPredicate(CriteriaBuilder builder, FieldPathBuilder fieldPathBuilder,"
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"From root, String ceilingEntity,"
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"String fullPropertyName, Path explicitPath, List directValues) {"
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,//We want to limit the product we find to those who have a CategoryProductXref that
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"//is unarchived, is the defaultReference, and is the selected filter category. We"
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,//do this in a subquery to avoid an additional join that would cause duplicate query
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,//results.
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,Subquery<Long> sub = fieldPathBuilder.getCriteria().subquery(Long.class);
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,Root<CategoryProductXrefImpl> subRoot = sub.from(CategoryProductXrefImpl.class);
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"sub.select(subRoot.get(""id"").as(Long.class));"
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,List<Predicate> subRestrictions = new ArrayList<Predicate>();
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"subRestrictions.add(builder.equal(subRoot.get(""defaultReference""), Boolean.TRUE));"
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"subRestrictions.add(subRoot.get(""category"").get(""id"").in(directValues));"
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,//archived?
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"QueryUtils.notArchived(builder, subRestrictions, subRoot, ""archiveStatus"");"
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,sub.where(subRestrictions.toArray(new Predicate[subRestrictions.size()]));
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,return explicitPath.in(sub);
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,}
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,}));
9d9210ac5ffcac6791074b9997f16444499e0304,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,cto.getAdditionalFilterMappings().add(filterMapping);
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import org.broadleafcommerce.common.sandbox.SandBoxHelper;
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import org.broadleafcommerce.common.util.BLCCollectionUtils;
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import org.broadleafcommerce.common.util.TypedTransformer;
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import org.hibernate.ejb.QueryHints;
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import javax.persistence.TypedQuery;
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import javax.persistence.criteria.CriteriaQuery;
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"@Resource(name=""blSandBoxHelper"")"
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,protected SandBoxHelper sandBoxHelper;
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"List<Long> transformedValues = BLCCollectionUtils.collectList(filterValues, new TypedTransformer<Long>() {"
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,@Override
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,public Long transform(Object input) {
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,return Long.parseLong(((String) input));
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,}
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,});
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,CriteriaBuilder builder = dynamicEntityDao.getStandardEntityManager().getCriteriaBuilder();
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,CriteriaQuery<Long> criteria = builder.createQuery(Long.class);
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,Root<CategoryProductXrefImpl> root = criteria.from(CategoryProductXrefImpl.class);
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"criteria.select(root.get(""product"").get(""id"").as(Long.class));"
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,List<Predicate> restrictions = new ArrayList<Predicate>();
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"restrictions.add(builder.equal(root.get(""defaultReference""), Boolean.TRUE));"
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"restrictions.add(root.get(""category"").get(""id"").in(transformedValues));"
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,//archived?
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"QueryUtils.notArchived(builder, restrictions, root, ""archiveStatus"");"
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,criteria.where(restrictions.toArray(new Predicate[restrictions.size()]));
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,TypedQuery<Long> query = dynamicEntityDao.getStandardEntityManager().createQuery(criteria);
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,final List<Long> productIds = query.getResultList();
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,if (productIds.size() <= 800) {
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,FilterMapping filterMapping = new FilterMapping()
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,".withFieldPath(new FieldPath().withTargetProperty(""id""))"
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,.withPredicateProvider(new PredicateProvider() {
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"public Predicate buildPredicate(CriteriaBuilder builder, FieldPathBuilder fieldPathBuilder,"
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"From root, String ceilingEntity, String fullPropertyName,"
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"Path explicitPath, List directValues) {"
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"return explicitPath.in(sandBoxHelper.mergeCloneIds(ProductImpl.class,"
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,productIds.toArray(new Long[productIds.size()])));
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,)
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,);
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,cto.getAdditionalFilterMappings().add(filterMapping);
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,} else {
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"String joined = StringUtils.join(transformedValues, ',');"
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"LOG.warn(String.format(""Skipping default category filtering for product fetch query since there are "" +"
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"""more than 800 products found to belong to the selected default categories(%s). This is a "" +"
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"""filter query limitation."", joined));"
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,FilterMapping filterMapping = new FilterMapping()
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,".withFieldPath(new FieldPath().withTargetProperty(""allParentCategoryXrefs.id""))"
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,.withPredicateProvider(new PredicateProvider() {
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,@Override
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"public Predicate buildPredicate(CriteriaBuilder builder, FieldPathBuilder fieldPathBuilder,"
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"From root, String ceilingEntity,"
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"String fullPropertyName, Path explicitPath, List directValues) {"
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,//We want to limit the product we find to those who have a CategoryProductXref that
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"//is unarchived, is the defaultReference, and is the selected filter category. We"
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,//do this in a subquery to avoid an additional join that would cause duplicate query
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,//results.
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,Subquery<Long> sub = fieldPathBuilder.getCriteria().subquery(Long.class);
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,Root<CategoryProductXrefImpl> subRoot = sub.from(CategoryProductXrefImpl.class);
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"sub.select(subRoot.get(""id"").as(Long.class));"
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,List<Predicate> subRestrictions = new ArrayList<Predicate>();
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"subRestrictions.add(builder.equal(subRoot.get(""defaultReference""), Boolean.TRUE));"
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"subRestrictions.add(subRoot.get(""category"").get(""id"").in(directValues));"
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,//archived?
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"QueryUtils.notArchived(builder, subRestrictions, subRoot, ""archiveStatus"");"
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,sub.where(subRestrictions.toArray(new Predicate[subRestrictions.size()]));
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,return explicitPath.in(sub);
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,}
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,}));
9d9210ac5ffcac6791074b9997f16444499e0304,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,cto.getAdditionalFilterMappings().add(filterMapping);
d65288fc2364ff43b726b93000acd4092a620e16,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,List<Long> productIds = query.getResultList();
d65288fc2364ff43b726b93000acd4092a620e16,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"productIds = sandBoxHelper.mergeCloneIds(ProductImpl.class, productIds.toArray(new Long[productIds.size()]));"
d65288fc2364ff43b726b93000acd4092a620e16,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,.withDirectFilterValues(productIds)
d65288fc2364ff43b726b93000acd4092a620e16,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,return explicitPath.in(directValues);
d65288fc2364ff43b726b93000acd4092a620e16,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,final List<Long> productIds = query.getResultList();
d65288fc2364ff43b726b93000acd4092a620e16,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,.withDirectFilterValues(filterValues)
d65288fc2364ff43b726b93000acd4092a620e16,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"return explicitPath.in(sandBoxHelper.mergeCloneIds(ProductImpl.class,"
d65288fc2364ff43b726b93000acd4092a620e16,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,productIds.toArray(new Long[productIds.size()])));
652944ab7a97449c39e9c83518340a80955a6124,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"@DirectCopyTransformMember(templateTokens = DirectCopyTransformTypes.SANDBOX, skipOverlaps=true),"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,import org.broadleafcommerce.common.sandbox.SandBoxHelper;
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,import org.broadleafcommerce.common.util.BLCCollectionUtils;
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,import org.broadleafcommerce.common.util.TypedTransformer;
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,import org.hibernate.ejb.QueryHints;
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,import javax.persistence.TypedQuery;
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,import javax.persistence.criteria.CriteriaQuery;
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"@Resource(name=""blSandBoxHelper"")"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,protected SandBoxHelper sandBoxHelper;
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"List<Long> transformedValues = BLCCollectionUtils.collectList(filterValues, new TypedTransformer<Long>() {"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,@Override
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,public Long transform(Object input) {
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,return Long.parseLong(((String) input));
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,}
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,});
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,CriteriaBuilder builder = dynamicEntityDao.getStandardEntityManager().getCriteriaBuilder();
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,CriteriaQuery<Long> criteria = builder.createQuery(Long.class);
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,Root<CategoryProductXrefImpl> root = criteria.from(CategoryProductXrefImpl.class);
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"criteria.select(root.get(""product"").get(""id"").as(Long.class));"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,List<Predicate> restrictions = new ArrayList<Predicate>();
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"restrictions.add(builder.equal(root.get(""defaultReference""), Boolean.TRUE));"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"restrictions.add(root.get(""category"").get(""id"").in(transformedValues));"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,//archived?
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"QueryUtils.notArchived(builder, restrictions, root, ""archiveStatus"");"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,criteria.where(restrictions.toArray(new Predicate[restrictions.size()]));
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,TypedQuery<Long> query = dynamicEntityDao.getStandardEntityManager().createQuery(criteria);
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,final List<Long> productIds = query.getResultList();
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,if (productIds.size() <= 800) {
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,FilterMapping filterMapping = new FilterMapping()
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,".withFieldPath(new FieldPath().withTargetProperty(""id""))"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,.withPredicateProvider(new PredicateProvider() {
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"public Predicate buildPredicate(CriteriaBuilder builder, FieldPathBuilder fieldPathBuilder,"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"From root, String ceilingEntity, String fullPropertyName,"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"Path explicitPath, List directValues) {"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"return explicitPath.in(sandBoxHelper.mergeCloneIds(ProductImpl.class,"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,productIds.toArray(new Long[productIds.size()])));
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,)
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,);
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,cto.getAdditionalFilterMappings().add(filterMapping);
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,} else {
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"String joined = StringUtils.join(transformedValues, ',');"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"LOG.warn(String.format(""Skipping default category filtering for product fetch query since there are "" +"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"""more than 800 products found to belong to the selected default categories(%s). This is a "" +"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"""filter query limitation."", joined));"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,FilterMapping filterMapping = new FilterMapping()
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,".withFieldPath(new FieldPath().withTargetProperty(""allParentCategoryXrefs.id""))"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,.withPredicateProvider(new PredicateProvider() {
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,@Override
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"public Predicate buildPredicate(CriteriaBuilder builder, FieldPathBuilder fieldPathBuilder,"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"From root, String ceilingEntity,"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"String fullPropertyName, Path explicitPath, List directValues) {"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,//We want to limit the product we find to those who have a CategoryProductXref that
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"//is unarchived, is the defaultReference, and is the selected filter category. We"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,//do this in a subquery to avoid an additional join that would cause duplicate query
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,//results.
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,Subquery<Long> sub = fieldPathBuilder.getCriteria().subquery(Long.class);
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,Root<CategoryProductXrefImpl> subRoot = sub.from(CategoryProductXrefImpl.class);
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"sub.select(subRoot.get(""id"").as(Long.class));"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,List<Predicate> subRestrictions = new ArrayList<Predicate>();
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"subRestrictions.add(builder.equal(subRoot.get(""defaultReference""), Boolean.TRUE));"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"subRestrictions.add(subRoot.get(""category"").get(""id"").in(directValues));"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,//archived?
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"QueryUtils.notArchived(builder, subRestrictions, subRoot, ""archiveStatus"");"
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,sub.where(subRestrictions.toArray(new Predicate[subRestrictions.size()]));
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,return explicitPath.in(sub);
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,}
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,}));
2f585340e35786539145bad6bee089910068b6c9,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,cto.getAdditionalFilterMappings().add(filterMapping);
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import org.broadleafcommerce.common.sandbox.SandBoxHelper;
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import org.broadleafcommerce.common.util.BLCCollectionUtils;
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import org.broadleafcommerce.common.util.TypedTransformer;
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import org.hibernate.ejb.QueryHints;
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import javax.persistence.TypedQuery;
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import javax.persistence.criteria.CriteriaQuery;
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"@Resource(name=""blSandBoxHelper"")"
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,protected SandBoxHelper sandBoxHelper;
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"List<Long> transformedValues = BLCCollectionUtils.collectList(filterValues, new TypedTransformer<Long>() {"
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,@Override
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,public Long transform(Object input) {
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,return Long.parseLong(((String) input));
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,}
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,});
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,CriteriaBuilder builder = dynamicEntityDao.getStandardEntityManager().getCriteriaBuilder();
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,CriteriaQuery<Long> criteria = builder.createQuery(Long.class);
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,Root<CategoryProductXrefImpl> root = criteria.from(CategoryProductXrefImpl.class);
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"criteria.select(root.get(""product"").get(""id"").as(Long.class));"
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,List<Predicate> restrictions = new ArrayList<Predicate>();
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"restrictions.add(builder.equal(root.get(""defaultReference""), Boolean.TRUE));"
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"restrictions.add(root.get(""category"").get(""id"").in(transformedValues));"
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,//archived?
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"QueryUtils.notArchived(builder, restrictions, root, ""archiveStatus"");"
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,criteria.where(restrictions.toArray(new Predicate[restrictions.size()]));
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,TypedQuery<Long> query = dynamicEntityDao.getStandardEntityManager().createQuery(criteria);
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,final List<Long> productIds = query.getResultList();
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,if (productIds.size() <= 800) {
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,FilterMapping filterMapping = new FilterMapping()
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,".withFieldPath(new FieldPath().withTargetProperty(""id""))"
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,.withPredicateProvider(new PredicateProvider() {
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"public Predicate buildPredicate(CriteriaBuilder builder, FieldPathBuilder fieldPathBuilder,"
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"From root, String ceilingEntity, String fullPropertyName,"
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"Path explicitPath, List directValues) {"
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"return explicitPath.in(sandBoxHelper.mergeCloneIds(ProductImpl.class,"
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,productIds.toArray(new Long[productIds.size()])));
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,)
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,);
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,cto.getAdditionalFilterMappings().add(filterMapping);
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,} else {
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"String joined = StringUtils.join(transformedValues, ',');"
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"LOG.warn(String.format(""Skipping default category filtering for product fetch query since there are "" +"
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"""more than 800 products found to belong to the selected default categories(%s). This is a "" +"
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"""filter query limitation."", joined));"
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,FilterMapping filterMapping = new FilterMapping()
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,".withFieldPath(new FieldPath().withTargetProperty(""allParentCategoryXrefs.id""))"
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,.withPredicateProvider(new PredicateProvider() {
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,@Override
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"public Predicate buildPredicate(CriteriaBuilder builder, FieldPathBuilder fieldPathBuilder,"
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"From root, String ceilingEntity,"
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"String fullPropertyName, Path explicitPath, List directValues) {"
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,//We want to limit the product we find to those who have a CategoryProductXref that
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"//is unarchived, is the defaultReference, and is the selected filter category. We"
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,//do this in a subquery to avoid an additional join that would cause duplicate query
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,//results.
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,Subquery<Long> sub = fieldPathBuilder.getCriteria().subquery(Long.class);
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,Root<CategoryProductXrefImpl> subRoot = sub.from(CategoryProductXrefImpl.class);
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"sub.select(subRoot.get(""id"").as(Long.class));"
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,List<Predicate> subRestrictions = new ArrayList<Predicate>();
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"subRestrictions.add(builder.equal(subRoot.get(""defaultReference""), Boolean.TRUE));"
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"subRestrictions.add(subRoot.get(""category"").get(""id"").in(directValues));"
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,//archived?
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"QueryUtils.notArchived(builder, subRestrictions, subRoot, ""archiveStatus"");"
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,sub.where(subRestrictions.toArray(new Predicate[subRestrictions.size()]));
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,return explicitPath.in(sub);
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,}
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,}));
2f585340e35786539145bad6bee089910068b6c9,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,cto.getAdditionalFilterMappings().add(filterMapping);
8e089b3cfe571e601fd0ae27aef9db8318187998,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,List<Long> productIds = query.getResultList();
8e089b3cfe571e601fd0ae27aef9db8318187998,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"productIds = sandBoxHelper.mergeCloneIds(ProductImpl.class, productIds.toArray(new Long[productIds.size()]));"
8e089b3cfe571e601fd0ae27aef9db8318187998,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,.withDirectFilterValues(productIds)
8e089b3cfe571e601fd0ae27aef9db8318187998,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,return explicitPath.in(directValues);
8e089b3cfe571e601fd0ae27aef9db8318187998,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,final List<Long> productIds = query.getResultList();
8e089b3cfe571e601fd0ae27aef9db8318187998,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,.withDirectFilterValues(filterValues)
8e089b3cfe571e601fd0ae27aef9db8318187998,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"return explicitPath.in(sandBoxHelper.mergeCloneIds(ProductImpl.class,"
8e089b3cfe571e601fd0ae27aef9db8318187998,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,productIds.toArray(new Long[productIds.size()])));
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,import org.apache.solr.client.solrj.SolrClient;
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public SolrClient getSolrServerForIndexing() {
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.apache.solr.client.solrj.SolrServer;
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public SolrServer getSolrServerForIndexing() {
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,import org.apache.solr.client.solrj.SolrClient;
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,*  the index directly on the primary {@link SolrClient} (obtained via {@link SolrContext#getServer()}) so this operation
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public SolrClient getSolrServerForIndexing() {
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.apache.solr.client.solrj.SolrServer;
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,*  the index directly on the primary {@link SolrServer} (obtained via {@link SolrContext#getServer()}) so this operation
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public SolrServer getSolrServerForIndexing() {
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,import org.apache.solr.client.solrj.SolrClient;
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,* Which {@link SolrClient} the index should be built on
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public SolrClient getSolrServerForIndexing();
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"* wrapper extension around {@link SolrIndexService#buildIncrementalIndex(List, SolrClient)}."
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.apache.solr.client.solrj.SolrServer;
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* Which {@link SolrServer} the index should be built on
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public SolrServer getSolrServerForIndexing();
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* wrapper extension around {@link SolrIndexService#buildIncrementalIndex(List, SolrServer)}."
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,import org.apache.solr.client.solrj.SolrClient;
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public Collection<SolrInputDocument> buildIncrementalIndex(List<? extends Indexable> indexables, SolrClient solrServer) throws ServiceException;"
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public void optimizeIndex(SolrClient server) throws ServiceException, IOException;"
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public void commit(SolrClient server) throws ServiceException, IOException;"
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,* This allows an external caller to force a commit to the SolrClient.  See Solr Documentation for
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,* @param server - the SolrClient to update
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public void commit(SolrClient server, boolean softCommit, boolean waitSearcher, boolean waitFlush) throws ServiceException, IOException;"
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void deleteAllNamespaceDocuments(SolrClient server) throws ServiceException;
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void deleteAllDocuments(SolrClient server) throws ServiceException;
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.apache.solr.client.solrj.SolrServer;
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public Collection<SolrInputDocument> buildIncrementalIndex(List<? extends Indexable> indexables, SolrServer solrServer) throws ServiceException;"
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public void optimizeIndex(SolrServer server) throws ServiceException, IOException;"
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public void commit(SolrServer server) throws ServiceException, IOException;"
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* This allows an external caller to force a commit to the SolrServer.  See Solr Documentation for
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* @param server - the SolrServer to update
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public void commit(SolrServer server, boolean softCommit, boolean waitSearcher, boolean waitFlush) throws ServiceException, IOException;"
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public void deleteAllNamespaceDocuments(SolrServer server) throws ServiceException;
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public void deleteAllDocuments(SolrServer server) throws ServiceException;
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,import org.apache.solr.client.solrj.SolrClient;
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void deleteAllNamespaceDocuments(SolrClient server) throws ServiceException {
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void deleteAllDocuments(SolrClient server) throws ServiceException {
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public Collection<SolrInputDocument> buildIncrementalIndex(List<? extends Indexable> indexables, SolrClient solrServer) throws ServiceException {"
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public void optimizeIndex(SolrClient server) throws ServiceException, IOException {"
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public void commit(SolrClient server) throws ServiceException, IOException {"
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public void commit(SolrClient server, boolean softCommit, boolean waitSearcher, boolean waitFlush) throws ServiceException, IOException {"
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.apache.solr.client.solrj.SolrServer;
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public void deleteAllNamespaceDocuments(SolrServer server) throws ServiceException {
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public void deleteAllDocuments(SolrServer server) throws ServiceException {
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public Collection<SolrInputDocument> buildIncrementalIndex(List<? extends Indexable> indexables, SolrServer solrServer) throws ServiceException {"
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public void optimizeIndex(SolrServer server) throws ServiceException, IOException {"
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public void commit(SolrServer server) throws ServiceException, IOException {"
7c53d066989ed537d29b1eb518a95c3b25904013,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public void commit(SolrServer server, boolean softCommit, boolean waitSearcher, boolean waitFlush) throws ServiceException, IOException {"
556d8d15215fda60a3bbe78781b1256291996ae5,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"attachIndexableDocumentFields(document, indexable, fields, locales);"
556d8d15215fda60a3bbe78781b1256291996ae5,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"attachAdditionalDocumentFields(indexable, document);"
556d8d15215fda60a3bbe78781b1256291996ae5,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,return document;
556d8d15215fda60a3bbe78781b1256291996ae5,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,}
556d8d15215fda60a3bbe78781b1256291996ae5,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,@Override
556d8d15215fda60a3bbe78781b1256291996ae5,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public void attachIndexableDocumentFields(SolrInputDocument document, Indexable indexable, List<Field> fields, List<Locale> locales) {"
556d8d15215fda60a3bbe78781b1256291996ae5,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,// Keep track of searchable fields added to the index.   We need to also add the search facets if
556d8d15215fda60a3bbe78781b1256291996ae5,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"extensionManager.getProxy().attachAdditionalDocumentFields(indexable, document);"
556d8d15215fda60a3bbe78781b1256291996ae5,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"document.addField(shs.getTypeFieldName(), shs.getDocumentType(indexable));"
556d8d15215fda60a3bbe78781b1256291996ae5,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,// Keep track of searchable fields added to the index.   We need to also add the search facets if
556d8d15215fda60a3bbe78781b1256291996ae5,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"attachAdditionalDocumentFields(indexable, document);"
556d8d15215fda60a3bbe78781b1256291996ae5,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,return document;
6939fb638975e14a52fb469c674ecc83b50d67aa,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"@AdminPresentation(friendlyName = ""IndexFieldImpl_ID"", group = ""IndexFieldImpl_description"","
6939fb638975e14a52fb469c674ecc83b50d67aa,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"@AdminPresentation(friendlyName = ""IndexFieldImpl_searchable"", defaultValue = ""true"", prominent = true, tooltip = ""IndexFieldImpl_searchable_tooltip"")"
6939fb638975e14a52fb469c674ecc83b50d67aa,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"@AdminPresentation(friendlyName = ""IndexFieldImpl_field"", order = 1000, group = ""IndexFieldImpl_description"","
6939fb638975e14a52fb469c674ecc83b50d67aa,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"@AdminPresentationCollection(friendlyName = ""IndexFieldImpl_fieldTypes"", order = 1000)"
6939fb638975e14a52fb469c674ecc83b50d67aa,a4d551eb8e80d433566d7a54761750db6313563b,added,0,protected List<IndexFieldType> fieldTypes = new ArrayList<IndexFieldType>();
6939fb638975e14a52fb469c674ecc83b50d67aa,a4d551eb8e80d433566d7a54761750db6313563b,added,0,@Override
6939fb638975e14a52fb469c674ecc83b50d67aa,a4d551eb8e80d433566d7a54761750db6313563b,added,0,return fieldTypes;
6939fb638975e14a52fb469c674ecc83b50d67aa,a4d551eb8e80d433566d7a54761750db6313563b,added,0,this.fieldTypes = searchableFieldTypes;
6939fb638975e14a52fb469c674ecc83b50d67aa,a4d551eb8e80d433566d7a54761750db6313563b,added,0,for(IndexFieldType entry : fieldTypes){
6939fb638975e14a52fb469c674ecc83b50d67aa,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"@AdminPresentation(friendlyName = ""SearchFieldImpl_ID"", group = ""SearchFieldImpl_description"","
6939fb638975e14a52fb469c674ecc83b50d67aa,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"@AdminPresentation(friendlyName = ""Searchable"", defaultValue = ""true"")"
6939fb638975e14a52fb469c674ecc83b50d67aa,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"@AdminPresentation(friendlyName = ""SearchFieldImpl_field"", order = 1000, group = ""SearchFieldImpl_description"","
6939fb638975e14a52fb469c674ecc83b50d67aa,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"@AdminPresentationCollection(friendlyName = ""SearchFieldImpl_searchableFieldTypes"", order = 1000)"
6939fb638975e14a52fb469c674ecc83b50d67aa,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,protected List<IndexFieldType> indexableFieldTypes = new ArrayList<IndexFieldType>();
6939fb638975e14a52fb469c674ecc83b50d67aa,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,return indexableFieldTypes;
6939fb638975e14a52fb469c674ecc83b50d67aa,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,this.indexableFieldTypes = searchableFieldTypes;
6939fb638975e14a52fb469c674ecc83b50d67aa,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,for(IndexFieldType entry : indexableFieldTypes){
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"Map<String, List<Map<String, String>>> validations ="
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"for (Map.Entry<String, List<Map<String, String>>> validation : validations.entrySet()) {"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"for (Map<String, String> configuration : validation.getValue()) {"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,PropertyValidator validator = null;
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,//attempt bean resolution to find the validator
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (applicationContext.containsBean(validationImplementation)) {
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"validator = applicationContext.getBean(validationImplementation, PropertyValidator.class);"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"//not a bean, attempt to instantiate the class"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (validator == null) {
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,try {
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,validator = (PropertyValidator) Class.forName(validationImplementation).newInstance();
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,} catch (Exception e) {
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,//do nothing
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,}
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"throw new PersistenceException(""Could not find validator: "" + validationImplementation +"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,""" for property: "" + propertyName);"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"PropertyValidationResult result = validator.validate(entity,"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"instance,"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"propertiesMetadata,"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"configuration,"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"(BasicFieldMetadata)metadata,"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"propertyName,"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,propertyValue);
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,if (!result.isValid()) {
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,for (String message : result.getErrorMessages()) {
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,added,0,"submittedEntity.addValidationError(propertyName, message);"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"Map<String, Map<String, String>> validations ="
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"for (Map.Entry<String, Map<String, String>> validation : validations.entrySet()) {"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"Map<String, String> configuration = validation.getValue();"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,PropertyValidator validator = null;
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,//attempt bean resolution to find the validator
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (applicationContext.containsBean(validationImplementation)) {
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"validator = applicationContext.getBean(validationImplementation, PropertyValidator.class);"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,}
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"//not a bean, attempt to instantiate the class"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (validator == null) {
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,try {
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,validator = (PropertyValidator) Class.forName(validationImplementation).newInstance();
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,} catch (Exception e) {
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,//do nothing
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"throw new PersistenceException(""Could not find validator: "" + validationImplementation +"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,""" for property: "" + propertyName);"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"PropertyValidationResult result = validator.validate(entity,"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"instance,"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"propertiesMetadata,"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"configuration,"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"(BasicFieldMetadata)metadata,"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"propertyName,"
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,propertyValue);
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,if (!result.isValid()) {
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,for (String message : result.getErrorMessages()) {
6c2ab71ea3b0c6366e49e96cbdea2a67b40e2fd5,c57fb5239fcbaf8ef32ec629ab9f9d3b02cd9f7d,deleted,1,"submittedEntity.addValidationError(propertyName, message);"
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.core.search.domain.solr.FieldType;
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,@Deprecated
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@Column(name = ""SEARCHABLE"")"
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@AdminPresentation(friendlyName = ""FieldImpl_searchable"", group = ""FieldImpl_general"", order = 4, excluded = true)"
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,protected Boolean searchable = false;
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,// This is a broadleaf enumeration
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@Column(name = ""FACET_FIELD_TYPE"")"
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@AdminPresentation(friendlyName = ""FieldImpl_facetFieldType"", group = ""FieldImpl_general"", excluded = true)"
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,protected String facetFieldType;
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@Column(name = ""IS_CUSTOM"")"
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@AdminPresentation(friendlyName = ""FieldImpl_isCustom"", group = ""FieldImpl_general"","
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,visibility = VisibilityEnum.VISIBLE_ALL)
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,protected Boolean isCustom = false;
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,@Override
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,public Boolean getSearchable() {
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,if (searchable == null) {
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,return false;
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,}
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,return searchable;
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,public void setSearchable(Boolean searchable) {
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,this.searchable = searchable;
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,public FieldType getFacetFieldType() {
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,return FieldType.getInstance(facetFieldType);
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,public void setFacetFieldType(FieldType facetFieldType) {
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,this.facetFieldType = facetFieldType == null ? null : facetFieldType.getType();
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,public Boolean getIsCustom() {
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,return translatable == null ? false : translatable;
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,public void setIsCustom(Boolean isCustom) {
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,this.isCustom = isCustom;
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,cloned.setFacetFieldType(getFacetFieldType());
cc464a54aeabefb4edb61128afa86ce5849d3fe4,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,cloned.setSearchable(searchable);
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,import org.broadleafcommerce.core.search.domain.solr.FieldType;
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,@Deprecated
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,"@Column(name = ""SEARCHABLE"")"
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,"@AdminPresentation(friendlyName = ""FieldImpl_searchable"", group = ""FieldImpl_general"", order = 4, excluded = true)"
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,protected Boolean searchable = false;
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,// This is a broadleaf enumeration
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,"@Column(name = ""FACET_FIELD_TYPE"")"
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,"@AdminPresentation(friendlyName = ""FieldImpl_facetFieldType"", group = ""FieldImpl_general"", excluded = true)"
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,protected String facetFieldType;
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,"@Column(name = ""IS_CUSTOM"")"
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,"@AdminPresentation(friendlyName = ""FieldImpl_isCustom"", group = ""FieldImpl_general"","
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,visibility = VisibilityEnum.VISIBLE_ALL)
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,protected Boolean isCustom = false;
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,@Override
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,public Boolean getSearchable() {
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,if (searchable == null) {
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,return false;
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,}
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,return searchable;
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,public void setSearchable(Boolean searchable) {
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,this.searchable = searchable;
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,public FieldType getFacetFieldType() {
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,return FieldType.getInstance(facetFieldType);
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,public void setFacetFieldType(FieldType facetFieldType) {
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,this.facetFieldType = facetFieldType == null ? null : facetFieldType.getType();
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,public Boolean getIsCustom() {
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,return translatable == null ? false : translatable;
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,public void setIsCustom(Boolean isCustom) {
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,this.isCustom = isCustom;
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,cloned.setFacetFieldType(getFacetFieldType());
cc464a54aeabefb4edb61128afa86ce5849d3fe4,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,cloned.setSearchable(searchable);
62273011bb01bd820d123e8c9898330e3f618f70,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,return readFieldsByEntityType(FieldEntity.PRODUCT);
62273011bb01bd820d123e8c9898330e3f618f70,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,return readFieldsByEntityType(FieldEntity.SKU);
62273011bb01bd820d123e8c9898330e3f618f70,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.core.catalog.domain.ProductImpl;
62273011bb01bd820d123e8c9898330e3f618f70,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,CriteriaBuilder builder = em.getCriteriaBuilder();
62273011bb01bd820d123e8c9898330e3f618f70,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,CriteriaQuery<Field> criteria = builder.createQuery(Field.class);
62273011bb01bd820d123e8c9898330e3f618f70,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,Root<FieldImpl> root = criteria.from(FieldImpl.class);
62273011bb01bd820d123e8c9898330e3f618f70,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,criteria.select(root);
62273011bb01bd820d123e8c9898330e3f618f70,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,criteria.where(
62273011bb01bd820d123e8c9898330e3f618f70,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"builder.or(builder.equal(root.get(""entityType""), FieldEntity.PRODUCT.getType()),"
62273011bb01bd820d123e8c9898330e3f618f70,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"builder.equal(root.get(""entityType"").as(String.class), ProductImpl.class.getName()))"
62273011bb01bd820d123e8c9898330e3f618f70,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,);
62273011bb01bd820d123e8c9898330e3f618f70,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,TypedQuery<Field> query = em.createQuery(criteria);
62273011bb01bd820d123e8c9898330e3f618f70,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"query.setHint(QueryHints.HINT_CACHEABLE, true);"
62273011bb01bd820d123e8c9898330e3f618f70,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"query.setHint(QueryHints.HINT_CACHE_REGION, ""query.Catalog"");"
62273011bb01bd820d123e8c9898330e3f618f70,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,return query.getResultList();
62273011bb01bd820d123e8c9898330e3f618f70,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"builder.equal(root.get(""entityType"").as(String.class), FieldEntity.SKU.getType())"
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,* The main relationship to the rest of the search index entities
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,* @see {@link #getField()}
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,* @see {@link #getFacetFieldType()}
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,*/
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,public IndexFieldType getFieldType();
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,public void setFieldType(IndexFieldType fieldType);
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,/**
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,* <p>
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,* Returns the field associated with this facet.
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,*
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,* This is a convenience method for <pre>{@code getFieldType().getIndexField().getField()}</pre>
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,* This String represents the FieldType for the given SearchFacet. This is the FieldType that will be used when this Field is indexed in Solr
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,* This is a convience method for <pre>{@code getFieldType().getFieldType().getType()}</pre>
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,* @return the String representing the FieldType of this SearchFacet
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,public String getFacetFieldType();
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* Returns the field associated with this facet.
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* Sets the field associated with this facet.
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,*
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* @see #getFieldName()
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* @param fieldName
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,public void setField(Field field);
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,/**
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* This String represents the FieldType for the given SearchFacet. This is the FieldType that will be used when this Field is indexed in Solr
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* @return the String representing the FieldType of this SearchFacet
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,*/
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,public String getFacetFieldType();
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* Sets the FieldType for the current SearchFacet
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,* @param facetFieldType the String representation of a FieldType
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,public void setFacetFieldType(String facetFieldType);
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationClass;
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,import org.broadleafcommerce.common.presentation.PopulateToOneFieldsEnum;
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,@AdminPresentationClass(populateToOneFields = PopulateToOneFieldsEnum.TRUE)
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"@ManyToOne(optional=false, targetEntity = IndexFieldTypeImpl.class)"
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"@JoinColumn(name = ""INDEX_FIELD_TYPE_ID"")"
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"@AdminPresentationToOneLookup(lookupDisplayProperty = ""indexField.field.friendlyName"")"
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,protected IndexFieldType fieldType;
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"gridVisibleFields = { ""name"", ""label"", ""fieldType.indexField.field.friendlyName"" },"
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,@Override
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,public IndexFieldType getFieldType() {
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,return fieldType;
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,}
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,public void setFieldType(IndexFieldType fieldType) {
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,this.fieldType = fieldType;
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,return getFieldType().getIndexField().getField();
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,public String getFacetFieldType() {
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,return getFieldType().getFieldType().getType();
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,".append(fieldType, other.fieldType)"
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,.append(fieldType)
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,cloned.setFieldType(fieldType.createOrRetrieveCopyInstance(context).getClone());
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.common.presentation.client.SupportedFieldType;
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.core.search.domain.solr.FieldType;
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@ManyToOne(optional=false, targetEntity = FieldImpl.class)"
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@JoinColumn(name = ""FIELD_ID"")"
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@AdminPresentationToOneLookup(lookupDisplayProperty = ""friendlyName"")"
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,protected Field field;
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@Column(name = ""FACET_FIELD_TYPE"")"
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@AdminPresentation(friendlyName = ""SearchFacetImpl_facetFieldType"", group = ""SearchFacetImpl_description"", order = 4,"
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"fieldType = SupportedFieldType.BROADLEAF_ENUMERATION,"
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"broadleafEnumeration = ""org.broadleafcommerce.core.search.domain.solr.FieldType"","
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"requiredOverride = RequiredOverride.REQUIRED,"
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"defaultValue = ""t"")"
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,protected String facetFieldType;
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"gridVisibleFields = { ""name"", ""label"", ""field"" },"
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,return field;
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,public void setField(Field field) {
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,this.field = field;
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,@Override
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,public String getFacetFieldType() {
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,return facetFieldType;
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,}
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,public void setFacetFieldType(String facetFieldType) {
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,this.facetFieldType = facetFieldType;
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,".append(field, other.field)"
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,.append(field)
9ffe5bd9d9fdb43caf34335bb4f6e7e2411a3d5a,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,cloned.setField(field.createOrRetrieveCopyInstance(context).getClone());
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,import org.apache.solr.client.solrj.SolrClient;
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,import org.broadleafcommerce.core.search.domain.IndexField;
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,import org.broadleafcommerce.core.search.domain.IndexFieldType;
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public String getPropertyNameForIndexField(IndexField field, FieldType fieldType, String prefix) {"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,".append(field.getField().getAbbreviation()).append(""_"").append(fieldType.getType())"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public String getPropertyNameForIndexField(IndexField field, FieldType searchableFieldType) {"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"searchExtensionManager.getProxy().buildPrefixListForIndexField(field, searchableFieldType, prefixList);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"return getPropertyNameForIndexField(field, searchableFieldType, prefix);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public void attachSortClause(SolrQuery query, SearchCriteria searchCriteria, String defaultSort, List<IndexField> fields) {"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public Map<String, String> getSolrFieldKeyMap(SearchCriteria searchCriteria, List<IndexField> fields) {"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,for (IndexField field : fields) {
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,for (IndexFieldType type : field.getFieldTypes()) {
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"solrFieldKeyMap.put(field.getField().getAbbreviation(), getPropertyNameForIndexField(field, type.getFieldType()));"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,}
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"return getPropertyNameForIndexField(facet.getFacet().getFieldType().getIndexField(),"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,FieldType.getInstance(facet.getFacet().getFacetFieldType()));
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.apache.solr.client.solrj.SolrClient;
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public String getPropertyNameForFieldSearchable(Field field, FieldType searchableFieldType, String prefix) {"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,return new StringBuilder()
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,.append(prefix)
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,".append(field.getAbbreviation()).append(""_"").append(searchableFieldType.getType())"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,.toString();
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,}
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,@Override
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public String getPropertyNameForFieldFacet(Field field, String prefix, FieldType facetType) {"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (facetType == null) {
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,return null;
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,".append(field.getAbbreviation()).append(""_"").append(facetType.getType())"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public String getPropertyNameForFieldSearchable(Field field, FieldType searchableFieldType) {"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"searchExtensionManager.getProxy().buildPrefixListForSearchableField(field, searchableFieldType, prefixList);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"return getPropertyNameForFieldSearchable(field, searchableFieldType, prefix);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public String getPropertyNameForFieldFacet(Field field) {
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,SearchFacet searchFacet = searchFacetDao.readSearchFacetForField(field);
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (searchFacet == null || searchFacet.getFacetFieldType() == null) {
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,List<String> prefixList = new ArrayList<String>();
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"searchExtensionManager.getProxy().buildPrefixListForSearchableFacet(field, prefixList);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,String prefix = convertPrefixListToString(prefixList);
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"return getPropertyNameForFieldFacet(field, prefix, FieldType.getInstance(searchFacet.getFacetFieldType()));"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public void attachSortClause(SolrQuery query, SearchCriteria searchCriteria, String defaultSort, List<Field> fields) {"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public Map<String, String> getSolrFieldKeyMap(SearchCriteria searchCriteria, List<Field> fields) {"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,for (Field field : fields) {
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"solrFieldKeyMap.put(field.getAbbreviation(), getPropertyNameForFieldFacet(field));"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,return getPropertyNameForFieldFacet(facet.getFacet().getField());
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,List<IndexField> fields = null;
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,fields = indexFieldDao.readFieldsByEntityType(FieldEntity.SKU);
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,fields = indexFieldDao.readFieldsByEntityType(FieldEntity.PRODUCT);
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,for (IndexField currentField : fields) {
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"protected void getQueryFields(SolrQuery query, final List<String> queryFields, IndexField indexField) {"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"String solrFieldName = shs.getPropertyNameForIndexField(indexFieldType.getIndexField(), fieldType);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.broadleafcommerce.core.search.domain.Field;
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,List<Field> fields = null;
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,fields = fieldDao.readFieldsByEntityType(FieldEntity.SKU);
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,fields = fieldDao.readFieldsByEntityType(FieldEntity.PRODUCT);
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,for (Field currentField : fields) {
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"protected void getQueryFields(SolrQuery query, final List<String> queryFields, Field currentField) {"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,IndexField indexField = indexFieldDao.readIndexFieldForField(currentField);
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"String solrFieldName = shs.getPropertyNameForFieldSearchable(currentField, fieldType);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,/**
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* @param searchCriteria
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* @return a map of abbreviated key to fully qualified solr index field key for all product fields
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,*/
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"protected Map<String, String> getSolrFieldKeyMap(SearchCriteria searchCriteria) {"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (useSku) {
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,} else {
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,}
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"return shs.getSolrFieldKeyMap(searchCriteria, fields);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,import org.broadleafcommerce.core.search.domain.IndexField;
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"@Override public ExtensionResultStatusType populateDocumentForIndexField(SolrInputDocument document, IndexField field, FieldType fieldType, Map<String, Object> propertyValues) {"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public ExtensionResultStatusType modifyBuiltDocuments(Collection<SolrInputDocument> documents, List<? extends Indexable> products, List<IndexField> fields, List<Locale> locales) {"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"@Override public ExtensionResultStatusType populateDocumentForIndexField(SolrInputDocument document, Field field, FieldType fieldType, Map<String, Object> propertyValues, List<String> addedProperties) {"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public ExtensionResultStatusType modifyBuiltDocuments(Collection<SolrInputDocument> documents, List<? extends Indexable> products, List<Field> fields, List<Locale> locales) {"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,import org.broadleafcommerce.core.search.domain.IndexField;
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public SolrInputDocument buildDocument(Indexable indexable, List<IndexField> fields, List<Locale> locales);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public void attachIndexableDocumentFields(SolrInputDocument document, Indexable indexable, List<IndexField> fields, List<Locale> locales);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.broadleafcommerce.core.search.domain.Field;
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public SolrInputDocument buildDocument(Indexable indexable, List<Field> fields, List<Locale> locales);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public void attachIndexableDocumentFields(SolrInputDocument document, Indexable indexable, List<Field> fields, List<Locale> locales);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,import org.broadleafcommerce.core.search.domain.IndexField;
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public ExtensionResultStatusType modifyBuiltDocuments(Collection<SolrInputDocument> documents, List<? extends Indexable> items, List<IndexField> fields, List<Locale> locales);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public ExtensionResultStatusType populateDocumentForIndexField(SolrInputDocument document, IndexField field, FieldType fieldType, Map<String, Object> propertyValues);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public ExtensionResultStatusType modifyBuiltDocuments(Collection<SolrInputDocument> documents, List<? extends Indexable> items, List<Field> fields, List<Locale> locales);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public ExtensionResultStatusType populateDocumentForIndexField(SolrInputDocument document, Field field, FieldType fieldType, Map<String, Object> propertyValues, List<String> addedProperties);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,protected IndexFieldDao indexFieldDao;
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,List<IndexField> fields = null;
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,fields = indexFieldDao.readFieldsByEntityType(indexable.getFieldEntityType());
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public SolrInputDocument buildDocument(final Indexable indexable, List<IndexField> fields, List<Locale> locales) {"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public void attachIndexableDocumentFields(SolrInputDocument document, Indexable indexable, List<IndexField> fields, List<Locale> locales) {"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,for (IndexField indexField : fields) {
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"Map<String, Object> propertyValues = getPropertyValues(indexable, indexField.getField(), fieldType, locales);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"ExtensionResultStatusType result = extensionManager.getProxy().populateDocumentForIndexField(document, indexField, fieldType, propertyValues);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"String solrPropertyName = shs.getPropertyNameForIndexField(indexField, fieldType, prefix);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"LOG.error(""Could not get value for property["" + indexField.getField().getQualifiedFieldName() + ""] for product id["""
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.broadleafcommerce.core.search.domain.SearchFacet;
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,protected IndexFieldDao searchFieldDao;
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,List<Field> fields = null;
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,fields = fieldDao.readFieldsByEntityType(indexable.getFieldEntityType());
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public SolrInputDocument buildDocument(final Indexable indexable, List<Field> fields, List<Locale> locales) {"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public void attachIndexableDocumentFields(SolrInputDocument document, Indexable indexable, List<Field> fields, List<Locale> locales) {"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,// Keep track of fields added to the index.   We need to also add the search facets if
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,// they weren't already added as a normal index field.
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,List<String> addedProperties = new ArrayList<String>();
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,for (Field field : fields) {
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,IndexField indexField = searchFieldDao.readIndexFieldForField(field);
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"Map<String, Object> propertyValues = getPropertyValues(indexable, field, fieldType, locales);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"ExtensionResultStatusType result = extensionManager.getProxy().populateDocumentForIndexField(document, field, fieldType, propertyValues, addedProperties);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"String solrPropertyName = shs.getPropertyNameForFieldSearchable(field, fieldType, prefix);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,addedProperties.add(solrPropertyName);
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,}
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,// Index the faceted field type as well
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,// Determine if field is faceted (check if it has a search facet entry in BLC_SEARCH_FACET)
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,SearchFacet searchFacet = searchFacetDao.readSearchFacetForField(field);
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"// If we find a SearchFacet entry for this field, then this field is faceted"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (searchFacet != null && searchFacet.getFacetFieldType() != null) {
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"// Get the FacetFieldType for the SearchFacet, get the property values, and add a field to the document for each property value"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,FieldType facetType = FieldType.getInstance(searchFacet.getFacetFieldType());
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (facetType != null) {
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"Map<String, Object> propertyValues = getPropertyValues(indexable, field, facetType, locales);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,// Build out the field for every prefix
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"for (Entry<String, Object> entry : propertyValues.entrySet()) {"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,String prefix = entry.getKey();
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"prefix = StringUtils.isBlank(prefix) ? prefix : prefix + ""_"";"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"String solrFacetPropertyName = shs.getPropertyNameForFieldFacet(field, prefix, facetType);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,Object value = entry.getValue();
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (!addedProperties.contains(solrFacetPropertyName)) {
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"document.addField(solrFacetPropertyName, value);"
41437a2cc4317a8dd59bf809195467fda2f36212,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"LOG.error(""Could not get value for property["" + field.getQualifiedFieldName() + ""] for product id["""
532a5ae8e2248104cbb70821da4ebe29623476b0,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,newGroup.setIsUntitled(groupMetadata.getUntitled());
532a5ae8e2248104cbb70821da4ebe29623476b0,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,newGroup.setIsBorderless(groupMetadata.getBorderless());
532a5ae8e2248104cbb70821da4ebe29623476b0,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"untitled = true),"
532a5ae8e2248104cbb70821da4ebe29623476b0,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"order = OfferAdminPresentation.GroupOrder.Codes, untitled = true)"
532a5ae8e2248104cbb70821da4ebe29623476b0,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"borderless = true),"
532a5ae8e2248104cbb70821da4ebe29623476b0,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"order = OfferAdminPresentation.GroupOrder.Codes, borderless = true)"
b41b9b6083d172216a23a665b1948ed13a2d0a2c,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"friendlyName = ""AdminUserImpl_Admin_Password"","
b41b9b6083d172216a23a665b1948ed13a2d0a2c,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"group = AdminUserAdminPresentation.GroupName.User, order = 6000,"
b41b9b6083d172216a23a665b1948ed13a2d0a2c,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,"friendlyName = ""AdminUserImpl_Admin_Password"", order = 6000,"
b41b9b6083d172216a23a665b1948ed13a2d0a2c,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,"excluded = true,"
b41b9b6083d172216a23a665b1948ed13a2d0a2c,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,"group = AdminUserAdminPresentation.GroupName.User,"
6b0ba50e77eeaa72edbc92f4b8d5aa5015250305,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,"FieldGroup fieldGroup = findGroupInTab(groupName, tabName);"
6b0ba50e77eeaa72edbc92f4b8d5aa5015250305,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,"public FieldGroup findGroupInTab(String groupName, String tabName) {"
6b0ba50e77eeaa72edbc92f4b8d5aa5015250305,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,if (groupName == null || tabName == null) {
6b0ba50e77eeaa72edbc92f4b8d5aa5015250305,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,return null;
6b0ba50e77eeaa72edbc92f4b8d5aa5015250305,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,}
6b0ba50e77eeaa72edbc92f4b8d5aa5015250305,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,if (tabName.equals(tab.getTitle())) {
6b0ba50e77eeaa72edbc92f4b8d5aa5015250305,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,FieldGroup fieldGroup = tab.findGroup(groupName);
6b0ba50e77eeaa72edbc92f4b8d5aa5015250305,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,if (fieldGroup != null) {
6b0ba50e77eeaa72edbc92f4b8d5aa5015250305,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,return fieldGroup;
6b0ba50e77eeaa72edbc92f4b8d5aa5015250305,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,FieldGroup fieldGroup = findGroup(groupName);
6b0ba50e77eeaa72edbc92f4b8d5aa5015250305,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,public FieldGroup findGroup(String groupName) {
6b0ba50e77eeaa72edbc92f4b8d5aa5015250305,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,FieldGroup fieldGroup = null;
6b0ba50e77eeaa72edbc92f4b8d5aa5015250305,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,fieldGroup = tab.findGroup(groupName);
6b0ba50e77eeaa72edbc92f4b8d5aa5015250305,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,if (fieldGroup != null) {
6b0ba50e77eeaa72edbc92f4b8d5aa5015250305,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,break;
6b0ba50e77eeaa72edbc92f4b8d5aa5015250305,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,return fieldGroup;
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,import org.springframework.beans.factory.annotation.Value;
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,"@Value(""${admin.form.validation.errors.hideTopLevelFieldErrors:false}"")"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,protected boolean hideTopLevelFieldErrors;
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,if (!hideTopLevelFieldErrors) {
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,for (FieldError err : bindStatus.getErrors().getFieldErrors()) {
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,"//attempt to look up which tab the field error is on. If it can't be found, just use"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,//the default tab for the group
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,String tabName = EntityForm.DEFAULT_TAB_NAME;
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,Tab tab = form.findTabForField(err.getField());
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,if (tab != null) {
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,tabName = tab.getTitle();
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,}
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,"Map<String, List<String>> tabErrors = result.get(tabName);"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,if (tabErrors == null) {
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,"tabErrors = new HashMap<String, List<String>>();"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,"result.put(tabName, tabErrors);"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,if (err.getField().contains(DynamicEntityFormInfo.FIELD_SEPARATOR)) {
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,//at this point the field name actually occurs within some array syntax
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,String fieldName = extractFieldName(err);
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,"String[] fieldInfo = fieldName.split(""\\"" + DynamicEntityFormInfo.FIELD_SEPARATOR);"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,Field formField = form.getDynamicForm(fieldInfo[0]).getFields().get(fieldName);
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,"LOG.warn(""Could not find field "" + fieldName + "" within the dynamic form "" + fieldInfo[0]);"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,"addFieldError(fieldName, err.getCode(), tabErrors);"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,if (form.getTabs().size() > 0) {
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,Field formField = form.findField(err.getField());
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,if (formField != null) {
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,"addFieldError(formField.getFriendlyName(), err.getCode(), tabErrors);"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,} else {
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,"LOG.warn(""Could not find field "" + err.getField() + "" within the main form"");"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,"addFieldError(err.getField(), err.getCode(), tabErrors);"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,//this is the code that is executed when a Translations add action contains errors
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,"//this branch of the code just puts a placeholder ""tabErrors"", to avoid errprProcessor parsing errors, and"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,"//avoids checking on tabs, fieldGroups or fields (which for translations are empty), thus skipping any warning"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,"Map<String, Object> localVariables = new HashMap<String, Object>();"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,"localVariables.put(""tabErrors"", tabErrors);"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,added,0,return ProcessorResult.setLocalVariables(localVariables);
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,for (FieldError err : bindStatus.getErrors().getFieldErrors()) {
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,"//attempt to look up which tab the field error is on. If it can't be found, just use"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,//the default tab for the group
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,String tabName = EntityForm.DEFAULT_TAB_NAME;
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,Tab tab = form.findTabForField(err.getField());
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,if (tab != null) {
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,tabName = tab.getTitle();
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,}
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,"Map<String, List<String>> tabErrors = result.get(tabName);"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,if (tabErrors == null) {
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,"tabErrors = new HashMap<String, List<String>>();"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,"result.put(tabName, tabErrors);"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,if (err.getField().contains(DynamicEntityFormInfo.FIELD_SEPARATOR)) {
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,//at this point the field name actually occurs within some array syntax
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,String fieldName = extractFieldName(err);
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,"String[] fieldInfo = fieldName.split(""\\"" + DynamicEntityFormInfo.FIELD_SEPARATOR);"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,Field formField = form.getDynamicForm(fieldInfo[0]).getFields().get(fieldName);
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,if (formField != null) {
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,"addFieldError(formField.getFriendlyName(), err.getCode(), tabErrors);"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,} else {
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,"LOG.warn(""Could not find field "" + fieldName + "" within the dynamic form "" + fieldInfo[0]);"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,"addFieldError(fieldName, err.getCode(), tabErrors);"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,if (form.getTabs().size() > 0) {
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,Field formField = form.findField(err.getField());
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,"LOG.warn(""Could not find field "" + err.getField() + "" within the main form"");"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,"addFieldError(err.getField(), err.getCode(), tabErrors);"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,//this is the code that is executed when a Translations add action contains errors
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,"//this branch of the code just puts a placeholder ""tabErrors"", to avoid errprProcessor parsing errors, and"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,"//avoids checking on tabs, fieldGroups or fields (which for translations are empty), thus skipping any warning"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,"Map<String, Object> localVariables = new HashMap<String, Object>();"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,"localVariables.put(""tabErrors"", tabErrors);"
053d01fc86d5860a7d28b3e06d54d30dee57d6ba,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,return ProcessorResult.setLocalVariables(localVariables);
487481058b1f94bb49ba0329d1835a924adbcf6b,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,FieldGroup fieldGroup = findGroup(groupName);
487481058b1f94bb49ba0329d1835a924adbcf6b,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,public FieldGroup findGroup(String groupName) {
487481058b1f94bb49ba0329d1835a924adbcf6b,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,FieldGroup fieldGroup = null;
487481058b1f94bb49ba0329d1835a924adbcf6b,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,fieldGroup = tab.findGroup(groupName);
487481058b1f94bb49ba0329d1835a924adbcf6b,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,if (fieldGroup != null) {
487481058b1f94bb49ba0329d1835a924adbcf6b,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,break;
487481058b1f94bb49ba0329d1835a924adbcf6b,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,return fieldGroup;
487481058b1f94bb49ba0329d1835a924adbcf6b,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,"FieldGroup fieldGroup = findGroupInTab(groupName, tabName);"
487481058b1f94bb49ba0329d1835a924adbcf6b,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,"public FieldGroup findGroupInTab(String groupName, String tabName) {"
487481058b1f94bb49ba0329d1835a924adbcf6b,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,if (groupName == null || tabName == null) {
487481058b1f94bb49ba0329d1835a924adbcf6b,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,return null;
487481058b1f94bb49ba0329d1835a924adbcf6b,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,}
487481058b1f94bb49ba0329d1835a924adbcf6b,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,if (tabName.equals(tab.getTitle())) {
487481058b1f94bb49ba0329d1835a924adbcf6b,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,FieldGroup fieldGroup = tab.findGroup(groupName);
487481058b1f94bb49ba0329d1835a924adbcf6b,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,if (fieldGroup != null) {
487481058b1f94bb49ba0329d1835a924adbcf6b,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,return fieldGroup;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,import org.broadleafcommerce.common.util.BLCMessageUtils;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,".append(o1.getProcessedTitle(), o2.getProcessedTitle())"
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,if (tab.getUnprocessedTitle() != null && tab.getUnprocessedTitle().equals(tabTitle)) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,public void removeGroup(FieldGroup group) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,for (Tab tab : getTabs()) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,tab.removeFieldGroup(group);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,}
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,if (tabName.equals(currentTab.getUnprocessedTitle())
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,|| tabName.equals(currentTab.getProcessedTitle())) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,FieldGroup containingGroup = null;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,findLg:
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,{
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,for (FieldGroup group : tab.getFieldGroups()) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,for (ListGrid lg : group.getListGrids()) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,if (subCollectionFieldName.equals(lg.getSubCollectionFieldName())) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,lgToRemove = lg;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,containingTab = tab;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,containingGroup = group;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,break findLg;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,if (lgToRemove != null && containingGroup != null) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,containingGroup.removeListGrid(lgToRemove);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,} else if (lgToRemove != null && containingGroup == null) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,if (containingGroup != null && containingGroup.getListGrids().size() == 0 && containingGroup.getFields().size() == 0) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,removeGroup(containingGroup);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,} else if (containingTab != null && containingTab.getListGrids().size() == 0 && containingTab.getFields().size() == 0) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,tab.setUnprocessedTitle(tabName);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,tab.setProcessedTitle(BLCMessageUtils.getMessage(tabName));
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,fieldGroup.setUnprocessedTitle(groupName);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,fieldGroup.setProcessedTitle(BLCMessageUtils.getMessage(groupName));
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,FieldGroup fieldGroup = tab.findGroupByUnprocessedTitle(groupName);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,return fieldGroup;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,return null;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,newTab.setUnprocessedTitle(tabMetadata.getTabName());
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,newTab.setProcessedTitle(BLCMessageUtils.getMessage(tabMetadata.getTabName()));
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,return newTab.getUnprocessedTitle();
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"public void addGroupFromGroupMetadata(GroupMetadata groupMetadata, String unprocessedTabName) {"
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,newGroup.setUnprocessedTitle(groupMetadata.getGroupName());
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,newGroup.setProcessedTitle(BLCMessageUtils.getMessage(groupMetadata.getGroupName()));
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,newGroup.setToolTip(groupMetadata.getTooltip());
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,Tab tab = findTab(unprocessedTabName);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,import org.broadleafcommerce.common.web.BroadleafRequestContext;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,".append(o1.getTitle(), o2.getTitle())"
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,if (tab.getTitle() != null && tab.getTitle().equals(tabTitle)) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,if (tabName.equals(currentTab.getTitle())) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,findLg: {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,if (lgToRemove != null) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,if (containingTab != null && containingTab.getListGrids().size() == 0 && containingTab.getFields().size() == 0) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,public String processMessageString(String message) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,BroadleafRequestContext context = BroadleafRequestContext.getBroadleafRequestContext();
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,if (context != null && context.getMessageSource() != null) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"return context.getMessageSource().getMessage(message, null, message, context.getJavaLocale());"
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,}
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,return message;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"// Tabs and groups should be looked up by their display, translated name since 2 unique strings can display the same"
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,// thing when they are looked up in message bundles after display
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,// When displayed on the form the duplicate groups and tabs look funny
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,groupName = processMessageString(groupName);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,tabName = processMessageString(tabName);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,tab.setTitle(tabName);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,fieldGroup.setTitle(groupName);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,FieldGroup fieldGroup = null;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,fieldGroup = tab.findGroup(groupName);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,break;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,return fieldGroup;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,// Tabs/Groups should be looked up and referenced by their display name
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,newTab.setTitle(tabMetadata.getTabName());
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,newTab.setTitle(processMessageString(tabMetadata.getTabName()));
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,return newTab.getTitle();
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"public void addGroupFromGroupMetadata(GroupMetadata groupMetadata, String processedTabName) {"
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,newGroup.setTitle(groupMetadata.getGroupName());
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,newGroup.setTitle(processMessageString(groupMetadata.getGroupName()));
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,newGroup.setToolTip(processMessageString(groupMetadata.getTooltip()));
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,Tab tab = findTab(processedTabName);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,import org.broadleafcommerce.common.util.BLCMessageUtils;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,".append(o1.getProcessedTitle(), o2.getProcessedTitle())"
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,if (tab.getUnprocessedTitle() != null && tab.getUnprocessedTitle().equals(tabTitle)) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,public void removeGroup(FieldGroup group) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,for (Tab tab : getTabs()) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,tab.removeFieldGroup(group);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,}
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,if (tabName.equals(currentTab.getUnprocessedTitle())
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,|| tabName.equals(currentTab.getProcessedTitle())) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,FieldGroup containingGroup = null;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,findLg:
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,{
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,for (FieldGroup group : tab.getFieldGroups()) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,for (ListGrid lg : group.getListGrids()) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,if (subCollectionFieldName.equals(lg.getSubCollectionFieldName())) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,lgToRemove = lg;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,containingTab = tab;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,containingGroup = group;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,break findLg;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,if (lgToRemove != null && containingGroup != null) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,containingGroup.removeListGrid(lgToRemove);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,} else if (lgToRemove != null && containingGroup == null) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,if (containingGroup != null && containingGroup.getListGrids().size() == 0 && containingGroup.getFields().size() == 0) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,removeGroup(containingGroup);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,} else if (containingTab != null && containingTab.getListGrids().size() == 0 && containingTab.getFields().size() == 0) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,tab.setUnprocessedTitle(tabName);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,tab.setProcessedTitle(BLCMessageUtils.getMessage(tabName));
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,fieldGroup.setUnprocessedTitle(groupName);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,fieldGroup.setProcessedTitle(BLCMessageUtils.getMessage(groupName));
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,FieldGroup fieldGroup = tab.findGroupByUnprocessedTitle(groupName);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,return fieldGroup;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,return null;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,newTab.setUnprocessedTitle(tabMetadata.getTabName());
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,newTab.setProcessedTitle(BLCMessageUtils.getMessage(tabMetadata.getTabName()));
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,return newTab.getUnprocessedTitle();
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,"public void addGroupFromGroupMetadata(GroupMetadata groupMetadata, String unprocessedTabName) {"
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,newGroup.setUnprocessedTitle(groupMetadata.getGroupName());
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,newGroup.setProcessedTitle(BLCMessageUtils.getMessage(groupMetadata.getGroupName()));
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,newGroup.setToolTip(groupMetadata.getTooltip());
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,Tab tab = findTab(unprocessedTabName);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.common.web.BroadleafRequestContext;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,".append(o1.getTitle(), o2.getTitle())"
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,if (tab.getTitle() != null && tab.getTitle().equals(tabTitle)) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,if (tabName.equals(currentTab.getTitle())) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,findLg: {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,if (lgToRemove != null) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,if (containingTab != null && containingTab.getListGrids().size() == 0 && containingTab.getFields().size() == 0) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,public String processMessageString(String message) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,BroadleafRequestContext context = BroadleafRequestContext.getBroadleafRequestContext();
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,if (context != null && context.getMessageSource() != null) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,"return context.getMessageSource().getMessage(message, null, message, context.getJavaLocale());"
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,}
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,return message;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,"// Tabs and groups should be looked up by their display, translated name since 2 unique strings can display the same"
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,// thing when they are looked up in message bundles after display
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,// When displayed on the form the duplicate groups and tabs look funny
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,groupName = processMessageString(groupName);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,tabName = processMessageString(tabName);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,tab.setTitle(tabName);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,fieldGroup.setTitle(groupName);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,FieldGroup fieldGroup = null;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,fieldGroup = tab.findGroup(groupName);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,break;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,return fieldGroup;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,// Tabs/Groups should be looked up and referenced by their display name
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,newTab.setTitle(tabMetadata.getTabName());
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,newTab.setTitle(processMessageString(tabMetadata.getTabName()));
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,return newTab.getTitle();
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,"public void addGroupFromGroupMetadata(GroupMetadata groupMetadata, String processedTabName) {"
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,newGroup.setTitle(groupMetadata.getGroupName());
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,newGroup.setTitle(processMessageString(groupMetadata.getGroupName()));
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,newGroup.setToolTip(processMessageString(groupMetadata.getTooltip()));
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,Tab tab = findTab(processedTabName);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,protected String processedTitle;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,protected String unprocessedTitle;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,public String getUnprocessedTitle() {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,return unprocessedTitle;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,public void setUnprocessedTitle(String unprocessedTitle) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,this.unprocessedTitle = unprocessedTitle;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,}
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,public String getProcessedTitle() {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,return processedTitle;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,public void setProcessedTitle(String processedTitle) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,this.processedTitle = processedTitle;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,public FieldGroup withUnprocessedTitle(String unprocessedTitle) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,setUnprocessedTitle(unprocessedTitle);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,return this;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,public FieldGroup withProcessedTitle(String processedTitle) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,setProcessedTitle(processedTitle);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,"if ((getUnprocessedTitle() != null && getUnprocessedTitle().toLowerCase().contains(""master""))"
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,"|| (getProcessedTitle() != null && getProcessedTitle().toLowerCase().contains(""master"")) ) {"
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,protected String title;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,public String getTitle() {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,return title;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,public void setTitle(String title) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,this.title = title;
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,public FieldGroup withTitle(String title) {
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,setTitle(title);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,"if (getTitle() != null && getTitle().toLowerCase().contains(""master"")) {"
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,String unprocessedTabName = ef.addTabFromTabMetadata(tabMetadata);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,"ef.addGroupFromGroupMetadata(tabMetadata.getGroupMetadata().get(groupKey), unprocessedTabName);"
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,String processedTabName = ef.addTabFromTabMetadata(tabMetadata);
e8bb4cfc8b1e5a04e281c5f7b7d84e3b11ff8859,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,"ef.addGroupFromGroupMetadata(tabMetadata.getGroupMetadata().get(groupKey), processedTabName);"
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,import org.apache.solr.common.util.NamedList;
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"searchExtensionManager.getProxy().setFacetResults(namedFacetMap, response);"
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"ExtensionResultStatusType status = searchExtensionManager.getProxy().attachFacet(query, entry.getKey(), dto);"
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (ExtensionResultStatusType.NOT_HANDLED.equals(status)) {
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,// Clone the list - we don't want to remove these facets from the DB
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,List<SearchFacetRange> facetRanges = new ArrayList<SearchFacetRange>(dto.getFacet().getSearchFacetRanges());
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (searchExtensionManager != null) {
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"searchExtensionManager.getProxy().filterSearchFacetRanges(dto, facetRanges);"
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,}
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (facetRanges != null && facetRanges.size() > 0) {
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,for (SearchFacetRange range : facetRanges) {
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"query.addFacetQuery(getSolrTaggedFieldString(entry.getKey(), ""key"", range));"
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,} else {
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"query.addFacetField(getSolrTaggedFieldString(entry.getKey(), ""ex"", null));"
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,FieldType.getInstance(facet.getFacet().getFacetFieldType()));
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,// Clone the list - we don't want to remove these facets from the DB
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,List<SearchFacetRange> facetRanges = new ArrayList<SearchFacetRange>(dto.getFacet().getSearchFacetRanges());
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (searchExtensionManager != null) {
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"searchExtensionManager.getProxy().filterSearchFacetRanges(dto, facetRanges);"
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,}
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (facetRanges != null && facetRanges.size() > 0) {
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,for (SearchFacetRange range : facetRanges) {
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"query.addFacetQuery(getSolrTaggedFieldString(entry.getKey(), ""key"", range));"
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,} else {
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"query.addFacetField(getSolrTaggedFieldString(entry.getKey(), ""ex"", null));"
61c5060d04bd4e8761489407789ec60c75e39d5b,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,FieldType.getInstance(facet.getFacet().getFacetFieldType()));
5495354dc1d79a379644075eed086cf2ebd9d0c8,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"@AdminPresentation(friendlyName = ""SearchFacetImpl_name"", group = GroupName.General,"
5495354dc1d79a379644075eed086cf2ebd9d0c8,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"@AdminPresentation(friendlyName = ""SearchFacetImpl_field"", order = 2000, group = GroupName.General,"
5495354dc1d79a379644075eed086cf2ebd9d0c8,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"group = GroupName.General,"
5495354dc1d79a379644075eed086cf2ebd9d0c8,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"group = GroupName.Options,"
5495354dc1d79a379644075eed086cf2ebd9d0c8,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"tabOrder = 2000,"
5495354dc1d79a379644075eed086cf2ebd9d0c8,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"defaultValue = ""false"")"
5495354dc1d79a379644075eed086cf2ebd9d0c8,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"@AdminPresentationCollection(addType = AddMethodType.PERSIST,"
5495354dc1d79a379644075eed086cf2ebd9d0c8,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"friendlyName = ""newRangeTitle"","
5495354dc1d79a379644075eed086cf2ebd9d0c8,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,group = GroupName.General)
5495354dc1d79a379644075eed086cf2ebd9d0c8,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"group = GroupName.Dependent,"
5495354dc1d79a379644075eed086cf2ebd9d0c8,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,@AdminPresentationClass(populateToOneFields = PopulateToOneFieldsEnum.TRUE)
5495354dc1d79a379644075eed086cf2ebd9d0c8,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@AdminPresentation(friendlyName = ""SearchFacetImpl_name"", group = ""SearchFacetImpl_description"","
5495354dc1d79a379644075eed086cf2ebd9d0c8,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@AdminPresentation(friendlyName = ""SearchFacetImpl_field"", order = 2000, group = ""SearchFacetImpl_description"","
5495354dc1d79a379644075eed086cf2ebd9d0c8,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"group = ""SearchFacetImpl_description"","
5495354dc1d79a379644075eed086cf2ebd9d0c8,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"tab = ""SearchFacetImpl_Advanced_tab"","
5495354dc1d79a379644075eed086cf2ebd9d0c8,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,tabOrder = 2000)
5495354dc1d79a379644075eed086cf2ebd9d0c8,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@AdminPresentationCollection(addType = AddMethodType.PERSIST, friendlyName = ""newRangeTitle"")"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"@AdminGroupPresentation(name = AdminUserAdminPresentation.GroupName.AdditionalFields,"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"order = AdminUserAdminPresentation.GroupOrder.AdditionalFields),"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"@AdminGroupPresentation(name = AdminUserAdminPresentation.GroupName.RolesAndPermissions,"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"order = AdminUserAdminPresentation.GroupOrder.RolesAndPermissions,"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"column = 1),"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"@AdminGroupPresentation(name = AdminUserAdminPresentation.GroupName.Miscellaneous,"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"order = AdminUserAdminPresentation.GroupOrder.Miscellaneous,"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"column = 1, untitled = true)"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"public static final String AdditionalFields = ""AdminUserImpl_AdditionalFields"";"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"public static final String RolesAndPermissions = ""AdminUserImpl_RolesAndPermissions"";"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"public static final String Miscellaneous = ""AdminUserImpl_Miscellaneous"";"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,public static final int AdditionalFields = 2000;
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,public static final int RolesAndPermissions = 1000;
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,public static final int Miscellaneous = 2000;
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,}
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,public static class FieldOrder {
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,public static final int NAME = 1000;
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,public static final int LOGIN = 2000;
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,public static final int EMAIL = 3000;
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,public static final int PHONE_NUMBER = 4000;
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,public static final int PASSWORD = 5000;
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,public static final int ACTIVE_STATUS_FLAG = 1000;
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,public static final int ROLES = 1000;
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,public static final int PERMISSIONS = 2000;
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,"@AdminGroupPresentation(name = AdminUserAdminPresentation.GroupName.PermissionsAndRoles,"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,"order = AdminUserAdminPresentation.GroupOrder.PermissionsAndRoles,"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,column = 1)
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,"public static final String PermissionsAndRoles = ""AdminUserImpl_PermissionsAndRoles"";"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,public static final int PermissionsAndRoles = 2000;
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"@AdminPresentation(friendlyName = ""AdminUserImpl_Admin_Name"","
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"group = GroupName.User, order = FieldOrder.NAME,"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"prominent = true, gridOrder = 1000)"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"@AdminPresentation(friendlyName = ""AdminUserImpl_Admin_Login"","
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"group = GroupName.User, order = FieldOrder.LOGIN,"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"prominent = true, gridOrder = 2000)"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"group = GroupName.User, order = FieldOrder.PASSWORD,"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"@AdminPresentation(friendlyName = ""AdminUserImpl_Admin_Email_Address"","
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"group = GroupName.User, order = FieldOrder.EMAIL)"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"@AdminPresentation(friendlyName = ""AdminUserImpl_Phone_Number"","
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"group = GroupName.User, order = FieldOrder.PHONE_NUMBER)"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"group = GroupName.Miscellaneous, order = FieldOrder.ACTIVE_STATUS_FLAG,"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,protected Boolean activeStatusFlag;
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"@AdminPresentationCollection(friendlyName = ""roleListTitle"","
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"group = GroupName.RolesAndPermissions, order = FieldOrder.ROLES,"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"addType = AddMethodType.SELECTIZE_LOOKUP, selectizeVisibleField = ""description"","
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"manyToField = ""allUsers"","
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,operationTypes = @AdminPresentationOperationTypes(removeType = OperationType.NONDESTRUCTIVEREMOVE))
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"@AdminPresentationCollection(friendlyName = ""permissionListTitle"","
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"group = GroupName.RolesAndPermissions, order = FieldOrder.PERMISSIONS,"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"addType = AddMethodType.SELECTIZE_LOOKUP,"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"group = GroupName.AdditionalFields,"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,"@AdminPresentation(friendlyName = ""AdminUserImpl_Admin_Name"", gridOrder = 1000, order = 1000,"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,"group = AdminUserAdminPresentation.GroupName.User, prominent = true, defaultValue = """")"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,"@AdminPresentation(friendlyName = ""AdminUserImpl_Admin_Login"", gridOrder = 2000, order = 2000,"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,"group = AdminUserAdminPresentation.GroupName.User, order = 6000,"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,"@AdminPresentation(friendlyName = ""AdminUserImpl_Admin_Email_Address"", order = 3000, group = AdminUserAdminPresentation.GroupName.User, defaultValue = """")"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,"@AdminPresentation(friendlyName = ""AdminUserImpl_Phone_Number"", order = 5000, group = AdminUserAdminPresentation.GroupName.User)"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,"order = 4000, group = AdminUserAdminPresentation.GroupName.User,"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,protected Boolean activeStatusFlag = Boolean.TRUE;
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,"@AdminPresentationCollection(addType = AddMethodType.SELECTIZE_LOOKUP, selectizeVisibleField = ""description"","
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,"friendlyName = ""roleListTitle"", manyToField = ""allUsers"","
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,"group = GroupName.PermissionsAndRoles, operationTypes = @AdminPresentationOperationTypes(removeType = OperationType.NONDESTRUCTIVEREMOVE))"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,"@AdminPresentationCollection(addType = AddMethodType.SELECTIZE_LOOKUP,"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,"group = GroupName.PermissionsAndRoles,"
580a803022e273910b5b5418dc26e839baa0189f,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,"friendlyName = ""permissionListTitle"","
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import org.broadleafcommerce.common.util.BLCMessageUtils;
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import org.broadleafcommerce.openadmin.dto.*;
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import org.broadleafcommerce.openadmin.web.form.component.*;
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,"PersistencePackageRequest ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs);"
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,ClassMetadata collectionCmd = adminEntityService.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,if (collectionCmd.getPolymorphicEntities().getChildren().length != 0) {
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,List<ClassTree> entityTypes = collectionCmd.getPolymorphicEntities().getCollapsedClassTrees();
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,for (ClassTree entityType : entityTypes) {
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,ListGridAction ADD = new ListGridAction(ListGridAction.ADD)
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,".withButtonClass(""sub-list-grid-add"")"
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,.withActionTargetEntity(entityType.getFullyQualifiedClassname())
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,".withUrlPostfix(""/add"")"
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,".withIconClass(""blc-icon-add-category"")"
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,".withDisplayText(""Add "" + BLCMessageUtils.getMessage(entityType.getFriendlyName()));"
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,"listGrid.getToolbarActions().add(0, ADD);"
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,}
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,} else {
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,"listGrid.getToolbarActions().add(0, DefaultListGridActions.ADD);"
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,//        for (ListGrid lg : ef.getAllListGrids()) {
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,//            // We always want the add option to be the first toolbar action for consistency
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,//            if (lg.getToolbarActions().isEmpty()) {
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,//                lg.addToolbarAction(DefaultListGridActions.ADD);
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,//            } else {
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,"//                lg.getToolbarActions().add(0, DefaultListGridActions.ADD);"
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,//            }
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,//        }
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,//
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.AdornedTargetCollectionMetadata;
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.AdornedTargetList;
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.BasicCollectionMetadata;
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.BasicFieldMetadata;
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.ClassMetadata;
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.CollectionMetadata;
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.DynamicResultSet;
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.Entity;
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.FieldMetadata;
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.ForeignKey;
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.MapMetadata;
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.MapStructure;
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.Property;
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.SectionCrumb;
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.TabMetadata;
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.DefaultListGridActions;
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.ListGrid;
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.ListGridRecord;
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.MediaField;
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.RuleBuilderField;
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,for (ListGrid lg : ef.getAllListGrids()) {
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,// We always want the add option to be the first toolbar action for consistency
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,if (lg.getToolbarActions().isEmpty()) {
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,lg.addToolbarAction(DefaultListGridActions.ADD);
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,} else {
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,"lg.getToolbarActions().add(0, DefaultListGridActions.ADD);"
d2a7aba6e2de0eddef63fa437ce4946068978461,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,}
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,import org.broadleafcommerce.common.util.BLCMessageUtils;
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,import org.broadleafcommerce.openadmin.dto.*;
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,import org.broadleafcommerce.openadmin.web.form.component.*;
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,"PersistencePackageRequest ppr = PersistencePackageRequest.fromMetadata(md, sectionCrumbs);"
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,ClassMetadata collectionCmd = adminEntityService.getClassMetadata(ppr).getDynamicResultSet().getClassMetaData();
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,if (collectionCmd.getPolymorphicEntities().getChildren().length != 0) {
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,List<ClassTree> entityTypes = collectionCmd.getPolymorphicEntities().getCollapsedClassTrees();
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,for (ClassTree entityType : entityTypes) {
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,ListGridAction ADD = new ListGridAction(ListGridAction.ADD)
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,".withButtonClass(""sub-list-grid-add"")"
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,.withActionTargetEntity(entityType.getFullyQualifiedClassname())
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,".withUrlPostfix(""/add"")"
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,".withIconClass(""blc-icon-add-category"")"
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,".withDisplayText(""Add "" + BLCMessageUtils.getMessage(entityType.getFriendlyName()));"
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,"listGrid.getToolbarActions().add(0, ADD);"
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,}
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,} else {
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,"listGrid.getToolbarActions().add(0, DefaultListGridActions.ADD);"
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,//        for (ListGrid lg : ef.getAllListGrids()) {
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,//            // We always want the add option to be the first toolbar action for consistency
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,//            if (lg.getToolbarActions().isEmpty()) {
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,//                lg.addToolbarAction(DefaultListGridActions.ADD);
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,//            } else {
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,"//                lg.getToolbarActions().add(0, DefaultListGridActions.ADD);"
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,//            }
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,//        }
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,//
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.AdornedTargetCollectionMetadata;
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.AdornedTargetList;
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.BasicCollectionMetadata;
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.BasicFieldMetadata;
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.ClassMetadata;
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.CollectionMetadata;
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.DynamicResultSet;
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.Entity;
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.FieldMetadata;
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.ForeignKey;
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.MapMetadata;
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.MapStructure;
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.Property;
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.SectionCrumb;
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.TabMetadata;
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.DefaultListGridActions;
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.ListGrid;
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.ListGridRecord;
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.MediaField;
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.RuleBuilderField;
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,for (ListGrid lg : ef.getAllListGrids()) {
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,// We always want the add option to be the first toolbar action for consistency
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,if (lg.getToolbarActions().isEmpty()) {
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,lg.addToolbarAction(DefaultListGridActions.ADD);
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,} else {
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,"lg.getToolbarActions().add(0, DefaultListGridActions.ADD);"
d2a7aba6e2de0eddef63fa437ce4946068978461,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,}
c2aaffb07315e8093bce993ae676d82858e5d85e,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"group = OfferAdminPresentation.GroupName.ActivityRange, order = 4000,"
c2aaffb07315e8093bce993ae676d82858e5d85e,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,//
c2aaffb07315e8093bce993ae676d82858e5d85e,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,//    @Transient
c2aaffb07315e8093bce993ae676d82858e5d85e,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"//    @AdminPresentation(fieldType = SupportedFieldType.BOOLEAN_LINK,"
c2aaffb07315e8093bce993ae676d82858e5d85e,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"//            group = OfferAdminPresentation.GroupName.ActivityRange, order = 5000,"
c2aaffb07315e8093bce993ae676d82858e5d85e,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"//            friendlyName = ""OfferImpl_View_Visibility_Options"", defaultValue = ""false"","
c2aaffb07315e8093bce993ae676d82858e5d85e,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,//            visibility = VisibilityEnum.VISIBLE_ALL)
c2aaffb07315e8093bce993ae676d82858e5d85e,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,//    protected Boolean showAdvancedVisibilityOptions = false;
c2aaffb07315e8093bce993ae676d82858e5d85e,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"prominent =  true, gridOrder = 3,"
c2aaffb07315e8093bce993ae676d82858e5d85e,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"group = OfferAdminPresentation.GroupName.ActivityRange,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"public class FieldImpl implements Field, FieldAdminPresentation, AdminMainEntity {"
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"@AdminPresentation(friendlyName = ""FieldImpl_EntityType"","
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"group = GroupName.General, order = FieldOrder.ENTITY_TYPE,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"prominent = true, gridOrder = 1,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"fieldType = SupportedFieldType.BROADLEAF_ENUMERATION,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"broadleafEnumeration = ""org.broadleafcommerce.core.search.domain.FieldEntity"","
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"defaultValue = ""org.broadleafcommerce.core.catalog.domain.Product"","
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,requiredOverride = RequiredOverride.REQUIRED)
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"@AdminPresentation(friendlyName = ""FieldImpl_friendlyName"","
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"group = GroupName.General, order = FieldOrder.FRIENDLY_NAME,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"prominent = true, gridOrder = 2, translatable = true,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"@AdminPresentation(friendlyName = ""FieldImpl_propertyName"","
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"group = GroupName.General, order = FieldOrder.PROPERTY_NAME,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"prominent = true, gridOrder = 3,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"@AdminPresentation(friendlyName = ""FieldImpl_abbreviation"","
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"group = GroupName.General, order = FieldOrder.ABBREVIATION,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,excluded = true)
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"@AdminPresentation(friendlyName = ""FieldImpl_translatable"","
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"group = GroupName.General, order = FieldOrder.TRANSLATABLE,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,"public class FieldImpl implements Field, AdminMainEntity {"
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,"@AdminPresentation(friendlyName = ""FieldImpl_EntityType"", group = ""FieldImpl_general"", order = 1, prominent = true,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,"gridOrder = 1, fieldType = SupportedFieldType.BROADLEAF_ENUMERATION,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,"broadleafEnumeration = ""org.broadleafcommerce.core.search.domain.FieldEntity"","
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,requiredOverride = RequiredOverride.REQUIRED)
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,"@AdminPresentation(friendlyName = ""FieldImpl_friendlyName"", group = ""FieldImpl_general"", order = 2, gridOrder = 2,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,"prominent = true, translatable = true)"
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,"@AdminPresentation(friendlyName = ""FieldImpl_propertyName"", group = ""FieldImpl_general"", order = 3, gridOrder = 3,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,prominent = true)
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,"@AdminPresentation(friendlyName = ""FieldImpl_abbreviation"", group = ""FieldImpl_general"", order = 3, excluded = true)"
effa1c442bd544a55274c3354ab03a675b7ae1b6,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,"@AdminPresentation(friendlyName = ""FieldImpl_translatable"", group = ""FieldImpl_general"", excluded = true)"
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"public class FieldImpl implements Field, FieldAdminPresentation, AdminMainEntity {"
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"@AdminPresentation(friendlyName = ""FieldImpl_EntityType"","
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"group = GroupName.General, order = FieldOrder.ENTITY_TYPE,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"prominent = true, gridOrder = 1,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"fieldType = SupportedFieldType.BROADLEAF_ENUMERATION,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"broadleafEnumeration = ""org.broadleafcommerce.core.search.domain.FieldEntity"","
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"defaultValue = ""org.broadleafcommerce.core.catalog.domain.Product"","
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,requiredOverride = RequiredOverride.REQUIRED)
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"@AdminPresentation(friendlyName = ""FieldImpl_friendlyName"","
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"group = GroupName.General, order = FieldOrder.FRIENDLY_NAME,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"prominent = true, gridOrder = 2, translatable = true,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"@AdminPresentation(friendlyName = ""FieldImpl_propertyName"","
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"group = GroupName.General, order = FieldOrder.PROPERTY_NAME,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"prominent = true, gridOrder = 3,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"@AdminPresentation(friendlyName = ""FieldImpl_abbreviation"","
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"group = GroupName.General, order = FieldOrder.ABBREVIATION,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,excluded = true)
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"@AdminPresentation(friendlyName = ""FieldImpl_translatable"","
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"group = GroupName.General, order = FieldOrder.TRANSLATABLE,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"public class FieldImpl implements Field, AdminMainEntity {"
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@AdminPresentation(friendlyName = ""FieldImpl_EntityType"", group = ""FieldImpl_general"", order = 1, prominent = true,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"gridOrder = 1, fieldType = SupportedFieldType.BROADLEAF_ENUMERATION,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"broadleafEnumeration = ""org.broadleafcommerce.core.search.domain.FieldEntity"","
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,requiredOverride = RequiredOverride.REQUIRED)
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@AdminPresentation(friendlyName = ""FieldImpl_friendlyName"", group = ""FieldImpl_general"", order = 2, gridOrder = 2,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"prominent = true, translatable = true)"
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@AdminPresentation(friendlyName = ""FieldImpl_propertyName"", group = ""FieldImpl_general"", order = 3, gridOrder = 3,"
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,prominent = true)
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@AdminPresentation(friendlyName = ""FieldImpl_abbreviation"", group = ""FieldImpl_general"", order = 3, excluded = true)"
effa1c442bd544a55274c3354ab03a675b7ae1b6,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@AdminPresentation(friendlyName = ""FieldImpl_translatable"", group = ""FieldImpl_general"", excluded = true)"
9666d5ec7da8cab3b7fc1d353ff764b4371e073e,a4d551eb8e80d433566d7a54761750db6313563b,added,0,cloned.setField(field);
9666d5ec7da8cab3b7fc1d353ff764b4371e073e,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,cloned.setField(field.createOrRetrieveCopyInstance(context).getClone());
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,basicFieldMetadata.getFieldType() == SupportedFieldType.RULE_WITH_QUANTITY ||
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,basicFieldMetadata.getFieldType() == SupportedFieldType.RULE_SIMPLE_TIME)
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,basicFieldMetadata.getFieldType() == SupportedFieldType.RULE_WITH_QUANTITY)
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,SupportedFieldType.RULE_WITH_QUANTITY==mo1.getFieldType() ||
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,SupportedFieldType.RULE_SIMPLE_TIME==mo1.getFieldType() ||
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,SupportedFieldType.MEDIA==mo1.getFieldType() || o1.getName().contains(FieldManager.MAPFIELDSEPARATOR));
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,SupportedFieldType.RULE_WITH_QUANTITY==mo2.getFieldType() ||
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,SupportedFieldType.RULE_SIMPLE_TIME==mo2.getFieldType() ||
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,SupportedFieldType.MEDIA==mo2.getFieldType() || o2.getName().contains(FieldManager.MAPFIELDSEPARATOR));
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,SupportedFieldType.RULE_WITH_QUANTITY==mo1.getFieldType() ||
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,SupportedFieldType.MEDIA==mo1.getFieldType() || o1.getName().contains(FieldManager.MAPFIELDSEPARATOR));
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,SupportedFieldType.RULE_WITH_QUANTITY==mo2.getFieldType() ||
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,SupportedFieldType.MEDIA==mo2.getFieldType() || o2.getName().contains(FieldManager.MAPFIELDSEPARATOR));
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,populateValueRequest.getMetadata().getFieldType() == SupportedFieldType.RULE_SIMPLE ||
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,populateValueRequest.getMetadata().getFieldType() == SupportedFieldType.RULE_SIMPLE_TIME;
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,extractValueRequest.getMetadata().getFieldType() == SupportedFieldType.RULE_SIMPLE ||
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,extractValueRequest.getMetadata().getFieldType() == SupportedFieldType.RULE_SIMPLE_TIME;
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,case RULE_SIMPLE_TIME:{
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,"dirty = populateSimpleRule(populateValueRequest, instance);"
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,break;
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,}
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,if (extractValueRequest.getMetadata().getFieldType()== SupportedFieldType.RULE_SIMPLE ||
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,extractValueRequest.getMetadata().getFieldType()== SupportedFieldType.RULE_SIMPLE_TIME) {
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,originalFM.getFieldType() == SupportedFieldType.RULE_SIMPLE_TIME ||
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,populateValueRequest.getMetadata().getFieldType() == SupportedFieldType.RULE_SIMPLE;
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,extractValueRequest.getMetadata().getFieldType() == SupportedFieldType.RULE_SIMPLE;
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,if (extractValueRequest.getMetadata().getFieldType()== SupportedFieldType.RULE_SIMPLE) {
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,if (SupportedFieldType.RULE_SIMPLE.equals(populateValueRequest.getMetadata().getFieldType()) ||
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,SupportedFieldType.RULE_SIMPLE_TIME.equals(populateValueRequest.getMetadata().getFieldType())) {
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,populateValueRequest.getMetadata().getFieldType() == SupportedFieldType.RULE_SIMPLE ||
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,populateValueRequest.getMetadata().getFieldType() == SupportedFieldType.RULE_SIMPLE_TIME;
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,if (SupportedFieldType.RULE_SIMPLE.equals(populateValueRequest.getMetadata().getFieldType())) {
ce500bc103982f518d4760264a1626dbbe79f2db,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,populateValueRequest.getMetadata().getFieldType() == SupportedFieldType.RULE_SIMPLE;
10f72421ca9a81eb1a8d70da17ac517a1f695d55,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,tearDownContext(context);
10f72421ca9a81eb1a8d70da17ac517a1f695d55,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,tearDownContext(context);
10f72421ca9a81eb1a8d70da17ac517a1f695d55,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,BroadleafRequestContext context = BroadleafRequestContext.getBroadleafRequestContext();
10f72421ca9a81eb1a8d70da17ac517a1f695d55,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,} finally {
10f72421ca9a81eb1a8d70da17ac517a1f695d55,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,setupContext();
e2619cffc7a73212df18a451e653434278b96167,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"return new PropertyValidationResult(false, ""Tried to update QuantityBasedRule with ID "" + dto.getPk() + "" but that rule does not exist"");"
e2619cffc7a73212df18a451e653434278b96167,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"return new PropertyValidationResult(false, ""Tried to update QuantityBasedReule with ID "" + dto.getPk() + "" but that rule does not exist"");"
e2619cffc7a73212df18a451e653434278b96167,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildCollectionExpression(sb, entityKey, field, value, type, secondaryType, "".size()>0"", false, false, false, false, false);"
e2619cffc7a73212df18a451e653434278b96167,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildCollectionExpression(sb, entityKey, field, value, type, secondaryType, "".size()==0"", false, false, false, false, false);"
e2619cffc7a73212df18a451e653434278b96167,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (value.length == 1) {
e2619cffc7a73212df18a451e653434278b96167,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"value[0] = value[0].toString().replaceAll(""[\\[\\]]"", """");"
e2619cffc7a73212df18a451e653434278b96167,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(""["");"
e2619cffc7a73212df18a451e653434278b96167,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(formatValue(field, entityKey, type, secondaryType, value, isFieldComparison,"
e2619cffc7a73212df18a451e653434278b96167,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"ignoreCase, ignoreQuotes));"
e2619cffc7a73212df18a451e653434278b96167,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(""])"");"
e2619cffc7a73212df18a451e653434278b96167,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"return  entityKey + ""."" + fieldName;"
e2619cffc7a73212df18a451e653434278b96167,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildCollectionExpression(sb, entityKey, field, value, type, secondaryType, "".size()>0"", false, false, false, false, true);"
e2619cffc7a73212df18a451e653434278b96167,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildCollectionExpression(sb, entityKey, field, value, type, secondaryType, "".size()==0"", false, false, false, false, true);"
e2619cffc7a73212df18a451e653434278b96167,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,if (value.length > 1) {
e2619cffc7a73212df18a451e653434278b96167,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(""["");"
e2619cffc7a73212df18a451e653434278b96167,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(formatValue(field, entityKey, type, secondaryType, value, isFieldComparison,"
e2619cffc7a73212df18a451e653434278b96167,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"ignoreCase, ignoreQuotes));"
e2619cffc7a73212df18a451e653434278b96167,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(""])"");"
e2619cffc7a73212df18a451e653434278b96167,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,} else {
e2619cffc7a73212df18a451e653434278b96167,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append("")"");"
e2619cffc7a73212df18a451e653434278b96167,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"String response = entityKey + ""."" + fieldName;"
e2619cffc7a73212df18a451e653434278b96167,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"response = response.replaceAll(""\\."", "".?"");"
e2619cffc7a73212df18a451e653434278b96167,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return response;
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"@AdminTabPresentation(name = OfferAdminPresentation.TabName.Marketing,"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"order = OfferAdminPresentation.TabOrder.Marketing,"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,groups = {
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"@AdminGroupPresentation(name = OfferAdminPresentation.GroupName.Marketing,"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"order = OfferAdminPresentation.GroupOrder.Marketing, untitled = true)"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,}
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"),"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"order = OfferAdminPresentation.TabOrder.Codes,"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"@AdminGroupPresentation(name = OfferAdminPresentation.GroupName.Codes,"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"order = OfferAdminPresentation.GroupOrder.Codes, untitled = true)"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"public static final String Marketing = ""OfferImpl_Marketing_Tab"";"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,public static final int Marketing = 2000;
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,public static final int Codes = 3000;
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,public static final int Advanced = 4000;
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"public static final String Marketing = ""OfferImpl_Marketing"";"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,public static final int Marketing = 1000;
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,public static class FieldOrder {
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,public static final int Name = 1000;
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,public static final int Description = 2000;
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,public static final int Message = 3000;
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,public static final int TemplateType = 4000;
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,public static final int Amount = 5000;
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,public static final int OfferType = 5000;
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,public static final int DiscountType = 5000;
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"order = OfferAdminPresentation.TabOrder.Codes,"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,groups = {
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"@AdminGroupPresentation(name = OfferAdminPresentation.GroupName.Codes,"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"order = OfferAdminPresentation.GroupOrder.Codes, untitled = true)"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,}
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,public static final int Codes = 2000;
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,public static final int Advanced = 3000;
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"@AdminPresentation(friendlyName = ""OfferImpl_Offer_Name"", order = FieldOrder.Name,"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"@AdminPresentation(friendlyName = ""OfferImpl_Offer_Description"", order = FieldOrder.Description,"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"largeEntry = true, fieldType = SupportedFieldType.DESCRIPTION)"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"@AdminPresentation(friendlyName = ""OfferImpl_marketingMessage"", order = FieldOrder.Message,"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"group = GroupName.Marketing,"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"@AdminPresentation(friendlyName = ""OfferImpl_Offer_Type"", order = FieldOrder.OfferType,"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"group = GroupName.Description,"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"@AdminPresentation(friendlyName = ""OfferImpl_Offer_Discount_Type"", order = FieldOrder.DiscountType,"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"@AdminPresentation(friendlyName = ""OfferImpl_Offer_Value"", order = FieldOrder.Amount,"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"group = OfferAdminPresentation.GroupName.Description,"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"@AdminPresentation(friendlyName = ""OfferImpl_Offer_Name"", order = 1000,"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"@AdminPresentation(friendlyName = ""OfferImpl_Offer_Description"", order = 2000,"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,largeEntry = true)
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"@AdminPresentation(friendlyName = ""OfferImpl_marketingMessage"", order = 3000,"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"group = OfferAdminPresentation.GroupName.Description,"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"@AdminPresentation(friendlyName = ""OfferImpl_Offer_Type"", order = 1000,"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"group = OfferAdminPresentation.GroupName.RuleConfiguration,"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"@AdminPresentation(friendlyName = ""OfferImpl_Offer_Discount_Type"", order = 2000,"
19904547e0506788a7f625e3d7e82b575b08f5d4,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"@AdminPresentation(friendlyName = ""OfferImpl_Offer_Value"", order = 3000,"
19904547e0506788a7f625e3d7e82b575b08f5d4,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@AdminPresentation(friendlyName = ""OfferImpl_Offer_Name"", order = FieldOrder.Name,"
19904547e0506788a7f625e3d7e82b575b08f5d4,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@AdminPresentation(friendlyName = ""OfferImpl_Offer_Description"", order = FieldOrder.Description,"
19904547e0506788a7f625e3d7e82b575b08f5d4,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"largeEntry = true, fieldType = SupportedFieldType.DESCRIPTION)"
19904547e0506788a7f625e3d7e82b575b08f5d4,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@AdminPresentation(friendlyName = ""OfferImpl_marketingMessage"", order = FieldOrder.Message,"
19904547e0506788a7f625e3d7e82b575b08f5d4,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"group = GroupName.Marketing,"
19904547e0506788a7f625e3d7e82b575b08f5d4,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@AdminPresentation(friendlyName = ""OfferImpl_Offer_Type"", order = FieldOrder.OfferType,"
19904547e0506788a7f625e3d7e82b575b08f5d4,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"group = GroupName.Description,"
19904547e0506788a7f625e3d7e82b575b08f5d4,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@AdminPresentation(friendlyName = ""OfferImpl_Offer_Discount_Type"", order = FieldOrder.DiscountType,"
19904547e0506788a7f625e3d7e82b575b08f5d4,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@AdminPresentation(friendlyName = ""OfferImpl_Offer_Value"", order = FieldOrder.Amount,"
19904547e0506788a7f625e3d7e82b575b08f5d4,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"group = OfferAdminPresentation.GroupName.Description,"
19904547e0506788a7f625e3d7e82b575b08f5d4,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@AdminPresentation(friendlyName = ""OfferImpl_Offer_Name"", order = 1000,"
19904547e0506788a7f625e3d7e82b575b08f5d4,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@AdminPresentation(friendlyName = ""OfferImpl_Offer_Description"", order = 2000,"
19904547e0506788a7f625e3d7e82b575b08f5d4,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,largeEntry = true)
19904547e0506788a7f625e3d7e82b575b08f5d4,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@AdminPresentation(friendlyName = ""OfferImpl_marketingMessage"", order = 3000,"
19904547e0506788a7f625e3d7e82b575b08f5d4,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"group = OfferAdminPresentation.GroupName.Description,"
19904547e0506788a7f625e3d7e82b575b08f5d4,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@AdminPresentation(friendlyName = ""OfferImpl_Offer_Type"", order = 1000,"
19904547e0506788a7f625e3d7e82b575b08f5d4,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"group = OfferAdminPresentation.GroupName.RuleConfiguration,"
19904547e0506788a7f625e3d7e82b575b08f5d4,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@AdminPresentation(friendlyName = ""OfferImpl_Offer_Discount_Type"", order = 2000,"
19904547e0506788a7f625e3d7e82b575b08f5d4,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@AdminPresentation(friendlyName = ""OfferImpl_Offer_Value"", order = 3000,"
f780e1c9d149c7d775b516a5f178b68dda616262,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,"@AdminPresentation(friendlyName = ""OfferImpl_Offer_Automatically_Added"", order = 2000,"
f780e1c9d149c7d775b516a5f178b68dda616262,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,"group = GroupName.Customer,"
f780e1c9d149c7d775b516a5f178b68dda616262,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,"fieldType = SupportedFieldType.BOOLEAN, defaultValue = ""false"")"
f780e1c9d149c7d775b516a5f178b68dda616262,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,protected Boolean requiresCode = false;
f780e1c9d149c7d775b516a5f178b68dda616262,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,public boolean getRequiresCode() {
f780e1c9d149c7d775b516a5f178b68dda616262,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,if (requiresCode == null) {
f780e1c9d149c7d775b516a5f178b68dda616262,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,return requiresCode;
f780e1c9d149c7d775b516a5f178b68dda616262,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,public void setRequiresCode(boolean requiresCode) {
f780e1c9d149c7d775b516a5f178b68dda616262,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,this.requiresCode = requiresCode;
f780e1c9d149c7d775b516a5f178b68dda616262,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,if (getRequiresCode()) {
f780e1c9d149c7d775b516a5f178b68dda616262,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,if (requiresCode != null) {
f780e1c9d149c7d775b516a5f178b68dda616262,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,cloned.setRequiresCode(requiresCode);
f780e1c9d149c7d775b516a5f178b68dda616262,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,"@AdminPresentation(friendlyName = ""OfferImpl_Offer_Automatically_Added"", order = 5000,"
f780e1c9d149c7d775b516a5f178b68dda616262,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,"group = OfferAdminPresentation.GroupName.Usage,"
f780e1c9d149c7d775b516a5f178b68dda616262,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,fieldType = SupportedFieldType.BOOLEAN)
f780e1c9d149c7d775b516a5f178b68dda616262,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,protected Boolean automaticallyAdded = false;
f780e1c9d149c7d775b516a5f178b68dda616262,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,public boolean isAutomaticallyAdded() {
f780e1c9d149c7d775b516a5f178b68dda616262,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,if (automaticallyAdded == null) {
f780e1c9d149c7d775b516a5f178b68dda616262,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,return automaticallyAdded;
f780e1c9d149c7d775b516a5f178b68dda616262,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,public void setAutomaticallyAdded(boolean automaticallyAdded) {
f780e1c9d149c7d775b516a5f178b68dda616262,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,this.automaticallyAdded = automaticallyAdded;
f780e1c9d149c7d775b516a5f178b68dda616262,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,if (isAutomaticallyAdded()) {
f780e1c9d149c7d775b516a5f178b68dda616262,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,if (automaticallyAdded != null) {
f780e1c9d149c7d775b516a5f178b68dda616262,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,cloned.setAutomaticallyAdded(automaticallyAdded);
d5efcf4eca531ef1df036c68d9431cbc47d1fdca,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"tab = TabName.Qualifiers,"
d5efcf4eca531ef1df036c68d9431cbc47d1fdca,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"visibility = VisibilityEnum.HIDDEN_ALL, defaultValue = ""false"")"
d5efcf4eca531ef1df036c68d9431cbc47d1fdca,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"group = OfferAdminPresentation.GroupName.ShouldBeRelated,"
d5efcf4eca531ef1df036c68d9431cbc47d1fdca,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"visibility = VisibilityEnum.VISIBLE_ALL, defaultValue = ""false"")"
d5efcf4eca531ef1df036c68d9431cbc47d1fdca,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"group = OfferAdminPresentation.GroupName.RuleConfiguration,"
d5efcf4eca531ef1df036c68d9431cbc47d1fdca,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,visibility = VisibilityEnum.HIDDEN_ALL)
d5efcf4eca531ef1df036c68d9431cbc47d1fdca,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"group = OfferAdminPresentation.GroupName.Advanced,"
d5efcf4eca531ef1df036c68d9431cbc47d1fdca,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,visibility = VisibilityEnum.VISIBLE_ALL)
a4162d307974245c62a375460fd92a8d32b42091,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,"@AdminGroupPresentation(name = OfferAdminPresentation.GroupName.Restrictions,"
a4162d307974245c62a375460fd92a8d32b42091,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,"order = OfferAdminPresentation.GroupOrder.Restrictions,"
a4162d307974245c62a375460fd92a8d32b42091,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,"public static final String Restrictions = ""OfferImpl_Restrictions"";"
a4162d307974245c62a375460fd92a8d32b42091,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,public static final int Restrictions = 4000;
a4162d307974245c62a375460fd92a8d32b42091,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,"@AdminGroupPresentation(name = OfferAdminPresentation.GroupName.Usage,"
a4162d307974245c62a375460fd92a8d32b42091,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,"order = OfferAdminPresentation.GroupOrder.Usage,"
a4162d307974245c62a375460fd92a8d32b42091,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,"public static final String Usage = ""OfferImpl_Usage"";"
a4162d307974245c62a375460fd92a8d32b42091,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,public static final int Usage = 4000;
a4162d307974245c62a375460fd92a8d32b42091,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,group = OfferAdminPresentation.GroupName.Restrictions)
a4162d307974245c62a375460fd92a8d32b42091,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"group = OfferAdminPresentation.GroupName.Restrictions,"
a4162d307974245c62a375460fd92a8d32b42091,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,group = OfferAdminPresentation.GroupName.Advanced)
a4162d307974245c62a375460fd92a8d32b42091,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"group = OfferAdminPresentation.GroupName.Usage,"
a4162d307974245c62a375460fd92a8d32b42091,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,group = OfferAdminPresentation.GroupName.Restrictions)
a4162d307974245c62a375460fd92a8d32b42091,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,added,0,"group = OfferAdminPresentation.GroupName.Restrictions,"
a4162d307974245c62a375460fd92a8d32b42091,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,group = OfferAdminPresentation.GroupName.Advanced)
a4162d307974245c62a375460fd92a8d32b42091,7a9ee5f739bc3cce4747ea95a5fca1d4393b4f72,deleted,1,"group = OfferAdminPresentation.GroupName.Usage,"
73c8e579256ebb1944c6fe76ff647bd17ed7fd7a,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildCollectionExpression(sb, entityKey, field, value, type, secondaryType, "".size()>0"", false, false, false, false, true);"
73c8e579256ebb1944c6fe76ff647bd17ed7fd7a,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildCollectionExpression(sb, entityKey, field, value, type, secondaryType, "".size()==0"", false, false, false, false, true);"
73c8e579256ebb1944c6fe76ff647bd17ed7fd7a,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (value.length > 1) {
73c8e579256ebb1944c6fe76ff647bd17ed7fd7a,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(""["");"
73c8e579256ebb1944c6fe76ff647bd17ed7fd7a,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(formatValue(field, entityKey, type, secondaryType, value, isFieldComparison,"
73c8e579256ebb1944c6fe76ff647bd17ed7fd7a,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"ignoreCase, ignoreQuotes));"
73c8e579256ebb1944c6fe76ff647bd17ed7fd7a,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(""])"");"
73c8e579256ebb1944c6fe76ff647bd17ed7fd7a,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else {
73c8e579256ebb1944c6fe76ff647bd17ed7fd7a,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append("")"");"
73c8e579256ebb1944c6fe76ff647bd17ed7fd7a,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildCollectionExpression(sb, entityKey, field, value, type, secondaryType, "".size()>0"", false, false, false, false, false);"
73c8e579256ebb1944c6fe76ff647bd17ed7fd7a,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildCollectionExpression(sb, entityKey, field, value, type, secondaryType, "".size()==0"", false, false, false, false, false);"
73c8e579256ebb1944c6fe76ff647bd17ed7fd7a,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,if (value.length == 1) {
73c8e579256ebb1944c6fe76ff647bd17ed7fd7a,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"value[0] = value[0].toString().replaceAll(""[\\[\\]]"", """");"
73c8e579256ebb1944c6fe76ff647bd17ed7fd7a,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(""["");"
73c8e579256ebb1944c6fe76ff647bd17ed7fd7a,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(formatValue(field, entityKey, type, secondaryType, value, isFieldComparison,"
73c8e579256ebb1944c6fe76ff647bd17ed7fd7a,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"ignoreCase, ignoreQuotes));"
73c8e579256ebb1944c6fe76ff647bd17ed7fd7a,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(""])"");"
5c387fb38a8cf051a546849233ba0fe413259526,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"if (orderMeetsQualifyingSubtotalRequirements(order, itemOffer) && orderMeetsSubtotalRequirements(order, itemOffer)) {"
5c387fb38a8cf051a546849233ba0fe413259526,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"protected boolean orderMeetsQualifyingSubtotalRequirements(PromotableOrder order, PromotableCandidateItemOffer itemOffer) {"
5c387fb38a8cf051a546849233ba0fe413259526,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"protected boolean orderMeetsSubtotalRequirements(PromotableOrder order, PromotableCandidateItemOffer itemOffer) {"
5c387fb38a8cf051a546849233ba0fe413259526,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (itemOffer.getOffer().getOrderMinSubTotal() == null ||
5c387fb38a8cf051a546849233ba0fe413259526,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,itemOffer.getOffer().getOrderMinSubTotal().lessThanOrEqual(Money.ZERO) ||
5c387fb38a8cf051a546849233ba0fe413259526,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,itemOffer.getOffer().getOrderMinSubTotal().lessThanOrEqual(order.getOrder().getSubTotal())) {
5c387fb38a8cf051a546849233ba0fe413259526,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return true;
5c387fb38a8cf051a546849233ba0fe413259526,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
5c387fb38a8cf051a546849233ba0fe413259526,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return false;
5c387fb38a8cf051a546849233ba0fe413259526,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"if (offerMeetsSubtotalRequirements(order, itemOffer)) {"
5c387fb38a8cf051a546849233ba0fe413259526,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"protected boolean offerMeetsSubtotalRequirements(PromotableOrder order, PromotableCandidateItemOffer itemOffer) {"
011967caca56c72d4c88d8db20abf395625d3f6a,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"group = OfferAdminPresentation.GroupName.Advanced,"
011967caca56c72d4c88d8db20abf395625d3f6a,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"defaultValue = ""true"")"
011967caca56c72d4c88d8db20abf395625d3f6a,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,protected Boolean applyToSalePrice = true;
011967caca56c72d4c88d8db20abf395625d3f6a,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,group = OfferAdminPresentation.GroupName.Advanced)
011967caca56c72d4c88d8db20abf395625d3f6a,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,protected Boolean applyToSalePrice = false;
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"@AdminGroupPresentation(name = OfferAdminPresentation.GroupName.Customer,"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"order = OfferAdminPresentation.GroupOrder.Customer,"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"column = 1),"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"@AdminGroupPresentation(name = OfferAdminPresentation.GroupName.CombineStack,"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"column = 1,"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"collapsed = true),"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,collapsed = true)
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"order = OfferAdminPresentation.GroupOrder.ShouldBeRelated,"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"untitled = true),"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"order = OfferAdminPresentation.TabOrder.Marketing,"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,groups = {
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"@AdminGroupPresentation(name = OfferAdminPresentation.GroupName.Marketing,"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"order = OfferAdminPresentation.GroupOrder.Marketing,"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,untitled = true)
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,}
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"order = OfferAdminPresentation.TabOrder.Codes,"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"@AdminGroupPresentation(name = OfferAdminPresentation.GroupName.Codes,"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"order = OfferAdminPresentation.GroupOrder.Codes,"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"order = OfferAdminPresentation.GroupOrder.Advanced,"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"@AdminGroupPresentation(name = OfferAdminPresentation.GroupName.Customer,"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"order = OfferAdminPresentation.GroupOrder.Customer,"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"column = 1),"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"@AdminGroupPresentation(name = OfferAdminPresentation.GroupName.CombineStack,"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"column = 1, collapsed = true),"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"column = 1, collapsed = true)"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"order = OfferAdminPresentation.GroupOrder.ShouldBeRelated,"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"column = 1, untitled = true),"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"order = OfferAdminPresentation.TabOrder.Marketing,"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,groups = {
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"@AdminGroupPresentation(name = OfferAdminPresentation.GroupName.Marketing,"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"order = OfferAdminPresentation.GroupOrder.Marketing, untitled = true)"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,}
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"order = OfferAdminPresentation.TabOrder.Codes,"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"@AdminGroupPresentation(name = OfferAdminPresentation.GroupName.Codes,"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"order = OfferAdminPresentation.GroupOrder.Codes, untitled = true)"
f04e710982baef0ab83dbd33dc79e46cff87a540,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,order = OfferAdminPresentation.GroupOrder.Advanced)
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,protected TreeSet<Tab> tabs = new TreeSet<Tab>(new Comparator<Tab>() {
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,public FieldGroup findGroup(String groupName) {
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,for (Tab tab : tabs) {
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,FieldGroup fieldGroup = tab.findGroupByKey(groupName);
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,if (fieldGroup != null) {
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,return fieldGroup;
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,}
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,return null;
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,Tab firstTab = tabs.isEmpty() ? null : tabs.first();
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,FieldGroup firstGroup = firstTab == null || firstTab.getFieldGroups().isEmpty() ? null : ((TreeSet<FieldGroup>) firstTab.getFieldGroups()).first();
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,tabName = tabName == null ? (firstTab == null ? DEFAULT_TAB_NAME : firstTab.getKey()) : tabName;
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,tabOrder = tabOrder == null ? (firstTab == null ? DEFAULT_TAB_ORDER : firstTab.getOrder()) : tabOrder;
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,groupName = groupName == null ? (firstGroup == null ? DEFAULT_GROUP_NAME : firstGroup.getKey()) : groupName;
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,groupOrder = groupOrder == null ? (firstGroup == null ? DEFAULT_GROUP_ORDER : firstGroup.getOrder()) : groupOrder;
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,this.tabs.addAll(tabs);
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,protected Set<Tab> tabs = new TreeSet<Tab>(new Comparator<Tab>() {
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,TabMetadata firstTab = cmd.getFirstTab();
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,GroupMetadata firstGroup = firstTab == null ? null : firstTab.getFirstGroup();
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,tabName = tabName == null ? (field.getIsVisible() || firstTab == null ? DEFAULT_TAB_NAME : firstTab.getTabName()) : tabName;
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,tabOrder = tabOrder == null ? (field.getIsVisible() || firstTab == null ? DEFAULT_TAB_ORDER : firstTab.getTabOrder()) : tabOrder;
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,groupName = groupName == null ? (field.getIsVisible() || firstGroup == null ? DEFAULT_GROUP_NAME : firstGroup.getGroupName()) : groupName;
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,groupOrder = groupOrder == null ? (field.getIsVisible() || firstGroup == null ? DEFAULT_GROUP_ORDER : firstGroup.getGroupOrder()) : groupOrder;
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,public FieldGroup findGroup(String groupName) {
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,for (Tab tab : tabs) {
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,FieldGroup fieldGroup = tab.findGroupByKey(groupName);
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,if (fieldGroup != null) {
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,return fieldGroup;
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,}
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,return null;
db4e585d7a8309cf4425229adcf4778f6ee78e54,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,this.tabs = tabs;
db4e585d7a8309cf4425229adcf4778f6ee78e54,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,List<Field> homelessFields = new ArrayList<>();
db4e585d7a8309cf4425229adcf4778f6ee78e54,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,if (fmd.getGroup() == null) {
db4e585d7a8309cf4425229adcf4778f6ee78e54,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,homelessFields.add(f);
db4e585d7a8309cf4425229adcf4778f6ee78e54,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,} else {
db4e585d7a8309cf4425229adcf4778f6ee78e54,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,"ef.addField(cmd, f, fmd.getGroup(), fmd.getGroupOrder(), fmd.getTab(), fmd.getTabOrder());"
db4e585d7a8309cf4425229adcf4778f6ee78e54,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,}
db4e585d7a8309cf4425229adcf4778f6ee78e54,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,for (Field f : homelessFields) {
db4e585d7a8309cf4425229adcf4778f6ee78e54,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,"ef.addField(cmd, f, null, null, null, null);"
db4e585d7a8309cf4425229adcf4778f6ee78e54,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,deleted,1,"ef.addField(cmd, f, fmd.getGroup(), fmd.getGroupOrder(), fmd.getTab(), fmd.getTabOrder());"
8692d1f35ba1af98b0ee1a7cebcf5a1a26d47faf,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,return fields == null ? null : fields.get(fieldName);
8692d1f35ba1af98b0ee1a7cebcf5a1a26d47faf,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,return null;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import com.fasterxml.jackson.core.Version;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import com.fasterxml.jackson.databind.ObjectMapper;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import com.fasterxml.jackson.databind.module.SimpleModule;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import org.broadleafcommerce.common.presentation.client.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import org.broadleafcommerce.openadmin.dto.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import org.broadleafcommerce.openadmin.web.form.component.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import org.broadleafcommerce.openadmin.web.form.entity.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import javax.annotation.Resource;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import javax.persistence.ManyToOne;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import javax.persistence.OneToOne;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import javax.servlet.http.HttpServletRequest;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import java.text.DateFormatSymbols;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import java.text.SimpleDateFormat;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import java.util.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,// format date list grid cells
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,"SimpleDateFormat formatter = new SimpleDateFormat(""MMM d, Y @ hh:mma"");"
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,DateFormatSymbols symbols = new DateFormatSymbols(Locale.getDefault());
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,"symbols.setAmPmStrings(new String[] { ""am"", ""pm"" });"
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,formatter.setDateFormatSymbols(symbols);
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,"if (headerField.getFieldType().equals(""DATE"")) {"
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,try {
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,"Date date = new SimpleDateFormat(""yyyy.MM.dd HH:mm:ss"").parse(recordField.getValue());"
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,String newValue = formatter.format(date);
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,recordField.setValue(newValue);
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,} catch (Exception ex) {
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,recordField.setValue(p.getValue());
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,}
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,} else {
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.common.presentation.client.AddMethodType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.common.presentation.client.AdornedTargetAddMethodType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.common.presentation.client.LookupType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.common.presentation.client.PersistencePerspectiveItemType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.common.presentation.client.SupportedFieldType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.common.presentation.client.VisibilityEnum;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.AdornedTargetCollectionMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.AdornedTargetList;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.BasicCollectionMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.BasicFieldMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.ClassMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.ClassTree;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.CollectionMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.DynamicResultSet;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.Entity;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.FieldMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.ForeignKey;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.MapMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.MapStructure;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.Property;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.SectionCrumb;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.TabMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.DefaultListGridActions;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.ListGrid;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.ListGridAction;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.ListGridRecord;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.MediaField;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.RuleBuilderField;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.CodeField;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.ComboField;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.DefaultEntityFormActions;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.DynamicEntityFormInfo;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.EntityForm;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.Field;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import com.fasterxml.jackson.core.Version;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import com.fasterxml.jackson.databind.ObjectMapper;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import com.fasterxml.jackson.databind.module.SimpleModule;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import java.util.ArrayList;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import java.util.Arrays;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import java.util.Collections;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import java.util.Date;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import java.util.HashMap;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import java.util.List;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import java.util.Map;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import java.util.Set;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import javax.annotation.Resource;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import javax.persistence.ManyToOne;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import javax.persistence.OneToOne;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import javax.servlet.http.HttpServletRequest;
ac7344b9f94db20ca063a2ce918762ccabfddb79,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,recordField.setValue(p.getValue());
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,import com.fasterxml.jackson.core.Version;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,import com.fasterxml.jackson.databind.ObjectMapper;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,import com.fasterxml.jackson.databind.module.SimpleModule;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,import org.broadleafcommerce.common.presentation.client.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,import org.broadleafcommerce.openadmin.dto.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,import org.broadleafcommerce.openadmin.web.form.component.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,import org.broadleafcommerce.openadmin.web.form.entity.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,import javax.annotation.Resource;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,import javax.persistence.ManyToOne;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,import javax.persistence.OneToOne;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,import javax.servlet.http.HttpServletRequest;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,import java.text.DateFormatSymbols;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,import java.text.SimpleDateFormat;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,import java.util.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,// format date list grid cells
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,"SimpleDateFormat formatter = new SimpleDateFormat(""MMM d, Y @ hh:mma"");"
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,DateFormatSymbols symbols = new DateFormatSymbols(Locale.getDefault());
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,"symbols.setAmPmStrings(new String[] { ""am"", ""pm"" });"
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,formatter.setDateFormatSymbols(symbols);
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,"if (headerField.getFieldType().equals(""DATE"")) {"
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,try {
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,"Date date = new SimpleDateFormat(""yyyy.MM.dd HH:mm:ss"").parse(recordField.getValue());"
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,String newValue = formatter.format(date);
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,recordField.setValue(newValue);
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,} catch (Exception ex) {
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,recordField.setValue(p.getValue());
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,}
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,} else {
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.common.presentation.client.AddMethodType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.common.presentation.client.AdornedTargetAddMethodType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.common.presentation.client.LookupType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.common.presentation.client.PersistencePerspectiveItemType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.common.presentation.client.SupportedFieldType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.common.presentation.client.VisibilityEnum;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.dto.AdornedTargetCollectionMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.dto.AdornedTargetList;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.dto.BasicCollectionMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.dto.BasicFieldMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.dto.ClassMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.dto.ClassTree;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.dto.CollectionMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.dto.DynamicResultSet;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.dto.Entity;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.dto.FieldMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.dto.ForeignKey;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.dto.MapMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.dto.MapStructure;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.dto.Property;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.dto.SectionCrumb;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.dto.TabMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.DefaultListGridActions;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.ListGrid;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.ListGridAction;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.ListGridRecord;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.MediaField;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.RuleBuilderField;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.CodeField;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.ComboField;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.DefaultEntityFormActions;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.DynamicEntityFormInfo;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.EntityForm;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.Field;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import com.fasterxml.jackson.core.Version;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import com.fasterxml.jackson.databind.ObjectMapper;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import com.fasterxml.jackson.databind.module.SimpleModule;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import java.util.ArrayList;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import java.util.Arrays;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import java.util.Collections;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import java.util.Date;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import java.util.HashMap;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import java.util.List;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import java.util.Map;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import java.util.Set;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import javax.annotation.Resource;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import javax.persistence.ManyToOne;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import javax.persistence.OneToOne;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import javax.servlet.http.HttpServletRequest;
ac7344b9f94db20ca063a2ce918762ccabfddb79,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,recordField.setValue(p.getValue());
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import com.fasterxml.jackson.core.Version;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import com.fasterxml.jackson.databind.ObjectMapper;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import com.fasterxml.jackson.databind.module.SimpleModule;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import org.broadleafcommerce.common.presentation.client.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import org.broadleafcommerce.openadmin.dto.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import org.broadleafcommerce.openadmin.web.form.component.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import org.broadleafcommerce.openadmin.web.form.entity.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import javax.annotation.Resource;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import javax.persistence.ManyToOne;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import javax.persistence.OneToOne;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import javax.servlet.http.HttpServletRequest;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import java.text.DateFormatSymbols;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import java.text.SimpleDateFormat;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import java.util.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,// format date list grid cells
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"SimpleDateFormat formatter = new SimpleDateFormat(""MMM d, Y @ hh:mma"");"
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,DateFormatSymbols symbols = new DateFormatSymbols(Locale.getDefault());
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"symbols.setAmPmStrings(new String[] { ""am"", ""pm"" });"
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,formatter.setDateFormatSymbols(symbols);
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"if (headerField.getFieldType().equals(""DATE"")) {"
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,try {
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"Date date = new SimpleDateFormat(""yyyy.MM.dd HH:mm:ss"").parse(recordField.getValue());"
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,String newValue = formatter.format(date);
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,recordField.setValue(newValue);
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,} catch (Exception ex) {
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,recordField.setValue(p.getValue());
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,}
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,} else {
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.common.presentation.client.AddMethodType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.common.presentation.client.AdornedTargetAddMethodType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.common.presentation.client.LookupType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.common.presentation.client.PersistencePerspectiveItemType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.common.presentation.client.SupportedFieldType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.common.presentation.client.VisibilityEnum;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.dto.AdornedTargetCollectionMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.dto.AdornedTargetList;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.dto.BasicCollectionMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.dto.BasicFieldMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.dto.ClassMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.dto.ClassTree;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.dto.CollectionMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.dto.DynamicResultSet;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.dto.Entity;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.dto.FieldMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.dto.ForeignKey;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.dto.MapMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.dto.MapStructure;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.dto.Property;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.dto.SectionCrumb;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.dto.TabMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.DefaultListGridActions;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.ListGrid;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.ListGridAction;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.ListGridRecord;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.MediaField;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.RuleBuilderField;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.CodeField;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.ComboField;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.DefaultEntityFormActions;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.DynamicEntityFormInfo;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.EntityForm;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.Field;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import com.fasterxml.jackson.core.Version;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import com.fasterxml.jackson.databind.ObjectMapper;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import com.fasterxml.jackson.databind.module.SimpleModule;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import java.util.ArrayList;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import java.util.Arrays;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import java.util.Collections;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import java.util.Date;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import java.util.HashMap;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import java.util.List;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import java.util.Map;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import java.util.Set;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import javax.annotation.Resource;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import javax.persistence.ManyToOne;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import javax.persistence.OneToOne;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import javax.servlet.http.HttpServletRequest;
ac7344b9f94db20ca063a2ce918762ccabfddb79,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,recordField.setValue(p.getValue());
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import com.fasterxml.jackson.core.Version;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import com.fasterxml.jackson.databind.ObjectMapper;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import com.fasterxml.jackson.databind.module.SimpleModule;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import org.broadleafcommerce.common.presentation.client.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import org.broadleafcommerce.openadmin.dto.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import org.broadleafcommerce.openadmin.web.form.component.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import org.broadleafcommerce.openadmin.web.form.entity.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import javax.annotation.Resource;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import javax.persistence.ManyToOne;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import javax.persistence.OneToOne;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import javax.servlet.http.HttpServletRequest;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import java.text.DateFormatSymbols;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import java.text.SimpleDateFormat;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,import java.util.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,// format date list grid cells
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,"SimpleDateFormat formatter = new SimpleDateFormat(""MMM d, Y @ hh:mma"");"
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,DateFormatSymbols symbols = new DateFormatSymbols(Locale.getDefault());
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,"symbols.setAmPmStrings(new String[] { ""am"", ""pm"" });"
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,formatter.setDateFormatSymbols(symbols);
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,"if (headerField.getFieldType().equals(""DATE"")) {"
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,try {
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,"Date date = new SimpleDateFormat(""yyyy.MM.dd HH:mm:ss"").parse(recordField.getValue());"
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,String newValue = formatter.format(date);
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,recordField.setValue(newValue);
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,} catch (Exception ex) {
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,recordField.setValue(p.getValue());
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,}
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,} else {
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.common.presentation.client.AddMethodType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.common.presentation.client.AdornedTargetAddMethodType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.common.presentation.client.LookupType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.common.presentation.client.PersistencePerspectiveItemType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.common.presentation.client.SupportedFieldType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.common.presentation.client.VisibilityEnum;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.dto.AdornedTargetCollectionMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.dto.AdornedTargetList;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.dto.BasicCollectionMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.dto.BasicFieldMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.dto.ClassMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.dto.ClassTree;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.dto.CollectionMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.dto.DynamicResultSet;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.dto.Entity;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.dto.FieldMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.dto.ForeignKey;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.dto.MapMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.dto.MapStructure;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.dto.Property;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.dto.SectionCrumb;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.dto.TabMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.DefaultListGridActions;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.ListGrid;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.ListGridAction;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.ListGridRecord;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.MediaField;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.RuleBuilderField;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.CodeField;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.ComboField;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.DefaultEntityFormActions;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.DynamicEntityFormInfo;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.EntityForm;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.Field;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import com.fasterxml.jackson.core.Version;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import com.fasterxml.jackson.databind.ObjectMapper;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import com.fasterxml.jackson.databind.module.SimpleModule;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import java.util.ArrayList;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import java.util.Arrays;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import java.util.Collections;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import java.util.Date;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import java.util.HashMap;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import java.util.List;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import java.util.Map;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import java.util.Set;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import javax.annotation.Resource;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import javax.persistence.ManyToOne;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import javax.persistence.OneToOne;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,import javax.servlet.http.HttpServletRequest;
ac7344b9f94db20ca063a2ce918762ccabfddb79,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,recordField.setValue(p.getValue());
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,import com.fasterxml.jackson.core.Version;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,import com.fasterxml.jackson.databind.ObjectMapper;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,import com.fasterxml.jackson.databind.module.SimpleModule;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,import org.broadleafcommerce.common.presentation.client.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,import org.broadleafcommerce.openadmin.dto.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,import org.broadleafcommerce.openadmin.web.form.component.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,import org.broadleafcommerce.openadmin.web.form.entity.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,import javax.annotation.Resource;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,import javax.persistence.ManyToOne;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,import javax.persistence.OneToOne;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,import javax.servlet.http.HttpServletRequest;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,import java.text.DateFormatSymbols;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,import java.text.SimpleDateFormat;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,import java.util.*;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,// format date list grid cells
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,"SimpleDateFormat formatter = new SimpleDateFormat(""MMM d, Y @ hh:mma"");"
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,DateFormatSymbols symbols = new DateFormatSymbols(Locale.getDefault());
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,"symbols.setAmPmStrings(new String[] { ""am"", ""pm"" });"
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,formatter.setDateFormatSymbols(symbols);
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,"if (headerField.getFieldType().equals(""DATE"")) {"
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,try {
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,"Date date = new SimpleDateFormat(""yyyy.MM.dd HH:mm:ss"").parse(recordField.getValue());"
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,String newValue = formatter.format(date);
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,recordField.setValue(newValue);
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,} catch (Exception ex) {
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,recordField.setValue(p.getValue());
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,}
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,} else {
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.common.presentation.client.AddMethodType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.common.presentation.client.AdornedTargetAddMethodType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.common.presentation.client.LookupType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.common.presentation.client.PersistencePerspectiveItemType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.common.presentation.client.SupportedFieldType;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.common.presentation.client.VisibilityEnum;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.AdornedTargetCollectionMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.AdornedTargetList;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.BasicCollectionMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.BasicFieldMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.ClassMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.ClassTree;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.CollectionMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.DynamicResultSet;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.Entity;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.FieldMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.ForeignKey;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.MapMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.MapStructure;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.Property;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.SectionCrumb;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.dto.TabMetadata;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.DefaultListGridActions;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.ListGrid;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.ListGridAction;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.ListGridRecord;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.MediaField;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.web.form.component.RuleBuilderField;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.CodeField;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.ComboField;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.DefaultEntityFormActions;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.DynamicEntityFormInfo;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.EntityForm;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.Field;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import com.fasterxml.jackson.core.Version;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import com.fasterxml.jackson.databind.ObjectMapper;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import com.fasterxml.jackson.databind.module.SimpleModule;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import java.util.ArrayList;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import java.util.Arrays;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import java.util.Collections;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import java.util.Date;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import java.util.HashMap;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import java.util.List;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import java.util.Map;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import java.util.Set;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import javax.annotation.Resource;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import javax.persistence.ManyToOne;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import javax.persistence.OneToOne;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import javax.servlet.http.HttpServletRequest;
ac7344b9f94db20ca063a2ce918762ccabfddb79,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,recordField.setValue(p.getValue());
04581d2fb9db10f9644cbacfe91416fd141e1bff,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,tabName = tabName == null ? (firstTab == null || firstTab.getKey() == null ? DEFAULT_TAB_NAME : firstTab.getKey()) : tabName;
04581d2fb9db10f9644cbacfe91416fd141e1bff,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,tabOrder = tabOrder == null ? (firstTab == null || firstTab.getOrder() == null ? DEFAULT_TAB_ORDER : firstTab.getOrder()) : tabOrder;
04581d2fb9db10f9644cbacfe91416fd141e1bff,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,groupName = groupName == null ? (firstGroup == null || firstGroup.getKey() == null ? DEFAULT_GROUP_NAME : firstGroup.getKey()) : groupName;
04581d2fb9db10f9644cbacfe91416fd141e1bff,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,groupOrder = groupOrder == null ? (firstGroup == null || firstGroup.getOrder() == null ? DEFAULT_GROUP_ORDER : firstGroup.getOrder()) : groupOrder;
04581d2fb9db10f9644cbacfe91416fd141e1bff,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,if ((tabKey.equals(tabName)) ||
04581d2fb9db10f9644cbacfe91416fd141e1bff,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,(tabMetadataMap.get(tabKey).getTabName() != null
04581d2fb9db10f9644cbacfe91416fd141e1bff,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,&& tabMetadataMap.get(tabKey).getTabName().equals(tabName))) {
04581d2fb9db10f9644cbacfe91416fd141e1bff,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,if (tabMetadata.getTabName() != null) {
04581d2fb9db10f9644cbacfe91416fd141e1bff,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,newTab.setTitle(BLCMessageUtils.getMessage(tabMetadata.getTabName()));
04581d2fb9db10f9644cbacfe91416fd141e1bff,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,added,0,}
04581d2fb9db10f9644cbacfe91416fd141e1bff,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,deleted,1,tabName = tabName == null ? (firstTab == null ? DEFAULT_TAB_NAME : firstTab.getKey()) : tabName;
04581d2fb9db10f9644cbacfe91416fd141e1bff,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,deleted,1,tabOrder = tabOrder == null ? (firstTab == null ? DEFAULT_TAB_ORDER : firstTab.getOrder()) : tabOrder;
04581d2fb9db10f9644cbacfe91416fd141e1bff,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,deleted,1,groupName = groupName == null ? (firstGroup == null ? DEFAULT_GROUP_NAME : firstGroup.getKey()) : groupName;
04581d2fb9db10f9644cbacfe91416fd141e1bff,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,deleted,1,groupOrder = groupOrder == null ? (firstGroup == null ? DEFAULT_GROUP_ORDER : firstGroup.getOrder()) : groupOrder;
04581d2fb9db10f9644cbacfe91416fd141e1bff,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,deleted,1,if (tabKey.equals(tabName) || tabMetadataMap.get(tabKey).getTabName().equals(tabName)) {
04581d2fb9db10f9644cbacfe91416fd141e1bff,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,deleted,1,newTab.setTitle(BLCMessageUtils.getMessage(tabMetadata.getTabName()));
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,import com.google.common.base.Strings;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,import org.broadleafcommerce.common.presentation.*;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,import org.hibernate.annotations.*;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,import javax.persistence.*;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,import java.io.Serializable;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,import java.util.ArrayList;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,import java.util.List;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"group = GroupName.Ranges,"
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"order = 6000,"
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"@AdminPresentation(friendlyName = ""SearchFacetImpl_multiselect"", order = 5000,"
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,group = GroupName.Ranges)
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,"defaultValue = ""false"")"
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentation;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentationAdornedTargetCollection;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentationCollection;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentationToOneLookup;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.broadleafcommerce.common.presentation.RequiredOverride;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.hibernate.annotations.CacheConcurrencyStrategy;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.hibernate.annotations.Cascade;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import org.hibernate.annotations.GenericGenerator;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import com.google.common.base.Strings;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import java.io.Serializable;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import java.util.ArrayList;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import java.util.List;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import javax.persistence.Column;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import javax.persistence.GeneratedValue;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import javax.persistence.Id;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import javax.persistence.Inheritance;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import javax.persistence.InheritanceType;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import javax.persistence.JoinColumn;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import javax.persistence.ManyToOne;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,import javax.persistence.OneToMany;
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"group = GroupName.General,"
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"order = 5000,"
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"groupOrder = 1,"
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"tab = ""SearchFacetImpl_Advanced_tab"","
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"tabOrder = 2000,"
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"@AdminPresentation(friendlyName = ""SearchFacetImpl_multiselect"", order = 6000,"
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,group = GroupName.General)
5d401893c9196efdd4c4610339d43195360a2b15,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,tabOrder = 3000)
746113869d28fb67ed402ee3a0f9a79a9bc615e0,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,"// (i.e. where the transaction is meant to be charged, UNCONFIRMED -> AUTHORIZE or UNCONFIRMED -> AUTHORIZE_AND_CAPTURE)"
746113869d28fb67ed402ee3a0f9a79a9bc615e0,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,// AND where the order does not contain multiple final payments. (e.g. multiple credit cards)
746113869d28fb67ed402ee3a0f9a79a9bc615e0,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,"// - If in a REFUND flow or paying with multiple final payments,"
746113869d28fb67ed402ee3a0f9a79a9bc615e0,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,//   you cannot use the total after applied payments convenience method.
746113869d28fb67ed402ee3a0f9a79a9bc615e0,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,// - The amounts to be sent to the gateway are the amounts passed in.
746113869d28fb67ed402ee3a0f9a79a9bc615e0,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,if (PaymentTransactionType.UNCONFIRMED.equals(paymentTransaction.getType()) &&
746113869d28fb67ed402ee3a0f9a79a9bc615e0,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,!orderContainsMultipleFinalPayments(order)) {
746113869d28fb67ed402ee3a0f9a79a9bc615e0,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,/**
746113869d28fb67ed402ee3a0f9a79a9bc615e0,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,* determine whether or not this order contains multiple final payments.
746113869d28fb67ed402ee3a0f9a79a9bc615e0,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,* (e.g. paying with multiple credit cards)
746113869d28fb67ed402ee3a0f9a79a9bc615e0,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,* @param order
746113869d28fb67ed402ee3a0f9a79a9bc615e0,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,* @return
746113869d28fb67ed402ee3a0f9a79a9bc615e0,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,*/
746113869d28fb67ed402ee3a0f9a79a9bc615e0,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,protected boolean orderContainsMultipleFinalPayments(Order order) {
746113869d28fb67ed402ee3a0f9a79a9bc615e0,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,int finalPaymentCount = 0;
746113869d28fb67ed402ee3a0f9a79a9bc615e0,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,for (OrderPayment payment : order.getPayments()) {
746113869d28fb67ed402ee3a0f9a79a9bc615e0,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,if (payment.isActive() && payment.isFinalPayment()) {
746113869d28fb67ed402ee3a0f9a79a9bc615e0,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,finalPaymentCount++;
746113869d28fb67ed402ee3a0f9a79a9bc615e0,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,}
746113869d28fb67ed402ee3a0f9a79a9bc615e0,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,return finalPaymentCount > 1;
746113869d28fb67ed402ee3a0f9a79a9bc615e0,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,if (PaymentTransactionType.UNCONFIRMED.equals(paymentTransaction.getType())) {
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import com.fasterxml.jackson.databind.ObjectMapper;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import org.broadleafcommerce.common.extension.ExtensionResultStatusType;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import org.broadleafcommerce.openadmin.dto.*;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import org.broadleafcommerce.openadmin.web.form.entity.*;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import org.springframework.web.bind.annotation.*;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import javax.annotation.Resource;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import javax.servlet.http.HttpServletRequest;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,import javax.servlet.http.HttpServletResponse;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,} else if (md instanceof MapMetadata) {
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,"ExtensionResultStatusType result = extensionManager.getProxy().modifyModelForAddCollectionType(request,response,model,sectionKey,id,requestParams,(MapMetadata) md);"
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,if (result.equals(ExtensionResultStatusType.HANDLED)) {
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,"model.addAttribute(""entityId"", id);"
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,"model.addAttribute(""sectionKey"", sectionKey);"
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,"model.addAttribute(""collectionField"", collectionField);"
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,"return ""modules/modalContainer"";"
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,}
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.AdornedTargetCollectionMetadata;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.AdornedTargetList;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.BasicCollectionMetadata;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.BasicFieldMetadata;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.ClassMetadata;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.ClassTree;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.CollectionMetadata;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.DynamicResultSet;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.Entity;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.FieldMetadata;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.FilterAndSortCriteria;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.MapMetadata;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.Property;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.SectionCrumb;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.dto.TabMetadata;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.DefaultEntityFormActions;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.DefaultMainActions;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.EntityForm;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.EntityFormAction;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.Field;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.springframework.web.bind.annotation.InitBinder;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.springframework.web.bind.annotation.ModelAttribute;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.springframework.web.bind.annotation.PathVariable;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.springframework.web.bind.annotation.RequestMapping;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.springframework.web.bind.annotation.RequestMethod;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.springframework.web.bind.annotation.RequestParam;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import org.springframework.web.bind.annotation.ResponseBody;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import com.fasterxml.jackson.databind.ObjectMapper;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import javax.annotation.Resource;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import javax.servlet.http.HttpServletRequest;
758f221ae645a54264e2fcb6edaa72e8a6e2db9b,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,import javax.servlet.http.HttpServletResponse;
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,/*
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* #%L
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* BroadleafCommerce Framework
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* %%
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* Copyright (C) 2009 - 2015 Broadleaf Commerce
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* Licensed under the Apache License, Version 2.0 (the ""License"");"
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* you may not use this file except in compliance with the License.
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* You may obtain a copy of the License at
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,*
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,*       http://www.apache.org/licenses/LICENSE-2.0
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* Unless required by applicable law or agreed to in writing, software"
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* distributed under the License is distributed on an ""AS IS"" BASIS,"
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* See the License for the specific language governing permissions and
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* limitations under the License.
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* #L%
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,*/
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,/**
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,package org.broadleafcommerce.core.search.service.solr.index;
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.apache.commons.logging.Log;
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.apache.commons.logging.LogFactory;
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.apache.solr.client.solrj.SolrClient;
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.broadleafcommerce.common.site.domain.Site;
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.broadleafcommerce.common.web.BroadleafRequestContext;
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.broadleafcommerce.core.search.service.solr.SolrContext;
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import java.util.HashSet;
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,*  Builds an index for the current {@link Site} from {@link BroadleafRequestContext#getNonPersistentSite()}. This builds
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,*  the index directly on the primary {@link SolrClient} (obtained via {@link SolrContext#getServer()}) so this operation
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,*  should only be done once to avoid duplicate documents in the index.
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* @author Phillip Verheyden (phillipuniverse)
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public abstract class SiteSolrIndexOperation implements SolrIndexOperation {
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,private static final Log LOG = LogFactory.getLog(SiteSolrIndexOperation.class);
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,protected SolrIndexService indexService;
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,//Holds site ids that are currently being indexed
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,protected HashSet<Long> currentReindexProcesses;
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,protected boolean errorOnConcurrentReindex;
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public SiteSolrIndexOperation(SolrIndexService indexService, HashSet<Long> currentReindexProcesses, boolean errorOnConcurrentReindex) {"
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,this.indexService = indexService;
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,this.currentReindexProcesses = currentReindexProcesses;
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,this.errorOnConcurrentReindex = errorOnConcurrentReindex;
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,}
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,@Override
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public boolean obtainLock() {
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,synchronized (currentReindexProcesses) {
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,Long siteId = null;
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,BroadleafRequestContext brc = BroadleafRequestContext.getBroadleafRequestContext();
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (brc != null && brc.getNonPersistentSite() != null) {
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,siteId = brc.getNonPersistentSite().getId();
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"// even if siteId is null (no active site) then this should be ok, still locking"
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (currentReindexProcesses.add(siteId)) {
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"// successfully indicated that I'm now indexing the current site, all good"
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,return true;
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,} else if (errorOnConcurrentReindex) {
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"throw new IllegalStateException(""More than one thread attempting to concurrently create an initial Solr index for site ID """
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,+ siteId);
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,} else {
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"LOG.warn(""There is more than one thread attempting to concurrently create an initial Solr index for site ID """
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,+ siteId
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"+ "". Failing additional threads gracefully. Check your configuration."");"
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,return false;
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public void releaseLock() {
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,currentReindexProcesses.remove(siteId);
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public SolrClient getSolrServerForIndexing() {
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,return SolrContext.getServer();
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public void beforeCountIndexables() {
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,// By default we want to do nothing here
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public void afterCountIndexables() {
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public void beforeReadIndexables() {
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public void afterReadIndexables() {
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public void beforeBuildPage() {
542d8faf10be8fd415109416ad97d1d90d8fcbb1,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public void afterBuildPage() {
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import org.hibernate.annotations.*;
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import javax.persistence.*;
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import java.io.Serializable;
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import java.util.ArrayList;
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import java.util.List;
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"public class IndexFieldImpl implements IndexField, Serializable, IndexFieldAdminPresentation {"
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"@AdminPresentation(friendlyName = ""IndexFieldImpl_searchable"","
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"defaultValue = ""false"","
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"prominent = true,"
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"group = GroupName.General,"
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"tooltip = ""IndexFieldImpl_searchable_tooltip"")"
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"@AdminPresentation(friendlyName = ""IndexFieldImpl_field"", order = 1000, group = GroupName.General,"
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"@AdminPresentationToOneLookup(lookupDisplayProperty = ""friendlyName"", customCriteria = { ""fieldImplOnly"" })"
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import org.hibernate.annotations.BatchSize;
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import org.hibernate.annotations.CacheConcurrencyStrategy;
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import org.hibernate.annotations.GenericGenerator;
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import java.io.Serializable;
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import java.util.ArrayList;
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import java.util.List;
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import javax.persistence.Column;
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import javax.persistence.GeneratedValue;
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import javax.persistence.Id;
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import javax.persistence.Inheritance;
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import javax.persistence.InheritanceType;
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import javax.persistence.JoinColumn;
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import javax.persistence.ManyToOne;
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import javax.persistence.OneToMany;
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"public class IndexFieldImpl implements IndexField, Serializable {"
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"@AdminPresentation(friendlyName = ""IndexFieldImpl_searchable"", defaultValue = ""true"", prominent = true, tooltip = ""IndexFieldImpl_searchable_tooltip"")"
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"@AdminPresentation(friendlyName = ""IndexFieldImpl_field"", order = 1000, group = ""IndexFieldImpl_description"","
5388acd7a5b15c82d0dbecafbc5bf22149f4122a,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"@AdminPresentationToOneLookup(lookupDisplayProperty = ""friendlyName"")"
f0e247142979f35069eced986c64a3e095195863,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,"public Object getPreviousClone(Class<?> instanceClass, Long originalId) {"
f0e247142979f35069eced986c64a3e095195863,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,Object previousClone;
f0e247142979f35069eced986c64a3e095195863,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,"if (currentEquivalentMap.inverse().containsKey(instanceClass.getName() + ""_"" + originalId)) {"
f0e247142979f35069eced986c64a3e095195863,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,"previousClone = currentCloneMap.get(currentEquivalentMap.inverse().get(instanceClass.getName() + ""_"" + originalId));"
f0e247142979f35069eced986c64a3e095195863,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,} else {
f0e247142979f35069eced986c64a3e095195863,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,"previousClone = getClonedVersion(instanceClass, originalId);"
f0e247142979f35069eced986c64a3e095195863,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,}
f0e247142979f35069eced986c64a3e095195863,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,added,0,return previousClone;
f0e247142979f35069eced986c64a3e095195863,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,"protected Object getPreviousClone(Class<?> instanceClass, Long originalId) {"
f0e247142979f35069eced986c64a3e095195863,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,Object previousClone;
f0e247142979f35069eced986c64a3e095195863,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,"if (currentEquivalentMap.inverse().containsKey(instanceClass.getName() + ""_"" + originalId)) {"
f0e247142979f35069eced986c64a3e095195863,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,"previousClone = currentCloneMap.get(currentEquivalentMap.inverse().get(instanceClass.getName() + ""_"" + originalId));"
f0e247142979f35069eced986c64a3e095195863,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,} else {
f0e247142979f35069eced986c64a3e095195863,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,"previousClone = getClonedVersion(instanceClass, originalId);"
f0e247142979f35069eced986c64a3e095195863,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,}
f0e247142979f35069eced986c64a3e095195863,dcb140d2ec70bd26396bf8b773ea5e6dc3d50cc2,deleted,1,return previousClone;
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,import org.apache.commons.collections.CollectionUtils;
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,import java.lang.reflect.Field;
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,import java.util.List;
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (genericAnnot != null && genericAnnot.strategy().equals(IdOverrideTableGenerator.class.getName())) {
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,// Default values are set on startup in IdOverrideTableGenerator so that every annotation does not have
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"// to redefine them. If they aren't defined in the annotation, glean them from the defaults"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (StringUtils.isBlank(tableName)) {
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,tableName = IdOverrideTableGenerator.DEFAULT_TABLE_NAME;
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,}
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (StringUtils.isBlank(segmentColumnName)) {
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,segmentColumnName = IdOverrideTableGenerator.DEFAULT_SEGMENT_COLUMN_NAME;
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (StringUtils.isBlank(valueColumnName)) {
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,valueColumnName = IdOverrideTableGenerator.DEFAULT_VALUE_COLUMN_NAME;
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,Long maxSequenceId = 0l;
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,boolean sequenceEntryExists = false;
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (CollectionUtils.isNotEmpty(results2) && results2.get(0) != null) {
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,maxSequenceId = ((Number) results2.get(0)).longValue();
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,sequenceEntryExists = true;
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"LOG.info(""Detecting id sequence state between "" + mappedClass.getName() + "" and "" + segmentValue + "" in "" + tableName);"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,StringBuilder sb = new StringBuilder();
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"sb.append(""select max("");"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,sb.append(idField.getName());
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"sb.append("") from "");"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,sb.append(mappedClass.getName());
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"sb.append("" entity"");"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,List results = em.createQuery(sb.toString()).getResultList();
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (CollectionUtils.isNotEmpty(results) && results.get(0) != null) {
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,Long maxEntityId = (Long) results.get(0);
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (maxEntityId > maxSequenceId) {
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"LOG.error(String.format(""The sequence value for %s in %s was found as %d (or an entry did not exist) but the actual max sequence in"""
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"+ "" %s's table was found as %d"", segmentValue, tableName, maxSequenceId, mappedClass.getName(), maxEntityId));"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (automaticallyCorrectInconsistencies) {
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,long newMaxId = maxEntityId + 10;
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (sequenceEntryExists) {
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"String log = String.format(""Correcting sequences for entity %s.  Updating the sequence value"""
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"+ "" to %d"","
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"mappedClass.getName(), newMaxId);"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,LOG.warn(log);
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,StringBuilder updateQuery = new StringBuilder();
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"updateQuery.append(""update "");"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,updateQuery.append(tableName);
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"updateQuery.append("" set "");"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,updateQuery.append(valueColumnName);
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"updateQuery.append("" = "");"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,updateQuery.append(String.valueOf(newMaxId));
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"updateQuery.append("" where "");"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,updateQuery.append(segmentColumnName);
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"updateQuery.append("" = '"");"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,updateQuery.append(segmentValue);
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"updateQuery.append(""'"");"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,int response = em.createNativeQuery(updateQuery.toString()).executeUpdate();
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"String log = String.format(""Correcting sequences for entity %s. Did not find an entry in"""
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"+ "" %s, inserting the new sequence value as %d"","
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"mappedClass.getName(), tableName, newMaxId);"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,StringBuilder insertQuery = new StringBuilder();
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"insertQuery.append(""insert into "");"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"if (!tableName.contains(""."") && !StringUtils.isEmpty(defaultSchemaSequenceGenerator)) {"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,sb2.append(defaultSchemaSequenceGenerator);
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"sb2.append(""."");"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,insertQuery.append(tableName);
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"insertQuery.append("" ("" + segmentColumnName + "","" + valueColumnName + "")"");"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"insertQuery.append(""values ('"" + segmentValue + ""','"" + String.valueOf(newMaxId) + ""')"");"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,int response = em.createNativeQuery(insertQuery.toString()).executeUpdate();
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (response <= 0) {
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"throw new RuntimeException(""Unable to update "" + tableName + "" with the sequence generator id for "" + segmentValue);"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,} else {
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"String reason = ""A data inconsistency has been detected between the "" + tableName + "" table and one or more entity tables for which it manages current max primary key values.\n"" +"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"""The inconsistency was detected between the managed class ("" + mappedClass.getName() + "") and the identifier ("" + segmentValue + "") in "" + tableName + "". Broadleaf\n"" +"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"""has stopped startup of the application in order to allow you to resolve the issue and avoid possible data corruption. If you wish to disable this detection, you may\n"" +"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"""set the 'detect.sequence.generator.inconsistencies' property to false in your application's common.properties or common-shared.properties. If you would like for this component\n"" +"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"""to autocorrect these problems by setting the sequence generator value to a value greater than the max entity id, then set the 'auto.correct.sequence.generator.inconsistencies'\n"" +"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"""property to true in your application's common.properties or common-shared.properties. If you would like to provide a default schema to be used to qualify table names used in the\n"" +"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"""queries for this detection, set the 'default.schema.sequence.generator' property in your application's common.properties or common-shared.properties. Also, if you are upgrading\n"" +"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"""from 1.6 or below, please refer to http://docs.broadleafcommerce.org/current/1.6-to-2.0-Migration.html for important information regarding migrating your SEQUENCE_GENERATOR table."";"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"LOG.error(""Broadleaf Commerce failed to start"", new RuntimeException(reason));"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,added,0,System.exit(1);
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,import java.lang.reflect.Field;
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,import java.util.List;
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"if (genericAnnot != null && genericAnnot.strategy().equals(""org.broadleafcommerce.common.persistence.IdOverrideTableGenerator"")) {"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (results2 != null && !results2.isEmpty() && results2.get(0) != null) {
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,Long maxSequenceId = ((Number) results2.get(0)).longValue();
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"LOG.info(""Detecting id sequence state between "" + mappedClass.getName() + "" and "" + segmentValue + "" in "" + tableName);"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,StringBuilder sb = new StringBuilder();
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb.append(""select max("");"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,sb.append(idField.getName());
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb.append("") from "");"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,sb.append(mappedClass.getName());
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb.append("" entity"");"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,List results = em.createQuery(sb.toString()).getResultList();
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (results != null && !results.isEmpty() && results.get(0) != null) {
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,Long maxEntityId = (Long) results.get(0);
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (maxEntityId > maxSequenceId) {
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (automaticallyCorrectInconsistencies) {
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,StringBuilder sb3 = new StringBuilder();
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb3.append(""update "");"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,sb3.append(tableName);
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb3.append("" set "");"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,sb3.append(valueColumnName);
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb3.append("" = "");"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,sb3.append(String.valueOf(maxEntityId + 10));
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb3.append("" where "");"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,sb3.append(segmentColumnName);
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb3.append("" = '"");"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,sb3.append(segmentValue);
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb3.append(""'"");"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,int response = em.createNativeQuery(sb3.toString()).executeUpdate();
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"String reason = ""A data inconsistency has been detected between the "" + tableName + "" table and one or more entity tables for which it manages current max primary key values.\n"" +"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"""The inconsistency was detected between the managed class ("" + mappedClass.getName() + "") and the identifier ("" + segmentValue + "") in "" + tableName + "". Broadleaf\n"" +"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"""has stopped startup of the application in order to allow you to resolve the issue and avoid possible data corruption. If you wish to disable this detection, you may\n"" +"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"""set the 'detect.sequence.generator.inconsistencies' property to false in your application's common.properties or common-shared.properties. If you would like for this component\n"" +"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"""to autocorrect these problems by setting the sequence generator value to a value greater than the max entity id, then set the 'auto.correct.sequence.generator.inconsistencies'\n"" +"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"""property to true in your application's common.properties or common-shared.properties. If you would like to provide a default schema to be used to qualify table names used in the\n"" +"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"""queries for this detection, set the 'default.schema.sequence.generator' property in your application's common.properties or common-shared.properties. Also, if you are upgrading\n"" +"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"""from 1.6 or below, please refer to http://docs.broadleafcommerce.org/current/1.6-to-2.0-Migration.html for important information regarding migrating your SEQUENCE_GENERATOR table."";"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"LOG.error(""Broadleaf Commerce failed to start"", new RuntimeException(reason));"
b47fd96fcaacd7e4942d1e882a4c1f5c1eeedb44,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,System.exit(1);
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,import org.apache.commons.collections4.CollectionUtils;
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,import java.util.ArrayList;
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,import java.util.Arrays;
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,import java.util.Collections;
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,import java.util.List;
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"public static final FieldEntity PRODUCT = new FieldEntity(""PRODUCT"", ""Product"");"
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"public static final FieldEntity SKU = new FieldEntity(""SKU"", ""Sku"");"
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"public static final FieldEntity CUSTOMER = new FieldEntity(""CUSTOMER"", ""Customer"");"
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"public static final FieldEntity ORDER = new FieldEntity(""ORDER"", ""Order"");"
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"public static final FieldEntity ORDERITEM = new FieldEntity(""ORDER_ITEM"", ""Order Item"");"
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"public static final FieldEntity OFFER = new FieldEntity(""OFFER"", ""Offer"");"
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,protected List<String> additionalLookupTypes = new ArrayList<>();;
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,"public FieldEntity(final String type, final String friendlyType) {"
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,@Override
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,public void addAditionalLookupType(String additionalLookupType) {
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,if (additionalLookupTypes == null) {
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,additionalLookupTypes = new ArrayList<>();
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,}
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,additionalLookupTypes.add(additionalLookupType);
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,public List<String> getAdditionalLookupTypes() {
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,return Collections.unmodifiableList(additionalLookupTypes);
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,public List<String> getAllLookupTypes() {
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,if (CollectionUtils.isNotEmpty(getAdditionalLookupTypes())) {
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,List<String> result = new ArrayList<>(getAdditionalLookupTypes());
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,result.add(getType());
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,return Collections.unmodifiableList(result);
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,} else {
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,added,0,return Arrays.asList(getType());
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,"public static final FieldEntity PRODUCT = new FieldEntity(""PRODUCT"", ""Product"", false);"
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,"public static final FieldEntity SKU = new FieldEntity(""SKU"", ""Sku"", false);"
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,"public static final FieldEntity CUSTOMER = new FieldEntity(""CUSTOMER"", ""Customer"", false);"
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,"public static final FieldEntity ORDER = new FieldEntity(""ORDER"", ""Order"", false);"
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,"public static final FieldEntity ORDERITEM = new FieldEntity(""ORDER_ITEM"", ""Order Item"", false);"
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,"public static final FieldEntity OFFER = new FieldEntity(""OFFER"", ""Offer"", false);"
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,private Boolean isCustomFieldEntity;
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,"public FieldEntity(final String type, final String friendlyType, final Boolean isCustomFieldEntity) {"
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,this.isCustomFieldEntity = isCustomFieldEntity;
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,public Boolean getIsCustomFieldEntity() {
8a009411d0585b87d68e70373b016483f4d00c14,96dce1e088f5d34b63f2973619320f7bc828311b,deleted,1,return isCustomFieldEntity;
c4400115b1432f3e45edd47e926f4b6b3957c06f,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,"LOG.info(""Excluding dynamic field "" + dynamicField.getKey() + "" as there is already an occurrence in"" +"
c4400115b1432f3e45edd47e926f4b6b3957c06f,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,"Map<String, Field> fields = getFields();"
c4400115b1432f3e45edd47e926f4b6b3957c06f,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,return fields.get(fieldName);
c4400115b1432f3e45edd47e926f4b6b3957c06f,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"LOG.info(""Excluding dynamic field "" + dynamicField.getKey() + "" as there is already an occurrance in"" +"
c4400115b1432f3e45edd47e926f4b6b3957c06f,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,for (Tab tab : tabs) {
c4400115b1432f3e45edd47e926f4b6b3957c06f,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,for (FieldGroup fieldGroup : tab.getFieldGroups()) {
c4400115b1432f3e45edd47e926f4b6b3957c06f,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,for (Field field : fieldGroup.getFields()) {
c4400115b1432f3e45edd47e926f4b6b3957c06f,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,if (field.getName().equals(fieldName)) {
c4400115b1432f3e45edd47e926f4b6b3957c06f,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,return field;
c4400115b1432f3e45edd47e926f4b6b3957c06f,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,}
c4400115b1432f3e45edd47e926f4b6b3957c06f,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,return fields == null ? null : fields.get(fieldName);
9010e15a2c019812fa89c8c23035cc3a38e00e0f,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,import java.lang.reflect.Field;
9010e15a2c019812fa89c8c23035cc3a38e00e0f,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,import java.util.ArrayList;
9010e15a2c019812fa89c8c23035cc3a38e00e0f,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,import java.util.List;
9010e15a2c019812fa89c8c23035cc3a38e00e0f,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,import java.util.Map;
9010e15a2c019812fa89c8c23035cc3a38e00e0f,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"// if this is a Pre-Add, skip the rest of the method"
9010e15a2c019812fa89c8c23035cc3a38e00e0f,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,if (entity.isPreAdd()) {
9010e15a2c019812fa89c8c23035cc3a38e00e0f,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"return helper.getRecord(adminProperties, adminInstance, null, null);"
9010e15a2c019812fa89c8c23035cc3a38e00e0f,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,}
9010e15a2c019812fa89c8c23035cc3a38e00e0f,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,import org.hibernate.ejb.QueryHints;
9010e15a2c019812fa89c8c23035cc3a38e00e0f,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,import java.lang.reflect.Field;
9010e15a2c019812fa89c8c23035cc3a38e00e0f,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,import java.util.ArrayList;
9010e15a2c019812fa89c8c23035cc3a38e00e0f,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,import java.util.List;
9010e15a2c019812fa89c8c23035cc3a38e00e0f,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,import java.util.Map;
9010e15a2c019812fa89c8c23035cc3a38e00e0f,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,import javax.persistence.criteria.Subquery;
7092674e61e6697ea8ebdfd6ff606d4d5666e13a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (reason == null && offer != null) {
7092674e61e6697ea8ebdfd6ff606d4d5666e13a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,} else {
7092674e61e6697ea8ebdfd6ff606d4d5666e13a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.reason = reason;
7092674e61e6697ea8ebdfd6ff606d4d5666e13a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.offerName = offerName;
7092674e61e6697ea8ebdfd6ff606d4d5666e13a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"cloned.init(orderItemPriceDetail, offer, reason);"
7092674e61e6697ea8ebdfd6ff606d4d5666e13a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (reason == null) {
7092674e61e6697ea8ebdfd6ff606d4d5666e13a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.reason = reason;
7092674e61e6697ea8ebdfd6ff606d4d5666e13a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.offerName = offer.getName();
7092674e61e6697ea8ebdfd6ff606d4d5666e13a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// dont clone
7092674e61e6697ea8ebdfd6ff606d4d5666e13a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,cloned.setOrderItemPriceDetail(orderItemPriceDetail);
7092674e61e6697ea8ebdfd6ff606d4d5666e13a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,cloned.setReason(reason);
7092674e61e6697ea8ebdfd6ff606d4d5666e13a,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,if (reason == null && offer != null) {
7092674e61e6697ea8ebdfd6ff606d4d5666e13a,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,} else {
7092674e61e6697ea8ebdfd6ff606d4d5666e13a,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,this.reason = reason;
7092674e61e6697ea8ebdfd6ff606d4d5666e13a,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,this.offerName = offerName;
7092674e61e6697ea8ebdfd6ff606d4d5666e13a,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,"cloned.init(orderItemPriceDetail, offer, reason);"
7092674e61e6697ea8ebdfd6ff606d4d5666e13a,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,if (reason == null) {
7092674e61e6697ea8ebdfd6ff606d4d5666e13a,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,this.reason = reason;
7092674e61e6697ea8ebdfd6ff606d4d5666e13a,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,this.offerName = offer.getName();
7092674e61e6697ea8ebdfd6ff606d4d5666e13a,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,// dont clone
7092674e61e6697ea8ebdfd6ff606d4d5666e13a,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,cloned.setOrderItemPriceDetail(orderItemPriceDetail);
7092674e61e6697ea8ebdfd6ff606d4d5666e13a,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,cloned.setReason(reason);
cc9a61768bd6eb6018ab4e162a52a0658754b1c7,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,if (containingGroup != null && containingGroup.getGroupItems().isEmpty()) {
cc9a61768bd6eb6018ab4e162a52a0658754b1c7,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,} else if (containingTab != null && containingTab.getListGrids().isEmpty() && containingTab.getFields().isEmpty()) {
cc9a61768bd6eb6018ab4e162a52a0658754b1c7,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,fieldGroup.addListGrid(listGrid);
cc9a61768bd6eb6018ab4e162a52a0658754b1c7,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,if (containingGroup != null && containingGroup.getListGrids().size() == 0 && containingGroup.getFields().size() == 0) {
cc9a61768bd6eb6018ab4e162a52a0658754b1c7,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,} else if (containingTab != null && containingTab.getListGrids().size() == 0 && containingTab.getFields().size() == 0) {
cc9a61768bd6eb6018ab4e162a52a0658754b1c7,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,fieldGroup.getListGrids().add(listGrid);
a0eb66f72d56e001ec659dd7d0b842d3c28544cc,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,added,0,"public static final String General = ""General"";"
a0eb66f72d56e001ec659dd7d0b842d3c28544cc,3e1d2e3c2b9043954ccdfd1baa15e2b97b4c5fa1,deleted,1,"public static final String General = ""General_Tab"";"
a0eb66f72d56e001ec659dd7d0b842d3c28544cc,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"public static final String General = ""General"";"
a0eb66f72d56e001ec659dd7d0b842d3c28544cc,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"public static final String General = ""OfferImpl_General_Tab"";"
f38e3f554539eb0cb65d6ef7403e3778c01acf4d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,if (p != null){
f38e3f554539eb0cb65d6ef7403e3778c01acf4d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,BasicFieldMetadata md = (BasicFieldMetadata) p.getMetadata();
f38e3f554539eb0cb65d6ef7403e3778c01acf4d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"Field hf = createHeaderField(p, md);"
f38e3f554539eb0cb65d6ef7403e3778c01acf4d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,headerFields.add(hf);
f38e3f554539eb0cb65d6ef7403e3778c01acf4d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"wrapper.getFields().add(constructFieldDTOFromFieldData(hf, md));"
f38e3f554539eb0cb65d6ef7403e3778c01acf4d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,}
f38e3f554539eb0cb65d6ef7403e3778c01acf4d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,BasicFieldMetadata md = (BasicFieldMetadata) p.getMetadata();
f38e3f554539eb0cb65d6ef7403e3778c01acf4d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"Field hf = createHeaderField(p, md);"
f38e3f554539eb0cb65d6ef7403e3778c01acf4d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,headerFields.add(hf);
f38e3f554539eb0cb65d6ef7403e3778c01acf4d,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"wrapper.getFields().add(constructFieldDTOFromFieldData(hf, md));"
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,if (IndexField.class.getName().equals(ceilingEntityFullyQualifiedClassname) ||
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,IndexFieldTypeImpl.class.getName().equals(ceilingEntityFullyQualifiedClassname)) {
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,return true;
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,}
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,return false;
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,String ceilingEntityFullyQualifiedClassname = persistencePackage.getCeilingEntityFullyQualifiedClassname();
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,return IndexField.class.getName().equals(ceilingEntityFullyQualifiedClassname);
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"return getIndexFieldEntity(persistencePackage, dynamicEntityDao, helper, entity, adminProperties, adminInstance);"
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"protected Entity getIndexFieldEntity(PersistencePackage persistencePackage, DynamicEntityDao dynamicEntityDao, RecordHelper helper, Entity entity, Map<String, FieldMetadata> adminProperties, IndexField adminInstance) throws ServiceException {"
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,if(entity.getType()[0].equalsIgnoreCase(IndexFieldImpl.class.getName())){
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,try {
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,PersistencePerspective persistencePerspective = persistencePackage.getPersistencePerspective();
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,IndexField adminInstance = (IndexField) Class.forName(entity.getType()[0]).newInstance();
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"Map<String, FieldMetadata> adminProperties = helper.getSimpleMergedProperties(IndexField.class.getName(), persistencePerspective);"
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,} catch (Exception e) {
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"throw new ServiceException(""Unable to perform add for entity: "" + IndexField.class.getName(), e);"
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,} else {
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,IndexFieldType adminInstance = (IndexFieldType) Class.forName(entity.getType()[0]).newInstance();
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"Map<String, FieldMetadata> adminProperties = helper.getSimpleMergedProperties(IndexFieldType.class.getName(), persistencePerspective);"
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,IndexField field;
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"Property idProperty = entity.findProperty(""indexField"");"
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"Property typeProperty = entity.findProperty(""fieldType"");"
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,Long fieldId = Long.parseLong(idProperty.getValue());
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"field = (IndexField)dynamicEntityDao.find(IndexFieldImpl.class,fieldId);"
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,adminInstance.setIndexField(field);
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,adminInstance.setFieldType(FieldType.getInstance(typeProperty.getValue()));
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,adminInstance = dynamicEntityDao.merge(adminInstance);
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"return helper.getRecord(adminProperties,adminInstance,null,null);"
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"throw new ServiceException(""Unable to perform add for entity: "" + entity.getType()[0], e);"
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,return IndexField.class.getName().equals(ceilingEntityFullyQualifiedClassname);
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,return canHandleAdd(persistencePackage);
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"return getEntity(persistencePackage, dynamicEntityDao, helper, entity, adminProperties, adminInstance);"
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"protected Entity getEntity(PersistencePackage persistencePackage, DynamicEntityDao dynamicEntityDao, RecordHelper helper, Entity entity, Map<String, FieldMetadata> adminProperties, IndexField adminInstance) throws ServiceException {"
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,try {
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,PersistencePerspective persistencePerspective = persistencePackage.getPersistencePerspective();
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,IndexField adminInstance = (IndexField) Class.forName(entity.getType()[0]).newInstance();
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"Map<String, FieldMetadata> adminProperties = helper.getSimpleMergedProperties(IndexField.class.getName(), persistencePerspective);"
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,} catch (Exception e) {
db542a0d9d3f645ec614495d0ec32cfb8b800b47,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"throw new ServiceException(""Unable to perform add for entity: "" + IndexField.class.getName(), e);"
3294c81369fb0eb619bc0875b5e505b12f789fe0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String CUSTOM_CRITERIA = ""criteria"";"
3294c81369fb0eb619bc0875b5e505b12f789fe0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,.withMaxIndex(getMaxIndex(requestParams))
3294c81369fb0eb619bc0875b5e505b12f789fe0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,.withCustomCriteria(getCustomCriteria(requestParams));
3294c81369fb0eb619bc0875b5e505b12f789fe0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,/**
3294c81369fb0eb619bc0875b5e505b12f789fe0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,* Obtains the requested criteria parameter
3294c81369fb0eb619bc0875b5e505b12f789fe0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,*
3294c81369fb0eb619bc0875b5e505b12f789fe0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,* @param requestParams
3294c81369fb0eb619bc0875b5e505b12f789fe0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,* @return
3294c81369fb0eb619bc0875b5e505b12f789fe0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,*/
3294c81369fb0eb619bc0875b5e505b12f789fe0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"protected String[] getCustomCriteria(Map<String, List<String>> requestParams) {"
3294c81369fb0eb619bc0875b5e505b12f789fe0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (requestParams == null || requestParams.isEmpty()) {
3294c81369fb0eb619bc0875b5e505b12f789fe0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return null;
3294c81369fb0eb619bc0875b5e505b12f789fe0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,}
3294c81369fb0eb619bc0875b5e505b12f789fe0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,List<String> criteria = requestParams.get(CUSTOM_CRITERIA);
3294c81369fb0eb619bc0875b5e505b12f789fe0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,String response = CollectionUtils.isEmpty(criteria) ? null : criteria.get(0);
3294c81369fb0eb619bc0875b5e505b12f789fe0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return new String[] {response};
3294c81369fb0eb619bc0875b5e505b12f789fe0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,.withMaxIndex(getMaxIndex(requestParams));
ea36fecfd74771f9329d2dd984659d26a38e6573,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"@DirectCopyTransformMember(templateTokens = DirectCopyTransformTypes.MULTITENANT_CATALOG),"
ea36fecfd74771f9329d2dd984659d26a38e6573,a4d551eb8e80d433566d7a54761750db6313563b,added,0,@DirectCopyTransformMember(templateTokens = DirectCopyTransformTypes.ARCHIVE_ONLY)
ea36fecfd74771f9329d2dd984659d26a38e6573,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,@DirectCopyTransformMember(templateTokens = DirectCopyTransformTypes.MULTITENANT_CATALOG)
1a30218d32aac8d6ca4b229c322b1fe0a4dd5cc6,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,/**
1a30218d32aac8d6ca4b229c322b1fe0a4dd5cc6,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,* Created to work around a dependency in FulfillmentGroupOfferProcessorImpl to a live application context and
1a30218d32aac8d6ca4b229c322b1fe0a4dd5cc6,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,* system properties service since it uses BLCSystemProperty
1a30218d32aac8d6ca4b229c322b1fe0a4dd5cc6,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,*
1a30218d32aac8d6ca4b229c322b1fe0a4dd5cc6,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,* @author Phillip Verheyden (phillipuniverse)
1a30218d32aac8d6ca4b229c322b1fe0a4dd5cc6,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,*/
1a30218d32aac8d6ca4b229c322b1fe0a4dd5cc6,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,protected static class TestableFulfillmentGroupOfferProcessor extends FulfillmentGroupOfferProcessorImpl {
1a30218d32aac8d6ca4b229c322b1fe0a4dd5cc6,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,@Override
1a30218d32aac8d6ca4b229c322b1fe0a4dd5cc6,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,protected boolean getQualifyGroupAcrossAllOrderItems(PromotableFulfillmentGroup fg) {
1a30218d32aac8d6ca4b229c322b1fe0a4dd5cc6,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,return false;
1a30218d32aac8d6ca4b229c322b1fe0a4dd5cc6,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,}
1a30218d32aac8d6ca4b229c322b1fe0a4dd5cc6,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,fgProcessor = new TestableFulfillmentGroupOfferProcessor();
1a30218d32aac8d6ca4b229c322b1fe0a4dd5cc6,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,fgProcessor = new FulfillmentGroupOfferProcessorImpl();
1709f5369a47216ab05e4326802cee2897b06279,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,if (CollectionUtils.isNotEmpty(transformedValues)) {
1709f5369a47216ab05e4326802cee2897b06279,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,@Override
1709f5369a47216ab05e4326802cee2897b06279,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,import org.hibernate.ejb.QueryHints;
1709f5369a47216ab05e4326802cee2897b06279,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,import javax.persistence.criteria.Subquery;
1709f5369a47216ab05e4326802cee2897b06279,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,if (!transformedValues.isEmpty()) {
2519bec65e1634cc6b14baa262f5ab6a28f5cf89,0f5008328a9e23b8abf5561c68076c0bbaff9a5c,deleted,1,groupName = groupName == null ? DEFAULT_GROUP_NAME : groupName;
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,added,0,synchronized (EXPRESSION_CACHE) {
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,added,0,"Map<String, Class<?>> contextImports = new HashMap<>();"
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,added,0,"contextImports.put(""OfferType"", OfferType.class);"
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,added,0,"contextImports.put(""FulfillmentType"", FulfillmentType.class);"
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,added,0,"return MvelHelper.evaluateRule(expression, vars, EXPRESSION_CACHE, contextImports);"
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,import org.mvel2.MVEL;
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,import org.mvel2.ParserContext;
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,import java.io.Serializable;
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,try {
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,Serializable exp;
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,synchronized (EXPRESSION_CACHE) {
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,exp = (Serializable) EXPRESSION_CACHE.get(expression);
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,if (exp == null) {
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,ParserContext context = new ParserContext();
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,"context.addImport(""OfferType"", OfferType.class);"
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,"context.addImport(""FulfillmentType"", FulfillmentType.class);"
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,"context.addImport(""MVEL"", MVEL.class);"
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,"context.addImport(""MvelHelper"", MvelHelper.class);"
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,//            StringBuffer completeExpression = new StringBuffer(functions.toString());
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,"//            completeExpression.append("" "").append(expression);"
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,"exp = MVEL.compileExpression(expression, context);"
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,"EXPRESSION_CACHE.put(expression, exp);"
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,}
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,"Object test = MVEL.executeExpression(exp, vars);"
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,return (Boolean) test;
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,} catch (Exception e) {
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,//Unable to execute the MVEL expression for some reason
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,"//Return false, but notify about the bad expression through logs"
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,"LOG.warn(""Unable to parse and/or execute an mvel expression. Reporting to the logs and returning false "" +"
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,"""for the match expression:"" + expression, e);"
23c3254ea1399aabd91b595298bee1f5a3e9029c,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,return false;
0269feda3b4606b33f5ef90280f876ba8f8b27ab,23c3254ea1399aabd91b595298bee1f5a3e9029c,added,0,"modifiedExpression = modifiedExpression.replaceAll(attributeMap + ""\\(\\)\\[(.*)\\](?!\\.\\?value)"", attributeMap + ""()[$1].?value"");"
0269feda3b4606b33f5ef90280f876ba8f8b27ab,23c3254ea1399aabd91b595298bee1f5a3e9029c,deleted,1,import org.springframework.stereotype.Component;
0269feda3b4606b33f5ef90280f876ba8f8b27ab,23c3254ea1399aabd91b595298bee1f5a3e9029c,deleted,1,"rule.replaceAll(attributeMap + ""\\(\\)\\[(.*)\\](?!\\.\\?value)"", attributeMap + ""()[$1].?value"");"
ee06b4d45d3b8945dff5b2a3ee0d75b9381919cc,23c3254ea1399aabd91b595298bee1f5a3e9029c,added,0,/**
ee06b4d45d3b8945dff5b2a3ee0d75b9381919cc,23c3254ea1399aabd91b595298bee1f5a3e9029c,added,0,* Returns an array of attribute map field names that we need to do replacements for in
ee06b4d45d3b8945dff5b2a3ee0d75b9381919cc,23c3254ea1399aabd91b595298bee1f5a3e9029c,added,0,"* {@link #modifyExpression(String, Map, ParserContext)}"
ee06b4d45d3b8945dff5b2a3ee0d75b9381919cc,23c3254ea1399aabd91b595298bee1f5a3e9029c,added,0,*/
ee06b4d45d3b8945dff5b2a3ee0d75b9381919cc,23c3254ea1399aabd91b595298bee1f5a3e9029c,added,0,"// intentionally left out pricing context getPricingContextAttributes because that's a Map<String, String>"
ee06b4d45d3b8945dff5b2a3ee0d75b9381919cc,23c3254ea1399aabd91b595298bee1f5a3e9029c,added,0,"// Map<String, PageAttribute>"
ee06b4d45d3b8945dff5b2a3ee0d75b9381919cc,23c3254ea1399aabd91b595298bee1f5a3e9029c,added,0,"// Map<String, AdminUserAttribute>"
ee06b4d45d3b8945dff5b2a3ee0d75b9381919cc,23c3254ea1399aabd91b595298bee1f5a3e9029c,deleted,1,"""getPricingContextAttributes"","
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,import org.broadleafcommerce.core.catalog.domain.Indexable;
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"String[] sortFieldsSegments = sortField.split("" "");"
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,String requestedSortFieldName = sortFieldsSegments[0];
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,List<IndexFieldType> fieldTypes = indexFieldDao.getIndexFieldTypesByAbbreviation(requestedSortFieldName);
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"// Used to determine if, by looping through the index field types managed in the database, we actually"
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"// attach the sort field that is being requested. If we do, then we shouldn't manually add the requested"
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"// sort field ourselves but if not, we should"
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,boolean requestedSortFieldAdded = false;
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,// Loop through all of the field types for the given sort field and add each generated field name
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"// as a sort. Generated field names are comprised of both the field abbreviation and their type, and each"
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,// field could have indexed multiple field types. Rather than try to guess which field type to sort by
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,// this sorts by them all
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,// Verify that the field that is being added as a sort is a match for the field that is requesting
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"// to be sorted by. Since field abbreviations are what are added to the index, this is what should"
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,// be checked
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (fieldType.getIndexField().getField().getAbbreviation().equals(requestedSortFieldName)) {
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,requestedSortFieldAdded = true;
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"ORDER order = getSortOrder(sortFieldsSegments, sortQuery);"
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"query.addSort(new SortClause(field, order));"
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,}
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"// At the end here, it's possible that the field that was passed in to sort by was not managed in the"
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"// database in the list of index fields and their types. If that's the case, go ahead and add it as a sort"
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,// field anyway since we're trusting that the field was actually added to the index by some programmatic means
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (!requestedSortFieldAdded) {
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"query.addSort(new SortClause(requestedSortFieldName, getSortOrder(sortFieldsSegments, sortQuery)));"
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"protected ORDER getSortOrder(String[] sortFieldsSegments, String sortQuery) {"
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,ORDER order = ORDER.asc;
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (sortFieldsSegments.length < 2) {
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"StringBuilder msg = new StringBuilder().append(""Solr sortquery received was "" + sortQuery + "", but no sorting tokens could be extracted."");"
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"msg.append(""\nDefaulting to ASCending"");"
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,LOG.warn(msg.toString());
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"} else if (""desc"".equals(sortFieldsSegments[1])) {"
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,order = ORDER.desc;
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,return order;
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.broadleafcommerce.core.catalog.domain.Indexable;
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"List<IndexFieldType> fieldTypes = indexFieldDao.getIndexFieldTypesByAbbreviation(sortField.split("" "")[0]);"
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,ORDER order = ORDER.asc;
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"String[] sortFieldsSegments = sortField.split("" "");"
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (sortFieldsSegments.length < 2) {
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"StringBuilder msg = new StringBuilder().append(""Solr sortquery received was "" + sortQuery + "", but no sorting tokens could be extracted."");"
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"msg.append(""\nDefaulting to ASCending"");"
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,LOG.warn(msg.toString());
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"} else if (""desc"".equals(sortFieldsSegments[1])) {"
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,order = ORDER.desc;
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,}
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (field != null) {
cba520d014f607225403917706c6aa7502ed8138,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"query.addSort(new SortClause(field, order));"
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,import org.apache.commons.collections.map.MultiValueMap;
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"@OneToMany(mappedBy = ""product"", targetEntity = SkuAttributeImpl.class, cascade = { CascadeType.ALL }, orphanRemoval = true)"
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"@Cache(usage=CacheConcurrencyStrategy.NONSTRICT_READ_WRITE, region=""blProducts"")"
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"@AdminPresentationAdornedTargetCollection(friendlyName = ""productAttributesTitle"","
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"tab = TabName.Advanced, order = 1000,"
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"targetObjectProperty = ""product"","
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"gridVisibleFields = { ""name"", ""value"" })"
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,protected List<ProductAttribute> productAttributes = new ArrayList<ProductAttribute>();
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,@Deprecated
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"Map<String, ProductAttribute> attributeMap = new HashMap<String, ProductAttribute>();"
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,for (ProductAttribute productAttribute : productAttributes) {
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"attributeMap.put(productAttribute.getName(), productAttribute);"
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,}
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,return attributeMap;
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,@Override
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"public Map<String, ProductAttribute> getMultiValueProductAttributes() {"
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"Map<String, ProductAttribute> multiValueMap = new MultiValueMap();"
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"multiValueMap.put(productAttribute.getName(), productAttribute);"
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,return multiValueMap;
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,List<ProductAttribute> productAttributeList = new ArrayList<ProductAttribute>();
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"for(Map.Entry<String, ProductAttribute> entry : productAttributes.entrySet()){"
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,productAttributeList.add(entry.getValue());
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,this.productAttributes = productAttributeList;
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"for (Map.Entry<String, ProductAttribute> entry : getProductAttributes().entrySet()) {"
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"@OneToMany(mappedBy = ""product"", targetEntity = ProductAttributeImpl.class, cascade = { CascadeType.ALL }, orphanRemoval = true)"
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region = ""blProducts"")"
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"@MapKey(name = ""name"")"
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"@AdminPresentationMap(friendlyName = ""productAttributesTitle"","
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"tab = TabName.General,"
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"deleteEntityUponRemove = true, forceFreeFormKeys = true, keyPropertyFriendlyName = ""ProductAttributeImpl_Attribute_Name"")"
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"protected Map<String, ProductAttribute> productAttributes = new HashMap<String, ProductAttribute>();"
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,return productAttributes;
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,this.productAttributes = productAttributes;
70769354b77e20a708b098d796f4ec00883d7542,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"for (Map.Entry<String, ProductAttribute> entry : productAttributes.entrySet()) {"
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,components[0] = convertMapAccessSyntax(components[0]);
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return components;
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,}
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,protected String convertMapAccessSyntax(String field) {
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"if (field.matches("".*\\[\"".*?\""\\].*"")) {"
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"field = field.substring(0, field.lastIndexOf(""["")) + FieldManager.MAPFIELDSEPARATOR +"
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"field.substring(field.lastIndexOf(""["") + 2, field.lastIndexOf(""]"") - 1) +"
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"field.substring(field.lastIndexOf(""]"") + 1, field.length());"
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"if (field.startsWith(""MvelHelper.convertField("")) {"
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"field = field.substring(field.indexOf(""("") + 1, field.length() - 1);"
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"} else if (field.matches("".*\\?get\\(\"".*?\""\\)\\.\\?getValue\\(\\).*"")) {"
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"field = field.substring(0, field.lastIndexOf("".?get("")) + FieldManager.MAPFIELDSEPARATOR +"
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"field.substring(field.lastIndexOf("".?get("") + 7, field.lastIndexOf("").?getValue()"") - 1) +"
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"field.substring(field.lastIndexOf("").?getValue()"") + 13, field.length());"
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"} else if (field.matches("".*\\?get\\(\"".*?\""\\)\\.\\?value.*"")) {"
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,//this is using MVELHelper null-safe map access syntax - must be a map field
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"field.substring(field.lastIndexOf("".?get("") + 7, field.lastIndexOf("").?value"") - 1) +"
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"field.substring(field.lastIndexOf("").?value"") + 8, field.length());"
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return field;
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"if (components[0].matches("".*\\[\"".*?\""\\].*"")) {"
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"components[0] = components[0].substring(0, components[0].lastIndexOf(""["")) + FieldManager.MAPFIELDSEPARATOR +"
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"components[0].substring(components[0].lastIndexOf(""["") + 2, components[0].lastIndexOf(""]"") - 1) +"
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"components[0].substring(components[0].lastIndexOf(""]"") + 1, components[0].length());"
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"if (components[0].startsWith(""MvelHelper.convertField("")) {"
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"components[0] = components[0].substring(components[0].indexOf(""("") + 1, components[0].length()-1);"
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (components[0].matches("".*\\?get\\(\"".*?\""\\)\\.\\?getValue\\(\\).*"")) {"
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"components[0] = components[0].substring(0, components[0].lastIndexOf("".?get("")) + FieldManager.MAPFIELDSEPARATOR +"
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"components[0].substring(components[0].lastIndexOf("".?get("") + 7, components[0].lastIndexOf("").?getValue()"") - 1) +"
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"components[0].substring(components[0].lastIndexOf("").?getValue()"") + 13, components[0].length());"
3d248854d749c5b983d5de88a8631858d0acb4ed,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return components;
3d248854d749c5b983d5de88a8631858d0acb4ed,843d6e33b01967c14878ff604fab842752481e3a,added,0,"context.addImport(""CollectionUtils"", SelectizeCollectionUtils.class);"
3d248854d749c5b983d5de88a8631858d0acb4ed,843d6e33b01967c14878ff604fab842752481e3a,deleted,1,"context.addImport(""CollectionUtils"", CollectionUtils.class);"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,/*
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* #%L
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* BroadleafCommerce Framework
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* %%
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* Copyright (C) 2009 - 2013 Broadleaf Commerce
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* Licensed under the Apache License, Version 2.0 (the ""License"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* you may not use this file except in compliance with the License.
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* You may obtain a copy of the License at
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,*
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,*       http://www.apache.org/licenses/LICENSE-2.0
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* Unless required by applicable law or agreed to in writing, software"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* distributed under the License is distributed on an ""AS IS"" BASIS,"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* See the License for the specific language governing permissions and
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* limitations under the License.
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* #L%
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,*/
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,package org.broadleafcommerce.core.search.service.solr;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.apache.commons.lang.StringUtils;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.apache.solr.client.solrj.SolrClient;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.apache.solr.client.solrj.impl.CloudSolrClient;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.broadleafcommerce.core.search.service.solr.index.SolrIndexServiceImpl;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,/**
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* <p>
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* Provides a class that will statically hold the Solr server.
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* This is initialized in {@link SolrSearchServiceImpl} and used in {@link SolrIndexServiceImpl}
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* @author Andre Azzolini (apazzolini)
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public class SolrContext {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public static final String PRIMARY = ""primary"";"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public static final String REINDEX = ""reindex"";"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,protected static SolrClient adminServer = null;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,protected static SolrClient primaryServer = null;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,protected static SolrClient reindexServer = null;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* Sets the primary SolrClient instance to communicate with Solr.  This is typically one of the following:
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* <code>org.apache.solr.client.solrj.embedded.EmbeddedSolrClient</code>,"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* <code>org.apache.solr.client.solrj.impl.HttpSolrClient</code>,"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* <code>org.apache.solr.client.solrj.impl.LBHttpSolrClient</code>,"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* or <code>org.apache.solr.client.solrj.impl.CloudSolrClient</code>
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* @param server
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public static void setPrimaryServer(SolrClient server) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (server != null && CloudSolrClient.class.isAssignableFrom(server.getClass())) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,CloudSolrClient cs = (CloudSolrClient) server;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (StringUtils.isBlank(cs.getDefaultCollection())) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,cs.setDefaultCollection(PRIMARY);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,}
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (reindexServer != null) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"//If we already have a reindex server set, make sure it's not the same instance as the primary"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (server == reindexServer) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"throw new IllegalArgumentException(""The primary and reindex CloudSolrServers are the same instances. """
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"+ ""They must be different instances. Each instance must have a different defaultCollection or """
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"+ ""the defaultCollection must be unspecified and Broadleaf will set it."");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (CloudSolrClient.class.isAssignableFrom(reindexServer.getClass())) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,//Make sure that the primary and reindex servers are not using the same default collection name
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (cs.getDefaultCollection().equals(((CloudSolrClient) reindexServer).getDefaultCollection())) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"throw new IllegalStateException(""Primary and Reindex servers cannot have the same defaultCollection: """
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,+ cs.getDefaultCollection());
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,primaryServer = server;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* Sets the SolrClient instance that points to the reindex core for the purpose of doing a full reindex, while the"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* primary core is still serving serving requests.  This is typically one of the following:
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* <code>org.apache.solr.client.solrj.embedded.EmbeddedSolrServer</code>,"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* <code>org.apache.solr.client.solrj.impl.HttpSolrServer</code>,"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* <code>org.apache.solr.client.solrj.impl.LBHttpSolrServer</code>,"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public static void setReindexServer(SolrClient server) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,cs.setDefaultCollection(REINDEX);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (primaryServer != null) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (server == primaryServer) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (CloudSolrClient.class.isAssignableFrom(primaryServer.getClass())) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (cs.getDefaultCollection().equals(((CloudSolrClient) primaryServer).getDefaultCollection())) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,reindexServer = server;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* Sets the admin SolrClient instance to communicate with Solr for administrative reasons, like swapping cores."
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* This is typically one of the following:
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* This should not typically need to be set unless using a stand-alone configuration, where the path to the"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* /admin URI is different than the core URI.  This should not typically be set for EmbeddedSolrServer or
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* CloudSolrClient.
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public static void setAdminServer(SolrClient server) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,adminServer = server;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* The adminServer is just a reference to a SolrClient component for connecting to Solr.  In newer
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* versions of Solr, 4.4 and beyond, auto discovery of cores is"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* provided.  When using a stand-alone server or server cluster,"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* the admin server, for swapping cores, is a different URL. For example,"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* one needs to use http://solrserver:8983/solr, which formerly acted as the admin server"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* AND as the primary core.  As of Solr 4.4, one needs to specify the cores separately:"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* http://solrserver:8983/solr/primary and http://solrserver:8983/solr/reindex,"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* and use http://solrserver:8983/solr for swapping cores.
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* By default, this method attempts to return an admin server if configured. Otherwise,"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* it returns the primary server if the admin server is null, which is backwards compatible"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* with the way that BLC worked prior to this change.
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* @return
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public static SolrClient getAdminServer() {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (adminServer != null) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,return adminServer;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"//If the admin server hasn't been set, return the primary server."
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,return getServer();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* @return the primary Solr server
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public static SolrClient getServer() {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,return primaryServer;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* @return the primary server if {@link #isSingleCoreMode()}, else the reindex server"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public static SolrClient getReindexServer() {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,return isSingleCoreMode() ? primaryServer : reindexServer;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* @return if this Solr context has a reindex server set not
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public static boolean isSingleCoreMode() {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,return reindexServer == null;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* Indicates if we are communicating with SolrCloud, rather than embedded, or Stand-alone"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* Solr server(s).  This is important to know because Solr cloud is clustered, uses sharding, uses"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* Zookeeper to manage state, and manages individual ""collections"" rather than ""cores"" for searching and reindexing."
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public static boolean isSolrCloudMode() {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,return CloudSolrClient.class.isAssignableFrom(getServer().getClass());
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,added,0,import org.springframework.beans.factory.annotation.Autowired;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,added,0,import org.springframework.beans.factory.annotation.Qualifier;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,added,0,"public class SolrSearchServiceImpl implements SearchService, DisposableBean {"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,added,0,"@Qualifier(""blCatalogSolrConfiguration"")"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,added,0,@Autowired(required = false)
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,added,0,protected SolrConfiguration solrConfiguration;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,added,0,"//This is for SolrCloud.  We assume that we are always searching against a collection aliased as ""primaryName"""
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,added,0,"solrQuery.setParam(""collection"", solrConfiguration.getPrimaryName()); //This should be ignored if not using SolrCloud"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,added,0,"solrQuery.addFilterQuery(shs.getNamespaceFieldName() + "":(\"""" + solrConfiguration.getNamespace() + ""\"")"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,added,0,"response = solrConfiguration.getServer().query(solrQuery, getSolrQueryMethod());"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,added,0,@Override
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,added,0,public void destroy() throws Exception {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,added,0,solrConfiguration.destroy();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,added,0,}
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,import org.apache.commons.io.IOUtils;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,import org.apache.solr.client.solrj.SolrClient;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,import org.apache.solr.client.solrj.embedded.EmbeddedSolrServer;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,import org.apache.solr.client.solrj.impl.CloudSolrClient;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,import org.apache.solr.client.solrj.request.CollectionAdminRequest;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,import org.apache.solr.common.cloud.Aliases;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,import org.apache.solr.core.CoreContainer;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,import org.springframework.beans.factory.InitializingBean;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,import org.xml.sax.SAXException;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,import java.io.BufferedInputStream;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,import java.io.BufferedOutputStream;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,import java.io.BufferedReader;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,import java.io.File;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,import java.io.FileOutputStream;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,import java.io.FileReader;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,import java.io.InputStream;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,import java.util.HashSet;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,import java.util.Properties;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,import java.util.Set;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,import javax.xml.parsers.ParserConfigurationException;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"public class SolrSearchServiceImpl implements SearchService, InitializingBean, DisposableBean {"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,//This is the name of the config that Zookeeper has associated with Solr configs
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"@Value(""${solr.cloud.configName}"")"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"protected String solrCloudConfigName = ""blc"";"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,//This is the default number of shards that should be created if a SolrCloud collection is created via API
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"@Value(""${solr.cloud.defaultNumShards}"")"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,protected int solrCloudNumShards = 2;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,protected String solrHomePath;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"public SolrSearchServiceImpl(String solrServer) throws IOException, ParserConfigurationException, SAXException {"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"if (Objects.equals(""solrhome"", solrServer)) {"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"final String baseTempPath = System.getProperty(""java.io.tmpdir"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"File tempDir = new File(baseTempPath + File.separator + System.getProperty(""user.name"") + File.separator + ""solrhome-5.3.1"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"if (System.getProperty(""tmpdir.solrhome"") != null) {"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,//allow for an override of tmpdir
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"tempDir = new File(System.getProperty(""tmpdir.solrhome""));"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,}
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (!tempDir.exists()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,tempDir.mkdirs();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,solrServer = tempDir.getAbsolutePath();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,solrHomePath = solrServer;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"File solrXml = new File(new File(solrServer), ""solr.xml"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (!solrXml.exists()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"copyConfigToSolrHome(this.getClass().getResourceAsStream(""/solr-default.xml""), solrXml);"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,buildSolrCoreDirectories(solrServer);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"LOG.debug(String.format(""Using [%s] as solrhome"", solrServer));"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"LOG.debug(String.format(""Using [%s] as solr.xml"", solrXml.getAbsoluteFile()));"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (LOG.isTraceEnabled()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"LOG.trace(""Contents of solr.xml:"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,BufferedReader br = null;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,try {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,br = new BufferedReader(new FileReader(solrXml));
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,String line;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,while ((line = br.readLine()) != null) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,LOG.trace(line);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,} finally {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (br != null) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,br.close();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,} catch (Throwable e) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,//do nothing
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"LOG.trace(""Done printing solr.xml"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"CoreContainer coreContainer = CoreContainer.createAndLoad(solrServer, solrXml);"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"EmbeddedSolrServer primaryServer = new EmbeddedSolrServer(coreContainer, SolrContext.PRIMARY);"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"EmbeddedSolrServer reindexServer = new EmbeddedSolrServer(coreContainer, SolrContext.REINDEX);"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,SolrContext.setPrimaryServer(primaryServer);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,SolrContext.setReindexServer(reindexServer);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,//NOTE: There is no reason to set the admin server here as the SolrContext will return the primary server
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,//if the admin server is not set...
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,public String getSolrHomePath() {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,return solrHomePath;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"public void copyConfigToSolrHome(InputStream configIs, File destFile) throws IOException {"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,BufferedInputStream bis = null;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,BufferedOutputStream bos = null;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,bis = new BufferedInputStream(configIs);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"bos = new BufferedOutputStream(new FileOutputStream(destFile, false));"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,boolean eof = false;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,while (!eof) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,int temp = bis.read();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (temp == -1) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,eof = true;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,} else {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,bos.write(temp);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,bos.flush();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (bis != null) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,bis.close();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (bos != null) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,bos.close();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,/**
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,* This creates the proper directories and writes the correct properties files for Solr to run in embedded mode.
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,* @param solrServer
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,* @throws IOException
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,*/
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,protected void buildSolrCoreDirectories(String solrServer) throws IOException {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"//Create a ""cores"" directory if it does not exist"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"File cores = new File(new File(solrServer), ""cores"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (!cores.exists() || !cores.isDirectory()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,cores.mkdirs();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"//Create a ""cores/primary"" if it does not exist"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"File primaryCoreDir = new File(cores, ""primary"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (!primaryCoreDir.exists() || !primaryCoreDir.isDirectory()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,primaryCoreDir.mkdirs();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"//Create a cores/primary/core.properties file, populated with ""name=primary"""
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"File primaryCoreFile = new File(primaryCoreDir, ""core.properties"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (!primaryCoreFile.exists()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,FileOutputStream os = new FileOutputStream(primaryCoreFile);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,Properties prop = new Properties();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"prop.put(""name"", SolrContext.PRIMARY);"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"prop.store(os, ""Generated Solr core properties file"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,IOUtils.closeQuietly(os);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"//Create a ""cores/primary/conf"" directory if it does not exist"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"File primaryConfDir = new File(primaryCoreDir, ""conf"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (!primaryConfDir.exists() || !primaryConfDir.isDirectory()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,primaryConfDir.mkdirs();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"//Create a ""cores/reindex"" if it does not exist"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"File reindexCoreDir = new File(cores, ""reindex"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (!reindexCoreDir.exists() || !reindexCoreDir.isDirectory()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,reindexCoreDir.mkdirs();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"//Create a cores/reindex/core.properties file, populated with ""name=reindex"""
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"File reindexCoreFile = new File(reindexCoreDir, ""core.properties"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (!reindexCoreFile.exists()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,FileOutputStream os = new FileOutputStream(reindexCoreFile);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"prop.put(""name"", SolrContext.REINDEX);"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"//Create a ""cores/reindex/conf"" directory if it does not exist"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"File reindexConfDir = new File(reindexCoreDir, ""conf"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (!reindexConfDir.exists() || !reindexConfDir.isDirectory()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,reindexConfDir.mkdirs();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,public SolrSearchServiceImpl(SolrClient solrServer) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,SolrContext.setPrimaryServer(solrServer);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,* This constructor serves to mimic the one which takes in one {@link SolrClient} argument.
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"* By having this and then simply disregarding the second parameter, we can more easily support 2-core"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,* Solr configurations that use embedded/standalone per environment.
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,*
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,* @param reindexServer
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,* @throws SAXException
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,* @throws ParserConfigurationException
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"public SolrSearchServiceImpl(String solrServer, String reindexServer)"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"throws IOException, ParserConfigurationException, SAXException {"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,this(solrServer);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"* By having this and then simply disregarding the second and third parameters, we can more easily support 2-core"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"* Solr configurations that use embedded/standalone per environment, along with an admin server."
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"public SolrSearchServiceImpl(String solrServer, String reindexServer, String adminServer)"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"public SolrSearchServiceImpl(SolrClient solrServer, SolrClient reindexServer) {"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"public SolrSearchServiceImpl(SolrClient solrServer, SolrClient reindexServer, SolrClient adminServer) {"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,SolrContext.setAdminServer(adminServer);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,@Override
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,public void afterPropertiesSet() throws Exception {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (SolrContext.isSolrCloudMode()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,//We want to use the Solr APIs to make sure the correct collections are set up.
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,CloudSolrClient primary = (CloudSolrClient) SolrContext.getServer();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,CloudSolrClient reindex = (CloudSolrClient) SolrContext.getReindexServer();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (primary == null || reindex == null) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"throw new IllegalStateException(""The primary and reindex CloudSolrServers must not be null. Check """
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"+ ""your configuration and ensure that you are passing a different instance for each to the """
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"+ ""constructor of """
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,+ this.getClass().getName()
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"+ "" and ensure that each has a null (empty)"""
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"+ "" defaultCollection property, or ensure that defaultCollection is unique between"""
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"+ "" the two instances. All other things, like Zookeeper addresses should be the same."");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (primary == reindex) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"//These are the same object instances.  They should be separate instances, with generally"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"//the same configuration, except for the defaultCollection name."
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"throw new IllegalStateException(""The primary and reindex CloudSolrServers must be different instances """
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"+ ""and their defaultCollection property must be unique or null.  All other things like the """
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"+ ""Zookeeper addresses should be the same."");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,//Set the default collection if it's null
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (StringUtils.isEmpty(primary.getDefaultCollection())) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,primary.setDefaultCollection(SolrContext.PRIMARY);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (StringUtils.isEmpty(reindex.getDefaultCollection())) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,reindex.setDefaultCollection(SolrContext.REINDEX);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"if (Objects.equals(primary.getDefaultCollection(), reindex.getDefaultCollection())) {"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"throw new IllegalStateException(""The primary and reindex CloudSolrServers must have a null (empty) or """
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"+ ""unique defaultCollection property.  All other things like the """
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,primary.connect(); //This is required to ensure no NPE!
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,//Get a list of existing collections so we don't overwrite one
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,Set<String> collectionNames = primary.getZkStateReader().getClusterState().getCollections();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (collectionNames == null) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,collectionNames = new HashSet<String>();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,Aliases aliases = primary.getZkStateReader().getAliases();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"Map<String, String> aliasCollectionMap = aliases.getCollectionAliasMap();"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (aliasCollectionMap == null || !aliasCollectionMap.containsKey(primary.getDefaultCollection())) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,//Create a completely new collection
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,String collectionName = null;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,for (int i = 0; i < 1000; i++) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"collectionName = ""blcCollection"" + i;"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (collectionNames.contains(collectionName)) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,collectionName = null;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,break;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,new CollectionAdminRequest.Create().setCollectionName(collectionName).setNumShards(solrCloudNumShards)
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,.setConfigName(solrCloudConfigName).process(primary);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,new CollectionAdminRequest.CreateAlias().setAliasName(primary.getDefaultCollection())
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,.setAliasedCollections(collectionName).process(primary);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,//Aliases can be mapped to collections that don't exist.... Make sure the collection exists
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,String collectionName = aliasCollectionMap.get(primary.getDefaultCollection());
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"collectionName = collectionName.split("","")[0];"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (!collectionNames.contains(collectionName)) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,//Reload the collection names
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,collectionNames = primary.getZkStateReader().getClusterState().getCollections();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,//Reload these maps for the next collection.
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,aliases = primary.getZkStateReader().getAliases();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,aliasCollectionMap = aliases.getCollectionAliasMap();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (aliasCollectionMap == null || !aliasCollectionMap.containsKey(reindex.getDefaultCollection())) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,new CollectionAdminRequest.CreateAlias().setAliasName(reindex.getDefaultCollection())
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,String collectionName = aliasCollectionMap.get(reindex.getDefaultCollection());
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,public void destroy() throws Exception {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,//Make sure we shut down each of the SolrClient references (these is really the Solr clients despite the name)
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (SolrContext.getServer() != null) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,SolrContext.getServer().shutdown();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,} catch (Exception e) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"LOG.error(""Error shutting down primary SolrClient (client)."", e);"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (SolrContext.getReindexServer() != null
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,&& SolrContext.getReindexServer() != SolrContext.getServer()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,SolrContext.getReindexServer().shutdown();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"LOG.error(""Error shutting down reindex SolrClient (client)."", e);"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,if (SolrContext.getAdminServer() != null
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,&& SolrContext.getAdminServer() != SolrContext.getServer()
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,&& SolrContext.getAdminServer() != SolrContext.getReindexServer()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,SolrContext.getAdminServer().shutdown();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"LOG.error(""Error shutting down admin SolrClient (client)."", e);"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"//This is for SolrCloud.  We assume that we are always searching against a collection aliased as ""PRIMARY"""
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"solrQuery.setParam(""collection"", SolrContext.PRIMARY); //This should be ignored if not using SolrCloud"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"solrQuery.addFilterQuery(shs.getNamespaceFieldName() + "":(\"""" + shs.getCurrentNamespace() + ""\"")"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,0582e26a3fe8fef34ea59ae9d48530be7f1a4256,deleted,1,"response = SolrContext.getServer().query(solrQuery, getSolrQueryMethod());"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,added,0,import org.springframework.beans.factory.annotation.Autowired;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,added,0,import org.springframework.beans.factory.annotation.Qualifier;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,added,0,"public class SolrSearchServiceImpl implements SearchService, DisposableBean {"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,added,0,"@Qualifier(""blCatalogSolrConfiguration"")"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,added,0,@Autowired(required = false)
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,added,0,protected SolrConfiguration solrConfiguration;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,added,0,"//This is for SolrCloud.  We assume that we are always searching against a collection aliased as ""primaryName"""
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,added,0,"solrQuery.setParam(""collection"", solrConfiguration.getPrimaryName()); //This should be ignored if not using SolrCloud"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,added,0,"solrQuery.addFilterQuery(shs.getNamespaceFieldName() + "":(\"""" + solrConfiguration.getNamespace() + ""\"")"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,added,0,"response = solrConfiguration.getServer().query(solrQuery, getSolrQueryMethod());"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,added,0,@Override
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,added,0,public void destroy() throws Exception {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,added,0,solrConfiguration.destroy();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,added,0,}
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,import org.apache.commons.io.IOUtils;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,import org.apache.solr.client.solrj.SolrClient;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,import org.apache.solr.client.solrj.embedded.EmbeddedSolrServer;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,import org.apache.solr.client.solrj.impl.CloudSolrClient;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,import org.apache.solr.client.solrj.request.CollectionAdminRequest;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,import org.apache.solr.common.cloud.Aliases;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,import org.apache.solr.core.CoreContainer;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,import org.springframework.beans.factory.InitializingBean;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,import org.xml.sax.SAXException;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,import java.io.BufferedInputStream;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,import java.io.BufferedOutputStream;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,import java.io.BufferedReader;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,import java.io.File;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,import java.io.FileOutputStream;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,import java.io.FileReader;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,import java.io.InputStream;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,import java.util.HashSet;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,import java.util.Properties;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,import java.util.Set;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,import javax.xml.parsers.ParserConfigurationException;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"public class SolrSearchServiceImpl implements SearchService, InitializingBean, DisposableBean {"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,//This is the name of the config that Zookeeper has associated with Solr configs
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"@Value(""${solr.cloud.configName}"")"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"protected String solrCloudConfigName = ""blc"";"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,//This is the default number of shards that should be created if a SolrCloud collection is created via API
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"@Value(""${solr.cloud.defaultNumShards}"")"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,protected int solrCloudNumShards = 2;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,protected String solrHomePath;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"public SolrSearchServiceImpl(String solrServer) throws IOException, ParserConfigurationException, SAXException {"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"if (Objects.equals(""solrhome"", solrServer)) {"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"final String baseTempPath = System.getProperty(""java.io.tmpdir"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"File tempDir = new File(baseTempPath + File.separator + System.getProperty(""user.name"") + File.separator + ""solrhome-5.3.1"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"if (System.getProperty(""tmpdir.solrhome"") != null) {"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,//allow for an override of tmpdir
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"tempDir = new File(System.getProperty(""tmpdir.solrhome""));"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,}
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (!tempDir.exists()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,tempDir.mkdirs();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,solrServer = tempDir.getAbsolutePath();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,solrHomePath = solrServer;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"File solrXml = new File(new File(solrServer), ""solr.xml"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (!solrXml.exists()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"copyConfigToSolrHome(this.getClass().getResourceAsStream(""/solr-default.xml""), solrXml);"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,buildSolrCoreDirectories(solrServer);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"LOG.debug(String.format(""Using [%s] as solrhome"", solrServer));"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"LOG.debug(String.format(""Using [%s] as solr.xml"", solrXml.getAbsoluteFile()));"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (LOG.isTraceEnabled()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"LOG.trace(""Contents of solr.xml:"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,BufferedReader br = null;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,try {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,br = new BufferedReader(new FileReader(solrXml));
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,String line;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,while ((line = br.readLine()) != null) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,LOG.trace(line);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,} finally {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (br != null) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,br.close();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,} catch (Throwable e) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,//do nothing
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"LOG.trace(""Done printing solr.xml"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"CoreContainer coreContainer = CoreContainer.createAndLoad(solrServer, solrXml);"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"EmbeddedSolrServer primaryServer = new EmbeddedSolrServer(coreContainer, SolrContext.PRIMARY);"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"EmbeddedSolrServer reindexServer = new EmbeddedSolrServer(coreContainer, SolrContext.REINDEX);"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,SolrContext.setPrimaryServer(primaryServer);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,SolrContext.setReindexServer(reindexServer);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,//NOTE: There is no reason to set the admin server here as the SolrContext will return the primary server
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,//if the admin server is not set...
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,public String getSolrHomePath() {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,return solrHomePath;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"public void copyConfigToSolrHome(InputStream configIs, File destFile) throws IOException {"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,BufferedInputStream bis = null;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,BufferedOutputStream bos = null;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,bis = new BufferedInputStream(configIs);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"bos = new BufferedOutputStream(new FileOutputStream(destFile, false));"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,boolean eof = false;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,while (!eof) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,int temp = bis.read();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (temp == -1) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,eof = true;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,} else {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,bos.write(temp);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,bos.flush();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (bis != null) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,bis.close();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (bos != null) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,bos.close();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,/**
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,* This creates the proper directories and writes the correct properties files for Solr to run in embedded mode.
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,* @param solrServer
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,* @throws IOException
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,*/
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,protected void buildSolrCoreDirectories(String solrServer) throws IOException {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"//Create a ""cores"" directory if it does not exist"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"File cores = new File(new File(solrServer), ""cores"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (!cores.exists() || !cores.isDirectory()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,cores.mkdirs();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"//Create a ""cores/primary"" if it does not exist"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"File primaryCoreDir = new File(cores, ""primary"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (!primaryCoreDir.exists() || !primaryCoreDir.isDirectory()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,primaryCoreDir.mkdirs();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"//Create a cores/primary/core.properties file, populated with ""name=primary"""
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"File primaryCoreFile = new File(primaryCoreDir, ""core.properties"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (!primaryCoreFile.exists()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,FileOutputStream os = new FileOutputStream(primaryCoreFile);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,Properties prop = new Properties();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"prop.put(""name"", SolrContext.PRIMARY);"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"prop.store(os, ""Generated Solr core properties file"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,IOUtils.closeQuietly(os);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"//Create a ""cores/primary/conf"" directory if it does not exist"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"File primaryConfDir = new File(primaryCoreDir, ""conf"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (!primaryConfDir.exists() || !primaryConfDir.isDirectory()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,primaryConfDir.mkdirs();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"//Create a ""cores/reindex"" if it does not exist"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"File reindexCoreDir = new File(cores, ""reindex"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (!reindexCoreDir.exists() || !reindexCoreDir.isDirectory()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,reindexCoreDir.mkdirs();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"//Create a cores/reindex/core.properties file, populated with ""name=reindex"""
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"File reindexCoreFile = new File(reindexCoreDir, ""core.properties"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (!reindexCoreFile.exists()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,FileOutputStream os = new FileOutputStream(reindexCoreFile);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"prop.put(""name"", SolrContext.REINDEX);"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"//Create a ""cores/reindex/conf"" directory if it does not exist"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"File reindexConfDir = new File(reindexCoreDir, ""conf"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (!reindexConfDir.exists() || !reindexConfDir.isDirectory()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,reindexConfDir.mkdirs();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,public SolrSearchServiceImpl(SolrClient solrServer) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,SolrContext.setPrimaryServer(solrServer);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,* This constructor serves to mimic the one which takes in one {@link SolrClient} argument.
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"* By having this and then simply disregarding the second parameter, we can more easily support 2-core"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,* Solr configurations that use embedded/standalone per environment.
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,*
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,* @param reindexServer
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,* @throws SAXException
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,* @throws ParserConfigurationException
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"public SolrSearchServiceImpl(String solrServer, String reindexServer)"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"throws IOException, ParserConfigurationException, SAXException {"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,this(solrServer);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"* By having this and then simply disregarding the second and third parameters, we can more easily support 2-core"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"* Solr configurations that use embedded/standalone per environment, along with an admin server."
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"public SolrSearchServiceImpl(String solrServer, String reindexServer, String adminServer)"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"public SolrSearchServiceImpl(SolrClient solrServer, SolrClient reindexServer) {"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"public SolrSearchServiceImpl(SolrClient solrServer, SolrClient reindexServer, SolrClient adminServer) {"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,SolrContext.setAdminServer(adminServer);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,@Override
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,public void afterPropertiesSet() throws Exception {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (SolrContext.isSolrCloudMode()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,//We want to use the Solr APIs to make sure the correct collections are set up.
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,CloudSolrClient primary = (CloudSolrClient) SolrContext.getServer();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,CloudSolrClient reindex = (CloudSolrClient) SolrContext.getReindexServer();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (primary == null || reindex == null) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"throw new IllegalStateException(""The primary and reindex CloudSolrServers must not be null. Check """
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"+ ""your configuration and ensure that you are passing a different instance for each to the """
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"+ ""constructor of """
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,+ this.getClass().getName()
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"+ "" and ensure that each has a null (empty)"""
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"+ "" defaultCollection property, or ensure that defaultCollection is unique between"""
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"+ "" the two instances. All other things, like Zookeeper addresses should be the same."");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (primary == reindex) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"//These are the same object instances.  They should be separate instances, with generally"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"//the same configuration, except for the defaultCollection name."
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"throw new IllegalStateException(""The primary and reindex CloudSolrServers must be different instances """
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"+ ""and their defaultCollection property must be unique or null.  All other things like the """
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"+ ""Zookeeper addresses should be the same."");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,//Set the default collection if it's null
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (StringUtils.isEmpty(primary.getDefaultCollection())) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,primary.setDefaultCollection(SolrContext.PRIMARY);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (StringUtils.isEmpty(reindex.getDefaultCollection())) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,reindex.setDefaultCollection(SolrContext.REINDEX);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"if (Objects.equals(primary.getDefaultCollection(), reindex.getDefaultCollection())) {"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"throw new IllegalStateException(""The primary and reindex CloudSolrServers must have a null (empty) or """
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"+ ""unique defaultCollection property.  All other things like the """
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,primary.connect(); //This is required to ensure no NPE!
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,//Get a list of existing collections so we don't overwrite one
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,Set<String> collectionNames = primary.getZkStateReader().getClusterState().getCollections();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (collectionNames == null) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,collectionNames = new HashSet<String>();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,Aliases aliases = primary.getZkStateReader().getAliases();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"Map<String, String> aliasCollectionMap = aliases.getCollectionAliasMap();"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (aliasCollectionMap == null || !aliasCollectionMap.containsKey(primary.getDefaultCollection())) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,//Create a completely new collection
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,String collectionName = null;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,for (int i = 0; i < 1000; i++) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"collectionName = ""blcCollection"" + i;"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (collectionNames.contains(collectionName)) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,collectionName = null;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,break;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,new CollectionAdminRequest.Create().setCollectionName(collectionName).setNumShards(solrCloudNumShards)
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,.setConfigName(solrCloudConfigName).process(primary);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,new CollectionAdminRequest.CreateAlias().setAliasName(primary.getDefaultCollection())
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,.setAliasedCollections(collectionName).process(primary);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,//Aliases can be mapped to collections that don't exist.... Make sure the collection exists
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,String collectionName = aliasCollectionMap.get(primary.getDefaultCollection());
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"collectionName = collectionName.split("","")[0];"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (!collectionNames.contains(collectionName)) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,//Reload the collection names
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,collectionNames = primary.getZkStateReader().getClusterState().getCollections();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,//Reload these maps for the next collection.
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,aliases = primary.getZkStateReader().getAliases();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,aliasCollectionMap = aliases.getCollectionAliasMap();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (aliasCollectionMap == null || !aliasCollectionMap.containsKey(reindex.getDefaultCollection())) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,new CollectionAdminRequest.CreateAlias().setAliasName(reindex.getDefaultCollection())
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,String collectionName = aliasCollectionMap.get(reindex.getDefaultCollection());
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,public void destroy() throws Exception {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,//Make sure we shut down each of the SolrClient references (these is really the Solr clients despite the name)
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (SolrContext.getServer() != null) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,SolrContext.getServer().shutdown();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,} catch (Exception e) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"LOG.error(""Error shutting down primary SolrClient (client)."", e);"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (SolrContext.getReindexServer() != null
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,&& SolrContext.getReindexServer() != SolrContext.getServer()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,SolrContext.getReindexServer().shutdown();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"LOG.error(""Error shutting down reindex SolrClient (client)."", e);"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,if (SolrContext.getAdminServer() != null
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,&& SolrContext.getAdminServer() != SolrContext.getServer()
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,&& SolrContext.getAdminServer() != SolrContext.getReindexServer()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,SolrContext.getAdminServer().shutdown();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"LOG.error(""Error shutting down admin SolrClient (client)."", e);"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"//This is for SolrCloud.  We assume that we are always searching against a collection aliased as ""PRIMARY"""
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"solrQuery.setParam(""collection"", SolrContext.PRIMARY); //This should be ignored if not using SolrCloud"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"solrQuery.addFilterQuery(shs.getNamespaceFieldName() + "":(\"""" + shs.getCurrentNamespace() + ""\"")"");"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,33025acc016e68691cbde972fb62e2b766178b80,deleted,1,"response = SolrContext.getServer().query(solrQuery, getSolrQueryMethod());"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,import org.broadleafcommerce.core.search.service.solr.SolrConfiguration;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,protected SolrConfiguration solrConfiguration;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public GlobalSolrFullReIndexOperation(SolrIndexService indexService, SolrConfiguration solrConfiguration, SolrHelperService shs, boolean errorOnConcurrentReindex) {"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,this.solrConfiguration = solrConfiguration;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,return solrConfiguration.getReindexServer();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.broadleafcommerce.core.search.service.solr.SolrContext;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public GlobalSolrFullReIndexOperation(SolrIndexService indexService, SolrHelperService shs, boolean errorOnConcurrentReindex) {"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,return SolrContext.getReindexServer();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,import org.broadleafcommerce.core.search.service.solr.SolrConfiguration;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,import org.springframework.beans.factory.annotation.Autowired;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,import org.springframework.beans.factory.annotation.Qualifier;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"@Qualifier(""blCatalogSolrConfiguration"")"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,@Autowired(required = false)
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,protected SolrConfiguration solrConfiguration;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,deleteAllNamespaceDocuments(solrConfiguration.getReindexServer());
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,optimizeIndex(solrConfiguration.getReindexServer());
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (!solrConfiguration.isSingleCoreMode()) {
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,shs.swapActiveCores(solrConfiguration);
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,}
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"return new GlobalSolrFullReIndexOperation(this, solrConfiguration, shs, errorOnConcurrentReIndex) {"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"String deleteQuery = shs.getNamespaceFieldName() + "":(\"""" + solrConfiguration.getNamespace() + ""\"")"";"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"document.addField(shs.getNamespaceFieldName(), solrConfiguration.getNamespace());"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.broadleafcommerce.core.search.service.solr.SolrContext;
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,deleteAllNamespaceDocuments(SolrContext.getReindexServer());
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,optimizeIndex(SolrContext.getReindexServer());
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,shs.swapActiveCores();
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"return new GlobalSolrFullReIndexOperation(this, shs, errorOnConcurrentReIndex) {"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"String deleteQuery = shs.getNamespaceFieldName() + "":(\"""" + shs.getCurrentNamespace() + ""\"")"";"
6d3c73b5ef3ed758fba0a7de9b7cb2ab1553fe84,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"document.addField(shs.getNamespaceFieldName(), shs.getCurrentNamespace());"
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"group = GroupName.Codes,"
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"group = GroupName.Description,"
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,group = GroupName.Advanced)
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"group = GroupName.ActivityRange,"
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"group = GroupName.CombineStack,"
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"group = GroupName.Advanced,"
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,group = GroupName.Restrictions)
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"group = GroupName.QualifierRuleRestriction,"
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"group = GroupName.TargetRuleRestriction,"
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"group = GroupName.RuleConfiguration,"
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"group = GroupName.ShouldBeRelated,"
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"group = GroupName.Restrictions,"
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,added,0,"group = GroupName.ActivityRange, order = 3000,"
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"group = OfferAdminPresentation.GroupName.Codes,"
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"group = OfferAdminPresentation.GroupName.Description,"
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,group = OfferAdminPresentation.GroupName.Advanced)
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"group = OfferAdminPresentation.GroupName.ActivityRange,"
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"group = OfferAdminPresentation.GroupName.CombineStack,"
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"group = OfferAdminPresentation.GroupName.Advanced,"
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,group = OfferAdminPresentation.GroupName.Restrictions)
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"group = OfferAdminPresentation.GroupName.QualifierRuleRestriction,"
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"group = OfferAdminPresentation.GroupName.TargetRuleRestriction,"
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"group = OfferAdminPresentation.GroupName.RuleConfiguration,"
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"group = OfferAdminPresentation.GroupName.ShouldBeRelated,"
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"group = OfferAdminPresentation.GroupName.Restrictions,"
1ad6339e1847acb3b8867f650eac54635c1d934f,a16aeb9158a64c9917bb71669e522043c358b44a,deleted,1,"group = OfferAdminPresentation.GroupName.ActivityRange, order = 3000,"
7d5ae24d2b7224ef70c251c66a2fe5b0223522a1,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,try {
7d5ae24d2b7224ef70c251c66a2fe5b0223522a1,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"fullFieldName = fieldNamePrefix + fieldNamePart.substring(0, 1).toUpperCase() + fieldNamePart.substring(1);"
7d5ae24d2b7224ef70c251c66a2fe5b0223522a1,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"value = PropertyUtils.getProperty(bean, fullFieldName);"
7d5ae24d2b7224ef70c251c66a2fe5b0223522a1,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,} catch (InvocationTargetException|NoSuchMethodException n) {
7d5ae24d2b7224ef70c251c66a2fe5b0223522a1,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"throw new FieldNotAvailableException(""Unable to find field ("" + fieldNamePart + "") on the class ("" + componentClass + "")"");"
7d5ae24d2b7224ef70c251c66a2fe5b0223522a1,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,}
7d5ae24d2b7224ef70c251c66a2fe5b0223522a1,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,Map map;
7d5ae24d2b7224ef70c251c66a2fe5b0223522a1,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"String fieldNamePrefix = fieldName.substring(0, fieldName.indexOf(fieldNamePart));"
7d5ae24d2b7224ef70c251c66a2fe5b0223522a1,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"String fullFieldName = fieldNamePrefix + ""multiValue"" + fieldNamePart.substring(0, 1) + fieldNamePart.substring(1);"
7d5ae24d2b7224ef70c251c66a2fe5b0223522a1,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"fullFieldName = fieldNamePrefix + fieldNamePart.substring(0, 1) + fieldNamePart.substring(1);"
7d5ae24d2b7224ef70c251c66a2fe5b0223522a1,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"map = (Map) PropertyUtils.getProperty(bean, fullFieldName);"
7d5ae24d2b7224ef70c251c66a2fe5b0223522a1,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"LOG.info(""Unable to find a reference to ("" + field.getType().getName() + "") in the EntityConfigurationManager. "" +"
7d5ae24d2b7224ef70c251c66a2fe5b0223522a1,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"""Using the type of this class."");"
7d5ae24d2b7224ef70c251c66a2fe5b0223522a1,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"throw new IllegalAccessException(""Unable to save field ("" + fieldNamePart + "") on the class ("" + componentClass + "")"");"
7d5ae24d2b7224ef70c251c66a2fe5b0223522a1,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,import org.apache.commons.collections.map.MultiValueMap;
7d5ae24d2b7224ef70c251c66a2fe5b0223522a1,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,try {
7d5ae24d2b7224ef70c251c66a2fe5b0223522a1,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"throw new FieldNotAvailableException(""Unable to find field ("" + fieldNamePart + "") on the class ("" + componentClass + "")"");"
7d5ae24d2b7224ef70c251c66a2fe5b0223522a1,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,Map map = new HashMap();
7d5ae24d2b7224ef70c251c66a2fe5b0223522a1,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"String fieldNamePrefix = fieldName.substring(0, fieldName.indexOf(fieldNamePart));"
7d5ae24d2b7224ef70c251c66a2fe5b0223522a1,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"String fullFieldName = fieldNamePrefix + fieldNamePart.substring(0, 1) + fieldNamePart.substring(1);"
7d5ae24d2b7224ef70c251c66a2fe5b0223522a1,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"LOG.info(""Unable to find a reference to (""+field.getType().getName()+"") in the EntityConfigurationManager. "" +"
7d5ae24d2b7224ef70c251c66a2fe5b0223522a1,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"""Using the type of this class."");"
c178a7ad7803aaa94719e186f7fce3789bd996dd,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"String fieldNamePrefix = fieldName.substring(0, fieldName.indexOf(fieldNamePart));"
c178a7ad7803aaa94719e186f7fce3789bd996dd,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"String fullFieldName = fieldNamePrefix + ""multiValue"" + fieldNamePart.substring(0, 1).toUpperCase() + fieldNamePart.substring(1);"
c178a7ad7803aaa94719e186f7fce3789bd996dd,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,if (fieldNamePrefix.isEmpty()) {
c178a7ad7803aaa94719e186f7fce3789bd996dd,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,fullFieldName =  fieldNamePart;
c178a7ad7803aaa94719e186f7fce3789bd996dd,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,} else {
c178a7ad7803aaa94719e186f7fce3789bd996dd,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"fullFieldName = fieldNamePrefix + fieldNamePart.substring(0, 1).toUpperCase() + fieldNamePart.substring(1);"
c178a7ad7803aaa94719e186f7fce3789bd996dd,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,}
c178a7ad7803aaa94719e186f7fce3789bd996dd,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,if (value instanceof List && !((List) value).isEmpty()) {
c178a7ad7803aaa94719e186f7fce3789bd996dd,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"String fieldNamePrefix = fieldName.substring(0, fieldName.indexOf(fieldNamePart));"
c178a7ad7803aaa94719e186f7fce3789bd996dd,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"String fullFieldName = fieldNamePrefix + ""multiValue"" + fieldNamePart.substring(0, 1).toUpperCase() + fieldNamePart.substring(1);"
c178a7ad7803aaa94719e186f7fce3789bd996dd,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"fullFieldName = fieldNamePrefix + fieldNamePart.substring(0, 1).toUpperCase() + fieldNamePart.substring(1);"
c178a7ad7803aaa94719e186f7fce3789bd996dd,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,if (value instanceof List) {
13d8f503a0b6080366e275eb0c41fb83c18ddf56,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withEntity(new Entity());
13d8f503a0b6080366e275eb0c41fb83c18ddf56,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,ppr.getEntity().setType(new String[]{fmd.getCollectionCeilingEntity()});
13d8f503a0b6080366e275eb0c41fb83c18ddf56,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,ppr.getEntity().setType(new String[]{adornedList.getAdornedTargetEntityClassname()});
13d8f503a0b6080366e275eb0c41fb83c18ddf56,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,ppr.getEntity().setType(new String[] { fmd.getTargetClass() });
13d8f503a0b6080366e275eb0c41fb83c18ddf56,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,ppr.setCeilingEntityClassname(ppr.getEntity().getType()[0]);
13d8f503a0b6080366e275eb0c41fb83c18ddf56,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,Entity entity = new Entity();
13d8f503a0b6080366e275eb0c41fb83c18ddf56,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withEntity(entity);
13d8f503a0b6080366e275eb0c41fb83c18ddf56,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,entity.setType(new String[] { fmd.getCollectionCeilingEntity() });
13d8f503a0b6080366e275eb0c41fb83c18ddf56,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,entity.setType(new String[] { adornedList.getAdornedTargetEntityClassname() });
13d8f503a0b6080366e275eb0c41fb83c18ddf56,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,entity.setType(new String[] { fmd.getTargetClass() });
13d8f503a0b6080366e275eb0c41fb83c18ddf56,0a6b890c4cde078866f7bb7056300c5a367542a7,added,0,.withEntity(new Entity());
13d8f503a0b6080366e275eb0c41fb83c18ddf56,0a6b890c4cde078866f7bb7056300c5a367542a7,added,0,ppr.getEntity().setType(new String[]{fmd.getCollectionCeilingEntity()});
13d8f503a0b6080366e275eb0c41fb83c18ddf56,0a6b890c4cde078866f7bb7056300c5a367542a7,added,0,ppr.getEntity().setType(new String[]{adornedList.getAdornedTargetEntityClassname()});
13d8f503a0b6080366e275eb0c41fb83c18ddf56,0a6b890c4cde078866f7bb7056300c5a367542a7,added,0,ppr.getEntity().setType(new String[] { fmd.getTargetClass() });
13d8f503a0b6080366e275eb0c41fb83c18ddf56,0a6b890c4cde078866f7bb7056300c5a367542a7,added,0,ppr.setCeilingEntityClassname(ppr.getEntity().getType()[0]);
13d8f503a0b6080366e275eb0c41fb83c18ddf56,0a6b890c4cde078866f7bb7056300c5a367542a7,deleted,1,Entity entity = new Entity();
13d8f503a0b6080366e275eb0c41fb83c18ddf56,0a6b890c4cde078866f7bb7056300c5a367542a7,deleted,1,.withEntity(entity);
13d8f503a0b6080366e275eb0c41fb83c18ddf56,0a6b890c4cde078866f7bb7056300c5a367542a7,deleted,1,entity.setType(new String[] { fmd.getCollectionCeilingEntity() });
13d8f503a0b6080366e275eb0c41fb83c18ddf56,0a6b890c4cde078866f7bb7056300c5a367542a7,deleted,1,entity.setType(new String[] { adornedList.getAdornedTargetEntityClassname() });
13d8f503a0b6080366e275eb0c41fb83c18ddf56,0a6b890c4cde078866f7bb7056300c5a367542a7,deleted,1,entity.setType(new String[] { fmd.getTargetClass() });
f48611d7b7648760d8a8fba865a013a213492bd1,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"String fieldNamePrefix = fieldName.substring(0, fieldName.indexOf(fieldNamePart));"
f48611d7b7648760d8a8fba865a013a213492bd1,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"String fullFieldName = fieldNamePrefix + ""multiValue"" + fieldNamePart.substring(0, 1).toUpperCase() + fieldNamePart.substring(1);"
f48611d7b7648760d8a8fba865a013a213492bd1,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,if (fieldNamePrefix.isEmpty()) {
f48611d7b7648760d8a8fba865a013a213492bd1,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,fullFieldName =  fieldNamePart;
f48611d7b7648760d8a8fba865a013a213492bd1,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,} else {
f48611d7b7648760d8a8fba865a013a213492bd1,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"fullFieldName = fieldNamePrefix + fieldNamePart.substring(0, 1).toUpperCase() + fieldNamePart.substring(1);"
f48611d7b7648760d8a8fba865a013a213492bd1,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,}
f48611d7b7648760d8a8fba865a013a213492bd1,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"String fieldNamePrefix = fieldName.substring(0, fieldName.indexOf(fieldNamePart));"
f48611d7b7648760d8a8fba865a013a213492bd1,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"String fullFieldName = fieldNamePrefix + ""multiValue"" + fieldNamePart.substring(0, 1).toUpperCase() + fieldNamePart.substring(1);"
f48611d7b7648760d8a8fba865a013a213492bd1,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"fullFieldName = fieldNamePrefix.isEmpty() ? fieldNamePart : fieldNamePrefix + fieldNamePart.substring(0, 1).toUpperCase() + fieldNamePart.substring(1);"
4c7ed640f8e4009d318307e931e1a2d0446659c3,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,added,0,List<Property> properties = getPropertiesFromEntityForm(entityForm);
4c7ed640f8e4009d318307e931e1a2d0446659c3,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,List<Property> properties = new ArrayList<Property>();
4c7ed640f8e4009d318307e931e1a2d0446659c3,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,"for (Entry<String, Field> entry : entityForm.getFields().entrySet()) {"
4c7ed640f8e4009d318307e931e1a2d0446659c3,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,Property p = new Property();
4c7ed640f8e4009d318307e931e1a2d0446659c3,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,p.setName(entry.getKey());
4c7ed640f8e4009d318307e931e1a2d0446659c3,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,p.setValue(entry.getValue().getValue());
4c7ed640f8e4009d318307e931e1a2d0446659c3,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,properties.add(p);
4c7ed640f8e4009d318307e931e1a2d0446659c3,e90f2c78a1c151c0cc049dc1cd9ee4cdd2556703,deleted,1,}
4c7ed640f8e4009d318307e931e1a2d0446659c3,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,List<Property> properties = getPropertiesFromEntityForm(entityForm);
4c7ed640f8e4009d318307e931e1a2d0446659c3,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,List<Property> properties = new ArrayList<Property>();
4c7ed640f8e4009d318307e931e1a2d0446659c3,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"for (Entry<String, Field> entry : entityForm.getFields().entrySet()) {"
4c7ed640f8e4009d318307e931e1a2d0446659c3,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,Property p = new Property();
4c7ed640f8e4009d318307e931e1a2d0446659c3,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,p.setName(entry.getKey());
4c7ed640f8e4009d318307e931e1a2d0446659c3,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,p.setValue(entry.getValue().getValue());
4c7ed640f8e4009d318307e931e1a2d0446659c3,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,properties.add(p);
4c7ed640f8e4009d318307e931e1a2d0446659c3,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,}
4c7ed640f8e4009d318307e931e1a2d0446659c3,b389a4bff2a1d7b804e2c6068874684eb59f4313,added,0,List<Property> properties = getPropertiesFromEntityForm(entityForm);
4c7ed640f8e4009d318307e931e1a2d0446659c3,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,List<Property> properties = new ArrayList<Property>();
4c7ed640f8e4009d318307e931e1a2d0446659c3,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,"for (Entry<String, Field> entry : entityForm.getFields().entrySet()) {"
4c7ed640f8e4009d318307e931e1a2d0446659c3,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,Property p = new Property();
4c7ed640f8e4009d318307e931e1a2d0446659c3,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,p.setName(entry.getKey());
4c7ed640f8e4009d318307e931e1a2d0446659c3,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,p.setValue(entry.getValue().getValue());
4c7ed640f8e4009d318307e931e1a2d0446659c3,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,properties.add(p);
4c7ed640f8e4009d318307e931e1a2d0446659c3,b389a4bff2a1d7b804e2c6068874684eb59f4313,deleted,1,}
49fca65caa220c3b1b1c4510f82e8450c72a239b,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.core.order.domain.FulfillmentGroup;
49fca65caa220c3b1b1c4510f82e8450c72a239b,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,FulfillmentGroup fulfillmentGroup = fulfillmentGroupMember.getFulfillmentGroup();
49fca65caa220c3b1b1c4510f82e8450c72a239b,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,Money fulfillmentCharges;
49fca65caa220c3b1b1c4510f82e8450c72a239b,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (fulfillmentGroup.getShippingOverride()) {
49fca65caa220c3b1b1c4510f82e8450c72a239b,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,fulfillmentCharges = fulfillmentGroup.getFulfillmentPrice();
49fca65caa220c3b1b1c4510f82e8450c72a239b,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,} else {
49fca65caa220c3b1b1c4510f82e8450c72a239b,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,fulfillmentCharges = fulfillmentGroupMember.getFinalizedPriceWithAdjustments();
49fca65caa220c3b1b1c4510f82e8450c72a239b,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,fulfillmentGroupMember.getFulfillmentGroup().setFulfillmentPrice(fulfillmentCharges);
49fca65caa220c3b1b1c4510f82e8450c72a239b,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
49fca65caa220c3b1b1c4510f82e8450c72a239b,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,PromotableFulfillmentGroup fulfillmentGroup = fulfillmentGroupMember;
49fca65caa220c3b1b1c4510f82e8450c72a239b,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Money fulfillmentCharges = fulfillmentGroup.getFinalizedPriceWithAdjustments();
49fca65caa220c3b1b1c4510f82e8450c72a239b,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,fulfillmentGroup.getFulfillmentGroup().setFulfillmentPrice(fulfillmentCharges);
49fca65caa220c3b1b1c4510f82e8450c72a239b,984aba0c7214f3f04667baab1ebfa04293cd1e48,added,0,import org.broadleafcommerce.core.order.domain.FulfillmentGroup;
49fca65caa220c3b1b1c4510f82e8450c72a239b,984aba0c7214f3f04667baab1ebfa04293cd1e48,added,0,FulfillmentGroup fulfillmentGroup = fulfillmentGroupMember.getFulfillmentGroup();
49fca65caa220c3b1b1c4510f82e8450c72a239b,984aba0c7214f3f04667baab1ebfa04293cd1e48,added,0,Money fulfillmentCharges;
49fca65caa220c3b1b1c4510f82e8450c72a239b,984aba0c7214f3f04667baab1ebfa04293cd1e48,added,0,if (fulfillmentGroup.getShippingOverride()) {
49fca65caa220c3b1b1c4510f82e8450c72a239b,984aba0c7214f3f04667baab1ebfa04293cd1e48,added,0,fulfillmentCharges = fulfillmentGroup.getFulfillmentPrice();
49fca65caa220c3b1b1c4510f82e8450c72a239b,984aba0c7214f3f04667baab1ebfa04293cd1e48,added,0,} else {
49fca65caa220c3b1b1c4510f82e8450c72a239b,984aba0c7214f3f04667baab1ebfa04293cd1e48,added,0,fulfillmentCharges = fulfillmentGroupMember.getFinalizedPriceWithAdjustments();
49fca65caa220c3b1b1c4510f82e8450c72a239b,984aba0c7214f3f04667baab1ebfa04293cd1e48,added,0,fulfillmentGroupMember.getFulfillmentGroup().setFulfillmentPrice(fulfillmentCharges);
49fca65caa220c3b1b1c4510f82e8450c72a239b,984aba0c7214f3f04667baab1ebfa04293cd1e48,added,0,}
49fca65caa220c3b1b1c4510f82e8450c72a239b,984aba0c7214f3f04667baab1ebfa04293cd1e48,deleted,1,PromotableFulfillmentGroup fulfillmentGroup = fulfillmentGroupMember;
49fca65caa220c3b1b1c4510f82e8450c72a239b,984aba0c7214f3f04667baab1ebfa04293cd1e48,deleted,1,Money fulfillmentCharges = fulfillmentGroup.getFinalizedPriceWithAdjustments();
49fca65caa220c3b1b1c4510f82e8450c72a239b,984aba0c7214f3f04667baab1ebfa04293cd1e48,deleted,1,fulfillmentGroup.getFulfillmentGroup().setFulfillmentPrice(fulfillmentCharges);
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public List<? extends Indexable> readIndexables(int pageSize, Long lastId) throws ServiceException;"
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"* Build a page from {@link #readIndexables(int, Long)} on the {@link #getSolrServerForIndexing()}. This is used as a"
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public List<? extends Indexable> readIndexables(int page, int pageSize) throws ServiceException;"
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* Build a page from {@link #readIndexables(int, int)} on the {@link #getSolrServerForIndexing()}. This is used as a"
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public List<? extends Indexable> readIndexables(int pageSize, Long lastId) {"
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"return readAllActiveIndexables(pageSize, lastId);"
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,Long lastId = null;
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"lastId = buildIncrementalIndex(pageSize, lastId, operation);"
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"protected Long buildIncrementalIndex(int pageSize, Long lastId, SolrIndexOperation operation) throws ServiceException {"
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,Long response = null;
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"indexables = operation.readIndexables(pageSize, lastId);"
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (CollectionUtils.isNotEmpty(indexables)) {
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,response = indexables.get(indexables.size()-1).getId();
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,}
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,return response;
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"protected List<? extends Indexable> readAllActiveIndexables(int pageSize, Long lastId) {"
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"List<Sku> skus = skuDao.readAllActiveSkus(pageSize, lastId);"
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"return productDao.readAllActiveProducts(pageSize, lastId);"
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public List<? extends Indexable> readIndexables(int page, int pageSize) {"
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"return readAllActiveIndexables(page, pageSize);"
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"buildIncrementalIndex(page, pageSize, operation);"
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"protected void buildIncrementalIndex(int page, int pageSize, SolrIndexOperation operation) throws ServiceException {"
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"indexables = operation.readIndexables(page, pageSize);"
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"protected List<? extends Indexable> readAllActiveIndexables(int page, int pageSize) {"
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"List<Sku> skus = skuDao.readAllActiveSkus(page, pageSize);"
d9044cf7d73448f864f32a5429efe5792a714279,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"return productDao.readAllActiveProducts(page, pageSize);"
9711e7ce24e5811ef6a9aecc8c2a3d8854e60a60,d1309f19fd92992a1b0602a48fb5ade59d6efd3b,added,0,if (sortable) {
9711e7ce24e5811ef6a9aecc8c2a3d8854e60a60,d1309f19fd92992a1b0602a48fb5ade59d6efd3b,added,0,sortProperty = adornedList.getSortField();
9711e7ce24e5811ef6a9aecc8c2a3d8854e60a60,d1309f19fd92992a1b0602a48fb5ade59d6efd3b,added,0,}
9711e7ce24e5811ef6a9aecc8c2a3d8854e60a60,d1309f19fd92992a1b0602a48fb5ade59d6efd3b,added,0,"ListGrid listGrid = createListGrid(ceilingType, headerFields, type, drs, sectionKey, fmd.getOrder(), idProperty, sectionCrumbs, sortProperty);"
9711e7ce24e5811ef6a9aecc8c2a3d8854e60a60,d1309f19fd92992a1b0602a48fb5ade59d6efd3b,added,0,if (sortable){
9711e7ce24e5811ef6a9aecc8c2a3d8854e60a60,d1309f19fd92992a1b0602a48fb5ade59d6efd3b,added,0,if (StringUtils.isNotBlank(sortPropery) && e.findProperty(sortPropery) != null) {
9711e7ce24e5811ef6a9aecc8c2a3d8854e60a60,d1309f19fd92992a1b0602a48fb5ade59d6efd3b,deleted,1,"ListGrid listGrid = createListGrid(ceilingType, headerFields, type, drs, sectionKey, fmd.getOrder(), idProperty, sectionCrumbs,sortProperty);"
9711e7ce24e5811ef6a9aecc8c2a3d8854e60a60,d1309f19fd92992a1b0602a48fb5ade59d6efd3b,deleted,1,if (isLookup) {
9711e7ce24e5811ef6a9aecc8c2a3d8854e60a60,d1309f19fd92992a1b0602a48fb5ade59d6efd3b,deleted,1,listGrid.setIsSortable(false);
9711e7ce24e5811ef6a9aecc8c2a3d8854e60a60,d1309f19fd92992a1b0602a48fb5ade59d6efd3b,deleted,1,} else if (sortable){
9711e7ce24e5811ef6a9aecc8c2a3d8854e60a60,d1309f19fd92992a1b0602a48fb5ade59d6efd3b,deleted,1,if (StringUtils.isNotBlank(sortPropery)) {
67680d15a4ac054c210deefcbd125cffa70901e0,cdabda4e8cf99961c44011e9e015e13617026637,added,0,return idGenerationService.findNextId(Customer.class.getCanonicalName());
67680d15a4ac054c210deefcbd125cffa70901e0,cdabda4e8cf99961c44011e9e015e13617026637,deleted,1,"return idGenerationService.findNextId(""org.broadleafcommerce.profile.core.domain.Customer"");"
c91c219a62c7adf07c06c70202cbfce6ee472579,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,.withFilterAndSortCriteria(getCriteria(requestParams))
c91c219a62c7adf07c06c70202cbfce6ee472579,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,.withStartIndex(getStartIndex(requestParams))
c91c219a62c7adf07c06c70202cbfce6ee472579,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,.withMaxIndex(getMaxIndex(requestParams))
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,List<String> temp = new ArrayList<String>();
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,int initial = 1;
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,//assume this is a multi-value phrase
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,boolean eof = false;
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,while (!eof) {
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"int end = stringValue.indexOf("","", initial);"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (end == -1) {
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,eof = true;
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,end = stringValue.length() - 1;
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,}
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"String tempValue = stringValue.substring(initial, end);"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"String regex = ""(?<!^)\\\""(?!$)"";"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"tempValue = tempValue.replaceAll(regex, ""\\\\\"""");"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,temp.add(tempValue);
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,initial = end + 1;
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,response = temp.toArray(response);
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(""["");"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(formatValue(field, entityKey, type, secondaryType, value, isFieldComparison,"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"ignoreCase, ignoreQuotes));"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(""])"");"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(""("");"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(""] contains "");"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(formatField(entityKey, type, field, ignoreCase, isNegation));"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if ((type.equals(SupportedFieldType.ID) && secondaryType != null &&
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,secondaryType.equals(SupportedFieldType.INTEGER)) || type.equals(SupportedFieldType.INTEGER)) {
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append("".intValue()"");"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append("")"");"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,if (isProjection(value)) {
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,List<String> temp = new ArrayList<String>();
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,int initial = 1;
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,//assume this is a multi-value phrase
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,boolean eof = false;
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,while (!eof) {
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"int end = stringValue.indexOf("","", initial);"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,if (end == -1) {
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,eof = true;
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,end = stringValue.length() - 1;
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,}
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"temp.add(stringValue.substring(initial, end));"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,initial = end + 1;
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,response = temp.toArray(response);
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,} else {
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,response = new Object[]{value};
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,public boolean isProjection(Object value) {
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,String stringValue = value.toString().trim();
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"return stringValue.startsWith(""["") && stringValue.endsWith(""]"") && stringValue.indexOf("","") > 0;"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,if (value.length > 1) {
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(""["");"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(formatValue(field, entityKey, type, secondaryType, value, isFieldComparison,"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"ignoreCase, ignoreQuotes));"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(""])"");"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append("")"");"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"if (operator.equals(""=="") && !isFieldComparison && value.length > 1) {"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(""("");"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(""] contains "");"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(formatField(entityKey, type, field, ignoreCase, isNegation));"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,if ((type.equals(SupportedFieldType.ID) && secondaryType != null &&
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,secondaryType.equals(SupportedFieldType.INTEGER)) || type.equals(SupportedFieldType.INTEGER)) {
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append("".intValue()"");"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,sb.append(operator);
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,if (includeParenthesis) {
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(formatValue(field, entityKey, type, secondaryType, value,"
e7fb65484cda4affee9ec6ffeeb96facc2afcb1e,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"isFieldComparison, ignoreCase, ignoreQuotes));"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (isProjection(value)) {
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,List<String> temp = new ArrayList<String>();
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,int initial = 1;
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,//assume this is a multi-value phrase
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,boolean eof = false;
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,while (!eof) {
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"int end = stringValue.indexOf("","", initial);"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (end == -1) {
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,eof = true;
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,end = stringValue.length() - 1;
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,}
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"temp.add(stringValue.substring(initial, end));"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,initial = end + 1;
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,response = temp.toArray(response);
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else {
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,response = new Object[]{value};
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,public boolean isProjection(Object value) {
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,String stringValue = value.toString().trim();
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"return stringValue.startsWith(""["") && stringValue.endsWith(""]"") && stringValue.indexOf("","") > 0;"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (value.length > 1) {
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(""["");"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(formatValue(field, entityKey, type, secondaryType, value, isFieldComparison,"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"ignoreCase, ignoreQuotes));"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(""])"");"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append("")"");"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"if (operator.equals(""=="") && !isFieldComparison && value.length > 1) {"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(""("");"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(""] contains "");"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(formatField(entityKey, type, field, ignoreCase, isNegation));"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if ((type.equals(SupportedFieldType.ID) && secondaryType != null &&
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,secondaryType.equals(SupportedFieldType.INTEGER)) || type.equals(SupportedFieldType.INTEGER)) {
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append("".intValue()"");"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,sb.append(operator);
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (includeParenthesis) {
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(formatValue(field, entityKey, type, secondaryType, value,"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"isFieldComparison, ignoreCase, ignoreQuotes));"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,List<String> temp = new ArrayList<String>();
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,int initial = 1;
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,//assume this is a multi-value phrase
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,boolean eof = false;
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,while (!eof) {
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"int end = stringValue.indexOf("","", initial);"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,if (end == -1) {
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,eof = true;
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,end = stringValue.length() - 1;
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,}
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"String tempValue = stringValue.substring(initial, end);"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"String regex = ""(?<!^)\\\""(?!$)"";"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"tempValue = tempValue.replaceAll(regex, ""\\\\\"""");"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,temp.add(tempValue);
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,initial = end + 1;
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,response = temp.toArray(response);
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(""["");"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(formatValue(field, entityKey, type, secondaryType, value, isFieldComparison,"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"ignoreCase, ignoreQuotes));"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(""])"");"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(""("");"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(""] contains "");"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(formatField(entityKey, type, field, ignoreCase, isNegation));"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,if ((type.equals(SupportedFieldType.ID) && secondaryType != null &&
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,secondaryType.equals(SupportedFieldType.INTEGER)) || type.equals(SupportedFieldType.INTEGER)) {
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append("".intValue()"");"
fbb466fd3f3cabe2cf4b86e909b2f11923ecc68d,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append("")"");"
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (isProjection(value)) {
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,List<String> temp = new ArrayList<String>();
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,int initial = 1;
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,//assume this is a multi-value phrase
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,boolean eof = false;
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,while (!eof) {
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"int end = stringValue.indexOf("","", initial);"
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (end == -1) {
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,eof = true;
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,end = stringValue.length() - 1;
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,}
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"temp.add(stringValue.substring(initial, end));"
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,initial = end + 1;
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,response = temp.toArray(response);
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else {
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,response = new Object[]{value};
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,public boolean isProjection(Object value) {
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,String stringValue = value.toString().trim();
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"return stringValue.startsWith(""["") && stringValue.endsWith(""]"") && stringValue.indexOf("","") > 0;"
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (value.length > 1) {
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(""["");"
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(formatValue(field, entityKey, type, secondaryType, value, isFieldComparison,"
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"ignoreCase, ignoreQuotes));"
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(""])"");"
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append("")"");"
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,List<String> temp = new ArrayList<String>();
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,int initial = 1;
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,//assume this is a multi-value phrase
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,boolean eof = false;
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,while (!eof) {
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"int end = stringValue.indexOf("","", initial);"
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,if (end == -1) {
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,eof = true;
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,end = stringValue.length() - 1;
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,}
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"String tempValue = stringValue.substring(initial, end);"
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"String regex = ""(?<!^)\\\""(?!$)"";"
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"tempValue = tempValue.replaceAll(regex, ""\\\\\"""");"
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,temp.add(tempValue);
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,initial = end + 1;
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,response = temp.toArray(response);
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(""["");"
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(formatValue(field, entityKey, type, secondaryType, value, isFieldComparison,"
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"ignoreCase, ignoreQuotes));"
bc2e34a48f5aeb9d8d7f6a3fc350a42d48a13f9f,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(""])"");"
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"String processedValue = stringValue.substring(initial, end);"
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,processedValue = escapeInternalQuotes(processedValue);
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,temp.add(processedValue);
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,protected String escapeInternalQuotes(String processedValue) {
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"String regex = ""(?<!^)(?<!^\\s)\\\""(?!\\s$)(?!$)"";"
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"return processedValue.replaceAll(regex, ""\\\\\"""");"
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,}
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"return stringValue.startsWith(""["") && stringValue.endsWith(""]"");"
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"SupportedFieldType type, SupportedFieldType secondaryType, String operator,"
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"boolean includeParenthesis, boolean isFieldComparison, boolean ignoreCase,"
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"boolean isNegation, boolean ignoreQuotes) throws MVELTranslationException {"
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(""["");"
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(formatValue(field, entityKey, type, secondaryType, value, isFieldComparison,"
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"ignoreCase, ignoreQuotes));"
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(""])"");"
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"temp.add(stringValue.substring(initial, end));"
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"return stringValue.startsWith(""["") && stringValue.endsWith(""]"") && stringValue.indexOf("","") > 0;"
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"SupportedFieldType type, SupportedFieldType secondaryType, String operator,"
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"boolean includeParenthesis, boolean isFieldComparison, boolean ignoreCase,"
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"boolean isNegation, boolean ignoreQuotes)"
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,throws MVELTranslationException {
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,if (value.length > 1) {
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(""["");"
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(formatValue(field, entityKey, type, secondaryType, value, isFieldComparison,"
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"ignoreCase, ignoreQuotes));"
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(""])"");"
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,} else {
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append("")"");"
484073310a6b46450629e1582c3d1eea532559de,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,}
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,/*
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* #%L
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* BroadleafCommerce Framework
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* %%
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* Copyright (C) 2009 - 2016 Broadleaf Commerce
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"* Licensed under the Broadleaf Fair Use License Agreement, Version 1.0"
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"* (the ""Fair Use License"" located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)"
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* unless the restrictions on use therein are violated and require payment to Broadleaf in which case
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"* the Broadleaf End User License Agreement (EULA), Version 1.1"
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"* (the ""Commercial License"" located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)"
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* shall apply.
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,*
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"* Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the ""Custom License"")"
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* #L%
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,*/
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,package org.broadleafcommerce.core.offer.service.type;
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,import org.broadleafcommerce.common.BroadleafEnumerationType;
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,import java.io.Serializable;
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,import java.util.LinkedHashMap;
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,import java.util.Map;
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,/**
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* An extendible enumeration of delivery types.
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* Enumeration of how the offer should be applied.
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* AUTOMATIC - will be applied to everyone's order
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* MANUAL - offer is manually assigned to a Customer by an administrator
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,* CODE - a offer code must be supplied in order to receive this offer
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public class OfferDeliveryType implements Serializable, BroadleafEnumerationType, Comparable<OfferDeliveryType> {"
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,private static final long serialVersionUID = 1L;
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"private static final Map<String, OfferDeliveryType> TYPES = new LinkedHashMap<String, OfferDeliveryType>();"
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final OfferDeliveryType AUTOMATIC = new OfferDeliveryType(""AUTOMATIC"", ""Automatically"", 1000);"
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final OfferDeliveryType CODE = new OfferDeliveryType(""CODE"", ""Using Shared Code"", 2000);"
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final OfferDeliveryType MANUAL = new OfferDeliveryType(""MANUAL"", ""Via Application or Shared Code"", 3000);"
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public static OfferDeliveryType getInstance(final String type) {
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return TYPES.get(type);
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,}
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,private String type;
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,private String friendlyType;
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,private int order;
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public OfferDeliveryType() {
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,//do nothing
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public OfferDeliveryType(final String type, final String friendlyType, int order) {"
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,this.friendlyType = friendlyType;
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,setType(type);
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,setOrder(order);
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public void setType(final String type) {
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,this.type = type;
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,if (!TYPES.containsKey(type)) {
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"TYPES.put(type, this);"
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public String getType() {
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return type;
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public String getFriendlyType() {
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return friendlyType;
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public int getOrder() {
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return order;
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public void setOrder(int order) {
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,this.order = order;
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,@Override
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public int hashCode() {
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,final int prime = 31;
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,int result = 1;
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,result = prime * result + ((type == null) ? 0 : type.hashCode());
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return result;
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public boolean equals(Object obj) {
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,if (this == obj)
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return true;
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,if (obj == null)
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return false;
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,if (!getClass().isAssignableFrom(obj.getClass()))
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,OfferDeliveryType other = (OfferDeliveryType) obj;
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,if (type == null) {
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,if (other.type != null)
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,} else if (!type.equals(other.type))
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public int compareTo(OfferDeliveryType arg0) {
599bdd59cab2a109946f45608edcd04948c2e58a,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,return this.order - arg0.order;
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,"public PaymentRequestDTO translatePaymentTransaction(Money transactionAmount, PaymentTransaction paymentTransaction) {"
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,"return translatePaymentTransaction(transactionAmount, paymentTransaction, false);"
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,}
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,@Override
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,"public PaymentRequestDTO translatePaymentTransaction(Money transactionAmount, PaymentTransaction paymentTransaction, boolean autoCalculateFinalPaymentTotals) {"
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,.transactionTotal(transactionAmount.getAmount().toPlainString())
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,.orderSubtotal(transactionAmount.getAmount().toPlainString())
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,.shippingTotal(ZERO_TOTAL)
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,.taxTotal(ZERO_TOTAL)
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,.orderCurrencyCode(paymentTransaction.getOrderPayment().getCurrency().getCurrencyCode())
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,.orderId(paymentTransaction.getOrderPayment().getOrder().getId().toString());
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,if (autoCalculateFinalPaymentTotals) {
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,"populateTotals(order, requestDTO);"
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,"populateDefaultLineItemsAndSubtotal(order, requestDTO);"
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,import org.broadleafcommerce.common.payment.PaymentAdditionalFieldType;
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,import org.broadleafcommerce.common.payment.PaymentGatewayRequestType;
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,import org.broadleafcommerce.common.payment.PaymentTransactionType;
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,"public PaymentRequestDTO translateStandalonePaymentTransaction(Money transactionAmount, PaymentTransaction paymentTransaction) {"
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,.transactionTotal(transactionAmount.getAmount().toPlainString())
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,.orderSubtotal(transactionAmount.getAmount().toPlainString())
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,.shippingTotal(ZERO_TOTAL)
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,.taxTotal(ZERO_TOTAL)
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,.orderCurrencyCode(paymentTransaction.getOrderPayment().getCurrency().getCurrencyCode())
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,.orderId(paymentTransaction.getOrderPayment().getOrder().getId().toString());
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,@Override
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,"public PaymentRequestDTO translatePaymentTransactionForCheckout(Money transactionAmount, PaymentTransaction paymentTransaction) {"
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,Order order = paymentTransaction.getOrderPayment().getOrder();
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,"PaymentRequestDTO requestDTO = translateStandalonePaymentTransaction(transactionAmount, paymentTransaction);"
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,// Only set totals and line items when in a Payment flow
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,"// (i.e. where the transaction is meant to be charged, UNCONFIRMED -> AUTHORIZE or UNCONFIRMED -> AUTHORIZE_AND_CAPTURE)"
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,// AND where the order does not contain multiple final payments. (e.g. multiple credit cards)
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,"// - If in a REFUND flow OR paying with multiple final payments OR this is a DETACHED_CREDIT request,"
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,//   you cannot use the total after applied payments convenience method.
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,// - The amounts to be sent to the gateway are the amounts passed in.
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,if (PaymentTransactionType.UNCONFIRMED.equals(paymentTransaction.getType()) &&
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,!orderContainsMultipleFinalPayments(order) &&
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,!transactionIsDetachedCreditRequest(paymentTransaction)) {
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,"populateTotals(order, requestDTO);"
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,"populateDefaultLineItemsAndSubtotal(order, requestDTO);"
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,}
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,return requestDTO;
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,/**
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,* determine whether or not this order contains multiple final payments.
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,* (e.g. paying with multiple credit cards)
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,* @param order
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,* @return
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,*/
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,protected boolean orderContainsMultipleFinalPayments(Order order) {
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,int finalPaymentCount = 0;
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,for (OrderPayment payment : order.getPayments()) {
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,if (payment.isActive() && payment.isFinalPayment()) {
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,finalPaymentCount++;
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,return finalPaymentCount > 1;
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,* determine whether or not this transaction is a detached credit request.
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,"* By default, will look at the additional fields map to determine intent"
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,* (as the actual type of the transaction is UNCONFIRMED).
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,* @param transaction
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,protected boolean transactionIsDetachedCreditRequest(PaymentTransaction transaction) {
cd9ac36d3dad34cbb10fd57c15ac174e95889739,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,return transaction.getAdditionalFields().containsKey(PaymentGatewayRequestType.DETACHED_CREDIT_REFUND.getType());
8b61a6bd4bd9d45c9f44fb83f21616d12588ddd6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected BigDecimal weightedPercentSaved;
8b61a6bd4bd9d45c9f44fb83f21616d12588ddd6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected Money originalPrice;
8b61a6bd4bd9d45c9f44fb83f21616d12588ddd6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,originalPrice = orderItem.getPriceBeforeAdjustments(getOffer().getApplyDiscountToSalePrice());
8b61a6bd4bd9d45c9f44fb83f21616d12588ddd6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"savings = PromotableOfferUtility.computeAdjustmentValue(originalPrice, offerUnitValue, this, this);"
8b61a6bd4bd9d45c9f44fb83f21616d12588ddd6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,@Override
8b61a6bd4bd9d45c9f44fb83f21616d12588ddd6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public BigDecimal getWeightedPercentSaved() {
8b61a6bd4bd9d45c9f44fb83f21616d12588ddd6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (weightedPercentSaved == null) {
8b61a6bd4bd9d45c9f44fb83f21616d12588ddd6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return new BigDecimal(0);
8b61a6bd4bd9d45c9f44fb83f21616d12588ddd6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
8b61a6bd4bd9d45c9f44fb83f21616d12588ddd6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return weightedPercentSaved;
8b61a6bd4bd9d45c9f44fb83f21616d12588ddd6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setWeightedPercentSaved(BigDecimal weightedPercentSaved) {
8b61a6bd4bd9d45c9f44fb83f21616d12588ddd6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.weightedPercentSaved = weightedPercentSaved;
8b61a6bd4bd9d45c9f44fb83f21616d12588ddd6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public Money getOriginalPrice() {
8b61a6bd4bd9d45c9f44fb83f21616d12588ddd6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return originalPrice;
8b61a6bd4bd9d45c9f44fb83f21616d12588ddd6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setOriginalPrice(Money originalPrice) {
8b61a6bd4bd9d45c9f44fb83f21616d12588ddd6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.originalPrice = originalPrice;
8b61a6bd4bd9d45c9f44fb83f21616d12588ddd6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Money price = orderItem.getPriceBeforeAdjustments(getOffer().getApplyDiscountToSalePrice());
8b61a6bd4bd9d45c9f44fb83f21616d12588ddd6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"savings = PromotableOfferUtility.computeAdjustmentValue(price, offerUnitValue, this, this);"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,"TypedQuery<URLHandler> query = em.createNamedQuery(""BC_READ_OUTGOING_URL"", URLHandler.class);"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"TypedQuery<URLHandler> query = em.createNamedQuery(""BC_READ_BY_INCOMING_URL"", URLHandler.class);"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,@Override
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,public List<URLHandler> findAllRegexURLHandlers() {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"TypedQuery<URLHandler> query = em.createNamedQuery(""BC_READ_ALL_REGEX_HANDLERS"", URLHandler.class);"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"query.setHint(QueryHints.HINT_CACHEABLE, true);"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,return query.getResultList();
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,}
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,* A Null instance of a URLHandler.   Used by the default URLHandlerServiceImpl implementation to
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,*
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,* A Null instance of a URLHandler.   Used by the default URLHandlerServiceImpl implementation to
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,*
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,private static final long serialVersionUID = 1L;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,public void setUrlRedirectType(URLRedirectType redirectType);
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,public abstract void setUrlRedirectType(URLRedirectType redirectType);
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,/**
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,* Indicates if the value returned by <code>getIncomingURL()</code> is a regex expression
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,* rather than a concrete URI.  Default is false.
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,*
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,* @return
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,*/
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,public abstract boolean isRegexHandler();
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,* Indicates if the value set by the method <code>setIncomingURL(String)</code> should be treated as a regex
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,* expression rather than as a concrete URI.
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,* @param regexHandler
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,public abstract void setRegexHandler(boolean regexHandler);
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,*
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,cloned.setUrlRedirectType( URLRedirectType.getInstance(urlRedirectType));
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,return  createResponse;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,*
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,protected boolean isRegex = false;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,@Override
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,public boolean isRegexHandler() {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,return isRegex;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,}
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,public void setRegexHandler(boolean regexHandler) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,this.isRegex = regexHandler;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,cloned.setUrlRedirectType(URLRedirectType.getInstance(urlRedirectType));
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,cloned.setRegexHandler(isRegex);
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,return createResponse;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,import java.io.Serializable;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,"@DirectCopyTransformMember(templateTokens = DirectCopyTransformTypes.SANDBOX, skipOverlaps=true),"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,"name=""URLHandlerID"","
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,"strategy=""org.broadleafcommerce.common.persistence.IdOverrideTableGenerator"","
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,parameters = {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,"@Parameter(name=""segment_value"", value=""URLHandlerImpl""),"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,"@Parameter(name=""entity_name"", value=""org.broadleafcommerce.cms.url.domain.URLHandlerImpl"")"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,}
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,"@Index(name=""INCOMING_URL_INDEX"", columnNames={""INCOMING_URL""})"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,} else if (hasRegExCharacters(location)) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,"* In a preview environment, {@link #getLocation()} attempts to navigate to the"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,"* provided URL.    If the URL contains a Regular Expression, then we can't"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,* navigate to it.
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,*
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,cloned.setUrlRedirectType( URLRedirectType.getInstance(urlRedirectType));
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"@DirectCopyTransformMember(templateTokens = DirectCopyTransformTypes.SANDBOX, skipOverlaps = true),"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"name = ""URLHandlerID"","
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"strategy = ""org.broadleafcommerce.common.persistence.IdOverrideTableGenerator"","
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,parameters = {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"@Parameter(name = ""segment_value"", value = ""URLHandlerImpl""),"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"@Parameter(name = ""entity_name"", value = ""org.broadleafcommerce.cms.url.domain.URLHandlerImpl"")"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,}
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"@AdminPresentation(friendlyName = ""URLHandlerImpl_isRegexHandler"", order = 1, group = ""URLHandlerImpl_friendyName"", prominent = true, groupOrder = 1,"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"helpText = ""urlHandlerIsRegexHandler_help"")"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"@Column(name = ""IS_REGEX"")"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"@Index(name = ""IS_REGEX_HANDLER_INDEX"", columnNames = {""IS_REGEX""})"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,protected Boolean isRegex = false;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"@Index(name = ""INCOMING_URL_INDEX"", columnNames = {""INCOMING_URL""})"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,} else if (isRegexHandler()) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,@Override
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,public boolean isRegexHandler() {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,if (isRegex == null) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,if (hasRegExCharacters(getIncomingURL())) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,return true;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,return false;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,return isRegex;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,public void setRegexHandler(boolean regexHandler) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,this.isRegex = regexHandler;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"* In a preview environment, {@link #getLocation()} attempts to navigate to the"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"* provided URL.    If the URL contains a Regular Expression, then we can't"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,* navigate to it.
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,*
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,if (location == null) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,cloned.setUrlRedirectType(URLRedirectType.getInstance(urlRedirectType));
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,cloned.setRegexHandler(isRegex);
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,import net.sf.ehcache.Cache;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,import org.broadleafcommerce.cms.url.domain.URLHandler;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,import org.broadleafcommerce.common.sandbox.domain.SandBox;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,*
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,URLHandler findURLHandlerByURI(String uri);
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,List<URLHandler> findAllURLHandlers();
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,URLHandler saveURLHandler(URLHandler handler);
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,URLHandler findURLHandlerById(Long id);
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,import org.broadleafcommerce.cms.url.domain.URLHandler;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,*
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,public URLHandler findURLHandlerByURI(String uri);
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,/**
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"* Be cautious when calling this.  If there are a large number of records, this can cause performance and"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,* memory issues.
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,* @return
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,*/
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,public List<URLHandler> findAllURLHandlers();
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,* Persists the URLHandler to the DB.
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,* @param handler
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,public URLHandler saveURLHandler(URLHandler handler);
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,* Finds a URLHandler by its ID.
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,* @param id
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,public URLHandler findURLHandlerById(Long id);
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,* This is assumed to be a relatively small list of regex URLHandlers (perhaps in the dozens or hundreds of
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"* records at a maximum).  Having large number of records here (more 1000, for example)"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"* is not likely necessary to accomplish the desired goal, and can cause performance problems."
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,public List<URLHandler> findAllRegexURLHandlers();
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,import org.broadleafcommerce.common.cache.StatisticsService;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,"@Resource(name=""blURLHandlerDao"")"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,"@Resource(name=""blStatisticsService"")"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,protected StatisticsService statisticsService;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,*
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,return checkForMatches(uri);
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,List<URLHandler> urlHandlers = findAllURLHandlers();
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,for (URLHandler urlHandler : urlHandlers) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,currentHandler = urlHandler;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,String incomingUrl = currentHandler.getIncomingURL();
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,"if (!incomingUrl.startsWith(""^"")) {"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,"if (incomingUrl.startsWith(""/"")) {"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,"incomingUrl = ""^"" + incomingUrl + ""$"";"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,} else {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,"incomingUrl = ""^/"" + incomingUrl + ""$"";"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,}
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,Pattern p = urlPatternMap.get(incomingUrl);
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,if (p == null) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,p = Pattern.compile(incomingUrl);
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,"urlPatternMap.put(incomingUrl, p);"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,Matcher m = p.matcher(requestURI);
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,if (m.find()) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,String newUrl = m.replaceFirst(urlHandler.getNewURL());
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,if (newUrl.equals(urlHandler.getNewURL())) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,return urlHandler;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,added,0,"return new URLHandlerDTO(newUrl, urlHandler.getUrlRedirectType());"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,import org.broadleafcommerce.cms.url.domain.NullURLHandler;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,import org.broadleafcommerce.common.sandbox.domain.SandBox;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,import org.broadleafcommerce.common.site.domain.Site;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,import org.broadleafcommerce.common.web.BroadleafRequestContext;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,import net.sf.ehcache.Cache;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,import net.sf.ehcache.CacheManager;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,import net.sf.ehcache.Element;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,//This is just a placeholder object to allow us to cache a URI that does not have a URL handler.
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,protected static final NullURLHandler NULL_URL_HANDLER = new NullURLHandler();
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,protected Cache urlHandlerCache;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"@Resource(name = ""blURLHandlerDao"")"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,*
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"//This allows clients or implementors to manipulate the URI, for example making it all lower case."
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"//The default implementation simply does not manipulate the URI in any way, but simply returns"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,//what is passed in.
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,uri = manipulateUri(uri);
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,URLHandler handler = null;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,SandBox sandbox = null;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,Site site = null;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,if (BroadleafRequestContext.getBroadleafRequestContext() != null) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,sandbox = BroadleafRequestContext.getBroadleafRequestContext().getSandBox();
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,site = BroadleafRequestContext.getBroadleafRequestContext().getNonPersistentSite();
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,}
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"String key = buildKey(site, sandbox, uri);"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,//See if this is in cache first...
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,handler = getUrlHandlerFromCache(key);
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,if (handler == null) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,//Check for an exact match in the DB...
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,handler = urlHandlerDao.findURLHandlerByURI(uri);
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,//Check for a regex match
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,handler = checkForMatches(uri);
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,//Use the NullURLHandler instance. This will be cached to indicate that
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,//This URL does not have a match.
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,handler = NULL_URL_HANDLER;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,} else if (!(URLHandlerDTO.class.isAssignableFrom(handler.getClass()))) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,//Create a non-entity instance of the DTO to cache.
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"handler = new URLHandlerDTO(handler.getNewURL(), handler.getUrlRedirectType());"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"getUrlHandlerCache().put(new Element(key, handler));"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,if (handler instanceof NullURLHandler) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,return null;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,return handler;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,@Override
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,public List<URLHandler> findAllRegexURLHandlers() {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,return urlHandlerDao.findAllRegexURLHandlers();
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,List<URLHandler> urlHandlers = findAllRegexURLHandlers();
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,if (urlHandlers != null) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,for (URLHandler urlHandler : urlHandlers) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,currentHandler = urlHandler;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,String incomingUrl = currentHandler.getIncomingURL();
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"if (!incomingUrl.startsWith(""^"")) {"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"if (incomingUrl.startsWith(""/"")) {"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"incomingUrl = ""^"" + incomingUrl + ""$"";"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,} else {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"incomingUrl = ""^/"" + incomingUrl + ""$"";"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,Pattern p = urlPatternMap.get(incomingUrl);
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,if (p == null) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,p = Pattern.compile(incomingUrl);
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"urlPatternMap.put(incomingUrl, p);"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,Matcher m = p.matcher(requestURI);
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,if (m.find()) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,String newUrl = m.replaceFirst(urlHandler.getNewURL());
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,if (newUrl.equals(urlHandler.getNewURL())) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,return urlHandler;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"return new URLHandlerDTO(newUrl, urlHandler.getUrlRedirectType());"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,/*
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"* Some clients may wish, for example, to convert the URI into all lower case, or to manipulate it in some way.  This"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,* is just a convenience method to allow the manipulation of the URI coming in that we are trying to
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,* find a match for.
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,*/
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,protected String manipulateUri(String uri) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,//The default is not to modify the URI at all.
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,return uri;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,protected URLHandler getUrlHandlerFromCache(String key) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,Element cacheElement = getUrlHandlerCache().get(key);
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,if (cacheElement != null) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,return (URLHandler) cacheElement.getObjectValue();
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,protected Cache getUrlHandlerCache() {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,if (urlHandlerCache == null) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"urlHandlerCache = CacheManager.getInstance().getCache(""cmsUrlHandlerCache"");"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,return urlHandlerCache;
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"protected String buildKey(Site site, SandBox sandBox, String requestUri) {"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,StringBuilder key = new StringBuilder();
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,if (site != null) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"key.append(""site:"").append(site.getId()).append('_');"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,if (sandBox != null) {
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,"key.append(""sbx:"").append(sandBox.getId()).append('_');"
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,key.append(requestUri);
fc580cf925a7807763763344f1df0da8b59f1424,0a82ae877ab4f23a62f41602c079083a9157f623,deleted,1,return key.toString();
b515202921d836d84dec8c637db565e0fb18bcff,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected void initializePriceDetails() {
b515202921d836d84dec8c637db565e0fb18bcff,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,private void initializePriceDetails() {
7af1b718119c250631c0b3853574682d20f404e8,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected BigDecimal weightedPercentSaved;
7af1b718119c250631c0b3853574682d20f404e8,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected Money originalPrice;
7af1b718119c250631c0b3853574682d20f404e8,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,originalPrice = orderItem.getPriceBeforeAdjustments(getOffer().getApplyDiscountToSalePrice());
7af1b718119c250631c0b3853574682d20f404e8,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"savings = PromotableOfferUtility.computeAdjustmentValue(originalPrice, offerUnitValue, this, this);"
7af1b718119c250631c0b3853574682d20f404e8,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,@Override
7af1b718119c250631c0b3853574682d20f404e8,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public BigDecimal getWeightedPercentSaved() {
7af1b718119c250631c0b3853574682d20f404e8,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (weightedPercentSaved == null) {
7af1b718119c250631c0b3853574682d20f404e8,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return new BigDecimal(0);
7af1b718119c250631c0b3853574682d20f404e8,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
7af1b718119c250631c0b3853574682d20f404e8,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return weightedPercentSaved;
7af1b718119c250631c0b3853574682d20f404e8,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setWeightedPercentSaved(BigDecimal weightedPercentSaved) {
7af1b718119c250631c0b3853574682d20f404e8,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.weightedPercentSaved = weightedPercentSaved;
7af1b718119c250631c0b3853574682d20f404e8,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public Money getOriginalPrice() {
7af1b718119c250631c0b3853574682d20f404e8,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return originalPrice;
7af1b718119c250631c0b3853574682d20f404e8,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setOriginalPrice(Money originalPrice) {
7af1b718119c250631c0b3853574682d20f404e8,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.originalPrice = originalPrice;
7af1b718119c250631c0b3853574682d20f404e8,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Money price = orderItem.getPriceBeforeAdjustments(getOffer().getApplyDiscountToSalePrice());
7af1b718119c250631c0b3853574682d20f404e8,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"savings = PromotableOfferUtility.computeAdjustmentValue(price, offerUnitValue, this, this);"
66ae8f00a336acfd1569bda8752f26ebae85a7dc,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected void initializePriceDetails() {
66ae8f00a336acfd1569bda8752f26ebae85a7dc,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,poid.chooseSaleOrRetailAdjustments();
66ae8f00a336acfd1569bda8752f26ebae85a7dc,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,private void initializePriceDetails() {
66ae8f00a336acfd1569bda8752f26ebae85a7dc,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,poid.chooseSaleOrRetailAdjustments();
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import org.broadleafcommerce.common.filter.Filter;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import org.broadleafcommerce.common.sandbox.domain.SandBoxImpl;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import org.broadleafcommerce.core.catalog.domain.SkuImpl;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import org.broadleafcommerce.core.search.domain.IndexField;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import org.broadleafcommerce.openadmin.dto.ClassMetadata;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import org.broadleafcommerce.openadmin.dto.SortDirection;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import org.broadleafcommerce.openadmin.server.domain.PersistencePackageRequest;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import org.broadleafcommerce.openadmin.server.service.persistence.module.criteria.RestrictionType;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import java.io.Serializable;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import java.math.BigDecimal;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import java.util.Collections;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import java.util.HashMap;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import java.util.Set;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import javax.persistence.EntityManager;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import javax.persistence.PersistenceContext;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import javax.persistence.Tuple;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import javax.persistence.criteria.Subquery;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"public static final String DEFAULT_SKU = ""defaultSku"";"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"if (!setupNonLegacyProductCategory(cto, dynamicEntityDao)) {"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"return new DynamicResultSet(null, new Entity[0], 0);"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,}
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,if (eagerFetchAssociations) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,cto.getNonCountAdditionalFilterMappings().add(new FilterMapping()
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,.withDirectFilterValues(new EmptyFilterValues())
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,.withRestriction(new Restriction()
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,.withPredicateProvider(new PredicateProvider() {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,@Override
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"public Predicate buildPredicate(CriteriaBuilder builder,"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"FieldPathBuilder fieldPathBuilder, From root,"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"String ceilingEntity,"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"String fullPropertyName, Path explicitPath,"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,List directValues) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"root.fetch(""defaultSku"", JoinType.LEFT);"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"root.fetch(""defaultCategory"", JoinType.LEFT);"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,return null;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,})
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,));
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,if (ArrayUtils.isEmpty(persistencePackage.getSectionCrumbs()) &&
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"(!cto.getCriteriaMap().containsKey(""id"") || CollectionUtils.isEmpty(cto.getCriteriaMap().get(""id"").getFilterValues()))) {"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,//Add special handling for product list grid fetches
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,boolean hasExplicitSort = false;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,for (FilterAndSortCriteria filter : cto.getCriteriaMap().values()) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,hasExplicitSort = filter.getSortDirection() != null;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,if (hasExplicitSort) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,break;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,if (!hasExplicitSort) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"FilterAndSortCriteria filter = cto.get(""id"");"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,filter.setNullsLast(false);
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,filter.setSortAscending(true);
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"List<Product> filteredProducts = buildSkuFilters(cto, dynamicEntityDao, helper);"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"// If a list of products was returned, use them instead of proceeding through the pipeline."
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,if (filteredProducts != null) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,// Convert the result list into a list of entities
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,PersistencePerspective persistencePerspective = persistencePackage.getPersistencePerspective();
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"Map<String, FieldMetadata> indexFieldMetadata = helper.getSimpleMergedProperties(Product.class.getName(), persistencePerspective);"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"Entity[] entities = helper.getRecords(indexFieldMetadata, filteredProducts);"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,// We need to get the total number of records available because the entityList returned may not be the full set.
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"Map<String, FieldMetadata> originalProps = helper.getSimpleMergedProperties(Product.class.getName(), persistencePerspective);"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"List<FilterMapping> filterMappings = helper.getFilterMappings(persistencePerspective, cto, Product.class.getName(), originalProps);"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"int totalRecords = helper.getTotalRecords(persistencePackage.getCeilingEntityFullyQualifiedClassname(), filterMappings);"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,// Create a Dynamic Result Set from the entity list created above.
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"DynamicResultSet resultSet = new DynamicResultSet(entities, totalRecords);"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,return resultSet;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,try {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,extensionManager.getProxy().initiateFetchState();
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"return helper.getCompatibleModule(OperationType.BASIC).fetch(persistencePackage, cto);"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,} finally {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,extensionManager.getProxy().endFetchState();
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,} else {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"@SuppressWarnings(""unchecked"")"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"private boolean setupNonLegacyProductCategory(CriteriaTransferObject cto, DynamicEntityDao dynamicEntityDao) {"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"//against the categories chosen in the listGrid filter. The default behavior up to this point, assumes the ""legacy"" mode."
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,if (!isDefaultCategoryLegacyMode()) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,return false;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"""more than "" + queryLimit + "" products found to belong to the selected default categories(%s). This is a "" +"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,return true;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"private List<Product> buildSkuFilters(CriteriaTransferObject cto, DynamicEntityDao dynamicEntityDao, RecordHelper helper) {"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,// Setup the Sku query.
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,CriteriaBuilder builder = dynamicEntityDao.getStandardEntityManager().getCriteriaBuilder();
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,CriteriaQuery<Product> criteria = builder.createQuery(Product.class);
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,Root<SkuImpl> root = criteria.from(SkuImpl.class);
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"criteria.select(root.get(""defaultProduct"").as(Product.class));"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,// Build our list of Sku related restrictions.
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"Map<String, Predicate> restrictions = buildSkuRestrictions(cto, helper, builder, criteria, root);"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,TypedQuery<Product> query = dynamicEntityDao.getStandardEntityManager().createQuery(criteria);
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,List<Product> filteredProducts = query.getResultList();
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"// Check if we are only sorting/filtering on Sku related fields. If so, return the filtered product list."
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,if (isSkuOnlyFilter(cto)) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,return filteredProducts;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"// If we have any filtered products, clear out the associated filter and sort criteria values and add a new"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,// filter mapping to the cto.
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,if (filteredProducts.size() != 0) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"clearFilteredProperties(cto, restrictions.keySet());"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"addSkuFilterMapping(cto, filteredProducts);"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,private Boolean isSkuOnlyFilter(CriteriaTransferObject cto) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,Boolean isSkuOnly = Boolean.TRUE;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,int skuFilters = 0;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,for (String filterProperty : cto.getCriteriaMap().keySet()) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,if (!filterProperty.startsWith(DEFAULT_SKU)
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"&& !filterProperty.equals(""id"")"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"&& !filterProperty.equals(""isLookup"")) {"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,isSkuOnly = Boolean.FALSE;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,} else if (filterProperty.startsWith(DEFAULT_SKU)){
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,skuFilters++;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,return isSkuOnly && (skuFilters > 0);
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"private Map<String, Predicate> buildSkuRestrictions(CriteriaTransferObject cto, RecordHelper helper, CriteriaBuilder builder, CriteriaQuery<Product> criteria, Root<SkuImpl> root) {"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"Map<String, Predicate> restrictions = new HashMap<>();"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,if (filterProperty.startsWith(DEFAULT_SKU)) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,FilterAndSortCriteria fasc = cto.getCriteriaMap().get(filterProperty);
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"String skuField = filterProperty.replace(DEFAULT_SKU + ""."","""");"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,Path skuFieldPath = root.get(skuField);
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"Field field = helper.getFieldManager().getField(SkuImpl.class, skuField);"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"// If we have filter values, create the appropriate restrictions."
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,if (fasc.getFilterValues().size() > 0) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,if (field.getType().isAssignableFrom(String.class)) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"restrictions.put(filterProperty, builder.like(skuFieldPath.as(String.class), ""%"" + fasc.getFilterValues().get(0) + ""%""));"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,} else if (field.getType().isAssignableFrom(BigDecimal.class)) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,if (fasc.getFilterValues().size() == 1) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"restrictions.put(filterProperty, builder.equal(skuFieldPath.as(String.class), fasc.getFilterValues().get(0)));"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,BigDecimal firstValue = new BigDecimal(fasc.getFilterValues().get(0));
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,BigDecimal secondValue = new BigDecimal(fasc.getFilterValues().get(1));
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"restrictions.put(filterProperty, builder.between(skuFieldPath.as(BigDecimal.class), firstValue, secondValue));"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,// Add sorting if applicable.
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,if (fasc.getSortDirection() != null) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,if (fasc.getSortAscending()) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,criteria.orderBy(builder.asc(skuFieldPath));
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,criteria.orderBy(builder.desc(skuFieldPath));
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,// Apply the restrictions if any.
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,if (restrictions.size() > 0) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,criteria.where(restrictions.values().toArray(new Predicate[restrictions.size()]));
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,return restrictions;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"private void addSkuFilterMapping(CriteriaTransferObject cto, List<Product> filterValues) {"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,List<String> productIds = buildProductIdList(filterValues);
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,cto.getAdditionalFilterMappings().add(new FilterMapping()
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,".withFieldPath(new FieldPath().withTargetProperty(""id""))"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,.withDirectFilterValues(productIds)
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"public Predicate buildPredicate(CriteriaBuilder builder, FieldPathBuilder fieldPathBuilder,"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"From root, String ceilingEntity,"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"String fullPropertyName, Path explicitPath, List directValues) {"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,return explicitPath.in(directValues);
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,private List<String> buildProductIdList(List<Product> filterValues) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"List<String> productIds = BLCCollectionUtils.collectList(filterValues, new TypedTransformer<String>() {"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,public String transform(Object input) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,// Make sure we have the actual product id.
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,Long originalId = sandBoxHelper.getOriginalId(input);
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,if (originalId != null) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,return originalId.toString();
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,return ((Product)input).getId().toString();
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,});
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,return productIds;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"private void clearFilteredProperties(CriteriaTransferObject cto, Set<String> filteredProperties) {"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,for (String filterProperty : filteredProperties) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,cto.getCriteriaMap().get(filterProperty).setFilterValues(Collections.<String>emptyList());
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,boolean legacy = parentCategoryLegacyModeService.isLegacyMode();
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"//against the categories chosen in the listGrid filter. The default behavior up to this point, assumes the ""legacy"" mode."
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,if (!legacy) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"return new DynamicResultSet(null, new Entity[0],0);"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"""more than ""+queryLimit+"" products found to belong to the selected default categories(%s). This is a "" +"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,if (eagerFetchAssociations) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,cto.getNonCountAdditionalFilterMappings().add(new FilterMapping()
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,.withDirectFilterValues(new EmptyFilterValues())
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,.withRestriction(new Restriction()
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,.withPredicateProvider(new PredicateProvider() {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,@Override
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"public Predicate buildPredicate(CriteriaBuilder builder,"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"FieldPathBuilder fieldPathBuilder, From root,"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"String ceilingEntity,"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"String fullPropertyName, Path explicitPath,"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,List directValues) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"root.fetch(""defaultSku"", JoinType.LEFT);"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"root.fetch(""defaultCategory"", JoinType.LEFT);"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,return null;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,}
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,})
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,));
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,if (ArrayUtils.isEmpty(persistencePackage.getSectionCrumbs()) &&
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"(!cto.getCriteriaMap().containsKey(""id"") || CollectionUtils.isEmpty(cto.getCriteriaMap().get(""id"").getFilterValues()))) {"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,//Add special handling for product list grid fetches
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,boolean hasExplicitSort = false;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,for (FilterAndSortCriteria filter : cto.getCriteriaMap().values()) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,hasExplicitSort = filter.getSortDirection() != null;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,if (hasExplicitSort) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,break;
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,if (!hasExplicitSort) {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"FilterAndSortCriteria filter = cto.get(""id"");"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,filter.setNullsLast(false);
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,filter.setSortAscending(true);
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,try {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,extensionManager.getProxy().initiateFetchState();
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"return helper.getCompatibleModule(OperationType.BASIC).fetch(persistencePackage, cto);"
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,} finally {
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,extensionManager.getProxy().endFetchState();
5abb45653fdb6a95054a41792d281b330cda8f49,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,} else {
b230ba13ec533d7485d558343cfea0c3057dcb1a,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,import org.broadleafcommerce.common.persistence.Status;
b230ba13ec533d7485d558343cfea0c3057dcb1a,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,boolean update = false;
b230ba13ec533d7485d558343cfea0c3057dcb1a,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,update = false;
b230ba13ec533d7485d558343cfea0c3057dcb1a,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,if ('Y' == ((Status) media).getArchived()) {
b230ba13ec533d7485d558343cfea0c3057dcb1a,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,persist = true;
b230ba13ec533d7485d558343cfea0c3057dcb1a,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,}
b230ba13ec533d7485d558343cfea0c3057dcb1a,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,update = dirty;
b230ba13ec533d7485d558343cfea0c3057dcb1a,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,if (update) {
b230ba13ec533d7485d558343cfea0c3057dcb1a,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,"updateMedia(populateValueRequest, newMedia, persist, media);"
b230ba13ec533d7485d558343cfea0c3057dcb1a,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,response = MetadataProviderResponse.HANDLED_BREAK;
b230ba13ec533d7485d558343cfea0c3057dcb1a,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,if (dirty) {
b230ba13ec533d7485d558343cfea0c3057dcb1a,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,"updateMedia(populateValueRequest, newMedia, persist, media);"
b230ba13ec533d7485d558343cfea0c3057dcb1a,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,}
b230ba13ec533d7485d558343cfea0c3057dcb1a,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,response = MetadataProviderResponse.HANDLED_BREAK;
b230ba13ec533d7485d558343cfea0c3057dcb1a,0fdf3221d7140558f5efc32430d6605100fa9770,added,0,import org.broadleafcommerce.common.persistence.Status;
b230ba13ec533d7485d558343cfea0c3057dcb1a,0fdf3221d7140558f5efc32430d6605100fa9770,added,0,boolean update = false;
b230ba13ec533d7485d558343cfea0c3057dcb1a,0fdf3221d7140558f5efc32430d6605100fa9770,added,0,update = false;
b230ba13ec533d7485d558343cfea0c3057dcb1a,0fdf3221d7140558f5efc32430d6605100fa9770,added,0,if ('Y' == ((Status) media).getArchived()) {
b230ba13ec533d7485d558343cfea0c3057dcb1a,0fdf3221d7140558f5efc32430d6605100fa9770,added,0,persist = true;
b230ba13ec533d7485d558343cfea0c3057dcb1a,0fdf3221d7140558f5efc32430d6605100fa9770,added,0,}
b230ba13ec533d7485d558343cfea0c3057dcb1a,0fdf3221d7140558f5efc32430d6605100fa9770,added,0,update = dirty;
b230ba13ec533d7485d558343cfea0c3057dcb1a,0fdf3221d7140558f5efc32430d6605100fa9770,added,0,if (update) {
b230ba13ec533d7485d558343cfea0c3057dcb1a,0fdf3221d7140558f5efc32430d6605100fa9770,added,0,"updateMedia(populateValueRequest, newMedia, persist, media);"
b230ba13ec533d7485d558343cfea0c3057dcb1a,0fdf3221d7140558f5efc32430d6605100fa9770,added,0,response = MetadataProviderResponse.HANDLED_BREAK;
b230ba13ec533d7485d558343cfea0c3057dcb1a,0fdf3221d7140558f5efc32430d6605100fa9770,deleted,1,if (dirty) {
b230ba13ec533d7485d558343cfea0c3057dcb1a,0fdf3221d7140558f5efc32430d6605100fa9770,deleted,1,"updateMedia(populateValueRequest, newMedia, persist, media);"
b230ba13ec533d7485d558343cfea0c3057dcb1a,0fdf3221d7140558f5efc32430d6605100fa9770,deleted,1,}
b230ba13ec533d7485d558343cfea0c3057dcb1a,0fdf3221d7140558f5efc32430d6605100fa9770,deleted,1,response = MetadataProviderResponse.HANDLED_BREAK;
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"protected boolean orderMeetsQualifyingSubtotalRequirements(PromotableOrder order, PromotableCandidateItemOffer itemOffer) {"
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"return offerServiceUtilities.orderMeetsQualifyingSubtotalRequirements(order, itemOffer.getOffer(), itemOffer.getCandidateQualifiersMap());"
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"return offerServiceUtilities.orderMeetsSubtotalRequirements(order, itemOffer.getOffer());"
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"protected boolean orderMeetsQualifyingSubtotalRequirements(PromotableOrder order, PromotableCandidateItemOffer itemOffer) {"
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Money qualifyingItemSubTotal = itemOffer.getOffer().getQualifyingItemSubTotal();
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (qualifyingItemSubTotal == null || qualifyingItemSubTotal.lessThanOrEqual(Money.ZERO)) {
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return true;
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,}
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Money subtotal = Money.ZERO;
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (OfferItemCriteria itemCriteria : itemOffer.getCandidateQualifiersMap().keySet()) {
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,List<PromotableOrderItem> promotableItems = itemOffer.getCandidateQualifiersMap().get(itemCriteria);
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (PromotableOrderItem item : promotableItems) {
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Money lineItemAmount = item.getPriceBeforeAdjustments(itemOffer.getOffer().getApplyDiscountToSalePrice()).multiply(item.getQuantity());
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,subtotal = subtotal.add(lineItemAmount);
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (subtotal.greaterThanOrEqual(qualifyingItemSubTotal)) {
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return false;
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (itemOffer.getOffer().getOrderMinSubTotal() == null ||
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,itemOffer.getOffer().getOrderMinSubTotal().lessThanOrEqual(Money.ZERO) ||
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,itemOffer.getOffer().getOrderMinSubTotal().lessThanOrEqual(order.getOrder().getSubTotal())) {
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.core.offer.domain.OfferItemCriteria;
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableCandidateItemOffer;
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"if (orderMeetsQualifyingSubtotalRequirements(promotableOrder, orderOffer) && orderMeetsSubtotalRequirements(promotableOrder, orderOffer)) {"
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"applyOrderOffer(promotableOrder, orderOffer);"
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (orderOffer.isTotalitarian() || promotableOrder.isTotalitarianItemOfferApplied()) {
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (LOG.isTraceEnabled()) {
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"LOG.trace(""Totalitarian Order Offer Applied.   Comparing order and item offers for best outcome."");"
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,compareAndAdjustOrderAndItemOffers(promotableOrder);
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"// We continue because this could be the first offer and marked as totalitarian, but not as good as an"
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,// item offer. There could be other order offers that are not totalitarian that also qualify.
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,continue;
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (!orderOffer.isCombinable()) {
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"LOG.trace(""Non-Combinable Order Offer Applied with id=["" + orderOffer.getOffer().getId() + ""].  No other order offers can be applied"");"
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,break;
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"protected boolean orderMeetsQualifyingSubtotalRequirements(PromotableOrder order, PromotableCandidateOrderOffer orderOffer) {"
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"return offerServiceUtilities.orderMeetsQualifyingSubtotalRequirements(order, orderOffer.getOffer(), orderOffer.getCandidateQualifiersMap());"
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"protected boolean orderMeetsSubtotalRequirements(PromotableOrder order, PromotableCandidateOrderOffer orderOffer) {"
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"return offerServiceUtilities.orderMeetsSubtotalRequirements(order, orderOffer.getOffer());"
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"applyOrderOffer(promotableOrder, orderOffer);"
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (orderOffer.isTotalitarian() || promotableOrder.isTotalitarianItemOfferApplied()) {
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (LOG.isTraceEnabled()) {
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"LOG.trace(""Totalitarian Order Offer Applied.   Comparing order and item offers for best outcome."");"
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,compareAndAdjustOrderAndItemOffers(promotableOrder);
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"// We continue because this could be the first offer and marked as totalitarian, but not as good as an"
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// item offer. There could be other order offers that are not totalitarian that also qualify.
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,continue;
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,}
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (!orderOffer.isCombinable()) {
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"LOG.trace(""Non-Combinable Order Offer Applied with id=["" + orderOffer.getOffer().getId() +""].  No other order offers can be applied"");"
2567e4bdda1017ab34e1b128657afa29e1a2a518,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,break;
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,added,0,import org.broadleafcommerce.core.offer.domain.OfferItemCriteria;
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,added,0,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableCandidateItemOffer;
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,added,0,"if (orderMeetsQualifyingSubtotalRequirements(promotableOrder, orderOffer) && orderMeetsSubtotalRequirements(promotableOrder, orderOffer)) {"
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,added,0,"applyOrderOffer(promotableOrder, orderOffer);"
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,added,0,if (orderOffer.isTotalitarian() || promotableOrder.isTotalitarianItemOfferApplied()) {
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,added,0,if (LOG.isTraceEnabled()) {
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,added,0,"LOG.trace(""Totalitarian Order Offer Applied.   Comparing order and item offers for best outcome."");"
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,added,0,}
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,added,0,compareAndAdjustOrderAndItemOffers(promotableOrder);
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,added,0,"// We continue because this could be the first offer and marked as totalitarian, but not as good as an"
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,added,0,// item offer. There could be other order offers that are not totalitarian that also qualify.
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,added,0,continue;
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,added,0,if (!orderOffer.isCombinable()) {
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,added,0,"LOG.trace(""Non-Combinable Order Offer Applied with id=["" + orderOffer.getOffer().getId() + ""].  No other order offers can be applied"");"
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,added,0,break;
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,added,0,"protected boolean orderMeetsQualifyingSubtotalRequirements(PromotableOrder order, PromotableCandidateOrderOffer orderOffer) {"
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,added,0,"return offerServiceUtilities.orderMeetsQualifyingSubtotalRequirements(order, orderOffer.getOffer(), orderOffer.getCandidateQualifiersMap());"
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,added,0,"protected boolean orderMeetsSubtotalRequirements(PromotableOrder order, PromotableCandidateOrderOffer orderOffer) {"
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,added,0,"return offerServiceUtilities.orderMeetsSubtotalRequirements(order, orderOffer.getOffer());"
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,"applyOrderOffer(promotableOrder, orderOffer);"
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,if (orderOffer.isTotalitarian() || promotableOrder.isTotalitarianItemOfferApplied()) {
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,if (LOG.isTraceEnabled()) {
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,"LOG.trace(""Totalitarian Order Offer Applied.   Comparing order and item offers for best outcome."");"
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,compareAndAdjustOrderAndItemOffers(promotableOrder);
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,"// We continue because this could be the first offer and marked as totalitarian, but not as good as an"
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,// item offer. There could be other order offers that are not totalitarian that also qualify.
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,continue;
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,}
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,if (!orderOffer.isCombinable()) {
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,"LOG.trace(""Non-Combinable Order Offer Applied with id=["" + orderOffer.getOffer().getId() +""].  No other order offers can be applied"");"
2567e4bdda1017ab34e1b128657afa29e1a2a518,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,break;
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import org.broadleafcommerce.core.offer.domain.OfferItemCriteria;
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableCandidateItemOffer;
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"if (orderMeetsQualifyingSubtotalRequirements(promotableOrder, orderOffer) && orderMeetsSubtotalRequirements(promotableOrder, orderOffer)) {"
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"applyOrderOffer(promotableOrder, orderOffer);"
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,if (orderOffer.isTotalitarian() || promotableOrder.isTotalitarianItemOfferApplied()) {
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,if (LOG.isTraceEnabled()) {
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"LOG.trace(""Totalitarian Order Offer Applied.   Comparing order and item offers for best outcome."");"
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,}
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,compareAndAdjustOrderAndItemOffers(promotableOrder);
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"// We continue because this could be the first offer and marked as totalitarian, but not as good as an"
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,// item offer. There could be other order offers that are not totalitarian that also qualify.
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,continue;
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,if (!orderOffer.isCombinable()) {
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"LOG.trace(""Non-Combinable Order Offer Applied with id=["" + orderOffer.getOffer().getId() + ""].  No other order offers can be applied"");"
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,break;
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"protected boolean orderMeetsQualifyingSubtotalRequirements(PromotableOrder order, PromotableCandidateOrderOffer orderOffer) {"
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"return offerServiceUtilities.orderMeetsQualifyingSubtotalRequirements(order, orderOffer.getOffer(), orderOffer.getCandidateQualifiersMap());"
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"protected boolean orderMeetsSubtotalRequirements(PromotableOrder order, PromotableCandidateOrderOffer orderOffer) {"
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"return offerServiceUtilities.orderMeetsSubtotalRequirements(order, orderOffer.getOffer());"
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"applyOrderOffer(promotableOrder, orderOffer);"
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (orderOffer.isTotalitarian() || promotableOrder.isTotalitarianItemOfferApplied()) {
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (LOG.isTraceEnabled()) {
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"LOG.trace(""Totalitarian Order Offer Applied.   Comparing order and item offers for best outcome."");"
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,compareAndAdjustOrderAndItemOffers(promotableOrder);
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"// We continue because this could be the first offer and marked as totalitarian, but not as good as an"
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,// item offer. There could be other order offers that are not totalitarian that also qualify.
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,continue;
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,}
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (!orderOffer.isCombinable()) {
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"LOG.trace(""Non-Combinable Order Offer Applied with id=["" + orderOffer.getOffer().getId() +""].  No other order offers can be applied"");"
2567e4bdda1017ab34e1b128657afa29e1a2a518,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,break;
8a9ba7733cc0170b74584ab56108a0bc8521854a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"return getPriceBeforeAdjustments(allowSalesPrice, false);"
8a9ba7733cc0170b74584ab56108a0bc8521854a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
8a9ba7733cc0170b74584ab56108a0bc8521854a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,@Override
8a9ba7733cc0170b74584ab56108a0bc8521854a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"public Money getPriceBeforeAdjustments(boolean allowSalesPrice, boolean includeChildren) {"
8a9ba7733cc0170b74584ab56108a0bc8521854a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,Money returnPrice = Money.ZERO;
8a9ba7733cc0170b74584ab56108a0bc8521854a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (includeChildren) {
8a9ba7733cc0170b74584ab56108a0bc8521854a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,for (OrderItem child : getChildOrderItems()) {
8a9ba7733cc0170b74584ab56108a0bc8521854a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"returnPrice = returnPrice.add(child.getPriceBeforeAdjustments(allowSalesPrice, true));"
8a9ba7733cc0170b74584ab56108a0bc8521854a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return getSalePrice().add(returnPrice);
8a9ba7733cc0170b74584ab56108a0bc8521854a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return getRetailPrice().add(returnPrice);
8a9ba7733cc0170b74584ab56108a0bc8521854a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return getSalePrice();
8a9ba7733cc0170b74584ab56108a0bc8521854a,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return getRetailPrice();
e8f0567632c3b37d24a6cac5e236e1e157224395,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import javax.annotation.Resource;
e8f0567632c3b37d24a6cac5e236e1e157224395,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import javax.servlet.http.HttpServletRequest;
e8f0567632c3b37d24a6cac5e236e1e157224395,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import javax.servlet.http.HttpServletResponse;
e8f0567632c3b37d24a6cac5e236e1e157224395,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,brc.setNonPersistentSite(site);
e8f0567632c3b37d24a6cac5e236e1e157224395,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,HttpServletResponse response = ((ServletWebRequest) request).getResponse();
e8f0567632c3b37d24a6cac5e236e1e157224395,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"ESAPI.httpUtilities().sendRedirect(response, url.toString());"
e8f0567632c3b37d24a6cac5e236e1e157224395,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,} catch(Exception e) {
e8f0567632c3b37d24a6cac5e236e1e157224395,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"LOG.error(""SECURITY FAILURE Bad redirect location: "" + url.toString(), e);"
e8f0567632c3b37d24a6cac5e236e1e157224395,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,response.sendError(403);
e8f0567632c3b37d24a6cac5e236e1e157224395,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import org.owasp.esapi.errors.EncodingException;
e8f0567632c3b37d24a6cac5e236e1e157224395,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import javax.annotation.Resource;
e8f0567632c3b37d24a6cac5e236e1e157224395,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import javax.servlet.http.HttpServletRequest;
e8f0567632c3b37d24a6cac5e236e1e157224395,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,brc.setSite(site);
e8f0567632c3b37d24a6cac5e236e1e157224395,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,String encodedURL = ESAPI.encoder().encodeForURL(url.toString());
e8f0567632c3b37d24a6cac5e236e1e157224395,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,((ServletWebRequest) request).getResponse().sendRedirect(encodedURL);
e8f0567632c3b37d24a6cac5e236e1e157224395,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,} catch(EncodingException e) {
e8f0567632c3b37d24a6cac5e236e1e157224395,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"LOG.error(""Encoding Exception for url when reprocessing request"", e);"
e8f0567632c3b37d24a6cac5e236e1e157224395,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,((ServletWebRequest) request).getResponse().sendError(403);
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,import java.lang.reflect.Field;
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,import java.util.ArrayList;
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,import java.util.List;
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,import java.util.Map;
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"@Resource(name = ""blSandBoxHelper"")"
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,if (productIds.size() == 0) {
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"return new DynamicResultSet(null, new Entity[0], 0);"
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,".withFieldPath(new FieldPath().withTargetProperty(""id""))"
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,.withDirectFilterValues(productIds)
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,.withRestriction(new Restriction()
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,.withPredicateProvider(new PredicateProvider() {
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,@Override
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"public Predicate buildPredicate(CriteriaBuilder builder, FieldPathBuilder fieldPathBuilder,"
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"From root, String ceilingEntity, String fullPropertyName,"
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"Path explicitPath, List directValues) {"
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,return explicitPath.in(directValues);
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,}
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,)
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,);
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"""more than "" + queryLimit + "" products found to belong to the selected default categories(%s). This is a "" +"
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,Entity entity = persistencePackage.getEntity();
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"removeBundleFieldRestrictions((ProductBundle) adminInstance, adminProperties, entity);"
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"Map<String, FieldMetadata> adminProperties = helper.getSimpleMergedProperties(Product.class.getName(), persistencePerspective);"
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,*
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"((BasicFieldMetadata) adminProperties.get(""defaultSku.retailPrice"")).setRequiredOverride(false);"
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,added,0,"((BasicFieldMetadata) adminProperties.get(""defaultSku.retailPrice"")).setRequiredOverride(true);"
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,import org.broadleafcommerce.core.catalog.dao.ProductDao;
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,import org.broadleafcommerce.openadmin.dto.Property;
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,import org.broadleafcommerce.openadmin.server.service.ValidationException;
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,import java.lang.reflect.Field;
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,import java.util.ArrayList;
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,import java.util.List;
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,import java.util.Map;
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"@Resource(name=""blSandBoxHelper"")"
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,if(productIds.size() == 0){
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"return new DynamicResultSet(null, new Entity[0],0);"
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,".withFieldPath(new FieldPath().withTargetProperty(""id""))"
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,.withDirectFilterValues(productIds)
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,.withRestriction(new Restriction()
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,.withPredicateProvider(new PredicateProvider() {
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,@Override
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"public Predicate buildPredicate(CriteriaBuilder builder, FieldPathBuilder fieldPathBuilder,"
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"From root, String ceilingEntity, String fullPropertyName,"
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"Path explicitPath, List directValues) {"
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,return explicitPath.in(directValues);
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,}
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,)
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,);
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"""more than ""+queryLimit+"" products found to belong to the selected default categories(%s). This is a "" +"
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,Entity entity  = persistencePackage.getEntity();
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"removeBundleFieldRestrictions((ProductBundle)adminInstance, adminProperties, entity);"
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"Map<String, FieldMetadata> adminProperties = helper.getSimpleMergedProperties(Product.class.getName(), persistencePerspective);"
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"((BasicFieldMetadata)adminProperties.get(""defaultSku.retailPrice"")).setRequiredOverride(false);"
e9d18769de0788a454b358ded232ca7d14d947a1,29a3bbf5f954d466d9e5ef167be4a5cb23f0d9ce,deleted,1,"((BasicFieldMetadata)adminProperties.get(""defaultSku.retailPrice"")).setRequiredOverride(true);"
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import java.lang.reflect.Field;
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import java.util.ArrayList;
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import java.util.List;
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import java.util.Map;
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"@Resource(name = ""blSandBoxHelper"")"
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,if (productIds.size() == 0) {
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"return new DynamicResultSet(null, new Entity[0], 0);"
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,".withFieldPath(new FieldPath().withTargetProperty(""id""))"
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,.withDirectFilterValues(productIds)
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,.withRestriction(new Restriction()
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,.withPredicateProvider(new PredicateProvider() {
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,@Override
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"public Predicate buildPredicate(CriteriaBuilder builder, FieldPathBuilder fieldPathBuilder,"
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"From root, String ceilingEntity, String fullPropertyName,"
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"Path explicitPath, List directValues) {"
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,return explicitPath.in(directValues);
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,}
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,)
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,);
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"""more than "" + queryLimit + "" products found to belong to the selected default categories(%s). This is a "" +"
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,Entity entity = persistencePackage.getEntity();
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"removeBundleFieldRestrictions((ProductBundle) adminInstance, adminProperties, entity);"
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"Map<String, FieldMetadata> adminProperties = helper.getSimpleMergedProperties(Product.class.getName(), persistencePerspective);"
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,*
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"((BasicFieldMetadata) adminProperties.get(""defaultSku.retailPrice"")).setRequiredOverride(false);"
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"((BasicFieldMetadata) adminProperties.get(""defaultSku.retailPrice"")).setRequiredOverride(true);"
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,import org.broadleafcommerce.core.catalog.dao.ProductDao;
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,import org.broadleafcommerce.openadmin.dto.Property;
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,import org.broadleafcommerce.openadmin.server.service.ValidationException;
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,import java.lang.reflect.Field;
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,import java.util.ArrayList;
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,import java.util.List;
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,import java.util.Map;
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"@Resource(name=""blSandBoxHelper"")"
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,if(productIds.size() == 0){
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"return new DynamicResultSet(null, new Entity[0],0);"
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,".withFieldPath(new FieldPath().withTargetProperty(""id""))"
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,.withDirectFilterValues(productIds)
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,.withRestriction(new Restriction()
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,.withPredicateProvider(new PredicateProvider() {
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,@Override
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"public Predicate buildPredicate(CriteriaBuilder builder, FieldPathBuilder fieldPathBuilder,"
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"From root, String ceilingEntity, String fullPropertyName,"
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"Path explicitPath, List directValues) {"
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,return explicitPath.in(directValues);
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,}
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,)
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,);
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"""more than ""+queryLimit+"" products found to belong to the selected default categories(%s). This is a "" +"
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,Entity entity  = persistencePackage.getEntity();
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"removeBundleFieldRestrictions((ProductBundle)adminInstance, adminProperties, entity);"
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"Map<String, FieldMetadata> adminProperties = helper.getSimpleMergedProperties(Product.class.getName(), persistencePerspective);"
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"((BasicFieldMetadata)adminProperties.get(""defaultSku.retailPrice"")).setRequiredOverride(false);"
e9d18769de0788a454b358ded232ca7d14d947a1,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"((BasicFieldMetadata)adminProperties.get(""defaultSku.retailPrice"")).setRequiredOverride(true);"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,import java.math.BigDecimal;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,import java.util.ArrayList;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,import java.util.Collections;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,import java.util.Comparator;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,import java.util.Date;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,import java.util.HashMap;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,import java.util.HashSet;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,import java.util.Iterator;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,import java.util.List;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,import java.util.Map;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,import java.util.Set;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,*
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"columnNames = {""URL"", ""URL_KEY""}"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,{
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"@AdminPresentationMergeOverride(name = ""defaultSku.displayTemplate"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"@AdminPresentationMergeOverride(name = ""defaultSku.urlKey"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"@AdminPresentationMergeOverride(name = ""defaultSku.retailPrice"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"@AdminPresentationMergeOverride(name = ""defaultSku.name"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"@AdminPresentationMergeOverride(name = ""defaultSku.activeEndDate"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,@ValidationConfiguration(
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"validationImplementation = ""blAfterStartDateValidator"","
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,configurationItems = {
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"@ConfigurationItem(itemName = ""otherField"", itemValue = ""defaultSku.activeStartDate"")"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,})
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"@AdminPresentationMergeOverride(name = ""defaultSku.auditable.createdBy"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"@AdminPresentationMergeOverride(name = ""defaultSku.auditable.dateCreated"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"@AdminPresentationMergeOverride(name = ""defaultSku.auditable.dateUpdated"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"@AdminPresentationMergeOverride(name = ""defaultSku.auditable.updatedBy"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,/**
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,* The Constant serialVersionUID.
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,*/
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,* The id.
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,@AdminPresentation(
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"friendlyName = ""ProductImpl_Product_Url"","
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"group = GroupName.General,"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"order = FieldOrder.URL,"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"prominent = true,"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"gridOrder = 3,"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"columnWidth = ""260px"","
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,validationConfigurations = {
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"@ValidationConfiguration(validationImplementation = ""blUriPropertyValidator""),"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"validationImplementation = ""blUniqueValueValidator"","
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,@ConfigurationItem(
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"itemName = ConfigurationItem.ERROR_MESSAGE,"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"itemValue = ""This URL is already in use. Please provide a unique URL."""
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,)
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,}
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"),"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"@OneToOne(targetEntity = SkuImpl.class, cascade = {CascadeType.ALL})"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,@Cascade(value = {org.hibernate.annotations.CascadeType.ALL})
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"@OneToMany(mappedBy = ""product"", targetEntity = CrossSaleProductImpl.class, cascade = {CascadeType.ALL})"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"@Cascade(value = {org.hibernate.annotations.CascadeType.ALL, org.hibernate.annotations.CascadeType.DELETE_ORPHAN})"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"maintainedAdornedTargetFields = {""promotionMessage""},"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"gridVisibleFields = {""defaultSku.name"", ""promotionMessage""})"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"@OneToMany(mappedBy = ""product"", targetEntity = UpSaleProductImpl.class, cascade = {CascadeType.ALL})"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"@Index(name = ""PRODUCT_CATEGORY_INDEX"", columnNames = {""DEFAULT_CATEGORY_ID""})"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"cascade = {CascadeType.MERGE, CascadeType.PERSIST, CascadeType.REFRESH})"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"gridVisibleFields = {""name""})"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"@OneToMany(mappedBy = ""product"", targetEntity = ProductAttributeImpl.class, cascade = {CascadeType.ALL}, orphanRemoval = true)"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region = ""blProducts"")"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,"gridVisibleFields = {""name"", ""type"", ""required""})"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,while (it.hasNext()) {
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,productAttributeList.addAll((List) productAttributes.get(theKey));
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentationMap;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,import java.math.BigDecimal;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,import java.util.ArrayList;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,import java.util.Collection;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,import java.util.Collections;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,import java.util.Comparator;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,import java.util.Date;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,import java.util.HashMap;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,import java.util.HashSet;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,import java.util.Iterator;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,import java.util.List;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,import java.util.Map;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,import java.util.Set;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,import javax.persistence.MapKey;
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"columnNames = { ""URL"", ""URL_KEY"" }"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,{
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"@AdminPresentationMergeOverride(name = ""defaultSku.displayTemplate"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"@AdminPresentationMergeOverride(name = ""defaultSku.urlKey"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"@AdminPresentationMergeOverride(name = ""defaultSku.retailPrice"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"@AdminPresentationMergeOverride(name = ""defaultSku.name"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"@AdminPresentationMergeOverride(name = ""defaultSku.activeEndDate"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,@ValidationConfiguration(
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"validationImplementation = ""blAfterStartDateValidator"","
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,configurationItems = {
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"@ConfigurationItem(itemName = ""otherField"", itemValue = ""defaultSku.activeStartDate"")"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,})
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"@AdminPresentationMergeOverride(name = ""defaultSku.auditable.createdBy"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"@AdminPresentationMergeOverride(name = ""defaultSku.auditable.dateCreated"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"@AdminPresentationMergeOverride(name = ""defaultSku.auditable.dateUpdated"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"@AdminPresentationMergeOverride(name = ""defaultSku.auditable.updatedBy"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,/** The Constant serialVersionUID. */
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,/** The id. */
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"@AdminPresentation(friendlyName = ""ProductImpl_Product_Url"","
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"group = GroupName.General, order = FieldOrder.URL,"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"prominent = true, gridOrder = 3, columnWidth = ""260px"","
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"validationConfigurations = { @ValidationConfiguration(validationImplementation = ""blUriPropertyValidator""),"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"@ValidationConfiguration(validationImplementation = ""blUniqueValueValidator"","
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"configurationItems = { @ConfigurationItem(itemName = ConfigurationItem.ERROR_MESSAGE, itemValue = ""This URL is already in use. Please provide a unique URL."")"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"}),"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"@OneToOne(targetEntity = SkuImpl.class, cascade = { CascadeType.ALL })"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,@Cascade(value = { org.hibernate.annotations.CascadeType.ALL })
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"@OneToMany(mappedBy = ""product"", targetEntity = CrossSaleProductImpl.class, cascade = { CascadeType.ALL })"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"@Cascade(value = { org.hibernate.annotations.CascadeType.ALL, org.hibernate.annotations.CascadeType.DELETE_ORPHAN })"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"maintainedAdornedTargetFields = { ""promotionMessage"" },"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"gridVisibleFields = { ""defaultSku.name"", ""promotionMessage"" })"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"@OneToMany(mappedBy = ""product"", targetEntity = UpSaleProductImpl.class, cascade = { CascadeType.ALL })"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"@Index(name = ""PRODUCT_CATEGORY_INDEX"", columnNames = { ""DEFAULT_CATEGORY_ID"" })"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"cascade = { CascadeType.MERGE, CascadeType.PERSIST, CascadeType.REFRESH })"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"gridVisibleFields = { ""name"" })"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"@OneToMany(mappedBy = ""product"", targetEntity = ProductAttributeImpl.class, cascade = { CascadeType.ALL }, orphanRemoval = true)"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"@Cache(usage=CacheConcurrencyStrategy.READ_WRITE, region=""blProducts"")"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,"gridVisibleFields = { ""name"", ""type"", ""required"" })"
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,while(it.hasNext()){
e9d18769de0788a454b358ded232ca7d14d947a1,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,productAttributeList.addAll((List)productAttributes.get(theKey));
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import java.math.BigDecimal;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import java.util.ArrayList;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import java.util.Collections;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import java.util.Comparator;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import java.util.Date;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import java.util.HashMap;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import java.util.HashSet;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import java.util.Iterator;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import java.util.List;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import java.util.Map;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import java.util.Set;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,*
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"columnNames = {""URL"", ""URL_KEY""}"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,{
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeOverride(name = ""defaultSku.displayTemplate"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeOverride(name = ""defaultSku.urlKey"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeOverride(name = ""defaultSku.retailPrice"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeOverride(name = ""defaultSku.name"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeOverride(name = ""defaultSku.activeEndDate"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@ValidationConfiguration(
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"validationImplementation = ""blAfterStartDateValidator"","
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,configurationItems = {
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@ConfigurationItem(itemName = ""otherField"", itemValue = ""defaultSku.activeStartDate"")"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,})
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeOverride(name = ""defaultSku.auditable.createdBy"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeOverride(name = ""defaultSku.auditable.dateCreated"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeOverride(name = ""defaultSku.auditable.dateUpdated"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeOverride(name = ""defaultSku.auditable.updatedBy"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,/**
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,* The Constant serialVersionUID.
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,*/
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,* The id.
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@AdminPresentation(
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"friendlyName = ""ProductImpl_Product_Url"","
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"group = GroupName.General,"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"order = FieldOrder.URL,"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"prominent = true,"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"gridOrder = 3,"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"columnWidth = ""260px"","
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,validationConfigurations = {
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@ValidationConfiguration(validationImplementation = ""blUriPropertyValidator""),"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"validationImplementation = ""blUniqueValueValidator"","
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@ConfigurationItem(
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"itemName = ConfigurationItem.ERROR_MESSAGE,"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"itemValue = ""This URL is already in use. Please provide a unique URL."""
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,)
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,}
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"),"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@OneToOne(targetEntity = SkuImpl.class, cascade = {CascadeType.ALL})"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@Cascade(value = {org.hibernate.annotations.CascadeType.ALL})
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@OneToMany(mappedBy = ""product"", targetEntity = CrossSaleProductImpl.class, cascade = {CascadeType.ALL})"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Cascade(value = {org.hibernate.annotations.CascadeType.ALL, org.hibernate.annotations.CascadeType.DELETE_ORPHAN})"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"maintainedAdornedTargetFields = {""promotionMessage""},"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"gridVisibleFields = {""defaultSku.name"", ""promotionMessage""})"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@OneToMany(mappedBy = ""product"", targetEntity = UpSaleProductImpl.class, cascade = {CascadeType.ALL})"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Index(name = ""PRODUCT_CATEGORY_INDEX"", columnNames = {""DEFAULT_CATEGORY_ID""})"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"cascade = {CascadeType.MERGE, CascadeType.PERSIST, CascadeType.REFRESH})"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"gridVisibleFields = {""name""})"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@OneToMany(mappedBy = ""product"", targetEntity = ProductAttributeImpl.class, cascade = {CascadeType.ALL}, orphanRemoval = true)"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region = ""blProducts"")"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"gridVisibleFields = {""name"", ""type"", ""required""})"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,while (it.hasNext()) {
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,productAttributeList.addAll((List) productAttributes.get(theKey));
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentationMap;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import java.math.BigDecimal;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import java.util.ArrayList;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import java.util.Collection;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import java.util.Collections;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import java.util.Comparator;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import java.util.Date;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import java.util.HashMap;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import java.util.HashSet;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import java.util.Iterator;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import java.util.List;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import java.util.Map;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import java.util.Set;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.MapKey;
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"columnNames = { ""URL"", ""URL_KEY"" }"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,{
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeOverride(name = ""defaultSku.displayTemplate"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeOverride(name = ""defaultSku.urlKey"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeOverride(name = ""defaultSku.retailPrice"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeOverride(name = ""defaultSku.name"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeOverride(name = ""defaultSku.activeEndDate"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@ValidationConfiguration(
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"validationImplementation = ""blAfterStartDateValidator"","
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,configurationItems = {
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@ConfigurationItem(itemName = ""otherField"", itemValue = ""defaultSku.activeStartDate"")"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,})
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeOverride(name = ""defaultSku.auditable.createdBy"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeOverride(name = ""defaultSku.auditable.dateCreated"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeOverride(name = ""defaultSku.auditable.dateUpdated"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeOverride(name = ""defaultSku.auditable.updatedBy"", mergeEntries ="
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,/** The Constant serialVersionUID. */
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,/** The id. */
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""ProductImpl_Product_Url"","
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"group = GroupName.General, order = FieldOrder.URL,"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"prominent = true, gridOrder = 3, columnWidth = ""260px"","
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"validationConfigurations = { @ValidationConfiguration(validationImplementation = ""blUriPropertyValidator""),"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@ValidationConfiguration(validationImplementation = ""blUniqueValueValidator"","
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"configurationItems = { @ConfigurationItem(itemName = ConfigurationItem.ERROR_MESSAGE, itemValue = ""This URL is already in use. Please provide a unique URL."")"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"}),"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@OneToOne(targetEntity = SkuImpl.class, cascade = { CascadeType.ALL })"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@Cascade(value = { org.hibernate.annotations.CascadeType.ALL })
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@OneToMany(mappedBy = ""product"", targetEntity = CrossSaleProductImpl.class, cascade = { CascadeType.ALL })"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Cascade(value = { org.hibernate.annotations.CascadeType.ALL, org.hibernate.annotations.CascadeType.DELETE_ORPHAN })"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"maintainedAdornedTargetFields = { ""promotionMessage"" },"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"gridVisibleFields = { ""defaultSku.name"", ""promotionMessage"" })"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@OneToMany(mappedBy = ""product"", targetEntity = UpSaleProductImpl.class, cascade = { CascadeType.ALL })"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name = ""PRODUCT_CATEGORY_INDEX"", columnNames = { ""DEFAULT_CATEGORY_ID"" })"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"cascade = { CascadeType.MERGE, CascadeType.PERSIST, CascadeType.REFRESH })"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"gridVisibleFields = { ""name"" })"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@OneToMany(mappedBy = ""product"", targetEntity = ProductAttributeImpl.class, cascade = { CascadeType.ALL }, orphanRemoval = true)"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Cache(usage=CacheConcurrencyStrategy.READ_WRITE, region=""blProducts"")"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"gridVisibleFields = { ""name"", ""type"", ""required"" })"
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,while(it.hasNext()){
e9d18769de0788a454b358ded232ca7d14d947a1,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,productAttributeList.addAll((List)productAttributes.get(theKey));
af496925cbd0fef6c7bce50dd72738407f023d69,713900318ac303ae31a8314be722d5aab7beb4a5,added,0,public static final int TargetMinSubTotal = 4000;
af496925cbd0fef6c7bce50dd72738407f023d69,713900318ac303ae31a8314be722d5aab7beb4a5,deleted,1,public static final int TargetMinSubTotal = 3000;
7366ec7ff3b1c59556b811664c12ae55ae0773a0,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,public List<PromotionMessage> getActivePromotionMessagesByType(PromotionMessageType promotionMessageType);
7366ec7ff3b1c59556b811664c12ae55ae0773a0,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,public boolean hasPromotionMessageOfType(PromotionMessageType type);
7366ec7ff3b1c59556b811664c12ae55ae0773a0,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,List<PromotionMessage> getActivePromotionMessagesByType(PromotionMessageType promotionMessageType);
d19794a2f8ce4f971e866f10a69b2a9c50d3a053,8ecb846dc0086d78fd52547459197a73d8d2d009,added,0,import org.broadleafcommerce.core.order.service.call.OrderItemRequestDTO;
d19794a2f8ce4f971e866f10a69b2a9c50d3a053,8ecb846dc0086d78fd52547459197a73d8d2d009,added,0,List<OrderItemRequestDTO> itemsToReprice = new ArrayList<OrderItemRequestDTO>();
d19794a2f8ce4f971e866f10a69b2a9c50d3a053,8ecb846dc0086d78fd52547459197a73d8d2d009,added,0,OrderItemRequestDTO itemRequest = new OrderItemRequestDTO();
d19794a2f8ce4f971e866f10a69b2a9c50d3a053,8ecb846dc0086d78fd52547459197a73d8d2d009,added,0,for(OrderItemRequestDTO itemRequest: itemsToReprice){
d19794a2f8ce4f971e866f10a69b2a9c50d3a053,8ecb846dc0086d78fd52547459197a73d8d2d009,deleted,1,import org.broadleafcommerce.core.order.service.call.AddToCartItem;
d19794a2f8ce4f971e866f10a69b2a9c50d3a053,8ecb846dc0086d78fd52547459197a73d8d2d009,deleted,1,List<AddToCartItem> itemsToReprice = new ArrayList<AddToCartItem>();
d19794a2f8ce4f971e866f10a69b2a9c50d3a053,8ecb846dc0086d78fd52547459197a73d8d2d009,deleted,1,AddToCartItem itemRequest = new AddToCartItem();
d19794a2f8ce4f971e866f10a69b2a9c50d3a053,8ecb846dc0086d78fd52547459197a73d8d2d009,deleted,1,for(AddToCartItem itemRequest: itemsToReprice){
2723180fbf8cf91ea2782ee5a20b36077d71fdf9,843d6e33b01967c14878ff604fab842752481e3a,added,0,import org.broadleafcommerce.common.util.StringUtil;
2723180fbf8cf91ea2782ee5a20b36077d71fdf9,843d6e33b01967c14878ff604fab842752481e3a,added,0,"LOG.info(""Unable to parse and/or execute the mvel expression ("" + StringUtil.sanitize(rule)"
2723180fbf8cf91ea2782ee5a20b36077d71fdf9,843d6e33b01967c14878ff604fab842752481e3a,deleted,1,import org.apache.commons.collections4.CollectionUtils;
2723180fbf8cf91ea2782ee5a20b36077d71fdf9,843d6e33b01967c14878ff604fab842752481e3a,deleted,1,import org.broadleafcommerce.common.util.BLCStringUtils;
2723180fbf8cf91ea2782ee5a20b36077d71fdf9,843d6e33b01967c14878ff604fab842752481e3a,deleted,1,"LOG.info(""Unable to parse and/or execute the mvel expression ("" + BLCStringUtils.sanitize(rule)"
6f7f15cb9cb88d4f368fd7a0ce95d9120193e9a6,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.dao.GenericEntityDao;
6f7f15cb9cb88d4f368fd7a0ce95d9120193e9a6,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import org.broadleafcommerce.common.util.HibernateUtils;
6f7f15cb9cb88d4f368fd7a0ce95d9120193e9a6,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDao;
6f7f15cb9cb88d4f368fd7a0ce95d9120193e9a6,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import org.hibernate.proxy.HibernateProxy;
6f7f15cb9cb88d4f368fd7a0ce95d9120193e9a6,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,genericEntityDao.getEntityManager().detach(offer);
6f7f15cb9cb88d4f368fd7a0ce95d9120193e9a6,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.dao.GenericEntityDao;
6f7f15cb9cb88d4f368fd7a0ce95d9120193e9a6,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import org.broadleafcommerce.common.util.HibernateUtils;
6f7f15cb9cb88d4f368fd7a0ce95d9120193e9a6,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDao;
6f7f15cb9cb88d4f368fd7a0ce95d9120193e9a6,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import org.hibernate.proxy.HibernateProxy;
6f7f15cb9cb88d4f368fd7a0ce95d9120193e9a6,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,genericEntityDao.getEntityManager().detach(offer);
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import java.util.Collection;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,public Boolean getHasPromotionMessage();
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,public void setHasPromotionMessage(Boolean hasPromotionMessage);
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,public List<OfferPromotionMessageXref> getPromotionMessageXrefs();
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,public void setPromotionMessageXrefs(List<OfferPromotionMessageXref> promotionMessageXrefs);
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,public List<PromotionMessage> getActivePromotionMessagesByType(PromotionMessageType promotionMessageType);
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,public boolean hasPromotionMessageOfType(PromotionMessageType type);
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.core.promotionMessage.domain.PromotionMessageImpl;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@Column(name = ""HAS_PROMOTION_MESSAGE"")"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@AdminPresentation(friendlyName = ""OfferImpl_HasPromotionMessage"","
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"group = GroupName.Marketing, defaultValue = ""false"")"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,protected Boolean hasPromotionMessage = false;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@OneToMany(mappedBy = ""offer"", targetEntity = OfferPromotionMessageXrefImpl.class, cascade = {CascadeType.ALL})"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region=""blOffers"")"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@AdminPresentationCollection(friendlyName = ""OfferImpl_PromotionMessages"","
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"group = GroupName.Marketing,"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,addType = AddMethodType.PERSIST)
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,protected List<OfferPromotionMessageXref> promotionMessageXrefs = new ArrayList<>();
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,public List<OfferPromotionMessageXref> getPromotionMessageXrefs() {
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,return promotionMessageXrefs;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,}
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,@Override
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,public List<PromotionMessage> getActivePromotionMessagesByType(PromotionMessageType desiredPromotionMessageType) {
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,List filteredPromotionMessages = new ArrayList();
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,for (OfferPromotionMessageXref xref : getPromotionMessageXrefs()) {
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,PromotionMessage promotionMessage = xref.getPromotionMessage();
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"boolean isDesiredType = StringUtils.equals(desiredPromotionMessageType.getType(), xref.getMessageType());"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"boolean typeIsTargetsOrQualifiers = StringUtils.equals(PromotionMessageType.TARGETS_OR_QUALIFIERS.getType(), xref.getMessageType());"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,if (promotionMessage.isActive() && (isDesiredType || typeIsTargetsOrQualifiers)) {
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,filteredPromotionMessages.add(promotionMessage);
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,return filteredPromotionMessages;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,public void setPromotionMessageXrefs(List<OfferPromotionMessageXref> promotionMessageXrefs) {
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,this.promotionMessageXrefs = promotionMessageXrefs;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,public Boolean getHasPromotionMessage() {
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,return hasPromotionMessage == null ? Boolean.FALSE : hasPromotionMessage;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,public void setHasPromotionMessage(Boolean hasPromotionMessage) {
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,this.hasPromotionMessage = hasPromotionMessage;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,public boolean hasPromotionMessageOfType(PromotionMessageType type) {
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,if (!getHasPromotionMessage()) return false;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,List<PromotionMessage> promotionMessages = getActivePromotionMessagesByType(type);
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,return CollectionUtils.isNotEmpty(promotionMessages);
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,/*
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,* #%L
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,* broadleaf-enterprise
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,* %%
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,* Copyright (C) 2009 - 2016 Broadleaf Commerce
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"* Licensed under the Broadleaf Fair Use License Agreement, Version 1.0"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"* (the ""Fair Use License"" located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,* unless the restrictions on use therein are violated and require payment to Broadleaf in which case
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"* the Broadleaf End User License Agreement (EULA), Version 1.1"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"* (the ""Commercial License"" located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,* shall apply.
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,*
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"* Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the ""Custom License"")"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,* between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,* #L%
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,*/
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,package org.broadleafcommerce.core.offer.domain;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.common.extensibility.jpa.copy.DirectCopyTransform;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.common.extensibility.jpa.copy.DirectCopyTransformMember;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.common.extensibility.jpa.copy.DirectCopyTransformTypes;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentation;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentationClass;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.common.presentation.ConfigurationItem;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.common.presentation.PopulateToOneFieldsEnum;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.common.presentation.RequiredOverride;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.common.presentation.ValidationConfiguration;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.common.presentation.client.SupportedFieldType;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.common.presentation.client.VisibilityEnum;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.common.presentation.override.AdminPresentationMergeEntry;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.common.presentation.override.AdminPresentationMergeOverride;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.common.presentation.override.AdminPresentationMergeOverrides;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.common.presentation.override.PropertyType;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.core.promotionMessage.domain.PromotionMessage;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.core.promotionMessage.domain.PromotionMessageAdminPresentation;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.core.promotionMessage.domain.PromotionMessageImpl;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.hibernate.annotations.CacheConcurrencyStrategy;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.hibernate.annotations.GenericGenerator;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.hibernate.annotations.Index;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.hibernate.annotations.Parameter;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import javax.persistence.CascadeType;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import javax.persistence.Column;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import javax.persistence.Entity;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import javax.persistence.GeneratedValue;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import javax.persistence.Id;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import javax.persistence.Inheritance;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import javax.persistence.InheritanceType;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import javax.persistence.JoinColumn;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import javax.persistence.ManyToOne;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import javax.persistence.Table;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,/**
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,* @author Chris Kittrell (ckittrell)
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,@Entity
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,@Inheritance(strategy = InheritanceType.JOINED)
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@Table(name=""BLC_OFFER_PROMO_MSG_XREF"")"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@org.hibernate.annotations.Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region=""blOffers"")"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,@AdminPresentationClass(populateToOneFields = PopulateToOneFieldsEnum.TRUE)
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,@AdminPresentationMergeOverrides({
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@AdminPresentationMergeOverride(name = ""promotionMessage.endDate"", mergeEntries ="
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.VALIDATIONCONFIGURATIONS, validationConfigurations = {"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,@ValidationConfiguration(
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"validationImplementation = ""blAfterStartDateValidator"","
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,configurationItems = {
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@ConfigurationItem(itemName = ""otherField"", itemValue = ""promotionMessage.startDate"")"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,})
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,}))
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,@DirectCopyTransform({
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@DirectCopyTransformMember(templateTokens = DirectCopyTransformTypes.SANDBOX, skipOverlaps=true),"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,@DirectCopyTransformMember(templateTokens = DirectCopyTransformTypes.MULTITENANT_CATALOG)
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,public class OfferPromotionMessageXrefImpl implements OfferPromotionMessageXref {
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,private static final long serialVersionUID = 1L;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,@Id
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@GeneratedValue(generator = ""OfferPromotionMessageXrefId"")"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,@GenericGenerator(
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"name = ""OfferPromotionMessageXrefId"","
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"strategy = ""org.broadleafcommerce.common.persistence.IdOverrideTableGenerator"","
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,parameters = {
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@Parameter(name = ""segment_value"", value = ""OfferPromotionMessageXrefImpl""),"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@Parameter(name = ""entity_name"", value = ""org.broadleafcommerce.core.offer.domain.OfferPromotionMessageXrefImpl"")"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@Column(name = ""OFFER_PROMO_MSG_XREF_ID"")"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,protected Long id;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@ManyToOne(targetEntity = OfferImpl.class, optional=false, cascade = CascadeType.REFRESH)"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@JoinColumn(name = ""OFFER_ID"")"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@AdminPresentation(excluded = true, visibility = VisibilityEnum.HIDDEN_ALL)"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,protected Offer offer;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@ManyToOne(targetEntity = PromotionMessageImpl.class,  optional=false, cascade = CascadeType.REFRESH)"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@JoinColumn(name = ""PROMOTION_MESSAGE_ID"")"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,protected PromotionMessage promotionMessage;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@Column(name = ""MESSAGE_TYPE"", nullable=false)"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@Index(name=""MESSAGE_TYPE_INDEX"", columnNames={""MESSAGE_TYPE""})"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@AdminPresentation(friendlyName = ""OfferPromotionMessageXrefImpl_MessageType"","
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"group = PromotionMessageAdminPresentation.GroupName.Placement,"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"order = PromotionMessageAdminPresentation.FieldOrder.MessagePlacement - 500,"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"fieldType= SupportedFieldType.BROADLEAF_ENUMERATION,"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"broadleafEnumeration=""org.broadleafcommerce.core.promotionMessage.domain.type.PromotionMessageType"","
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"defaultValue = ""TARGETS_OR_QUALIFIERS"","
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"requiredOverride = RequiredOverride.REQUIRED,"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"prominent = true, gridOrder = PromotionMessageAdminPresentation.FieldOrder.Message + 1000)"
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,protected String messageType;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,@Override
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,public Long getId() {
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,return id;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,}
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,public void setId(Long id) {
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,this.id = id;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,public Offer getOffer() {
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,return offer;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,public void setOffer(Offer offer) {
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,this.offer = offer;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,public PromotionMessage getPromotionMessage() {
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,return promotionMessage;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,public void setPromotionMessage(PromotionMessage promotionMessage) {
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,this.promotionMessage = promotionMessage;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,public String getMessageType() {
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,return messageType;
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,public void setMessageType(String messageType) {
f39c89d1794836fb5b3ed6ad6260583066213ddf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,this.messageType = messageType;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"order = PromotionMessageAdminPresentation.GroupOrder.General,"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"untitled = true),"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"order = PromotionMessageAdminPresentation.GroupOrder.Placement,"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"order = PromotionMessageAdminPresentation.GroupOrder.ActiveRange,"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"tooltip = ""PromotionMessageImpl_Offer_Active_Range_Tooltip"","
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,column = 1)
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,}
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"),"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"@AdminTabPresentation(name = PromotionMessageAdminPresentation.TabName.Media,"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"order = PromotionMessageAdminPresentation.TabOrder.Media,"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,groups = {
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"@AdminGroupPresentation(name = PromotionMessageAdminPresentation.GroupName.Media,"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"order = PromotionMessageAdminPresentation.GroupOrder.Media,"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,untitled = true)
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"public static final String Media = ""PromotionMessageImpl_Media"";"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,public static final int Media = 2000;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,public static final int Media = 4000;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"order = PromotionMessageAdminPresentation.GroupOrder.General,"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"untitled = true),"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"order = PromotionMessageAdminPresentation.GroupOrder.Placement,"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"order = PromotionMessageAdminPresentation.GroupOrder.ActiveRange,"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"tooltip = ""PromotionMessageImpl_Offer_Active_Range_Tooltip"","
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,column = 1)
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,import org.broadleafcommerce.cms.file.domain.StaticAssetAdminPresentation;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,import org.broadleafcommerce.common.extensibility.jpa.clone.ClonePolicy;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,import org.broadleafcommerce.common.media.domain.Media;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,import org.broadleafcommerce.common.media.domain.MediaImpl;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,import org.broadleafcommerce.common.presentation.override.AdminPresentationMergeEntry;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,import org.broadleafcommerce.common.presentation.override.AdminPresentationMergeOverride;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,import org.broadleafcommerce.common.presentation.override.AdminPresentationMergeOverrides;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,import org.broadleafcommerce.common.presentation.override.AdminPresentationOverride;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,import org.broadleafcommerce.common.presentation.override.PropertyType;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region=""blStandardElements"")"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,@AdminPresentationMergeOverrides({
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"@AdminPresentationMergeOverride(name = ""promotionMessageMedia.url"", mergeEntries = {"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.EXCLUDED, booleanOverrideValue = false),"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.TAB, overrideValue = PromotionMessageAdminPresentation.TabName.Media),"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.TABORDER, intOverrideValue = PromotionMessageAdminPresentation.TabOrder.Media),"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.GROUP, overrideValue = PromotionMessageAdminPresentation.GroupName.Media),"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.FRIENDLYNAME, overrideValue = ""PromotionMessageImpl_Media""),"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.REQUIREDOVERRIDE, overrideValue = ""NOT_REQUIRED""),"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.PROMINENT, booleanOverrideValue = false)"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"}),"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"@AdminPresentationMergeOverride(name = ""promotionMessageMedia.title"", mergeEntries = {"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"@AdminPresentationMergeOverride(name = ""promotionMessageMedia.altText"", mergeEntries = {"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"@AdminPresentationMergeOverride(name = ""promotionMessageMedia.tags"", mergeEntries = {"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"@AdminPresentationMergeOverride(name = ""promotionMessageMedia.auditable.createdBy"", mergeEntries = {"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.VISIBILITY, overrideValue = ""HIDDEN_ALL"")"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"@AdminPresentationMergeOverride(name = ""promotionMessageMedia.auditable.updatedBy"", mergeEntries = {"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"@AdminPresentationMergeOverride(name = ""promotionMessageMedia.auditable.dateCreated"", mergeEntries = {"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"@AdminPresentationMergeOverride(name = ""promotionMessageMedia.auditable.dateUpdated"", mergeEntries = {"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,})
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"tab = TabName.General, tabOrder = TabOrder.General,"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"@ManyToOne(targetEntity = MediaImpl.class, cascade = {CascadeType.MERGE, CascadeType.PERSIST})"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"@JoinColumn(name = ""MEDIA_ID"")"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,@ClonePolicy
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,protected Media promotionMessageMedia;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"group = GroupName.Placement, groupOrder = GroupOrder.Placement, order = FieldOrder.MessagePlacement,"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"fieldType= SupportedFieldType.BROADLEAF_ENUMERATION,"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"broadleafEnumeration=""org.broadleafcommerce.core.promotionMessage.domain.type.PromotionMessagePlacementType"","
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"defaultValue = ""ALL"","
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,requiredOverride = RequiredOverride.REQUIRED)
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"group = GroupName.Placement, groupOrder = GroupOrder.Placement, order = FieldOrder.Locale)"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,public Media getPromotionMessageMedia() {
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,public void setPromotionMessageMedia(Media promotionMessageMedia) {
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,cloned.setPromotionMessageMedia(getPromotionMessageMedia());
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentationMap;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentationMapField;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentationMapFields;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentationMapKey;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.common.presentation.client.LookupType;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.core.catalog.domain.Product;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.broadleafcommerce.core.catalog.domain.ProductImpl;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import org.hibernate.annotations.BatchSize;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import java.util.HashMap;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import java.util.Map;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import javax.persistence.MapKey;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,import javax.persistence.OneToMany;
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region=""blOffers"")"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@OneToMany(mappedBy = ""promotionMessage"", targetEntity = PromotionMessageMediaXrefImpl.class, cascade = { CascadeType.ALL }, orphanRemoval = true)"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@MapKey(name = ""key"")"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region = ""blOffers"")"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,@BatchSize(size = 50)
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,@AdminPresentationMap(
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"excluded = true,"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"mediaField = ""media.url"","
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"toOneTargetProperty = ""media"","
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"toOneParentProperty = ""promotionMessage"","
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,keys = {
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"@AdminPresentationMapKey(keyName = ""primary"", friendlyKeyName = ""mediaPrimary"")"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,}
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,)
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,@AdminPresentationMapFields(
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,mapDisplayFields = {
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,@AdminPresentationMapField(
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"fieldName = ""primary"","
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"fieldPresentation = @AdminPresentation(friendlyName = ""PromotionMessageImpl_Media"","
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"group = GroupName.General, groupOrder = GroupOrder.General, order = FieldOrder.Media,"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,fieldType = SupportedFieldType.MEDIA)
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,})
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"protected Map<String, PromotionMessageMediaXref> promotionMessageMedia = new HashMap<>();"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"group = GroupName.Placement, groupOrder = GroupOrder.Placement, order = FieldOrder.MessagePlacement,"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"fieldType= SupportedFieldType.BROADLEAF_ENUMERATION,"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"broadleafEnumeration=""org.broadleafcommerce.core.promotionMessage.domain.type.PromotionMessagePlacementType"","
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"defaultValue = ""ALL"","
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,requiredOverride = RequiredOverride.REQUIRED)
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"group = GroupName.Placement, groupOrder = GroupOrder.Placement, order = FieldOrder.Locale)"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"public Map<String, PromotionMessageMediaXref> getPromotionMessageMedia() {"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"public void setPromotionMessageMedia(Map<String, PromotionMessageMediaXref> promotionMessageMedia) {"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"for(Map.Entry<String, PromotionMessageMediaXref> entry : promotionMessageMedia.entrySet()){"
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,PromotionMessageMediaXrefImpl clonedEntry = ((PromotionMessageMediaXrefImpl)entry.getValue()).createOrRetrieveCopyInstance(context).getClone();
d932d6718aa3bf74344702a68fa96da7e9d62fcf,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"cloned.getPromotionMessageMedia().put(entry.getKey(),clonedEntry);"
c732b1392163af1b8fa085b7f153849ef13771cb,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"defaultValue = ""EVERYWHERE"","
c732b1392163af1b8fa085b7f153849ef13771cb,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"defaultValue = ""ALL"","
c732b1392163af1b8fa085b7f153849ef13771cb,04661fb3411d527ead90ce09e3a356c73f753cfa,added,0,"public static final PromotionMessagePlacementType EVERYWHERE = new PromotionMessagePlacementType(""EVERYWHERE"", ""Everywhere"", 5000);"
c732b1392163af1b8fa085b7f153849ef13771cb,04661fb3411d527ead90ce09e3a356c73f753cfa,deleted,1,"public static final PromotionMessagePlacementType ALL = new PromotionMessagePlacementType(""ALL"", ""All of the above"", 5000);"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,import org.broadleafcommerce.common.persistence.Status;
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,.withPredicateProvider(new PredicateProvider() {
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,@Override
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"public Predicate buildPredicate(CriteriaBuilder builder, FieldPathBuilder fieldPathBuilder,"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"From root, String ceilingEntity, String fullPropertyName,"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"Path explicitPath, List directValues) {"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,return explicitPath.in(directValues);
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,}
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,)
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"""more than "" + queryLimit + "" products found to belong to the selected default categories(%s). This is a "" +"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"""filter query limitation."", joined));"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,.withDirectFilterValues(new EmptyFilterValues())
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,.withRestriction(new Restriction()
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"public Predicate buildPredicate(CriteriaBuilder builder,"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"FieldPathBuilder fieldPathBuilder, From root,"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"String ceilingEntity,"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"String fullPropertyName, Path explicitPath,"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,List directValues) {
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"root.fetch(""defaultSku"", JoinType.LEFT);"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"root.fetch(""defaultCategory"", JoinType.LEFT);"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,return null;
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,})
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,));
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"(!cto.getCriteriaMap().containsKey(""id"") || CollectionUtils.isEmpty(cto.getCriteriaMap().get(""id"").getFilterValues()))) {"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"Product adminInstance = getAdminInstance(persistencePackage, dynamicEntityDao, helper, entity);"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"removeProduct(persistencePackage, adminInstance, helper);"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"protected Product getAdminInstance(PersistencePackage persistencePackage, DynamicEntityDao dynamicEntityDao, RecordHelper helper,"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,Entity entity) throws ClassNotFoundException {
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,PersistencePerspective persistencePerspective = persistencePackage.getPersistencePerspective();
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"Map<String, FieldMetadata> adminProperties = helper.getSimpleMergedProperties(Product.class.getName(), persistencePerspective);"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"Object primaryKey = helper.getPrimaryKey(entity, adminProperties);"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,String type = entity.getType()[0];
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"Product adminInstance = (Product) dynamicEntityDao.retrieve(Class.forName(type), primaryKey);"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,return adminInstance;
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,"protected void removeProduct(PersistencePackage persistencePackage, Product adminInstance, RecordHelper helper) throws ServiceException {"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,added,0,catalogService.removeProduct(adminInstance);
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,import org.broadleafcommerce.common.util.ModulePresentUtil;
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,.withPredicateProvider(new PredicateProvider() {
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,@Override
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"public Predicate buildPredicate(CriteriaBuilder builder, FieldPathBuilder fieldPathBuilder,"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"From root, String ceilingEntity, String fullPropertyName,"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"Path explicitPath, List directValues) {"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,return explicitPath.in(directValues);
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,}
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,)
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"""more than "" + queryLimit + "" products found to belong to the selected default categories(%s). This is a "" +"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"""filter query limitation."", joined));"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,.withDirectFilterValues(new EmptyFilterValues())
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,.withRestriction(new Restriction()
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"public Predicate buildPredicate(CriteriaBuilder builder,"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"FieldPathBuilder fieldPathBuilder, From root,"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"String ceilingEntity,"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"String fullPropertyName, Path explicitPath,"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,List directValues) {
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"root.fetch(""defaultSku"", JoinType.LEFT);"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"root.fetch(""defaultCategory"", JoinType.LEFT);"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,return null;
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,})
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,));
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"(!cto.getCriteriaMap().containsKey(""id"") || CollectionUtils.isEmpty(cto.getCriteriaMap().get(""id"").getFilterValues()))) {"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,PersistencePerspective persistencePerspective = persistencePackage.getPersistencePerspective();
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"Map<String, FieldMetadata> adminProperties = helper.getSimpleMergedProperties(Product.class.getName(), persistencePerspective);"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"Object primaryKey = helper.getPrimaryKey(entity, adminProperties);"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"Product adminInstance = (Product) dynamicEntityDao.retrieve(Class.forName(entity.getType()[0]), primaryKey);"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,if(ModulePresentUtil.isPresent(ModulePresentUtil.BroadleafModuleEnum.ENTERPRISE)) {
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"enterpriseRemove(persistencePackage, adminInstance, helper);"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,} else {
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,catalogService.removeProduct(adminInstance);
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"protected void enterpriseRemove(PersistencePackage persistencePackage, Product adminInstance, RecordHelper helper) throws ServiceException {"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,if (extensionManager != null) {
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,"extensionManager.getProxy().manageRemove(persistencePackage, adminInstance);"
e4a7e6240a1dd778f59272b0453c61918a97a085,d84cd698e4cffef5d0dddfd2148c3d009178e78e,deleted,1,helper.getCompatibleModule(OperationType.BASIC).remove(persistencePackage);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,/*
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* #%L
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* BroadleafCommerce Integration
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* %%
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* Copyright (C) 2009 - 2016 Broadleaf Commerce
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"* Licensed under the Broadleaf Fair Use License Agreement, Version 1.0"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"* (the ""Fair Use License"" located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* unless the restrictions on use therein are violated and require payment to Broadleaf in which case
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"* the Broadleaf End User License Agreement (EULA), Version 1.1"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"* (the ""Commercial License"" located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* shall apply.
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,*
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"* Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the ""Custom License"")"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* #L%
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,*/
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,package org.broadleafcommerce.core.order.service.legacy;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.order.domain.Order;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.order.domain.OrderItem;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.order.service.call.MergeCartResponse;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.order.service.type.OrderStatus;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.pricing.service.exception.PricingException;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.profile.core.domain.Customer;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.springframework.transaction.annotation.Transactional;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.testng.annotations.Test;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import java.util.ArrayList;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import java.util.List;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public class LegacyCartTest extends LegacyOrderBaseTest {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""testCartAndNamedOrderLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,@Transactional
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void testMoveAllItemsToCartFromNamedOrder() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Order namedOrder = setUpNamedOrder();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,List<OrderItem> namedOrderItems = new ArrayList<OrderItem>();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,namedOrderItems.addAll(namedOrder.getOrderItems());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Order cart = cartService.createNewCartForCustomer(namedOrder.getCustomer());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,cart = cartService.moveAllItemsToCartFromNamedOrder(namedOrder);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert namedOrderItems.equals(cart.getOrderItems());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert namedOrder.getOrderItems().size() == 0;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,}
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void testAddAllItemsToCartFromNamedOrder() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,cartService.setMoveNamedOrderItems(false);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,cart = cartService.addAllItemsToCartFromNamedOrder(namedOrder);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,cartService.setMoveNamedOrderItems(true);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void testAddAllItemsToCartFromNamedOrderWithoutExistingCart() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Order cart = cartService.addAllItemsToCartFromNamedOrder(namedOrder);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void testAddItemToCartFromNamedOrder() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"OrderItem movedItem = cartService.moveItemToCartFromNamedOrder(namedOrder, namedOrderItems.get(0));"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert movedItem != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert cart.getOrderItems().size() == 1;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void testMoveItemToCartFromNamedOrder() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"List<Order> customerNamedOrders = cartService.findOrdersForCustomer(namedOrder.getCustomer(), OrderStatus.NAMED);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert customerNamedOrders.size() == 0;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void testMoveItemToCartFromNamedOrderWithoutExistingCart() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Order cart = cartService.findCartForCustomer(namedOrder.getCustomer());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void testMoveItemToCartFromNamedOrderByIds() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"OrderItem movedItem = cartService.moveItemToCartFromNamedOrder(namedOrder.getCustomer().getId(),"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"namedOrder.getName(), namedOrderItems.get(0).getId(), namedOrderItems.get(0).getQuantity());"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""testMergeCartLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void testMergeToEmptyCart() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Order anonymousCart = setUpAnonymousCartWithInactiveSku();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Customer customer = customerService.saveCustomer(createNamedCustomer());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"MergeCartResponse response = cartService.mergeCart(customer, anonymousCart);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert response.getAddedItems().size() == 2;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert response.getOrder().getOrderItems().size() == 2;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert response.isMerged() == false;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert response.getRemovedItems().size() == 2;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void testMergeToExistingCart() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"//sets up anonymous cart with a DiscreteOrderItem, inactive DiscreteOrderItem, BundleOrderItem, and inactive BundleOrderItem"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"//sets up existing cart with a DiscreteOrderItem, inactive DiscreteOrderItem, BundleOrderItem, and inactive BundleOrderItem"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,initializeExistingCartWithInactiveSkuAndInactiveBundle(customer);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert response.getOrder().getOrderItems().size() == 4;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert response.isMerged();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert response.getRemovedItems().size() == 4;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void testMergeToExistingCartWithGiftWrapOrderItems() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,//FIXME: This test needs to be fixed
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"//sets up anonymous cart with two DiscreteOrderItems, and a GiftWrapOrderItem"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Order anonymousCart = setUpAnonymousCartWithGiftWrap();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,//sets up existing cart with two active DiscreteOrderItems
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,initializeExistingCart(customer);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert response.getAddedItems().size() == 3;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert response.getOrder().getOrderItems().size() == 5;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert response.getRemovedItems().size() == 0;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"//sets up anonymous cart with a DiscreteOrderItem, inactive DiscreteOrderItem and inactive GiftWrapOrderItem (due to inactive wrapped item)"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,anonymousCart = setUpAnonymousCartWithInactiveGiftWrap();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,customer = customerService.saveCustomer(createNamedCustomer());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"response = cartService.mergeCart(customer, anonymousCart);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert response.getAddedItems().size() == 1;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert response.getOrder().getOrderItems().size() == 3;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"//sets up anonymous cart with a DiscreteOrderItem, inactive DiscreteOrderItem and inactive GiftWrapOrderItem (due to inactive wrapped item) inside a BundleOrderItem"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,anonymousCart = setUpAnonymousCartWithInactiveBundleGiftWrap();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert response.getAddedItems().size() == 0;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert response.getRemovedItems().size() == 1;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"//sets up anonymous cart with active DiscreteOrderItems, and active GiftWrapOrderItem inside a BundleOrderItem"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,anonymousCart = setUpAnonymousCartWithBundleGiftWrap();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"//sets up anonymous cart with active DiscreteOrderItems, and active GiftWrapOrderItem inside a BundleOrderItem. Active OrderItems are also in the root of the order and the bundled GiftWrapOrderItem wraps the root OrderItems"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,anonymousCart = setUpAnonymousCartWithBundleGiftWrapReferringToRootItems();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"//sets up anonymous cart with two BundleOrderItems, one of which has a GiftWrapOrderItem. The GiftWrapOrderItem wraps the DiscreteOrderItems from the other bundle, which makes its bundle inactive."
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,anonymousCart = setUpAnonymousCartWithBundleGiftWrapReferringItemsInAnotherBundle();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,/*
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,* #%L
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,* BroadleafCommerce Integration
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,* %%
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,* Copyright (C) 2009 - 2016 Broadleaf Commerce
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"* Licensed under the Broadleaf Fair Use License Agreement, Version 1.0"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"* (the ""Fair Use License"" located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,* unless the restrictions on use therein are violated and require payment to Broadleaf in which case
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"* the Broadleaf End User License Agreement (EULA), Version 1.1"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"* (the ""Commercial License"" located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,* shall apply.
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,*
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"* Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the ""Custom License"")"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,* between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,* #L%
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,*/
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,package org.broadleafcommerce.core.order.service.legacy;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.common.money.Money;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.catalog.dao.SkuDao;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.catalog.domain.Category;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.catalog.domain.CategoryImpl;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.catalog.domain.Product;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.catalog.domain.ProductImpl;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.catalog.domain.Sku;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.catalog.domain.SkuImpl;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.order.FulfillmentGroupDataProvider;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.order.domain.BundleOrderItem;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.order.domain.DiscreteOrderItem;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.order.domain.FulfillmentGroup;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.order.domain.FulfillmentGroupImpl;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.order.domain.FulfillmentGroupItem;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.order.domain.Order;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.order.domain.OrderItem;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.order.service.OrderItemService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.order.service.call.BundleOrderItemRequest;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.order.service.call.DiscreteOrderItemRequest;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.order.service.call.FulfillmentGroupItemRequest;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.order.service.call.FulfillmentGroupRequest;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.order.service.exception.ItemNotFoundException;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.order.service.type.OrderStatus;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.payment.PaymentInfoDataProvider;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.payment.domain.OrderPayment;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.pricing.ShippingRateDataProvider;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.pricing.domain.ShippingRate;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.pricing.service.ShippingRateService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.pricing.service.exception.PricingException;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.core.pricing.service.workflow.type.ShippingServiceType;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.profile.core.domain.Address;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.profile.core.domain.Customer;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.profile.core.domain.CustomerAddress;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.broadleafcommerce.profile.core.domain.CustomerImpl;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.springframework.test.annotation.Rollback;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.springframework.transaction.annotation.Propagation;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.springframework.transaction.annotation.Transactional;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import org.testng.annotations.Test;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import java.math.BigDecimal;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import java.util.ArrayList;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import java.util.Calendar;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import java.util.List;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,import javax.annotation.Resource;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@SuppressWarnings(""deprecation"")"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public class LegacyOrderTest extends LegacyOrderBaseTest {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,private Long orderId = null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,private int numOrderItems = 0;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,private Long fulfillmentGroupId;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,private Long bundleOrderItemId;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Resource(name = ""blOrderItemService"")"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,private OrderItemService orderItemService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,@Resource
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,private SkuDao skuDao;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,private ShippingRateService shippingRateService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""createCartForCustomerLegacy"" }, dependsOnGroups = { ""readCustomer"", ""createPhone"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,@Transactional
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,@Rollback(false)
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void createCartForCustomer() {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"String userName = ""customer1"";"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,Customer customer = customerService.readCustomerByUsername(userName);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,Order order = cartService.createNewCartForCustomer(customer);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert order != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert order.getId() != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,this.orderId = order.getId();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,}
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""findCurrentCartForCustomerLegacy"" }, dependsOnGroups = { ""readCustomer"", ""createPhone"", ""createCartForCustomerLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void findCurrentCartForCustomer() {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,Order order = cartService.findCartForCustomer(customer);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""addItemToOrderLegacy"" }, dependsOnGroups = { ""findCurrentCartForCustomerLegacy"", ""createSku"", ""testCatalog"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,@Transactional(propagation = Propagation.REQUIRES_NEW)
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void addItemToOrder() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,numOrderItems++;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,Sku sku = skuDao.readFirstSku();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,Order order = cartService.findOrderById(orderId);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert sku.getId() != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,DiscreteOrderItemRequest itemRequest = new DiscreteOrderItemRequest();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,itemRequest.setQuantity(1);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,itemRequest.setSku(sku);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"DiscreteOrderItem item = (DiscreteOrderItem) cartService.addDiscreteItemToOrder(order, itemRequest);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert item != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert item.getQuantity() == numOrderItems;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert item.getSku() != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert item.getSku().equals(sku);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""addAnotherItemToOrderLegacy"" }, dependsOnGroups = { ""addItemToOrderLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void addAnotherItemToOrder() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,cartService.setAutomaticallyMergeLikeItems(true);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"DiscreteOrderItem item = (DiscreteOrderItem) cartService.addDiscreteItemToOrder(order, itemRequest, true);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert item.getQuantity() == 2;  // item-was merged with prior item.
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,order = cartService.findOrderById(orderId);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert(order.getOrderItems().size()==1);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert(order.getOrderItems().get(0).getQuantity()==2);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"This test is currently not supported, as the order service only supports like item merging"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,// re-price the order without automatically merging.
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,cartService.setAutomaticallyMergeLikeItems(false);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,DiscreteOrderItemRequest itemRequest2 = new DiscreteOrderItemRequest();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,itemRequest2.setQuantity(1);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,itemRequest2.setSku(sku);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"DiscreteOrderItem item2 = (DiscreteOrderItem) cartService.addDiscreteItemToOrder(order, itemRequest2, true);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert item2.getSku() != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert item2.getSku().equals(sku);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert item2.getQuantity() == 1;  // item-was not auto-merged with prior items.
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert(order.getOrderItems().size()==2);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert(order.getOrderItems().get(1).getQuantity()==1);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""addBundleToOrderLegacy"" }, dependsOnGroups = { ""addAnotherItemToOrderLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void addBundleToOrder() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,//numOrderItems++;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,BundleOrderItemRequest bundleRequest = new BundleOrderItemRequest();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,bundleRequest.setQuantity(1);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"bundleRequest.setName(""myBundle"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,bundleRequest.getDiscreteOrderItems().add(itemRequest);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"BundleOrderItem item = (BundleOrderItem) cartService.addBundleItemToOrder(order, bundleRequest);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,bundleOrderItemId = item.getId();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert item.getQuantity() == 1;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""removeBundleFromOrderLegacy"" }, dependsOnGroups = { ""addBundleToOrderLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void removeBundleFromOrder() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,List<OrderItem> orderItems = order.getOrderItems();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert orderItems.size() == numOrderItems;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,int startingSize = orderItems.size();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,BundleOrderItem bundleOrderItem = (BundleOrderItem) orderItemService.readOrderItemById(bundleOrderItemId);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert bundleOrderItem != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert bundleOrderItem.getDiscreteOrderItems() != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert bundleOrderItem.getDiscreteOrderItems().size() == 1;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"cartService.removeItemFromOrder(order, bundleOrderItem);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,List<OrderItem> items = order.getOrderItems();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert items != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert items.size() == startingSize - 1;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""getItemsForOrderLegacy"" }, dependsOnGroups = { ""removeBundleFromOrderLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void getItemsForOrder() {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert orderItems != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert orderItems.size() == numOrderItems - 1;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""updateItemsInOrderLegacy"" }, dependsOnGroups = { ""getItemsForOrderLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"public void updateItemsInOrder() throws ItemNotFoundException, PricingException {"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert orderItems.size() > 0;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,OrderItem item = orderItems.get(0);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,//item.setSalePrice(new Money(BigDecimal.valueOf(10000)));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,((DiscreteOrderItem) item).getSku().setSalePrice(new Money(BigDecimal.valueOf(10000)));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,((DiscreteOrderItem) item).getSku().setRetailPrice(new Money(BigDecimal.valueOf(10000)));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,item.setQuantity(10);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"cartService.updateItemQuantity(order, item);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,OrderItem updatedItem = orderItemService.readOrderItemById(item.getId());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert updatedItem != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert updatedItem.getPrice().equals(new Money(BigDecimal.valueOf(10000)));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert updatedItem.getQuantity() == 10;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,List<OrderItem> updateItems = new ArrayList<OrderItem> (order.getOrderItems());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,updateItems.get(0).setQuantity(15);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"cartService.updateItemQuantity(order, updatedItem);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert order.getOrderItems().get(0).getQuantity() == 15;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""removeItemFromOrderLegacy"" }, dependsOnGroups = { ""getItemsForOrderLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void removeItemFromOrder() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"cartService.removeItemFromOrder(order, item);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""checkOrderItemsLegacy"" }, dependsOnGroups = { ""removeItemFromOrderLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void checkOrderItems() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,//the removal from the previous test was rolled back
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert order.getOrderItems().size() == 1;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert bundleOrderItem == null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""addPaymentToOrderLegacy"" }, dataProvider = ""basicPaymentInfo"", dataProviderClass = PaymentInfoDataProvider.class, dependsOnGroups = { ""checkOrderItemsLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void addPaymentToOrder(OrderPayment paymentInfo) {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"cartService.addPaymentToOrder(order, paymentInfo, null);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,OrderPayment payment = order.getPayments().get(order.getPayments().indexOf(paymentInfo));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert payment != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,//assert payment.getId() != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert payment.getOrder() != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert payment.getOrder().equals(order);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = ""addFulfillmentGroupToOrderFirstLegacy"", dataProvider = ""basicFulfillmentGroupLegacy"", dataProviderClass = FulfillmentGroupDataProvider.class, dependsOnGroups = { ""addPaymentToOrderLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void addFulfillmentGroupToOrderFirst(FulfillmentGroup fulfillmentGroup) throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,Address address = customerAddressService.readActiveCustomerAddressesByCustomerId(customer.getId()).get(0).getAddress();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,fulfillmentGroup.setOrder(order);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,fulfillmentGroup.setAddress(address);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"FulfillmentGroup fg = cartService.addFulfillmentGroupToOrder(order, fulfillmentGroup);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert fg != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert fg.getId() != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert fg.getAddress().equals(fulfillmentGroup.getAddress());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert fg.getOrder().equals(order);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert fg.getMethod().equals(fulfillmentGroup.getMethod());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert fg.getReferenceNumber().equals(fulfillmentGroup.getReferenceNumber());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,this.fulfillmentGroupId = fg.getId();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""removeFulfillmentGroupFromOrderLegacy"" }, dependsOnGroups = { ""addFulfillmentGroupToOrderFirstLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void removeFulfillmentGroupFromOrder() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,List<FulfillmentGroup> fgItems = order.getFulfillmentGroups();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert fgItems.size() > 0;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,int startingSize = fgItems.size();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,FulfillmentGroup item = fgItems.get(0);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"cartService.removeFulfillmentGroupFromOrder(order, item);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,List<FulfillmentGroup> items = order.getFulfillmentGroups();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""findFulFillmentGroupForOrderFirstLegacy"" }, dependsOnGroups = { ""addFulfillmentGroupToOrderFirstLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void findFillmentGroupForOrderFirst() {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,FulfillmentGroup fg = order.getFulfillmentGroups().get(0);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"FulfillmentGroup fulfillmentGroup = em.find(FulfillmentGroupImpl.class, fulfillmentGroupId);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert fg.getAddress().getId().equals(fulfillmentGroup.getAddress().getId());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups= {""addItemToFulfillmentGroupSecondLegacy""}, dependsOnGroups = { ""addFulfillmentGroupToOrderFirstLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void addItemToFulfillmentgroupSecond() {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert(orderItems.size() > 0);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,FulfillmentGroup newFg = new FulfillmentGroupImpl();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,newFg.setAddress(address);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"newFg.setMethod(""standard"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,newFg.setService(ShippingServiceType.BANDED_SHIPPING.getType());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,try {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"newFg = cartService.addItemToFulfillmentGroup(orderItems.get(0), newFg, 1);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,} catch (PricingException e) {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,throw new RuntimeException(e);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,FulfillmentGroup newNewFg = order.getFulfillmentGroups().get(order.getFulfillmentGroups().indexOf(newFg));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert(newNewFg.getFulfillmentGroupItems().size() == 1);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert(newNewFg.getFulfillmentGroupItems().get(0).getOrderItem().equals(orderItems.get(0)));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"* @Test(groups = { ""removeFulFillmentGroupForOrderFirst"" }, dependsOnGroups"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"* = { ""findCurrentCartForCustomer"","
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"* ""addFulfillmentGroupToOrderFirst"" }) public void"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,* removeFulFillmentGroupForOrderFirst() { int beforeRemove =
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,* cartService.findFulfillmentGroupsForOrder(order).size();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"* FulfillmentGroup fulfillmentGroup = entityManager.find(FulfillmentGroupImpl.class,"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"* fulfillmentGroupId); cartService.removeFulfillmentGroupFromOrder(order,"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,* fulfillmentGroup); int afterRemove =
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,* cartService.findFulfillmentGroupsForOrder(order).size(); assert
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,* (beforeRemove - afterRemove) == 1; }
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""findDefaultFulFillmentGroupForOrderLegacy"" }, dependsOnGroups = { ""findCurrentCartForCustomerLegacy"", ""addFulfillmentGroupToOrderFirstLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void findDefaultFillmentGroupForOrder() {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,FulfillmentGroup fg = cartService.findDefaultFulfillmentGroupForOrder(order);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"* @Test(groups = { ""removeDefaultFulFillmentGroupForOrder"" },"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"* dependsOnGroups = { ""findCurrentCartForCustomer"","
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,* removeDefaultFulFillmentGroupForOrder() { int beforeRemove =
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"* cartService.removeFulfillmentGroupFromOrder(order, fulfillmentGroup);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,* int afterRemove =
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""removeItemFromOrderAfterDefaultFulfillmentGroupLegacy"" }, dependsOnGroups = { ""addFulfillmentGroupToOrderFirstLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void removeItemFromOrderAfterFulfillmentGroups() {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,for (FulfillmentGroupItem fulfillmentGroupItem : fg.getFulfillmentGroupItems()) {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert !fulfillmentGroupItem.getOrderItem().equals(item);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""getOrdersForCustomerLegacy"" }, dependsOnGroups = { ""readCustomer"", ""findCurrentCartForCustomerLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void getOrdersForCustomer() {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"String username = ""customer1"";"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,Customer customer = customerService.readCustomerByUsername(username);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,List<Order> orders = cartService.findOrdersForCustomer(customer);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert orders != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert orders.size() > 0;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""findCartForAnonymousCustomerLegacy"" }, dependsOnGroups = { ""getOrdersForCustomerLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void findCartForAnonymousCustomer() {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,Customer customer = customerService.createCustomerFromId(null);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert order == null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,order = cartService.createNewCartForCustomer(customer);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,Long orderId = order.getId();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,Order newOrder = cartService.findOrderById(orderId);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert newOrder != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert newOrder.getCustomer() != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""findOrderByOrderNumberLegacy"" }, dependsOnGroups = { ""findCartForAnonymousCustomerLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void findOrderByOrderNumber() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"order.setOrderNumber(""3456"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"order = cartService.save(order, false);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"Order newOrder = cartService.findOrderByOrderNumber(""3456"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert newOrder.getId().equals(orderId);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,Order nullOrder = cartService.findOrderByOrderNumber(null);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert nullOrder == null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"nullOrder = cartService.findOrderByOrderNumber("""");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""findNamedOrderForCustomerLegacy"" }, dependsOnGroups = { ""findOrderByOrderNumberLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void findNamedOrderForCustomer() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,order.setStatus(OrderStatus.NAMED);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"order.setName(""COOL ORDER"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"Order newOrder = cartService.findNamedOrderForCustomer(""COOL ORDER"", customer);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""testReadOrdersForCustomerLegacy"" }, dependsOnGroups = { ""findNamedOrderForCustomerLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void testReadOrdersForCustomer() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,order.setStatus(OrderStatus.IN_PROCESS);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"List<Order> newOrders = cartService.findOrdersForCustomer(customer, OrderStatus.IN_PROCESS);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,boolean containsOrder = false;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,if (newOrders.contains(order))
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,{
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,containsOrder = true;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert containsOrder == true;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,containsOrder = false;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"newOrders = cartService.findOrdersForCustomer(customer, null);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""testOrderPropertiesLegacy"" }, dependsOnGroups = { ""testReadOrdersForCustomerLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void testOrderProperties() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert order.getSubTotal() == null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert order.getTotal() == null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,Calendar testCalendar = Calendar.getInstance();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,order.setSubmitDate(testCalendar.getTime());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert order.getSubmitDate().equals(testCalendar.getTime());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""testNamedOrderForCustomerLegacy"" }, dependsOnGroups = { ""testOrderPropertiesLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void testNamedOrderForCustomer() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,customer = customerService.saveCustomer(customer);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"Order order = cartService.createNamedOrderForCustomer(""Birthday Order"", customer);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"assert order.getName().equals(""Birthday Order"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert order.getCustomer().equals(customer);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"cartService.removeNamedOrderForCustomer(""Birthday Order"", customer);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert cartService.findOrderById(orderId) == null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""testAddSkuToOrderLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void testAddSkuToOrder() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,Customer customer = customerService.saveCustomer(customerService.createCustomerFromId(null));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,Category category = new CategoryImpl();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"category.setName(""Pants"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,category = catalogService.saveCategory(category);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,Calendar activeStartCal = Calendar.getInstance();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"activeStartCal.add(Calendar.DAY_OF_YEAR, -2);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,Sku newDefaultSku = new SkuImpl();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"newDefaultSku.setName(""Leather Pants"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,newDefaultSku.setRetailPrice(new Money(44.99));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,newDefaultSku.setActiveStartDate(activeStartCal.getTime());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,newDefaultSku.setDiscountable(true);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,newDefaultSku = catalogService.saveSku(newDefaultSku);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,Product newProduct = new ProductImpl();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,newProduct.setDefaultCategory(category);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,newProduct.setDefaultSku(newDefaultSku);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,newProduct = catalogService.saveProduct(newProduct);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"Order order = cartService.createNamedOrderForCustomer(""Pants Order"", customer);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"OrderItem orderItem = cartService.addSkuToOrder(order.getId(), newDefaultSku.getId(),"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"newProduct.getId(), category.getId(), 2);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"OrderItem quantityNullOrderItem = cartService.addSkuToOrder(order.getId(), newDefaultSku.getId(),"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"newProduct.getId(), category.getId(), null);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"OrderItem skuNullOrderItem = cartService.addSkuToOrder(order.getId(), null,"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"null, category.getId(), 2);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"OrderItem orderNullOrderItem = cartService.addSkuToOrder(null, newDefaultSku.getId(),"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"OrderItem productNullOrderItem = cartService.addSkuToOrder(order.getId(), newDefaultSku.getId(),"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"OrderItem categoryNullOrderItem = cartService.addSkuToOrder(order.getId(), newDefaultSku.getId(),"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"newProduct.getId(), null, 2);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert orderItem != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert skuNullOrderItem == null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert quantityNullOrderItem == null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert orderNullOrderItem == null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert productNullOrderItem != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert categoryNullOrderItem != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""testOrderPaymentInfosLegacy"" }, dataProvider = ""basicPaymentInfo"", dataProviderClass = PaymentInfoDataProvider.class)"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void testOrderPaymentInfos(OrderPayment info) throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,Customer customer = customerService.saveCustomer(createNamedCustomer());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"cartService.addPaymentToOrder(order, info);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,boolean foundInfo = false;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert order.getPayments() != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,for (OrderPayment testInfo : order.getPayments())
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,if (testInfo.equals(info))
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,foundInfo = true;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert foundInfo == true;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert cartService.readPaymentInfosForOrder(order) != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,//cartService.removeAllPaymentsFromOrder(order);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,//assert order.getPaymentInfos().size() == 0;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""testSubmitOrderLegacy"" }, dependsOnGroups = { ""findNamedOrderForCustomerLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void testSubmitOrder() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,Order confirmedOrder = cartService.confirmOrder(order);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,confirmedOrder = cartService.findOrderById(confirmedOrder.getId());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,Long confirmedOrderId = confirmedOrder.getId();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert orderId.equals(confirmedOrderId);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert confirmedOrder.getStatus().equals(OrderStatus.SUBMITTED);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,@Test
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void findCartForNullCustomerId() {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert cartService.findCartForCustomer(new CustomerImpl()) == null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""testCartAndNamedOrderLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,public void testCreateNamedOrder() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,category.setActiveStartDate(activeStartCal.getTime());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"@Test(groups = { ""testOrderFulfillmentGroupsLegacy"" }, dataProvider = ""basicShippingRates"", dataProviderClass = ShippingRateDataProvider.class)"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"public void testAddFulfillmentGroupToOrder(ShippingRate shippingRate, ShippingRate sr2) throws PricingException, ItemNotFoundException{"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,shippingRate = shippingRateService.save(shippingRate);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,sr2 = shippingRateService.save(sr2);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,Customer customer = createCustomerWithAddresses();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,Order order = initializeExistingCart(customer);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,CustomerAddress customerAddress = customerAddressService.readActiveCustomerAddressesByCustomerId(customer.getId()).get(0);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,FulfillmentGroupRequest fgRequest = new FulfillmentGroupRequest();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,List<FulfillmentGroupItemRequest> fgiRequests = new ArrayList<FulfillmentGroupItemRequest>();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,for (OrderItem orderItem : order.getOrderItems()) {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,FulfillmentGroupItemRequest fgiRequest = new FulfillmentGroupItemRequest();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,fgiRequest.setOrderItem(orderItem);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,fgiRequest.setQuantity(1);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,fgiRequests.add(fgiRequest);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,fgRequest.setAddress(customerAddress.getAddress());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,fgRequest.setFulfillmentGroupItemRequests(fgiRequests);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,fgRequest.setOrder(cartService.findCartForCustomer(customer));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"fgRequest.setMethod(""standard"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,fgRequest.setService(ShippingServiceType.BANDED_SHIPPING.getType());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,cartService.addFulfillmentGroupToOrder(fgRequest);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,Order resultOrder = cartService.findOrderById(order.getId());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert resultOrder.getFulfillmentGroups().size() == 1;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert resultOrder.getFulfillmentGroups().get(0).getFulfillmentGroupItems().size() == 2;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"cartService.removeAllFulfillmentGroupsFromOrder(order, false);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,resultOrder = cartService.findOrderById(order.getId());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert resultOrder.getFulfillmentGroups().size() == 0;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"FulfillmentGroup defaultFg = cartService.createDefaultFulfillmentGroup(order, customerAddress.getAddress());"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"defaultFg.setMethod(""standard"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,defaultFg.setService(ShippingServiceType.BANDED_SHIPPING.getType());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,assert defaultFg.isPrimary();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,69877cda3b323c2da3a26f32c48e1111e61fed45,deleted,1,"cartService.addFulfillmentGroupToOrder(order, defaultFg);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,/*
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* #%L
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* BroadleafCommerce Integration
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* %%
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* Copyright (C) 2009 - 2016 Broadleaf Commerce
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"* Licensed under the Broadleaf Fair Use License Agreement, Version 1.0"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"* (the ""Fair Use License"" located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* unless the restrictions on use therein are violated and require payment to Broadleaf in which case
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"* the Broadleaf End User License Agreement (EULA), Version 1.1"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"* (the ""Commercial License"" located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* shall apply.
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,*
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"* Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the ""Custom License"")"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* #L%
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,*/
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,package org.broadleafcommerce.core.order.service.legacy;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.common.money.Money;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.catalog.dao.SkuDao;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.catalog.domain.Category;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.catalog.domain.CategoryImpl;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.catalog.domain.Product;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.catalog.domain.ProductImpl;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.catalog.domain.Sku;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.catalog.domain.SkuImpl;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.order.FulfillmentGroupDataProvider;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.order.domain.BundleOrderItem;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.order.domain.DiscreteOrderItem;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.order.domain.FulfillmentGroup;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.order.domain.FulfillmentGroupImpl;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.order.domain.FulfillmentGroupItem;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.order.domain.Order;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.order.domain.OrderItem;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.order.service.OrderItemService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.order.service.call.BundleOrderItemRequest;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.order.service.call.DiscreteOrderItemRequest;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.order.service.call.FulfillmentGroupItemRequest;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.order.service.call.FulfillmentGroupRequest;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.order.service.exception.ItemNotFoundException;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.order.service.type.OrderStatus;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.payment.PaymentInfoDataProvider;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.payment.domain.OrderPayment;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.pricing.ShippingRateDataProvider;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.pricing.domain.ShippingRate;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.pricing.service.ShippingRateService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.pricing.service.exception.PricingException;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.core.pricing.service.workflow.type.ShippingServiceType;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.profile.core.domain.Address;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.profile.core.domain.Customer;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.profile.core.domain.CustomerAddress;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.broadleafcommerce.profile.core.domain.CustomerImpl;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.springframework.test.annotation.Rollback;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.springframework.transaction.annotation.Propagation;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.springframework.transaction.annotation.Transactional;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.testng.annotations.Test;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import java.math.BigDecimal;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import java.util.ArrayList;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import java.util.Calendar;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import java.util.List;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import javax.annotation.Resource;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@SuppressWarnings(""deprecation"")"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public class LegacyOrderTest extends LegacyOrderBaseTest {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,private Long orderId = null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,private int numOrderItems = 0;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,private Long fulfillmentGroupId;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,private Long bundleOrderItemId;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Resource(name = ""blOrderItemService"")"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,private OrderItemService orderItemService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,@Resource
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,private SkuDao skuDao;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,private ShippingRateService shippingRateService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""createCartForCustomerLegacy"" }, dependsOnGroups = { ""readCustomer"", ""createPhone"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,@Transactional
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,@Rollback(false)
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void createCartForCustomer() {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"String userName = ""customer1"";"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Customer customer = customerService.readCustomerByUsername(userName);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Order order = cartService.createNewCartForCustomer(customer);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert order != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert order.getId() != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,this.orderId = order.getId();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,}
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""findCurrentCartForCustomerLegacy"" }, dependsOnGroups = { ""readCustomer"", ""createPhone"", ""createCartForCustomerLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void findCurrentCartForCustomer() {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Order order = cartService.findCartForCustomer(customer);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""addItemToOrderLegacy"" }, dependsOnGroups = { ""findCurrentCartForCustomerLegacy"", ""createSku"", ""testCatalog"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,@Transactional(propagation = Propagation.REQUIRES_NEW)
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void addItemToOrder() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,numOrderItems++;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Sku sku = skuDao.readFirstSku();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Order order = cartService.findOrderById(orderId);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert sku.getId() != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,DiscreteOrderItemRequest itemRequest = new DiscreteOrderItemRequest();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,itemRequest.setQuantity(1);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,itemRequest.setSku(sku);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"DiscreteOrderItem item = (DiscreteOrderItem) cartService.addDiscreteItemToOrder(order, itemRequest);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert item != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert item.getQuantity() == numOrderItems;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert item.getSku() != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert item.getSku().equals(sku);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""addAnotherItemToOrderLegacy"" }, dependsOnGroups = { ""addItemToOrderLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void addAnotherItemToOrder() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,cartService.setAutomaticallyMergeLikeItems(true);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"DiscreteOrderItem item = (DiscreteOrderItem) cartService.addDiscreteItemToOrder(order, itemRequest, true);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert item.getQuantity() == 2;  // item-was merged with prior item.
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,order = cartService.findOrderById(orderId);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert(order.getOrderItems().size()==1);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert(order.getOrderItems().get(0).getQuantity()==2);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"This test is currently not supported, as the order service only supports like item merging"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,// re-price the order without automatically merging.
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,cartService.setAutomaticallyMergeLikeItems(false);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,DiscreteOrderItemRequest itemRequest2 = new DiscreteOrderItemRequest();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,itemRequest2.setQuantity(1);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,itemRequest2.setSku(sku);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"DiscreteOrderItem item2 = (DiscreteOrderItem) cartService.addDiscreteItemToOrder(order, itemRequest2, true);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert item2.getSku() != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert item2.getSku().equals(sku);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert item2.getQuantity() == 1;  // item-was not auto-merged with prior items.
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert(order.getOrderItems().size()==2);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert(order.getOrderItems().get(1).getQuantity()==1);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""addBundleToOrderLegacy"" }, dependsOnGroups = { ""addAnotherItemToOrderLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void addBundleToOrder() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,//numOrderItems++;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,BundleOrderItemRequest bundleRequest = new BundleOrderItemRequest();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,bundleRequest.setQuantity(1);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"bundleRequest.setName(""myBundle"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,bundleRequest.getDiscreteOrderItems().add(itemRequest);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"BundleOrderItem item = (BundleOrderItem) cartService.addBundleItemToOrder(order, bundleRequest);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,bundleOrderItemId = item.getId();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert item.getQuantity() == 1;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""removeBundleFromOrderLegacy"" }, dependsOnGroups = { ""addBundleToOrderLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void removeBundleFromOrder() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,List<OrderItem> orderItems = order.getOrderItems();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert orderItems.size() == numOrderItems;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,int startingSize = orderItems.size();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,BundleOrderItem bundleOrderItem = (BundleOrderItem) orderItemService.readOrderItemById(bundleOrderItemId);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert bundleOrderItem != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert bundleOrderItem.getDiscreteOrderItems() != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert bundleOrderItem.getDiscreteOrderItems().size() == 1;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"cartService.removeItemFromOrder(order, bundleOrderItem);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,List<OrderItem> items = order.getOrderItems();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert items != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert items.size() == startingSize - 1;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""getItemsForOrderLegacy"" }, dependsOnGroups = { ""removeBundleFromOrderLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void getItemsForOrder() {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert orderItems != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert orderItems.size() == numOrderItems - 1;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""updateItemsInOrderLegacy"" }, dependsOnGroups = { ""getItemsForOrderLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"public void updateItemsInOrder() throws ItemNotFoundException, PricingException {"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert orderItems.size() > 0;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,OrderItem item = orderItems.get(0);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,//item.setSalePrice(new Money(BigDecimal.valueOf(10000)));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,((DiscreteOrderItem) item).getSku().setSalePrice(new Money(BigDecimal.valueOf(10000)));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,((DiscreteOrderItem) item).getSku().setRetailPrice(new Money(BigDecimal.valueOf(10000)));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,item.setQuantity(10);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"cartService.updateItemQuantity(order, item);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,OrderItem updatedItem = orderItemService.readOrderItemById(item.getId());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert updatedItem != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert updatedItem.getPrice().equals(new Money(BigDecimal.valueOf(10000)));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert updatedItem.getQuantity() == 10;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,List<OrderItem> updateItems = new ArrayList<OrderItem> (order.getOrderItems());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,updateItems.get(0).setQuantity(15);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"cartService.updateItemQuantity(order, updatedItem);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert order.getOrderItems().get(0).getQuantity() == 15;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""removeItemFromOrderLegacy"" }, dependsOnGroups = { ""getItemsForOrderLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void removeItemFromOrder() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"cartService.removeItemFromOrder(order, item);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""checkOrderItemsLegacy"" }, dependsOnGroups = { ""removeItemFromOrderLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void checkOrderItems() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,//the removal from the previous test was rolled back
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert order.getOrderItems().size() == 1;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert bundleOrderItem == null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""addPaymentToOrderLegacy"" }, dataProvider = ""basicPaymentInfo"", dataProviderClass = PaymentInfoDataProvider.class, dependsOnGroups = { ""checkOrderItemsLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void addPaymentToOrder(OrderPayment paymentInfo) {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"cartService.addPaymentToOrder(order, paymentInfo, null);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,OrderPayment payment = order.getPayments().get(order.getPayments().indexOf(paymentInfo));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert payment != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,//assert payment.getId() != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert payment.getOrder() != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert payment.getOrder().equals(order);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = ""addFulfillmentGroupToOrderFirstLegacy"", dataProvider = ""basicFulfillmentGroupLegacy"", dataProviderClass = FulfillmentGroupDataProvider.class, dependsOnGroups = { ""addPaymentToOrderLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void addFulfillmentGroupToOrderFirst(FulfillmentGroup fulfillmentGroup) throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Address address = customerAddressService.readActiveCustomerAddressesByCustomerId(customer.getId()).get(0).getAddress();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,fulfillmentGroup.setOrder(order);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,fulfillmentGroup.setAddress(address);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"FulfillmentGroup fg = cartService.addFulfillmentGroupToOrder(order, fulfillmentGroup);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert fg != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert fg.getId() != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert fg.getAddress().equals(fulfillmentGroup.getAddress());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert fg.getOrder().equals(order);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert fg.getMethod().equals(fulfillmentGroup.getMethod());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert fg.getReferenceNumber().equals(fulfillmentGroup.getReferenceNumber());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,this.fulfillmentGroupId = fg.getId();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""removeFulfillmentGroupFromOrderLegacy"" }, dependsOnGroups = { ""addFulfillmentGroupToOrderFirstLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void removeFulfillmentGroupFromOrder() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,List<FulfillmentGroup> fgItems = order.getFulfillmentGroups();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert fgItems.size() > 0;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,int startingSize = fgItems.size();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,FulfillmentGroup item = fgItems.get(0);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"cartService.removeFulfillmentGroupFromOrder(order, item);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,List<FulfillmentGroup> items = order.getFulfillmentGroups();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""findFulFillmentGroupForOrderFirstLegacy"" }, dependsOnGroups = { ""addFulfillmentGroupToOrderFirstLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void findFillmentGroupForOrderFirst() {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,FulfillmentGroup fg = order.getFulfillmentGroups().get(0);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"FulfillmentGroup fulfillmentGroup = em.find(FulfillmentGroupImpl.class, fulfillmentGroupId);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert fg.getAddress().getId().equals(fulfillmentGroup.getAddress().getId());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups= {""addItemToFulfillmentGroupSecondLegacy""}, dependsOnGroups = { ""addFulfillmentGroupToOrderFirstLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void addItemToFulfillmentgroupSecond() {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert(orderItems.size() > 0);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,FulfillmentGroup newFg = new FulfillmentGroupImpl();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,newFg.setAddress(address);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"newFg.setMethod(""standard"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,newFg.setService(ShippingServiceType.BANDED_SHIPPING.getType());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,try {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"newFg = cartService.addItemToFulfillmentGroup(orderItems.get(0), newFg, 1);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,} catch (PricingException e) {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,throw new RuntimeException(e);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,FulfillmentGroup newNewFg = order.getFulfillmentGroups().get(order.getFulfillmentGroups().indexOf(newFg));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert(newNewFg.getFulfillmentGroupItems().size() == 1);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert(newNewFg.getFulfillmentGroupItems().get(0).getOrderItem().equals(orderItems.get(0)));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"* @Test(groups = { ""removeFulFillmentGroupForOrderFirst"" }, dependsOnGroups"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"* = { ""findCurrentCartForCustomer"","
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"* ""addFulfillmentGroupToOrderFirst"" }) public void"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* removeFulFillmentGroupForOrderFirst() { int beforeRemove =
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* cartService.findFulfillmentGroupsForOrder(order).size();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"* FulfillmentGroup fulfillmentGroup = entityManager.find(FulfillmentGroupImpl.class,"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"* fulfillmentGroupId); cartService.removeFulfillmentGroupFromOrder(order,"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* fulfillmentGroup); int afterRemove =
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* cartService.findFulfillmentGroupsForOrder(order).size(); assert
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* (beforeRemove - afterRemove) == 1; }
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""findDefaultFulFillmentGroupForOrderLegacy"" }, dependsOnGroups = { ""findCurrentCartForCustomerLegacy"", ""addFulfillmentGroupToOrderFirstLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void findDefaultFillmentGroupForOrder() {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,FulfillmentGroup fg = cartService.findDefaultFulfillmentGroupForOrder(order);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"* @Test(groups = { ""removeDefaultFulFillmentGroupForOrder"" },"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"* dependsOnGroups = { ""findCurrentCartForCustomer"","
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* removeDefaultFulFillmentGroupForOrder() { int beforeRemove =
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"* cartService.removeFulfillmentGroupFromOrder(order, fulfillmentGroup);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* int afterRemove =
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""removeItemFromOrderAfterDefaultFulfillmentGroupLegacy"" }, dependsOnGroups = { ""addFulfillmentGroupToOrderFirstLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void removeItemFromOrderAfterFulfillmentGroups() {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,for (FulfillmentGroupItem fulfillmentGroupItem : fg.getFulfillmentGroupItems()) {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert !fulfillmentGroupItem.getOrderItem().equals(item);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""getOrdersForCustomerLegacy"" }, dependsOnGroups = { ""readCustomer"", ""findCurrentCartForCustomerLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void getOrdersForCustomer() {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"String username = ""customer1"";"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Customer customer = customerService.readCustomerByUsername(username);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,List<Order> orders = cartService.findOrdersForCustomer(customer);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert orders != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert orders.size() > 0;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""findCartForAnonymousCustomerLegacy"" }, dependsOnGroups = { ""getOrdersForCustomerLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void findCartForAnonymousCustomer() {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Customer customer = customerService.createCustomerFromId(null);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert order == null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,order = cartService.createNewCartForCustomer(customer);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Long orderId = order.getId();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Order newOrder = cartService.findOrderById(orderId);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert newOrder != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert newOrder.getCustomer() != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""findOrderByOrderNumberLegacy"" }, dependsOnGroups = { ""findCartForAnonymousCustomerLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void findOrderByOrderNumber() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"order.setOrderNumber(""3456"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"order = cartService.save(order, false);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"Order newOrder = cartService.findOrderByOrderNumber(""3456"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert newOrder.getId().equals(orderId);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Order nullOrder = cartService.findOrderByOrderNumber(null);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert nullOrder == null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"nullOrder = cartService.findOrderByOrderNumber("""");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""findNamedOrderForCustomerLegacy"" }, dependsOnGroups = { ""findOrderByOrderNumberLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void findNamedOrderForCustomer() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,order.setStatus(OrderStatus.NAMED);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"order.setName(""COOL ORDER"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"Order newOrder = cartService.findNamedOrderForCustomer(""COOL ORDER"", customer);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""testReadOrdersForCustomerLegacy"" }, dependsOnGroups = { ""findNamedOrderForCustomerLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void testReadOrdersForCustomer() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,order.setStatus(OrderStatus.IN_PROCESS);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"List<Order> newOrders = cartService.findOrdersForCustomer(customer, OrderStatus.IN_PROCESS);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,boolean containsOrder = false;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,if (newOrders.contains(order))
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,{
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,containsOrder = true;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert containsOrder == true;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,containsOrder = false;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"newOrders = cartService.findOrdersForCustomer(customer, null);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""testOrderPropertiesLegacy"" }, dependsOnGroups = { ""testReadOrdersForCustomerLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void testOrderProperties() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert order.getSubTotal() == null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert order.getTotal() == null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Calendar testCalendar = Calendar.getInstance();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,order.setSubmitDate(testCalendar.getTime());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert order.getSubmitDate().equals(testCalendar.getTime());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""testNamedOrderForCustomerLegacy"" }, dependsOnGroups = { ""testOrderPropertiesLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void testNamedOrderForCustomer() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,customer = customerService.saveCustomer(customer);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"Order order = cartService.createNamedOrderForCustomer(""Birthday Order"", customer);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"assert order.getName().equals(""Birthday Order"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert order.getCustomer().equals(customer);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"cartService.removeNamedOrderForCustomer(""Birthday Order"", customer);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert cartService.findOrderById(orderId) == null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""testAddSkuToOrderLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void testAddSkuToOrder() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Customer customer = customerService.saveCustomer(customerService.createCustomerFromId(null));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Category category = new CategoryImpl();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"category.setName(""Pants"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,category = catalogService.saveCategory(category);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Calendar activeStartCal = Calendar.getInstance();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"activeStartCal.add(Calendar.DAY_OF_YEAR, -2);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Sku newDefaultSku = new SkuImpl();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"newDefaultSku.setName(""Leather Pants"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,newDefaultSku.setRetailPrice(new Money(44.99));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,newDefaultSku.setActiveStartDate(activeStartCal.getTime());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,newDefaultSku.setDiscountable(true);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,newDefaultSku = catalogService.saveSku(newDefaultSku);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Product newProduct = new ProductImpl();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,newProduct.setDefaultCategory(category);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,newProduct.setDefaultSku(newDefaultSku);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,newProduct = catalogService.saveProduct(newProduct);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"Order order = cartService.createNamedOrderForCustomer(""Pants Order"", customer);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"OrderItem orderItem = cartService.addSkuToOrder(order.getId(), newDefaultSku.getId(),"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"newProduct.getId(), category.getId(), 2);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"OrderItem quantityNullOrderItem = cartService.addSkuToOrder(order.getId(), newDefaultSku.getId(),"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"newProduct.getId(), category.getId(), null);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"OrderItem skuNullOrderItem = cartService.addSkuToOrder(order.getId(), null,"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"null, category.getId(), 2);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"OrderItem orderNullOrderItem = cartService.addSkuToOrder(null, newDefaultSku.getId(),"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"OrderItem productNullOrderItem = cartService.addSkuToOrder(order.getId(), newDefaultSku.getId(),"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"OrderItem categoryNullOrderItem = cartService.addSkuToOrder(order.getId(), newDefaultSku.getId(),"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"newProduct.getId(), null, 2);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert orderItem != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert skuNullOrderItem == null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert quantityNullOrderItem == null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert orderNullOrderItem == null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert productNullOrderItem != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert categoryNullOrderItem != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""testOrderPaymentInfosLegacy"" }, dataProvider = ""basicPaymentInfo"", dataProviderClass = PaymentInfoDataProvider.class)"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void testOrderPaymentInfos(OrderPayment info) throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Customer customer = customerService.saveCustomer(createNamedCustomer());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"cartService.addPaymentToOrder(order, info);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,boolean foundInfo = false;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert order.getPayments() != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,for (OrderPayment testInfo : order.getPayments())
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,if (testInfo.equals(info))
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,foundInfo = true;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert foundInfo == true;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert cartService.readPaymentInfosForOrder(order) != null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,//cartService.removeAllPaymentsFromOrder(order);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,//assert order.getPaymentInfos().size() == 0;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""testSubmitOrderLegacy"" }, dependsOnGroups = { ""findNamedOrderForCustomerLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void testSubmitOrder() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Order confirmedOrder = cartService.confirmOrder(order);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,confirmedOrder = cartService.findOrderById(confirmedOrder.getId());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Long confirmedOrderId = confirmedOrder.getId();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert orderId.equals(confirmedOrderId);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert confirmedOrder.getStatus().equals(OrderStatus.SUBMITTED);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,@Test
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void findCartForNullCustomerId() {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert cartService.findCartForCustomer(new CustomerImpl()) == null;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""testCartAndNamedOrderLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void testCreateNamedOrder() throws PricingException {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,category.setActiveStartDate(activeStartCal.getTime());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Test(groups = { ""testOrderFulfillmentGroupsLegacy"" }, dataProvider = ""basicShippingRates"", dataProviderClass = ShippingRateDataProvider.class)"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"public void testAddFulfillmentGroupToOrder(ShippingRate shippingRate, ShippingRate sr2) throws PricingException, ItemNotFoundException{"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,shippingRate = shippingRateService.save(shippingRate);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,sr2 = shippingRateService.save(sr2);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Customer customer = createCustomerWithAddresses();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Order order = initializeExistingCart(customer);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,CustomerAddress customerAddress = customerAddressService.readActiveCustomerAddressesByCustomerId(customer.getId()).get(0);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,FulfillmentGroupRequest fgRequest = new FulfillmentGroupRequest();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,List<FulfillmentGroupItemRequest> fgiRequests = new ArrayList<FulfillmentGroupItemRequest>();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,for (OrderItem orderItem : order.getOrderItems()) {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,FulfillmentGroupItemRequest fgiRequest = new FulfillmentGroupItemRequest();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,fgiRequest.setOrderItem(orderItem);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,fgiRequest.setQuantity(1);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,fgiRequests.add(fgiRequest);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,fgRequest.setAddress(customerAddress.getAddress());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,fgRequest.setFulfillmentGroupItemRequests(fgiRequests);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,fgRequest.setOrder(cartService.findCartForCustomer(customer));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"fgRequest.setMethod(""standard"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,fgRequest.setService(ShippingServiceType.BANDED_SHIPPING.getType());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,cartService.addFulfillmentGroupToOrder(fgRequest);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Order resultOrder = cartService.findOrderById(order.getId());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert resultOrder.getFulfillmentGroups().size() == 1;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert resultOrder.getFulfillmentGroups().get(0).getFulfillmentGroupItems().size() == 2;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"cartService.removeAllFulfillmentGroupsFromOrder(order, false);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,resultOrder = cartService.findOrderById(order.getId());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert resultOrder.getFulfillmentGroups().size() == 0;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"FulfillmentGroup defaultFg = cartService.createDefaultFulfillmentGroup(order, customerAddress.getAddress());"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"defaultFg.setMethod(""standard"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,defaultFg.setService(ShippingServiceType.BANDED_SHIPPING.getType());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,assert defaultFg.isPrimary();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"cartService.addFulfillmentGroupToOrder(order, defaultFg);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,/*
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,* #%L
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,* BroadleafCommerce Integration
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,* %%
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,* Copyright (C) 2009 - 2016 Broadleaf Commerce
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"* Licensed under the Broadleaf Fair Use License Agreement, Version 1.0"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"* (the ""Fair Use License"" located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,* unless the restrictions on use therein are violated and require payment to Broadleaf in which case
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"* the Broadleaf End User License Agreement (EULA), Version 1.1"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"* (the ""Commercial License"" located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,* shall apply.
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,*
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"* Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the ""Custom License"")"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,* between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,* #L%
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,*/
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,package org.broadleafcommerce.core.pricing.service.legacy;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.common.i18n.domain.ISOCountry;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.common.i18n.domain.ISOCountryImpl;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.common.i18n.service.ISOService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.common.money.Money;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.common.time.SystemTime;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.core.catalog.domain.Sku;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.core.catalog.domain.SkuImpl;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.core.catalog.service.CatalogService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.core.offer.domain.Offer;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.core.offer.domain.OfferCode;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.core.offer.domain.OfferCodeImpl;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.core.offer.domain.OfferImpl;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.core.offer.service.OfferService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.core.offer.service.type.OfferDiscountType;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.core.offer.service.type.OfferType;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.core.order.domain.DiscreteOrderItem;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.core.order.domain.DiscreteOrderItemImpl;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.core.order.domain.FulfillmentGroup;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.core.order.domain.FulfillmentGroupImpl;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.core.order.domain.FulfillmentGroupItem;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.core.order.domain.FulfillmentGroupItemImpl;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.core.order.domain.Order;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.core.order.domain.OrderItem;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.core.order.service.OrderItemService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.core.order.service.OrderService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.core.pricing.ShippingRateDataProvider;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.core.pricing.domain.ShippingRate;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.core.pricing.service.ShippingRateService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.core.pricing.service.workflow.type.ShippingServiceType;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.profile.core.domain.Address;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.profile.core.domain.AddressImpl;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.profile.core.domain.Country;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.profile.core.domain.CountryImpl;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.profile.core.domain.Customer;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.profile.core.domain.State;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.profile.core.domain.StateImpl;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.profile.core.service.CountryService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.profile.core.service.CustomerService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.profile.core.service.StateService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.broadleafcommerce.test.BaseTest;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.springframework.test.annotation.Rollback;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.springframework.transaction.annotation.Transactional;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import org.testng.annotations.Test;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import java.math.BigDecimal;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import java.util.ArrayList;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import java.util.Calendar;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import java.util.List;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,import javax.annotation.Resource;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"@SuppressWarnings(""deprecation"")"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,public class LegacyPricingTest extends BaseTest {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,@Resource
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,private CustomerService customerService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"@Resource(name = ""blOrderService"")"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,private OrderService orderService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,private ShippingRateService shippingRateService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,private CatalogService catalogService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"@Resource(name = ""blOrderItemService"")"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,private OrderItemService orderItemService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,private OfferService offerService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,private CountryService countryService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,private StateService stateService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,private ISOService isoService;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"@Test(groups =  {""testShippingInsertLegacy""}, dataProvider = ""basicShippingRates"", dataProviderClass = ShippingRateDataProvider.class)"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,@Rollback(false)
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"public void testShippingInsert(ShippingRate shippingRate, ShippingRate sr2) throws Exception {"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,shippingRate = shippingRateService.save(shippingRate);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,sr2 = shippingRateService.save(sr2);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,}
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"@Test(groups = {""testPricingLegacy""}, dependsOnGroups = { ""testShippingInsertLegacy"", ""createCustomerIdGenerationLegacy"" })"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,@Transactional
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,public void testPricing() throws Exception {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,Order order = orderService.createNewCartForCustomer(createCustomer());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,customerService.saveCustomer(order.getCustomer());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,Country country = new CountryImpl();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"country.setAbbreviation(""US"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"country.setName(""United States"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,country = countryService.save(country);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,ISOCountry isoCountry = new ISOCountryImpl();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"isoCountry.setAlpha2(""US"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"isoCountry.setName(""UNITED STATES"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,isoCountry = isoService.save(isoCountry);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,State state = new StateImpl();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"state.setAbbreviation(""TX"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"state.setName(""Texas"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,state.setCountry(country);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,state = stateService.save(state);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,Address address = new AddressImpl();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"address.setAddressLine1(""123 Test Rd"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"address.setCity(""Dallas"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"address.setFirstName(""Jeff"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"address.setLastName(""Fischer"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"address.setPostalCode(""75240"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"address.setPrimaryPhone(""972-978-9067"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,address.setState(state);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,address.setCountry(country);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"address.setIsoCountrySubdivision(""US-TX"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,address.setIsoCountryAlpha2(isoCountry);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,FulfillmentGroup group = new FulfillmentGroupImpl();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,group.setAddress(address);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,List<FulfillmentGroup> groups = new ArrayList<FulfillmentGroup>();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"group.setMethod(""standard"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,group.setService(ShippingServiceType.BANDED_SHIPPING.getType());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,group.setOrder(order);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,groups.add(group);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,order.setFulfillmentGroups(groups);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,Money total = new Money(8.5D);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,group.setShippingPrice(total);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,{
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,DiscreteOrderItem item = new DiscreteOrderItemImpl();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,Sku sku = new SkuImpl();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"sku.setName(""Test Sku"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,sku.setRetailPrice(new Money(10D));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,sku.setDiscountable(true);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,sku = catalogService.saveSku(sku);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,item.setSku(sku);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,item.setQuantity(2);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,item.setOrder(order);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,item = (DiscreteOrderItem) orderItemService.saveOrderItem(item);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,order.addOrderItem(item);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,FulfillmentGroupItem fgItem = new FulfillmentGroupItemImpl();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,fgItem.setFulfillmentGroup(group);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,fgItem.setOrderItem(item);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,fgItem.setQuantity(2);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,//fgItem.setPrice(new Money(0D));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,group.addFulfillmentGroupItem(fgItem);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"sku.setName(""Test Product 2"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,sku.setRetailPrice(new Money(20D));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,item.setQuantity(1);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,fgItem.setQuantity(1);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"order.addOfferCode(createOfferCode(""20 Percent Off Item Offer"", OfferType.ORDER_ITEM, OfferDiscountType.PERCENT_OFF, 20, null, ""discreteOrderItem.sku.name==\""Test Sku\""""));"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"order.addOfferCode(createOfferCode(""3 Dollars Off Item Offer"", OfferType.ORDER_ITEM, OfferDiscountType.AMOUNT_OFF, 3, null, ""discreteOrderItem.sku.name!=\""Test Sku\""""));"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"order.addOfferCode(createOfferCode(""1.20 Dollars Off Order Offer"", OfferType.ORDER, OfferDiscountType.AMOUNT_OFF, 1.20, null, null));"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,order.setTotalShipping(new Money(0D));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"orderService.save(order, true);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,assert order.getSubTotal().subtract(order.getOrderAdjustmentsValue()).equals(new Money(31.80D));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,assert (order.getTotal().greaterThan(order.getSubTotal()));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,// Distribute Order Savings Activity is on.
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,assert (order.getTotalTax().equals((order.getSubTotal().subtract(order.getOrderAdjustmentsValue())).multiply(0.05D))); // Shipping is not taxable
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,assert (order.getTotal().equals(order.getSubTotal().add(order.getTotalTax()).add(order.getTotalShipping()).subtract(order.getOrderAdjustmentsValue())));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"@Test(groups = { ""testShippingLegacy"" }, dependsOnGroups = { ""testShippingInsertLegacy"", ""createCustomerIdGenerationLegacy""})"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,public void testShipping() throws Exception {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,FulfillmentGroup group1 = new FulfillmentGroupImpl();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,FulfillmentGroup group2 = new FulfillmentGroupImpl();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,// setup group1 - standard
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"group1.setMethod(""standard"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,group1.setService(ShippingServiceType.BANDED_SHIPPING.getType());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,group1.setAddress(address);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,group1.setOrder(order);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,// setup group2 - truck
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"group2.setMethod(""truck"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,group2.setService(ShippingServiceType.BANDED_SHIPPING.getType());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,group2.setOrder(order);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,groups.add(group1);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,//groups.add(group2);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,group1.setShippingPrice(total);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,group2.setShippingPrice(total);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,//group1.setTotalTax(new Money(1D));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,//group2.setTotalTax(new Money(1D));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,order.setSubTotal(total);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,order.setTotal(total);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,sku.setRetailPrice(new Money(15D));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,List<OrderItem> items = new ArrayList<OrderItem>();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,items.add(item);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,order.setOrderItems(items);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,for (OrderItem orderItem : items) {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,FulfillmentGroupItem fgi = new FulfillmentGroupItemImpl();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,fgi.setOrderItem(orderItem);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,fgi.setQuantity(orderItem.getQuantity());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,fgi.setFulfillmentGroup(group1);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,//fgi.setRetailPrice(new Money(15D));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,group1.addFulfillmentGroupItem(fgi);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,assert (order.getTotalTax().equals(order.getSubTotal().multiply(0.05D))); // Shipping price is not taxable
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,assert (order.getTotal().equals(order.getSubTotal().add(order.getTotalTax().add(order.getTotalShipping()))));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,public Customer createCustomer() {
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,Customer customer = customerService.createCustomerFromId(null);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,return customer;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"private OfferCode createOfferCode(String offerName, OfferType offerType, OfferDiscountType discountType, double value, String customerRule, String orderRule) {"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,OfferCode offerCode = new OfferCodeImpl();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"Offer offer = createOffer(offerName, offerType, discountType, value, customerRule, orderRule);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,offerCode.setOffer(offer);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"offerCode.setOfferCode(""OPRAH"");"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,offerCode = offerService.saveOfferCode(offerCode);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,return offerCode;
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"private Offer createOffer(String offerName, OfferType offerType, OfferDiscountType discountType, double value, String customerRule, String orderRule) {"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,Offer offer = new OfferImpl();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,offer.setName(offerName);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,offer.setStartDate(SystemTime.asDate());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,Calendar calendar = Calendar.getInstance();
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"calendar.add(Calendar.DATE, -1);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,offer.setStartDate(calendar.getTime());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"calendar.add(Calendar.DATE, 2);"
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,offer.setEndDate(calendar.getTime());
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,offer.setType(offerType);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,offer.setDiscountType(discountType);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,offer.setValue(BigDecimal.valueOf(value));
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,offer.setCombinableWithOtherOffers(true);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,offer = offerService.save(offer);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,offer.setMaxUsesPerOrder(50);
5b119847c3bc37cf68c08fe05ff46e26e35653cc,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,return offer;
d058a055199443c4e4083a34145198d4ec794b1f,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,"@ManyToOne(targetEntity = OrderItemImpl.class, cascade = {CascadeType.REFRESH})"
d058a055199443c4e4083a34145198d4ec794b1f,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,@ManyToOne(targetEntity = OrderItemImpl.class)
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"m2.setValue(""CollectionUtils.intersection(orderItem.?product.?manufacturer,[\""test manufacturer\""]).size()==0"");"
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,assert(expd1e1.getOperator().equals(BLCOperator.COLLECTION_NOT_IN.name()));
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"assert(expd1e1.getValue().equals(""[\""test manufacturer\""]""));"
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,}
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,public void testNestedExpressionExceptionForItemQualificationDataWrapper() throws MVELTranslationException {
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,MVELToDataWrapperTranslator translator = new MVELToDataWrapperTranslator();
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,Property[] p1 = new Property[3];
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,Property m1 = new Property();
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"m1.setName(""orderItemMatchRule"");"
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"m1.setValue(""discreteOrderItem.category.name==\""test category\"""");"
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,Property q1 = new Property();
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"q1.setName(""quantity"");"
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"q1.setValue(""1"");"
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,Property i1 = new Property();
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"i1.setName(""id"");"
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"i1.setValue(""100"");"
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,p1[0] = m1;
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,p1[1] = q1;
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,p1[2] = i1;
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,Entity e1 = new Entity();
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,e1.setProperties(p1);
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,Property[] p2 = new Property[3];
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,Property m2 = new Property();
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"m2.setName(""orderItemMatchRule"");"
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"m2.setValue(""!(discreteOrderItem.product.manufacturer==\""test manufacturer\"")"");"
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,Property q2 = new Property();
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"q2.setName(""quantity"");"
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"q2.setValue(""2"");"
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,Property i2 = new Property();
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"i2.setName(""id"");"
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"i2.setValue(""200"");"
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,p2[0] = m2;
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,p2[1] = q2;
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,p2[2] = i2;
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,Entity e2 = new Entity();
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,e2.setProperties(p2);
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,Entity[] entities = new Entity[2];
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,entities[0] = e1;
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,entities[1] = e2;
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"DataWrapper dataWrapper = translator.createRuleData(entities, ""orderItemMatchRule"", ""quantity"", ""id"", orderItemFieldService);"
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,assert(dataWrapper.getError().equals(MVELToDataWrapperTranslator.SUB_GROUP_MESSAGE));
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"mvelProperty.setValue(""fulfillmentGroup.address.state.name==\""Texas\""&&fulfillmentGroup.retailFulfillmentPrice.getAmount()>=99&&fulfillmentGroup.retailFulfillmentPrice.getAmount()<=199"");"
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,public void testNestedExpressionExceptionForFulfillmentGroupQualificationDataWrapper() throws MVELTranslationException {
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,Property[] properties = new Property[1];
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,Property mvelProperty = new Property();
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"mvelProperty.setName(""matchRule"");"
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"mvelProperty.setValue(""fulfillmentGroup.address.state.name==\""Texas\""&&(fulfillmentGroup.retailFulfillmentPrice.getAmount()>=99&&fulfillmentGroup.retailFulfillmentPrice.getAmount()<=199)"");"
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,properties[0] = mvelProperty;
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,Entity[] entities = new Entity[1];
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,Entity entity = new Entity();
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,entity.setProperties(properties);
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,entities[0] = entity;
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"DataWrapper dataWrapper = translator.createRuleData(entities, ""matchRule"", null, null, fulfillmentGroupFieldService);"
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,public void testNestedExpressionExceptionForItemQualificationCollectionDataWrapper() throws MVELTranslationException {
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"m1.setValue(""CollectionUtils.intersection(discreteOrderItem.?category.?name,[\""test category\"", \""test category 2\""]).size()>0&&discreteOrderItem.?quantity>5"");"
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"m2.setValue(""!(discreteOrderItem.product.manufacturer==\""test manufacturer\"")"");"
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,assert(dataWrapper.getData().get(1).getCondition().equals(BLCOperator.NOT.name()));
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,assert(expd1e1.getOperator().equals(BLCOperator.EQUALS.name()));
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"assert(expd1e1.getValue().equals(""test manufacturer""));"
b203175d1178ba53c11107cbcfc4d9d6105fe8e0,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"mvelProperty.setValue(""fulfillmentGroup.address.state.name==\""Texas\""&&(fulfillmentGroup.retailFulfillmentPrice.getAmount()>=99&&fulfillmentGroup.retailFulfillmentPrice.getAmount()<=199)"");"
deae97c2095c0c07ce60ce0697102acf7de0db98,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,return getRetailPriceInternal();
deae97c2095c0c07ce60ce0697102acf7de0db98,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,}
deae97c2095c0c07ce60ce0697102acf7de0db98,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,@Override
deae97c2095c0c07ce60ce0697102acf7de0db98,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,public Money getSalePrice() {
deae97c2095c0c07ce60ce0697102acf7de0db98,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,return getSalePriceInternal();
deae97c2095c0c07ce60ce0697102acf7de0db98,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,protected Money getRetailPriceInternal() {
deae97c2095c0c07ce60ce0697102acf7de0db98,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,protected Money getSalePriceInternal() {
deae97c2095c0c07ce60ce0697102acf7de0db98,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,if (defaultSku == null) {
deae97c2095c0c07ce60ce0697102acf7de0db98,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,return null;
deae97c2095c0c07ce60ce0697102acf7de0db98,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,} else {
deae97c2095c0c07ce60ce0697102acf7de0db98,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,added,0,return defaultSku.getSalePrice();
deae97c2095c0c07ce60ce0697102acf7de0db98,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,@Override
deae97c2095c0c07ce60ce0697102acf7de0db98,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,public Money getSalePrice() {
deae97c2095c0c07ce60ce0697102acf7de0db98,b5f116ae0dcfab45ff865c4bb5f96594868e1d38,deleted,1,return getRetailPrice();
0ceaca170b09f5ce284119ed60fde75c3aac6da9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,import org.broadleafcommerce.core.order.domain.OrderItem;
0ceaca170b09f5ce284119ed60fde75c3aac6da9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,*  for the given {@link Product} or {@link OrderItem}.
0ceaca170b09f5ce284119ed60fde75c3aac6da9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,"Map<String, List<PromotionMessageDTO>> generatePromotionMessages(Product product);"
0ceaca170b09f5ce284119ed60fde75c3aac6da9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,List<String> generatePromotionMessages(OrderItem orderItem);
0ceaca170b09f5ce284119ed60fde75c3aac6da9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,deleted,1,*  for the given {@link Product}.
0ceaca170b09f5ce284119ed60fde75c3aac6da9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,deleted,1,"public Map<String, List<PromotionMessageDTO>> generatePromotionMessages(Product product);"
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,import org.broadleafcommerce.core.promotionMessage.domain.type.PromotionMessagePlacementType;
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,import org.springframework.util.CollectionUtils;
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,import java.util.ArrayList;
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,"public static final String PLACEMENT = ""placement"";"
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,List<String> placementTypes = getPlacementFromArguments(element);
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,placementTypes.add(PromotionMessagePlacementType.EVERYWHERE.getType());
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,List<PromotionMessageDTO> filteredPromotionMessages = new ArrayList<>();
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,for (String type : promotionMessages.keySet()) {
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,if (placementTypes.contains(type)) {
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,filteredPromotionMessages.addAll(promotionMessages.get(type));
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,}
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,BLCPromotionMessageUtils.sortMessagesByPriority(filteredPromotionMessages);
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,"newVars.put(""promotionMessages"", filteredPromotionMessages);"
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,protected List<String> getPlacementFromArguments(Element element) {
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,String placementString = element.getAttributeValue(PLACEMENT);
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,List<String> requestedPlacement = new ArrayList<>();
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,"for (String placement : placementString.split("","")) {"
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,placement = placement.trim();
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,"if (testPlacementType(requestedPlacement, placement)) {"
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,requestedPlacement.add(placement);
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,return requestedPlacement;
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,"protected Boolean testPlacementType(List<String> requestedPlacement, String placement) {"
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,try {
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,PromotionMessagePlacementType type = PromotionMessagePlacementType.getInstance(placement);
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,requestedPlacement.add(type.getType());
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,} catch (Exception e) {
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,"LOG.error(""Unrecognized Promotion Message Placement Type"", e);"
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,return Boolean.FALSE;
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,added,0,return Boolean.TRUE;
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,deleted,1,BLCPromotionMessageUtils.sortMessagesByPriority(promotionMessages);
6e513aafff6837fe8526b64324d7975ffd4b0bd9,59684b01f7e295adaf4ad6af7bd426d37f1c17b9,deleted,1,"newVars.put(""promotionMessageMap"", promotionMessages);"
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import org.broadleafcommerce.openadmin.server.security.service.EntityFormModifierConfiguration;
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import com.fasterxml.jackson.core.Version;
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import com.fasterxml.jackson.databind.ObjectMapper;
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import com.fasterxml.jackson.databind.module.SimpleModule;
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import javax.annotation.Resource;
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import javax.persistence.ManyToOne;
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import javax.persistence.OneToOne;
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import javax.servlet.http.HttpServletRequest;
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,List<Field> headerFields = new ArrayList<>();
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,ArrayList<FieldDTO> defaultWrapperFields = new ArrayList<>();
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"Map<String, String> enumMap = new HashMap<>();"
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,if (allowNoValueEnum != null){
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"Map<String, String> options = new HashMap<>();"
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,List<Property> entityFormProperties = new ArrayList<>();
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,mapFormProperties = new ArrayList<>();
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,mapFormProperties = new ArrayList<>(Arrays.asList(cmd.getProperties()));
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import com.fasterxml.jackson.core.Version;
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import com.fasterxml.jackson.databind.ObjectMapper;
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import com.fasterxml.jackson.databind.module.SimpleModule;
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import org.broadleafcommerce.openadmin.server.security.service.EntityFormModifierConfiguration;
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import javax.annotation.Resource;
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import javax.persistence.ManyToOne;
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import javax.persistence.OneToOne;
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,import javax.servlet.http.HttpServletRequest;
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,List<Field> headerFields = new ArrayList<Field>();
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,ArrayList<FieldDTO> defaultWrapperFields = new ArrayList<FieldDTO>();
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"Map<String, String> enumMap = new HashMap<String, String>();"
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,if(allowNoValueEnum != null){
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,"Map<String, String> options = new HashMap<String, String>();"
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,List<Property> entityFormProperties = new ArrayList<Property>();
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,mapFormProperties = new ArrayList<Property>();
6a56b49f98fe91a2e74345d37c46131ba4cb2ec0,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,mapFormProperties = new ArrayList<Property>(Arrays.asList(cmd.getProperties()));
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,import org.broadleafcommerce.common.web.dialect.AbstractBroadleafAttributeModifierProcessor;
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,import org.broadleafcommerce.common.web.dialect.BroadleafDialectPrefix;
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,import org.broadleafcommerce.common.web.domain.BroadleafAttributeModifier;
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,import org.broadleafcommerce.common.web.domain.BroadleafThymeleafContext;
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,public class AdminComponentIdProcessor extends AbstractBroadleafAttributeModifierProcessor {
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,@Override
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,public String getName() {
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,"return ""component_id"";"
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,public BroadleafDialectPrefix getPrefix() {
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,return BroadleafDialectPrefix.BLC_ADMIN;
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,}
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,"public BroadleafAttributeModifier getModifiedAttributes(String tagName, Map<String, String> tagAttributes, String attributeName, String attributeValue, BroadleafThymeleafContext context) {"
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,Object component = context.parseExpression(attributeValue);
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,return new BroadleafAttributeModifier(attrs);
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.thymeleaf.Arguments;
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.thymeleaf.dom.Element;
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.thymeleaf.processor.attr.AbstractAttributeModifierAttrProcessor;
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.thymeleaf.standard.expression.Expression;
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.thymeleaf.standard.expression.StandardExpressions;
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,public class AdminComponentIdProcessor extends AbstractAttributeModifierAttrProcessor {
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,/**
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,* Sets the name of this processor to be used in Thymeleaf template
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,*/
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,public AdminComponentIdProcessor() {
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,"super(""component_id"");"
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,"protected Map<String, String> getModifiedAttributeValues(Arguments arguments, Element element, String attributeName) {"
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,Expression expression = (Expression) StandardExpressions.getExpressionParser(arguments.getConfiguration())
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,".parseExpression(arguments.getConfiguration(), arguments, element.getAttributeValue(attributeName));"
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,"Object component = expression.execute(arguments.getConfiguration(), arguments);"
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,return attrs;
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,@Override
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,"protected ModificationType getModificationType(Arguments arguments, Element element, String attributeName, String newAttributeName) {"
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,return ModificationType.SUBSTITUTION;
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,}
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,"protected boolean removeAttributeIfEmpty(Arguments arguments, Element element, String attributeName, String newAttributeName) {"
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,return true;
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,"protected boolean recomputeProcessorsAfterExecution(Arguments arguments, Element element, String attributeName) {"
49322e8be344cdff707c60099010c5c2ea8b9f9f,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,return false;
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,added,0,import org.broadleafcommerce.common.web.dialect.AbstractBroadleafAttributeModelVariableModifierProcessor;
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,added,0,import org.broadleafcommerce.common.web.dialect.BroadleafDialectPrefix;
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,added,0,import org.broadleafcommerce.common.web.domain.BroadleafThymeleafContext;
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,added,0,public class ErrorsProcessor extends AbstractBroadleafAttributeModelVariableModifierProcessor {
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,added,0,@Override
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,added,0,public String getName() {
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,added,0,"return ""errors"";"
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,added,0,public BroadleafDialectPrefix getPrefix() {
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,added,0,return BroadleafDialectPrefix.BLC_ADMIN;
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,added,0,}
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,added,0,"public void populateModelVariables(String tagName, Map<String, String> tagAttributes, String attributeName, String attributeValue, Map<String, Object> newLocalVariables, BroadleafThymeleafContext context) {"
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,added,0,BindStatus bindStatus = context.getBindStatus(attributeValue);
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,added,0,"newLocalVariables.put(""tabErrors"", tabErrors);"
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,added,0,return;
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,added,0,BroadleafRequestContext blcContext = BroadleafRequestContext.getBroadleafRequestContext();
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,added,0,if (blcContext != null && blcContext.getMessageSource() != null) {
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,added,0,"translatedGeneralTab = blcContext.getMessageSource().getMessage(translatedGeneralTab, null, translatedGeneralTab, blcContext.getJavaLocale());"
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,added,0,"newLocalVariables.put(""tabErrors"", result);"
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,import org.thymeleaf.Arguments;
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,import org.thymeleaf.dom.Element;
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,import org.thymeleaf.processor.ProcessorResult;
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,import org.thymeleaf.processor.attr.AbstractAttrProcessor;
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,import org.thymeleaf.spring4.util.FieldUtils;
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,public class ErrorsProcessor extends AbstractAttrProcessor {
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,public ErrorsProcessor() {
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,"super(""errors"");"
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,"protected ProcessorResult processAttribute(Arguments arguments, Element element, String attributeName) {"
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,String attributeValue = element.getAttributeValue(attributeName);
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,"BindStatus bindStatus = FieldUtils.getBindStatus(arguments.getConfiguration(), arguments, attributeValue);"
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,"Map<String, Object> localVariables = new HashMap<String, Object>();"
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,"localVariables.put(""tabErrors"", tabErrors);"
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,return ProcessorResult.setLocalVariables(localVariables);
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,BroadleafRequestContext context = BroadleafRequestContext.getBroadleafRequestContext();
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,if (context != null && context.getMessageSource() != null) {
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,"translatedGeneralTab = context.getMessageSource().getMessage(translatedGeneralTab, null, translatedGeneralTab, context.getJavaLocale());"
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,"localVariables.put(""tabErrors"", result);"
49322e8be344cdff707c60099010c5c2ea8b9f9f,f7f3ca2c1196f3df086281c689109c153833a776,deleted,1,return ProcessorResult.OK;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,import org.broadleafcommerce.common.web.dialect.AbstractBroadleafModelVariableModifierProcessor;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,import org.broadleafcommerce.common.web.domain.BroadleafThymeleafContext;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,import org.springframework.stereotype.Component;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,"@Component(""blHeadProcessor"")"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,public class HeadProcessor extends AbstractBroadleafModelVariableModifierProcessor {
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,public String getName() {
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,"return ""head"";"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,"public void populateModelVariables(String tagName, Map<String, String> tagAttributes, Map<String, Object> newModelVars, BroadleafThymeleafContext context) {"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,"String pageTitle = tagAttributes.get(""pageTitle"");"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,pageTitle = (String) context.parseExpression(pageTitle);
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,"newModelVars.put(""pageTitle"", pageTitle);"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,"newModelVars.put(""additionalCss"", tagAttributes.get(""additionalCss""));"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,"extensionManager.processAttributeValues(tagName, tagAttributes, newModelVars, context);"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,"//        return new FragmentAndTarget(HEAD_PARTIAL_PATH, WholeFragmentSpec.INSTANCE);"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.thymeleaf.Arguments;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.thymeleaf.dom.Element;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.thymeleaf.dom.Node;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.thymeleaf.exceptions.TemplateProcessingException;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.thymeleaf.processor.element.AbstractFragmentHandlingElementProcessor;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.thymeleaf.standard.expression.Expression;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.thymeleaf.standard.expression.StandardExpressions;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.thymeleaf.standard.processor.attr.StandardFragmentAttrProcessor;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import java.util.ArrayList;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import java.util.List;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,public class HeadProcessor extends AbstractFragmentHandlingElementProcessor {
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,public static final String FRAGMENT_ATTR_NAME = StandardFragmentAttrProcessor.ATTR_NAME;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,/**
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* Sets the name of this processor to be used in Thymeleaf template
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,*/
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,public HeadProcessor() {
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"super(""head"");"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,}
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,@Override
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,public int getPrecedence() {
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,return 10000;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"protected boolean getRemoveHostNode(final Arguments arguments, final Element element) {"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,return true;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"@SuppressWarnings(""unchecked"")"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"protected List<Node> computeFragment(final Arguments arguments, final Element element) {"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"String pageTitle = element.getAttributeValue(""pageTitle"");"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,try {
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,Expression expression = (Expression) StandardExpressions.getExpressionParser(arguments.getConfiguration())
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,".parseExpression(arguments.getConfiguration(), arguments, pageTitle);"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"pageTitle = (String) expression.execute(arguments.getConfiguration(), arguments);"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,} catch (TemplateProcessingException e) {
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,// Do nothing.
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"((Map<String, Object>) arguments.getExpressionEvaluationRoot()).put(""pageTitle"", pageTitle);"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"((Map<String, Object>) arguments.getExpressionEvaluationRoot()).put(""additionalCss"", element.getAttributeValue(""additionalCss""));"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"extensionManager.processAttributeValues(arguments, element);"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"//        return new FragmentAndTarget(HEAD_PARTIAL_PATH, WholeFragmentSpec.INSTANCE);"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,return new ArrayList<Node>();
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,import org.broadleafcommerce.common.web.domain.BroadleafThymeleafContext;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,import java.util.Map;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,"public void processAttributeValues(String tagName, Map<String, String> tagAttributes, Map<String, Object> newModelVars, BroadleafThymeleafContext context);"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.thymeleaf.Arguments;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.thymeleaf.dom.Element;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"public void processAttributeValues(Arguments arguments, Element element);"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,import org.broadleafcommerce.common.web.domain.BroadleafThymeleafContext;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,import org.springframework.stereotype.Component;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,import java.util.Map;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,"@Component(""blHeadProcessorExtensionManager"")"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,"public void processAttributeValues(String tagName, Map<String, String> tagAttributes, Map<String, Object> newModelVars, BroadleafThymeleafContext context) {"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,if (listeners == null) {
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,for (HeadProcessorExtensionListener listener : listeners) {
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,added,0,"listener.processAttributeValues(tagName, tagAttributes, newModelVars, context);"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.thymeleaf.Arguments;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.thymeleaf.dom.Element;
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"public void processAttributeValues(Arguments arguments, Element element) {"
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,if(listeners == null) {
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,for(HeadProcessorExtensionListener listener : listeners){
49322e8be344cdff707c60099010c5c2ea8b9f9f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"listener.processAttributeValues(arguments, element);"
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,added,0,import org.broadleafcommerce.core.catalog.domain.CategoryAdminPresentation;
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,added,0,"@AdminPresentation(friendlyName = ""OrderImpl_Customer"", group = GroupName.Customer,"
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,added,0,"@AdminPresentation(friendlyName = ""OrderImpl_Order_Total_Tax"", group = GroupName.OrderTotals,"
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,added,0,"@AdminPresentation(friendlyName = ""OrderImpl_Order_Total_Shipping"", group = GroupName.OrderTotals,"
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,added,0,"@AdminPresentation(friendlyName = ""OrderImpl_Order_Subtotal"", group = GroupName.OrderTotals,"
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,added,0,"@AdminPresentation(friendlyName = ""OrderImpl_Order_Total"", group = GroupName.OrderTotals,"
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,added,0,"@AdminPresentation(friendlyName = ""OrderImpl_Order_Email_Address"", group = GroupName.Customer,"
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,added,0,tab = TabName.General)
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,added,0,protected List<OrderItem> orderItems = new ArrayList<>();
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,added,0,tab = TabName.FulfillmentGroups)
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,added,0,protected List<FulfillmentGroup> fulfillmentGroups = new ArrayList<>();
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,added,0,protected List<OrderAdjustment> orderAdjustments = new ArrayList<>();
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,added,0,protected List<OfferCode> addedOfferCodes = new ArrayList<>();
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,added,0,protected List<CandidateOrderOffer> candidateOrderOffers = new ArrayList<>();
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,added,0,tab = TabName.Payment)
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,added,0,protected List<OrderPayment> payments = new ArrayList<>();
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,added,0,"protected Map<Offer, OfferInfo> additionalOfferInformation = new HashMap<>();"
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,added,0,"forceFreeFormKeys = true, keyPropertyFriendlyName = ""OrderImpl_Attributes_Key_Name"","
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,added,0,"group = GroupName.Advanced, order = FieldOrder.ATTRIBUTES)"
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,added,0,"protected Map<String,OrderAttribute> orderAttributes = new HashMap<>();"
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"@AdminPresentation(friendlyName = ""OrderImpl_Customer"", group = GroupName.General,"
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"@AdminPresentation(friendlyName = ""OrderImpl_Order_Total_Tax"", group = GroupName.General,"
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"@AdminPresentation(friendlyName = ""OrderImpl_Order_Total_Shipping"", group = GroupName.General,"
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"@AdminPresentation(friendlyName = ""OrderImpl_Order_Subtotal"", group = GroupName.General,"
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"@AdminPresentation(friendlyName = ""OrderImpl_Order_Total"", group = GroupName.General,"
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"@AdminPresentation(friendlyName = ""OrderImpl_Order_Email_Address"", group = GroupName.General,"
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,group = GroupName.OrderItems)
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,protected List<OrderItem> orderItems = new ArrayList<OrderItem>();
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,group = GroupName.FulfillmentGroups)
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,protected List<FulfillmentGroup> fulfillmentGroups = new ArrayList<FulfillmentGroup>();
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,protected List<OrderAdjustment> orderAdjustments = new ArrayList<OrderAdjustment>();
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,protected List<OfferCode> addedOfferCodes = new ArrayList<OfferCode>();
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,protected List<CandidateOrderOffer> candidateOrderOffers = new ArrayList<CandidateOrderOffer>();
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,group = GroupName.Payment)
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,protected List<OrderPayment> payments = new ArrayList<OrderPayment>();
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"protected Map<Offer, OfferInfo> additionalOfferInformation = new HashMap<Offer, OfferInfo>();"
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"forceFreeFormKeys = true, keyPropertyFriendlyName = ""OrderImpl_Attributes_Key_Name"", group = GroupName.Advanced"
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,)
8bd6aef8bf881c807d318a907f19ea0ab25d9e16,5e48559d6e0e5ba4608c25def6449573340e4af2,deleted,1,"protected Map<String,OrderAttribute> orderAttributes = new HashMap<String,OrderAttribute>();"
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,/*
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* #%L
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* BroadleafCommerce Framework Web
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* %%
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* Copyright (C) 2009 - 2016 Broadleaf Commerce
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"* Licensed under the Broadleaf Fair Use License Agreement, Version 1.0"
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"* (the ""Fair Use License"" located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)"
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* unless the restrictions on use therein are violated and require payment to Broadleaf in which case
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"* the Broadleaf End User License Agreement (EULA), Version 1.1"
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"* (the ""Commercial License"" located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)"
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* shall apply.
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,*
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"* Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the ""Custom License"")"
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* #L%
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,*/
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,package org.broadleafcommerce.core.web.api.wrapper;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,import org.broadleafcommerce.common.money.Money;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,import org.broadleafcommerce.core.order.domain.FulfillmentGroupItem;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,import org.broadleafcommerce.core.order.domain.OrderItem;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,import org.broadleafcommerce.core.order.domain.TaxDetail;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,import org.broadleafcommerce.core.order.service.OrderItemService;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,import org.broadleafcommerce.core.order.service.call.FulfillmentGroupItemRequest;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,import org.springframework.context.ApplicationContext;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,import java.util.ArrayList;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,import java.util.List;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,import javax.servlet.http.HttpServletRequest;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,import javax.xml.bind.annotation.XmlAccessType;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,import javax.xml.bind.annotation.XmlAccessorType;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,import javax.xml.bind.annotation.XmlElement;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,import javax.xml.bind.annotation.XmlElementWrapper;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,import javax.xml.bind.annotation.XmlRootElement;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,/**
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* This is a JAXB wrapper around FulfillmentGroupItem.
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* @deprecated - use {@link com.broadleafcommerce.core.rest.api.v2.wrapper.FulfillmentGroupItemWrapper}
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* User: Elbert Bautista
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* Date: 4/10/12
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,@Deprecated
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@XmlRootElement(name = ""fulfillmentGroupItem"")"
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,@XmlAccessorType(value = XmlAccessType.FIELD)
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"public class FulfillmentGroupItemWrapper extends BaseWrapper implements APIWrapper<FulfillmentGroupItem>, APIUnwrapper<FulfillmentGroupItemRequest> {"
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,@XmlElement
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,protected Long id;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,protected Long fulfillmentGroupId;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,protected Long orderItemId;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,protected Money totalTax;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,protected Integer quantity;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,protected Money totalItemAmount;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@XmlElement(name = ""taxDetail"")"
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"@XmlElementWrapper(name = ""taxDetails"")"
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,protected List<TaxDetailWrapper> taxDetails;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,@Override
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"public void wrapDetails(FulfillmentGroupItem model, HttpServletRequest request) {"
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,this.id = model.getId();
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,if (model.getFulfillmentGroup() != null) {
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,this.fulfillmentGroupId = model.getFulfillmentGroup().getId();
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,}
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,if (model.getOrderItem() != null) {
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,this.orderItemId = model.getOrderItem().getId();
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,this.totalTax = model.getTotalTax();
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,this.quantity = model.getQuantity();
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,this.totalItemAmount = model.getTotalItemAmount();
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,List<TaxDetail> taxes = model.getTaxes();
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,if (taxes != null && !taxes.isEmpty()) {
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,this.taxDetails = new ArrayList<TaxDetailWrapper>();
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,for (TaxDetail detail : taxes) {
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,TaxDetailWrapper taxDetailWrapper = (TaxDetailWrapper) context.getBean(TaxDetailWrapper.class.getName());
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"taxDetailWrapper.wrapSummary(detail, request);"
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,this.taxDetails.add(taxDetailWrapper);
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"public void wrapSummary(FulfillmentGroupItem model, HttpServletRequest request) {"
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"wrapDetails(model, request);"
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"public FulfillmentGroupItemRequest unwrap(HttpServletRequest request, ApplicationContext appContext) {"
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"OrderItemService orderItemService = (OrderItemService) appContext.getBean(""blOrderItemService"");"
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,OrderItem orderItem = orderItemService.readOrderItemById(this.orderItemId);
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,if (orderItem != null) {
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,FulfillmentGroupItemRequest fulfillmentGroupItemRequest = new FulfillmentGroupItemRequest();
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,fulfillmentGroupItemRequest.setOrderItem(orderItem);
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,fulfillmentGroupItemRequest.setQuantity(this.quantity);
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return fulfillmentGroupItemRequest;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return null;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* @return the id
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public Long getId() {
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return id;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* @param id the id to set
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public void setId(Long id) {
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,this.id = id;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* @return the fulfillmentGroupId
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public Long getFulfillmentGroupId() {
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return fulfillmentGroupId;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* @param fulfillmentGroupId the fulfillmentGroupId to set
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public void setFulfillmentGroupId(Long fulfillmentGroupId) {
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,this.fulfillmentGroupId = fulfillmentGroupId;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* @return the orderItemId
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public Long getOrderItemId() {
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return orderItemId;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* @param orderItemId the orderItemId to set
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public void setOrderItemId(Long orderItemId) {
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,this.orderItemId = orderItemId;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* @return the totalTax
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public Money getTotalTax() {
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return totalTax;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* @param totalTax the totalTax to set
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public void setTotalTax(Money totalTax) {
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,this.totalTax = totalTax;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* @return the quantity
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public Integer getQuantity() {
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return quantity;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* @param quantity the quantity to set
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public void setQuantity(Integer quantity) {
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,this.quantity = quantity;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* @return the totalItemAmount
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public Money getTotalItemAmount() {
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return totalItemAmount;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* @param totalItemAmount the totalItemAmount to set
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public void setTotalItemAmount(Money totalItemAmount) {
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,this.totalItemAmount = totalItemAmount;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* @return the taxDetails
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public List<TaxDetailWrapper> getTaxDetails() {
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,return taxDetails;
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,* @param taxDetails the taxDetails to set
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,public void setTaxDetails(List<TaxDetailWrapper> taxDetails) {
8a35655c2715a32af2a426fecfb64b30e8ef4444,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,this.taxDetails = taxDetails;
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,/*
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* #%L
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* BroadleafCommerce Framework Web
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* %%
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* Copyright (C) 2009 - 2016 Broadleaf Commerce
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"* Licensed under the Broadleaf Fair Use License Agreement, Version 1.0"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"* (the ""Fair Use License"" located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* unless the restrictions on use therein are violated and require payment to Broadleaf in which case
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"* the Broadleaf End User License Agreement (EULA), Version 1.1"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"* (the ""Commercial License"" located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* shall apply.
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,*
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"* Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the ""Custom License"")"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* #L%
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,*/
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,package org.broadleafcommerce.core.web.processor;
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.broadleafcommerce.common.web.condition.TemplatingExistCondition;
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.broadleafcommerce.common.web.dialect.AbstractBroadleafModelVariableModifierProcessor;
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.broadleafcommerce.common.web.domain.BroadleafTemplateContext;
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.broadleafcommerce.core.web.processor.extension.HeadProcessorExtensionListener;
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.springframework.context.annotation.Conditional;
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.springframework.stereotype.Component;
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import java.util.Map;
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import javax.annotation.Resource;
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,/**
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* A Thymeleaf processor that will include the standard head element. It will also set the
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* following variables for use by the head fragment.
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* <ul>
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,*  <li><b>pageTitle</b> - The title of the page</li>
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"*  <li><b>additionalCss</b> - An additional, page specific CSS file to include</li>"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"*  <li><b>metaDescription</b> - Optional, Content for the Meta-Description tag</li>"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"*  <li><b>metaKeywords</b> - Optional, Content for the Meta-Keywords tag</li>"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"*  <li><b>metaRobot</b> - Optional, Content for the Meta-Robots tag</li>"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* </ul>
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* @author apazzolini
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* @deprecated
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* The entire FragmentAndTarget class has been deprecated in favor of a completely new system in Thymeleaf 2.1
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* The referenced issue can be found at https://github.com/thymeleaf/thymeleaf/issues/205
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* Use th:include or th:replace within the head tag and include the variables to replicate the behaviour.
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* Examples:
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"* <head th:include=""/layout/partials/head (pageTitle='My Page Title')""></head>"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"* <head th:include=""/layout/partials/head (twovar=${value2},onevar=${value1})"">...</head>"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,@Deprecated
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"@Component(""blHeadProcessor"")"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,@Conditional(TemplatingExistCondition.class)
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,public class HeadProcessor extends AbstractBroadleafModelVariableModifierProcessor {
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"@Resource(name = ""blHeadProcessorExtensionManager"")"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,protected HeadProcessorExtensionListener extensionManager;
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"protected String HEAD_PARTIAL_PATH = ""layout/partials/head"";"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,@Override
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,public String getName() {
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"return ""head"";"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,}
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"public void populateModelVariables(String tagName, Map<String, String> tagAttributes, Map<String, Object> newModelVars, BroadleafTemplateContext context) {"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"// The pageTitle attribute could be an expression that needs to be evaluated. Try to evaluate, but fall back"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,// to its text value if the expression wasn't able to be processed. This will allow things like
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"// pageTitle=""Hello this is a string"""
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,// as well as expressions like
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"// pageTitle=""${'Hello this is a ' + product.name}"""
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"String pageTitle = tagAttributes.get(""pageTitle"");"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,pageTitle = (String) context.parseExpression(pageTitle);
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"newModelVars.put(""pageTitle"", pageTitle);"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"newModelVars.put(""additionalCss"", tagAttributes.get(""additionalCss""));"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"extensionManager.processAttributeValues(tagName, tagAttributes, newModelVars, context);"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,//the commit at https://github.com/thymeleaf/thymeleaf/commit/b214d9b5660369c41538e023d4b8d7223ebcbc22 along with
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,//the referenced issue at https://github.com/thymeleaf/thymeleaf/issues/205
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"//        return new FragmentAndTarget(HEAD_PARTIAL_PATH, WholeFragmentSpec.INSTANCE);"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,/*
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* #%L
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* BroadleafCommerce Framework Web
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* %%
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* Copyright (C) 2009 - 2016 Broadleaf Commerce
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"* Licensed under the Broadleaf Fair Use License Agreement, Version 1.0"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"* (the ""Fair Use License"" located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* unless the restrictions on use therein are violated and require payment to Broadleaf in which case
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"* the Broadleaf End User License Agreement (EULA), Version 1.1"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"* (the ""Commercial License"" located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* shall apply.
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,*
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"* Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the ""Custom License"")"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* #L%
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,*/
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,package org.broadleafcommerce.core.web.processor.extension;
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.broadleafcommerce.presentation.model.BroadleafTemplateContext;
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import java.util.Map;
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,/**
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* @author Jerry Ocanas (jocanas)
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,public interface HeadProcessorExtensionListener {
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"public void processAttributeValues(String tagName, Map<String, String> tagAttributes, Map<String, Object> newModelVars, BroadleafTemplateContext context);"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,}
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,/*
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* #%L
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* BroadleafCommerce Framework Web
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* %%
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* Copyright (C) 2009 - 2016 Broadleaf Commerce
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"* Licensed under the Broadleaf Fair Use License Agreement, Version 1.0"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"* (the ""Fair Use License"" located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* unless the restrictions on use therein are violated and require payment to Broadleaf in which case
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"* the Broadleaf End User License Agreement (EULA), Version 1.1"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"* (the ""Commercial License"" located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* shall apply.
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,*
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"* Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the ""Custom License"")"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* #L%
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,*/
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,package org.broadleafcommerce.core.web.processor.extension;
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.broadleafcommerce.presentation.condition.TemplatingExistCondition;
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.broadleafcommerce.presentation.model.BroadleafTemplateContext;
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.springframework.context.annotation.Conditional;
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import org.springframework.stereotype.Component;
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import java.util.ArrayList;
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import java.util.List;
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,import java.util.Map;
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,/**
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,* @author Jerry Ocanas (jocanas)
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"@Component(""blHeadProcessorExtensionManager"")"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,@Conditional(TemplatingExistCondition.class)
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,public class HeadProcessorExtensionManager implements HeadProcessorExtensionListener {
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,protected List<HeadProcessorExtensionListener> listeners;
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,@Override
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"public void processAttributeValues(String tagName, Map<String, String> tagAttributes, Map<String, Object> newModelVars, BroadleafTemplateContext context) {"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,if (listeners == null) {
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,listeners = new ArrayList<HeadProcessorExtensionListener>();
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,}
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,for (HeadProcessorExtensionListener listener : listeners) {
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,"listener.processAttributeValues(tagName, tagAttributes, newModelVars, context);"
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,public List<HeadProcessorExtensionListener> getListeners() {
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,return listeners;
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,public void setListeners(List<HeadProcessorExtensionListener> listeners) {
02502f98fd95547dabe87f4fc473bca8ea28918f,1a7e19f9df4f22f9372c3fd80d1c1752ec620adf,deleted,1,this.listeners = listeners;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.broadleafcommerce.common.persistence.DefaultPostLoaderDao;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.broadleafcommerce.common.persistence.PostLoaderDao;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.broadleafcommerce.common.presentation.AdminPresentation;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationClass;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationCollection;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationMap;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationToOneLookup;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.broadleafcommerce.common.presentation.PopulateToOneFieldsEnum;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.hibernate.annotations.CacheConcurrencyStrategy;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.hibernate.annotations.GenericGenerator;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.hibernate.annotations.Index;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.hibernate.annotations.NotFound;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.hibernate.annotations.NotFoundAction;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.CascadeType;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.Column;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.Entity;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.FetchType;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.GeneratedValue;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.Id;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.Inheritance;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.InheritanceType;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.JoinColumn;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.ManyToOne;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.MapKey;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.OneToMany;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.Table;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.Transient;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,if (postLoaderDao != null) {
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,"deproxiedCategory = postLoaderDao.find(CategoryImpl.class, id);"
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDao;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDaoImpl;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,import org.broadleafcommerce.common.presentation.*;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,import org.broadleafcommerce.core.catalog.domain.ProductImpl;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,import org.broadleafcommerce.core.offer.domain.OfferImpl;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,import org.hibernate.annotations.*;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,import javax.persistence.CascadeType;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,import javax.persistence.*;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,import javax.persistence.Entity;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,import javax.persistence.Table;
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,GenericEntityDao genericEntityDao = GenericEntityDaoImpl.getGenericEntityDao();
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,if (genericEntityDao != null) {
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,genericEntityDao.getEntityManager().detach(category);
fda9767f4d72af66404998254019965ddd1fd051,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,"deproxiedCategory = genericEntityDao.getEntityManager().find(CategoryImpl.class, id);"
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.persistence.DefaultPostLoaderDao;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.persistence.PostLoaderDao;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.presentation.AdminPresentation;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationClass;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationCollection;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationMap;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationToOneLookup;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.presentation.PopulateToOneFieldsEnum;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.hibernate.annotations.CacheConcurrencyStrategy;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.hibernate.annotations.GenericGenerator;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.hibernate.annotations.Index;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.hibernate.annotations.NotFound;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.hibernate.annotations.NotFoundAction;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.CascadeType;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.Column;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.Entity;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.FetchType;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.GeneratedValue;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.Id;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.Inheritance;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.InheritanceType;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.JoinColumn;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.ManyToOne;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.MapKey;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.OneToMany;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.Table;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.Transient;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,if (postLoaderDao != null) {
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,"deproxiedCategory = postLoaderDao.find(CategoryImpl.class, id);"
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDao;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDaoImpl;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import org.broadleafcommerce.common.presentation.*;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import org.broadleafcommerce.core.catalog.domain.ProductImpl;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import org.broadleafcommerce.core.offer.domain.OfferImpl;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import org.hibernate.annotations.*;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import javax.persistence.CascadeType;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import javax.persistence.*;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import javax.persistence.Entity;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import javax.persistence.Table;
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,GenericEntityDao genericEntityDao = GenericEntityDaoImpl.getGenericEntityDao();
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,if (genericEntityDao != null) {
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,genericEntityDao.getEntityManager().detach(category);
fda9767f4d72af66404998254019965ddd1fd051,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,"deproxiedCategory = genericEntityDao.getEntityManager().find(CategoryImpl.class, id);"
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.persistence.DefaultPostLoaderDao;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.persistence.PostLoaderDao;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.presentation.AdminPresentation;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationClass;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationCollection;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationMap;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationToOneLookup;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.presentation.PopulateToOneFieldsEnum;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.hibernate.annotations.CacheConcurrencyStrategy;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.hibernate.annotations.GenericGenerator;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.hibernate.annotations.Index;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.hibernate.annotations.NotFound;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.hibernate.annotations.NotFoundAction;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.CascadeType;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.Column;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.Entity;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.FetchType;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.GeneratedValue;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.Id;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.Inheritance;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.InheritanceType;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.JoinColumn;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.ManyToOne;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.MapKey;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.OneToMany;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.Table;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.Transient;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,if (postLoaderDao != null) {
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,"deproxiedCategory = postLoaderDao.find(CategoryImpl.class, id);"
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDao;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDaoImpl;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import org.broadleafcommerce.common.presentation.*;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import org.broadleafcommerce.core.catalog.domain.ProductImpl;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import org.broadleafcommerce.core.offer.domain.OfferImpl;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import org.hibernate.annotations.*;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import javax.persistence.CascadeType;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import javax.persistence.*;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import javax.persistence.Entity;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import javax.persistence.Table;
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,GenericEntityDao genericEntityDao = GenericEntityDaoImpl.getGenericEntityDao();
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,if (genericEntityDao != null) {
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,genericEntityDao.getEntityManager().detach(category);
fda9767f4d72af66404998254019965ddd1fd051,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,"deproxiedCategory = genericEntityDao.getEntityManager().find(CategoryImpl.class, id);"
1a95513d0a266c249f33da6232973d927b3ff5bb,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
1a95513d0a266c249f33da6232973d927b3ff5bb,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,if (postLoaderDao != null) {
1a95513d0a266c249f33da6232973d927b3ff5bb,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,Long id = category.getId();
1a95513d0a266c249f33da6232973d927b3ff5bb,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,"deproxiedCategory = postLoaderDao.find(CategoryImpl.class, id);"
1a95513d0a266c249f33da6232973d927b3ff5bb,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,} else if (category instanceof HibernateProxy) {
1a95513d0a266c249f33da6232973d927b3ff5bb,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,deproxiedCategory = HibernateUtils.deproxy(category);
1a95513d0a266c249f33da6232973d927b3ff5bb,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,if (category instanceof HibernateProxy) {
1a95513d0a266c249f33da6232973d927b3ff5bb,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
1a95513d0a266c249f33da6232973d927b3ff5bb,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,if (postLoaderDao != null) {
1a95513d0a266c249f33da6232973d927b3ff5bb,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,Long id = category.getId();
1a95513d0a266c249f33da6232973d927b3ff5bb,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,"deproxiedCategory = postLoaderDao.find(CategoryImpl.class, id);"
1a95513d0a266c249f33da6232973d927b3ff5bb,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,} else {
1a95513d0a266c249f33da6232973d927b3ff5bb,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,deproxiedCategory = HibernateUtils.deproxy(category);
1a95513d0a266c249f33da6232973d927b3ff5bb,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,}
1a95513d0a266c249f33da6232973d927b3ff5bb,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
1a95513d0a266c249f33da6232973d927b3ff5bb,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,if (postLoaderDao != null) {
1a95513d0a266c249f33da6232973d927b3ff5bb,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,Long id = category.getId();
1a95513d0a266c249f33da6232973d927b3ff5bb,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,"deproxiedCategory = postLoaderDao.find(CategoryImpl.class, id);"
1a95513d0a266c249f33da6232973d927b3ff5bb,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,} else if (category instanceof HibernateProxy) {
1a95513d0a266c249f33da6232973d927b3ff5bb,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,deproxiedCategory = HibernateUtils.deproxy(category);
1a95513d0a266c249f33da6232973d927b3ff5bb,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,if (category instanceof HibernateProxy) {
1a95513d0a266c249f33da6232973d927b3ff5bb,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
1a95513d0a266c249f33da6232973d927b3ff5bb,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,if (postLoaderDao != null) {
1a95513d0a266c249f33da6232973d927b3ff5bb,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,Long id = category.getId();
1a95513d0a266c249f33da6232973d927b3ff5bb,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,"deproxiedCategory = postLoaderDao.find(CategoryImpl.class, id);"
1a95513d0a266c249f33da6232973d927b3ff5bb,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,} else {
1a95513d0a266c249f33da6232973d927b3ff5bb,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,deproxiedCategory = HibernateUtils.deproxy(category);
1a95513d0a266c249f33da6232973d927b3ff5bb,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,}
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.persistence.DefaultPostLoaderDao;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.persistence.PostLoaderDao;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.util.HibernateUtils;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.hibernate.proxy.HibernateProxy;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,@Transient
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,protected Offer deproxiedOffer;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,if (deproxiedOffer == null) {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,if (postLoaderDao != null) {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,"deproxiedOffer = postLoaderDao.find(OfferImpl.class, id);"
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,} else if (offer instanceof HibernateProxy) {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,deproxiedOffer = HibernateUtils.deproxy(offer);
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,} else {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,deproxiedOffer = offer;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,}
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,return deproxiedOffer;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,sbClonedOffer = deproxiedOffer = null;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,"//This guarantees that the offer is the correct one based on sandboxed state.  If the offer has been overridden/cloned in the local site,"
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,//  then that overridden/cloned offer will be used.
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,if (sbClonedOffer == null) {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,GenericEntityDao genericEntityDao = GenericEntityDaoImpl.getGenericEntityDao();
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,if (genericEntityDao != null && offer != null && offer.getId() != null) {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,"sbClonedOffer = genericEntityDao.getEntityManager().find(OfferImpl.class, id);"
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,}
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,"//if for some reason the cloned offer was not found, at a minimum return the original offer (so we are not returning null)"
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,sbClonedOffer = offer;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,return sbClonedOffer;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,sbClonedOffer = null;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.persistence.DefaultPostLoaderDao;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.persistence.PostLoaderDao;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.util.HibernateUtils;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.hibernate.proxy.HibernateProxy;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,@Transient
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,protected Offer deproxiedOffer;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,if (deproxiedOffer == null) {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,if (postLoaderDao != null) {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,"deproxiedOffer = postLoaderDao.find(OfferImpl.class, id);"
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,} else if (offer instanceof HibernateProxy) {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,deproxiedOffer = HibernateUtils.deproxy(offer);
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,} else {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,deproxiedOffer = offer;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,}
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,return deproxiedOffer;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,sbClonedOffer = deproxiedOffer = null;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,"//This guarantees that the offer is the correct one based on sandboxed state.  If the offer has been overridden/cloned in the local site,"
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,//  then that overridden/cloned offer will be used.
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,if (sbClonedOffer == null) {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,GenericEntityDao genericEntityDao = GenericEntityDaoImpl.getGenericEntityDao();
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,if (genericEntityDao != null && offer != null && offer.getId() != null) {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,"sbClonedOffer = genericEntityDao.getEntityManager().find(OfferImpl.class, id);"
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,}
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,"//if for some reason the cloned offer was not found, at a minimum return the original offer (so we are not returning null)"
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,sbClonedOffer = offer;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,return sbClonedOffer;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,sbClonedOffer = null;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.persistence.DefaultPostLoaderDao;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.persistence.PostLoaderDao;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.util.HibernateUtils;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.hibernate.proxy.HibernateProxy;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,@Transient
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected Offer deproxiedOffer;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,setOrderItemPriceDetail(orderItemPriceDetail);
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,setReason(reason);
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (deproxiedOffer == null) {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (postLoaderDao != null) {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,Long id = offer.getId();
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"deproxiedOffer = postLoaderDao.find(OfferImpl.class, id);"
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,} else if (offer instanceof HibernateProxy) {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,deproxiedOffer = HibernateUtils.deproxy(offer);
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,} else {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,deproxiedOffer = offer;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return deproxiedOffer;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (reason != null) {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.reason = reason;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,} else if (this.offerName != null) {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.reason = this.offerName;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,deproxiedOffer = null;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.orderItemPriceDetail = orderItemPriceDetail;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (reason == null) {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.reason = reason;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.reason = offer.getName();
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,}
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return offer;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,import org.broadleafcommerce.common.persistence.DefaultPostLoaderDao;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,import org.broadleafcommerce.common.persistence.PostLoaderDao;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,import org.broadleafcommerce.common.util.HibernateUtils;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,import org.hibernate.proxy.HibernateProxy;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,@Transient
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,protected Offer deproxiedOffer;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,setOrderItemPriceDetail(orderItemPriceDetail);
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,setReason(reason);
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,if (deproxiedOffer == null) {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,if (postLoaderDao != null) {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,Long id = offer.getId();
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,"deproxiedOffer = postLoaderDao.find(OfferImpl.class, id);"
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,} else if (offer instanceof HibernateProxy) {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,deproxiedOffer = HibernateUtils.deproxy(offer);
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,} else {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,deproxiedOffer = offer;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,}
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,return deproxiedOffer;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,if (reason != null) {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,this.reason = reason;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,} else if (this.offerName != null) {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,this.reason = this.offerName;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,deproxiedOffer = null;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,this.orderItemPriceDetail = orderItemPriceDetail;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,if (reason == null) {
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,this.reason = reason;
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,this.reason = offer.getName();
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,}
ffced3a37c8c9aed090e2e3ae5cd4885411f0d09,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,return offer;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.persistence.DefaultPostLoaderDao;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.persistence.PostLoaderDao;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.util.HibernateUtils;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.hibernate.proxy.HibernateProxy;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,@Transient
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,protected Offer deproxiedOffer;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,if (deproxiedOffer == null) {
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,if (postLoaderDao != null) {
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,"deproxiedOffer = postLoaderDao.find(OfferImpl.class, id);"
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,} else if (offer instanceof HibernateProxy) {
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,deproxiedOffer = HibernateUtils.deproxy(offer);
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,} else {
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,deproxiedOffer = offer;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,}
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,return deproxiedOffer;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,sbClonedOffer = deproxiedOffer = null;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,"//This guarantees that the offer is the correct one based on sandboxed state.  If the offer has been overridden/cloned in the local site,"
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,//  then that overridden/cloned offer will be used.
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,if (sbClonedOffer == null) {
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,GenericEntityDao genericEntityDao = GenericEntityDaoImpl.getGenericEntityDao();
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,if (genericEntityDao != null && offer != null && offer.getId() != null) {
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,"sbClonedOffer = genericEntityDao.getEntityManager().find(OfferImpl.class, id);"
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,}
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,"//if for some reason the cloned offer was not found, at a minimum return the original offer (so we are not returning null)"
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,sbClonedOffer = offer;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,return sbClonedOffer;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,sbClonedOffer = null;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.persistence.DefaultPostLoaderDao;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.persistence.PostLoaderDao;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.util.HibernateUtils;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.hibernate.proxy.HibernateProxy;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,@Transient
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,protected Offer deproxiedOffer;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,if (deproxiedOffer == null) {
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,if (postLoaderDao != null) {
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,"deproxiedOffer = postLoaderDao.find(OfferImpl.class, id);"
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,} else if (offer instanceof HibernateProxy) {
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,deproxiedOffer = HibernateUtils.deproxy(offer);
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,} else {
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,deproxiedOffer = offer;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,}
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,return deproxiedOffer;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,sbClonedOffer = deproxiedOffer = null;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,"//This guarantees that the offer is the correct one based on sandboxed state.  If the offer has been overridden/cloned in the local site,"
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,//  then that overridden/cloned offer will be used.
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,if (sbClonedOffer == null) {
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,GenericEntityDao genericEntityDao = GenericEntityDaoImpl.getGenericEntityDao();
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,if (genericEntityDao != null && offer != null && offer.getId() != null) {
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,"sbClonedOffer = genericEntityDao.getEntityManager().find(OfferImpl.class, id);"
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,}
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,"//if for some reason the cloned offer was not found, at a minimum return the original offer (so we are not returning null)"
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,sbClonedOffer = offer;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,return sbClonedOffer;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,sbClonedOffer = null;
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.persistence.DefaultPostLoaderDao;
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.persistence.PostLoaderDao;
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.util.HibernateUtils;
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.hibernate.proxy.HibernateProxy;
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,@Transient
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected Offer deproxiedOffer;
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,setOrderItemPriceDetail(orderItemPriceDetail);
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,setReason(reason);
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (deproxiedOffer == null) {
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (postLoaderDao != null) {
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,Long id = offer.getId();
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"deproxiedOffer = postLoaderDao.find(OfferImpl.class, id);"
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,} else if (offer instanceof HibernateProxy) {
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,deproxiedOffer = HibernateUtils.deproxy(offer);
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,} else {
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,deproxiedOffer = offer;
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return deproxiedOffer;
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (reason != null) {
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.reason = reason;
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,} else if (this.offerName != null) {
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.reason = this.offerName;
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,deproxiedOffer = null;
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.orderItemPriceDetail = orderItemPriceDetail;
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (reason == null) {
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.reason = reason;
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.reason = offer.getName();
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,}
83fb11ed58644108db5d65f28772c299943478f5,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return offer;
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,import org.broadleafcommerce.common.persistence.DefaultPostLoaderDao;
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,import org.broadleafcommerce.common.persistence.PostLoaderDao;
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,import org.broadleafcommerce.common.util.HibernateUtils;
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,import org.hibernate.proxy.HibernateProxy;
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,@Transient
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,protected Offer deproxiedOffer;
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,setOrderItemPriceDetail(orderItemPriceDetail);
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,setReason(reason);
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,if (deproxiedOffer == null) {
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,if (postLoaderDao != null) {
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,Long id = offer.getId();
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,"deproxiedOffer = postLoaderDao.find(OfferImpl.class, id);"
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,} else if (offer instanceof HibernateProxy) {
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,deproxiedOffer = HibernateUtils.deproxy(offer);
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,} else {
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,deproxiedOffer = offer;
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,}
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,return deproxiedOffer;
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,if (reason != null) {
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,this.reason = reason;
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,} else if (this.offerName != null) {
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,this.reason = this.offerName;
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,deproxiedOffer = null;
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,this.orderItemPriceDetail = orderItemPriceDetail;
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,if (reason == null) {
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,this.reason = reason;
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,this.reason = offer.getName();
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,}
83fb11ed58644108db5d65f28772c299943478f5,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,return offer;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.broadleafcommerce.common.persistence.DefaultPostLoaderDao;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.broadleafcommerce.common.persistence.PostLoaderDao;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.broadleafcommerce.common.presentation.AdminPresentation;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationClass;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationCollection;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationMap;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationToOneLookup;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.broadleafcommerce.common.presentation.PopulateToOneFieldsEnum;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.hibernate.annotations.CacheConcurrencyStrategy;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.hibernate.annotations.GenericGenerator;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.hibernate.annotations.Index;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.hibernate.annotations.NotFound;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.hibernate.annotations.NotFoundAction;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.CascadeType;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.Column;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.Entity;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.FetchType;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.GeneratedValue;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.Id;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.Inheritance;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.InheritanceType;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.JoinColumn;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.ManyToOne;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.MapKey;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.OneToMany;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.Table;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import javax.persistence.Transient;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,if (postLoaderDao != null) {
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,Long id = category.getId();
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,"deproxiedCategory = postLoaderDao.find(CategoryImpl.class, id);"
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,} else if (category instanceof HibernateProxy) {
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,deproxiedCategory = HibernateUtils.deproxy(category);
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDao;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDaoImpl;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,import org.broadleafcommerce.common.presentation.*;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,import org.broadleafcommerce.core.catalog.domain.ProductImpl;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,import org.broadleafcommerce.core.offer.domain.OfferImpl;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,import org.hibernate.annotations.*;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,import javax.persistence.CascadeType;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,import javax.persistence.*;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,import javax.persistence.Entity;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,import javax.persistence.Table;
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,if (category instanceof HibernateProxy) {
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,GenericEntityDao genericEntityDao = GenericEntityDaoImpl.getGenericEntityDao();
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,if (genericEntityDao != null) {
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,Long id = category.getId();
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,genericEntityDao.getEntityManager().detach(category);
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,"deproxiedCategory = genericEntityDao.getEntityManager().find(CategoryImpl.class, id);"
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,} else {
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,deproxiedCategory = HibernateUtils.deproxy(category);
83fb11ed58644108db5d65f28772c299943478f5,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,}
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.persistence.DefaultPostLoaderDao;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.persistence.PostLoaderDao;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.presentation.AdminPresentation;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationClass;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationCollection;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationMap;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationToOneLookup;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.presentation.PopulateToOneFieldsEnum;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.hibernate.annotations.CacheConcurrencyStrategy;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.hibernate.annotations.GenericGenerator;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.hibernate.annotations.Index;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.hibernate.annotations.NotFound;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.hibernate.annotations.NotFoundAction;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.CascadeType;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.Column;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.Entity;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.FetchType;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.GeneratedValue;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.Id;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.Inheritance;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.InheritanceType;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.JoinColumn;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.ManyToOne;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.MapKey;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.OneToMany;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.Table;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import javax.persistence.Transient;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,if (postLoaderDao != null) {
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,Long id = category.getId();
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,"deproxiedCategory = postLoaderDao.find(CategoryImpl.class, id);"
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,} else if (category instanceof HibernateProxy) {
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,deproxiedCategory = HibernateUtils.deproxy(category);
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDao;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDaoImpl;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import org.broadleafcommerce.common.presentation.*;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import org.broadleafcommerce.core.catalog.domain.ProductImpl;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import org.broadleafcommerce.core.offer.domain.OfferImpl;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import org.hibernate.annotations.*;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import javax.persistence.CascadeType;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import javax.persistence.*;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import javax.persistence.Entity;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import javax.persistence.Table;
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,if (category instanceof HibernateProxy) {
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,GenericEntityDao genericEntityDao = GenericEntityDaoImpl.getGenericEntityDao();
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,if (genericEntityDao != null) {
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,Long id = category.getId();
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,genericEntityDao.getEntityManager().detach(category);
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,"deproxiedCategory = genericEntityDao.getEntityManager().find(CategoryImpl.class, id);"
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,} else {
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,deproxiedCategory = HibernateUtils.deproxy(category);
83fb11ed58644108db5d65f28772c299943478f5,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,}
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.persistence.DefaultPostLoaderDao;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.persistence.PostLoaderDao;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.presentation.AdminPresentation;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationClass;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationCollection;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationMap;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationToOneLookup;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.presentation.PopulateToOneFieldsEnum;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.hibernate.annotations.CacheConcurrencyStrategy;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.hibernate.annotations.GenericGenerator;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.hibernate.annotations.Index;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.hibernate.annotations.NotFound;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.hibernate.annotations.NotFoundAction;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.CascadeType;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.Column;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.Entity;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.FetchType;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.GeneratedValue;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.Id;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.Inheritance;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.InheritanceType;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.JoinColumn;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.ManyToOne;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.MapKey;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.OneToMany;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.Table;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import javax.persistence.Transient;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,if (postLoaderDao != null) {
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,Long id = category.getId();
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,"deproxiedCategory = postLoaderDao.find(CategoryImpl.class, id);"
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,} else if (category instanceof HibernateProxy) {
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,deproxiedCategory = HibernateUtils.deproxy(category);
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDao;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDaoImpl;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import org.broadleafcommerce.common.presentation.*;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import org.broadleafcommerce.core.catalog.domain.ProductImpl;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import org.broadleafcommerce.core.offer.domain.OfferImpl;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import org.hibernate.annotations.*;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import javax.persistence.CascadeType;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import javax.persistence.*;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import javax.persistence.Entity;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import javax.persistence.Table;
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,if (category instanceof HibernateProxy) {
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,GenericEntityDao genericEntityDao = GenericEntityDaoImpl.getGenericEntityDao();
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,if (genericEntityDao != null) {
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,Long id = category.getId();
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,genericEntityDao.getEntityManager().detach(category);
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,"deproxiedCategory = genericEntityDao.getEntityManager().find(CategoryImpl.class, id);"
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,} else {
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,deproxiedCategory = HibernateUtils.deproxy(category);
83fb11ed58644108db5d65f28772c299943478f5,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,}
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.persistence.DefaultPostLoaderDao;
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.persistence.PostLoaderDao;
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.util.HibernateUtils;
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.hibernate.proxy.HibernateProxy;
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,@Transient
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,protected Offer deproxiedOffer;
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,if (deproxiedOffer == null) {
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,if (postLoaderDao != null) {
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,"deproxiedOffer = postLoaderDao.find(OfferImpl.class, id);"
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,} else if (offer instanceof HibernateProxy) {
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,deproxiedOffer = HibernateUtils.deproxy(offer);
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,} else {
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,deproxiedOffer = offer;
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,}
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,return deproxiedOffer;
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,sbClonedOffer = deproxiedOffer = null;
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,"//This guarantees that the offer is the correct one based on sandboxed state.  If the offer has been overridden/cloned in the local site,"
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,//  then that overridden/cloned offer will be used.
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,if (sbClonedOffer == null) {
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,GenericEntityDao genericEntityDao = GenericEntityDaoImpl.getGenericEntityDao();
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,if (genericEntityDao != null && offer != null && offer.getId() != null) {
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,"sbClonedOffer = genericEntityDao.getEntityManager().find(OfferImpl.class, id);"
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,}
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,"//if for some reason the cloned offer was not found, at a minimum return the original offer (so we are not returning null)"
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,sbClonedOffer = offer;
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,return sbClonedOffer;
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,sbClonedOffer = null;
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.persistence.DefaultPostLoaderDao;
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.persistence.PostLoaderDao;
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.util.HibernateUtils;
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.hibernate.proxy.HibernateProxy;
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,@Transient
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,protected Offer deproxiedOffer;
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,if (deproxiedOffer == null) {
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,if (postLoaderDao != null) {
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,"deproxiedOffer = postLoaderDao.find(OfferImpl.class, id);"
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,} else if (offer instanceof HibernateProxy) {
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,deproxiedOffer = HibernateUtils.deproxy(offer);
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,} else {
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,deproxiedOffer = offer;
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,}
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,return deproxiedOffer;
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,sbClonedOffer = deproxiedOffer = null;
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,"//This guarantees that the offer is the correct one based on sandboxed state.  If the offer has been overridden/cloned in the local site,"
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,//  then that overridden/cloned offer will be used.
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,if (sbClonedOffer == null) {
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,GenericEntityDao genericEntityDao = GenericEntityDaoImpl.getGenericEntityDao();
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,if (genericEntityDao != null && offer != null && offer.getId() != null) {
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,"sbClonedOffer = genericEntityDao.getEntityManager().find(OfferImpl.class, id);"
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,}
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,"//if for some reason the cloned offer was not found, at a minimum return the original offer (so we are not returning null)"
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,sbClonedOffer = offer;
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,return sbClonedOffer;
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,sbClonedOffer = null;
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* Copyright (C) 2009 - 2013 Broadleaf Commerce
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.persistence.DefaultPostLoaderDao;
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.persistence.PostLoaderDao;
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.util.HibernateUtils;
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.hibernate.proxy.HibernateProxy;
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,@Transient
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected Offer deproxiedOffer;
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,setOrderItemPriceDetail(orderItemPriceDetail);
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,setReason(reason);
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (deproxiedOffer == null) {
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (postLoaderDao != null) {
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,Long id = offer.getId();
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"deproxiedOffer = postLoaderDao.find(OfferImpl.class, id);"
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,} else if (offer instanceof HibernateProxy) {
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,deproxiedOffer = HibernateUtils.deproxy(offer);
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,} else {
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,deproxiedOffer = offer;
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return deproxiedOffer;
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (reason != null) {
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.reason = reason;
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,} else if (this.offerName != null) {
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.reason = this.offerName;
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,deproxiedOffer = null;
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* Copyright (C) 2009 - 2016 Broadleaf Commerce
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.orderItemPriceDetail = orderItemPriceDetail;
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (reason == null && offer != null) {
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.reason = offer.getName();
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,} else {
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.reason = reason;
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,}
a323a37f6623de7a9da97e42282bce9ade965220,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return offer;
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,* Copyright (C) 2009 - 2013 Broadleaf Commerce
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,import org.broadleafcommerce.common.persistence.DefaultPostLoaderDao;
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,import org.broadleafcommerce.common.persistence.PostLoaderDao;
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,import org.broadleafcommerce.common.util.HibernateUtils;
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,import org.hibernate.proxy.HibernateProxy;
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,@Transient
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,protected Offer deproxiedOffer;
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,setOrderItemPriceDetail(orderItemPriceDetail);
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,setReason(reason);
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,if (deproxiedOffer == null) {
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,if (postLoaderDao != null) {
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,Long id = offer.getId();
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,"deproxiedOffer = postLoaderDao.find(OfferImpl.class, id);"
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,} else if (offer instanceof HibernateProxy) {
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,deproxiedOffer = HibernateUtils.deproxy(offer);
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,} else {
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,deproxiedOffer = offer;
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,}
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,return deproxiedOffer;
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,if (reason != null) {
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,this.reason = reason;
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,} else if (this.offerName != null) {
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,this.reason = this.offerName;
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,deproxiedOffer = null;
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,* Copyright (C) 2009 - 2016 Broadleaf Commerce
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,this.orderItemPriceDetail = orderItemPriceDetail;
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,if (reason == null && offer != null) {
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,this.reason = offer.getName();
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,} else {
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,this.reason = reason;
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,}
a323a37f6623de7a9da97e42282bce9ade965220,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,return offer;
a323a37f6623de7a9da97e42282bce9ade965220,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.broadleafcommerce.common.persistence.DefaultPostLoaderDao;
a323a37f6623de7a9da97e42282bce9ade965220,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,import org.broadleafcommerce.common.persistence.PostLoaderDao;
a323a37f6623de7a9da97e42282bce9ade965220,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
a323a37f6623de7a9da97e42282bce9ade965220,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,if (postLoaderDao != null) {
a323a37f6623de7a9da97e42282bce9ade965220,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,Long id = category.getId();
a323a37f6623de7a9da97e42282bce9ade965220,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,"deproxiedCategory = postLoaderDao.find(CategoryImpl.class, id);"
a323a37f6623de7a9da97e42282bce9ade965220,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,} else if (category instanceof HibernateProxy) {
a323a37f6623de7a9da97e42282bce9ade965220,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,added,0,deproxiedCategory = HibernateUtils.deproxy(category);
a323a37f6623de7a9da97e42282bce9ade965220,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDao;
a323a37f6623de7a9da97e42282bce9ade965220,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDaoImpl;
a323a37f6623de7a9da97e42282bce9ade965220,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,import org.broadleafcommerce.core.catalog.domain.ProductImpl;
a323a37f6623de7a9da97e42282bce9ade965220,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,import org.broadleafcommerce.core.offer.domain.OfferImpl;
a323a37f6623de7a9da97e42282bce9ade965220,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,if (category instanceof HibernateProxy) {
a323a37f6623de7a9da97e42282bce9ade965220,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,GenericEntityDao genericEntityDao = GenericEntityDaoImpl.getGenericEntityDao();
a323a37f6623de7a9da97e42282bce9ade965220,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,if (genericEntityDao != null) {
a323a37f6623de7a9da97e42282bce9ade965220,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,Long id = category.getId();
a323a37f6623de7a9da97e42282bce9ade965220,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,genericEntityDao.getEntityManager().detach(category);
a323a37f6623de7a9da97e42282bce9ade965220,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,"deproxiedCategory = genericEntityDao.getEntityManager().find(CategoryImpl.class, id);"
a323a37f6623de7a9da97e42282bce9ade965220,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,} else {
a323a37f6623de7a9da97e42282bce9ade965220,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,deproxiedCategory = HibernateUtils.deproxy(category);
a323a37f6623de7a9da97e42282bce9ade965220,c81a7ea1245314b5dd3bbe1053fda5c1af5c82ad,deleted,1,}
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.persistence.DefaultPostLoaderDao;
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,import org.broadleafcommerce.common.persistence.PostLoaderDao;
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,if (postLoaderDao != null) {
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,Long id = category.getId();
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,"deproxiedCategory = postLoaderDao.find(CategoryImpl.class, id);"
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,} else if (category instanceof HibernateProxy) {
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,added,0,deproxiedCategory = HibernateUtils.deproxy(category);
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDao;
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDaoImpl;
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import org.broadleafcommerce.core.catalog.domain.ProductImpl;
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,import org.broadleafcommerce.core.offer.domain.OfferImpl;
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,if (category instanceof HibernateProxy) {
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,GenericEntityDao genericEntityDao = GenericEntityDaoImpl.getGenericEntityDao();
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,if (genericEntityDao != null) {
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,Long id = category.getId();
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,genericEntityDao.getEntityManager().detach(category);
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,"deproxiedCategory = genericEntityDao.getEntityManager().find(CategoryImpl.class, id);"
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,} else {
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,deproxiedCategory = HibernateUtils.deproxy(category);
a323a37f6623de7a9da97e42282bce9ade965220,de0126e6f55eea69c8e1d4e7bb5358a85821397f,deleted,1,}
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.persistence.DefaultPostLoaderDao;
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,import org.broadleafcommerce.common.persistence.PostLoaderDao;
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,PostLoaderDao postLoaderDao = DefaultPostLoaderDao.getPostLoaderDao();
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,if (postLoaderDao != null) {
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,Long id = category.getId();
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,"deproxiedCategory = postLoaderDao.find(CategoryImpl.class, id);"
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,} else if (category instanceof HibernateProxy) {
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,deproxiedCategory = HibernateUtils.deproxy(category);
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDao;
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDaoImpl;
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import org.broadleafcommerce.core.catalog.domain.ProductImpl;
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import org.broadleafcommerce.core.offer.domain.OfferImpl;
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,if (category instanceof HibernateProxy) {
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,GenericEntityDao genericEntityDao = GenericEntityDaoImpl.getGenericEntityDao();
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,if (genericEntityDao != null) {
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,Long id = category.getId();
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,genericEntityDao.getEntityManager().detach(category);
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,"deproxiedCategory = genericEntityDao.getEntityManager().find(CategoryImpl.class, id);"
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,} else {
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,deproxiedCategory = HibernateUtils.deproxy(category);
a323a37f6623de7a9da97e42282bce9ade965220,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,}
11af6b835cd399c2014518979e944e0fb9cffbba,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,import org.broadleafcommerce.presentation.condition.ConditionalOnTemplating;
11af6b835cd399c2014518979e944e0fb9cffbba,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,@ConditionalOnTemplating
11af6b835cd399c2014518979e944e0fb9cffbba,ba9b908be174603ed774f6147e87c63387dc96a5,added,0,"Map<String, String> attrs = new HashMap<>();"
11af6b835cd399c2014518979e944e0fb9cffbba,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.broadleafcommerce.presentation.condition.TemplatingExistCondition;
11af6b835cd399c2014518979e944e0fb9cffbba,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,import org.springframework.context.annotation.Conditional;
11af6b835cd399c2014518979e944e0fb9cffbba,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,@Conditional(TemplatingExistCondition.class)
11af6b835cd399c2014518979e944e0fb9cffbba,ba9b908be174603ed774f6147e87c63387dc96a5,deleted,1,"Map<String, String> attrs = new HashMap<String, String>();"
bebf66191615b934ae3c84f71ecbd00355c730f5,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,import org.broadleafcommerce.common.payment.PaymentType;
bebf66191615b934ae3c84f71ecbd00355c730f5,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,"// At this point in a checkout, CustomerCredit and GiftCards are still Unconfirmed,"
bebf66191615b934ae3c84f71ecbd00355c730f5,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,// thus the check to prevent incorrect payment totals
bebf66191615b934ae3c84f71ecbd00355c730f5,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,if (PaymentTransactionType.UNCONFIRMED.equals(paymentTransaction.getType()) &&
bebf66191615b934ae3c84f71ecbd00355c730f5,e014c889a02fe035ca823d9c0b3b8b4335e6651a,added,0,paymentTransaction.getOrderPayment().isFinalPayment()) {
bebf66191615b934ae3c84f71ecbd00355c730f5,e014c889a02fe035ca823d9c0b3b8b4335e6651a,deleted,1,if (PaymentTransactionType.UNCONFIRMED.equals(paymentTransaction.getType())) {
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,"@Column(name = ""SEARCHABLE"")"
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,@AdminPresentation(excluded = true)
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,protected Boolean searchable = false;
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,@Override
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,public Boolean getSearchable() {
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,if (searchable == null) {
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,return Boolean.FALSE;
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,} else {
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,return searchable;
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,}
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,public void setSearchable(Boolean searchable) {
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,this.searchable = searchable;
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,cloned.setSearchable(searchable);
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,/** The searchable. */
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,"@Column(name = ""SEARCHABLE"")"
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,@AdminPresentation(excluded = true)
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,protected Boolean searchable = false;
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,@Override
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,public Boolean getSearchable() {
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,if (searchable == null) {
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,return Boolean.FALSE;
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,} else {
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,return searchable;
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,}
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,public void setSearchable(Boolean searchable) {
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,this.searchable = searchable;
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,cloned.setSearchable(searchable);
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,/** The searchable. */
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,"@Column(name = ""SEARCHABLE"")"
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,@AdminPresentation(excluded = true)
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,protected Boolean searchable = false;
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,/* (non-Javadoc)
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,* @see org.broadleafcommerce.core.catalog.domain.SkuAttribute#getSearchable()
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,*/
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,@Override
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,public Boolean getSearchable() {
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,if (searchable == null) {
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,return Boolean.FALSE;
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,} else {
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,return searchable;
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,}
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,* @see org.broadleafcommerce.core.catalog.domain.SkuAttribute#setSearchable(java.lang.Boolean)
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,public void setSearchable(Boolean searchable) {
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,this.searchable = searchable;
731b221479c475151154a830d0713ea88426e5b4,9c9e3d9d5c17a79d71a84f02996766c9bb7a26bc,deleted,1,cloned.setSearchable(getSearchable());
a86a32c0fcbb7653b48707e5360e2752082a64ee,fd1a6578e3835293b0a34ca78022d0b7ccb11ac1,added,0,import org.apache.commons.lang3.ArrayUtils;
a86a32c0fcbb7653b48707e5360e2752082a64ee,fd1a6578e3835293b0a34ca78022d0b7ccb11ac1,added,0,/* ************** */
a86a32c0fcbb7653b48707e5360e2752082a64ee,fd1a6578e3835293b0a34ca78022d0b7ccb11ac1,added,0,/* STATUS METHODS */
a86a32c0fcbb7653b48707e5360e2752082a64ee,fd1a6578e3835293b0a34ca78022d0b7ccb11ac1,added,0,public boolean hasFilterAndSortCriteria() {
a86a32c0fcbb7653b48707e5360e2752082a64ee,fd1a6578e3835293b0a34ca78022d0b7ccb11ac1,added,0,FilterAndSortCriteria[] fascs = getFilterAndSortCriteria();
a86a32c0fcbb7653b48707e5360e2752082a64ee,fd1a6578e3835293b0a34ca78022d0b7ccb11ac1,added,0,return ArrayUtils.isNotEmpty(fascs);
a86a32c0fcbb7653b48707e5360e2752082a64ee,fd1a6578e3835293b0a34ca78022d0b7ccb11ac1,added,0,}
a86a32c0fcbb7653b48707e5360e2752082a64ee,fd1a6578e3835293b0a34ca78022d0b7ccb11ac1,deleted,1,import org.apache.commons.lang.ArrayUtils;
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withFieldType(fieldType)
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withFieldComponentRenderer(fmd.getFieldComponentRenderer()==null?null:fmd.getFieldComponentRenderer().toString())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withOrder(fmd.getOrder())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withFriendlyName(fmd.getFriendlyName())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withForeignKeyDisplayValueProperty(fmd.getForeignKeyDisplayValueProperty())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withForeignKeyClass(fmd.getForeignKeyClass())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withForeignKeySectionPath(getAdminSectionPath(fmd.getForeignKeyClass()))
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withOwningEntityClass(fmd.getOwningClass()!=null?fmd.getOwningClass():fmd.getInheritedFromType())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withRequired(required)
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withReadOnly(fmd.getReadOnly())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withTranslatable(fmd.getTranslatable())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withAlternateOrdering((Boolean) fmd.getAdditionalMetadata().get(Field.ALTERNATE_ORDERING))
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withLargeEntry(fmd.isLargeEntry())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withHint(fmd.getHint())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withTooltip(fmd.getTooltip())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withHelp(fmd.getHelpText())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withTypeaheadEnabled(fmd.getEnableTypeaheadLookup())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withCanLinkToExternalEntity(fmd.getCanLinkToExternalEntity());
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withFieldType(fieldType)
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withFieldComponentRenderer(fmd.getFieldComponentRenderer()==null?null:fmd.getFieldComponentRenderer().toString())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withOrder(fmd.getOrder())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withFriendlyName(fmd.getFriendlyName())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withForeignKeyDisplayValueProperty(fmd.getForeignKeyDisplayValueProperty())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withForeignKeyClass(fmd.getForeignKeyClass())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withForeignKeySectionPath(getAdminSectionPath(fmd.getForeignKeyClass()))
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withOwningEntityClass(fmd.getOwningClass()!=null?fmd.getOwningClass():fmd.getInheritedFromType())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withRequired(required)
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withReadOnly(fmd.getReadOnly())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withTranslatable(fmd.getTranslatable())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withAlternateOrdering((Boolean) fmd.getAdditionalMetadata().get(Field.ALTERNATE_ORDERING))
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withLargeEntry(fmd.isLargeEntry())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withHint(fmd.getHint())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withTooltip(fmd.getTooltip())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withHelp(fmd.getHelpText())
11cd5369469955ffd9fe1884efdad0d8421d6893,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withTypeaheadEnabled(fmd.getEnableTypeaheadLookup());
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withOwningEntityClass(fmd.getOwningClass() != null ? fmd.getOwningClass() : fmd.getTargetClass())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withCanLinkToExternalEntity(fmd.getCanLinkToExternalEntity());
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withFieldType(fieldType)
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withFieldComponentRenderer(fmd.getFieldComponentRenderer()==null?null:fmd.getFieldComponentRenderer().toString())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withOrder(fmd.getOrder())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withFriendlyName(fmd.getFriendlyName())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withForeignKeyDisplayValueProperty(fmd.getForeignKeyDisplayValueProperty())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withForeignKeyClass(fmd.getForeignKeyClass())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withForeignKeySectionPath(getAdminSectionPath(fmd.getForeignKeyClass()))
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withOwningEntityClass(fmd.getOwningClass()!=null?fmd.getOwningClass():fmd.getInheritedFromType())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withRequired(required)
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withReadOnly(fmd.getReadOnly())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withTranslatable(fmd.getTranslatable())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withAlternateOrdering((Boolean) fmd.getAdditionalMetadata().get(Field.ALTERNATE_ORDERING))
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withLargeEntry(fmd.isLargeEntry())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withHint(fmd.getHint())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withTooltip(fmd.getTooltip())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withHelp(fmd.getHelpText())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,.withTypeaheadEnabled(fmd.getEnableTypeaheadLookup())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withOwningEntityClass(fmd.getOwningClass() != null ? fmd.getOwningClass() : fmd.getTargetClass());
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withFieldType(fieldType)
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withFieldComponentRenderer(fmd.getFieldComponentRenderer()==null?null:fmd.getFieldComponentRenderer().toString())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withOrder(fmd.getOrder())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withFriendlyName(fmd.getFriendlyName())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withForeignKeyDisplayValueProperty(fmd.getForeignKeyDisplayValueProperty())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withForeignKeyClass(fmd.getForeignKeyClass())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withForeignKeySectionPath(getAdminSectionPath(fmd.getForeignKeyClass()))
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withOwningEntityClass(fmd.getOwningClass()!=null?fmd.getOwningClass():fmd.getInheritedFromType())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withRequired(required)
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withReadOnly(fmd.getReadOnly())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withTranslatable(fmd.getTranslatable())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withAlternateOrdering((Boolean) fmd.getAdditionalMetadata().get(Field.ALTERNATE_ORDERING))
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withLargeEntry(fmd.isLargeEntry())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withHint(fmd.getHint())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withTooltip(fmd.getTooltip())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withHelp(fmd.getHelpText())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withTypeaheadEnabled(fmd.getEnableTypeaheadLookup())
4d598aef303dbeb6cede6a427ace6b6312d7e053,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,.withCanLinkToExternalEntity(fmd.getCanLinkToExternalEntity());
d58da3adab8898ae1aeb89d2c5c622cd7a1574bc,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,@Override
d58da3adab8898ae1aeb89d2c5c622cd7a1574bc,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,public <G extends IndexField> CreateResponse<G> createOrRetrieveCopyInstance(MultiTenantCopyContext context) throws CloneNotSupportedException {
d58da3adab8898ae1aeb89d2c5c622cd7a1574bc,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,CreateResponse<G> createResponse = context.createOrRetrieveCopyInstance(this);
d58da3adab8898ae1aeb89d2c5c622cd7a1574bc,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,if (createResponse.isAlreadyPopulated()) {
d58da3adab8898ae1aeb89d2c5c622cd7a1574bc,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,return createResponse;
d58da3adab8898ae1aeb89d2c5c622cd7a1574bc,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,}
d58da3adab8898ae1aeb89d2c5c622cd7a1574bc,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,IndexField cloned = createResponse.getClone();
d58da3adab8898ae1aeb89d2c5c622cd7a1574bc,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,cloned.setSearchable(searchable);
d58da3adab8898ae1aeb89d2c5c622cd7a1574bc,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,cloned.setField(field);
d58da3adab8898ae1aeb89d2c5c622cd7a1574bc,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,for(IndexFieldType entry : fieldTypes){
d58da3adab8898ae1aeb89d2c5c622cd7a1574bc,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,cloned.getFieldTypes().add(entry.createOrRetrieveCopyInstance(context).getClone());
d58da3adab8898ae1aeb89d2c5c622cd7a1574bc,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,public interface SearchFacet extends Serializable {
d58da3adab8898ae1aeb89d2c5c622cd7a1574bc,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"public interface SearchFacet extends Serializable, MultiTenantCloneable<SearchFacet> {"
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"return new AutoImportSql(AutoImportPersistenceUnit.BL_PU,""config/bc/sql/demo/load_admin_users.sql,config/bc/sql/demo/load_i18n_countries.sql,config/bc/sql/demo/load_sitemap_data.sql"", AutoImportStage.PRIMARY_BASIC_DATA);"
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"return new AutoImportSql(AutoImportPersistenceUnit.BL_PU,""config/bc/sql/demo/fix_admin_user_data.sql,config/bc/sql/demo/fix_system_property_data.sql"", AutoImportStage.PRIMARY_LATE);"
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,/*
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,* #%L
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,* BroadleafCommerce Open Admin Platform
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,* %%
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,* Copyright (C) 2009 - 2016 Broadleaf Commerce
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"* Licensed under the Broadleaf Fair Use License Agreement, Version 1.0"
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"* (the ""Fair Use License"" located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)"
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,* unless the restrictions on use therein are violated and require payment to Broadleaf in which case
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"* the Broadleaf End User License Agreement (EULA), Version 1.1"
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"* (the ""Commercial License"" located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)"
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,* shall apply.
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,*
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"* Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the ""Custom License"")"
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,* between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,* #L%
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,*/
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,package org.broadleafcommerce.openadmin.demo;
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,import org.broadleafcommerce.common.demo.AutoImportPersistenceUnit;
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,import org.broadleafcommerce.common.demo.AutoImportSql;
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,import org.broadleafcommerce.common.demo.AutoImportStage;
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,import org.broadleafcommerce.common.demo.DemoCondition;
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,import org.broadleafcommerce.common.demo.MTCondition;
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,import org.springframework.context.annotation.Bean;
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,import org.springframework.context.annotation.Conditional;
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,import org.springframework.context.annotation.Configuration;
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,/**
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,* @author Jeff Fischer
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"@Configuration(""blOpenAdminData"")"
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,@Conditional(DemoCondition.class)
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,public class ImportSQLConfig {
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,@Bean
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,public AutoImportSql blOpenAdminBasicData() {
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"return new AutoImportSql(AutoImportPersistenceUnit.BL_PU,""config/bc/sql/demo/load_admin_users.sql"", AutoImportStage.PRIMARY_BASIC_DATA);"
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,}
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,@Conditional(MTCondition.class)
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,public AutoImportSql blOpenAdminLateData() {
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"return new AutoImportSql(AutoImportPersistenceUnit.BL_PU,""config/bc/sql/demo/fix_admin_user_data.sql"", AutoImportStage.PRIMARY_LATE);"
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"return new AutoImportSql(AutoImportPersistenceUnit.BL_PU,""config/bc/sql/demo/load_i18n_countries.sql,config/bc/sql/demo/load_sitemap_data.sql"", AutoImportStage.PRIMARY_BASIC_DATA);"
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"return new AutoImportSql(AutoImportPersistenceUnit.BL_PU,""config/bc/sql/demo/fix_system_property_data.sql"", AutoImportStage.PRIMARY_LATE);"
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"return new AutoImportSql(AutoImportPersistenceUnit.BL_PU,""config/bc/sql/demo/load_admin_users.sql,config/bc/sql/demo/load_i18n_countries.sql,config/bc/sql/demo/load_sitemap_data.sql"", AutoImportStage.PRIMARY_BASIC_DATA);"
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"return new AutoImportSql(AutoImportPersistenceUnit.BL_PU,""config/bc/sql/demo/fix_admin_user_data.sql,config/bc/sql/demo/fix_system_property_data.sql"", AutoImportStage.PRIMARY_LATE);"
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,/*
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,* #%L
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,* BroadleafCommerce Open Admin Platform
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,* %%
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,* Copyright (C) 2009 - 2016 Broadleaf Commerce
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"* Licensed under the Broadleaf Fair Use License Agreement, Version 1.0"
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"* (the ""Fair Use License"" located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)"
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,* unless the restrictions on use therein are violated and require payment to Broadleaf in which case
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"* the Broadleaf End User License Agreement (EULA), Version 1.1"
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"* (the ""Commercial License"" located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)"
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,* shall apply.
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,*
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"* Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the ""Custom License"")"
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,* between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,* #L%
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,*/
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,package org.broadleafcommerce.openadmin.demo;
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,import org.broadleafcommerce.common.demo.AutoImportPersistenceUnit;
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,import org.broadleafcommerce.common.demo.AutoImportSql;
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,import org.broadleafcommerce.common.demo.AutoImportStage;
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,import org.broadleafcommerce.common.demo.DemoCondition;
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,import org.broadleafcommerce.common.demo.MTCondition;
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,import org.springframework.context.annotation.Bean;
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,import org.springframework.context.annotation.Conditional;
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,import org.springframework.context.annotation.Configuration;
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,/**
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,* @author Jeff Fischer
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"@Configuration(""blOpenAdminData"")"
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,@Conditional(DemoCondition.class)
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,public class ImportSQLConfig {
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,@Bean
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,public AutoImportSql blOpenAdminBasicData() {
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"return new AutoImportSql(AutoImportPersistenceUnit.BL_PU,""config/bc/sql/demo/load_admin_users.sql"", AutoImportStage.PRIMARY_BASIC_DATA);"
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,}
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,@Conditional(MTCondition.class)
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,public AutoImportSql blOpenAdminLateData() {
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"return new AutoImportSql(AutoImportPersistenceUnit.BL_PU,""config/bc/sql/demo/fix_admin_user_data.sql"", AutoImportStage.PRIMARY_LATE);"
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"return new AutoImportSql(AutoImportPersistenceUnit.BL_PU,""config/bc/sql/demo/load_i18n_countries.sql,config/bc/sql/demo/load_sitemap_data.sql"", AutoImportStage.PRIMARY_BASIC_DATA);"
e12801ab73b3f1e6f81908a647cac2c45c96fc33,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"return new AutoImportSql(AutoImportPersistenceUnit.BL_PU,""config/bc/sql/demo/fix_system_property_data.sql"", AutoImportStage.PRIMARY_LATE);"
52fb8f577fb630c8e06174723ba688a839a31e60,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,public static final int BASIC_DATA_SPECIAL = AutoImportStage.PRIMARY_BASIC_DATA - 30;
52fb8f577fb630c8e06174723ba688a839a31e60,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"""config/bc/sql/demo/load_content_data_i18n.sql"", BASIC_DATA_SPECIAL);"
52fb8f577fb630c8e06174723ba688a839a31e60,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"""config/bc/sql/demo/load_content_data_i18n.sql"", AutoImportStage.PRIMARY_BASIC_DATA);"
728d122ec01327ca95056a8ce5235b6813e20871,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,import org.broadleafcommerce.common.demo.ImportCondition;
728d122ec01327ca95056a8ce5235b6813e20871,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,@Conditional(ImportCondition.class)
728d122ec01327ca95056a8ce5235b6813e20871,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,@Conditional(DemoCondition.class)
728d122ec01327ca95056a8ce5235b6813e20871,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"@Conditional({MTCondition.class, DemoCondition.class})"
728d122ec01327ca95056a8ce5235b6813e20871,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,@Conditional(DemoCondition.class)
728d122ec01327ca95056a8ce5235b6813e20871,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,@Conditional(MTCondition.class)
728d122ec01327ca95056a8ce5235b6813e20871,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,import org.broadleafcommerce.common.demo.ImportCondition;
728d122ec01327ca95056a8ce5235b6813e20871,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,@Conditional(ImportCondition.class)
728d122ec01327ca95056a8ce5235b6813e20871,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,@Conditional(DemoCondition.class)
728d122ec01327ca95056a8ce5235b6813e20871,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"@Conditional({MTCondition.class, DemoCondition.class})"
728d122ec01327ca95056a8ce5235b6813e20871,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,@Conditional(DemoCondition.class)
728d122ec01327ca95056a8ce5235b6813e20871,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,@Conditional(MTCondition.class)
728d122ec01327ca95056a8ce5235b6813e20871,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,import org.broadleafcommerce.common.demo.ImportCondition;
728d122ec01327ca95056a8ce5235b6813e20871,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,@Conditional(ImportCondition.class)
728d122ec01327ca95056a8ce5235b6813e20871,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,@Conditional(DemoCondition.class)
728d122ec01327ca95056a8ce5235b6813e20871,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"@Conditional({MTCondition.class, DemoCondition.class})"
728d122ec01327ca95056a8ce5235b6813e20871,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,@Conditional(DemoCondition.class)
728d122ec01327ca95056a8ce5235b6813e20871,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,@Conditional(MTCondition.class)
728d122ec01327ca95056a8ce5235b6813e20871,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,import org.broadleafcommerce.common.demo.ImportCondition;
728d122ec01327ca95056a8ce5235b6813e20871,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,@Conditional(ImportCondition.class)
728d122ec01327ca95056a8ce5235b6813e20871,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,@Conditional(DemoCondition.class)
728d122ec01327ca95056a8ce5235b6813e20871,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"@Conditional({MTCondition.class, DemoCondition.class})"
728d122ec01327ca95056a8ce5235b6813e20871,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,@Conditional(DemoCondition.class)
728d122ec01327ca95056a8ce5235b6813e20871,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,@Conditional(MTCondition.class)
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,/*
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,* #%L
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,* BroadleafCommerce Common Libraries
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,* %%
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,* Copyright (C) 2009 - 2016 Broadleaf Commerce
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,"* Licensed under the Broadleaf Fair Use License Agreement, Version 1.0"
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,"* (the ""Fair Use License"" located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)"
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,* unless the restrictions on use therein are violated and require payment to Broadleaf in which case
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,"* the Broadleaf End User License Agreement (EULA), Version 1.1"
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,"* (the ""Commercial License"" located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)"
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,* shall apply.
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,*
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,"* Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the ""Custom License"")"
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,* between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,* #L%
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,*/
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,package org.broadleafcommerce.common.web;
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,import org.apache.commons.lang3.StringUtils;
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,import org.broadleafcommerce.common.site.domain.Theme;
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,import org.thymeleaf.TemplateProcessingParameters;
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,import org.thymeleaf.templateresolver.ClassLoaderTemplateResolver;
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,import org.thymeleaf.templateresolver.ServletContextTemplateResolver;
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,import org.thymeleaf.util.Validate;
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,/**
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,* Overrides the Thymeleaf ContextTemplateResolver and appends the org.broadleafcommerce.common.web.Theme path to the url
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,* if it exists.
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,public class BroadleafThymeleafClassLoaderTemplateResolver extends ClassLoaderTemplateResolver {
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,"protected String templateFolder = """";"
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,@Override
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,protected String computeResourceName(final TemplateProcessingParameters templateProcessingParameters) {
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,String themePath = null;
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,Theme theme = BroadleafRequestContext.getBroadleafRequestContext().getTheme();
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,if (theme != null && theme.getPath() != null) {
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,themePath = theme.getPath();
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,}
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,checkInitialized();
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,final String templateName = templateProcessingParameters.getTemplateName();
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,"Validate.notNull(templateName, ""Template name cannot be null"");"
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,String unaliasedName = this.getTemplateAliases().get(templateName);
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,if (unaliasedName == null) {
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,unaliasedName = templateName;
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,final StringBuilder resourceName = new StringBuilder();
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,String prefix = this.getPrefix();
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,if (themePath != null) {
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,"resourceName.append(StringUtils.isEmpty(prefix)?"""":prefix).append(themePath).append('/').append(templateFolder);"
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,"if (templateFolder.endsWith(""/"") && unaliasedName.startsWith(""/"")) {"
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,"unaliasedName = unaliasedName.substring(1, unaliasedName.length());"
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,resourceName.append(unaliasedName);
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,String suffix = this.getSuffix();
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,"if (suffix != null && ! suffix.trim().equals("""")) {"
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,resourceName.append(suffix);
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,return resourceName.toString();
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,public String getTemplateFolder() {
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,return templateFolder;
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,public void setTemplateFolder(String templateFolder) {
dc955368515377be4b575ded394fbc1dd676f939,e12801ab73b3f1e6f81908a647cac2c45c96fc33,deleted,1,this.templateFolder = templateFolder;
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,/*
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,* #%L
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,* BroadleafCommerce Common Libraries
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,* %%
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,* Copyright (C) 2009 - 2016 Broadleaf Commerce
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,"* Licensed under the Broadleaf Fair Use License Agreement, Version 1.0"
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,"* (the ""Fair Use License"" located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)"
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,* unless the restrictions on use therein are violated and require payment to Broadleaf in which case
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,"* the Broadleaf End User License Agreement (EULA), Version 1.1"
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,"* (the ""Commercial License"" located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)"
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,* shall apply.
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,*
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,"* Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the ""Custom License"")"
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,* between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,* #L%
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,*/
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,package org.broadleafcommerce.common.web;
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,import org.apache.commons.lang3.StringUtils;
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,import org.broadleafcommerce.common.site.domain.Theme;
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,import org.thymeleaf.TemplateProcessingParameters;
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,import org.thymeleaf.templateresolver.ClassLoaderTemplateResolver;
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,import org.thymeleaf.templateresolver.ServletContextTemplateResolver;
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,import org.thymeleaf.util.Validate;
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,/**
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,* Overrides the Thymeleaf ContextTemplateResolver and appends the org.broadleafcommerce.common.web.Theme path to the url
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,* if it exists.
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,public class BroadleafThymeleafClassLoaderTemplateResolver extends ClassLoaderTemplateResolver {
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,"protected String templateFolder = """";"
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,@Override
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,protected String computeResourceName(final TemplateProcessingParameters templateProcessingParameters) {
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,String themePath = null;
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,Theme theme = BroadleafRequestContext.getBroadleafRequestContext().getTheme();
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,if (theme != null && theme.getPath() != null) {
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,themePath = theme.getPath();
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,}
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,checkInitialized();
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,final String templateName = templateProcessingParameters.getTemplateName();
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,"Validate.notNull(templateName, ""Template name cannot be null"");"
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,String unaliasedName = this.getTemplateAliases().get(templateName);
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,if (unaliasedName == null) {
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,unaliasedName = templateName;
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,final StringBuilder resourceName = new StringBuilder();
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,String prefix = this.getPrefix();
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,if (themePath != null) {
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,"resourceName.append(StringUtils.isEmpty(prefix)?"""":prefix).append(themePath).append('/').append(templateFolder);"
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,"if (templateFolder.endsWith(""/"") && unaliasedName.startsWith(""/"")) {"
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,"unaliasedName = unaliasedName.substring(1, unaliasedName.length());"
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,resourceName.append(unaliasedName);
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,String suffix = this.getSuffix();
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,"if (suffix != null && ! suffix.trim().equals("""")) {"
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,resourceName.append(suffix);
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,return resourceName.toString();
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,public String getTemplateFolder() {
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,return templateFolder;
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,public void setTemplateFolder(String templateFolder) {
dc955368515377be4b575ded394fbc1dd676f939,1da407ad6f4ce78bb6268470fbc657b764885b25,deleted,1,this.templateFolder = templateFolder;
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,/*
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,* #%L
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,* BroadleafCommerce Common Libraries
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,* %%
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,* Copyright (C) 2009 - 2016 Broadleaf Commerce
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,"* Licensed under the Broadleaf Fair Use License Agreement, Version 1.0"
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,"* (the ""Fair Use License"" located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)"
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,* unless the restrictions on use therein are violated and require payment to Broadleaf in which case
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,"* the Broadleaf End User License Agreement (EULA), Version 1.1"
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,"* (the ""Commercial License"" located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)"
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,* shall apply.
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,*
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,"* Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the ""Custom License"")"
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,* between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,* #L%
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,*/
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,package org.broadleafcommerce.common.extensibility.context;
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,import org.apache.commons.logging.Log;
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,import org.apache.commons.logging.LogFactory;
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,import java.io.BufferedReader;
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,import java.io.IOException;
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,import java.io.InputStreamReader;
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,import java.util.ArrayList;
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,public class StandardConfigLocations {
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,private static final Log LOG = LogFactory.getLog(StandardConfigLocations.class);
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,"public static final String EXTRACONFIGLOCATIONSKEY = ""extra.config.locations"";"
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,public static final int ALLCONTEXTTYPE = 0;
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,public static final int WEBCONTEXTTYPE = 1;
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,public static final int SERVICECONTEXTTYPE = 2;
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,public static final int TESTCONTEXTTYPE = 3;
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,public static final int APPCONTEXTTYPE = 4;
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,public static String[] retrieveAll(int contextType) throws IOException {
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,String[] response;
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,BufferedReader reader = null;
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,try {
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,"reader = new BufferedReader(new InputStreamReader(StandardConfigLocations.class.getResourceAsStream(""StandardConfigLocations.txt"")));"
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,ArrayList<String> items = new ArrayList<String>();
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,boolean eof = false;
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,while (!eof) {
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,String temp = reader.readLine();
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,if (temp == null) {
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,eof = true;
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,} else {
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,"addContextFile(contextType, items, temp);"
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,}
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,String extraConfigFiles = System.getProperty(EXTRACONFIGLOCATIONSKEY);
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,if (extraConfigFiles != null) {
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,"String[] files = extraConfigFiles.split("" "");"
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,for (String file : files) {
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,"addContextFile(contextType, items, file);"
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,response = new String[]{};
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,response = items.toArray(response);
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,} finally {
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,if (reader != null) {
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,try{ reader.close(); } catch (Throwable e) {
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,"LOG.error(""Unable to merge source and patch locations"", e);"
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,return response;
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,"private static void addContextFile(int contextType, ArrayList<String> items, String temp) {"
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,"if (!temp.startsWith(""#"") && temp.trim().length() > 0 && StandardConfigLocations.class.getClassLoader().getResource(temp.trim()) != null) {"
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,if (
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,contextType == ALLCONTEXTTYPE  ||
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,"((contextType == WEBCONTEXTTYPE || contextType == APPCONTEXTTYPE) && temp.indexOf(""-web-"") >= 0) ||"
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,"((contextType == SERVICECONTEXTTYPE || contextType == TESTCONTEXTTYPE || contextType == APPCONTEXTTYPE) && temp.indexOf(""-web-"") < 0 && temp.indexOf(""-test"") < 0 && temp.indexOf(""-admin-"") < 0) ||"
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,"((contextType == SERVICECONTEXTTYPE || contextType == TESTCONTEXTTYPE || contextType == APPCONTEXTTYPE) && temp.indexOf(""-admin-applicationContext-persistence"") >= 0) ||"
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,"(contextType == TESTCONTEXTTYPE && (temp.indexOf(""-test"") >= 0 || temp.indexOf(""-web-"") >= 0))"
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,){
0a1d5f05a3ae3fa6e0745b816f7c5616bc4ce5de,609e7bdabe2fa10a90b5bbefc4c221a23ebc4513,deleted,1,items.add(temp.trim());
1274710da2c0f79f3416c3479c3adba42eb97a38,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.broadleafcommerce.test.TestNGSiteIntegrationSetup;
1274710da2c0f79f3416c3479c3adba42eb97a38,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import javax.annotation.Resource;
1274710da2c0f79f3416c3479c3adba42eb97a38,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,public class CustomerPhoneControllerTest extends TestNGSiteIntegrationSetup {
1274710da2c0f79f3416c3479c3adba42eb97a38,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,private final List<Long> createdCustomerPhoneIds = new ArrayList<>();
1274710da2c0f79f3416c3479c3adba42eb97a38,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import org.broadleafcommerce.test.BaseTest;
1274710da2c0f79f3416c3479c3adba42eb97a38,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import javax.annotation.Resource;
1274710da2c0f79f3416c3479c3adba42eb97a38,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,public class CustomerPhoneControllerTest extends BaseTest {
1274710da2c0f79f3416c3479c3adba42eb97a38,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,private final List<Long> createdCustomerPhoneIds = new ArrayList<Long>();
fcd1b70967bbada5c1d47e0f58b8ab225a68999a,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,import org.springframework.context.annotation.Condition;
fcd1b70967bbada5c1d47e0f58b8ab225a68999a,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,import org.springframework.context.annotation.ConditionContext;
fcd1b70967bbada5c1d47e0f58b8ab225a68999a,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,import org.springframework.core.type.AnnotatedTypeMetadata;
fcd1b70967bbada5c1d47e0f58b8ab225a68999a,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,import org.springframework.util.ClassUtils;
fcd1b70967bbada5c1d47e0f58b8ab225a68999a,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"return new AutoImportSql(AutoImportPersistenceUnit.BL_PU,""config/bc/sql/demo/fix_catalog_data.sql"", AutoImportStage.PRIMARY_LATE);"
fcd1b70967bbada5c1d47e0f58b8ab225a68999a,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,}
fcd1b70967bbada5c1d47e0f58b8ab225a68999a,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,@Bean
fcd1b70967bbada5c1d47e0f58b8ab225a68999a,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"@Conditional({AssetFoldersExistCondition.class, DemoCondition.class})"
fcd1b70967bbada5c1d47e0f58b8ab225a68999a,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,public AutoImportSql blAssetFolderData() {
fcd1b70967bbada5c1d47e0f58b8ab225a68999a,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"return new AutoImportSql(AutoImportPersistenceUnit.BL_PU,""config/bc/sql/demo/populate_asset_folders.sql"", AutoImportStage.PRIMARY_LATE);"
fcd1b70967bbada5c1d47e0f58b8ab225a68999a,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,public static class AssetFoldersExistCondition implements Condition {
fcd1b70967bbada5c1d47e0f58b8ab225a68999a,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,@Override
fcd1b70967bbada5c1d47e0f58b8ab225a68999a,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata) {"
fcd1b70967bbada5c1d47e0f58b8ab225a68999a,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"return ClassUtils.isPresent(""com.broadleafcommerce.enterprise.foldering.admin.domain.AssetFolder"", context.getClassLoader());"
fcd1b70967bbada5c1d47e0f58b8ab225a68999a,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"return new AutoImportSql(AutoImportPersistenceUnit.BL_PU,""config/bc/sql/demo/fix_catalog_data.sql,config/bc/sql/demo/populate_asset_folders.sql"", AutoImportStage.PRIMARY_LATE);"
0f52be830443701e3f8d9f4e0fd44bd8cb0b2f83,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,public static final int PRIMARY_PRE_MODULE_SECURITY = 2000;
0f52be830443701e3f8d9f4e0fd44bd8cb0b2f83,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,public static final int PRIMARY_MODULE_SECURITY = 3000;
0f52be830443701e3f8d9f4e0fd44bd8cb0b2f83,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,public static final int PRIMARY_POST_MODULE_SECURITY = 4000;
0f52be830443701e3f8d9f4e0fd44bd8cb0b2f83,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,public static final int PRIMARY_PRE_BASIC_DATA = 5000;
0f52be830443701e3f8d9f4e0fd44bd8cb0b2f83,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,public static final int PRIMARY_BASIC_DATA = 6000;
0f52be830443701e3f8d9f4e0fd44bd8cb0b2f83,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,public static final int PRIMARY_POST_BASIC_DATA = 7000;
0f52be830443701e3f8d9f4e0fd44bd8cb0b2f83,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,public static final int ALL_TABLE_SEQUENCE = 8000;
0f52be830443701e3f8d9f4e0fd44bd8cb0b2f83,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,public static final int PRIMARY_MODULE_SECURITY = 2000;
0f52be830443701e3f8d9f4e0fd44bd8cb0b2f83,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,public static final int PRIMARY_BASIC_DATA = 3000;
0f52be830443701e3f8d9f4e0fd44bd8cb0b2f83,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,public static final int ALL_TABLE_SEQUENCE = 4000;
0f52be830443701e3f8d9f4e0fd44bd8cb0b2f83,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"return new AutoImportSql(AutoImportPersistenceUnit.BL_PU,""config/bc/sql/demo/populate_asset_folders.sql"", AutoImportStage.PRIMARY_POST_BASIC_DATA);"
0f52be830443701e3f8d9f4e0fd44bd8cb0b2f83,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"return new AutoImportSql(AutoImportPersistenceUnit.BL_PU,""config/bc/sql/demo/load_code_tables.sql"", AutoImportStage.PRIMARY_PRE_BASIC_DATA);"
0f52be830443701e3f8d9f4e0fd44bd8cb0b2f83,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"return new AutoImportSql(AutoImportPersistenceUnit.BL_PU,""config/bc/sql/demo/populate_asset_folders.sql"", AutoImportStage.PRIMARY_LATE);"
0f52be830443701e3f8d9f4e0fd44bd8cb0b2f83,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"return new AutoImportSql(AutoImportPersistenceUnit.BL_PU,""config/bc/sql/demo/load_code_tables.sql"", AutoImportStage.PRIMARY_BASIC_DATA);"
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,import java.util.HashMap;
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,import java.util.LinkedHashMap;
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,import java.util.Map;
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"public Map<String, List<AutoImportSql>> constructAutoImportSqlMapForPU(String persistenceUnit) {"
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"Map<String, List<AutoImportSql>> sqlMap = new LinkedHashMap<>();"
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"sqlMap.put(""AutoImportStage.PRIMARY_EARLY"", new ArrayList<AutoImportSql>());"
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"sqlMap.put(""AutoImportStage.PRIMARY_FRAMEWORK_SECURITY"", new ArrayList<AutoImportSql>());"
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"sqlMap.put(""AutoImportStage.PRIMARY_PRE_MODULE_SECURITY"", new ArrayList<AutoImportSql>());"
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"sqlMap.put(""AutoImportStage.PRIMARY_MODULE_SECURITY"", new ArrayList<AutoImportSql>());"
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"sqlMap.put(""AutoImportStage.PRIMARY_POST_MODULE_SECURITY"", new ArrayList<AutoImportSql>());"
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"sqlMap.put(""AutoImportStage.PRIMARY_PRE_BASIC_DATA"", new ArrayList<AutoImportSql>());"
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"sqlMap.put(""AutoImportStage.PRIMARY_BASIC_DATA"", new ArrayList<AutoImportSql>());"
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"sqlMap.put(""AutoImportStage.PRIMARY_POST_BASIC_DATA"", new ArrayList<AutoImportSql>());"
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"sqlMap.put(""AutoImportStage.ALL_TABLE_SEQUENCE"", new ArrayList<AutoImportSql>());"
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"sqlMap.put(""AutoImportStage.PRIMARY_LATE"", new ArrayList<AutoImportSql>());"
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,for (AutoImportSql sql : importSqlList) {
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,if (persistenceUnit.equals(sql.getPersistenceUnit()) || AutoImportPersistenceUnit.ALL.equals(sql.getPersistenceUnit())) {
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,int order = sql.getOrder();
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,if (order < AutoImportStage.PRIMARY_FRAMEWORK_SECURITY) {
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"sqlMap.get(""AutoImportStage.PRIMARY_EARLY"").add(sql);"
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,} else if (order >= AutoImportStage.PRIMARY_FRAMEWORK_SECURITY
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,&& order < AutoImportStage.PRIMARY_PRE_MODULE_SECURITY) {
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"sqlMap.get(""AutoImportStage.PRIMARY_FRAMEWORK_SECURITY"").add(sql);"
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,} else if (order >= AutoImportStage.PRIMARY_PRE_MODULE_SECURITY
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,&& order < AutoImportStage.PRIMARY_MODULE_SECURITY) {
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"sqlMap.get(""AutoImportStage.PRIMARY_PRE_MODULE_SECURITY"").add(sql);"
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,} else if (order >= AutoImportStage.PRIMARY_MODULE_SECURITY
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,&& order < AutoImportStage.PRIMARY_POST_MODULE_SECURITY) {
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"sqlMap.get(""AutoImportStage.PRIMARY_MODULE_SECURITY"").add(sql);"
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,} else if (order >= AutoImportStage.PRIMARY_POST_MODULE_SECURITY
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,&& order < AutoImportStage.PRIMARY_PRE_BASIC_DATA) {
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"sqlMap.get(""AutoImportStage.PRIMARY_POST_MODULE_SECURITY"").add(sql);"
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,} else if (order >= AutoImportStage.PRIMARY_PRE_BASIC_DATA
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,&& order < AutoImportStage.PRIMARY_BASIC_DATA) {
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"sqlMap.get(""AutoImportStage.PRIMARY_PRE_BASIC_DATA"").add(sql);"
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,} else if (order >= AutoImportStage.PRIMARY_BASIC_DATA
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,&& order < AutoImportStage.PRIMARY_POST_BASIC_DATA) {
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"sqlMap.get(""AutoImportStage.PRIMARY_BASIC_DATA"").add(sql);"
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,} else if (order >= AutoImportStage.PRIMARY_POST_BASIC_DATA
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,&& order < AutoImportStage.ALL_TABLE_SEQUENCE) {
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"sqlMap.get(""AutoImportStage.PRIMARY_POST_BASIC_DATA"").add(sql);"
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,} else if (order >= AutoImportStage.ALL_TABLE_SEQUENCE
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,&& order < AutoImportStage.PRIMARY_LATE) {
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"sqlMap.get(""AutoImportStage.ALL_TABLE_SEQUENCE"").add(sql);"
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,} else  {
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"sqlMap.get(""AutoImportStage.PRIMARY_LATE"").add(sql);"
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,}
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,return sqlMap;
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,import org.apache.commons.lang3.ArrayUtils;
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,import java.util.Arrays;
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,import javax.annotation.Resource;
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,public static final int BASIC_DATA_SPECIAL = AutoImportStage.PRIMARY_PRE_BASIC_DATA + 200;
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"""config/bc/sql/demo/load_catalog_i18n_data_FR.sql"", AutoImportStage.PRIMARY_PRE_BASIC_DATA);"
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,public static final int BASIC_DATA_SPECIAL = AutoImportStage.PRIMARY_BASIC_DATA - 30;
b1cbe839f7ce77e81832118281af0a7f76fa4c66,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"""config/bc/sql/demo/load_catalog_i18n_data_FR.sql"", AutoImportStage.PRIMARY_BASIC_DATA-50);"
9ffdba63fdf10c9e31138bf83526b4983ba618c1,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"String parentId, boolean isViewCollectionItem, List<SectionCrumb> sectionCrumbs, boolean isAdd)"
9ffdba63fdf10c9e31138bf83526b4983ba618c1,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"return buildAdornedListForm(adornedMd, adornedList, parentId, isViewCollectionItem, ef, sectionCrumbs, isAdd);"
9ffdba63fdf10c9e31138bf83526b4983ba618c1,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,"String parentId, boolean isViewCollectionItem, EntityForm ef, List<SectionCrumb> sectionCrumbs, boolean isAdd)"
9ffdba63fdf10c9e31138bf83526b4983ba618c1,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,.withAdornedList(adornedList)
9ffdba63fdf10c9e31138bf83526b4983ba618c1,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,.withSectionCrumbs(sectionCrumbs);
9ffdba63fdf10c9e31138bf83526b4983ba618c1,3a934b634c67330fda4b28d88f2dc865cff4356b,added,0,request.setAddOperationInspect(isAdd);
9ffdba63fdf10c9e31138bf83526b4983ba618c1,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"String parentId, boolean isViewCollectionItem)"
9ffdba63fdf10c9e31138bf83526b4983ba618c1,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"return buildAdornedListForm(adornedMd, adornedList, parentId, isViewCollectionItem, ef);"
9ffdba63fdf10c9e31138bf83526b4983ba618c1,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,"String parentId, boolean isViewCollectionItem, EntityForm ef)"
9ffdba63fdf10c9e31138bf83526b4983ba618c1,3a934b634c67330fda4b28d88f2dc865cff4356b,deleted,1,.withAdornedList(adornedList);
e32672e479cc8940e3e0b925021e5694faaee499,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,@Override
e32672e479cc8940e3e0b925021e5694faaee499,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,public <G extends IndexField> CreateResponse<G> createOrRetrieveCopyInstance(MultiTenantCopyContext context) throws CloneNotSupportedException {
e32672e479cc8940e3e0b925021e5694faaee499,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,CreateResponse<G> createResponse = context.createOrRetrieveCopyInstance(this);
e32672e479cc8940e3e0b925021e5694faaee499,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,if (createResponse.isAlreadyPopulated()) {
e32672e479cc8940e3e0b925021e5694faaee499,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,return createResponse;
e32672e479cc8940e3e0b925021e5694faaee499,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,}
e32672e479cc8940e3e0b925021e5694faaee499,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,IndexField cloned = createResponse.getClone();
e32672e479cc8940e3e0b925021e5694faaee499,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,cloned.setSearchable(searchable);
e32672e479cc8940e3e0b925021e5694faaee499,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,cloned.setField(field);
e32672e479cc8940e3e0b925021e5694faaee499,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,for(IndexFieldType entry : fieldTypes){
e32672e479cc8940e3e0b925021e5694faaee499,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,cloned.getFieldTypes().add(entry.createOrRetrieveCopyInstance(context).getClone());
e32672e479cc8940e3e0b925021e5694faaee499,a13be2d28410422ea098d4789c02b1cfa45b0f2f,added,0,public interface SearchFacet extends Serializable {
e32672e479cc8940e3e0b925021e5694faaee499,a13be2d28410422ea098d4789c02b1cfa45b0f2f,deleted,1,"public interface SearchFacet extends Serializable, MultiTenantCloneable<SearchFacet> {"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,import org.apache.commons.lang3.StringUtils;
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,import java.util.Arrays;
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,if (mapKey != null) {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"value = handleMapFieldExtraction(bean, fieldName, componentClass, value, fieldNamePart, mapKey);"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"handleMapFieldPopulation(bean, fieldName, newValue, componentClass, field, value, fieldNamePart, mapKey);"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"protected Object handleMapFieldExtraction(Object bean, String fieldName, Class<?> componentClass, Object value,"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"String fieldNamePart, String mapKey) throws IllegalAccessException, FieldNotAvailableException {"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"String fieldNamePrefix = fieldName.substring(0, fieldName.indexOf(fieldNamePart));"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"String multiValueMapFullFieldName = fieldNamePrefix + ""multiValue"" + fieldNamePart.substring(0, 1).toUpperCase() + fieldNamePart.substring(1);"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,String standardMapFullFieldName = null;
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,if (!StringUtils.isEmpty(fieldNamePrefix)) {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"standardMapFullFieldName = fieldNamePrefix + fieldNamePart.substring(0, 1).toUpperCase() + fieldNamePart.substring(1);"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,}
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,if (value instanceof List) {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,try {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"value = PropertyUtils.getProperty(bean, multiValueMapFullFieldName);"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,} catch (InvocationTargetException | NoSuchMethodException e) {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,if (!StringUtils.isEmpty(standardMapFullFieldName)) {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"value = PropertyUtils.getProperty(bean, standardMapFullFieldName);"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,} catch (InvocationTargetException | NoSuchMethodException n) {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"throw new FieldNotAvailableException(""Unable to find field ("" + fieldNamePart + "") on the class ("" + componentClass + "")"");"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,if (value != null && !(value instanceof Map)) {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"List<String> names = Arrays.asList(fieldNamePart, multiValueMapFullFieldName);"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,names.add(standardMapFullFieldName);
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"String combined = StringUtils.join(names, "","");"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"throw new IllegalArgumentException(String.format(""A field containing a map field separator was requested "" +"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"""(%s), but no Map type field or method returning a Map was found using the following tests (%s)"","
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"fieldName, combined));"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,if (value != null) {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,value = ((Map) value).get(mapKey);
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,// This handles gathering the first element of a list that came from a MultiValue Map
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,// used for single-value CustomFields
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,if (value instanceof List && !((List) value).isEmpty()) {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,value = ((List) value).get(0);
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,return value;
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"protected void handleMapFieldPopulation(Object bean, String fieldName, Object newValue, Class<?> componentClass,"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"Field field, Object value, String fieldNamePart, String mapKey) throws IllegalAccessException {"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"Map<String, Object> map = null;"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,Object fieldValue = field.get(value);
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,if (fieldValue instanceof List) {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"map = (Map<String, Object>) PropertyUtils.getProperty(bean, multiValueMapFullFieldName);"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,} catch (InvocationTargetException |NoSuchMethodException e) {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"map = (Map<String, Object>) PropertyUtils.getProperty(bean, standardMapFullFieldName);"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"LOG.info(""Unable to find a reference to ("" + field.getType().getName() + "") in the EntityConfigurationManager. "" +"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"""Using the type of this class."");"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"throw new IllegalAccessException(""Unable to save field ("" + fieldNamePart + "") on"" +"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,""" the class ("" + componentClass + "")"");"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,} else {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"map = (Map<String, Object>) fieldValue;"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,if (fieldValue != null && map == null) {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,if (newValue == null) {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,Object currentValue = map.get(mapKey);
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,if (currentValue != null && currentValue instanceof ValueAssignable) {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,((ValueAssignable) currentValue).setValue(null);
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,map.remove(mapKey);
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,added,0,"map.put(mapKey, newValue);"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,import org.apache.commons.collections4.MapUtils;
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,import org.broadleafcommerce.common.util.ApplicationContextHolder;
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,import java.util.Collection;
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,if (value instanceof List) {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"String fieldNamePrefix = fieldName.substring(0, fieldName.indexOf(fieldNamePart));"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"String fullFieldName = fieldNamePrefix + ""multiValue"" + fieldNamePart.substring(0, 1).toUpperCase() + fieldNamePart.substring(1);"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,try {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"value = PropertyUtils.getProperty(bean, fullFieldName);"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,} catch (InvocationTargetException|NoSuchMethodException e) {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,if (fieldNamePrefix.isEmpty()) {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,fullFieldName =  fieldNamePart;
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,} else {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"fullFieldName = fieldNamePrefix + fieldNamePart.substring(0, 1).toUpperCase() + fieldNamePart.substring(1);"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,}
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,} catch (InvocationTargetException|NoSuchMethodException n) {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"throw new FieldNotAvailableException(""Unable to find field ("" + fieldNamePart + "") on the class ("" + componentClass + "")"");"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,if (value != null && mapKey != null) {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,value = ((Map) value).get(mapKey);
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,// This handles gathering the first element of a list that came from a MultiValue Map
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,// used for single-value CustomFields
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,if (value instanceof List && !((List) value).isEmpty()) {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,value = ((List) value).get(0);
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"Map<String, Object> map;"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,if (field.get(value) instanceof List) {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"String fullFieldName = fieldNamePrefix + ""multiValue"" + fieldNamePart.substring(0, 1) + fieldNamePart.substring(1);"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"map = (Map<String, Object>)PropertyUtils.getProperty(bean, fullFieldName);"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"fullFieldName = fieldNamePrefix + fieldNamePart.substring(0, 1) + fieldNamePart.substring(1);"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"map = (Map<String, Object>) PropertyUtils.getProperty(bean, fullFieldName);"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"LOG.info(""Unable to find a reference to ("" + field.getType().getName() + "") in the EntityConfigurationManager. "" +"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"""Using the type of this class."");"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"throw new IllegalAccessException(""Unable to save field ("" + fieldNamePart + "") on the class ("" + componentClass + "")"");"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"map = (Map<String, Object>) field.get(value);"
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,if (newValue == null) {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,Object currentValue = map.get(mapKey);
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,if (currentValue != null && currentValue instanceof ValueAssignable) {
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,((ValueAssignable) currentValue).setValue(null);
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,map.remove(mapKey);
ff6b2191c22c5218c8b79de5b5112e721298bf9e,f714a9c7b7243d616243380c4b85e9364711eb5d,deleted,1,"map.put(mapKey, newValue);"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,import org.broadleafcommerce.common.service.EntityManagerService;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,import javax.annotation.Resource;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"@Resource(name=""blEntityManagerService"")"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,protected EntityManagerService emService;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,List<EntityManager> entityManagers = emService.retrieveAllEntityManagers();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,for (EntityManager em : entityManagers) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,SessionFactory sessionFactory = ((HibernateEntityManager) em).getSession().getSessionFactory();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,for (Object item : sessionFactory.getAllClassMetadata().values()) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,ClassMetadata metadata = (ClassMetadata) item;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,String idProperty = metadata.getIdentifierPropertyName();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,Class<?> mappedClass = metadata.getMappedClass();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,Field idField;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,try {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,idField = mappedClass.getDeclaredField(idProperty);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,} catch (NoSuchFieldException e) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,continue;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,}
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,idField.setAccessible(true);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,GenericGenerator genericAnnot = idField.getAnnotation(GenericGenerator.class);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,TableGenerator tableAnnot = idField.getAnnotation(TableGenerator.class);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,String segmentValue = null;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,String tableName = null;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,String segmentColumnName = null;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,String valueColumnName = null;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (genericAnnot != null && genericAnnot.strategy().equals(IdOverrideTableGenerator.class.getName())) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,//This is a BLC style ID generator
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,for (Parameter param : genericAnnot.parameters()) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"if (param.name().equals(""segment_value"")) {"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,segmentValue = param.value();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"if (param.name().equals(""table_name"")) {"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,tableName = param.value();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"if (param.name().equals(""segment_column_name"")) {"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,segmentColumnName = param.value();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"if (param.name().equals(""value_column_name"")) {"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,valueColumnName = param.value();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,// Default values are set on startup in IdOverrideTableGenerator so that every annotation does not have
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"// to redefine them. If they aren't defined in the annotation, glean them from the defaults"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (StringUtils.isBlank(tableName)) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,tableName = IdOverrideTableGenerator.DEFAULT_TABLE_NAME;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (StringUtils.isBlank(segmentColumnName)) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,segmentColumnName = IdOverrideTableGenerator.DEFAULT_SEGMENT_COLUMN_NAME;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (StringUtils.isBlank(valueColumnName)) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,valueColumnName = IdOverrideTableGenerator.DEFAULT_VALUE_COLUMN_NAME;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,} else if (tableAnnot != null) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,//This is a traditional Hibernate generator
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,segmentValue = tableAnnot.pkColumnValue();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,tableName = tableAnnot.table();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,segmentColumnName = tableAnnot.pkColumnName();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,valueColumnName = tableAnnot.valueColumnName();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (!StringUtils.isEmpty(segmentValue) && !StringUtils.isEmpty(tableName) && !StringUtils.isEmpty(segmentColumnName) && !StringUtils.isEmpty(valueColumnName)) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,StringBuilder sb2 = new StringBuilder();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"sb2.append(""select "");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,sb2.append(valueColumnName);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"sb2.append("" from "");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"if (!tableName.contains(""."") && !StringUtils.isEmpty(defaultSchemaSequenceGenerator)) {"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,sb2.append(defaultSchemaSequenceGenerator);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"sb2.append(""."");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,sb2.append(tableName);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"sb2.append("" where "");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,sb2.append(segmentColumnName);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"sb2.append("" = '"");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,sb2.append(segmentValue);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"sb2.append(""'"");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,Long maxSequenceId = 0l;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,boolean sequenceEntryExists = false;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,List results2 = em.createNativeQuery(sb2.toString()).getResultList();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (CollectionUtils.isNotEmpty(results2) && results2.get(0) != null) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,maxSequenceId = ((Number) results2.get(0)).longValue();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,sequenceEntryExists = true;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"LOG.info(""Detecting id sequence state between "" + mappedClass.getName() + "" and "" + segmentValue + "" in "" + tableName);"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,StringBuilder sb = new StringBuilder();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"sb.append(""select max("");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,sb.append(idField.getName());
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"sb.append("") from "");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,sb.append(mappedClass.getName());
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"sb.append("" entity"");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,List results;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,BroadleafRequestContext context = BroadleafRequestContext.getBroadleafRequestContext();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,context.setInternalIgnoreFilters(true);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,results = em.createQuery(sb.toString()).getResultList();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,} finally {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,context.setInternalIgnoreFilters(false);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (CollectionUtils.isNotEmpty(results) && results.get(0) != null) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"LOG.debug(String.format(""Checking for sequence corruption on entity %s"", segmentValue));"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,Long maxEntityId = BLCNumberUtils.toLong(results.get(0));
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (maxEntityId > maxSequenceId) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"LOG.error(String.format(""The sequence value for %s in %s was found as %d (or an entry did not exist) but the actual max sequence in"""
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"+ "" %s's table was found as %d"", segmentValue, tableName, maxSequenceId, mappedClass.getName(), maxEntityId));"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (automaticallyCorrectInconsistencies) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,long newMaxId = maxEntityId + 10;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (sequenceEntryExists) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"String log = String.format(""Correcting sequences for entity %s.  Updating the sequence value"""
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"+ "" to %d"","
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"mappedClass.getName(), newMaxId);"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,LOG.warn(log);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,StringBuilder updateQuery = new StringBuilder();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"updateQuery.append(""update "");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,updateQuery.append(tableName);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"updateQuery.append("" set "");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,updateQuery.append(valueColumnName);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"updateQuery.append("" = "");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,updateQuery.append(String.valueOf(newMaxId));
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"updateQuery.append("" where "");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,updateQuery.append(segmentColumnName);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"updateQuery.append("" = '"");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,updateQuery.append(segmentValue);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"updateQuery.append(""'"");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,int response = em.createNativeQuery(updateQuery.toString()).executeUpdate();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (response <= 0) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"throw new RuntimeException(""Unable to update "" + tableName + "" with the sequence generator id for "" + segmentValue);"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,} else {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"String log = String.format(""Correcting sequences for entity %s. Did not find an entry in"""
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"+ "" %s, inserting the new sequence value as %d"","
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"mappedClass.getName(), tableName, newMaxId);"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,StringBuilder insertQuery = new StringBuilder();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"insertQuery.append(""insert into "");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,insertQuery.append(tableName);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"insertQuery.append("" ("" + segmentColumnName + "","" + valueColumnName + "")"");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"insertQuery.append(""values ('"" + segmentValue + ""','"" + String.valueOf(newMaxId) + ""')"");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,int response = em.createNativeQuery(insertQuery.toString()).executeUpdate();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"String reason = ""A data inconsistency has been detected between the "" + tableName + "" table and one or more entity tables for which it manages current max primary key values.\n"" +"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"""The inconsistency was detected between the managed class ("" + mappedClass.getName() + "") and the identifier ("" + segmentValue + "") in "" + tableName + "". Broadleaf\n"" +"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"""has stopped startup of the application in order to allow you to resolve the issue and avoid possible data corruption. If you wish to disable this detection, you may\n"" +"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"""set the 'detect.sequence.generator.inconsistencies' property to false in your application's common.properties or common-shared.properties. If you would like for this component\n"" +"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"""to autocorrect these problems by setting the sequence generator value to a value greater than the max entity id, then set the 'auto.correct.sequence.generator.inconsistencies'\n"" +"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"""property to true in your application's common.properties or common-shared.properties. If you would like to provide a default schema to be used to qualify table names used in the\n"" +"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"""queries for this detection, set the 'default.schema.sequence.generator' property in your application's common.properties or common-shared.properties. Also, if you are upgrading\n"" +"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"""from 1.6 or below, please refer to http://docs.broadleafcommerce.org/current/1.6-to-2.0-Migration.html for important information regarding migrating your SEQUENCE_GENERATOR table."";"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"LOG.error(""Broadleaf Commerce failed to start"", new RuntimeException(reason));"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,added,0,System.exit(1);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,import javax.persistence.PersistenceContext;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"@PersistenceContext(unitName=""blPU"")"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,protected EntityManager em;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,SessionFactory sessionFactory = ((HibernateEntityManager) em).getSession().getSessionFactory();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,for (Object item : sessionFactory.getAllClassMetadata().values()) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,ClassMetadata metadata = (ClassMetadata) item;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,String idProperty = metadata.getIdentifierPropertyName();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,Class<?> mappedClass = metadata.getMappedClass();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,Field idField;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,try {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,idField = mappedClass.getDeclaredField(idProperty);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,} catch (NoSuchFieldException e) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,continue;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,}
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,idField.setAccessible(true);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,GenericGenerator genericAnnot = idField.getAnnotation(GenericGenerator.class);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,TableGenerator tableAnnot = idField.getAnnotation(TableGenerator.class);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,String segmentValue = null;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,String tableName = null;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,String segmentColumnName = null;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,String valueColumnName = null;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (genericAnnot != null && genericAnnot.strategy().equals(IdOverrideTableGenerator.class.getName())) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,//This is a BLC style ID generator
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,for (Parameter param : genericAnnot.parameters()) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"if (param.name().equals(""segment_value"")) {"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,segmentValue = param.value();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"if (param.name().equals(""table_name"")) {"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,tableName = param.value();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"if (param.name().equals(""segment_column_name"")) {"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,segmentColumnName = param.value();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"if (param.name().equals(""value_column_name"")) {"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,valueColumnName = param.value();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,// Default values are set on startup in IdOverrideTableGenerator so that every annotation does not have
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"// to redefine them. If they aren't defined in the annotation, glean them from the defaults"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (StringUtils.isBlank(tableName)) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,tableName = IdOverrideTableGenerator.DEFAULT_TABLE_NAME;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (StringUtils.isBlank(segmentColumnName)) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,segmentColumnName = IdOverrideTableGenerator.DEFAULT_SEGMENT_COLUMN_NAME;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (StringUtils.isBlank(valueColumnName)) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,valueColumnName = IdOverrideTableGenerator.DEFAULT_VALUE_COLUMN_NAME;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,} else if (tableAnnot != null) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,//This is a traditional Hibernate generator
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,segmentValue = tableAnnot.pkColumnValue();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,tableName = tableAnnot.table();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,segmentColumnName = tableAnnot.pkColumnName();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,valueColumnName = tableAnnot.valueColumnName();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (!StringUtils.isEmpty(segmentValue) && !StringUtils.isEmpty(tableName) && !StringUtils.isEmpty(segmentColumnName) && !StringUtils.isEmpty(valueColumnName)) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,StringBuilder sb2 = new StringBuilder();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb2.append(""select "");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,sb2.append(valueColumnName);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb2.append("" from "");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"if (!tableName.contains(""."") && !StringUtils.isEmpty(defaultSchemaSequenceGenerator)) {"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,sb2.append(defaultSchemaSequenceGenerator);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb2.append(""."");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,sb2.append(tableName);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb2.append("" where "");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,sb2.append(segmentColumnName);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb2.append("" = '"");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,sb2.append(segmentValue);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb2.append(""'"");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,Long maxSequenceId = 0l;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,boolean sequenceEntryExists = false;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,List results2 = em.createNativeQuery(sb2.toString()).getResultList();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (CollectionUtils.isNotEmpty(results2) && results2.get(0) != null) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,maxSequenceId = ((Number) results2.get(0)).longValue();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,sequenceEntryExists = true;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"LOG.info(""Detecting id sequence state between "" + mappedClass.getName() + "" and "" + segmentValue + "" in "" + tableName);"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,StringBuilder sb = new StringBuilder();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb.append(""select max("");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,sb.append(idField.getName());
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb.append("") from "");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,sb.append(mappedClass.getName());
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb.append("" entity"");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,List results;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,BroadleafRequestContext context = BroadleafRequestContext.getBroadleafRequestContext();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,context.setInternalIgnoreFilters(true);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,results = em.createQuery(sb.toString()).getResultList();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,} finally {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,context.setInternalIgnoreFilters(false);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (CollectionUtils.isNotEmpty(results) && results.get(0) != null) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"LOG.debug(String.format(""Checking for sequence corruption on entity %s"", segmentValue));"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,Long maxEntityId = BLCNumberUtils.toLong(results.get(0));
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (maxEntityId > maxSequenceId) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"LOG.error(String.format(""The sequence value for %s in %s was found as %d (or an entry did not exist) but the actual max sequence in"""
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"+ "" %s's table was found as %d"", segmentValue, tableName, maxSequenceId, mappedClass.getName(), maxEntityId));"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (automaticallyCorrectInconsistencies) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,long newMaxId = maxEntityId + 10;
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (sequenceEntryExists) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"String log = String.format(""Correcting sequences for entity %s.  Updating the sequence value"""
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"+ "" to %d"","
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"mappedClass.getName(), newMaxId);"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,LOG.warn(log);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,StringBuilder updateQuery = new StringBuilder();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"updateQuery.append(""update "");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,updateQuery.append(tableName);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"updateQuery.append("" set "");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,updateQuery.append(valueColumnName);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"updateQuery.append("" = "");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,updateQuery.append(String.valueOf(newMaxId));
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"updateQuery.append("" where "");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,updateQuery.append(segmentColumnName);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"updateQuery.append("" = '"");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,updateQuery.append(segmentValue);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"updateQuery.append(""'"");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,int response = em.createNativeQuery(updateQuery.toString()).executeUpdate();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (response <= 0) {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"throw new RuntimeException(""Unable to update "" + tableName + "" with the sequence generator id for "" + segmentValue);"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"String log = String.format(""Correcting sequences for entity %s. Did not find an entry in"""
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"+ "" %s, inserting the new sequence value as %d"","
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"mappedClass.getName(), tableName, newMaxId);"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,StringBuilder insertQuery = new StringBuilder();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"insertQuery.append(""insert into "");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,insertQuery.append(tableName);
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"insertQuery.append("" ("" + segmentColumnName + "","" + valueColumnName + "")"");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"insertQuery.append(""values ('"" + segmentValue + ""','"" + String.valueOf(newMaxId) + ""')"");"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,int response = em.createNativeQuery(insertQuery.toString()).executeUpdate();
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,} else {
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"String reason = ""A data inconsistency has been detected between the "" + tableName + "" table and one or more entity tables for which it manages current max primary key values.\n"" +"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"""The inconsistency was detected between the managed class ("" + mappedClass.getName() + "") and the identifier ("" + segmentValue + "") in "" + tableName + "". Broadleaf\n"" +"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"""has stopped startup of the application in order to allow you to resolve the issue and avoid possible data corruption. If you wish to disable this detection, you may\n"" +"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"""set the 'detect.sequence.generator.inconsistencies' property to false in your application's common.properties or common-shared.properties. If you would like for this component\n"" +"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"""to autocorrect these problems by setting the sequence generator value to a value greater than the max entity id, then set the 'auto.correct.sequence.generator.inconsistencies'\n"" +"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"""property to true in your application's common.properties or common-shared.properties. If you would like to provide a default schema to be used to qualify table names used in the\n"" +"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"""queries for this detection, set the 'default.schema.sequence.generator' property in your application's common.properties or common-shared.properties. Also, if you are upgrading\n"" +"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"""from 1.6 or below, please refer to http://docs.broadleafcommerce.org/current/1.6-to-2.0-Migration.html for important information regarding migrating your SEQUENCE_GENERATOR table."";"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"LOG.error(""Broadleaf Commerce failed to start"", new RuntimeException(reason));"
835d8b408fd2aae765bc049a90562caa75e7d276,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,System.exit(1);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,import org.broadleafcommerce.common.util.TransactionUtils;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,import org.hibernate.Session;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,import org.hibernate.Transaction;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,Session hibernateSession = em.unwrap(Session.class);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,Transaction tx = TransactionUtils.createTransaction(hibernateSession);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,try {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"patchSequenceGeneratorInconsistencies(em, hibernateSession);"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,} finally {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"TransactionUtils.finalizeTransaction(tx, false);"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (hibernateSession != null) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,hibernateSession.close();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,}
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"protected void patchSequenceGeneratorInconsistencies(EntityManager em, Session session) {"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,SessionFactory sessionFactory = session.getSessionFactory();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,for (Object item : sessionFactory.getAllClassMetadata().values()) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,ClassMetadata metadata = (ClassMetadata) item;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,String idProperty = metadata.getIdentifierPropertyName();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,Class<?> mappedClass = metadata.getMappedClass();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,Field idField;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,idField = mappedClass.getDeclaredField(idProperty);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,} catch (NoSuchFieldException e) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,continue;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,idField.setAccessible(true);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,GenericGenerator genericAnnot = idField.getAnnotation(GenericGenerator.class);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,TableGenerator tableAnnot = idField.getAnnotation(TableGenerator.class);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,String segmentValue = null;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,String tableName = null;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,String segmentColumnName = null;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,String valueColumnName = null;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (genericAnnot != null && genericAnnot.strategy().equals(IdOverrideTableGenerator.class.getName())) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,//This is a BLC style ID generator
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,for (Parameter param : genericAnnot.parameters()) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"if (param.name().equals(""segment_value"")) {"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,segmentValue = param.value();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"if (param.name().equals(""table_name"")) {"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,tableName = param.value();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"if (param.name().equals(""segment_column_name"")) {"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,segmentColumnName = param.value();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"if (param.name().equals(""value_column_name"")) {"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,valueColumnName = param.value();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,// Default values are set on startup in IdOverrideTableGenerator so that every annotation does not have
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"// to redefine them. If they aren't defined in the annotation, glean them from the defaults"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (StringUtils.isBlank(tableName)) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,tableName = IdOverrideTableGenerator.DEFAULT_TABLE_NAME;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (StringUtils.isBlank(segmentColumnName)) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,segmentColumnName = IdOverrideTableGenerator.DEFAULT_SEGMENT_COLUMN_NAME;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (StringUtils.isBlank(valueColumnName)) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,valueColumnName = IdOverrideTableGenerator.DEFAULT_VALUE_COLUMN_NAME;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,} else if (tableAnnot != null) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,//This is a traditional Hibernate generator
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,segmentValue = tableAnnot.pkColumnValue();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,tableName = tableAnnot.table();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,segmentColumnName = tableAnnot.pkColumnName();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,valueColumnName = tableAnnot.valueColumnName();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (!StringUtils.isEmpty(segmentValue) && !StringUtils.isEmpty(tableName) && !StringUtils.isEmpty(segmentColumnName) && !StringUtils.isEmpty(valueColumnName)) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,StringBuilder sb2 = new StringBuilder();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"sb2.append(""select "");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,sb2.append(valueColumnName);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"sb2.append("" from "");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"if (!tableName.contains(""."") && !StringUtils.isEmpty(defaultSchemaSequenceGenerator)) {"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,sb2.append(defaultSchemaSequenceGenerator);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"sb2.append(""."");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,sb2.append(tableName);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"sb2.append("" where "");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,sb2.append(segmentColumnName);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"sb2.append("" = '"");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,sb2.append(segmentValue);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"sb2.append(""'"");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,Long maxSequenceId = 0l;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,boolean sequenceEntryExists = false;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,List results2 = em.createNativeQuery(sb2.toString()).getResultList();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (CollectionUtils.isNotEmpty(results2) && results2.get(0) != null) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,maxSequenceId = ((Number) results2.get(0)).longValue();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,sequenceEntryExists = true;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"LOG.info(""Detecting id sequence state between "" + mappedClass.getName() + "" and "" + segmentValue + "" in "" + tableName);"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,StringBuilder sb = new StringBuilder();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"sb.append(""select max("");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,sb.append(idField.getName());
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"sb.append("") from "");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,sb.append(mappedClass.getName());
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"sb.append("" entity"");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,List results;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,BroadleafRequestContext context = BroadleafRequestContext.getBroadleafRequestContext();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,context.setInternalIgnoreFilters(true);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,results = em.createQuery(sb.toString()).getResultList();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,context.setInternalIgnoreFilters(false);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (CollectionUtils.isNotEmpty(results) && results.get(0) != null) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"LOG.debug(String.format(""Checking for sequence corruption on entity %s"", segmentValue));"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,Long maxEntityId = BLCNumberUtils.toLong(results.get(0));
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (maxEntityId > maxSequenceId) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"LOG.error(String.format(""The sequence value for %s in %s was found as %d (or an entry did not exist) but the actual max sequence in"""
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"+ "" %s's table was found as %d"", segmentValue, tableName, maxSequenceId, mappedClass.getName(), maxEntityId));"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (automaticallyCorrectInconsistencies) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,long newMaxId = maxEntityId + 10;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (sequenceEntryExists) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"String log = String.format(""Correcting sequences for entity %s.  Updating the sequence value"""
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"+ "" to %d"","
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"mappedClass.getName(), newMaxId);"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,LOG.warn(log);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,StringBuilder updateQuery = new StringBuilder();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"updateQuery.append(""update "");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,updateQuery.append(tableName);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"updateQuery.append("" set "");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,updateQuery.append(valueColumnName);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"updateQuery.append("" = "");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,updateQuery.append(String.valueOf(newMaxId));
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"updateQuery.append("" where "");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,updateQuery.append(segmentColumnName);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"updateQuery.append("" = '"");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,updateQuery.append(segmentValue);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"updateQuery.append(""'"");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,int response = em.createNativeQuery(updateQuery.toString()).executeUpdate();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,if (response <= 0) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"throw new RuntimeException(""Unable to update "" + tableName + "" with the sequence generator id for "" + segmentValue);"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,} else {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"String log = String.format(""Correcting sequences for entity %s. Did not find an entry in"""
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"+ "" %s, inserting the new sequence value as %d"","
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"mappedClass.getName(), tableName, newMaxId);"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,StringBuilder insertQuery = new StringBuilder();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"insertQuery.append(""insert into "");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,insertQuery.append(tableName);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"insertQuery.append("" ("" + segmentColumnName + "","" + valueColumnName + "")"");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"insertQuery.append(""values ('"" + segmentValue + ""','"" + String.valueOf(newMaxId) + ""')"");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,int response = em.createNativeQuery(insertQuery.toString()).executeUpdate();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"String reason = ""A data inconsistency has been detected between the "" + tableName + "" table and one or more entity tables for which it manages current max primary key values.\n"" +"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"""The inconsistency was detected between the managed class ("" + mappedClass.getName() + "") and the identifier ("" + segmentValue + "") in "" + tableName + "". Broadleaf\n"" +"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"""has stopped startup of the application in order to allow you to resolve the issue and avoid possible data corruption. If you wish to disable this detection, you may\n"" +"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"""set the 'detect.sequence.generator.inconsistencies' property to false in your application's common.properties or common-shared.properties. If you would like for this component\n"" +"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"""to autocorrect these problems by setting the sequence generator value to a value greater than the max entity id, then set the 'auto.correct.sequence.generator.inconsistencies'\n"" +"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"""property to true in your application's common.properties or common-shared.properties. If you would like to provide a default schema to be used to qualify table names used in the\n"" +"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"""queries for this detection, set the 'default.schema.sequence.generator' property in your application's common.properties or common-shared.properties. Also, if you are upgrading\n"" +"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"""from 1.6 or below, please refer to http://docs.broadleafcommerce.org/current/1.6-to-2.0-Migration.html for important information regarding migrating your SEQUENCE_GENERATOR table."";"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,"LOG.error(""Broadleaf Commerce failed to start"", new RuntimeException(reason));"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,added,0,System.exit(1);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,import org.hibernate.ejb.HibernateEntityManager;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,import org.springframework.transaction.annotation.Transactional;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"@Transactional(""blTransactionManager"")"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,SessionFactory sessionFactory = ((HibernateEntityManager) em).getSession().getSessionFactory();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,for (Object item : sessionFactory.getAllClassMetadata().values()) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,ClassMetadata metadata = (ClassMetadata) item;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,String idProperty = metadata.getIdentifierPropertyName();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,Class<?> mappedClass = metadata.getMappedClass();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,Field idField;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,try {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,idField = mappedClass.getDeclaredField(idProperty);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,} catch (NoSuchFieldException e) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,continue;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,idField.setAccessible(true);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,GenericGenerator genericAnnot = idField.getAnnotation(GenericGenerator.class);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,TableGenerator tableAnnot = idField.getAnnotation(TableGenerator.class);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,String segmentValue = null;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,String tableName = null;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,String segmentColumnName = null;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,String valueColumnName = null;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (genericAnnot != null && genericAnnot.strategy().equals(IdOverrideTableGenerator.class.getName())) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,//This is a BLC style ID generator
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,for (Parameter param : genericAnnot.parameters()) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"if (param.name().equals(""segment_value"")) {"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,segmentValue = param.value();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,}
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"if (param.name().equals(""table_name"")) {"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,tableName = param.value();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"if (param.name().equals(""segment_column_name"")) {"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,segmentColumnName = param.value();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"if (param.name().equals(""value_column_name"")) {"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,valueColumnName = param.value();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,// Default values are set on startup in IdOverrideTableGenerator so that every annotation does not have
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"// to redefine them. If they aren't defined in the annotation, glean them from the defaults"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (StringUtils.isBlank(tableName)) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,tableName = IdOverrideTableGenerator.DEFAULT_TABLE_NAME;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (StringUtils.isBlank(segmentColumnName)) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,segmentColumnName = IdOverrideTableGenerator.DEFAULT_SEGMENT_COLUMN_NAME;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (StringUtils.isBlank(valueColumnName)) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,valueColumnName = IdOverrideTableGenerator.DEFAULT_VALUE_COLUMN_NAME;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,} else if (tableAnnot != null) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,//This is a traditional Hibernate generator
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,segmentValue = tableAnnot.pkColumnValue();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,tableName = tableAnnot.table();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,segmentColumnName = tableAnnot.pkColumnName();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,valueColumnName = tableAnnot.valueColumnName();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (!StringUtils.isEmpty(segmentValue) && !StringUtils.isEmpty(tableName) && !StringUtils.isEmpty(segmentColumnName) && !StringUtils.isEmpty(valueColumnName)) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,StringBuilder sb2 = new StringBuilder();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb2.append(""select "");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,sb2.append(valueColumnName);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb2.append("" from "");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"if (!tableName.contains(""."") && !StringUtils.isEmpty(defaultSchemaSequenceGenerator)) {"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,sb2.append(defaultSchemaSequenceGenerator);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb2.append(""."");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,sb2.append(tableName);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb2.append("" where "");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,sb2.append(segmentColumnName);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb2.append("" = '"");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,sb2.append(segmentValue);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb2.append(""'"");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,Long maxSequenceId = 0l;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,boolean sequenceEntryExists = false;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,List results2 = em.createNativeQuery(sb2.toString()).getResultList();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (CollectionUtils.isNotEmpty(results2) && results2.get(0) != null) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,maxSequenceId = ((Number) results2.get(0)).longValue();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,sequenceEntryExists = true;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"LOG.info(""Detecting id sequence state between "" + mappedClass.getName() + "" and "" + segmentValue + "" in "" + tableName);"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,StringBuilder sb = new StringBuilder();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb.append(""select max("");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,sb.append(idField.getName());
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb.append("") from "");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,sb.append(mappedClass.getName());
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"sb.append("" entity"");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,List results;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,BroadleafRequestContext context = BroadleafRequestContext.getBroadleafRequestContext();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,context.setInternalIgnoreFilters(true);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,results = em.createQuery(sb.toString()).getResultList();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,} finally {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,context.setInternalIgnoreFilters(false);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (CollectionUtils.isNotEmpty(results) && results.get(0) != null) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"LOG.debug(String.format(""Checking for sequence corruption on entity %s"", segmentValue));"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,Long maxEntityId = BLCNumberUtils.toLong(results.get(0));
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (maxEntityId > maxSequenceId) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"LOG.error(String.format(""The sequence value for %s in %s was found as %d (or an entry did not exist) but the actual max sequence in"""
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"+ "" %s's table was found as %d"", segmentValue, tableName, maxSequenceId, mappedClass.getName(), maxEntityId));"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (automaticallyCorrectInconsistencies) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,long newMaxId = maxEntityId + 10;
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (sequenceEntryExists) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"String log = String.format(""Correcting sequences for entity %s.  Updating the sequence value"""
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"+ "" to %d"","
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"mappedClass.getName(), newMaxId);"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,LOG.warn(log);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,StringBuilder updateQuery = new StringBuilder();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"updateQuery.append(""update "");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,updateQuery.append(tableName);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"updateQuery.append("" set "");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,updateQuery.append(valueColumnName);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"updateQuery.append("" = "");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,updateQuery.append(String.valueOf(newMaxId));
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"updateQuery.append("" where "");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,updateQuery.append(segmentColumnName);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"updateQuery.append("" = '"");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,updateQuery.append(segmentValue);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"updateQuery.append(""'"");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,int response = em.createNativeQuery(updateQuery.toString()).executeUpdate();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,if (response <= 0) {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"throw new RuntimeException(""Unable to update "" + tableName + "" with the sequence generator id for "" + segmentValue);"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,} else {
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"String log = String.format(""Correcting sequences for entity %s. Did not find an entry in"""
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"+ "" %s, inserting the new sequence value as %d"","
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"mappedClass.getName(), tableName, newMaxId);"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,StringBuilder insertQuery = new StringBuilder();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"insertQuery.append(""insert into "");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,insertQuery.append(tableName);
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"insertQuery.append("" ("" + segmentColumnName + "","" + valueColumnName + "")"");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"insertQuery.append(""values ('"" + segmentValue + ""','"" + String.valueOf(newMaxId) + ""')"");"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,int response = em.createNativeQuery(insertQuery.toString()).executeUpdate();
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"String reason = ""A data inconsistency has been detected between the "" + tableName + "" table and one or more entity tables for which it manages current max primary key values.\n"" +"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"""The inconsistency was detected between the managed class ("" + mappedClass.getName() + "") and the identifier ("" + segmentValue + "") in "" + tableName + "". Broadleaf\n"" +"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"""has stopped startup of the application in order to allow you to resolve the issue and avoid possible data corruption. If you wish to disable this detection, you may\n"" +"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"""set the 'detect.sequence.generator.inconsistencies' property to false in your application's common.properties or common-shared.properties. If you would like for this component\n"" +"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"""to autocorrect these problems by setting the sequence generator value to a value greater than the max entity id, then set the 'auto.correct.sequence.generator.inconsistencies'\n"" +"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"""property to true in your application's common.properties or common-shared.properties. If you would like to provide a default schema to be used to qualify table names used in the\n"" +"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"""queries for this detection, set the 'default.schema.sequence.generator' property in your application's common.properties or common-shared.properties. Also, if you are upgrading\n"" +"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"""from 1.6 or below, please refer to http://docs.broadleafcommerce.org/current/1.6-to-2.0-Migration.html for important information regarding migrating your SEQUENCE_GENERATOR table."";"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,"LOG.error(""Broadleaf Commerce failed to start"", new RuntimeException(reason));"
91b5a44a10ed2de324778015db473cc561a92256,3f045f476d549a73478867a8aa6d305ec4284457,deleted,1,System.exit(1);
35ce2e04a4dac1e6b2e897315ea7834e59b45d67,23c3254ea1399aabd91b595298bee1f5a3e9029c,added,0,"Map<String, Class<?>> contextImports = new HashMap<>();"
35ce2e04a4dac1e6b2e897315ea7834e59b45d67,23c3254ea1399aabd91b595298bee1f5a3e9029c,added,0,"return MvelHelper.evaluateRule(expression, vars, EXPRESSION_CACHE, contextImports);"
35ce2e04a4dac1e6b2e897315ea7834e59b45d67,23c3254ea1399aabd91b595298bee1f5a3e9029c,deleted,1,"Map<String, Class<?>> contextImports = new HashMap<>();"
35ce2e04a4dac1e6b2e897315ea7834e59b45d67,23c3254ea1399aabd91b595298bee1f5a3e9029c,deleted,1,"return MvelHelper.evaluateRule(expression, vars, EXPRESSION_CACHE, contextImports);"
60c8e3dc2d897250288633148669f5270a331259,23c3254ea1399aabd91b595298bee1f5a3e9029c,added,0,expression = usePriceBeforeAdjustments(expression);
60c8e3dc2d897250288633148669f5270a331259,23c3254ea1399aabd91b595298bee1f5a3e9029c,added,0,"contextImports.put(""OfferType"", OfferType.class);"
60c8e3dc2d897250288633148669f5270a331259,23c3254ea1399aabd91b595298bee1f5a3e9029c,added,0,"contextImports.put(""FulfillmentType"", FulfillmentType.class);"
60c8e3dc2d897250288633148669f5270a331259,23c3254ea1399aabd91b595298bee1f5a3e9029c,deleted,1,synchronized (EXPRESSION_CACHE) {
60c8e3dc2d897250288633148669f5270a331259,23c3254ea1399aabd91b595298bee1f5a3e9029c,deleted,1,expression = usePriceBeforeAdjustments(expression);
60c8e3dc2d897250288633148669f5270a331259,23c3254ea1399aabd91b595298bee1f5a3e9029c,deleted,1,"contextImports.put(""OfferType"", OfferType.class);"
60c8e3dc2d897250288633148669f5270a331259,23c3254ea1399aabd91b595298bee1f5a3e9029c,deleted,1,"contextImports.put(""FulfillmentType"", FulfillmentType.class);"
60c8e3dc2d897250288633148669f5270a331259,23c3254ea1399aabd91b595298bee1f5a3e9029c,deleted,1,}
0a76892ab1dbbccd1c92a8a8d66364e66a8f4400,23c3254ea1399aabd91b595298bee1f5a3e9029c,added,0,"return MvelHelper.evaluateRule(expression, vars);"
0a76892ab1dbbccd1c92a8a8d66364e66a8f4400,23c3254ea1399aabd91b595298bee1f5a3e9029c,deleted,1,"protected Map<String, Serializable> expressionCache = new EfficientLRUMap<String, Serializable>(1000);"
0a76892ab1dbbccd1c92a8a8d66364e66a8f4400,23c3254ea1399aabd91b595298bee1f5a3e9029c,deleted,1,"return MvelHelper.evaluateRule(expression, vars, expressionCache);"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,import org.broadleafcommerce.common.controller.FrameworkController;
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,import org.broadleafcommerce.common.controller.FrameworkMapping;
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,@FrameworkController
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(""/{sectionKey:.+}"")"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = """", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/selectize"", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/add"", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/add"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/{id}"", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/{id}/{tab:[0-9]+}/{tabName}"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/{id}"", method = RequestMethod.POST, produces = ""application/json"")"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/{id}"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/{id}/delete"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/{collectionField:.*}/details"", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/{collectionField:.*}/{id}/view"", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/{id}/{collectionField:.*}"", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/{id}/{collectionField:.*}/add"", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/{id}/{collectionField:.*}/add/{collectionItemId}/verify"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/{id}/{collectionField:.*}/selectize"", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/{id}/{collectionField:.*}/selectize-add"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/{id}/{collectionField:.*}/add"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/{id}/{collectionField:.*}/addEmpty"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}"", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/{id}/{collectionField:.*}/{collectionItemId}"", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/view"", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/{id}/{collectionField:.*}/{collectionItemId}/view"", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/{id}/{collectionField:.*}/{collectionItemId}"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/{id}/{collectionField:.*}/{collectionItemId}/sequence"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/sequence"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/{id}/{collectionField:.*}/{collectionItemId}/delete"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"@FrameworkMapping(value = ""/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/delete"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,import org.springframework.stereotype.Controller;
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,import org.springframework.web.bind.annotation.RequestMapping;
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@Controller(""blAdminBasicEntityController"")"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(""/{sectionKey:.+}"")"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = """", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/selectize"", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/add"", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/add"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/{id}"", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/{id}/{tab:[0-9]+}/{tabName}"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/{id}"", method = RequestMethod.POST, produces = ""application/json"")"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/{id}"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/{id}/delete"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/{collectionField:.*}/details"", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/{collectionField:.*}/{id}/view"", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/{id}/{collectionField:.*}"", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/{id}/{collectionField:.*}/add"", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/{id}/{collectionField:.*}/add/{collectionItemId}/verify"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/{id}/{collectionField:.*}/selectize"", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/{id}/{collectionField:.*}/selectize-add"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/{id}/{collectionField:.*}/add"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/{id}/{collectionField:.*}/addEmpty"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}"", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/{id}/{collectionField:.*}/{collectionItemId}"", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/view"", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/{id}/{collectionField:.*}/{collectionItemId}/view"", method = RequestMethod.GET)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/{id}/{collectionField:.*}/{collectionItemId}"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/{id}/{collectionField:.*}/{collectionItemId}/sequence"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/sequence"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/{id}/{collectionField:.*}/{collectionItemId}/delete"", method = RequestMethod.POST)"
124ccf441b62d03d3f564f9d611fc18e06bd18a7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"@RequestMapping(value = ""/{id}/{collectionField:.*}/{collectionItemId}/{alternateId}/delete"", method = RequestMethod.POST)"
95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,import org.broadleafcommerce.common.admin.condition.ConditionalOnAdmin;
95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,import org.broadleafcommerce.common.admin.condition.ConditionalOnNotAdmin;
95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,import org.broadleafcommerce.common.web.filter.FilterOrdered;
95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;
95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,"@Component(""blCustomerStateFilter"")"
95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,@ConditionalOnNotAdmin
95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,"@ConditionalOnProperty(value = ""use.customer.state.filter"", matchIfMissing = true)"
95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,94c99119c3821c752b657fe9ca850d1b11fb15db,added,0,return FilterOrdered.POST_SECURITY_HIGH + 50;
95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,"@Component(""blCustomerStateFilter"")"
95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,//FilterChainOrder has been dropped from Spring Security 3
95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,//return FilterChainOrder.REMEMBER_ME_FILTER+1;
95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,94c99119c3821c752b657fe9ca850d1b11fb15db,deleted,1,return 1501;
294dea0b01c2c2e2c3672635ab53a3804cd4e72f,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""OIADJUST_OFFER_INDEX"", columnNames={""OFFER_ID""})"
b7b41883ef693dc1046e3fe60dbb74ff4efecbe0,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,added,0,calculatedSubTotal = calculatedSubTotal.add(orderItem.getTotalPrice());
b7b41883ef693dc1046e3fe60dbb74ff4efecbe0,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,deleted,1,if (orderItem.getParentOrderItem() == null) {
b7b41883ef693dc1046e3fe60dbb74ff4efecbe0,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,deleted,1,calculatedSubTotal = calculatedSubTotal.add(orderItem.getTotalPrice());
b7b41883ef693dc1046e3fe60dbb74ff4efecbe0,2c2a1e91af899d84b48d02fe1b7157031c3d5d6c,deleted,1,}
b7b41883ef693dc1046e3fe60dbb74ff4efecbe0,7052c0ab3292e727ef82a25889c137aea193962d,added,0,calculatedSubTotal = calculatedSubTotal.add(orderItem.getTotalPrice());
b7b41883ef693dc1046e3fe60dbb74ff4efecbe0,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,if (orderItem.getParentOrderItem() == null) {
b7b41883ef693dc1046e3fe60dbb74ff4efecbe0,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,calculatedSubTotal = calculatedSubTotal.add(orderItem.getTotalPrice());
b7b41883ef693dc1046e3fe60dbb74ff4efecbe0,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,}
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,import java.util.ArrayList;
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,import javax.persistence.criteria.CriteriaBuilder;
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,import javax.persistence.criteria.CriteriaQuery;
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,import javax.persistence.criteria.Predicate;
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,import javax.persistence.criteria.Root;
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,CriteriaBuilder builder = em.getCriteriaBuilder();
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,CriteriaQuery<Long> criteria = builder.createQuery(Long.class);
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,Root<OfferAuditImpl> root = criteria.from(OfferAuditImpl.class);
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,criteria.select(builder.count(root));
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,List<Predicate> restrictions = new ArrayList<>();
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,restrictions.add(
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,builder.and(
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,builder.or(
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"builder.notEqual(root.get(""orderId""),  orderId),"
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"builder.isNull(root.get(""orderId""))"
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"),"
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"builder.equal(root.get(""customerId""), customerId),"
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"builder.equal(root.get(""offerId""), offerId)"
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,)
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,);
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,criteria.where(restrictions.toArray(new Predicate[restrictions.size()]));
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,try {
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,return em.createQuery(criteria).getSingleResult();
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,} catch (Exception e) {
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"LOG.error(""Error counting offer uses by customer."", e);"
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,return null;
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,}
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"builder.equal(root.get(""offerCodeId""), offerCodeId)"
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"LOG.error(""Error counting offer code uses."", e);"
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,import org.broadleafcommerce.common.util.dao.TQRestriction;
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"TQRestriction isNotAlreadyAppliedToOrder = new TQRestriction(""offerAudit.orderId"", ""<>"", orderId);"
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"TQRestriction orderIdIsNull = new TQRestriction(""offerAudit.orderId"", ""is"", null);"
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,TQRestriction isNotAlreadyAppliedToOrderOrOrderIdIsNull = new TQRestriction(TQRestriction.Mode.OR)
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,.addChildRestriction(isNotAlreadyAppliedToOrder)
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,.addChildRestriction(orderIdIsNull);
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"TypedQuery<Long> query = new TypedQueryBuilder<>(OfferAudit.class, ""offerAudit"")"
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,".addRestriction(""offerAudit.customerId"", ""="", customerId)"
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,".addRestriction(""offerAudit.offerId"", ""="", offerId)"
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,.addRestriction(isNotAlreadyAppliedToOrderOrOrderIdIsNull)
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,.toCountQuery(em);
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,return query.getSingleResult();
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,".addRestriction(""offerAudit.offerCodeId"", ""="", offerCodeId)"
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,import org.broadleafcommerce.common.extension.ExtensionResultHolder;
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,import org.broadleafcommerce.common.extension.ExtensionResultStatusType;
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,import org.broadleafcommerce.core.offer.service.workflow.extension.VerifyCustomerMaxOfferUsesActivityExtensionHandler;
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,import org.broadleafcommerce.core.offer.service.workflow.extension.VerifyCustomerMaxOfferUsesActivityExtensionManager;
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,import java.util.Objects;
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"protected static final String BL_PARENT_ORDER = ""blParentOrder"";"
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"@Resource(name = ""blVerifyCustomerMaxOfferUsesActivityExensionHandler"")"
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,protected VerifyCustomerMaxOfferUsesActivityExtensionManager extensionManager;
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,ExtensionResultHolder<Exception> resultHolder = new ExtensionResultHolder<>();
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,resultHolder.setResult(null);
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,if (extensionManager != null && extensionManager.getProxy() != null) {
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"ExtensionResultStatusType result = extensionManager.getProxy().verify(context.getSeedData(), resultHolder);"
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"if (!Objects.equals(ExtensionResultStatusType.NOT_HANDLED, result)) {"
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,if (resultHolder.getResult() != null) {
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,throw resultHolder.getResult();
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,}
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,return verify(context);
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,protected ProcessContext<CheckoutSeed> verify(ProcessContext<CheckoutSeed> context) throws OfferMaxUseExceededException {
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,Long orderId;
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"// In case this is a CSR order, we need to use the parent's ID to look up the OfferAudit data"
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,// instead of the current order's ID.
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,final Object parentOrder = context.getSeedData().getUserDefinedFields().get(BL_PARENT_ORDER);
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,if (parentOrder != null) {
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,orderId = ((Order) parentOrder).getId();
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,} else {
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,orderId = order.getId();
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"Long currentUses = offerAuditService.countUsesByCustomer(orderId, order.getCustomer().getId(), offer.getId());"
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"+ "" has been than the maximum allowed number of times."");"
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"Long currentUses = offerAuditService.countUsesByCustomer(order.getId(), order.getCustomer().getId(), offer.getId());"
b02df26e0be0a14088e449544253e8b449b5feb2,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"+ "" has been than the maximum allowed number of times."");"
eb8299ebe797b7b330b37a1162ab4477006a1901,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,"@Index(name = ""OFFER_CODE_EMAIL_INDEX"", columnNames = { ""EMAIL_ADDRESS"" })"
eb8299ebe797b7b330b37a1162ab4477006a1901,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,protected List<Order> orders = new ArrayList<>();
eb8299ebe797b7b330b37a1162ab4477006a1901,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDao;
eb8299ebe797b7b330b37a1162ab4477006a1901,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDaoImpl;
eb8299ebe797b7b330b37a1162ab4477006a1901,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,"@Index(name = ""OFFER_EMAIL_INDEX"", columnNames = { ""EMAIL_ADDRESS"" })"
eb8299ebe797b7b330b37a1162ab4477006a1901,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,protected List<Order> orders = new ArrayList<Order>();
73cef4ab91a61805828295307c1c0108eda58a78,23c3254ea1399aabd91b595298bee1f5a3e9029c,added,0,Serializable exp = null;
73cef4ab91a61805828295307c1c0108eda58a78,23c3254ea1399aabd91b595298bee1f5a3e9029c,added,0,if (expressionCache != null) {
73cef4ab91a61805828295307c1c0108eda58a78,23c3254ea1399aabd91b595298bee1f5a3e9029c,added,0,exp = expressionCache.get(rule);
73cef4ab91a61805828295307c1c0108eda58a78,23c3254ea1399aabd91b595298bee1f5a3e9029c,added,0,}
73cef4ab91a61805828295307c1c0108eda58a78,23c3254ea1399aabd91b595298bee1f5a3e9029c,added,0,"String modifiedRule = modifyExpression(rule, ruleParameters, context);"
73cef4ab91a61805828295307c1c0108eda58a78,23c3254ea1399aabd91b595298bee1f5a3e9029c,added,0,"exp = MVEL.compileExpression(modifiedRule, context);"
73cef4ab91a61805828295307c1c0108eda58a78,23c3254ea1399aabd91b595298bee1f5a3e9029c,added,0,if (!TEST_MODE && LOG.isInfoEnabled()) {
73cef4ab91a61805828295307c1c0108eda58a78,23c3254ea1399aabd91b595298bee1f5a3e9029c,deleted,1,Serializable exp = expressionCache.get(rule);
73cef4ab91a61805828295307c1c0108eda58a78,23c3254ea1399aabd91b595298bee1f5a3e9029c,deleted,1,"rule = modifyExpression(rule, ruleParameters, context);"
73cef4ab91a61805828295307c1c0108eda58a78,23c3254ea1399aabd91b595298bee1f5a3e9029c,deleted,1,"exp = MVEL.compileExpression(rule, context);"
73cef4ab91a61805828295307c1c0108eda58a78,23c3254ea1399aabd91b595298bee1f5a3e9029c,deleted,1,if (!TEST_MODE) {
73cef4ab91a61805828295307c1c0108eda58a78,23c3254ea1399aabd91b595298bee1f5a3e9029c,deleted,1,* @param request
46734b62276e806b9e31e7ebb92a78d02d037bd0,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,added,0,if (postLoaderDao != null && offer.getId() != null) {
46734b62276e806b9e31e7ebb92a78d02d037bd0,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDao;
46734b62276e806b9e31e7ebb92a78d02d037bd0,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDaoImpl;
46734b62276e806b9e31e7ebb92a78d02d037bd0,a38312f45c3b7e5e01f4466de5ad684f4699e5dd,deleted,1,if (postLoaderDao != null) {
c78cb2b894f4c517b88687393c81cda5b6a97034,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,String[] response = (String[]) parameters.get(name);
c78cb2b894f4c517b88687393c81cda5b6a97034,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,return response[0];
c78cb2b894f4c517b88687393c81cda5b6a97034,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,return FilterOrdered.POST_SECURITY_LOW + 1000;
c78cb2b894f4c517b88687393c81cda5b6a97034,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,Object temp = parameters.get(name);
c78cb2b894f4c517b88687393c81cda5b6a97034,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,Object[] response = new Object[0];
c78cb2b894f4c517b88687393c81cda5b6a97034,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,if (temp != null) {
c78cb2b894f4c517b88687393c81cda5b6a97034,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"ArrayUtils.addAll(response, temp);"
c78cb2b894f4c517b88687393c81cda5b6a97034,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,}
c78cb2b894f4c517b88687393c81cda5b6a97034,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,return (String) response[0];
c78cb2b894f4c517b88687393c81cda5b6a97034,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,return FilterOrdered.POST_SECURITY_LOW;
c78cb2b894f4c517b88687393c81cda5b6a97034,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,public Class<?> getCeilingImplClassFromEntityManagers(String className) {
c78cb2b894f4c517b88687393c81cda5b6a97034,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,Class<?> beanIdClass = getClassForName(className);
c78cb2b894f4c517b88687393c81cda5b6a97034,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,"throw new RuntimeException(""Unable to retrieve the entity class for the given bean id: "" + className);"
c78cb2b894f4c517b88687393c81cda5b6a97034,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,protected Class<?> getClassForName(String className) {
c78cb2b894f4c517b88687393c81cda5b6a97034,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,return Class.forName(className);
c78cb2b894f4c517b88687393c81cda5b6a97034,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,public Class<?> getCeilingImplClassFromEntityManagers(String beanId) {
c78cb2b894f4c517b88687393c81cda5b6a97034,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,Class<?> beanIdClass = getClassForName(beanId);
c78cb2b894f4c517b88687393c81cda5b6a97034,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,"throw new RuntimeException(""Unable to retrieve the entity class for the given bean id: "" + beanId);"
c78cb2b894f4c517b88687393c81cda5b6a97034,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,protected Class<?> getClassForName(String beanId) {
c78cb2b894f4c517b88687393c81cda5b6a97034,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,return Class.forName(beanId);
defc5d1877700a5ad6f94b30180f92be1d752e20,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,import org.broadleafcommerce.common.util.dao.DynamicDaoHelperImpl;
defc5d1877700a5ad6f94b30180f92be1d752e20,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,synchronized (DynamicDaoHelperImpl.LOCK_OBJECT) {
defc5d1877700a5ad6f94b30180f92be1d752e20,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,synchronized (persistenceManagers) {
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,/*
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,* #%L
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,* BroadleafCommerce Common Libraries
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,* %%
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,* Copyright (C) 2009 - 2016 Broadleaf Commerce
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"* Licensed under the Broadleaf Fair Use License Agreement, Version 1.0"
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"* (the ""Fair Use License"" located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)"
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,* unless the restrictions on use therein are violated and require payment to Broadleaf in which case
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"* the Broadleaf End User License Agreement (EULA), Version 1.1"
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"* (the ""Commercial License"" located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)"
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,* shall apply.
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,*
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"* Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the ""Custom License"")"
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,* between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,* #L%
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,*/
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,package org.broadleafcommerce.common.web.filter;
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import org.springframework.core.Ordered;
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import org.springframework.stereotype.Component;
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import org.springframework.web.filter.OncePerRequestFilter;
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import java.io.IOException;
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import javax.servlet.FilterChain;
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import javax.servlet.ServletException;
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import javax.servlet.http.HttpServletRequest;
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import javax.servlet.http.HttpServletResponse;
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,/**
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,* This filter adds security response headers to help protect against MIME type confusion and Cross-Site-Scripting attacks.
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,* @author Chad Harchar (charchar)
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"@Component(""blSecurityHeaderFilter"")"
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,public class SecurityHeaderFilter extends OncePerRequestFilter implements Ordered {
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,@Override
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"public void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain) throws IOException, ServletException {"
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"response.setHeader(""X-Content-Type-Options"", ""nosniff"");"
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"response.setHeader(""X-XSS-Protection"", ""1; mode=block"");"
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"filterChain.doFilter(request, response);"
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,return;
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,}
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,public int getOrder() {
95312567db2b333ab1b65bf3be6b0380275f5d72,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,return FilterOrdered.PRE_SECURITY_HIGH;
8c56746a962770b6965ee84758eb71cfebc6eb0d,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,List<SearchFacetRange> facetRanges = searchFacetDao.readSearchFacetRangesForSearchFacet(dto.getFacet());
8c56746a962770b6965ee84758eb71cfebc6eb0d,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,List<SearchFacetRange> cloneFacetRanges = new ArrayList<>(facetRanges);
8c56746a962770b6965ee84758eb71cfebc6eb0d,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"searchExtensionManager.getProxy().filterSearchFacetRanges(dto, cloneFacetRanges);"
8c56746a962770b6965ee84758eb71cfebc6eb0d,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (CollectionUtils.isNotEmpty(cloneFacetRanges)) {
8c56746a962770b6965ee84758eb71cfebc6eb0d,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,for (SearchFacetRange range : cloneFacetRanges) {
8c56746a962770b6965ee84758eb71cfebc6eb0d,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,List<SearchFacetRange> facetRanges = new ArrayList<SearchFacetRange>(dto.getFacet().getSearchFacetRanges());
8c56746a962770b6965ee84758eb71cfebc6eb0d,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"searchExtensionManager.getProxy().filterSearchFacetRanges(dto, facetRanges);"
8c56746a962770b6965ee84758eb71cfebc6eb0d,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (CollectionUtils.isNotEmpty(facetRanges)) {
8c56746a962770b6965ee84758eb71cfebc6eb0d,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,for (SearchFacetRange range : facetRanges) {
e84dc468898d82b3eada7d5886581b11aa7bdfc4,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"sb.append(StringUtils.repeat("" "", (tabs+1) * 2)).append(subFacet.toString(tabs + 2)).append("",\n"");"
e84dc468898d82b3eada7d5886581b11aa7bdfc4,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"sb.append(StringUtils.repeat("" "", tabs * 2)).append(""]"").append("",\n"");"
e84dc468898d82b3eada7d5886581b11aa7bdfc4,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"sb.append(StringUtils.repeat("" "", tabs * 2)).append(key).append("" : "").append(((SolrJSONFacet) object).toString(tabs + 1)).append("",\n"");"
e84dc468898d82b3eada7d5886581b11aa7bdfc4,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"sb.append(StringUtils.repeat("" "", tabs * 2)).append(key).append("" : "").append(object.toString()).append("",\n"");"
e84dc468898d82b3eada7d5886581b11aa7bdfc4,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"sb.append(StringUtils.repeat("" "", (tabs+1) * 2)).append(subFacet.toString(tabs + 2)).append("",\n"");;"
e84dc468898d82b3eada7d5886581b11aa7bdfc4,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"sb.append(StringUtils.repeat("" "", tabs * 2)).append(""]"").append("",\n"");;"
e84dc468898d82b3eada7d5886581b11aa7bdfc4,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"sb.append(StringUtils.repeat("" "", tabs * 2)).append(key).append("" : "").append(((SolrJSONFacet) object).toString(tabs + 1)).append("",\n"");;"
e84dc468898d82b3eada7d5886581b11aa7bdfc4,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"sb.append(StringUtils.repeat("" "", tabs * 2)).append(key).append("" : "").append(object.toString()).append("",\n"");;"
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,import org.broadleafcommerce.common.web.filter.AbstractIgnorableOncePerRequestFilter;
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,public class URLHandlerFilter extends AbstractIgnorableOncePerRequestFilter {
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,"protected void doFilterInternalUnlessIgnored(HttpServletRequest request,"
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,public class URLHandlerFilter extends OncePerRequestFilter implements Ordered {
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"protected void doFilterInternal(HttpServletRequest request,"
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,import org.broadleafcommerce.common.web.filter.AbstractIgnorableOncePerRequestFilter;
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,public class JSCompatibilityRequestFilter extends AbstractIgnorableOncePerRequestFilter {
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,"protected void doFilterInternalUnlessIgnored(HttpServletRequest request, HttpServletResponse response, FilterChain"
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,public class JSCompatibilityRequestFilter extends OncePerRequestFilter implements Ordered {
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain"
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,public class BroadleafAdminRequestFilter extends AbstractBroadleafAdminRequestFilter {
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,"public void doFilterInternalUnlessIgnored(final HttpServletRequest request, final HttpServletResponse response, final FilterChain filterChain) throws IOException, ServletException {"
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,public class BroadleafAdminRequestFilter extends AbstractBroadleafAdminRequestFilter implements Ordered {
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"public void doFilterInternal(final HttpServletRequest request, final HttpServletResponse response, final FilterChain filterChain) throws IOException, ServletException {"
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,public class BroadleafAdminTypedEntityRequestFilter extends AbstractBroadleafAdminRequestFilter {
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,"public void doFilterInternalUnlessIgnored(final HttpServletRequest request, final HttpServletResponse response, final FilterChain filterChain) throws IOException, ServletException {"
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,public class BroadleafAdminTypedEntityRequestFilter extends AbstractBroadleafAdminRequestFilter implements Ordered {
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"public void doFilterInternal(final HttpServletRequest request, final HttpServletResponse response, final FilterChain filterChain) throws IOException, ServletException {"
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,import org.broadleafcommerce.common.web.filter.AbstractIgnorableOncePerRequestFilter;
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,public class BroadleafRequestFilter extends AbstractIgnorableOncePerRequestFilter {
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,"protected void doFilterInternalUnlessIgnored(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain) throws IOException, ServletException {"
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,public class BroadleafRequestFilter extends OncePerRequestFilter implements Ordered {
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"public void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain) throws IOException, ServletException {"
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,public class EstablishSessionFilter extends AbstractIgnorableFilter {
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,"public void doFilterUnlessIgnored(ServletRequest request, ServletResponse response, FilterChain filterChain) throws IOException, ServletException {"
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,public class EstablishSessionFilter extends GenericFilterBean implements Ordered {
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"public void doFilter(ServletRequest request, ServletResponse response, FilterChain filterChain) throws IOException, ServletException {"
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,public class StatelessSessionFilter extends AbstractIgnorableFilter {
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,"public void doFilterUnlessIgnored(ServletRequest request, ServletResponse response, FilterChain filterChain) throws IOException, ServletException {"
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,public class StatelessSessionFilter extends GenericFilterBean implements Ordered {
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"public void doFilter(ServletRequest request, ServletResponse response, FilterChain filterChain) throws IOException, ServletException {"
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,public class TranslationFilter extends AbstractIgnorableFilter {
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,"public void doFilterUnlessIgnored(ServletRequest request, ServletResponse response, FilterChain filterChain) throws IOException, ServletException {"
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,public class TranslationFilter extends GenericFilterBean implements Ordered {
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"public void doFilter(ServletRequest request, ServletResponse response, FilterChain filterChain) throws IOException, ServletException {"
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,import org.broadleafcommerce.common.web.filter.AbstractIgnorableOncePerRequestFilter;
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,public class GeolocationFilter extends AbstractIgnorableOncePerRequestFilter {
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,"protected void doFilterInternalUnlessIgnored(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, FilterChain filterChain) throws ServletException, IOException {"
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,public class GeolocationFilter extends OncePerRequestFilter implements Ordered {
e89af052848f43e467034b7a3822c80a0bf3736f,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"protected void doFilterInternal(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, FilterChain filterChain) throws ServletException, IOException {"
d12ad628e177aef3846f64ce3b405467aef910e3,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.springframework.test.annotation.Commit;
d12ad628e177aef3846f64ce3b405467aef910e3,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.testng.annotations.BeforeMethod;
d12ad628e177aef3846f64ce3b405467aef910e3,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import java.lang.reflect.Method;
d12ad628e177aef3846f64ce3b405467aef910e3,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,private Long userId = null;
d12ad628e177aef3846f64ce3b405467aef910e3,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"@BeforeMethod(alwaysRun = true, dependsOnMethods = ""springTestContextBeforeTestMethod"")"
d12ad628e177aef3846f64ce3b405467aef910e3,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,protected void setupCustomerId(Method testMethod) throws Exception {
d12ad628e177aef3846f64ce3b405467aef910e3,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"userId = customerService.readCustomerByUsername(""customer1"").getId();"
d12ad628e177aef3846f64ce3b405467aef910e3,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,}
d12ad628e177aef3846f64ce3b405467aef910e3,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,@Commit
d12ad628e177aef3846f64ce3b405467aef910e3,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"Customer customer = customerService.readCustomerByUsername(""customer1"");"
d12ad628e177aef3846f64ce3b405467aef910e3,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,List<CustomerPhone> phones = customerPhoneService.readAllCustomerPhonesByCustomerId(userId);
d12ad628e177aef3846f64ce3b405467aef910e3,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,List<CustomerPhone> phones_1 = customerPhoneService.readAllCustomerPhonesByCustomerId(userId);
d12ad628e177aef3846f64ce3b405467aef910e3,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,List<CustomerPhone> phones_2 = customerPhoneService.readAllCustomerPhonesByCustomerId(userId);
d12ad628e177aef3846f64ce3b405467aef910e3,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import org.springframework.test.annotation.Rollback;
d12ad628e177aef3846f64ce3b405467aef910e3,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,private final Long userId = 1L;
d12ad628e177aef3846f64ce3b405467aef910e3,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,@Rollback(false)
d12ad628e177aef3846f64ce3b405467aef910e3,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,Customer customer = customerService.readCustomerById(userId);
d12ad628e177aef3846f64ce3b405467aef910e3,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,List<CustomerPhone> phones = customerPhoneService.readAllCustomerPhonesByCustomerId(1L);
d12ad628e177aef3846f64ce3b405467aef910e3,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,List<CustomerPhone> phones_1 = customerPhoneService.readAllCustomerPhonesByCustomerId(1L);
d12ad628e177aef3846f64ce3b405467aef910e3,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,List<CustomerPhone> phones_2 = customerPhoneService.readAllCustomerPhonesByCustomerId(1L);
d12ad628e177aef3846f64ce3b405467aef910e3,1b397c5267574a2aa47352245db66860acb1f75e,added,0,import org.springframework.test.annotation.Commit;
d12ad628e177aef3846f64ce3b405467aef910e3,1b397c5267574a2aa47352245db66860acb1f75e,added,0,import org.testng.annotations.BeforeMethod;
d12ad628e177aef3846f64ce3b405467aef910e3,1b397c5267574a2aa47352245db66860acb1f75e,added,0,import java.lang.reflect.Method;
d12ad628e177aef3846f64ce3b405467aef910e3,1b397c5267574a2aa47352245db66860acb1f75e,added,0,private Long userId = null;
d12ad628e177aef3846f64ce3b405467aef910e3,1b397c5267574a2aa47352245db66860acb1f75e,added,0,"@BeforeMethod(alwaysRun = true, dependsOnMethods = ""springTestContextBeforeTestMethod"")"
d12ad628e177aef3846f64ce3b405467aef910e3,1b397c5267574a2aa47352245db66860acb1f75e,added,0,protected void setupCustomerId(Method testMethod) throws Exception {
d12ad628e177aef3846f64ce3b405467aef910e3,1b397c5267574a2aa47352245db66860acb1f75e,added,0,"userId = customerService.readCustomerByUsername(""customer1"").getId();"
d12ad628e177aef3846f64ce3b405467aef910e3,1b397c5267574a2aa47352245db66860acb1f75e,added,0,}
d12ad628e177aef3846f64ce3b405467aef910e3,1b397c5267574a2aa47352245db66860acb1f75e,added,0,@Commit
d12ad628e177aef3846f64ce3b405467aef910e3,1b397c5267574a2aa47352245db66860acb1f75e,added,0,"Customer customer = customerService.readCustomerByUsername(""customer1"");"
d12ad628e177aef3846f64ce3b405467aef910e3,1b397c5267574a2aa47352245db66860acb1f75e,added,0,List<CustomerPhone> phones = customerPhoneService.readAllCustomerPhonesByCustomerId(userId);
d12ad628e177aef3846f64ce3b405467aef910e3,1b397c5267574a2aa47352245db66860acb1f75e,added,0,List<CustomerPhone> phones_1 = customerPhoneService.readAllCustomerPhonesByCustomerId(userId);
d12ad628e177aef3846f64ce3b405467aef910e3,1b397c5267574a2aa47352245db66860acb1f75e,added,0,List<CustomerPhone> phones_2 = customerPhoneService.readAllCustomerPhonesByCustomerId(userId);
d12ad628e177aef3846f64ce3b405467aef910e3,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.springframework.test.annotation.Rollback;
d12ad628e177aef3846f64ce3b405467aef910e3,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,private final Long userId = 1L;
d12ad628e177aef3846f64ce3b405467aef910e3,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,@Rollback(false)
d12ad628e177aef3846f64ce3b405467aef910e3,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,Customer customer = customerService.readCustomerById(userId);
d12ad628e177aef3846f64ce3b405467aef910e3,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,List<CustomerPhone> phones = customerPhoneService.readAllCustomerPhonesByCustomerId(1L);
d12ad628e177aef3846f64ce3b405467aef910e3,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,List<CustomerPhone> phones_1 = customerPhoneService.readAllCustomerPhonesByCustomerId(1L);
d12ad628e177aef3846f64ce3b405467aef910e3,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,List<CustomerPhone> phones_2 = customerPhoneService.readAllCustomerPhonesByCustomerId(1L);
69a95039bfda3e5cfe7af63a18bfb46d655bcadc,e87d3295e508764724cbeb5aaed4f4790a036a47,added,0,import org.springframework.core.annotation.AnnotationUtils;
69a95039bfda3e5cfe7af63a18bfb46d655bcadc,e87d3295e508764724cbeb5aaed4f4790a036a47,added,0,protected List<FieldMetadataProvider> fieldMetadataProviders = new ArrayList<>();
69a95039bfda3e5cfe7af63a18bfb46d655bcadc,e87d3295e508764724cbeb5aaed4f4790a036a47,added,0,"Map<String, FieldMetadata> metadata = new HashMap<>();"
69a95039bfda3e5cfe7af63a18bfb46d655bcadc,e87d3295e508764724cbeb5aaed4f4790a036a47,added,0,"AdminPresentationClass adminPresentationClass = AnnotationUtils.findAnnotation(entities[i], AdminPresentationClass.class);"
69a95039bfda3e5cfe7af63a18bfb46d655bcadc,e87d3295e508764724cbeb5aaed4f4790a036a47,deleted,1,import org.broadleafcommerce.common.util.BLCAnnotationUtils;
69a95039bfda3e5cfe7af63a18bfb46d655bcadc,e87d3295e508764724cbeb5aaed4f4790a036a47,deleted,1,protected List<FieldMetadataProvider> fieldMetadataProviders = new ArrayList<FieldMetadataProvider>();
69a95039bfda3e5cfe7af63a18bfb46d655bcadc,e87d3295e508764724cbeb5aaed4f4790a036a47,deleted,1,"Map<String, FieldMetadata> metadata = new HashMap<String, FieldMetadata>();"
69a95039bfda3e5cfe7af63a18bfb46d655bcadc,e87d3295e508764724cbeb5aaed4f4790a036a47,deleted,1,"AdminPresentationClass adminPresentationClass = BLCAnnotationUtils.getAnnotationFromClassOrInterface(AdminPresentationClass.class, entities[i]);"
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,import org.broadleafcommerce.common.admin.condition.ConditionalOnNotAdmin;
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,import org.broadleafcommerce.common.module.BroadleafModuleRegistration.BroadleafModuleEnum;
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,import org.broadleafcommerce.common.module.ModulePresentUtil;
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,import org.broadleafcommerce.common.util.BLCRequestUtils;
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,@ConditionalOnNotAdmin
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,"LOG.trace(String.format(""%s not processing URL %s"", getClass().getName(), request.getRequestURI()));"
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,"return shouldProcessURL(request, requestURI, false);"
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,}
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,"protected boolean shouldProcessURL(HttpServletRequest request, String requestURI, boolean ignoreSessionCheck) {"
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,} else if (!ignoreSessionCheck && BLCRequestUtils.isOKtoUseSession(new ServletWebRequest(request))
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,&& ModulePresentUtil.isPresent(BroadleafModuleEnum.ENTERPRISE)) {
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,//if session usage is enabled and enterprise is in play - disable to allow the enterprise request filters
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,//if session usage is disallowed - allow this filter regardless of enterprise (i.e. rest api)
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,return false;
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,ignoreSuffixes = new HashSet<>(Arrays.asList(ignoreSuffixList));
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import org.springframework.core.Ordered;
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import org.springframework.web.filter.OncePerRequestFilter;
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"@ConditionalOnProperty(value = ""use.basic.request"", matchIfMissing = true)"
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"LOG.trace(""Process URL not processing URL "" + request.getRequestURI());"
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,if (LOG.isTraceEnabled()) {
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"LOG.trace(""BroadleafProcessURLFilter ignoring admin request URI "" + requestURI);"
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,}
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,} else {
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"int pos = requestURI.lastIndexOf(""."");"
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,if (pos > 0) {
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,//                String suffix = requestURI.substring(pos);
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,//                if (getIgnoreSuffixes().contains(suffix.toLowerCase())) {
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,//                    if (LOG.isTraceEnabled()) {
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"//                        LOG.trace(""BroadleafProcessURLFilter ignoring request due to suffix "" + requestURI);"
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,//                    }
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,//                    return false;
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,//                }
760a25d5afbd033f3a29a903ad266313c8d6bbd2,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,ignoreSuffixes = new HashSet<String>(Arrays.asList(ignoreSuffixList));
7f23447ad51da8752cc18a184a86344f82b6534c,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"""org.apache.commons.lang3.StringUtils.startsWith"","
7f23447ad51da8752cc18a184a86344f82b6534c,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"""org.apache.commons.lang3.StringUtils.endsWith"","
7f23447ad51da8752cc18a184a86344f82b6534c,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"""org.apache.commons.lang3.StringUtils.contains"""
7f23447ad51da8752cc18a184a86344f82b6534c,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"temp[0] = components[0].substring(key.length() + 1, components[0].indexOf("",""));"
7f23447ad51da8752cc18a184a86344f82b6534c,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"temp[1] = key.substring(37, key.length());"
7f23447ad51da8752cc18a184a86344f82b6534c,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"temp[2] = components[0].substring(components[0].indexOf("","") + 1, components[0].lastIndexOf("")""));"
7f23447ad51da8752cc18a184a86344f82b6534c,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,""".startsWith"","
7f23447ad51da8752cc18a184a86344f82b6534c,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,""".endsWith"","
7f23447ad51da8752cc18a184a86344f82b6534c,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,""".contains"""
7f23447ad51da8752cc18a184a86344f82b6534c,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,int startsWithIndex = components[0].indexOf(key);
7f23447ad51da8752cc18a184a86344f82b6534c,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"temp[0] = components[0].substring(0, startsWithIndex);"
7f23447ad51da8752cc18a184a86344f82b6534c,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"temp[1] = key.substring(1, key.length());"
7f23447ad51da8752cc18a184a86344f82b6534c,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"temp[2] = components[0].substring(startsWithIndex + key.length() + 1, components[0].lastIndexOf("")""));"
c720179349428562f75a3499fd4280f37194111b,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,List<OfferCode> offerCodes = getNewOfferCodesFromCustomer(order);
c720179349428562f75a3499fd4280f37194111b,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,protected List<OfferCode> getNewOfferCodesFromCustomer(Order order) {
c720179349428562f75a3499fd4280f37194111b,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,List<OfferCode> offerCodesFromCustomer = offerService.buildOfferCodeListForCustomer(order);
c720179349428562f75a3499fd4280f37194111b,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,List<OfferCode> offerCodesFromOrder = order.getAddedOfferCodes();
c720179349428562f75a3499fd4280f37194111b,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,offerCodesFromCustomer.removeAll(offerCodesFromOrder);
c720179349428562f75a3499fd4280f37194111b,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,return offerCodesFromCustomer;
c720179349428562f75a3499fd4280f37194111b,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,}
c720179349428562f75a3499fd4280f37194111b,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,List<OfferCode> offerCodes = offerService.buildOfferCodeListForCustomer(order);
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import org.broadleafcommerce.common.admin.domain.AdminMainEntity;
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import org.hibernate.annotations.BatchSize;
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import org.hibernate.annotations.CacheConcurrencyStrategy;
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import org.hibernate.annotations.GenericGenerator;
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import javax.persistence.CascadeType;
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import javax.persistence.Column;
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import javax.persistence.Entity;
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import javax.persistence.GeneratedValue;
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import javax.persistence.Id;
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import javax.persistence.Inheritance;
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import javax.persistence.InheritanceType;
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import javax.persistence.JoinColumn;
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import javax.persistence.ManyToOne;
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import javax.persistence.OneToMany;
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import javax.persistence.Table;
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"public class IndexFieldImpl implements IndexField, Serializable, IndexFieldAdminPresentation, AdminMainEntity {"
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,added,0,@Override
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,added,0,public String getMainEntityName() {
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,added,0,return getField().getFriendlyName();
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,added,0,}
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import org.hibernate.annotations.*;
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import javax.persistence.CascadeType;
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import javax.persistence.*;
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import javax.persistence.Entity;
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import javax.persistence.Table;
4dc9eab29d35c28b0e6772236f8819c8474a9a60,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"public class IndexFieldImpl implements IndexField, Serializable, IndexFieldAdminPresentation {"
3dd5ec98179767fc3202f6738e8db330b857e082,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,import org.broadleafcommerce.common.condition.ConditionalOnMissingBroadleafModule;
3dd5ec98179767fc3202f6738e8db330b857e082,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,import org.broadleafcommerce.common.module.BroadleafModuleRegistration.BroadleafModuleEnum;
3dd5ec98179767fc3202f6738e8db330b857e082,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,@ConditionalOnMissingBroadleafModule(BroadleafModuleEnum.ADMIN)
3dd5ec98179767fc3202f6738e8db330b857e082,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import org.springframework.boot.autoconfigure.condition.ConditionalOnBean;
3dd5ec98179767fc3202f6738e8db330b857e082,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;
3dd5ec98179767fc3202f6738e8db330b857e082,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"@ConditionalOnMissingBean(name = ""blBasicPersistenceModule"")"
39b124d9005ec8c70dde527c7521506a2397d2e1,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,String unprocessedTabName = ef.addTabFromTabMetadata(tabMetadata);
39b124d9005ec8c70dde527c7521506a2397d2e1,2489d3609b635cdab1b6ce0d55c1b891a612f054,added,0,"ef.addGroupFromGroupMetadata(tabMetadata.getGroupMetadata().get(groupKey), unprocessedTabName);"
39b124d9005ec8c70dde527c7521506a2397d2e1,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.FieldGroup;
39b124d9005ec8c70dde527c7521506a2397d2e1,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,import org.broadleafcommerce.openadmin.web.form.entity.Tab;
39b124d9005ec8c70dde527c7521506a2397d2e1,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,String unprocessedTabName = tabMetadata.getTabName();
39b124d9005ec8c70dde527c7521506a2397d2e1,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,Tab currentTab = ef.findTab(unprocessedTabName);
39b124d9005ec8c70dde527c7521506a2397d2e1,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,if (currentTab != null) {
39b124d9005ec8c70dde527c7521506a2397d2e1,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,unprocessedTabName = currentTab.getTitle();
39b124d9005ec8c70dde527c7521506a2397d2e1,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,} else {
39b124d9005ec8c70dde527c7521506a2397d2e1,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,unprocessedTabName = ef.addTabFromTabMetadata(tabMetadata);
39b124d9005ec8c70dde527c7521506a2397d2e1,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,currentTab = ef.findTab(unprocessedTabName);
39b124d9005ec8c70dde527c7521506a2397d2e1,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,}
39b124d9005ec8c70dde527c7521506a2397d2e1,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,String translatedGroupName = BLCMessageUtils.getMessage(groupKey);
39b124d9005ec8c70dde527c7521506a2397d2e1,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,FieldGroup fieldGroup = currentTab.findGroupByTitle(translatedGroupName);
39b124d9005ec8c70dde527c7521506a2397d2e1,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,if (fieldGroup == null) {
39b124d9005ec8c70dde527c7521506a2397d2e1,2489d3609b635cdab1b6ce0d55c1b891a612f054,deleted,1,"ef.addGroupFromGroupMetadata(tabMetadata.getGroupMetadata().get(groupKey), unprocessedTabName);"
ace55a7ad8483cdc2af8413c37701f6004207d22,f5d2f01dbf8876f90a9732ad8e7fac8fbd0638cf,added,0,if (price != null && !price.getAmount().equals(BigDecimal.ZERO)) {
ace55a7ad8483cdc2af8413c37701f6004207d22,f5d2f01dbf8876f90a9732ad8e7fac8fbd0638cf,deleted,1,if (price != null && price.getAmount().equals(BigDecimal.ZERO)) {
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,import org.apache.commons.collections.CollectionUtils;
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"return getIndexFieldTypesByAbbreviationAndEntityType(abbreviation, null);"
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,}
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,@Override
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"public List<IndexFieldType> getIndexFieldTypesByAbbreviationAndEntityType(String abbreviation, FieldEntity entityType) {"
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,if (entityType == null) {
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,criteria.where(
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,);
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,} else {
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,builder.and(
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"builder.equal(root.get(""indexField"").get(""field"").get(""abbreviation"").as(String.class), abbreviation),"
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"builder.equal(root.get(""indexField"").get(""field"").get(""entityType"").as(String.class), entityType.getType())"
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,)
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"return readIndexFieldByAbbreviationAndEntityType(abbreviation, null);"
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"public IndexField readIndexFieldByAbbreviationAndEntityType(String abbreviation, FieldEntity entityType) {"
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"builder.equal(root.get(""field"").get(""abbreviation"").as(String.class), abbreviation),"
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"builder.equal(root.get(""field"").get(""entityType"").as(String.class), entityType.getType())"
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,List<IndexField> resultList = query.getResultList();
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,return CollectionUtils.isNotEmpty(resultList) ? resultList.get(0) : null;
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,criteria.where(
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,);
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,try {
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,return query.getSingleResult();
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,} catch (NoResultException ex) {
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,return null;
b037a0771995b7aa0d23bbffca213f9adb233a08,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,}
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,* @param order
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"Long countUsesByCustomer(Order order, Long customerId, Long offerId);"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"* @deprecated use {@link #countUsesByCustomer(Order, Long, Long)}"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"Long countOfferCodeUses(Order order, Long offerCodeId);"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"* @deprecated use {@link #countOfferCodeUses(Order, Long)}"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,* @param orderId
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"Long countUsesByCustomer(Long orderId, Long customerId, Long offerId);"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"* @deprecated use {@link #countUsesByCustomer(Long, Long, Long)}"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"Long countOfferCodeUses(Long orderId, Long offerCodeId);"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"* @deprecated use {@link #countOfferCodeUses(Long, Long)}"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,import org.broadleafcommerce.core.order.domain.Order;
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"public Long countUsesByCustomer(Order order, Long customerId, Long offerId) {"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"builder.notEqual(root.get(""orderId""),  getOrderId(order)),"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,protected Long getOrderId(Order order) {
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,return order.getId();
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,}
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"public Long countOfferCodeUses(Order order, Long offerCodeId) {"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"public Long countUsesByCustomer(Long orderId, Long customerId, Long offerId) {"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"builder.notEqual(root.get(""orderId""),  orderId),"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"public Long countOfferCodeUses(Long orderId, Long offerCodeId) {"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,import org.broadleafcommerce.core.order.domain.Order;
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,* @param order
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"Long countUsesByCustomer(Order order, Long customerId, Long offerId);"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"* @deprecated use {@link #countUsesByCustomer(Order, Long, Long)}"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"Long countOfferCodeUses(Order order, Long offerCodeId);"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"* @deprecated use {@link #countOfferCodeUses(Order, Long)}"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,* @param orderId
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"Long countUsesByCustomer(Long orderId, Long customerId, Long offerId);"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"* @deprecated use {@link #countUsesByCustomer(Long, Long, Long)}"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"Long countOfferCodeUses(Long orderId, Long offerCodeId);"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"* @deprecated use {@link #countOfferCodeUses(Long, Long)}"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,import org.broadleafcommerce.core.order.domain.Order;
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"public Long countUsesByCustomer(Order order, Long customerId, Long offerId) {"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"return offerAuditDao.countUsesByCustomer(order, customerId, offerId);"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"public Long countOfferCodeUses(Order order, Long offerCodeId) {"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"return offerAuditDao.countOfferCodeUses(order, offerCodeId);"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"public Long countUsesByCustomer(Long orderId, Long customerId, Long offerId) {"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"return offerAuditDao.countUsesByCustomer(orderId, customerId, offerId);"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"public Long countOfferCodeUses(Long orderId, Long offerCodeId) {"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"return offerAuditDao.countOfferCodeUses(orderId, offerCodeId);"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"Long currentUses = offerAuditService.countUsesByCustomer(order, customer.getId(), offer.getId());"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"Long currentCodeUses = offerAuditService.countOfferCodeUses(order, code.getId());"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"Long currentUses = offerAuditService.countUsesByCustomer(order.getId(), customer.getId(), offer.getId());"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"Long currentCodeUses = offerAuditService.countOfferCodeUses(order.getId(), code.getId());"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"Long currentUses = offerAuditService.countUsesByCustomer(order, order.getCustomer().getId(), offer.getId());"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"Long currentCodeUses = offerAuditService.countOfferCodeUses(order, code.getId());"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"+ "" has been than the maximum allowed number of times."");"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,import org.broadleafcommerce.common.extension.ExtensionResultHolder;
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,import org.broadleafcommerce.common.extension.ExtensionResultStatusType;
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,import org.broadleafcommerce.core.offer.service.workflow.extension.VerifyCustomerMaxOfferUsesActivityExtensionHandler;
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,import org.broadleafcommerce.core.offer.service.workflow.extension.VerifyCustomerMaxOfferUsesActivityExtensionManager;
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,import java.util.Objects;
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"protected static final String BL_PARENT_ORDER = ""blParentOrder"";"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"@Resource(name = ""blVerifyCustomerMaxOfferUsesActivityExensionHandler"")"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,protected VerifyCustomerMaxOfferUsesActivityExtensionManager extensionManager;
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,ExtensionResultHolder<Exception> resultHolder = new ExtensionResultHolder<>();
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,resultHolder.setResult(null);
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,if (extensionManager != null && extensionManager.getProxy() != null) {
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"ExtensionResultStatusType result = extensionManager.getProxy().verify(context.getSeedData(), resultHolder);"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"if (!Objects.equals(ExtensionResultStatusType.NOT_HANDLED, result)) {"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,if (resultHolder.getResult() != null) {
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,throw resultHolder.getResult();
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,}
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,return verify(context);
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,protected ProcessContext<CheckoutSeed> verify(ProcessContext<CheckoutSeed> context) throws OfferMaxUseExceededException {
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,Long orderId;
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"// In case this is a CSR order, we need to use the parent's ID to look up the OfferAudit data"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,// instead of the current order's ID.
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,final Object parentOrder = context.getSeedData().getUserDefinedFields().get(BL_PARENT_ORDER);
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,if (parentOrder != null) {
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,orderId = ((Order) parentOrder).getId();
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,} else {
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,orderId = order.getId();
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"Long currentUses = offerAuditService.countUsesByCustomer(orderId, order.getCustomer().getId(), offer.getId());"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"Long currentCodeUses = offerAuditService.countOfferCodeUses(order.getId(), code.getId());"
eab0ade1b4b95f4138ad1db5c852c766153a357a,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"+ "" has been than the maximum allowed number of times."");"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,import org.springframework.beans.factory.annotation.Autowired;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,import org.springframework.beans.factory.annotation.Qualifier;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,@Autowired
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,"@Qualifier(""blURLHandlerService"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,"@Qualifier(""blURLHandlerFilterExtensionManager"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import org.springframework.core.Ordered;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import org.springframework.web.filter.OncePerRequestFilter;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import javax.annotation.Resource;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"@Resource(name = ""blURLHandlerService"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"@Resource(name = ""blURLHandlerFilterExtensionManager"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,import org.broadleafcommerce.common.persistence.TargetModeType;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,import org.springframework.beans.factory.annotation.Autowired;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,import org.springframework.beans.factory.annotation.Qualifier;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,import java.util.LinkedHashMap;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,@Autowired
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,"@Qualifier(""blAdminRequestProcessor"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,"@Qualifier(""blPersistenceThreadManager"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,"@Qualifier(""blClassNameRequestParamValidationService"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,"@Qualifier(""blStaleStateProtectionService"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import org.broadleafcommerce.common.persistence.TargetModeType;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import org.springframework.core.Ordered;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import java.util.LinkedHashMap;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import javax.annotation.Resource;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"@Resource(name = ""blAdminRequestProcessor"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"@Resource(name=""blPersistenceThreadManager"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"@Resource(name=""blClassNameRequestParamValidationService"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"@Resource(name=""blStaleStateProtectionService"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,import org.springframework.beans.factory.annotation.Autowired;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,import org.springframework.beans.factory.annotation.Qualifier;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,@Autowired
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,"@Qualifier(""blAdminRequestProcessor"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,"@Qualifier(""blAdminNavigationService"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,"@Qualifier(""blAdminSecurityRemoteService"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,"@Qualifier(""blGenericEntityService"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import org.broadleafcommerce.common.dao.GenericEntityDao;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import org.springframework.core.Ordered;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import javax.annotation.Resource;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"@Resource(name = ""blAdminRequestProcessor"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"@Resource(name=""blAdminNavigationService"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"@Resource(name = ""blAdminSecurityRemoteService"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"@Resource(name = ""blGenericEntityService"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.springframework.beans.factory.annotation.Autowired;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.springframework.beans.factory.annotation.Qualifier;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,@Autowired
fa4a4525895fcf09074c652dfbcdae0cf32c9401,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"@Qualifier(""blRequestProcessor"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,import javax.annotation.Resource;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"@Resource(name = ""blRequestProcessor"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,import org.springframework.beans.factory.annotation.Autowired;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,import org.springframework.beans.factory.annotation.Qualifier;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,import java.io.IOException;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,@Autowired
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,"@Qualifier(""blTranslationRequestProcessor"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import org.springframework.core.Ordered;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import org.springframework.web.filter.GenericFilterBean;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import javax.annotation.Resource;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import java.io.IOException;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"@Resource(name = ""blTranslationRequestProcessor"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,import org.springframework.beans.factory.annotation.Autowired;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,import org.springframework.beans.factory.annotation.Qualifier;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,@Autowired
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,added,0,"@Qualifier(""blGeolocationRequestProcessor"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import org.springframework.core.Ordered;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import org.springframework.web.filter.OncePerRequestFilter;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,import javax.annotation.Resource;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,95c8dc1d935a9b1254f4472ed66b0a57f4cd5cce,deleted,1,"@Resource(name=""blGeolocationRequestProcessor"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,2406723e3f4313cf959ce2aff0578693004c1112,added,0,import org.springframework.beans.factory.annotation.Autowired;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,2406723e3f4313cf959ce2aff0578693004c1112,added,0,import org.springframework.beans.factory.annotation.Qualifier;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,2406723e3f4313cf959ce2aff0578693004c1112,added,0,@Autowired
fa4a4525895fcf09074c652dfbcdae0cf32c9401,2406723e3f4313cf959ce2aff0578693004c1112,added,0,"@Qualifier(""blCartStateRequestProcessor"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,2406723e3f4313cf959ce2aff0578693004c1112,added,0,"@Qualifier(""blOrderLockManager"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,2406723e3f4313cf959ce2aff0578693004c1112,added,0,"@Qualifier(""blOrderService"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,import javax.annotation.Resource;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,"@Resource(name = ""blCartStateRequestProcessor"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,"@Resource(name = ""blOrderLockManager"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,2406723e3f4313cf959ce2aff0578693004c1112,deleted,1,"@Resource(name = ""blOrderService"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.springframework.beans.factory.annotation.Autowired;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,import org.springframework.beans.factory.annotation.Qualifier;
fa4a4525895fcf09074c652dfbcdae0cf32c9401,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,@Autowired
fa4a4525895fcf09074c652dfbcdae0cf32c9401,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"@Qualifier(""blCustomerStateRequestProcessor"")"
fa4a4525895fcf09074c652dfbcdae0cf32c9401,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"@Resource(name=""blCustomerStateRequestProcessor"")"
cd4dba4517e56b14042e5ed1567e933ca3904efd,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,import org.springframework.stereotype.Component;
cd4dba4517e56b14042e5ed1567e933ca3904efd,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"@Component(""blFulfillmentItemPricingActivity"")"
cd4dba4517e56b14042e5ed1567e933ca3904efd,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public static final int ORDER = 3000;
cd4dba4517e56b14042e5ed1567e933ca3904efd,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,public FulfillmentItemPricingActivity() {
cd4dba4517e56b14042e5ed1567e933ca3904efd,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,setOrder(ORDER);
cd4dba4517e56b14042e5ed1567e933ca3904efd,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,}
cd4dba4517e56b14042e5ed1567e933ca3904efd,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,"Map<OrderItem,List<FulfillmentGroupItem>> partialOrderItemMap = new HashMap<>();"
cd4dba4517e56b14042e5ed1567e933ca3904efd,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,added,0,fgItemList = new ArrayList<>();
cd4dba4517e56b14042e5ed1567e933ca3904efd,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,"Map<OrderItem,List<FulfillmentGroupItem>> partialOrderItemMap = new HashMap<OrderItem,List<FulfillmentGroupItem>>();"
cd4dba4517e56b14042e5ed1567e933ca3904efd,a1a9256debcee8caf6565a2ae4cc73cc6ab13409,deleted,1,fgItemList = new ArrayList<FulfillmentGroupItem>();
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String CONTAINS_OPERATOR = ""org.apache.commons.lang3.StringUtils.contains()"";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String STARTS_WITH_OPERATOR = ""org.apache.commons.lang3.StringUtils.startsWith()"";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String ENDS_WITH_OPERATOR = ""org.apache.commons.lang3.StringUtils.endsWith()"";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String EQUALS_OPERATOR = ""=="";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String NOT_EQUALS_OPERATOR = ""!="";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String GREATER_THAN_EQUALS_OPERATOR = "">="";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String LESS_THAN_EQUALS_OPERATOR = ""<="";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String GREATER_THAN_OPERATOR = "">"";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String LESS_THAN_OPERATOR = ""<"";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String LENGTH_GREATER_THAN_EQUALS_OPERATOR = ""org.apache.commons.lang3.StringUtils.length()>="";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String LENGTH_LESS_THAN_EQUALS_OPERATOR = ""org.apache.commons.lang3.StringUtils.length()<="";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String LENGTH_GREATER_THAN_OPERATOR = ""org.apache.commons.lang3.StringUtils.length()>"";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String LENGTH_LESS_THAN_OPERATOR = ""org.apache.commons.lang3.StringUtils.length()<"";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String LENGTH_EQUALS_OPERATOR = ""org.apache.commons.lang3.StringUtils.length()=="";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String COLLECTION_OPERATOR = ""CollectionUtils.intersection"";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String ZERO_OPERATOR = ""0"";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String OLD_CONTAINS_OPERATOR = "".contains"";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String OLD_STARTS_WITH_OPERATOR = "".startsWith"";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String OLD_ENDS_WITH_OPERATOR = "".endsWith"";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String OLD_SIZE_GREATER_THAN_OPERATOR = "".size()>"";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String OLD_SIZE_GREATER_THAN_EQUAL_OPERATOR = "".size()>="";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String OLD_SIZE_LESS_THAN_OPERATOR = "".size()<"";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String OLD_SIZE_LESS_THAN_EQUAL_OPERATOR = "".size()<="";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public static final String OLD_SIZE_EQUAL_OPERATOR = "".size()=="";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, value, type, secondaryType, CONTAINS_OPERATOR,"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, value, type, secondaryType, ENDS_WITH_OPERATOR,"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, value, type, secondaryType, EQUALS_OPERATOR, false, false, false, false, false);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, value, type, secondaryType, EQUALS_OPERATOR, false, true, false, false, false);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, value, type, secondaryType, GREATER_THAN_EQUALS_OPERATOR, false, false, false, false, false);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, value, type, secondaryType, GREATER_THAN_EQUALS_OPERATOR, false, true, false, false, false);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, value, type, secondaryType, GREATER_THAN_OPERATOR, false, false, false, false, false);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, value, type, secondaryType, GREATER_THAN_OPERATOR, false, true, false, false, false);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, value, type, secondaryType, EQUALS_OPERATOR, false, false, true, false, false);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, value, type, secondaryType, NOT_EQUALS_OPERATOR, false, false, true, false, false);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, value, type, secondaryType, STARTS_WITH_OPERATOR,"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, new Object[]{""null""}, type, secondaryType, EQUALS_OPERATOR,"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, value, type, secondaryType, LESS_THAN_EQUALS_OPERATOR, false, false, false, false, false);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, value, type, secondaryType, LESS_THAN_EQUALS_OPERATOR, false, true, false, false, false);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, value, type, secondaryType, LESS_THAN_OPERATOR, false, false, false, false, false);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, value, type, secondaryType, LESS_THAN_OPERATOR,"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, value, type, secondaryType, NOT_EQUALS_OPERATOR, false, false, false, false, false);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, value, type, secondaryType, NOT_EQUALS_OPERATOR,"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, new Object[]{""null""}, type, secondaryType, NOT_EQUALS_OPERATOR,"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, value, type, secondaryType, LENGTH_GREATER_THAN_OPERATOR, false, false, false, false, true);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, value, type, secondaryType, LENGTH_GREATER_THAN_EQUALS_OPERATOR, false, false, false, false, true);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, value, type, secondaryType, LENGTH_LESS_THAN_OPERATOR, false, false, false, false, true);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, value, type, secondaryType, LENGTH_LESS_THAN_EQUALS_OPERATOR, false, false, false, false, true);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, value, type, secondaryType, LENGTH_EQUALS_OPERATOR, false, false, false, false, true);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildCollectionExpression(sb, entityKey, field, value, type, secondaryType, LENGTH_GREATER_THAN_OPERATOR + ZERO_OPERATOR, false, false, false, false, true);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildCollectionExpression(sb, entityKey, field, value, type, secondaryType, LENGTH_EQUALS_OPERATOR + ZERO_OPERATOR, false, false, false, false, true);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, new Object[]{value[0]}, type, secondaryType, GREATER_THAN_OPERATOR,"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, new Object[]{value[1]}, type, secondaryType, LESS_THAN_OPERATOR,"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, new Object[]{value[0]}, type, secondaryType, GREATER_THAN_EQUALS_OPERATOR,"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"buildExpression(sb, entityKey, field, new Object[]{value[1]}, type, secondaryType, LESS_THAN_EQUALS_OPERATOR,"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(operator.substring(0, operator.indexOf("")"")));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,sb.append(COLLECTION_OPERATOR);
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(""("");"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(operator.substring(operator.indexOf("")"")));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (operator.equals(EQUALS_OPERATOR) && !isFieldComparison && value.length > 1) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (CONTAINS_OPERATOR.equals(operator) || STARTS_WITH_OPERATOR.equals(operator) || ENDS_WITH_OPERATOR.equals(operator)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(formatField(entityKey, type, field, ignoreCase, isNegation));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append("","");"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(formatValue(field, entityKey, type, secondaryType, value, isFieldComparison, ignoreCase, ignoreQuotes));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append("")"");"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (LENGTH_EQUALS_OPERATOR.equals(operator) || LENGTH_GREATER_THAN_EQUALS_OPERATOR.equals(operator) || LENGTH_GREATER_THAN_OPERATOR.equals(operator) ||
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,LENGTH_LESS_THAN_EQUALS_OPERATOR.equals(operator) || LENGTH_LESS_THAN_OPERATOR.equals(operator)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, value, type, secondaryType, "".contains"","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, value, type, secondaryType, "".endsWith"","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, value, type, secondaryType, ""=="", false, false, false, false, false);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, value, type, secondaryType, ""=="", false, true, false, false, false);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, value, type, secondaryType, "">="", false, false, false, false, false);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, value, type, secondaryType, "">="", false, true, false, false, false);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, value, type, secondaryType, "">"", false, false, false, false, false);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, value, type, secondaryType, "">"", false, true, false, false, false);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, value, type, secondaryType, ""=="", false, false, true, false, false);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, value, type, secondaryType, ""!="", false, false, true, false, false);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, value, type, secondaryType, "".startsWith"","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, new Object[]{""null""}, type, secondaryType, ""=="","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, value, type, secondaryType, ""<="", false, false, false, false, false);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, value, type, secondaryType, ""<="", false, true, false, false, false);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, value, type, secondaryType, ""<"", false, false, false, false, false);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, value, type, secondaryType, ""<"","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, value, type, secondaryType, ""!="", false, false, false, false, false);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, value, type, secondaryType, ""!="","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, new Object[]{""null""}, type, secondaryType, ""!="","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, value, type, secondaryType, "".size()>"", false, false, false, false, true);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, value, type, secondaryType, "".size()>="", false, false, false, false, true);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, value, type, secondaryType, "".size()<"", false, false, false, false, true);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, value, type, secondaryType, "".size()<="", false, false, false, false, true);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, value, type, secondaryType, "".size()=="", false, false, false, false, true);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildCollectionExpression(sb, entityKey, field, value, type, secondaryType, "".size()>0"", false, false, false, false, true);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildCollectionExpression(sb, entityKey, field, value, type, secondaryType, "".size()==0"", false, false, false, false, true);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, new Object[]{value[0]}, type, secondaryType, "">"","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, new Object[]{value[1]}, type, secondaryType, ""<"","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, new Object[]{value[0]}, type, secondaryType, "">="","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"buildExpression(sb, entityKey, field, new Object[]{value[1]}, type, secondaryType, ""<="","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(""CollectionUtils.intersection("");"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,sb.append(operator);
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"if (operator.equals(""=="") && !isFieldComparison && value.length > 1) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,import org.broadleafcommerce.openadmin.web.rulebuilder.DataDTOToMVELTranslator;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"private static final String COLLECTION_CASE = ""CollectionUtils.intersection"";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,private static final String[] OLD_SPECIAL_CASES = {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,private static final String[] SPECIAL_CASES = {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"""org.apache.commons.lang3.StringUtils.startsWith()"","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"""org.apache.commons.lang3.StringUtils.endsWith()"","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"""org.apache.commons.lang3.StringUtils.contains()"","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"""org.apache.commons.lang3.StringUtils.length()>"","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"""org.apache.commons.lang3.StringUtils.length()>="","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"""org.apache.commons.lang3.StringUtils.length()<"","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"""org.apache.commons.lang3.StringUtils.length()<="","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"""org.apache.commons.lang3.StringUtils.length()=="""
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,};
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,private static final String[] STANDARD_OPERATORS = {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,if (phrase.contains(COLLECTION_CASE)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,String[] components = new String[3];
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,boolean componentsExtracted = false;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,if (phrase.startsWith(COLLECTION_CASE)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,components = extractOldCollectionCase(phrase);
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,components = extractCollectionCase(phrase);
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,}
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,componentsExtracted = true;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,if (!componentsExtracted) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,for (String operator : STANDARD_OPERATORS) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,if (phrase.contains(operator)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"components = extractStandardComponents(phrase, operator);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,//may be an old special expression
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,for (String key : OLD_SPECIAL_CASES) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,if (phrase.indexOf(key) >= 0) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"components = extractOldSpecialComponents(phrase, key);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,for (String operator: SPECIAL_CASES) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"int operatorLastIndex = operator.indexOf("")"");"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"if (phrase.contains(operator.substring(0, operatorLastIndex)) && phrase.contains(operator.substring(operatorLastIndex))) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"components = extractSpecialComponents(phrase, operator);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,//may be a projection
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,try {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,components = extractProjection(components);
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} catch (Exception e1) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,//do nothing
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"throw new MVELTranslationException(MVELTranslationException.UNRECOGNIZABLE_RULE, ""Could not parse the MVEL expression to a "" +"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"""compatible form for the rules builder ("" + phrase + "")"");"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,protected String[] extractOldCollectionCase(String phrase) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,String[] temp = new String[3];
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,//field
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"temp[0] = phrase.substring((COLLECTION_CASE + ""("").length(), phrase.indexOf("",""));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,//value
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"temp[2] = phrase.substring(phrase.indexOf(""[""), phrase.indexOf(""]"") + 1);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,//operator
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"temp[1] = phrase.substring(phrase.indexOf("".size""));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return temp;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,protected String[] extractCollectionCase(String phrase) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"int fieldIndex = phrase.indexOf(""("", phrase.indexOf(COLLECTION_CASE)) + 1;"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"temp[0] = phrase.substring(fieldIndex, phrase.indexOf("",""));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"String operatorBeginning = phrase.substring(0, phrase.indexOf(""("") + 1);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"String operatorEnd = phrase.substring(phrase.lastIndexOf("")""));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,temp[1] = operatorBeginning + operatorEnd;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"protected String[] extractOldSpecialComponents(String phrase, String operator) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,int startsWithIndex = phrase.indexOf(operator);
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"temp[0] = phrase.substring(0, startsWithIndex);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,temp[1] = operator;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"temp[2] = phrase.substring(startsWithIndex + operator.length() + 1, phrase.lastIndexOf("")""));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"protected String[] extractStandardComponents(String phrase, String operator) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"temp[0] = phrase.substring(0, phrase.indexOf(operator));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"temp[2] = phrase.substring(phrase.indexOf(operator) + operator.length(), phrase.length());"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"protected String[] extractSpecialComponents(String phrase, String operator) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"temp[0] = phrase.substring(phrase.indexOf(""("") + 1, phrase.indexOf("")""));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"String operatorEnd = operator.substring(phrase.indexOf("")""));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,int operatorLastIndex = phrase.indexOf(operatorEnd);
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,temp[2] = phrase.substring(operatorLastIndex + operatorEnd.length());
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,if (operator.equals(DataDTOToMVELTranslator.EQUALS_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"if (value.equals(""null"")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.IS_NULL;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (isFieldComparison) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.EQUALS_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (isIgnoreCase) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.IEQUALS;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.EQUALS;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (operator.equals(DataDTOToMVELTranslator.NOT_EQUALS_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.NOT_NULL;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.NOT_EQUAL_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.INOT_EQUAL;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.NOT_EQUAL;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (operator.equals(DataDTOToMVELTranslator.GREATER_THAN_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,if (isFieldComparison) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.GREATER_THAN_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.GREATER_THAN;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (operator.equals(DataDTOToMVELTranslator.LESS_THAN_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.LESS_THAN_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.LESS_THAN;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (operator.equals(DataDTOToMVELTranslator.GREATER_THAN_EQUALS_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.GREATER_OR_EQUAL_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.GREATER_OR_EQUAL;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (operator.equals(DataDTOToMVELTranslator.LESS_THAN_EQUALS_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.LESS_OR_EQUAL_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.LESS_OR_EQUAL;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (operator.equals(DataDTOToMVELTranslator.CONTAINS_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_CONTAINS_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,if (isNegation) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,if (isIgnoreCase) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.INOT_CONTAINS;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.NOT_CONTAINS;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.ICONTAINS;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.CONTAINS_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.CONTAINS;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (operator.equals(DataDTOToMVELTranslator.STARTS_WITH_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_STARTS_WITH_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.INOT_STARTS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.NOT_STARTS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.ISTARTS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (isFieldComparison){
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.STARTS_WITH_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.STARTS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (operator.equals(DataDTOToMVELTranslator.ENDS_WITH_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_ENDS_WITH_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.INOT_ENDS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.NOT_ENDS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.IENDS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.ENDS_WITH_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,return BLCOperator.ENDS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_GREATER_THAN_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_SIZE_GREATER_THAN_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_GREATER_THAN_EQUALS_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_SIZE_GREATER_THAN_EQUAL_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_LESS_THAN_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_SIZE_LESS_THAN_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_LESS_THAN_EQUALS_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_SIZE_LESS_THAN_EQUAL_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_EQUALS_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_SIZE_EQUAL_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_GREATER_THAN_OPERATOR + DataDTOToMVELTranslator.ZERO_OPERATOR) ||
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,operator.equals(DataDTOToMVELTranslator.OLD_SIZE_GREATER_THAN_OPERATOR + DataDTOToMVELTranslator.ZERO_OPERATOR)){
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_EQUALS_OPERATOR + DataDTOToMVELTranslator.ZERO_OPERATOR) ||
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,operator.equals(DataDTOToMVELTranslator.OLD_SIZE_EQUAL_OPERATOR + DataDTOToMVELTranslator.ZERO_OPERATOR)){
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"private static final String COLLECTIONCASE = ""CollectionUtils.intersection"";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,private static final String[] SPECIALCASES = {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,private static final String[] STANDARDOPERATORS = {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,if (phrase.startsWith(COLLECTIONCASE)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,String[] components = new String[]{};
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,//field
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"components[0] = phrase.substring((COLLECTIONCASE+""("").length(), phrase.indexOf("",""));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,//value
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"components[2] = phrase.substring(((COLLECTIONCASE+""("")+components[0]+"","").length(), phrase.indexOf("").size""));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,//operator
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"components[1] = phrase.substring(phrase.indexOf("".size""));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,components[0] = convertMapAccessSyntax(components[0]);
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return components;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,for (String operator : STANDARDOPERATORS) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,String[] temp;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,if (phrase.contains(operator)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,temp = new String[2];
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"temp[0] = phrase.substring(0, phrase.indexOf(operator));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"temp[1] = phrase.substring(phrase.indexOf(operator) + operator.length(), phrase.length());"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,} else {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,temp = new String[1];
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,temp[0] = phrase;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,}
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,if (temp.length == 2) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,components = new String[3];
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,components[0] = temp[0];
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,components[1] = operator;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,components[2] = temp[1];
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,break;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,components = temp;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,if (components.length != 3) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,//may be a special expression
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,for (String key : SPECIALCASES) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,if (components[0].indexOf(key) >= 0) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"String[] temp = extractSpecialComponents(components, key);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,//may be a projection
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,try {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,String[] temp = extractProjection(components);
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,} catch (Exception e1) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,//do nothing
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"throw new MVELTranslationException(MVELTranslationException.UNRECOGNIZABLE_RULE, ""Could not parse the MVEL expression to a "" +"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"""compatible form for the rules builder ("" + phrase + "")"");"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"protected String[] extractSpecialComponents(String[] components, String key) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,int startsWithIndex = components[0].indexOf(key);
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"temp[0] = components[0].substring(0, startsWithIndex);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"temp[1] = key.substring(1, key.length());"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"temp[2] = components[0].substring(startsWithIndex + key.length() + 1, components[0].lastIndexOf("")""));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"if (operator.equals(""=="") && value.equals(""null"")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.IS_NULL;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals(""=="") && isFieldComparison) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.EQUALS_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,} else if (
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,isIgnoreCase &&
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"operator.equals(""=="")"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.IEQUALS;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals(""=="")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.EQUALS;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals(""!="") && value.equals(""null"")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.NOT_NULL;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals(""!="") && isFieldComparison) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.NOT_EQUAL_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"operator.equals(""!="")"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.INOT_EQUAL;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals(""!="")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.NOT_EQUAL;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals("">"") && isFieldComparison) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.GREATER_THAN_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals("">"")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.GREATER_THAN;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals(""<"") && isFieldComparison) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.LESS_THAN_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals(""<"")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.LESS_THAN;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals("">="") && isFieldComparison) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.GREATER_OR_EQUAL_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals("">="")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.GREATER_OR_EQUAL;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals(""<="") && isFieldComparison) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.LESS_OR_EQUAL_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals(""<="")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.LESS_OR_EQUAL;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"operator.equals(""contains"") &&"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,isNegation
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.INOT_CONTAINS;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals(""contains"") && isNegation) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.NOT_CONTAINS;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"operator.equals(""contains"")"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.ICONTAINS;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals(""contains"") && isFieldComparison) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.CONTAINS_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals(""contains"")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.CONTAINS;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"operator.equals(""startsWith"") &&"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.INOT_STARTS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals(""startsWith"") && isNegation) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.NOT_STARTS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"operator.equals(""startsWith"")"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.ISTARTS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals(""startsWith"") && isFieldComparison) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.STARTS_WITH_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals(""startsWith"")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.STARTS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"operator.equals(""endsWith"") &&"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.INOT_ENDS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals(""endsWith"") && isNegation) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.NOT_ENDS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"operator.equals(""endsWith"")"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.IENDS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals(""endsWith"") && isFieldComparison) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.ENDS_WITH_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals(""endsWith"")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return BLCOperator.ENDS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals("".size()>"")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals("".size()>="")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals("".size()<"")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals("".size()<="")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals("".size()=="")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals("".size()>0"")){"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"} else if (operator.equals("".size()==0"")){"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,import org.broadleafcommerce.openadmin.web.rulebuilder.DataDTOToMVELTranslator;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"private static final String COLLECTION_CASE = ""CollectionUtils.intersection"";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,private static final String[] OLD_SPECIAL_CASES = {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,private static final String[] SPECIAL_CASES = {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"""org.apache.commons.lang3.StringUtils.startsWith()"","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"""org.apache.commons.lang3.StringUtils.endsWith()"","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"""org.apache.commons.lang3.StringUtils.contains()"","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"""org.apache.commons.lang3.StringUtils.length()>"","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"""org.apache.commons.lang3.StringUtils.length()>="","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"""org.apache.commons.lang3.StringUtils.length()<"","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"""org.apache.commons.lang3.StringUtils.length()<="","
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"""org.apache.commons.lang3.StringUtils.length()=="""
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,};
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,private static final String[] STANDARD_OPERATORS = {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (phrase.contains(COLLECTION_CASE)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,String[] components = new String[3];
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,boolean componentsExtracted = false;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (phrase.startsWith(COLLECTION_CASE)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,components = extractOldCollectionCase(phrase);
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,components = extractCollectionCase(phrase);
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,}
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,componentsExtracted = true;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (!componentsExtracted) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,for (String operator : STANDARD_OPERATORS) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (phrase.contains(operator)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"components = extractStandardComponents(phrase, operator);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,//may be an old special expression
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,for (String key : OLD_SPECIAL_CASES) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (phrase.indexOf(key) >= 0) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"components = extractOldSpecialComponents(phrase, key);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,for (String operator: SPECIAL_CASES) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"int operatorLastIndex = operator.indexOf("")"");"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"if (phrase.contains(operator.substring(0, operatorLastIndex)) && phrase.contains(operator.substring(operatorLastIndex))) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"components = extractSpecialComponents(phrase, operator);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,//may be a projection
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,try {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,components = extractProjection(components);
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} catch (Exception e1) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,//do nothing
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"throw new MVELTranslationException(MVELTranslationException.UNRECOGNIZABLE_RULE, ""Could not parse the MVEL expression to a "" +"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"""compatible form for the rules builder ("" + phrase + "")"");"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,protected String[] extractOldCollectionCase(String phrase) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,String[] temp = new String[3];
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,//field
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"temp[0] = phrase.substring((COLLECTION_CASE + ""("").length(), phrase.indexOf("",""));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,//value
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"temp[2] = phrase.substring(phrase.indexOf(""[""), phrase.indexOf(""]"") + 1);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,//operator
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"temp[1] = phrase.substring(phrase.indexOf("".size""));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return temp;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,protected String[] extractCollectionCase(String phrase) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"int fieldIndex = phrase.indexOf(""("", phrase.indexOf(COLLECTION_CASE)) + 1;"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"temp[0] = phrase.substring(fieldIndex, phrase.indexOf("",""));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"String operatorBeginning = phrase.substring(0, phrase.indexOf(""("") + 1);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"String operatorEnd = phrase.substring(phrase.lastIndexOf("")""));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,temp[1] = operatorBeginning + operatorEnd;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"protected String[] extractOldSpecialComponents(String phrase, String operator) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,int startsWithIndex = phrase.indexOf(operator);
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"temp[0] = phrase.substring(0, startsWithIndex);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,temp[1] = operator;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"temp[2] = phrase.substring(startsWithIndex + operator.length() + 1, phrase.lastIndexOf("")""));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"protected String[] extractStandardComponents(String phrase, String operator) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"temp[0] = phrase.substring(0, phrase.indexOf(operator));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"temp[2] = phrase.substring(phrase.indexOf(operator) + operator.length(), phrase.length());"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"protected String[] extractSpecialComponents(String phrase, String operator) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"temp[0] = phrase.substring(phrase.indexOf(""("") + 1, phrase.indexOf("")""));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"String operatorEnd = operator.substring(phrase.indexOf("")""));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,int operatorLastIndex = phrase.indexOf(operatorEnd);
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,temp[2] = phrase.substring(operatorLastIndex + operatorEnd.length());
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (operator.equals(DataDTOToMVELTranslator.EQUALS_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"if (value.equals(""null"")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.IS_NULL;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (isFieldComparison) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.EQUALS_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (isIgnoreCase) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.IEQUALS;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.EQUALS;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (operator.equals(DataDTOToMVELTranslator.NOT_EQUALS_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.NOT_NULL;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.NOT_EQUAL_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.INOT_EQUAL;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.NOT_EQUAL;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (operator.equals(DataDTOToMVELTranslator.GREATER_THAN_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (isFieldComparison) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.GREATER_THAN_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.GREATER_THAN;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (operator.equals(DataDTOToMVELTranslator.LESS_THAN_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.LESS_THAN_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.LESS_THAN;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (operator.equals(DataDTOToMVELTranslator.GREATER_THAN_EQUALS_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.GREATER_OR_EQUAL_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.GREATER_OR_EQUAL;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (operator.equals(DataDTOToMVELTranslator.LESS_THAN_EQUALS_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.LESS_OR_EQUAL_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.LESS_OR_EQUAL;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (operator.equals(DataDTOToMVELTranslator.CONTAINS_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_CONTAINS_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (isNegation) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (isIgnoreCase) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.INOT_CONTAINS;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.NOT_CONTAINS;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.ICONTAINS;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.CONTAINS_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.CONTAINS;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (operator.equals(DataDTOToMVELTranslator.STARTS_WITH_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_STARTS_WITH_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.INOT_STARTS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.NOT_STARTS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.ISTARTS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (isFieldComparison){
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.STARTS_WITH_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.STARTS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (operator.equals(DataDTOToMVELTranslator.ENDS_WITH_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_ENDS_WITH_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.INOT_ENDS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.NOT_ENDS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.IENDS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.ENDS_WITH_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,return BLCOperator.ENDS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_GREATER_THAN_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_SIZE_GREATER_THAN_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_GREATER_THAN_EQUALS_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_SIZE_GREATER_THAN_EQUAL_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_LESS_THAN_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_SIZE_LESS_THAN_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_LESS_THAN_EQUALS_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_SIZE_LESS_THAN_EQUAL_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_EQUALS_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_SIZE_EQUAL_OPERATOR)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_GREATER_THAN_OPERATOR + DataDTOToMVELTranslator.ZERO_OPERATOR) ||
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,operator.equals(DataDTOToMVELTranslator.OLD_SIZE_GREATER_THAN_OPERATOR + DataDTOToMVELTranslator.ZERO_OPERATOR)){
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_EQUALS_OPERATOR + DataDTOToMVELTranslator.ZERO_OPERATOR) ||
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,operator.equals(DataDTOToMVELTranslator.OLD_SIZE_EQUAL_OPERATOR + DataDTOToMVELTranslator.ZERO_OPERATOR)){
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"private static final String COLLECTIONCASE = ""CollectionUtils.intersection"";"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,private static final String[] SPECIALCASES = {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,private static final String[] STANDARDOPERATORS = {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,if (phrase.startsWith(COLLECTIONCASE)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,String[] components = new String[]{};
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,//field
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"components[0] = phrase.substring((COLLECTIONCASE+""("").length(), phrase.indexOf("",""));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,//value
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"components[2] = phrase.substring(((COLLECTIONCASE+""("")+components[0]+"","").length(), phrase.indexOf("").size""));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,//operator
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"components[1] = phrase.substring(phrase.indexOf("".size""));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,components[0] = convertMapAccessSyntax(components[0]);
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return components;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,for (String operator : STANDARDOPERATORS) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,String[] temp;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,if (phrase.contains(operator)) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,temp = new String[2];
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"temp[0] = phrase.substring(0, phrase.indexOf(operator));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"temp[1] = phrase.substring(phrase.indexOf(operator) + operator.length(), phrase.length());"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,} else {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,temp = new String[1];
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,temp[0] = phrase;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,}
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,if (temp.length == 2) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,components = new String[3];
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,components[0] = temp[0];
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,components[1] = operator;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,components[2] = temp[1];
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,break;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,components = temp;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,if (components.length != 3) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,//may be a special expression
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,for (String key : SPECIALCASES) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,if (components[0].indexOf(key) >= 0) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"String[] temp = extractSpecialComponents(components, key);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,//may be a projection
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,try {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,String[] temp = extractProjection(components);
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,} catch (Exception e1) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,//do nothing
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"throw new MVELTranslationException(MVELTranslationException.UNRECOGNIZABLE_RULE, ""Could not parse the MVEL expression to a "" +"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"""compatible form for the rules builder ("" + phrase + "")"");"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"protected String[] extractSpecialComponents(String[] components, String key) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,int startsWithIndex = components[0].indexOf(key);
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"temp[0] = components[0].substring(0, startsWithIndex);"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"temp[1] = key.substring(1, key.length());"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"temp[2] = components[0].substring(startsWithIndex + key.length() + 1, components[0].lastIndexOf("")""));"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"if (operator.equals(""=="") && value.equals(""null"")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.IS_NULL;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals(""=="") && isFieldComparison) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.EQUALS_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,} else if (
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,isIgnoreCase &&
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"operator.equals(""=="")"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,) {
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.IEQUALS;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals(""=="")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.EQUALS;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals(""!="") && value.equals(""null"")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.NOT_NULL;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals(""!="") && isFieldComparison) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.NOT_EQUAL_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"operator.equals(""!="")"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.INOT_EQUAL;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals(""!="")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.NOT_EQUAL;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals("">"") && isFieldComparison) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.GREATER_THAN_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals("">"")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.GREATER_THAN;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals(""<"") && isFieldComparison) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.LESS_THAN_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals(""<"")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.LESS_THAN;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals("">="") && isFieldComparison) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.GREATER_OR_EQUAL_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals("">="")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.GREATER_OR_EQUAL;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals(""<="") && isFieldComparison) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.LESS_OR_EQUAL_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals(""<="")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.LESS_OR_EQUAL;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"operator.equals(""contains"") &&"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,isNegation
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.INOT_CONTAINS;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals(""contains"") && isNegation) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.NOT_CONTAINS;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"operator.equals(""contains"")"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.ICONTAINS;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals(""contains"") && isFieldComparison) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.CONTAINS_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals(""contains"")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.CONTAINS;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"operator.equals(""startsWith"") &&"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.INOT_STARTS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals(""startsWith"") && isNegation) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.NOT_STARTS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"operator.equals(""startsWith"")"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.ISTARTS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals(""startsWith"") && isFieldComparison) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.STARTS_WITH_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals(""startsWith"")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.STARTS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"operator.equals(""endsWith"") &&"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.INOT_ENDS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals(""endsWith"") && isNegation) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.NOT_ENDS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"operator.equals(""endsWith"")"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.IENDS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals(""endsWith"") && isFieldComparison) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.ENDS_WITH_FIELD;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals(""endsWith"")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return BLCOperator.ENDS_WITH;
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals("".size()>"")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals("".size()>="")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals("".size()<"")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals("".size()<="")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals("".size()=="")) {"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals("".size()>0"")){"
dba90d13bb9f90f4f27ce484e0c363debdc9f58b,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"} else if (operator.equals("".size()==0"")){"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"DataDTOToMVELTranslator.OLD_STARTS_WITH_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"DataDTOToMVELTranslator.OLD_ENDS_WITH_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,DataDTOToMVELTranslator.OLD_CONTAINS_OPERATOR
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"DataDTOToMVELTranslator.STARTS_WITH_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"DataDTOToMVELTranslator.ENDS_WITH_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,DataDTOToMVELTranslator.CONTAINS_OPERATOR
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"DataDTOToMVELTranslator.SIZE_GREATER_THAN_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"DataDTOToMVELTranslator.SIZE_GREATER_THAN_EQUALS_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"DataDTOToMVELTranslator.SIZE_LESS_THAN_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"DataDTOToMVELTranslator.SIZE_LESS_THAN_EQUALS_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"DataDTOToMVELTranslator.SIZE_EQUALS_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"DataDTOToMVELTranslator.EQUALS_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"DataDTOToMVELTranslator.NOT_EQUALS_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"DataDTOToMVELTranslator.GREATER_THAN_EQUALS_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"DataDTOToMVELTranslator.LESS_THAN_EQUALS_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"DataDTOToMVELTranslator.GREATER_THAN_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,DataDTOToMVELTranslator.LESS_THAN_OPERATOR
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,if (phrase.contains(DataDTOToMVELTranslator.COLLECTION_OPERATOR)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,if (phrase.startsWith(DataDTOToMVELTranslator.COLLECTION_OPERATOR)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,components = extractCollectionCase(phrase);
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,componentsExtracted = true;
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,break;
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,}
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,if (!componentsExtracted) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,for (String operator: SPECIAL_CASES) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"int operatorLastIndex = operator.indexOf("")"");"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"if (phrase.contains(operator.substring(0, operatorLastIndex))) {"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"components = extractSpecialComponents(phrase, operator);"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,protected String[] extractCollectionCase(String phrase) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"temp[0] = phrase.substring(phrase.indexOf(""("") + 1, phrase.indexOf("",""));"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"protected String[] extractOldSpecialComponents(String phrase, String operator) {"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,int specialIndex = phrase.indexOf(operator);
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"temp[0] = phrase.substring(0, specialIndex);"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,//value
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"temp[2] = phrase.substring(specialIndex + operator.length() + 1, phrase.lastIndexOf("")""));"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"String operatorBegin = operator.substring(0, operator.indexOf("")""));"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"temp[0] = phrase.substring(operatorBegin.length(), phrase.indexOf("",""));"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"temp[2] = phrase.substring(phrase.indexOf("","") + 1, phrase.lastIndexOf("")""));"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (operator.equals(DataDTOToMVELTranslator.SIZE_GREATER_THAN_OPERATOR)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (operator.equals(DataDTOToMVELTranslator.SIZE_GREATER_THAN_EQUALS_OPERATOR)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (operator.equals(DataDTOToMVELTranslator.SIZE_LESS_THAN_OPERATOR)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (operator.equals(DataDTOToMVELTranslator.SIZE_LESS_THAN_EQUALS_OPERATOR)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (operator.equals(DataDTOToMVELTranslator.SIZE_EQUALS_OPERATOR)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (operator.equals(DataDTOToMVELTranslator.SIZE_GREATER_THAN_OPERATOR + DataDTOToMVELTranslator.ZERO_OPERATOR)){
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else if (operator.equals(DataDTOToMVELTranslator.SIZE_EQUALS_OPERATOR + DataDTOToMVELTranslator.ZERO_OPERATOR)){
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"private static final String COLLECTION_CASE = ""CollectionUtils.intersection"";"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,""".startsWith"","
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,""".endsWith"","
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,""".contains"""
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"""org.apache.commons.lang3.StringUtils.startsWith()"","
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"""org.apache.commons.lang3.StringUtils.endsWith()"","
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"""org.apache.commons.lang3.StringUtils.contains()"","
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"""org.apache.commons.lang3.StringUtils.length()>"","
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"""org.apache.commons.lang3.StringUtils.length()>="","
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"""org.apache.commons.lang3.StringUtils.length()<"","
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"""org.apache.commons.lang3.StringUtils.length()<="","
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"""org.apache.commons.lang3.StringUtils.length()=="""
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,""".size()>"","
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,""".size()>="","
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,""".size()<"","
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,""".size()<="","
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,""".size()=="","
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"""=="","
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"""!="","
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"""<="","
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"""<"","
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,""">="","
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,""">"""
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,if (phrase.contains(COLLECTION_CASE)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,components = new String[3];
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,if (phrase.startsWith(COLLECTION_CASE)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,components = extractOldCollectionCase(phrase);
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,} else {
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,components = extractCollectionCase(phrase);
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,}
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,if (!componentsExtracted) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,for (String operator: SPECIAL_CASES) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"int operatorLastIndex = operator.indexOf("")"");"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"if (phrase.contains(operator.substring(0, operatorLastIndex)) && phrase.contains(operator.substring(operatorLastIndex))) {"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"components = extractSpecialComponents(phrase, operator);"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,componentsExtracted = true;
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,protected String[] extractOldCollectionCase(String phrase) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"temp[0] = phrase.substring((COLLECTION_CASE + ""("").length(), phrase.indexOf("",""));"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,protected String[] extractCollectionCase(String phrase) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"int fieldIndex = phrase.indexOf(""("", phrase.indexOf(COLLECTION_CASE)) + 1;"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"temp[0] = phrase.substring(fieldIndex, phrase.indexOf("",""));"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,//value
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"temp[2] = phrase.substring(phrase.indexOf(""[""), phrase.indexOf(""]"") + 1);"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"String operatorBeginning = phrase.substring(0, phrase.indexOf(""("") + 1);"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"String operatorEnd = phrase.substring(phrase.lastIndexOf("")""));"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,temp[1] = operatorBeginning + operatorEnd;
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,return temp;
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"protected String[] extractOldSpecialComponents(String phrase, String operator) {"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,String[] temp = new String[3];
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,int startsWithIndex = phrase.indexOf(operator);
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"temp[0] = phrase.substring(0, startsWithIndex);"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"temp[2] = phrase.substring(startsWithIndex + operator.length() + 1, phrase.lastIndexOf("")""));"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"temp[0] = phrase.substring(phrase.indexOf(""("") + 1, phrase.indexOf("")""));"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"String operatorEnd = operator.substring(phrase.indexOf("")""));"
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,int operatorLastIndex = phrase.indexOf(operatorEnd);
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,temp[2] = phrase.substring(operatorLastIndex + operatorEnd.length());
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_GREATER_THAN_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_SIZE_GREATER_THAN_OPERATOR)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_GREATER_THAN_EQUALS_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_SIZE_GREATER_THAN_EQUAL_OPERATOR)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_LESS_THAN_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_SIZE_LESS_THAN_OPERATOR)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_LESS_THAN_EQUALS_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_SIZE_LESS_THAN_EQUAL_OPERATOR)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_EQUALS_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_SIZE_EQUAL_OPERATOR)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_GREATER_THAN_OPERATOR + DataDTOToMVELTranslator.ZERO_OPERATOR) ||
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,operator.equals(DataDTOToMVELTranslator.OLD_SIZE_GREATER_THAN_OPERATOR + DataDTOToMVELTranslator.ZERO_OPERATOR)){
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_EQUALS_OPERATOR + DataDTOToMVELTranslator.ZERO_OPERATOR) ||
587c832b8108cdd6b7e889e82c700c64805fe3f7,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,operator.equals(DataDTOToMVELTranslator.OLD_SIZE_EQUAL_OPERATOR + DataDTOToMVELTranslator.ZERO_OPERATOR)){
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"DataDTOToMVELTranslator.OLD_STARTS_WITH_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"DataDTOToMVELTranslator.OLD_ENDS_WITH_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,DataDTOToMVELTranslator.OLD_CONTAINS_OPERATOR
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"DataDTOToMVELTranslator.STARTS_WITH_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"DataDTOToMVELTranslator.ENDS_WITH_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,DataDTOToMVELTranslator.CONTAINS_OPERATOR
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"DataDTOToMVELTranslator.SIZE_GREATER_THAN_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"DataDTOToMVELTranslator.SIZE_GREATER_THAN_EQUALS_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"DataDTOToMVELTranslator.SIZE_LESS_THAN_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"DataDTOToMVELTranslator.SIZE_LESS_THAN_EQUALS_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"DataDTOToMVELTranslator.SIZE_EQUALS_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"DataDTOToMVELTranslator.EQUALS_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"DataDTOToMVELTranslator.NOT_EQUALS_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"DataDTOToMVELTranslator.GREATER_THAN_EQUALS_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"DataDTOToMVELTranslator.LESS_THAN_EQUALS_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"DataDTOToMVELTranslator.GREATER_THAN_OPERATOR,"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,DataDTOToMVELTranslator.LESS_THAN_OPERATOR
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (phrase.contains(DataDTOToMVELTranslator.COLLECTION_OPERATOR)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (phrase.startsWith(DataDTOToMVELTranslator.COLLECTION_OPERATOR)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,components = extractCollectionCase(phrase);
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,componentsExtracted = true;
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,break;
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,}
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (!componentsExtracted) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,for (String operator: SPECIAL_CASES) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"int operatorLastIndex = operator.indexOf("")"");"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"if (phrase.contains(operator.substring(0, operatorLastIndex))) {"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"components = extractSpecialComponents(phrase, operator);"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,protected String[] extractCollectionCase(String phrase) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"temp[0] = phrase.substring(phrase.indexOf(""("") + 1, phrase.indexOf("",""));"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"protected String[] extractOldSpecialComponents(String phrase, String operator) {"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,int specialIndex = phrase.indexOf(operator);
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"temp[0] = phrase.substring(0, specialIndex);"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,//value
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"temp[2] = phrase.substring(specialIndex + operator.length() + 1, phrase.lastIndexOf("")""));"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"String operatorBegin = operator.substring(0, operator.indexOf("")""));"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"temp[0] = phrase.substring(operatorBegin.length(), phrase.indexOf("",""));"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"temp[2] = phrase.substring(phrase.indexOf("","") + 1, phrase.lastIndexOf("")""));"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (operator.equals(DataDTOToMVELTranslator.SIZE_GREATER_THAN_OPERATOR)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (operator.equals(DataDTOToMVELTranslator.SIZE_GREATER_THAN_EQUALS_OPERATOR)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (operator.equals(DataDTOToMVELTranslator.SIZE_LESS_THAN_OPERATOR)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (operator.equals(DataDTOToMVELTranslator.SIZE_LESS_THAN_EQUALS_OPERATOR)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (operator.equals(DataDTOToMVELTranslator.SIZE_EQUALS_OPERATOR)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (operator.equals(DataDTOToMVELTranslator.SIZE_GREATER_THAN_OPERATOR + DataDTOToMVELTranslator.ZERO_OPERATOR)){
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,} else if (operator.equals(DataDTOToMVELTranslator.SIZE_EQUALS_OPERATOR + DataDTOToMVELTranslator.ZERO_OPERATOR)){
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"private static final String COLLECTION_CASE = ""CollectionUtils.intersection"";"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,""".startsWith"","
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,""".endsWith"","
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,""".contains"""
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"""org.apache.commons.lang3.StringUtils.startsWith()"","
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"""org.apache.commons.lang3.StringUtils.endsWith()"","
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"""org.apache.commons.lang3.StringUtils.contains()"","
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"""org.apache.commons.lang3.StringUtils.length()>"","
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"""org.apache.commons.lang3.StringUtils.length()>="","
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"""org.apache.commons.lang3.StringUtils.length()<"","
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"""org.apache.commons.lang3.StringUtils.length()<="","
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"""org.apache.commons.lang3.StringUtils.length()=="""
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,""".size()>"","
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,""".size()>="","
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,""".size()<"","
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,""".size()<="","
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,""".size()=="","
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"""=="","
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"""!="","
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"""<="","
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"""<"","
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,""">="","
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,""">"""
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,if (phrase.contains(COLLECTION_CASE)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,components = new String[3];
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,if (phrase.startsWith(COLLECTION_CASE)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,components = extractOldCollectionCase(phrase);
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,} else {
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,components = extractCollectionCase(phrase);
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,}
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,if (!componentsExtracted) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,for (String operator: SPECIAL_CASES) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"int operatorLastIndex = operator.indexOf("")"");"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"if (phrase.contains(operator.substring(0, operatorLastIndex)) && phrase.contains(operator.substring(operatorLastIndex))) {"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"components = extractSpecialComponents(phrase, operator);"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,componentsExtracted = true;
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,protected String[] extractOldCollectionCase(String phrase) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"temp[0] = phrase.substring((COLLECTION_CASE + ""("").length(), phrase.indexOf("",""));"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,protected String[] extractCollectionCase(String phrase) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"int fieldIndex = phrase.indexOf(""("", phrase.indexOf(COLLECTION_CASE)) + 1;"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"temp[0] = phrase.substring(fieldIndex, phrase.indexOf("",""));"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,//value
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"temp[2] = phrase.substring(phrase.indexOf(""[""), phrase.indexOf(""]"") + 1);"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"String operatorBeginning = phrase.substring(0, phrase.indexOf(""("") + 1);"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"String operatorEnd = phrase.substring(phrase.lastIndexOf("")""));"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,temp[1] = operatorBeginning + operatorEnd;
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,return temp;
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"protected String[] extractOldSpecialComponents(String phrase, String operator) {"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,String[] temp = new String[3];
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,int startsWithIndex = phrase.indexOf(operator);
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"temp[0] = phrase.substring(0, startsWithIndex);"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"temp[2] = phrase.substring(startsWithIndex + operator.length() + 1, phrase.lastIndexOf("")""));"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"temp[0] = phrase.substring(phrase.indexOf(""("") + 1, phrase.indexOf("")""));"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"String operatorEnd = operator.substring(phrase.indexOf("")""));"
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,int operatorLastIndex = phrase.indexOf(operatorEnd);
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,temp[2] = phrase.substring(operatorLastIndex + operatorEnd.length());
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_GREATER_THAN_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_SIZE_GREATER_THAN_OPERATOR)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_GREATER_THAN_EQUALS_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_SIZE_GREATER_THAN_EQUAL_OPERATOR)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_LESS_THAN_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_SIZE_LESS_THAN_OPERATOR)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_LESS_THAN_EQUALS_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_SIZE_LESS_THAN_EQUAL_OPERATOR)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_EQUALS_OPERATOR) || operator.equals(DataDTOToMVELTranslator.OLD_SIZE_EQUAL_OPERATOR)) {
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_GREATER_THAN_OPERATOR + DataDTOToMVELTranslator.ZERO_OPERATOR) ||
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,operator.equals(DataDTOToMVELTranslator.OLD_SIZE_GREATER_THAN_OPERATOR + DataDTOToMVELTranslator.ZERO_OPERATOR)){
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,} else if (operator.equals(DataDTOToMVELTranslator.LENGTH_EQUALS_OPERATOR + DataDTOToMVELTranslator.ZERO_OPERATOR) ||
587c832b8108cdd6b7e889e82c700c64805fe3f7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,operator.equals(DataDTOToMVELTranslator.OLD_SIZE_EQUAL_OPERATOR + DataDTOToMVELTranslator.ZERO_OPERATOR)){
b3f5d7a0b231237659a9700e9333e1a77033a7c1,9f1433694e1ca3ddbdafe5c752cc9df8b617e7e4,added,0,"@ComponentScan(""org.broadleafcommerce.test.common.context.override.config.client.scan"")"
b3f5d7a0b231237659a9700e9333e1a77033a7c1,9f1433694e1ca3ddbdafe5c752cc9df8b617e7e4,deleted,1,"@ComponentScan(""org.broadleafcommerce.common.context.override.config.client.scan"")"
c46cea63aa4b29717844eb6676f044bcd337b593,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,value.substring(value.indexOf(caseInsensitivityKey) + caseInsensitivityKey.length());
c46cea63aa4b29717844eb6676f044bcd337b593,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"if (value.contains(""\"")"")) {"
c46cea63aa4b29717844eb6676f044bcd337b593,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"value = value.substring(0, value.indexOf(""\"")"") + 1) + value.substring(value.indexOf(""\"")"") + 2);"
c46cea63aa4b29717844eb6676f044bcd337b593,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,} else {
c46cea63aa4b29717844eb6676f044bcd337b593,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"value = value.substring(0, value.indexOf("")"")) + value.substring(value.indexOf("")"") + 1);"
c46cea63aa4b29717844eb6676f044bcd337b593,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,}
c46cea63aa4b29717844eb6676f044bcd337b593,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"value.substring(value.indexOf(caseInsensitivityKey) + caseInsensitivityKey.length(), value.length());"
c46cea63aa4b29717844eb6676f044bcd337b593,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"value = value.substring(0, value.indexOf("")"")) + value.substring(value.indexOf("")"")+1, value.length());"
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(formatField(entityKey, type, field, ignoreCase));"
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if(isNegation) {
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"sb.append(""!"");"
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,}
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,boolean ignoreCase) {
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"sb.append(formatField(entityKey, type, field, ignoreCase, isNegation));"
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"boolean ignoreCase, boolean isNegation) {"
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,if (isNegation) {
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"response.append(""!"");"
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,}
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"if (field.startsWith(""!"") || phrase.startsWith(""!"")) {"
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,if (field.contains(caseInsensitivityKey)) {
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"field = field.substring(field.indexOf(caseInsensitivityKey) + caseInsensitivityKey.length(), field.length()-1);"
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,int caseIndex = value.indexOf(caseInsensitivityKey);
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,"value = value.substring(0, caseIndex) +"
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,fad5b75f13c673e999075eda9709c449b87dbb66,added,0,value.substring(caseIndex + caseInsensitivityKey.length());
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"if (field.startsWith(""!"")) {"
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,if (field.startsWith(caseInsensitivityKey)) {
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"field = field.substring(caseInsensitivityKey.length(), field.length()-1);"
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,}
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,//check for NOT operator
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"if (field.startsWith(""!"" + caseInsensitivityKey)) {"
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,isIgnoreCase = true;
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"field = field.substring((""!"" + caseInsensitivityKey).length(), field.length()-1);"
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,"value = value.substring(0, value.indexOf(caseInsensitivityKey)) +"
9eb8a3ddd3cb5c4da17c63a6cf6fe4df3fcd1823,fad5b75f13c673e999075eda9709c449b87dbb66,deleted,1,value.substring(value.indexOf(caseInsensitivityKey) + caseInsensitivityKey.length());
e0100d283885030d61f580dba4d0e6d7b57564fc,479ea79411965f831a686923dc011fc3297ad884,added,0,"protected List<Translation> getTemplateTranslations(TranslatedEntity entityType, String entityId, String property, String localeCode) {"
e0100d283885030d61f580dba4d0e6d7b57564fc,479ea79411965f831a686923dc011fc3297ad884,deleted,1,"protected List<Translation> getTemplateTranslations(final TranslatedEntity entityType, final String entityId, final String property, final String localeCode) {"
b9caee120d697d98086f1618345bed1e92daffe2,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,String response = null;
b9caee120d697d98086f1618345bed1e92daffe2,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,if (specificTranslationDeleted) {
b9caee120d697d98086f1618345bed1e92daffe2,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,return replaceEmptyWithNullResponse(response);
b9caee120d697d98086f1618345bed1e92daffe2,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,}
b9caee120d697d98086f1618345bed1e92daffe2,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,//We have a valid general override - don't check for general template value
b9caee120d697d98086f1618345bed1e92daffe2,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,generalTranslationDeleted = true;
b9caee120d697d98086f1618345bed1e92daffe2,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,"String templateResponse = getTemplateTranslatedValue(cacheKey, property, entityType, entityId, localeCode,"
b9caee120d697d98086f1618345bed1e92daffe2,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,if (templateResponse != null) {
b9caee120d697d98086f1618345bed1e92daffe2,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,response = templateResponse;
b9caee120d697d98086f1618345bed1e92daffe2,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,return response;
b9caee120d697d98086f1618345bed1e92daffe2,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,deleted,1,String response;
b9caee120d697d98086f1618345bed1e92daffe2,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,deleted,1,return replaceEmptyWithNullResponse(response);
b9caee120d697d98086f1618345bed1e92daffe2,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,deleted,1,"return getTemplateTranslatedValue(cacheKey, property, entityType, entityId, localeCode,"
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,Element result;
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,"//Translation is dual discriminated by site and catalog, which can make it impossible to find results under normal"
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,//circumstances because the two discriminators can cancel eachother out. We use the IGNORE_CATALOG_ONLY ResultType
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,//to force the system to only honor the catalog discrimination during this call.
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,"Translation translation = dao.readTranslation(entityType, entityId, property, localeCode, localeCountryCode, ResultType.IGNORE_CATALOG_ONLY);"
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,"buildSingleItemResponse(response, translation);"
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,return response;
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,"Map<String, Map<String, StandardCacheItem>> propertyTranslationMap = (Map<String, Map<String, StandardCacheItem>>) result.getObjectValue();"
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,// Check For a Specific Standard Site Match (language and country)
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,"StandardCacheItem specificTranslation = translationSupport.lookupTranslationFromMap(specificPropertyKey, propertyTranslationMap, entityId);"
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,// Check For a General Match (language and country)
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,"StandardCacheItem generalTranslation = translationSupport.lookupTranslationFromMap(generalPropertyKey, propertyTranslationMap, entityId);"
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,response.setSpecificItem(specificTranslation);
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,response.setGeneralItem(generalTranslation);
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,"cacheItem.setCacheItem(translation==null?"""":translation);"
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,deleted,1,Element result = null;
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,deleted,1,"Translation translation = dao.readTranslation(entityType, entityId, property, localeCode, localeCountryCode, ResultType.IGNORE);"
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,deleted,1,if (translation != null) {
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,deleted,1,"buildSingleItemResponse(response, translation);"
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,deleted,1,return response;
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,deleted,1,}
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,deleted,1,if (result != null) {
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,deleted,1,"Map<String, Map<String, StandardCacheItem>> propertyTranslationMap = (Map<String, Map<String, StandardCacheItem>>) result.getObjectValue();"
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,deleted,1,// Check For a Specific Standard Site Match (language and country)
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,deleted,1,"StandardCacheItem specificTranslation = translationSupport.lookupTranslationFromMap(specificPropertyKey, propertyTranslationMap, entityId);"
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,deleted,1,// Check For a General Match (language and country)
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,deleted,1,"StandardCacheItem generalTranslation = translationSupport.lookupTranslationFromMap(generalPropertyKey, propertyTranslationMap, entityId);"
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,deleted,1,response.setSpecificItem(specificTranslation);
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,deleted,1,response.setGeneralItem(generalTranslation);
960ea910eb69a795e9ae9f614ed1846d92da1c01,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,deleted,1,cacheItem.setCacheItem(translation);
88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,479ea79411965f831a686923dc011fc3297ad884,added,0,Object testObject;
88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,479ea79411965f831a686923dc011fc3297ad884,added,0,try {
88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,479ea79411965f831a686923dc011fc3297ad884,added,0,//This should already be in level 1 cache and this should not cause a hit to the database.
88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,479ea79411965f831a686923dc011fc3297ad884,added,0,"testObject = em.find(Class.forName(entityType.getType()), Long.parseLong(entityId));"
88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,479ea79411965f831a686923dc011fc3297ad884,added,0,} catch (ClassNotFoundException e) {
88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,479ea79411965f831a686923dc011fc3297ad884,added,0,throw ExceptionHelper.refineException(e);
88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,479ea79411965f831a686923dc011fc3297ad884,added,0,}
88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,479ea79411965f831a686923dc011fc3297ad884,added,0,"extensionManager.refineParameterRetrieve(TranslationImpl.class, testObject, builder, criteria, root, restrictions);"
88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,479ea79411965f831a686923dc011fc3297ad884,added,0,if (extensionManager != null) {
88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,479ea79411965f831a686923dc011fc3297ad884,added,0,"extensionManager.refineQuery(TranslationImpl.class, testObject, query);"
88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,479ea79411965f831a686923dc011fc3297ad884,deleted,1,Object testObject;
88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,479ea79411965f831a686923dc011fc3297ad884,deleted,1,try {
88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,479ea79411965f831a686923dc011fc3297ad884,deleted,1,//This should already be in level 1 cache and this should not cause a hit to the database.
88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,479ea79411965f831a686923dc011fc3297ad884,deleted,1,"testObject = em.find(Class.forName(entityType.getType()), Long.parseLong(entityId));"
88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,479ea79411965f831a686923dc011fc3297ad884,deleted,1,} catch (ClassNotFoundException e) {
88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,479ea79411965f831a686923dc011fc3297ad884,deleted,1,throw ExceptionHelper.refineException(e);
88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,479ea79411965f831a686923dc011fc3297ad884,deleted,1,}
88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,479ea79411965f831a686923dc011fc3297ad884,deleted,1,"extensionManager.refineRetrieve(TranslationImpl.class, testObject, builder, criteria, root, restrictions);"
0c270c21f40dba51e181a55233e93a198f65240f,479ea79411965f831a686923dc011fc3297ad884,added,0,import org.broadleafcommerce.common.util.dao.DynamicDaoHelper;
0c270c21f40dba51e181a55233e93a198f65240f,479ea79411965f831a686923dc011fc3297ad884,added,0,import org.broadleafcommerce.common.util.dao.DynamicDaoHelperImpl;
0c270c21f40dba51e181a55233e93a198f65240f,479ea79411965f831a686923dc011fc3297ad884,added,0,import org.hibernate.SessionFactory;
0c270c21f40dba51e181a55233e93a198f65240f,479ea79411965f831a686923dc011fc3297ad884,added,0,import org.hibernate.ejb.criteria.CriteriaBuilderImpl;
0c270c21f40dba51e181a55233e93a198f65240f,479ea79411965f831a686923dc011fc3297ad884,added,0,DynamicDaoHelper helper = new DynamicDaoHelperImpl();
0c270c21f40dba51e181a55233e93a198f65240f,479ea79411965f831a686923dc011fc3297ad884,added,0,for (String code : codesToMatch) {
0c270c21f40dba51e181a55233e93a198f65240f,479ea79411965f831a686923dc011fc3297ad884,added,0,for (Translation templateVal : templateVals) {
0c270c21f40dba51e181a55233e93a198f65240f,479ea79411965f831a686923dc011fc3297ad884,added,0,public boolean isTemplateEnabled() {
0c270c21f40dba51e181a55233e93a198f65240f,479ea79411965f831a686923dc011fc3297ad884,added,0,return templateEnabled;
0c270c21f40dba51e181a55233e93a198f65240f,479ea79411965f831a686923dc011fc3297ad884,added,0,}
0c270c21f40dba51e181a55233e93a198f65240f,479ea79411965f831a686923dc011fc3297ad884,added,0,public void setTemplateEnabled(boolean templateEnabled) {
0c270c21f40dba51e181a55233e93a198f65240f,479ea79411965f831a686923dc011fc3297ad884,added,0,this.templateEnabled = templateEnabled;
0c270c21f40dba51e181a55233e93a198f65240f,479ea79411965f831a686923dc011fc3297ad884,added,0,SessionFactory sessionFactory = ((CriteriaBuilderImpl) em.getCriteriaBuilder()).getEntityManagerFactory().getSessionFactory();
0c270c21f40dba51e181a55233e93a198f65240f,479ea79411965f831a686923dc011fc3297ad884,added,0,"Class<?>[] entities = helper.getAllPolymorphicEntitiesFromCeiling(Class.forName(entityType.getType()), sessionFactory, true, true);"
0c270c21f40dba51e181a55233e93a198f65240f,479ea79411965f831a686923dc011fc3297ad884,added,0,"testObject = em.find(entities[entities.length-1], Long.parseLong(entityId));"
0c270c21f40dba51e181a55233e93a198f65240f,479ea79411965f831a686923dc011fc3297ad884,deleted,1,for (Translation templateVal : templateVals) {
0c270c21f40dba51e181a55233e93a198f65240f,479ea79411965f831a686923dc011fc3297ad884,deleted,1,for (String code : codesToMatch) {
0c270c21f40dba51e181a55233e93a198f65240f,479ea79411965f831a686923dc011fc3297ad884,deleted,1,"testObject = em.find(Class.forName(entityType.getType()), Long.parseLong(entityId));"
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,added,0,"boolean isSpecificOnly = localeCode.equals(localeCountryCode) && localeCode.contains(""_"");"
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,added,0,"boolean isGeneralOnly = localeCode.equals(localeCountryCode) && !localeCode.contains(""_"");"
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,added,0,List<StandardCacheItem> overrides;
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,added,0,if (isSpecificOnly) {
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,added,0,overrides = preCachedSparseOverrideService.findElements(specificCacheKey);
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,added,0,} else if (isGeneralOnly) {
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,added,0,overrides = preCachedSparseOverrideService.findElements(generalCacheKey);
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,added,0,} else {
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,added,0,"overrides = preCachedSparseOverrideService.findElements(specificCacheKey, generalCacheKey);"
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,added,0,}
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,added,0,if (isSpecificOnly && ItemStatus.NONE != overrides.get(0).getItemStatus()) {
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,added,0,} else if (isGeneralOnly && ItemStatus.NONE != overrides.get(0).getItemStatus()) {
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,added,0,StandardCacheItem generalTranslation = overrides.get(0);
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,added,0,if (!isSpecificOnly && !isGeneralOnly) {
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,added,0,if (ItemStatus.NONE != overrides.get(0).getItemStatus()) {
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,added,0,StandardCacheItem specificTranslation = overrides.get(0);
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,added,0,override.setSpecificItem(specificTranslation);
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,added,0,if (ItemStatus.NONE != overrides.get(1).getItemStatus()) {
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,added,0,StandardCacheItem generalTranslation = overrides.get(1);
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,added,0,override.setGeneralItem(generalTranslation);
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,deleted,1,"List<StandardCacheItem> overrides = preCachedSparseOverrideService.findElements(specificCacheKey, generalCacheKey);"
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,deleted,1,if (ItemStatus.NONE != overrides.get(0).getItemStatus()) {
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,deleted,1,}
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,deleted,1,if (ItemStatus.NONE != overrides.get(1).getItemStatus()) {
c275e85063611b9fe8fc21571adc28e517e1513e,479ea79411965f831a686923dc011fc3297ad884,deleted,1,StandardCacheItem generalTranslation = overrides.get(1);
67274fb15693a9630004fb7882dee843e1166def,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,"if (dao.countTranslationEntries(entityType, ResultType.TEMPLATE_CACHE) < translationSupport.getTemplateThresholdForFullCache()) {"
67274fb15693a9630004fb7882dee843e1166def,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,@Override
67274fb15693a9630004fb7882dee843e1166def,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,"public boolean validateTemplateKey(String standardCacheKey, String templateCacheKey) {"
67274fb15693a9630004fb7882dee843e1166def,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,return !standardCacheKey.equals(templateCacheKey);
67274fb15693a9630004fb7882dee843e1166def,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,}
67274fb15693a9630004fb7882dee843e1166def,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,deleted,1,"if (dao.countTranslationEntries(entityType, ResultType.TEMPLATE_CACHE) < translationSupport.getThresholdForFullCache()) {"
bd21a1f7d3bf742735f9e8d24622d3f5ad14ec9b,467b9bdcb8035c410221ec4d02c7f72b337993d8,added,0,Iterator<PromotableCandidateFulfillmentGroupOffer> fgOffersIterator = fgOffers.iterator();
bd21a1f7d3bf742735f9e8d24622d3f5ad14ec9b,467b9bdcb8035c410221ec4d02c7f72b337993d8,added,0,while (fgOffersIterator.hasNext()) {
bd21a1f7d3bf742735f9e8d24622d3f5ad14ec9b,467b9bdcb8035c410221ec4d02c7f72b337993d8,added,0,PromotableCandidateFulfillmentGroupOffer offer = fgOffersIterator.next();
bd21a1f7d3bf742735f9e8d24622d3f5ad14ec9b,467b9bdcb8035c410221ec4d02c7f72b337993d8,added,0,fgOffersIterator.remove();
bd21a1f7d3bf742735f9e8d24622d3f5ad14ec9b,467b9bdcb8035c410221ec4d02c7f72b337993d8,deleted,1,Iterator<PromotableCandidateFulfillmentGroupOffer> sgOffersIterator = fgOffers.iterator();
bd21a1f7d3bf742735f9e8d24622d3f5ad14ec9b,467b9bdcb8035c410221ec4d02c7f72b337993d8,deleted,1,while (sgOffersIterator.hasNext()) {
bd21a1f7d3bf742735f9e8d24622d3f5ad14ec9b,467b9bdcb8035c410221ec4d02c7f72b337993d8,deleted,1,PromotableCandidateFulfillmentGroupOffer offer = sgOffersIterator.next();
bd21a1f7d3bf742735f9e8d24622d3f5ad14ec9b,467b9bdcb8035c410221ec4d02c7f72b337993d8,deleted,1,sgOffersIterator.remove();
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,import org.broadleafcommerce.profile.core.domain.Customer;
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,import org.broadleafcommerce.profile.core.domain.CustomerPayment;
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,import org.broadleafcommerce.profile.core.service.CustomerPaymentService;
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,import org.broadleafcommerce.profile.web.core.CustomerState;
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,import org.springframework.beans.factory.annotation.Value;
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,import javax.annotation.Resource;
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,"@Value(""${validate.customer.owned.data:true}"")"
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,protected boolean validateCustomerOwnedData;
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,"@Resource(name = ""blCustomerPaymentService"")"
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,protected CustomerPaymentService customerPaymentService;
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,"public String viewCustomerPayment(HttpServletRequest request, Model model, Long customerPaymentId) {"
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,"//TODO: update model, add form"
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,"public String updateCustomerPayment(HttpServletRequest request, Model model, Long customerPaymentId) {"
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,"public String removeCustomerPayment(HttpServletRequest request, Model model, Long customerPaymentId) {"
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,protected void validateCustomerOwnedData(CustomerPayment customerPayment) {
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,if (validateCustomerOwnedData) {
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,Customer activeCustomer = CustomerState.getCustomer();
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,if (activeCustomer != null
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,&& !(activeCustomer.equals(customerPayment.getCustomer()))) {
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,"throw new SecurityException(""The active customer does not own the object that they are trying to view, edit, or remove."");"
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,}
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,if (activeCustomer == null && customerPayment.getCustomer() != null) {
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,import org.springframework.stereotype.Controller;
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,import org.springframework.web.bind.annotation.PathVariable;
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,import org.springframework.web.bind.annotation.RequestMapping;
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,import org.springframework.web.bind.annotation.RequestMethod;
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,@Controller
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"@RequestMapping(""/account/payments"")"
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,@RequestMapping(method = RequestMethod.GET)
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"@RequestMapping(value = ""/{customerPaymentId}/"", method = RequestMethod.GET)"
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"public String viewCustomerPayment(HttpServletRequest request, Model model, @PathVariable(""customerPaymentId"") Long customerPaymentId) {"
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,//TODO: update model
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"@RequestMapping(value = ""/{customerPaymentId}/"", method = RequestMethod.POST)"
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"public String updateCustomerPayment(HttpServletRequest request, Model model, @PathVariable(""customerPaymentId"") Long customerPaymentId) {"
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"@RequestMapping(value = ""/{customerPaymentId}/"", method = RequestMethod.POST, params=""removePayment=Remove"")"
9f556f2ab943118087f04da2b980f843c198a9e6,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"public String removeCustomerPayment(HttpServletRequest request, Model model, @PathVariable(""customerPaymentId"") Long customerPaymentId) {"
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,/*
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,* #%L
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,* BroadleafCommerce Framework Web
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,* %%
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,* Copyright (C) 2009 - 2017 Broadleaf Commerce
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"* Licensed under the Broadleaf Fair Use License Agreement, Version 1.0"
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"* (the ""Fair Use License"" located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)"
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,* unless the restrictions on use therein are violated and require payment to Broadleaf in which case
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"* the Broadleaf End User License Agreement (EULA), Version 1.1"
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"* (the ""Commercial License"" located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)"
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,* shall apply.
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,*
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"* Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the ""Custom License"")"
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,* between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,* #L%
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,*/
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,import org.springframework.validation.BindingResult;
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,Customer customer = CustomerState.getCustomer(request);
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,if(customer == null) {
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"throw new SecurityException(""Customer is not found but tried to access account page"");"
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,}
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,//TODO: add customerPayments to model
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"model.addAttribute(""savePaymentForm"", new SavePaymentForm());"
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"public String addCustomerPayment(HttpServletRequest request, Model model, SavePaymentForm form, BindingResult result) {"
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"public String updateCustomerPayment(HttpServletRequest request, Model model, SavePaymentForm form, BindingResult result, Long customerPaymentId) {"
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"public String removeCustomerPayment(HttpServletRequest request, Model model, SavePaymentForm form, Long customerPaymentId) {"
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"//TODO: update model, add form"
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,return getCustomerPaymentRedirect();
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,import org.broadleafcommerce.profile.core.domain.CustomerPayment;
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,import org.broadleafcommerce.profile.core.service.CustomerPaymentService;
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,import javax.annotation.Resource;
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"@Resource(name = ""blCustomerPaymentService"")"
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,protected CustomerPaymentService customerPaymentService;
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,//TODO: update model
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"public String updateCustomerPayment(HttpServletRequest request, Model model, Long customerPaymentId) {"
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"public String removeCustomerPayment(HttpServletRequest request, Model model, Long customerPaymentId) {"
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,protected void validateCustomerOwnedData(CustomerPayment customerPayment) {
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,if (validateCustomerOwnedData) {
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,Customer activeCustomer = CustomerState.getCustomer();
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,if (activeCustomer != null
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,&& !(activeCustomer.equals(customerPayment.getCustomer()))) {
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"throw new SecurityException(""The active customer does not own the object that they are trying to view, edit, or remove."");"
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,}
a29545718d7f3f9961df7a57dc64bcb9a5ffc882,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,if (activeCustomer == null && customerPayment.getCustomer() != null) {
4735b3273686f2c61424b4cc06142621ec4be011,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,"public String removeCustomerPayment(HttpServletRequest request, Model model, Long customerPaymentId) {"
4735b3273686f2c61424b4cc06142621ec4be011,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"public String viewCustomerPayment(HttpServletRequest request, Model model, Long customerPaymentId) {"
4735b3273686f2c61424b4cc06142621ec4be011,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"//TODO: update model, add form"
4735b3273686f2c61424b4cc06142621ec4be011,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,return getCustomerPaymentView();
4735b3273686f2c61424b4cc06142621ec4be011,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,}
4735b3273686f2c61424b4cc06142621ec4be011,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"public String updateCustomerPayment(HttpServletRequest request, Model model, SavePaymentForm form, BindingResult result, Long customerPaymentId) {"
4735b3273686f2c61424b4cc06142621ec4be011,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,return getCustomerPaymentRedirect();
4735b3273686f2c61424b4cc06142621ec4be011,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"public String removeCustomerPayment(HttpServletRequest request, Model model, SavePaymentForm form, Long customerPaymentId) {"
4735b3273686f2c61424b4cc06142621ec4be011,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"public String removeCustomerPayment(HttpServletRequest request, Model model, Long customerPaymentId) {"
4735b3273686f2c61424b4cc06142621ec4be011,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"public String viewCustomerPayment(HttpServletRequest request, Model model, Long customerPaymentId) {"
4735b3273686f2c61424b4cc06142621ec4be011,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"//TODO: update model, add form"
4735b3273686f2c61424b4cc06142621ec4be011,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,return getCustomerPaymentView();
4735b3273686f2c61424b4cc06142621ec4be011,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,}
4735b3273686f2c61424b4cc06142621ec4be011,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"public String updateCustomerPayment(HttpServletRequest request, Model model, SavePaymentForm form, BindingResult result, Long customerPaymentId) {"
4735b3273686f2c61424b4cc06142621ec4be011,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,return getCustomerPaymentRedirect();
4735b3273686f2c61424b4cc06142621ec4be011,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"public String removeCustomerPayment(HttpServletRequest request, Model model, SavePaymentForm form, Long customerPaymentId) {"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,import org.apache.commons.lang.StringUtils;
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,import org.broadleafcommerce.common.i18n.domain.ISOCountry;
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,import org.broadleafcommerce.common.i18n.service.ISOService;
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,import org.broadleafcommerce.core.web.checkout.validator.BillingInfoFormValidator;
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,import org.broadleafcommerce.profile.core.domain.*;
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,import org.broadleafcommerce.profile.core.service.*;
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,import org.springframework.web.bind.ServletRequestDataBinder;
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,import org.springframework.web.bind.annotation.InitBinder;
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,import java.beans.PropertyEditorSupport;
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"@Resource(name = ""blBillingInfoFormValidator"")"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,protected BillingInfoFormValidator billingInfoFormValidator;
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"@Resource(name = ""blAddressService"")"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,protected AddressService addressService;
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"@Resource(name = ""blCountryService"")"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,protected CountryService countryService;
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"@Resource(name = ""blStateService"")"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,protected StateService stateService;
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"@Resource(name = ""blISOService"")"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,protected ISOService isoService;
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"public String addCustomerPayment(HttpServletRequest request, Model model, SavePaymentForm paymentForm,"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"BindingResult paymentResult, BillingInfoForm billingForm, BindingResult billingResult) {"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,addressService.populateAddressISOCountrySub(billingForm.getAddress());
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"savePaymentValidator.validate(paymentForm, paymentResult);"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"billingInfoFormValidator.validate(billingForm, billingResult);"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,if ((billingForm.getAddress().getPhonePrimary() != null) &&
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,(StringUtils.isEmpty(billingForm.getAddress().getPhonePrimary().getPhoneNumber()))) {
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,billingForm.getAddress().setPhonePrimary(null);
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,}
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,if ((billingForm.getAddress().getPhoneSecondary() != null) &&
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,(StringUtils.isEmpty(billingForm.getAddress().getPhoneSecondary().getPhoneNumber()))) {
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,billingForm.getAddress().setPhoneSecondary(null);
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,if ((billingForm.getAddress().getPhoneFax() != null) &&
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,(StringUtils.isEmpty(billingForm.getAddress().getPhoneFax().getPhoneNumber()))) {
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,billingForm.getAddress().setPhoneFax(null);
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,if(paymentResult.hasErrors() || billingResult.hasErrors()) {
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,customerPayment.setIsDefault(paymentForm.isDefaultMethod());
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"customerPayment.getAdditionalFields().put(PaymentAdditionalFieldType.EXP_DATE.getType(), paymentForm.getExpiration());"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"customerPayment.getAdditionalFields().put(PaymentAdditionalFieldType.LAST_FOUR.getType(), paymentForm.getLastFourDigits());"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"customerPayment.getAdditionalFields().put(PaymentAdditionalFieldType.PAYMENT_NAME.getType(), paymentForm.getPaymentName());"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"customerPayment.getAdditionalFields().put(PaymentAdditionalFieldType.NAME_ON_CARD.getType(), paymentForm.getPersonName());"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"//customerPayment.getAdditionalFields().put(PaymentAdditionalFieldType.CARD_TYPE.getType(), paymentForm.getPersonName());"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,customerPayment.setBillingAddress(billingForm.getAddress());
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,@InitBinder
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"protected void initBinder(HttpServletRequest request, ServletRequestDataBinder binder) throws Exception {"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,/**
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,* @deprecated - address.setState() is deprecated in favor of ISO standardization
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,* This is here for legacy compatibility
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,*/
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"binder.registerCustomEditor(State.class, ""address.state"", new PropertyEditorSupport() {"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,@Override
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,public void setAsText(String text) {
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,if (StringUtils.isNotEmpty(text)) {
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,State state = stateService.findStateByAbbreviation(text);
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,setValue(state);
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,} else {
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,setValue(null);
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,});
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,* @deprecated - address.setCountry() is deprecated in favor of ISO standardization
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"binder.registerCustomEditor(Country.class, ""address.country"", new PropertyEditorSupport() {"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,Country country = countryService.findCountryByAbbreviation(text);
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,setValue(country);
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"binder.registerCustomEditor(ISOCountry.class, ""address.isoCountryAlpha2"", new PropertyEditorSupport() {"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,ISOCountry isoCountry = isoService.findISOCountryByAlpha2Code(text);
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,setValue(isoCountry);
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,}else {
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"binder.registerCustomEditor(Phone.class, ""address.phonePrimary"", new PropertyEditorSupport() {"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,Phone phone = new PhoneImpl();
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,phone.setPhoneNumber(text);
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,setValue(phone);
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"binder.registerCustomEditor(Phone.class, ""address.phoneSecondary"", new PropertyEditorSupport() {"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"binder.registerCustomEditor(Phone.class, ""address.phoneFax"", new PropertyEditorSupport() {"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,import org.broadleafcommerce.profile.core.domain.Customer;
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,import org.broadleafcommerce.profile.core.domain.CustomerAddress;
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,import org.broadleafcommerce.profile.core.domain.CustomerPayment;
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,import org.broadleafcommerce.profile.core.service.CustomerAddressService;
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,import org.broadleafcommerce.profile.core.service.CustomerPaymentService;
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"public String addCustomerPayment(HttpServletRequest request, Model model, SavePaymentForm form, BindingResult result) {"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"savePaymentValidator.validate(form, result);"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,if(result.hasErrors()) {
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,customerPayment.setIsDefault(form.isDefaultMethod());
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"customerPayment.getAdditionalFields().put(PaymentAdditionalFieldType.EXP_DATE.getType(), form.getExpiration());"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"customerPayment.getAdditionalFields().put(PaymentAdditionalFieldType.LAST_FOUR.getType(), form.getLastFourDigits());"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"customerPayment.getAdditionalFields().put(PaymentAdditionalFieldType.PAYMENT_NAME.getType(), form.getPaymentName());"
131451c5abf018ea3c265b6ef08d0a8403e6b549,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"customerPayment.getAdditionalFields().put(PaymentAdditionalFieldType.NAME_ON_CARD.getType(), form.getPersonName());"
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,import org.broadleafcommerce.core.web.service.InitBinderService;
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,import org.broadleafcommerce.profile.core.domain.Customer;
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,import org.broadleafcommerce.profile.core.domain.CustomerAddress;
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,import org.broadleafcommerce.profile.core.domain.CustomerPayment;
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,import org.broadleafcommerce.profile.core.service.AddressService;
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,import org.broadleafcommerce.profile.core.service.CustomerAddressService;
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,import org.broadleafcommerce.profile.core.service.CustomerPaymentService;
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,import javax.annotation.Resource;
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,import javax.servlet.http.HttpServletRequest;
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,"@Resource(name = ""blInitBinderService"")"
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,protected InitBinderService initBinderService;
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,initBinderService.configAddressInitBinder(binder);
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,import org.broadleafcommerce.common.i18n.domain.ISOCountry;
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,import org.broadleafcommerce.common.i18n.service.ISOService;
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,import org.broadleafcommerce.profile.core.domain.*;
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,import org.broadleafcommerce.profile.core.service.*;
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,import javax.annotation.Resource;
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,import javax.servlet.http.HttpServletRequest;
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,import java.beans.PropertyEditorSupport;
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"@Resource(name = ""blCountryService"")"
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,protected CountryService countryService;
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"@Resource(name = ""blStateService"")"
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,protected StateService stateService;
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"@Resource(name = ""blISOService"")"
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,protected ISOService isoService;
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,/**
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,* @deprecated - address.setState() is deprecated in favor of ISO standardization
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,* This is here for legacy compatibility
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,*/
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"binder.registerCustomEditor(State.class, ""address.state"", new PropertyEditorSupport() {"
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,@Override
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,public void setAsText(String text) {
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,if (StringUtils.isNotEmpty(text)) {
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,State state = stateService.findStateByAbbreviation(text);
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,setValue(state);
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,} else {
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,setValue(null);
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,}
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,});
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,* @deprecated - address.setCountry() is deprecated in favor of ISO standardization
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"binder.registerCustomEditor(Country.class, ""address.country"", new PropertyEditorSupport() {"
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,Country country = countryService.findCountryByAbbreviation(text);
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,setValue(country);
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"binder.registerCustomEditor(ISOCountry.class, ""address.isoCountryAlpha2"", new PropertyEditorSupport() {"
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,ISOCountry isoCountry = isoService.findISOCountryByAlpha2Code(text);
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,setValue(isoCountry);
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,}else {
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"binder.registerCustomEditor(Phone.class, ""address.phonePrimary"", new PropertyEditorSupport() {"
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,Phone phone = new PhoneImpl();
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,phone.setPhoneNumber(text);
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,setValue(phone);
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"binder.registerCustomEditor(Phone.class, ""address.phoneSecondary"", new PropertyEditorSupport() {"
cb13f4351c50bd041e8da410a53cb9f9e74be524,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"binder.registerCustomEditor(Phone.class, ""address.phoneFax"", new PropertyEditorSupport() {"
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,import org.broadleafcommerce.common.extension.ResultType;
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,import org.broadleafcommerce.common.i18n.dao.TranslationDao;
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,import org.broadleafcommerce.common.site.domain.Site;
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,import org.broadleafcommerce.common.web.BroadleafRequestContext;
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,* This strategy also works best when there are few standard sites with isolated values (i.e. the value was created in the standard
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,* site and was not inherited from a profile or catalog). This is because the strategy can utilize an optimized template
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,* query that is portable across sites if it doesn't have to take into account the standard site. The strategy uses
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,"* {@link OverridePreCacheService#isActiveIsolatedSiteForType(Long, String)} to figure out this state."
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,* </p>
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,"@Resource(name = ""blTranslationDao"")"
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,protected TranslationDao dao;
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,* This value is meaningless if the current standard site is found to contain active isolated values for translations.
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,* Review the documentation in com.broadleafcommerce.tenant.service.cache.SparseOverridePreCacheServiceImpl for more information.
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,if (preCachedSparseOverrideService.isActiveForType(Translation.class.getName())) {
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,Site currentSite = BroadleafRequestContext.getBroadleafRequestContext().getNonPersistentSite();
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,boolean isIsolatedActive = false;
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,if (currentSite != null) {
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,"isIsolatedActive = preCachedSparseOverrideService.isActiveIsolatedSiteForType(currentSite.getId(), TranslationImpl.class.getName());"
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,if (isIsolatedActive || templateEnabled) {
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,override = new LocalePair();
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,List<Translation> templateVals;
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,if (!isIsolatedActive) {
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,"templateVals = getTemplateTranslations(entityType, entityId, property, localeCode);"
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,} else {
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,"//We need to include the standard site catalog in the query, so don't try to use an optimized template query"
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,templateVals = new ArrayList<Translation>();
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,"Translation translation = dao.readTranslation(entityType, entityId, property, localeCode, localeCountryCode, ResultType.CATALOG_ONLY);"
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,if (translation != null) {
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,templateVals.add(translation);
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,List<String> codesToMatch = new ArrayList<String>();
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,if (specificPropertyKey.endsWith(localeCountryCode) && generalPropertyKey.endsWith(localeCountryCode)) {
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,codesToMatch.add(localeCountryCode);
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,} else if (specificPropertyKey.endsWith(localeCode) && generalPropertyKey.endsWith(localeCode)) {
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,codesToMatch.add(localeCode);
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,}
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,for (String code : codesToMatch) {
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,for (Translation templateVal : templateVals) {
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,if (templateVal.getLocaleCode().equals(code)) {
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,StandardCacheItem cacheItem = new StandardCacheItem();
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,cacheItem.setItemStatus(ItemStatus.NORMAL);
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,cacheItem.setCacheItem(templateVal);
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,override.setSpecificItem(cacheItem);
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,break;
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,added,0,if (override.getSpecificItem() != null) {
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,deleted,1,if (preCachedSparseOverrideService.isActiveForType(Translation.class.getName()) && templateEnabled) {
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,deleted,1,override = new LocalePair();
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,deleted,1,"List<Translation> templateVals = getTemplateTranslations(entityType, entityId, property, localeCode);"
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,deleted,1,List<String> codesToMatch = new ArrayList<String>();
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,deleted,1,if (specificPropertyKey.endsWith(localeCountryCode) && generalPropertyKey.endsWith(localeCountryCode)) {
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,deleted,1,codesToMatch.add(localeCountryCode);
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,deleted,1,} else if (specificPropertyKey.endsWith(localeCode) && generalPropertyKey.endsWith(localeCode)) {
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,deleted,1,codesToMatch.add(localeCode);
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,deleted,1,} else {
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,deleted,1,for (String code : codesToMatch) {
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,deleted,1,for (Translation templateVal : templateVals) {
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,deleted,1,if (templateVal.getLocaleCode().equals(code)) {
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,deleted,1,StandardCacheItem cacheItem = new StandardCacheItem();
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,deleted,1,cacheItem.setItemStatus(ItemStatus.NORMAL);
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,deleted,1,cacheItem.setCacheItem(templateVal);
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,deleted,1,override.setSpecificItem(cacheItem);
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,deleted,1,break;
070f708bd53d83dd1d71c3ea8b9704588b48aca7,479ea79411965f831a686923dc011fc3297ad884,deleted,1,if (override.getSpecificItem() != null) {
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,import org.broadleafcommerce.core.web.controller.account.validator.SavedPaymentFormValidator;
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,import org.broadleafcommerce.core.web.payment.service.SavedPaymentService;
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,"* This is the page controller for adding, updating, and deleting a customer's saved payments."
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,* @author Chris Kittrell (ckittrell)
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,"@Resource(name = ""blSavedPaymentService"")"
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,protected SavedPaymentService savedPaymentService;
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,"@Resource(name = ""blSavedPaymentFormValidator"")"
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,protected SavedPaymentFormValidator savedPaymentFormValidator;
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,"public String viewCustomerPayments(HttpServletRequest request, Model model, SavedPaymentForm savedPaymentForm) {"
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,if (customer == null) {
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,List<CustomerAddress> customerAddresses = customerAddressService.readActiveCustomerAddressesByCustomerId(customer.getId());
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,"model.addAttribute(""customerAddresses"", customerAddresses);"
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,"public String addCustomerPayment(HttpServletRequest request, Model model,"
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,"SavedPaymentForm savedPaymentForm, BindingResult bindingResult) {"
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,addressService.populateAddressISOCountrySub(savedPaymentForm.getAddress());
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,"savedPaymentFormValidator.validate(savedPaymentForm, bindingResult);"
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,if (!bindingResult.hasErrors()) {
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,if ((savedPaymentForm.getAddress().getPhonePrimary() != null) &&
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,(StringUtils.isEmpty(savedPaymentForm.getAddress().getPhonePrimary().getPhoneNumber()))) {
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,savedPaymentForm.getAddress().setPhonePrimary(null);
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,}
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,if ((savedPaymentForm.getAddress().getPhoneSecondary() != null) &&
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,(StringUtils.isEmpty(savedPaymentForm.getAddress().getPhoneSecondary().getPhoneNumber()))) {
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,savedPaymentForm.getAddress().setPhoneSecondary(null);
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,if ((savedPaymentForm.getAddress().getPhoneFax() != null) &&
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,(StringUtils.isEmpty(savedPaymentForm.getAddress().getPhoneFax().getPhoneNumber()))) {
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,savedPaymentForm.getAddress().setPhoneFax(null);
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,Customer customer = CustomerState.getCustomer();
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,"savedPaymentService.addSavedPayment(customer, savedPaymentForm);"
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,return getCustomerPaymentView();
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,if (customerPayment == null) {
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,added,0,"throw new IllegalArgumentException(""Requested customer payment does not exist."");"
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,import org.broadleafcommerce.common.payment.PaymentAdditionalFieldType;
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,import org.broadleafcommerce.core.web.checkout.validator.BillingInfoFormValidator;
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,import org.broadleafcommerce.core.web.controller.account.validator.SavePaymentValidator;
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,import org.springframework.beans.factory.annotation.Value;
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,import java.security.InvalidParameterException;
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"* This is the page controller for adding, updating, and deleting saved payment information."
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"@Value(""${validate.customer.owned.data:true}"")"
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,protected boolean validateCustomerOwnedData;
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"@Resource(name = ""blSavePaymentValidator"")"
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,protected SavePaymentValidator savePaymentValidator;
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"@Resource(name = ""blBillingInfoFormValidator"")"
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,protected BillingInfoFormValidator billingInfoFormValidator;
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"public String viewCustomerPayments(HttpServletRequest request, Model model) {"
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,if(customer == null) {
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,SavePaymentForm savePaymentForm = new SavePaymentForm();
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,savePaymentForm.setDefaultMethod(savedPaymentList.isEmpty());
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"model.addAttribute(""savePaymentForm"", savePaymentForm);"
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,List<CustomerAddress> customerAddresses = customerAddressService.readActiveCustomerAddressesByCustomerId(CustomerState.getCustomer().getId());
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"model.addAttribute(""customerAddresses"", customerAddresses);"
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"public String addCustomerPayment(HttpServletRequest request, Model model, SavePaymentForm paymentForm,"
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"BindingResult paymentResult, BillingInfoForm billingForm, BindingResult billingResult) {"
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,Customer customer = CustomerState.getCustomer();
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,addressService.populateAddressISOCountrySub(billingForm.getAddress());
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"savePaymentValidator.validate(paymentForm, paymentResult);"
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"billingInfoFormValidator.validate(billingForm, billingResult);"
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,if ((billingForm.getAddress().getPhonePrimary() != null) &&
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,(StringUtils.isEmpty(billingForm.getAddress().getPhonePrimary().getPhoneNumber()))) {
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,billingForm.getAddress().setPhonePrimary(null);
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,}
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,if ((billingForm.getAddress().getPhoneSecondary() != null) &&
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,(StringUtils.isEmpty(billingForm.getAddress().getPhoneSecondary().getPhoneNumber()))) {
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,billingForm.getAddress().setPhoneSecondary(null);
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,if ((billingForm.getAddress().getPhoneFax() != null) &&
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,(StringUtils.isEmpty(billingForm.getAddress().getPhoneFax().getPhoneNumber()))) {
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,billingForm.getAddress().setPhoneFax(null);
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,if(paymentResult.hasErrors() || billingResult.hasErrors()) {
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,return getCustomerPaymentRedirect();
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,CustomerPayment customerPayment = customerPaymentService.create();
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,customerPayment.setCustomer(customer);
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,customerPayment.setIsDefault(paymentForm.isDefaultMethod());
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"customerPayment.getAdditionalFields().put(PaymentAdditionalFieldType.EXP_DATE.getType(), paymentForm.getExpiration());"
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"customerPayment.getAdditionalFields().put(PaymentAdditionalFieldType.LAST_FOUR.getType(), paymentForm.getLastFourDigits());"
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"customerPayment.getAdditionalFields().put(PaymentAdditionalFieldType.PAYMENT_NAME.getType(), paymentForm.getPaymentName());"
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"customerPayment.getAdditionalFields().put(PaymentAdditionalFieldType.NAME_ON_CARD.getType(), paymentForm.getPersonName());"
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"//customerPayment.getAdditionalFields().put(PaymentAdditionalFieldType.CARD_TYPE.getType(), paymentForm.getPersonName());"
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,customerPayment.setBillingAddress(billingForm.getAddress());
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,//        customerPayment.setToken();
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,customerPaymentService.saveCustomerPayment(customerPayment);
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,if(customerPayment == null) {
38f534e861b6faaf724012f027707927b0afc465,f1144e3fe313ede002eccf80e175bc4c8b949f4a,deleted,1,"throw new InvalidParameterException(""Requested customer payment does not exist."");"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,import org.broadleafcommerce.core.web.controller.account.validator.SavedPaymentFormValidator;
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,import org.broadleafcommerce.core.web.payment.service.SavedPaymentService;
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"* This is the page controller for adding, updating, and deleting a customer's saved payments."
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,* @author Chris Kittrell (ckittrell)
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"@Resource(name = ""blSavedPaymentService"")"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,protected SavedPaymentService savedPaymentService;
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"@Resource(name = ""blSavedPaymentFormValidator"")"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,protected SavedPaymentFormValidator savedPaymentFormValidator;
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"public String viewCustomerPayments(HttpServletRequest request, Model model, SavedPaymentForm savedPaymentForm) {"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,if (customer == null) {
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,List<CustomerAddress> customerAddresses = customerAddressService.readActiveCustomerAddressesByCustomerId(customer.getId());
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"model.addAttribute(""customerAddresses"", customerAddresses);"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"public String addCustomerPayment(HttpServletRequest request, Model model,"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"SavedPaymentForm savedPaymentForm, BindingResult bindingResult) {"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,addressService.populateAddressISOCountrySub(savedPaymentForm.getAddress());
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"savedPaymentFormValidator.validate(savedPaymentForm, bindingResult);"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,if (!bindingResult.hasErrors()) {
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,if ((savedPaymentForm.getAddress().getPhonePrimary() != null) &&
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,(StringUtils.isEmpty(savedPaymentForm.getAddress().getPhonePrimary().getPhoneNumber()))) {
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,savedPaymentForm.getAddress().setPhonePrimary(null);
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,}
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,if ((savedPaymentForm.getAddress().getPhoneSecondary() != null) &&
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,(StringUtils.isEmpty(savedPaymentForm.getAddress().getPhoneSecondary().getPhoneNumber()))) {
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,savedPaymentForm.getAddress().setPhoneSecondary(null);
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,if ((savedPaymentForm.getAddress().getPhoneFax() != null) &&
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,(StringUtils.isEmpty(savedPaymentForm.getAddress().getPhoneFax().getPhoneNumber()))) {
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,savedPaymentForm.getAddress().setPhoneFax(null);
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,Customer customer = CustomerState.getCustomer();
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"savedPaymentService.addSavedPayment(customer, savedPaymentForm);"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,return getCustomerPaymentView();
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,if (customerPayment == null) {
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,added,0,"throw new IllegalArgumentException(""Requested customer payment does not exist."");"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,import org.broadleafcommerce.common.payment.PaymentAdditionalFieldType;
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,import org.broadleafcommerce.core.web.checkout.validator.BillingInfoFormValidator;
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,import org.broadleafcommerce.core.web.controller.account.validator.SavePaymentValidator;
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,import org.springframework.beans.factory.annotation.Value;
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,import java.security.InvalidParameterException;
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"* This is the page controller for adding, updating, and deleting saved payment information."
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"@Value(""${validate.customer.owned.data:true}"")"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,protected boolean validateCustomerOwnedData;
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"@Resource(name = ""blSavePaymentValidator"")"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,protected SavePaymentValidator savePaymentValidator;
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"@Resource(name = ""blBillingInfoFormValidator"")"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,protected BillingInfoFormValidator billingInfoFormValidator;
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"public String viewCustomerPayments(HttpServletRequest request, Model model) {"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,if(customer == null) {
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,SavePaymentForm savePaymentForm = new SavePaymentForm();
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,savePaymentForm.setDefaultMethod(savedPaymentList.isEmpty());
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"model.addAttribute(""savePaymentForm"", savePaymentForm);"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,List<CustomerAddress> customerAddresses = customerAddressService.readActiveCustomerAddressesByCustomerId(CustomerState.getCustomer().getId());
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"model.addAttribute(""customerAddresses"", customerAddresses);"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"public String addCustomerPayment(HttpServletRequest request, Model model, SavePaymentForm paymentForm,"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"BindingResult paymentResult, BillingInfoForm billingForm, BindingResult billingResult) {"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,Customer customer = CustomerState.getCustomer();
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,addressService.populateAddressISOCountrySub(billingForm.getAddress());
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"savePaymentValidator.validate(paymentForm, paymentResult);"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"billingInfoFormValidator.validate(billingForm, billingResult);"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,if ((billingForm.getAddress().getPhonePrimary() != null) &&
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,(StringUtils.isEmpty(billingForm.getAddress().getPhonePrimary().getPhoneNumber()))) {
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,billingForm.getAddress().setPhonePrimary(null);
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,}
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,if ((billingForm.getAddress().getPhoneSecondary() != null) &&
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,(StringUtils.isEmpty(billingForm.getAddress().getPhoneSecondary().getPhoneNumber()))) {
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,billingForm.getAddress().setPhoneSecondary(null);
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,if ((billingForm.getAddress().getPhoneFax() != null) &&
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,(StringUtils.isEmpty(billingForm.getAddress().getPhoneFax().getPhoneNumber()))) {
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,billingForm.getAddress().setPhoneFax(null);
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,if(paymentResult.hasErrors() || billingResult.hasErrors()) {
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,return getCustomerPaymentRedirect();
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,CustomerPayment customerPayment = customerPaymentService.create();
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,customerPayment.setCustomer(customer);
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,customerPayment.setIsDefault(paymentForm.isDefaultMethod());
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"customerPayment.getAdditionalFields().put(PaymentAdditionalFieldType.EXP_DATE.getType(), paymentForm.getExpiration());"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"customerPayment.getAdditionalFields().put(PaymentAdditionalFieldType.LAST_FOUR.getType(), paymentForm.getLastFourDigits());"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"customerPayment.getAdditionalFields().put(PaymentAdditionalFieldType.PAYMENT_NAME.getType(), paymentForm.getPaymentName());"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"customerPayment.getAdditionalFields().put(PaymentAdditionalFieldType.NAME_ON_CARD.getType(), paymentForm.getPersonName());"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"//customerPayment.getAdditionalFields().put(PaymentAdditionalFieldType.CARD_TYPE.getType(), paymentForm.getPersonName());"
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,customerPayment.setBillingAddress(billingForm.getAddress());
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,//        customerPayment.setToken();
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,customerPaymentService.saveCustomerPayment(customerPayment);
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,if(customerPayment == null) {
38f534e861b6faaf724012f027707927b0afc465,9f556f2ab943118087f04da2b980f843c198a9e6,deleted,1,"throw new InvalidParameterException(""Requested customer payment does not exist."");"
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,/**
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,"* Whether or not to restrict the template search to the catalog/site of an associated item. For example, restrict"
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,"* the translation of name for a Sku to the catalog of the Sku. Or, restrict"
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,* the translation of StructuredContent property to the site discriminator of the StructuredContent.
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,* </p>
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,* This value is false by default. Change the 'precached.sparse.override.translation.template.search.restrict.association' to
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,* true to enable.
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,*/
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,"@Value(""${precached.sparse.override.translation.template.search.restrict.association:false}"")"
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,protected boolean restrictAssociation = false;
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,public boolean isRestrictAssociation() {
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,return restrictAssociation;
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,}
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,public void setRestrictAssociation(boolean restrictAssociation) {
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,this.restrictAssociation = restrictAssociation;
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,Object testObject = null;
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,if (restrictAssociation) {
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,try {
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,Class<?> type = Class.forName(entityType.getType());
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,SessionFactory sessionFactory = ((CriteriaBuilderImpl) em.getCriteriaBuilder()).getEntityManagerFactory().getSessionFactory();
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,"Class<?>[] entities = helper.getAllPolymorphicEntitiesFromCeiling(type, sessionFactory, true, true);"
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,//This should already be in level 1 cache and this should not cause a hit to the database.
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,"testObject = em.find(entities[entities.length - 1], Long.parseLong(entityId));"
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,} catch (ClassNotFoundException e) {
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,added,0,throw ExceptionHelper.refineException(e);
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,deleted,1,Object testObject;
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,deleted,1,try {
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,deleted,1,SessionFactory sessionFactory = ((CriteriaBuilderImpl) em.getCriteriaBuilder()).getEntityManagerFactory().getSessionFactory();
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,deleted,1,"Class<?>[] entities = helper.getAllPolymorphicEntitiesFromCeiling(Class.forName(entityType.getType()), sessionFactory, true, true);"
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,deleted,1,//This should already be in level 1 cache and this should not cause a hit to the database.
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,deleted,1,"testObject = em.find(entities[entities.length-1], Long.parseLong(entityId));"
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,deleted,1,} catch (ClassNotFoundException e) {
8647da6de98cf211a3be2e0032ba2d48a89a24c5,479ea79411965f831a686923dc011fc3297ad884,deleted,1,throw ExceptionHelper.refineException(e);
41720a2cb8fca12ebe7744d50f56ad309ad0885d,479ea79411965f831a686923dc011fc3297ad884,added,0,List response = query.getResultList();
41720a2cb8fca12ebe7744d50f56ad309ad0885d,479ea79411965f831a686923dc011fc3297ad884,added,0,if (extensionManager != null) {
41720a2cb8fca12ebe7744d50f56ad309ad0885d,479ea79411965f831a686923dc011fc3297ad884,added,0,"extensionManager.filterResults(TranslationImpl.class, testObject, response);"
41720a2cb8fca12ebe7744d50f56ad309ad0885d,479ea79411965f831a686923dc011fc3297ad884,added,0,}
41720a2cb8fca12ebe7744d50f56ad309ad0885d,479ea79411965f831a686923dc011fc3297ad884,added,0,return response;
41720a2cb8fca12ebe7744d50f56ad309ad0885d,479ea79411965f831a686923dc011fc3297ad884,deleted,1,return query.getResultList();
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,import org.broadleafcommerce.core.payment.service.OrderPaymentService;
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,import org.broadleafcommerce.core.web.checkout.model.PaymentInfoForm;
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,import org.broadleafcommerce.core.web.order.service.CartStateService;
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,import org.broadleafcommerce.profile.core.domain.CustomerPayment;
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,import org.broadleafcommerce.profile.core.service.CustomerPaymentService;
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,/**
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,* @author Chris Kittrell (ckittrell)
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,*/
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,"@Resource(name = ""blCustomerPaymentService"")"
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,protected CustomerPaymentService customerPaymentService;
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,"@Resource(name = ""blOrderPaymentService"")"
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,protected OrderPaymentService orderPaymentService;
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,"@Resource(name = ""blCartStateService"")"
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,protected CartStateService cartStateService;
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,Address orderPaymentBillingAddress = getAddressFromCCOrderPayment(cart);
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,billingInfoForm.setAddress(orderPaymentBillingAddress);
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,"boolean shippingAddressUsedForBilling = addressesContentsAreEqual(shippingInfoForm.getAddress(), billingInfoForm.getAddress());"
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,billingInfoForm.setUseShippingAddress(shippingAddressUsedForBilling);
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,return billingInfoForm;
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,}
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,@Override
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,"public PaymentInfoForm prePopulatePaymentInfoForm(PaymentInfoForm paymentInfoForm, ShippingInfoForm shippingInfoForm, Order cart) {"
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,"String emailAddress = getKnownEmailAddress(cart, customer);"
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,paymentInfoForm.setEmailAddress(emailAddress);
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,if (orderPaymentBillingAddress != null) {
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,paymentInfoForm.setAddress(orderPaymentBillingAddress);
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,CustomerPayment customerPaymentUsedForOrder = getCustomerPaymentUsedForOrder();
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,Long customerPaymentId = (customerPaymentUsedForOrder == null) ? null : customerPaymentUsedForOrder.getId();
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,paymentInfoForm.setCustomerPaymentId(customerPaymentId);
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,boolean useCustomerPaymentDefaultValue = getUseCustomerPaymentDefaultValue(customerPaymentUsedForOrder);
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,paymentInfoForm.setUseCustomerPayment(useCustomerPaymentDefaultValue);
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,"boolean useShippingAddressDefaultValue = getUseShippingAddressDefaultValue(customerPaymentUsedForOrder, paymentInfoForm, shippingInfoForm);"
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,paymentInfoForm.setUseShippingAddress(useShippingAddressDefaultValue);
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,boolean saveNewPaymentDefaultValue = getSaveNewPaymentDefaultValue();
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,paymentInfoForm.setSaveNewPayment(saveNewPaymentDefaultValue);
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,return paymentInfoForm;
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,* A temporary credit card {@link OrderPayment} will only be added to the cart if the customer has opted out
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,*  of saving their credit card for future payments.
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,* @param customerPaymentUsedForOrder
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,protected boolean getUseCustomerPaymentDefaultValue(CustomerPayment customerPaymentUsedForOrder) {
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,boolean orderUsingCustomerPayment = (customerPaymentUsedForOrder != null);
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,boolean cartHasTemporaryCreditCard = cartStateService.cartHasTemporaryCreditCard();
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,return orderUsingCustomerPayment || !cartHasTemporaryCreditCard;
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,"protected String getKnownEmailAddress(Order cart, Customer customer) {"
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,String emailAddress = null;
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,emailAddress = cart.getEmailAddress();
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,emailAddress = customer.getEmailAddress();
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,return emailAddress;
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,protected Address getAddressFromCCOrderPayment(Order cart) {
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,List<OrderPayment> orderPayments = orderPaymentService.readPaymentsForOrder(cart);
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,if (payment.isActive() && isCreditCardPaymentType && paymentHasBillingAddress) {
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,return payment.getBillingAddress();
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,return null;
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,protected CustomerPayment getCustomerPaymentUsedForOrder() {
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,Customer customer = CustomerState.getCustomer();
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,List<CustomerPayment> customerPayments = customerPaymentService.readCustomerPaymentsByCustomerId(customer.getId());
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,for (CustomerPayment customerPayment : customerPayments) {
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,if (cartStateService.cartHasCreditCardPaymentWithSameToken(customerPayment.getPaymentToken())) {
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,return customerPayment;
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,protected boolean getSaveNewPaymentDefaultValue() {
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,boolean customerOptedOutOfSavingCard = !cartStateService.cartHasTemporaryCreditCard();
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,return customerOptedOutOfSavingCard;
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,* @param paymentInfoForm
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,* @param shippingInfoForm
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,"protected boolean getUseShippingAddressDefaultValue(CustomerPayment customerPaymentUsedForOrder, PaymentInfoForm paymentInfoForm,"
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,ShippingInfoForm shippingInfoForm) {
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,boolean orderIsNotUsingCustomerPayment = (customerPaymentUsedForOrder == null);
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,"boolean shippingAddressEqualToBillingAddress = addressesContentsAreEqual(paymentInfoForm.getAddress(), shippingInfoForm.getAddress());"
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,return orderIsNotUsingCustomerPayment && shippingAddressEqualToBillingAddress;
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,"public void prePopulateInfoForms(ShippingInfoForm shippingInfoForm, PaymentInfoForm paymentInfoForm) {"
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,"prePopulatePaymentInfoForm(paymentInfoForm, shippingInfoForm, cart);"
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,"public void determineIfSavedAddressIsSelected(Model model, ShippingInfoForm shippingInfoForm, PaymentInfoForm paymentInfoForm) {"
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,"if (addressesContentsAreEqual(paymentInfoForm.getAddress(), customerAddress.getAddress())) {"
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,added,0,"Objects.equals(address2.getIsoCountrySubdivision(), address1.getIsoCountrySubdivision());"
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,deleted,1,billingInfoForm.setEmailAddress(cart.getEmailAddress());
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,deleted,1,billingInfoForm.setEmailAddress(customer.getEmailAddress());
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,deleted,1,List<OrderPayment> orderPayments = cart.getPayments();
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,deleted,1,if (isCreditCardPaymentType && paymentHasBillingAddress) {
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,deleted,1,billingInfoForm.setAddress(payment.getBillingAddress());
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,deleted,1,"boolean shippingAddressUsedForBilling = addressesContentsAreEqual(shippingInfoForm.getAddress(), billingInfoForm.getAddress());"
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,deleted,1,billingInfoForm.setUseShippingAddress(shippingAddressUsedForBilling);
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,deleted,1,return billingInfoForm;
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,deleted,1,"public void prePopulateInfoForms(ShippingInfoForm shippingInfoForm, BillingInfoForm billingInfoForm) {"
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,deleted,1,"prePopulateBillingInfoForm(billingInfoForm, shippingInfoForm, cart);"
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,deleted,1,"public void determineIfSavedAddressIsSelected(Model model, ShippingInfoForm shippingInfoForm, BillingInfoForm billingInfoForm) {"
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,deleted,1,"if (addressesContentsAreEqual(billingInfoForm.getAddress(), customerAddress.getAddress())) {"
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,deleted,1,"Objects.equals(address2.getIsoCountrySubdivision(), address1.getIsoCountrySubdivision()) &&"
45a80ec06d86c9050993f76741638733b6cef7e9,bebdc69c033f1f85f128978d971b82606288f34b,deleted,1,"Objects.equals(address2.getPhonePrimary().getPhoneNumber(), address1.getPhonePrimary().getPhoneNumber());"
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"appendExpression(phrase, fieldService, parentDTO, myCriteriaList);"
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if (!myCriteriaList.isEmpty()) {
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"public void appendExpression(String phrase, RuleBuilderFieldService fieldService, DataDTO parentDTO,"
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"postProcessCriteria(parentDTO, myCriteriaList, expressionDTO, type);"
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"ExpressionDTO temp, SupportedFieldType type) {"
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,int lstIdx = myCriteriaList.size() - 1;
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,ExpressionDTO prevExpression = lstIdx != -1 ? myCriteriaList.get(lstIdx) : null;
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,boolean sameExpressionId = prevExpression != null && temp.getId().equals(prevExpression.getId());
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,sameExpressionId &&
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,prevExpression.getOperator().equals(BLCOperator.GREATER_THAN.name()) &&
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,prevExpression.setOperator(BLCOperator.BETWEEN.name());
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,String start = prevExpression.getValue();
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,String end = temp.getValue();
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"start = ""\"""" + start + ""\"""" ;"
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"end = ""\"""" + end + ""\"""";"
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"prevExpression.setValue(""["" + start + "","" + end + ""]"");"
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,parentDTO.getRules().add(myCriteriaList.remove(lstIdx));
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,prevExpression.getOperator().equals(BLCOperator.GREATER_OR_EQUAL.name()) &&
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,prevExpression.setOperator(BLCOperator.BETWEEN_INCLUSIVE.name());
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,int j = 0;
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"appendExpression(phrase, fieldService, j, parentDTO, myCriteriaList);"
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,j++;
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,if (myCriteriaList.size() > 0) {
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"public void appendExpression(String phrase, RuleBuilderFieldService fieldService, int count, DataDTO parentDTO,"
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"postProcessCriteria(parentDTO, myCriteriaList, count, expressionDTO, type);"
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"int count, ExpressionDTO temp, SupportedFieldType type) {"
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,count > 0 &&
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,temp.getId().equals(myCriteriaList.get(count - 1).getId()) &&
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,myCriteriaList.get(count - 1).getOperator().equals(BLCOperator.GREATER_THAN.name()) &&
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,myCriteriaList.get(count-1).setOperator(BLCOperator.BETWEEN.name());
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,String start;
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,String end;
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"start = ""\"""" + myCriteriaList.get(count-1).getValue() + ""\"""" ;"
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"end = ""\"""" + temp.getValue() + ""\"""";"
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,} else {
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,start = myCriteriaList.get(count-1).getValue();
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,end = temp.getValue();
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"myCriteriaList.get(count-1).setValue(""["" + start + "","" + end + ""]"");"
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,parentDTO.getRules().add(myCriteriaList.remove(count-1));
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,temp.getId().equals(myCriteriaList.get(count-1).getId()) &&
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,myCriteriaList.get(count-1).getOperator().equals(BLCOperator.GREATER_OR_EQUAL.name()) &&
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,myCriteriaList.get(count - 1).setOperator(BLCOperator.BETWEEN_INCLUSIVE.name());
4df2ccc79223a35bc26118a1bc9f411d385ee197,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"start = ""\"""" + myCriteriaList.get(count-1).getValue() + ""\"""";"
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,"appendExpression(phrase, fieldService, parentDTO, myCriteriaList);"
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,if (!myCriteriaList.isEmpty()) {
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,"public void appendExpression(String phrase, RuleBuilderFieldService fieldService, DataDTO parentDTO,"
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,"postProcessCriteria(parentDTO, myCriteriaList, expressionDTO, type);"
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,"ExpressionDTO temp, SupportedFieldType type) {"
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,int lstIdx = myCriteriaList.size() - 1;
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,ExpressionDTO prevExpression = lstIdx != -1 ? myCriteriaList.get(lstIdx) : null;
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,boolean sameExpressionId = prevExpression != null && temp.getId().equals(prevExpression.getId());
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,sameExpressionId &&
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,prevExpression.getOperator().equals(BLCOperator.GREATER_THAN.name()) &&
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,prevExpression.setOperator(BLCOperator.BETWEEN.name());
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,String start = prevExpression.getValue();
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,String end = temp.getValue();
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,"start = ""\"""" + start + ""\"""" ;"
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,"end = ""\"""" + end + ""\"""";"
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,"prevExpression.setValue(""["" + start + "","" + end + ""]"");"
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,parentDTO.getRules().add(myCriteriaList.remove(lstIdx));
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,prevExpression.getOperator().equals(BLCOperator.GREATER_OR_EQUAL.name()) &&
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,prevExpression.setOperator(BLCOperator.BETWEEN_INCLUSIVE.name());
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,int j = 0;
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,"appendExpression(phrase, fieldService, j, parentDTO, myCriteriaList);"
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,j++;
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,if (myCriteriaList.size() > 0) {
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,"public void appendExpression(String phrase, RuleBuilderFieldService fieldService, int count, DataDTO parentDTO,"
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,"postProcessCriteria(parentDTO, myCriteriaList, count, expressionDTO, type);"
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,"int count, ExpressionDTO temp, SupportedFieldType type) {"
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,count > 0 &&
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,temp.getId().equals(myCriteriaList.get(count - 1).getId()) &&
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,myCriteriaList.get(count - 1).getOperator().equals(BLCOperator.GREATER_THAN.name()) &&
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,myCriteriaList.get(count-1).setOperator(BLCOperator.BETWEEN.name());
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,String start;
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,String end;
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,"start = ""\"""" + myCriteriaList.get(count-1).getValue() + ""\"""" ;"
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,"end = ""\"""" + temp.getValue() + ""\"""";"
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,} else {
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,start = myCriteriaList.get(count-1).getValue();
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,end = temp.getValue();
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,"myCriteriaList.get(count-1).setValue(""["" + start + "","" + end + ""]"");"
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,parentDTO.getRules().add(myCriteriaList.remove(count-1));
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,temp.getId().equals(myCriteriaList.get(count-1).getId()) &&
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,myCriteriaList.get(count-1).getOperator().equals(BLCOperator.GREATER_OR_EQUAL.name()) &&
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,myCriteriaList.get(count - 1).setOperator(BLCOperator.BETWEEN_INCLUSIVE.name());
4df2ccc79223a35bc26118a1bc9f411d385ee197,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,"start = ""\"""" + myCriteriaList.get(count-1).getValue() + ""\"""";"
67f5c78efc8881497214b2c0782b0426f7179c5f,bebdc69c033f1f85f128978d971b82606288f34b,added,0,import org.broadleafcommerce.profile.core.domain.AddressImpl;
67f5c78efc8881497214b2c0782b0426f7179c5f,bebdc69c033f1f85f128978d971b82606288f34b,added,0,if (orderPaymentBillingAddress != null) {
67f5c78efc8881497214b2c0782b0426f7179c5f,bebdc69c033f1f85f128978d971b82606288f34b,added,0,billingInfoForm.setAddress(orderPaymentBillingAddress);
67f5c78efc8881497214b2c0782b0426f7179c5f,bebdc69c033f1f85f128978d971b82606288f34b,added,0,}
67f5c78efc8881497214b2c0782b0426f7179c5f,bebdc69c033f1f85f128978d971b82606288f34b,added,0,return address1 != null && address2 != null &&
67f5c78efc8881497214b2c0782b0426f7179c5f,bebdc69c033f1f85f128978d971b82606288f34b,added,0,"Objects.equals(address2.getAddressLine1(), address1.getAddressLine1()) &&"
67f5c78efc8881497214b2c0782b0426f7179c5f,bebdc69c033f1f85f128978d971b82606288f34b,deleted,1,billingInfoForm.setAddress(orderPaymentBillingAddress);
67f5c78efc8881497214b2c0782b0426f7179c5f,bebdc69c033f1f85f128978d971b82606288f34b,deleted,1,"return Objects.equals(address2.getAddressLine1(), address1.getAddressLine1()) &&"
9a2208e9f9ee1f1321ac1afee2b2907d696fc526,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,import java.util.List;
9a2208e9f9ee1f1321ac1afee2b2907d696fc526,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,import net.sf.ehcache.Cache;
9a2208e9f9ee1f1321ac1afee2b2907d696fc526,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,/**
9a2208e9f9ee1f1321ac1afee2b2907d696fc526,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,*
9a2208e9f9ee1f1321ac1afee2b2907d696fc526,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,* Returns a list of cacheKeys for a template site
9a2208e9f9ee1f1321ac1afee2b2907d696fc526,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,* @param propertyName
9a2208e9f9ee1f1321ac1afee2b2907d696fc526,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,* @return
9a2208e9f9ee1f1321ac1afee2b2907d696fc526,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,*/
9a2208e9f9ee1f1321ac1afee2b2907d696fc526,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,added,0,List<String> getCacheKeyListForTemplateSite(String propertyName);
9a2208e9f9ee1f1321ac1afee2b2907d696fc526,ead09cdb72a1d9ded00dfc049adaf85a573b8fb5,deleted,1,import net.sf.ehcache.Cache;
eee6513f2a30f2b9b5f292da6def63aaf0cb797a,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"boolean isParentRelated = sandBoxHelper.isRelatedToParentCatalogIds(quantityBasedRule, dto.getPk());"
eee6513f2a30f2b9b5f292da6def63aaf0cb797a,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,boolean isMatch = isParentRelated || dto.getPk().equals(quantityBasedRule.getId());
eee6513f2a30f2b9b5f292da6def63aaf0cb797a,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,Long id = sandBoxHelper.getOriginalId(quantityBasedRule);
eee6513f2a30f2b9b5f292da6def63aaf0cb797a,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,boolean isMatch = dto.getPk().equals(id) || dto.getPk().equals(quantityBasedRule.getId());
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"updateAdjustmentIfChangesDetected(adjustment, promotableAdjustment);"
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"protected void updateAdjustmentIfChangesDetected(OrderAdjustment adjustment, PromotableOrderAdjustment promotableAdjustment) {"
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,Long offerId = adjustment.getOffer().getId();
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (!adjustment.getValue().equals(promotableAdjustment.getAdjustmentValue())) {
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (LOG.isDebugEnabled()) {
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"LOG.debug(""Updating value for order adjustment with offer Id "" + offerId + "" to "" +"
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,promotableAdjustment.getAdjustmentValue());
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,adjustment.setValue(promotableAdjustment.getAdjustmentValue());
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (!adjustment.isFutureCredit().equals(promotableAdjustment.getOffer().isFutureCredit())) {
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"LOG.debug(""Updating isFutureCredit for order adjustment with offer Id "" + offerId + "" to "" +"
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,promotableAdjustment.isFutureCredit());
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,adjustment.setFutureCredit(promotableAdjustment.isFutureCredit());
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,boolean syncNeededOnTotal = false;
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,boolean syncNeeded = fgContainsFutureCreditAdjustment(fg);
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (syncNeeded) {
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,syncFulfillmentPrice(fg);
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,syncNeededOnTotal = true;
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (syncNeededOnTotal) {
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,Money syncFulfillmentPrice = Money.ZERO;
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,for (FulfillmentGroup fg : order.getFulfillmentGroups()) {
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,syncFulfillmentPrice = fg.getFulfillmentPrice();
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,order.setTotalFulfillmentCharges(syncFulfillmentPrice);
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected boolean fgContainsFutureCreditAdjustment(FulfillmentGroup fg) {
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return !fg.getFutureCreditFulfillmentGroupAdjustmentsValue().equals(Money.ZERO);
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected void syncFulfillmentPrice(FulfillmentGroup fg) {
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,Money retailPrice = fg.getRetailFulfillmentPrice();
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,Money orderDiscountFulfillmentGroupAdjustmentsValue = fg.getFulfillmentGroupAdjustmentsValue();
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,Money fulfillmentPrice = retailPrice.subtract(orderDiscountFulfillmentGroupAdjustmentsValue);
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,fg.setFulfillmentPrice(fulfillmentPrice);
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.core.offer.domain.OfferItemCriteria;
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableCandidateItemOffer;
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (!adjustment.getValue().equals(promotableAdjustment.getAdjustmentValue())) {
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (LOG.isDebugEnabled()) {
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"LOG.debug(""Updating value for order adjustment with offer Id "" + offerId + "" to "" +"
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,promotableAdjustment.getAdjustmentValue());
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,}
4d72f640e53ffe99c82f79ba8fac2b126c84553d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,adjustment.setValue(promotableAdjustment.getAdjustmentValue());
4d72f640e53ffe99c82f79ba8fac2b126c84553d,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,@Override
4d72f640e53ffe99c82f79ba8fac2b126c84553d,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,public List<OrderItemPriceDetailAdjustment> getFutureCreditOrderItemPriceDetailAdjustments() {
4d72f640e53ffe99c82f79ba8fac2b126c84553d,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,List<OrderItemPriceDetailAdjustment> orderDiscountAdjustments = new ArrayList<>();
4d72f640e53ffe99c82f79ba8fac2b126c84553d,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,for (OrderItemPriceDetailAdjustment adjustment : orderItemPriceDetailAdjustments) {
4d72f640e53ffe99c82f79ba8fac2b126c84553d,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,if (adjustment.isFutureCredit()) {
4d72f640e53ffe99c82f79ba8fac2b126c84553d,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,orderDiscountAdjustments.add(adjustment);
4d72f640e53ffe99c82f79ba8fac2b126c84553d,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,}
4d72f640e53ffe99c82f79ba8fac2b126c84553d,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,return orderDiscountAdjustments;
4d72f640e53ffe99c82f79ba8fac2b126c84553d,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,if (!adjustment.isFutureCredit()) {
4d72f640e53ffe99c82f79ba8fac2b126c84553d,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,adjustmentValue = adjustmentValue.add(adjustment.getValue());
4d72f640e53ffe99c82f79ba8fac2b126c84553d,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,return adjustmentValue;
4d72f640e53ffe99c82f79ba8fac2b126c84553d,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,public Money getFutureCreditAdjustmentValue() {
4d72f640e53ffe99c82f79ba8fac2b126c84553d,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,"Money adjustmentValue = BroadleafCurrencyUtils.getMoney(BigDecimal.ZERO, getCurrency());"
4d72f640e53ffe99c82f79ba8fac2b126c84553d,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,public Money getFutureCreditTotalAdjustmentValue() {
4d72f640e53ffe99c82f79ba8fac2b126c84553d,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,return getFutureCreditAdjustmentValue().multiply(quantity);
4d72f640e53ffe99c82f79ba8fac2b126c84553d,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,adjustmentValue = adjustmentValue.add(adjustment.getValue());
c8a1f03dbb8d753a7a25a6ee259813c3d9249f47,dd75381870aa39ea55fe1c1898370f9ab4ab09a0,added,0,"String tabName = pathVars.get(""tabName"");"
c8a1f03dbb8d753a7a25a6ee259813c3d9249f47,dd75381870aa39ea55fe1c1898370f9ab4ab09a0,added,0,if (StringUtils.isEmpty(tabName)) {
c8a1f03dbb8d753a7a25a6ee259813c3d9249f47,dd75381870aa39ea55fe1c1898370f9ab4ab09a0,added,0,"tabName = cmd.getFirstTab() == null ? ""General"" : cmd.getFirstTab().getTabName();"
c8a1f03dbb8d753a7a25a6ee259813c3d9249f47,dd75381870aa39ea55fe1c1898370f9ab4ab09a0,added,0,}
c8a1f03dbb8d753a7a25a6ee259813c3d9249f47,dd75381870aa39ea55fe1c1898370f9ab4ab09a0,added,0,"return service.getRecordsForSelectedTab(cmd, entity, crumbs, tabName);"
c8a1f03dbb8d753a7a25a6ee259813c3d9249f47,dd75381870aa39ea55fe1c1898370f9ab4ab09a0,deleted,1,"String firstTabName = cmd.getFirstTab() == null ? ""General"" : cmd.getFirstTab().getTabName();"
c8a1f03dbb8d753a7a25a6ee259813c3d9249f47,dd75381870aa39ea55fe1c1898370f9ab4ab09a0,deleted,1,"return service.getRecordsForSelectedTab(cmd, entity, crumbs, firstTabName);"
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.config.service.SystemPropertiesService;
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.springframework.beans.factory.annotation.Value;
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import javax.annotation.Resource;
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected boolean useQtyOnlyTierCalculation = false;
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"public PromotableCandidateItemOfferImpl(PromotableOrder promotableOrder, Offer offer, boolean useQtyOnlyTierCalculation) {"
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"this(promotableOrder, offer);"
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.useQtyOnlyTierCalculation = useQtyOnlyTierCalculation;
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (isUseQtyOnlyTierCalculation()) {
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,int returnQty = 0;
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,for (OfferItemCriteria itemCriteria : getCandidateTargetsMap().keySet()) {
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,List<PromotableOrderItem> candidateTargets = getCandidateTargetsMap().get(itemCriteria);
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,for (PromotableOrderItem promotableOrderItem : candidateTargets) {
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,returnQty += promotableOrderItem.getQuantity();
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return returnQty;
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,} else {
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,Integer returnQty = null;
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,int iterationQty = 0;
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,iterationQty += promotableOrderItem.getQuantity();
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,int tmpReturnQty;
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (itemCriteria.getQuantity() <= 0) {
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,tmpReturnQty = 0;
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,tmpReturnQty = (int)Math.floor(iterationQty / itemCriteria.getQuantity());
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (returnQty == null) {
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,returnQty = tmpReturnQty;
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"returnQty = Math.min(tmpReturnQty, returnQty);"
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,returnQty = 0;
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,@Override
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public boolean isUseQtyOnlyTierCalculation() {
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return useQtyOnlyTierCalculation;
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setUseQtyOnlyTierCalculation(boolean useQtyOnlyTierCalculation) {
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,int returnQty = 0;
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (OfferItemCriteria itemCriteria : getCandidateTargetsMap().keySet()) {
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,List<PromotableOrderItem> candidateTargets = getCandidateTargetsMap().get(itemCriteria);
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (PromotableOrderItem promotableOrderItem : candidateTargets) {
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,returnQty += promotableOrderItem.getQuantity();
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,}
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return returnQty;
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.springframework.beans.factory.annotation.Value;
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Value(""${use.quantity.only.tier.calculation:false}"")"
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected boolean useQtyOnlyTierCalculation = false;
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"return new PromotableCandidateItemOfferImpl(promotableOrder, offer, useQtyOnlyTierCalculation);"
bb745a2763ad9c0605f8fee35621117cb4a751e6,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"return new PromotableCandidateItemOfferImpl(promotableOrder, offer);"
fd7732f9280f9cf923a228f57720c429849cb941,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"COUNT_GREATER_OR_EQUAL, COUNT_LESS_THAN, COUNT_LESS_OR_EQUAL, COUNT_EQUALS, COLLECTION_IN, COLLECTION_NOT_IN,"
fd7732f9280f9cf923a228f57720c429849cb941,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,WITHIN_DAYS
fd7732f9280f9cf923a228f57720c429849cb941,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"COUNT_GREATER_OR_EQUAL, COUNT_LESS_THAN, COUNT_LESS_OR_EQUAL, COUNT_EQUALS, COLLECTION_IN, COLLECTION_NOT_IN"
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,case WITHIN_DAYS: {
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,try {
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,"Integer.parseInt(value[0] + """");"
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,} catch (Exception e) {
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,"throw new MVELTranslationException(MVELTranslationException.INCOMPATIBLE_INTEGER_VALUE, ""Cannot format value for the field ("" +"
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,"field + "") based on field type. The type of field is Integer, "" +"
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,"""and you entered: ("" + value[0] +"")"");"
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,}
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,"sb.append(""("");"
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,"buildExpression(sb, entityKey, field, new Object[]{""MvelHelper.subtractFromCurrentTime("" + value[0] + "")""}, type, SupportedFieldType.WITHIN_DAYS, GREATER_THAN_OPERATOR,"
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,"false, false, false, false, true);"
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,"sb.append(""&&"");"
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,"buildExpression(sb, entityKey, field, new Object[]{""MvelHelper.currentTime()""}, type, SupportedFieldType.WITHIN_DAYS, LESS_THAN_OPERATOR,"
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,"sb.append("")"");"
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,break;
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,if (SupportedFieldType.WITHIN_DAYS.equals(secondaryType)) {
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,"response.append(""MvelHelper.convertField(\""DATE\"","");"
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,response.append(parsableVal);
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,"response.append("")"");"
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,} else {
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,//convert the date to our standard date/time format
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,Date temp = null;
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,temp = RuleBuilderFormatUtil.parseDate(parsableVal);
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,} catch (ParseException e) {
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,"throw new MVELTranslationException(MVELTranslationException.INCOMPATIBLE_DATE_VALUE, ""Cannot format value for the field ("" +"
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,"fieldName + "") based on field type. The type of field is Date, "" +"
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,"""and you entered: ("" + parsableVal + ""). Dates must be in the format MM/dd/yyyy HH:mm."");"
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,String convertedDate = FormatUtil.getTimeZoneFormat().format(temp);
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,"response.append(""MvelHelper.convertField(\""DATE\"",\"""");"
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,response.append(convertedDate);
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,added,0,"response.append(""\"")"");"
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,//convert the date to our standard date/time format
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,Date temp = null;
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,try {
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,temp = RuleBuilderFormatUtil.parseDate(parsableVal);
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,} catch (ParseException e) {
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,"throw new MVELTranslationException(MVELTranslationException.INCOMPATIBLE_DATE_VALUE, ""Cannot format value for the field ("" +"
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,"fieldName + "") based on field type. The type of field is Date, "" +"
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,"""and you entered: ("" + parsableVal +""). Dates must be in the format MM/dd/yyyy HH:mm."");"
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,String convertedDate = FormatUtil.getTimeZoneFormat().format(temp);
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,"response.append(""MvelHelper.convertField(\""DATE\"",\"""");"
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,response.append(convertedDate);
fd7732f9280f9cf923a228f57720c429849cb941,cf55ab08573f8a23e1914cdff06e40e7456d54ee,deleted,1,"response.append(""\"")"");"
9a5ba730763c3e2baf89704fda521af0128b2eba,56ce28c7c6b1b245910d9bcc0d23df9b74a6d966,added,0,if (!autoFlushSaveCart) {
9a5ba730763c3e2baf89704fda521af0128b2eba,56ce28c7c6b1b245910d9bcc0d23df9b74a6d966,added,0,session.setFlushMode(current);
9a5ba730763c3e2baf89704fda521af0128b2eba,56ce28c7c6b1b245910d9bcc0d23df9b74a6d966,added,0,}
9a5ba730763c3e2baf89704fda521af0128b2eba,56ce28c7c6b1b245910d9bcc0d23df9b74a6d966,added,0,if (!autoFlushSaveCart && !session.getFlushMode().equals(current)) {
9a5ba730763c3e2baf89704fda521af0128b2eba,56ce28c7c6b1b245910d9bcc0d23df9b74a6d966,deleted,1,if (!autoFlushSaveCart) {
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import java.io.Serializable;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import java.util.List;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import java.util.Map;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import javax.annotation.Resource;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import javax.persistence.criteria.CriteriaBuilder;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import javax.persistence.criteria.From;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import javax.persistence.criteria.Path;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import javax.persistence.criteria.Predicate;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import org.broadleafcommerce.openadmin.server.service.persistence.module.criteria.FieldPath;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import org.broadleafcommerce.openadmin.server.service.persistence.module.criteria.FieldPathBuilder;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import org.broadleafcommerce.openadmin.server.service.persistence.module.criteria.Restriction;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,import org.broadleafcommerce.openadmin.server.service.persistence.module.criteria.predicate.PredicateProvider;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"public DynamicResultSet fetch(PersistencePackage persistencePackage, CriteriaTransferObject cto,"
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"DynamicEntityDao dynamicEntityDao, RecordHelper helper) throws ServiceException {"
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,cto.getAdditionalFilterMappings().add(new FilterMapping()
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,".withFieldPath(new FieldPath().withTargetProperty(""field.friendlyName""))"
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,.withFilterValues(filterValues)
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,.withSortDirection(fieldFsc.getSortDirection())
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,.withRestriction(new Restriction()
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,.withPredicateProvider(new PredicateProvider() {
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,@Override
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"public Predicate buildPredicate(CriteriaBuilder builder, FieldPathBuilder fieldPathBuilder, From root,"
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"String ceilingEntity, String fullPropertyName, Path explicitPath, List directValues) {"
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"return builder.like(explicitPath.as(String.class), ""%"" + directValues.get(0) + ""%"");"
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,})
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,added,0,));
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import org.broadleafcommerce.core.search.domain.IndexFieldImpl;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import java.io.Serializable;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import java.util.ArrayList;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import java.util.List;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import java.util.Map;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import javax.annotation.Resource;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import javax.persistence.TypedQuery;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import javax.persistence.criteria.CriteriaBuilder;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import javax.persistence.criteria.CriteriaQuery;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import javax.persistence.criteria.Order;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import javax.persistence.criteria.Path;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import javax.persistence.criteria.Predicate;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,import javax.persistence.criteria.Root;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"public DynamicResultSet fetch(PersistencePackage persistencePackage, CriteriaTransferObject cto, DynamicEntityDao"
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"dynamicEntityDao, RecordHelper helper) throws ServiceException {"
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,boolean didFilter = false;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,CriteriaBuilder builder = dynamicEntityDao.getStandardEntityManager().getCriteriaBuilder();
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,CriteriaQuery<IndexField> criteria = builder.createQuery(IndexField.class);
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,Root<IndexFieldImpl> root = criteria.from(IndexFieldImpl.class);
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,criteria.select(root);
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,// Check if we are searching for specific field names
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,List<Predicate> restrictions = new ArrayList<>();
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,if (CollectionUtils.isNotEmpty(filterValues)) {
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"restrictions.add(builder.like(root.get(""field"").<String>get(""friendlyName""), ""%"" + filterValues.get(0) + ""%""));"
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,didFilter = true;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,}
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,// Check if this filter value has a sort direction associated with it
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,Order order = null;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,for (FilterAndSortCriteria sortCriteria : cto.getCriteriaMap().values()) {
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,if (sortCriteria.getSortDirection() != null) {
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,Path path = root;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,try {
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,// Try to find the path to the property in IndexFieldImpl
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"String[] pathParts = sortCriteria.getPropertyId().split(""\\."");"
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,for (String part : pathParts) {
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,path = path.get(part);
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"// If we made it here, we have the path, set the sorting (asc/desc)"
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,if (sortCriteria.getSortAscending()) {
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,order = builder.asc(path);
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,} else {
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,order = builder.desc(path);
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,criteria.orderBy(order);
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,break;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,} catch (IllegalArgumentException e) {
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,// This isn't an actual entity property
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,continue;
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,criteria.where(restrictions.toArray(new Predicate[restrictions.size()]));
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,TypedQuery<IndexField> query = dynamicEntityDao.getStandardEntityManager().createQuery(criteria);
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,List<IndexField> indexFields = query.getResultList();
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,// Convert the result list into a list of entities
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,PersistencePerspective persistencePerspective = persistencePackage.getPersistencePerspective();
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"Map<String, FieldMetadata> indexFieldMetadata = helper.getSimpleMergedProperties(IndexField.class.getName(), persistencePerspective);"
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"Entity[] entities = helper.getRecords(indexFieldMetadata, indexFields);"
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,// We need to get the total number of records available because the entityList returned may not be the full set.
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"Map<String, FieldMetadata> originalProps = helper.getSimpleMergedProperties(IndexField.class.getName(), persistencePerspective);"
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"List<FilterMapping> filterMappings = helper.getFilterMappings(persistencePerspective, cto, IndexField.class.getName(), originalProps);"
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"int totalRecords = helper.getTotalRecords(persistencePackage.getCeilingEntityFullyQualifiedClassname(), filterMappings);"
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,// Create a Dynamic Result Set from the entity list created above.
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"DynamicResultSet resultSet = new DynamicResultSet(entities, (didFilter ? entities.length : totalRecords));"
2b5175c52ff5eada5dc73d4ead0948f94c2cccd8,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,return resultSet;
9d8dfc83761123e96f088b1f129f0f87085c98d5,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Index(name = ""OFFERAUDIT_CUSTOMER_INDEX"", columnNames = { ""CUSTOMER_ID, OFFER_ID"" })"
9d8dfc83761123e96f088b1f129f0f87085c98d5,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""ACCOUNT_ID"")"
9d8dfc83761123e96f088b1f129f0f87085c98d5,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Index(name = ""OFFERAUDIT_ACCOUNT_INDEX"", columnNames = { ""ACCOUNT_ID, OFFER_ID"" })"
9d8dfc83761123e96f088b1f129f0f87085c98d5,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected Long accountId;
9d8dfc83761123e96f088b1f129f0f87085c98d5,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@Override
9d8dfc83761123e96f088b1f129f0f87085c98d5,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Long getAccountId() {
9d8dfc83761123e96f088b1f129f0f87085c98d5,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return accountId;
9d8dfc83761123e96f088b1f129f0f87085c98d5,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,}
9d8dfc83761123e96f088b1f129f0f87085c98d5,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setAccountId(Long accountId) {
9d8dfc83761123e96f088b1f129f0f87085c98d5,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.accountId = accountId;
9d8dfc83761123e96f088b1f129f0f87085c98d5,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,".append(this.accountId, that.accountId)"
9d8dfc83761123e96f088b1f129f0f87085c98d5,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""OFFERAUDIT_CUSTOMER_INDEX"", columnNames={""CUSTOMER_ID""})"
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,added,0,import org.broadleafcommerce.core.offer.service.type.CustomerMaxUsesStrategyType;
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,added,0,"defaultValue = ""0.00"")"
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,added,0,"@Column(name = ""MAX_USES_STRATEGY"")"
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,added,0,"@AdminPresentation(friendlyName = ""OfferImpl_Max_Uses_Strategy"", allowNoValueEnumOption = false, defaultValue = ""CUSTOMER"", group = GroupName.Restrictions, order = FieldOrder.MaxUsesStrategy, fieldType = SupportedFieldType.BROADLEAF_ENUMERATION, broadleafEnumeration = ""org.broadleafcommerce.core.offer.service.type.CustomerMaxUsesStrategyType"")"
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,added,0,protected String maxUsesStrategy;
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,added,0,@Override
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,added,0,public CustomerMaxUsesStrategyType getMaxUsesStrategyType() {
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,added,0,return CustomerMaxUsesStrategyType.getInstance(maxUsesStrategy);
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,added,0,}
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,added,0,public void setMaxUsesStrategyType(CustomerMaxUsesStrategyType strategyType) {
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,added,0,this.maxUsesStrategy = strategyType.getType();
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,deleted,1,"defaultValue = ""0.00000"")"
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,deleted,1,//    @Override
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,deleted,1,//    @Deprecated
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,deleted,1,//    public Set<OfferItemCriteria> getQualifyingItemCriteria() {
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,deleted,1,//        if (legacyQualifyingItemCriteria.size() == 0) {
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,deleted,1,//            for (OfferQualifyingCriteriaXref xref : getQualifyingItemCriteriaXref()) {
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,deleted,1,//                legacyQualifyingItemCriteria.add(xref.getOfferItemCriteria());
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,deleted,1,//            }
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,deleted,1,//        }
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,deleted,1,//        return Collections.unmodifiableSet(legacyQualifyingItemCriteria);
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,deleted,1,//    }
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,deleted,1,//
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,deleted,1,//    public void setQualifyingItemCriteria(Set<OfferItemCriteria> qualifyingItemCriteria) {
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,deleted,1,//        this.legacyQualifyingItemCriteria.clear();
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,deleted,1,//        this.qualifyingItemCriteria.clear();
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,deleted,1,//        for(OfferItemCriteria crit : qualifyingItemCriteria){
9d8dfc83761123e96f088b1f129f0f87085c98d5,713900318ac303ae31a8314be722d5aab7beb4a5,deleted,1,"//            this.qualifyingItemCriteria.add(new OfferQualifyingCriteriaXrefImpl(this, crit));"
9d8dfc83761123e96f088b1f129f0f87085c98d5,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,import org.broadleafcommerce.core.offer.service.type.CustomerMaxUsesStrategyType;
9d8dfc83761123e96f088b1f129f0f87085c98d5,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,CustomerMaxUsesStrategyType strategy = offer.getMaxUsesStrategyType();
9d8dfc83761123e96f088b1f129f0f87085c98d5,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,boolean checkUsingCustomer = (strategy == null || strategy.equals(CustomerMaxUsesStrategyType.CUSTOMER));
9d8dfc83761123e96f088b1f129f0f87085c98d5,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,Long currentUses;
9d8dfc83761123e96f088b1f129f0f87085c98d5,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,if (checkUsingCustomer) {
9d8dfc83761123e96f088b1f129f0f87085c98d5,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"currentUses = offerAuditService.countUsesByCustomer(order, order.getCustomer().getId(), offer.getId(), offer.getMinimumDaysPerUsage());"
9d8dfc83761123e96f088b1f129f0f87085c98d5,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,} else {
9d8dfc83761123e96f088b1f129f0f87085c98d5,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,"currentUses = offerAuditService.countUsesByAccount(order, order.getBroadleafAccountId(), offer.getId(), offer.getMinimumDaysPerUsage());"
9d8dfc83761123e96f088b1f129f0f87085c98d5,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,}
9d8dfc83761123e96f088b1f129f0f87085c98d5,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,Customer customer = order.getCustomer();
9d8dfc83761123e96f088b1f129f0f87085c98d5,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,"Long currentUses = offerAuditService.countUsesByCustomer(order, customer.getId(), offer.getId(), offer.getMinimumDaysPerUsage());"
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,"if (attemptToPopulateValue(property, fieldManager, instance, setId, metadata, entity, value)) {"
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,boolean isValid = true;
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,"PopulateValueRequest request = new PopulateValueRequest(setId, fieldManager, property, metadata, returnType, value, persistenceManager, this, entity.isPreAdd());"
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,handled = false;
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,isValid = false;
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,}
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,if (isValid) {
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,try {
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,boolean isBreakDetected = false;
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,for (FieldPersistenceProvider fieldPersistenceProvider : fieldPersistenceProviders) {
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,if (!isBreakDetected || fieldPersistenceProvider.alwaysRun() && (value != null || fieldPersistenceProvider.canHandlePopulateNull())) {
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,"MetadataProviderResponse response = fieldPersistenceProvider.populateValue(request, instance);"
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,if (MetadataProviderResponse.NOT_HANDLED != response) {
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,handled = true;
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,if (MetadataProviderResponse.HANDLED_BREAK == response) {
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,isBreakDetected = true;
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,if (!handled) {
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,if (value == null) {
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,property.setIsDirty(true);
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,"defaultFieldPersistenceProvider.populateValue(new PopulateValueRequest(setId, fieldManager, property, metadata, returnType, value, persistenceManager, this, entity.isPreAdd()), instance);"
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,"fieldManager.setFieldValue(instance, property.getName(), null);"
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,} catch (ParentEntityPersistenceException | javax.validation.ValidationException e) {
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,entityPersistenceException = e;
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,cleanupFailedPersistenceAttempt(instance);
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,break;
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,"protected boolean attemptToPopulateValue(Property property, FieldManager fieldManager, Serializable instance,"
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,"Boolean setId, BasicFieldMetadata metadata, Entity entity, String value) throws IllegalAccessException {"
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,Boolean mutable = metadata.getMutable();
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,Boolean readOnly = metadata.getReadOnly();
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,boolean generalConditionsMet = (mutable == null || mutable) && (readOnly == null || !readOnly) && property.getEnabled();
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,if (generalConditionsMet && value == null) {
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,boolean currentValueIsNotNull = false;
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,"currentValueIsNotNull = fieldManager.getFieldValue(instance, property.getName()) != null;"
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,} catch (FieldNotAvailableException e) {
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,throw new IllegalArgumentException(e);
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,boolean valueIsNotNullId = metadata.getFieldType() != SupportedFieldType.ID || setId;
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,boolean valueIsNotPassword = metadata.getFieldType() != SupportedFieldType.PASSWORD;
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,return currentValueIsNotNull && !entity.isPreAdd() && valueIsNotNullId && valueIsNotPassword;
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,added,0,return generalConditionsMet;
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,Boolean mutable = metadata.getMutable();
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,Boolean readOnly = metadata.getReadOnly();
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,if ((mutable == null || mutable) && (readOnly == null || !readOnly) && property.getEnabled()) {
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,handled = false;
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,"PopulateValueRequest request = new PopulateValueRequest(setId,"
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,"fieldManager, property, metadata, returnType, value, persistenceManager, this, entity.isPreAdd());"
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,boolean attemptToPopulate = true;
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,attemptToPopulate = false;
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,if (attemptToPopulate) {
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,try {
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,boolean isBreakDetected = false;
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,for (FieldPersistenceProvider fieldPersistenceProvider : fieldPersistenceProviders) {
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,if (!isBreakDetected || fieldPersistenceProvider.alwaysRun()) {
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,"MetadataProviderResponse response = fieldPersistenceProvider.populateValue(request, instance);"
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,if (MetadataProviderResponse.NOT_HANDLED != response) {
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,handled = true;
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,}
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,if (MetadataProviderResponse.HANDLED_BREAK == response) {
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,isBreakDetected = true;
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,if (!handled) {
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,"defaultFieldPersistenceProvider.populateValue(new PopulateValueRequest(setId,"
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,"fieldManager, property, metadata, returnType, value, persistenceManager, this, entity.isPreAdd()), instance);"
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,} catch (ParentEntityPersistenceException | javax.validation.ValidationException e) {
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,entityPersistenceException = e;
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,cleanupFailedPersistenceAttempt(instance);
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,break;
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,} else {
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,"if (fieldManager.getFieldValue(instance, property.getName()) != null && !entity.isPreAdd() && (metadata.getFieldType() != SupportedFieldType.ID || setId) && metadata.getFieldType() != SupportedFieldType.PASSWORD) {"
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,property.setIsDirty(true);
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,"PopulateValueRequest request = new PopulateValueRequest(setId, fieldManager, property, metadata, returnType, value, persistenceManager, this, entity.isPreAdd());"
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,"defaultFieldPersistenceProvider.populateValue(request, instance);"
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,"fieldManager.setFieldValue(instance, property.getName(), null);"
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,} catch (FieldNotAvailableException e) {
815d76112fe079fac6eee29570929d4ddcb7a0a0,7259b229e290cceef18db8e5fab505f2fcb28bc6,deleted,1,throw new IllegalArgumentException(e);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.core.offer.domain.OfferPriceData;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"public interface PromotableCandidateItemOffer extends PromotionRounding, Serializable {"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"HashMap<OfferPriceData, List<PromotableOrderItem>> getCandidateFixedTargetsMap();"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"void setCandidateFixedTargetsMap(HashMap<OfferPriceData, List<PromotableOrderItem>> candidateFixedTargetsMap);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public interface PromotableCandidateItemOffer extends Serializable {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,/**
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* Public only for unit testing - not intended to be called
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,*/
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"public Money calculateSavingsForOrderItem(PromotableOrderItem orderItem, int qtyToReceiveSavings);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.core.offer.domain.OfferPriceData;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"protected HashMap<OfferPriceData, List<PromotableOrderItem>> candidateFixedTargetsMap = new HashMap<>();"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,@Override
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"public HashMap<OfferPriceData, List<PromotableOrderItem>> getCandidateFixedTargetsMap() {"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return candidateFixedTargetsMap;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"public void setCandidateFixedTargetsMap(HashMap<OfferPriceData, List<PromotableOrderItem>> candidateFixedTargetsMap) {"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.candidateFixedTargetsMap = candidateFixedTargetsMap;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,@Override
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"public Money calculateSavingsForOrderItem(PromotableOrderItem orderItem, int qtyToReceiveSavings) {"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Money savings = new Money(promotableOrder.getOrderCurrency());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,originalPrice = orderItem.getPriceBeforeAdjustments(getOffer().getApplyDiscountToSalePrice());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"BigDecimal offerUnitValue = PromotableOfferUtility.determineOfferUnitValue(offer, this);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"savings = PromotableOfferUtility.computeAdjustmentValue(originalPrice, offerUnitValue, this, this);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return savings.multiply(qtyToReceiveSavings);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,}
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import org.broadleafcommerce.core.offer.domain.OfferPriceData;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"protected HashMap<OfferPriceData, List<PromotableOrderItem>> candidateFixedTargetsMap = new HashMap<>();"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,@Override
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"public HashMap<OfferPriceData, List<PromotableOrderItem>> getCandidateFixedTargetsMap() {"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,return candidateFixedTargetsMap;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,}
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"public void setCandidateFixedTargetsMap(HashMap<OfferPriceData, List<PromotableOrderItem>> candidateFixedTargetsMap) {"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,this.candidateFixedTargetsMap = candidateFixedTargetsMap;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,@Override
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"public Money calculateSavingsForOrderItem(PromotableOrderItem orderItem, int qtyToReceiveSavings) {"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,Money savings = new Money(promotableOrder.getOrderCurrency());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,originalPrice = orderItem.getPriceBeforeAdjustments(getOffer().getApplyDiscountToSalePrice());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"BigDecimal offerUnitValue = PromotableOfferUtility.determineOfferUnitValue(offer, this);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"savings = PromotableOfferUtility.computeAdjustmentValue(originalPrice, offerUnitValue, this, this);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,return savings.multiply(qtyToReceiveSavings);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,}
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7052c0ab3292e727ef82a25889c137aea193962d,added,0,"public interface PromotableFulfillmentGroupAdjustment extends PromotionRounding, Serializable {"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7052c0ab3292e727ef82a25889c137aea193962d,deleted,1,public interface PromotableFulfillmentGroupAdjustment extends Serializable {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"PromotableFulfillmentGroup fulfillmentGroup,"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"Money retailAdjustmentValue,"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,Money saleAdjustmentValue) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.retailAdjustmentValue = retailAdjustmentValue;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.saleAdjustmentValue = saleAdjustmentValue;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,PromotableFulfillmentGroup fulfillmentGroup) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,computeAdjustmentValues();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,/*
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* Calculates the value of the adjustment for both retail and sale prices.
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"* If either adjustment is greater than the item value, it will be set to the"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* currentItemValue (e.g. no adjustment can cause a negative value).
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,*/
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected void computeAdjustmentValues() {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,saleAdjustmentValue = new Money(getCurrency());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,retailAdjustmentValue = new Money(getCurrency());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Offer offer = promotableCandidateFulfillmentGroupOffer.getOffer();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Money currentPriceDetailSalesValue = promotableFulfillmentGroup.calculatePriceWithAdjustments(true);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Money currentPriceDetailRetailValue = promotableFulfillmentGroup.calculatePriceWithAdjustments(false);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"retailAdjustmentValue = PromotableOfferUtility.computeAdjustmentValue(currentPriceDetailRetailValue, offer.getValue(), this, this);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (offer.getApplyDiscountToSalePrice() == true) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"saleAdjustmentValue = PromotableOfferUtility.computeAdjustmentValue(currentPriceDetailSalesValue, offer.getValue(), this, this);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,}
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected final PromotableOfferUtility promotableOfferUtility;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public PromotableItemFactoryImpl(PromotableOfferUtility promotableOfferUtility) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.promotableOfferUtility = promotableOfferUtility;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"return new PromotableOrderItemPriceDetailAdjustmentImpl(promotableCandidateItemOffer, orderItemPriceDetail,"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"promotableOfferUtility.computeRetailAdjustmentValue(promotableCandidateItemOffer, orderItemPriceDetail),"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"promotableOfferUtility.computeSalesAdjustmentValue(promotableCandidateItemOffer, orderItemPriceDetail));"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"return new PromotableFulfillmentGroupAdjustmentImpl(promotableCandidateFulfillmentGroupOffer, fulfillmentGroup,"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"promotableOfferUtility.computeRetailAdjustmentValue(promotableCandidateFulfillmentGroupOffer, fulfillmentGroup),"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"promotableOfferUtility.computeSalesAdjustmentValue(promotableCandidateFulfillmentGroupOffer, fulfillmentGroup));"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"return new PromotableOrderItemPriceDetailAdjustmentImpl(promotableCandidateItemOffer, orderItemPriceDetail);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"return new PromotableFulfillmentGroupAdjustmentImpl(promotableCandidateFulfillmentGroupOffer, fulfillmentGroup);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* Copyright (C) 2009 - 2018 Broadleaf Commerce
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.core.offer.domain.OfferPriceData;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* @author Nick Crum ncrum
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public interface PromotableOfferUtility {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"boolean itemMatchesOfferPriceData(OfferPriceData offerPriceData, PromotableOrderItem promotableOrderItem);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"Money computeRetailAdjustmentValue(PromotableCandidateFulfillmentGroupOffer promotableCandidateFulfillmentGroupOffer, PromotableFulfillmentGroup promotableFulfillmentGroup);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"Money computeSalesAdjustmentValue(PromotableCandidateFulfillmentGroupOffer promotableCandidateFulfillmentGroupOffer, PromotableFulfillmentGroup promotableFulfillmentGroup);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"Money computeAdjustmentValue(PromotableCandidateFulfillmentGroupOffer promotableCandidateFulfillmentGroupOffer, PromotableFulfillmentGroup promotableFulfillmentGroup, boolean allowSalePrice);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"Money computeRetailAdjustmentValue(PromotableCandidateItemOffer promotableCandidateItemOffer, PromotableOrderItemPriceDetail orderItemPriceDetail);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"Money computeSalesAdjustmentValue(PromotableCandidateItemOffer promotableCandidateItemOffer, PromotableOrderItemPriceDetail orderItemPriceDetail);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"Money computeAdjustmentValue(PromotableCandidateItemOffer promotableCandidateItemOffer, PromotableOrderItemPriceDetail orderItemPriceDetail, boolean allowSalePrice);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"Money calculateSavingsForOrderItem(PromotableCandidateItemOffer promotableCandidateItemOffer, PromotableOrderItem orderItem, int qtyToReceiveSavings);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* Copyright (C) 2009 - 2016 Broadleaf Commerce
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.apache.commons.beanutils.BeanComparator;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.common.currency.domain.BroadleafCurrency;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.core.offer.domain.AdvancedOffer;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.core.offer.domain.Offer;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.core.offer.domain.OfferTier;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.core.offer.service.type.OfferDiscountType;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import java.math.BigDecimal;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import java.math.RoundingMode;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import java.util.Collections;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import java.util.List;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* Provides shared code for the default implementations of PromotableOrderItemPriceDetailAdjustmentImpl and
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* PromotableCandidateItemOfferImpl
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* @author bpolster
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,*
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public class PromotableOfferUtility {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"public static Money computeAdjustmentValue(Money currentPriceDetailValue, BigDecimal offerUnitValue, OfferHolder offerHolder, PromotionRounding rounding) {"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Offer offer = offerHolder.getOffer();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,BroadleafCurrency currency = offerHolder.getCurrency();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,OfferDiscountType discountType = offer.getDiscountType();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Money adjustmentValue;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (currency != null) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,adjustmentValue = new Money(currency);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,} else {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,adjustmentValue = new Money();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,}
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (OfferDiscountType.AMOUNT_OFF.equals(discountType)) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"adjustmentValue = new Money(offerUnitValue, currency);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (OfferDiscountType.FIX_PRICE.equals(discountType)) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"adjustmentValue = currentPriceDetailValue.subtract(new Money(offerUnitValue, currency));"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (OfferDiscountType.PERCENT_OFF.equals(discountType)) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"BigDecimal offerValue = currentPriceDetailValue.getAmount().multiply(offerUnitValue.divide(new BigDecimal(""100""), 5, RoundingMode.HALF_EVEN));"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (rounding.isRoundOfferValues()) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"offerValue = offerValue.setScale(rounding.getRoundingScale(), rounding.getRoundingMode());"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"adjustmentValue = new Money(offerValue, currency);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (currentPriceDetailValue.lessThan(adjustmentValue)) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,adjustmentValue = currentPriceDetailValue;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return adjustmentValue;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@SuppressWarnings(""unchecked"")"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"public static BigDecimal determineOfferUnitValue(Offer offer, PromotableCandidateItemOffer promotableCandidateItemOffer) {"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (offer instanceof AdvancedOffer) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,AdvancedOffer advancedOffer = (AdvancedOffer) offer;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (advancedOffer.isTieredOffer()) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,int quantity = promotableCandidateItemOffer.calculateTargetQuantityForTieredOffer();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,List<OfferTier> offerTiers = advancedOffer.getOfferTiers();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"Collections.sort(offerTiers, new BeanComparator(""minQuantity""));"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,OfferTier maxTier = null;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,//assuming that promotableOffer.getOffer()).getOfferTiers() is sorted already
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (OfferTier currentTier : offerTiers) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (quantity >= currentTier.getMinQuantity()) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,maxTier = currentTier;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,break;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (maxTier != null) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return maxTier.getAmount();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (OfferDiscountType.FIX_PRICE.equals(offer.getDiscountType())) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"// Choosing an arbitrary large value.    The retail / sale price will be less than this,"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,// so the offer will not get selected.
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return BigDecimal.valueOf(Integer.MAX_VALUE);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return BigDecimal.ZERO;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return offer.getValue();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"PromotableOrderItemPriceDetail orderItemPriceDetail,"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"Money retailAdjustmentValue,"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,Money saleAdjustmentValue) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.retailAdjustmentValue = retailAdjustmentValue;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.saleAdjustmentValue = saleAdjustmentValue;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"promotableCandidateItemOffer, promotableOrderItemPriceDetail, retailAdjustmentValue, saleAdjustmentValue);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import java.math.BigDecimal;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,PromotableOrderItemPriceDetail orderItemPriceDetail) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,computeAdjustmentValues();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,/*
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* Calculates the value of the adjustment for both retail and sale prices.
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"* If either adjustment is greater than the item value, it will be set to the"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* currentItemValue (e.g. no adjustment can cause a negative value).
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,*/
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected void computeAdjustmentValues() {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,saleAdjustmentValue = new Money(getCurrency());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,retailAdjustmentValue = new Money(getCurrency());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Money currentPriceDetailRetailValue = promotableOrderItemPriceDetail.calculateItemUnitPriceWithAdjustments(false);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,Money currentPriceDetailSalesValue = promotableOrderItemPriceDetail.calculateItemUnitPriceWithAdjustments(true);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (currentPriceDetailSalesValue == null) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,currentPriceDetailSalesValue = currentPriceDetailRetailValue;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,}
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"BigDecimal offerUnitValue = PromotableOfferUtility.determineOfferUnitValue(offer, promotableCandidateItemOffer);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"retailAdjustmentValue = PromotableOfferUtility.computeAdjustmentValue(currentPriceDetailRetailValue, offerUnitValue, this, this);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (offer.getApplyDiscountToSalePrice() == true) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"saleAdjustmentValue = PromotableOfferUtility.computeAdjustmentValue(currentPriceDetailSalesValue, offerUnitValue, this, this);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"promotableCandidateItemOffer, promotableOrderItemPriceDetail);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"PromotableOrderItemPriceDetail orderItemPriceDetail,"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"Money retailAdjustmentValue,"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,Money saleAdjustmentValue) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,this.retailAdjustmentValue = retailAdjustmentValue;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,this.saleAdjustmentValue = saleAdjustmentValue;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"promotableCandidateItemOffer, promotableOrderItemPriceDetail, retailAdjustmentValue, saleAdjustmentValue);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,import java.math.BigDecimal;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,PromotableOrderItemPriceDetail orderItemPriceDetail) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,computeAdjustmentValues();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,/*
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* Calculates the value of the adjustment for both retail and sale prices.
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"* If either adjustment is greater than the item value, it will be set to the"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,* currentItemValue (e.g. no adjustment can cause a negative value).
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,*/
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,protected void computeAdjustmentValues() {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,saleAdjustmentValue = new Money(getCurrency());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,retailAdjustmentValue = new Money(getCurrency());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,Money currentPriceDetailRetailValue = promotableOrderItemPriceDetail.calculateItemUnitPriceWithAdjustments(false);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,Money currentPriceDetailSalesValue = promotableOrderItemPriceDetail.calculateItemUnitPriceWithAdjustments(true);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (currentPriceDetailSalesValue == null) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,currentPriceDetailSalesValue = currentPriceDetailRetailValue;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,}
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"BigDecimal offerUnitValue = PromotableOfferUtility.determineOfferUnitValue(offer, promotableCandidateItemOffer);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"retailAdjustmentValue = PromotableOfferUtility.computeAdjustmentValue(currentPriceDetailRetailValue, offerUnitValue, this, this);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,if (offer.getApplyDiscountToSalePrice() == true) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"saleAdjustmentValue = PromotableOfferUtility.computeAdjustmentValue(currentPriceDetailSalesValue, offerUnitValue, this, this);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"promotableCandidateItemOffer, promotableOrderItemPriceDetail);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtility;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtilityImpl;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,private PromotableOfferUtility promotableOfferUtility;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,promotableOfferUtility = new PromotableOfferUtilityImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"promotableOrder = new PromotableOrderImpl(order, new PromotableItemFactoryImpl(promotableOfferUtility), false);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"promotableOrderItem = new PromotableOrderItemImpl(orderItem1, null, new PromotableItemFactoryImpl(promotableOfferUtility), false);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"Money savings = promotableOfferUtility.calculateSavingsForOrderItem(promotableCandidate, promotableOrderItem, 1);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"savings = promotableOfferUtility.calculateSavingsForOrderItem(promotableCandidate, promotableOrderItem, 1);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"promotableOrder = new PromotableOrderImpl(order, new PromotableItemFactoryImpl(), false);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"promotableOrderItem = new PromotableOrderItemImpl(orderItem1, null, new PromotableItemFactoryImpl(), false);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"Money savings = promotableCandidate.calculateSavingsForOrderItem(promotableOrderItem, 1);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"savings = promotableCandidate.calculateSavingsForOrderItem(promotableOrderItem, 1);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtility;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,public PromotableOrder createBasicPromotableOrder(PromotableOfferUtility promotableOfferUtility) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,"PromotableOrder promotableOrder = new PromotableOrderImpl(order, new PromotableItemFactoryImpl(promotableOfferUtility), false);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,public PromotableOrder createBasicPromotableOrder() {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,"PromotableOrder promotableOrder = new PromotableOrderImpl(order, new PromotableItemFactoryImpl(), false);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,import junit.framework.TestCase;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtility;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtilityImpl;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,protected PromotableOfferUtility promotableOfferUtility;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,promotableOfferUtility = new PromotableOfferUtilityImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,OrderOfferProcessorImpl orderProcessor = new OrderOfferProcessorImpl(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,orderProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,ItemOfferProcessorImpl itemProcessor = new ItemOfferProcessorImpl(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,itemProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,FulfillmentGroupOfferProcessor fgProcessor = new FulfillmentGroupOfferProcessorImpl(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,fgProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,offerService.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,order = dataProvider.createBasicPromotableOrder(promotableOfferUtility).getOrder();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,Order order = dataProvider.createBasicPromotableOrder(promotableOfferUtility).getOrder();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,import junit.framework.TestCase;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,OrderOfferProcessorImpl orderProcessor = new OrderOfferProcessorImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,orderProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,ItemOfferProcessorImpl itemProcessor = new ItemOfferProcessorImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,itemProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,FulfillmentGroupOfferProcessor fgProcessor = new FulfillmentGroupOfferProcessorImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,fgProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,offerService.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,order = dataProvider.createBasicPromotableOrder().getOrder();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,Order order = dataProvider.createBasicPromotableOrder().getOrder();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import junit.framework.TestCase;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtility;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtilityImpl;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,protected PromotableOfferUtility promotableOfferUtility;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,promotableOfferUtility = new PromotableOfferUtilityImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,OrderOfferProcessorImpl orderProcessor = new OrderOfferProcessorImpl(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,orderProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,ItemOfferProcessorImpl itemProcessor = new ItemOfferProcessorImpl(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,itemProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,FulfillmentGroupOfferProcessor fgProcessor = new FulfillmentGroupOfferProcessorImpl(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,fgProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,offerService.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,order = dataProvider.createBasicPromotableOrder(promotableOfferUtility).getOrder();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,Order order = dataProvider.createBasicPromotableOrder(promotableOfferUtility).getOrder();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,import junit.framework.TestCase;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,OrderOfferProcessorImpl orderProcessor = new OrderOfferProcessorImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,orderProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,ItemOfferProcessorImpl itemProcessor = new ItemOfferProcessorImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,itemProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,FulfillmentGroupOfferProcessor fgProcessor = new FulfillmentGroupOfferProcessorImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,fgProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,offerService.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,order = dataProvider.createBasicPromotableOrder().getOrder();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,Order order = dataProvider.createBasicPromotableOrder().getOrder();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,import junit.framework.TestCase;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtility;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtilityImpl;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,protected PromotableOfferUtility promotableOfferUtility;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,public TestableFulfillmentGroupOfferProcessor(PromotableOfferUtility promotableOfferUtility) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,super(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,}
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,promotableOfferUtility = new PromotableOfferUtilityImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,fgProcessor = new TestableFulfillmentGroupOfferProcessor(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,fgProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,OrderOfferProcessorImpl orderProcessor = new OrderOfferProcessorImpl(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,orderProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,ItemOfferProcessorImpl itemProcessor = new ItemOfferProcessorImpl(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,itemProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,offerService.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,PromotableOrder promotableOrder = dataProvider.createBasicPromotableOrder(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,promotableOrder = dataProvider.createBasicPromotableOrder(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,import junit.framework.TestCase;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,fgProcessor = new TestableFulfillmentGroupOfferProcessor();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,fgProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,OrderOfferProcessorImpl orderProcessor = new OrderOfferProcessorImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,orderProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,ItemOfferProcessorImpl itemProcessor = new ItemOfferProcessorImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,itemProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,offerService.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,PromotableOrder order = dataProvider.createBasicPromotableOrder();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,PromotableOrder promotableOrder = dataProvider.createBasicPromotableOrder();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,promotableOrder = dataProvider.createBasicPromotableOrder();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,order = dataProvider.createBasicPromotableOrder();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import junit.framework.TestCase;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtility;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtilityImpl;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,protected PromotableOfferUtility promotableOfferUtility;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,public TestableFulfillmentGroupOfferProcessor(PromotableOfferUtility promotableOfferUtility) {
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,super(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,}
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,promotableOfferUtility = new PromotableOfferUtilityImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,fgProcessor = new TestableFulfillmentGroupOfferProcessor(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,fgProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,OrderOfferProcessorImpl orderProcessor = new OrderOfferProcessorImpl(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,orderProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,ItemOfferProcessorImpl itemProcessor = new ItemOfferProcessorImpl(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,itemProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,offerService.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,PromotableOrder promotableOrder = dataProvider.createBasicPromotableOrder(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,promotableOrder = dataProvider.createBasicPromotableOrder(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,import junit.framework.TestCase;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,fgProcessor = new TestableFulfillmentGroupOfferProcessor();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,fgProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,OrderOfferProcessorImpl orderProcessor = new OrderOfferProcessorImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,orderProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,ItemOfferProcessorImpl itemProcessor = new ItemOfferProcessorImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,itemProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,offerService.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,PromotableOrder order = dataProvider.createBasicPromotableOrder();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,PromotableOrder promotableOrder = dataProvider.createBasicPromotableOrder();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,promotableOrder = dataProvider.createBasicPromotableOrder();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,order = dataProvider.createBasicPromotableOrder();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,import junit.framework.TestCase;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtility;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtilityImpl;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,protected PromotableOfferUtility promotableOfferUtility;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,promotableOfferUtility = new PromotableOfferUtilityImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,itemProcessor = new ItemOfferProcessorImpl(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,itemProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,OrderOfferProcessorImpl orderProcessor = new OrderOfferProcessorImpl(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,orderProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,offerService.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,added,0,PromotableOrder promotableOrder = dataProvider.createBasicPromotableOrder(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,import junit.framework.TestCase;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,itemProcessor = new ItemOfferProcessorImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,itemProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,OrderOfferProcessorImpl orderProcessor = new OrderOfferProcessorImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,orderProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,offerService.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,PromotableOrder order = dataProvider.createBasicPromotableOrder();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,7e9a594431453cd2bc7e7b516307840af4e25657,deleted,1,PromotableOrder promotableOrder = dataProvider.createBasicPromotableOrder();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,import junit.framework.TestCase;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtility;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtilityImpl;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,protected PromotableOfferUtility promotableOfferUtility;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,promotableOfferUtility = new PromotableOfferUtilityImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,itemProcessor = new ItemOfferProcessorImpl(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,itemProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,OrderOfferProcessorImpl orderProcessor = new OrderOfferProcessorImpl(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,orderProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,offerService.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,385ef959d62c7dcb4b90bc91826a12923f4c5377,added,0,PromotableOrder promotableOrder = dataProvider.createBasicPromotableOrder(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,import junit.framework.TestCase;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,itemProcessor = new ItemOfferProcessorImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,itemProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,OrderOfferProcessorImpl orderProcessor = new OrderOfferProcessorImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,orderProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,offerService.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,PromotableOrder order = dataProvider.createBasicPromotableOrder();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,385ef959d62c7dcb4b90bc91826a12923f4c5377,deleted,1,PromotableOrder promotableOrder = dataProvider.createBasicPromotableOrder();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import junit.framework.TestCase;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtility;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtilityImpl;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,protected PromotableOfferUtility promotableOfferUtility;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,promotableOfferUtility = new PromotableOfferUtilityImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,itemProcessor = new ItemOfferProcessorImpl(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,itemProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,OrderOfferProcessorImpl orderProcessor = new OrderOfferProcessorImpl(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,orderProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,offerService.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,PromotableOrder promotableOrder = dataProvider.createBasicPromotableOrder(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,import junit.framework.TestCase;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,OfferServiceUtilitiesImpl offerServiceUtilities = new OfferServiceUtilitiesImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,offerServiceUtilities.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,itemProcessor = new ItemOfferProcessorImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,itemProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,OrderOfferProcessorImpl orderProcessor = new OrderOfferProcessorImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,orderProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,offerService.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,PromotableOrder order = dataProvider.createBasicPromotableOrder();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,PromotableOrder promotableOrder = dataProvider.createBasicPromotableOrder();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import junit.framework.TestCase;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtility;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtilityImpl;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,protected PromotableOfferUtility promotableOfferUtility;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,promotableOfferUtility = new PromotableOfferUtilityImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,orderProcessor = new OrderOfferProcessorImpl(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,orderProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl(promotableOfferUtility));
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,added,0,PromotableOrder order = dataProvider.createBasicPromotableOrder(promotableOfferUtility);
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,import junit.framework.TestCase;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,orderProcessor = new OrderOfferProcessorImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,orderProcessor.setPromotableItemFactory(new PromotableItemFactoryImpl());
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,8352a0815cde294e891c3b46a0c12366e71d2352,deleted,1,PromotableOrder order = dataProvider.createBasicPromotableOrder();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtility;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.core.offer.service.discount.domain.PromotableOfferUtilityImpl;
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,PromotableOfferUtility promotableOfferUtility = new PromotableOfferUtilityImpl();
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"PromotableOrder promotableOrder = new PromotableOrderImpl(new OrderImpl(), new PromotableItemFactoryImpl(promotableOfferUtility), false);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"new PromotableItemFactoryImpl(promotableOfferUtility), false);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"PromotableOrder promotableOrder = new PromotableOrderImpl(new OrderImpl(), new PromotableItemFactoryImpl(), false);"
1c9e946382866ceaf7b3b3a1b989673bf67e6bcb,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"new PromotableItemFactoryImpl(), false);"
b606d3bad38d80851044e3fb92c96274abcf370f,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"String productFilter = shs.getTypeFieldName() + "":"" + shs.getPrimaryDocumentType();"
b606d3bad38d80851044e3fb92c96274abcf370f,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"// transform the deleteQuery to include the productFilter, this is necessary to ensure that we don't delete non-product documents accidentally"
b606d3bad38d80851044e3fb92c96274abcf370f,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"deleteQuery = productFilter + "" AND ("" + deleteQuery + "")"";"
b606d3bad38d80851044e3fb92c96274abcf370f,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"String childDeleteQuery = ""{!child of="" + productFilter + ""} "" + deleteQuery;"
b606d3bad38d80851044e3fb92c96274abcf370f,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"String childDeleteQuery = ""{!child of="" + shs.getTypeFieldName() + "":"" + shs.getPrimaryDocumentType() + ""} "" + deleteQuery;"
0a446c22dd0850f80b2132590d816116f693d71d,479ea79411965f831a686923dc011fc3297ad884,added,0,import org.hibernate.jpa.QueryHints;
0a446c22dd0850f80b2132590d816116f693d71d,479ea79411965f831a686923dc011fc3297ad884,added,0,import org.hibernate.query.criteria.internal.CriteriaBuilderImpl;
0a446c22dd0850f80b2132590d816116f693d71d,479ea79411965f831a686923dc011fc3297ad884,deleted,1,import org.hibernate.ejb.QueryHints;
0a446c22dd0850f80b2132590d816116f693d71d,479ea79411965f831a686923dc011fc3297ad884,deleted,1,import org.hibernate.ejb.criteria.CriteriaBuilderImpl;
2a29020f78028ce984edfbf63c2c8256470b1178,b9113cc952405fc38bffc1a680d1ca93f4e2079c,added,0,//if (key instanceof CacheKey) {
2a29020f78028ce984edfbf63c2c8256470b1178,b9113cc952405fc38bffc1a680d1ca93f4e2079c,added,0,//cacheName = ((CacheKey) key).getEntityOrRoleName();
2a29020f78028ce984edfbf63c2c8256470b1178,b9113cc952405fc38bffc1a680d1ca93f4e2079c,added,0,//key = ((CacheKey) key).getKey();
2a29020f78028ce984edfbf63c2c8256470b1178,b9113cc952405fc38bffc1a680d1ca93f4e2079c,added,0,//}
2a29020f78028ce984edfbf63c2c8256470b1178,b9113cc952405fc38bffc1a680d1ca93f4e2079c,added,0,//TODO 3064 what is this an instance of now?
2a29020f78028ce984edfbf63c2c8256470b1178,b9113cc952405fc38bffc1a680d1ca93f4e2079c,deleted,1,import org.hibernate.cache.spi.CacheKey;
2a29020f78028ce984edfbf63c2c8256470b1178,b9113cc952405fc38bffc1a680d1ca93f4e2079c,deleted,1,if (key instanceof CacheKey) {
2a29020f78028ce984edfbf63c2c8256470b1178,b9113cc952405fc38bffc1a680d1ca93f4e2079c,deleted,1,cacheName = ((CacheKey) key).getEntityOrRoleName();
2a29020f78028ce984edfbf63c2c8256470b1178,b9113cc952405fc38bffc1a680d1ca93f4e2079c,deleted,1,key = ((CacheKey) key).getKey();
2a29020f78028ce984edfbf63c2c8256470b1178,b9113cc952405fc38bffc1a680d1ca93f4e2079c,deleted,1,}
360b39fa35ebb2b288d792f9a0333bd4b7f43e51,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"request.removeAttribute(BroadleafCurrencyResolverImpl.CURRENCY_VAR, WebRequest.SCOPE_SESSION);"
360b39fa35ebb2b288d792f9a0333bd4b7f43e51,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"locale = (Locale) request.getAttribute(LOCALE_VAR, WebRequest.SCOPE_SESSION);"
360b39fa35ebb2b288d792f9a0333bd4b7f43e51,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"request.setAttribute(LOCALE_VAR, locale, WebRequest.SCOPE_SESSION);"
360b39fa35ebb2b288d792f9a0333bd4b7f43e51,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"request.removeAttribute(BroadleafCurrencyResolverImpl.CURRENCY_VAR, WebRequest.SCOPE_GLOBAL_SESSION);"
360b39fa35ebb2b288d792f9a0333bd4b7f43e51,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"locale = (Locale) request.getAttribute(LOCALE_VAR, WebRequest.SCOPE_GLOBAL_SESSION);"
360b39fa35ebb2b288d792f9a0333bd4b7f43e51,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"request.setAttribute(LOCALE_VAR, locale, WebRequest.SCOPE_GLOBAL_SESSION);"
360b39fa35ebb2b288d792f9a0333bd4b7f43e51,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"previousSandBoxId = (Long) request.getAttribute(SANDBOX_ID_VAR, WebRequest.SCOPE_SESSION);"
360b39fa35ebb2b288d792f9a0333bd4b7f43e51,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"request.removeAttribute(SANDBOX_DATE_TIME_VAR, WebRequest.SCOPE_SESSION);"
360b39fa35ebb2b288d792f9a0333bd4b7f43e51,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"request.removeAttribute(SANDBOX_ID_VAR, WebRequest.SCOPE_SESSION);"
360b39fa35ebb2b288d792f9a0333bd4b7f43e51,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"sandboxId = (Long) request.getAttribute(SANDBOX_ID_VAR, WebRequest.SCOPE_SESSION);"
360b39fa35ebb2b288d792f9a0333bd4b7f43e51,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"request.setAttribute(SANDBOX_ID_VAR, sandboxId, WebRequest.SCOPE_SESSION);"
360b39fa35ebb2b288d792f9a0333bd4b7f43e51,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"overrideTime = (Date) request.getAttribute(SANDBOX_DATE_TIME_VAR, WebRequest.SCOPE_SESSION);"
360b39fa35ebb2b288d792f9a0333bd4b7f43e51,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"request.setAttribute(SANDBOX_DATE_TIME_VAR, overrideTime, WebRequest.SCOPE_SESSION);"
360b39fa35ebb2b288d792f9a0333bd4b7f43e51,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"previousSandBoxId = (Long) request.getAttribute(SANDBOX_ID_VAR, WebRequest.SCOPE_GLOBAL_SESSION);"
360b39fa35ebb2b288d792f9a0333bd4b7f43e51,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"request.removeAttribute(SANDBOX_DATE_TIME_VAR, WebRequest.SCOPE_GLOBAL_SESSION);"
360b39fa35ebb2b288d792f9a0333bd4b7f43e51,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"request.removeAttribute(SANDBOX_ID_VAR, WebRequest.SCOPE_GLOBAL_SESSION);"
360b39fa35ebb2b288d792f9a0333bd4b7f43e51,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"sandboxId = (Long) request.getAttribute(SANDBOX_ID_VAR, WebRequest.SCOPE_GLOBAL_SESSION);"
360b39fa35ebb2b288d792f9a0333bd4b7f43e51,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"request.setAttribute(SANDBOX_ID_VAR, sandboxId, WebRequest.SCOPE_GLOBAL_SESSION);"
360b39fa35ebb2b288d792f9a0333bd4b7f43e51,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"overrideTime = (Date) request.getAttribute(SANDBOX_DATE_TIME_VAR, WebRequest.SCOPE_GLOBAL_SESSION);"
360b39fa35ebb2b288d792f9a0333bd4b7f43e51,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"request.setAttribute(SANDBOX_DATE_TIME_VAR, overrideTime, WebRequest.SCOPE_GLOBAL_SESSION);"
360b39fa35ebb2b288d792f9a0333bd4b7f43e51,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,"request.setAttribute(mergeCartResponseKey, mergeCartResponse, WebRequest.SCOPE_SESSION);"
360b39fa35ebb2b288d792f9a0333bd4b7f43e51,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,"request.setAttribute(mergeCartResponseKey, mergeCartResponse, WebRequest.SCOPE_GLOBAL_SESSION);"
3c3352c52aac08b031cc88cda619373346dcfd05,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,"Class<?>[] entitiesFromCeiling = daoHelper.getAllPolymorphicEntitiesFromCeiling(beanIdClass, true, true);"
3c3352c52aac08b031cc88cda619373346dcfd05,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,"Class<?>[] entitiesFromCeiling = daoHelper.getAllPolymorphicEntitiesFromCeiling(beanIdClass, em.unwrap(Session.class).getSessionFactory(), true, true);"
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,/*
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,* #%L
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,* BroadleafCommerce Common Libraries
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,* %%
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,* Copyright (C) 2009 - 2016 Broadleaf Commerce
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,"* Licensed under the Broadleaf Fair Use License Agreement, Version 1.0"
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,"* (the ""Fair Use License"" located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)"
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,* unless the restrictions on use therein are violated and require payment to Broadleaf in which case
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,"* the Broadleaf End User License Agreement (EULA), Version 1.1"
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,"* (the ""Commercial License"" located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)"
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,* shall apply.
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,*
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,"* Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the ""Custom License"")"
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,* between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,* #L%
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,*/
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,package org.broadleafcommerce.common.util;
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,import org.apache.commons.lang.StringUtils;
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,import org.apache.tools.ant.BuildException;
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,import org.apache.tools.ant.taskdefs.Copy;
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,import org.apache.tools.ant.types.Resource;
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,import org.apache.tools.ant.types.ResourceCollection;
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,import org.apache.tools.ant.types.resources.FileResource;
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,import java.io.File;
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,import java.io.IOException;
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,import java.util.Iterator;
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,import java.util.Vector;
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,public class DependencyLicenseCopy extends Copy {
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,protected File licenseDir = null;
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,protected Vector<ResourceCollection> rcs = new Vector<ResourceCollection>();
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,"@SuppressWarnings(""unchecked"")"
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,public void execute() throws BuildException {
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,super.execute();
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,try {
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,for (int i = 0; i < rcs.size(); i++) {
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,ResourceCollection rc = (ResourceCollection) rcs.elementAt(i);
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,Iterator<Resource> resources = rc.iterator();
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,while (resources.hasNext()) {
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,Resource r = (Resource) resources.next();
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,if (!r.isExists()) {
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,continue;
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,}
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,if (r instanceof FileResource) {
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,FileResource fr = (FileResource) r;
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,String baseDir = fr.getBaseDir().getAbsolutePath();
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,String file = fr.getFile().getAbsolutePath();
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,"file = file.substring(baseDir.length(), file.length());"
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,"String[] parts = file.split(""/"");"
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,if (parts.length<=1) {
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,"parts = file.split(""\\\\"");"
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,if (parts.length <= 1) {
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,"throw new BuildException(""Unable to recognize the path separator for src file: "" + file);"
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,String[] specificParts = new String[parts.length-1];
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,"System.arraycopy(parts, 0, specificParts, 0, specificParts.length);"
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,"String specificFilePart = StringUtils.join(specificParts, '/') + ""/license.txt"";"
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,"File specificFile = new File(licenseDir, specificFilePart);"
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,"File specificDestinationFile = new File(destDir, specificFilePart);"
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,if (specificFile.exists()) {
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,"fileUtils.copyFile(specificFile, specificDestinationFile);"
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,String[] generalParts = new String[3];
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,"System.arraycopy(parts, 0, generalParts, 0, 3);"
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,"String generalFilePart = StringUtils.join(generalParts, '/') + ""/license.txt"";"
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,"File generalFile = new File(licenseDir, generalFilePart);"
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,if (generalFile.exists()) {
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,"fileUtils.copyFile(generalFile, specificDestinationFile);"
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,String[] moreGeneralParts = new String[2];
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,"System.arraycopy(parts, 0, moreGeneralParts, 0, 2);"
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,"String moreGeneralFilePart = StringUtils.join(moreGeneralParts, '/') + ""/license.txt"";"
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,"File moreGeneralFile = new File(licenseDir, moreGeneralFilePart);"
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,if (moreGeneralFile.exists()) {
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,"fileUtils.copyFile(moreGeneralFile, specificDestinationFile);"
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,} catch (IOException e) {
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,throw new BuildException(e);
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,public void add(ResourceCollection res) {
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,super.add(res);
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,rcs.add(res);
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,public File getLicenseDir() {
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,return licenseDir;
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,public void setLicenseDir(File licenseDir) {
c651c6c716cc36f9daea77c2ce71cda4da7dd999,2c1bd6e3fe1db5ba47250fc73b0c46bc96bc4155,deleted,1,this.licenseDir = licenseDir;
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,return FieldEntity.PRODUCT.getType();
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"return ""productId"";"
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,fields = indexFieldDao.readSearchableFieldsByEntityType(FieldEntity.PRODUCT);
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"@Value(""${solr.index.use.sku}"")"
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,protected boolean useSku;
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,return (useSku) ? FieldEntity.SKU.getType() : FieldEntity.PRODUCT.getType();
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,if (useSku) {
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"return ""skuId"";"
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,} else {
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"return ""productId"";"
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,}
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,fields = indexFieldDao.readSearchableFieldsByEntityType(FieldEntity.SKU);
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,fields = indexFieldDao.readSearchableFieldsByEntityType(FieldEntity.PRODUCT);
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,// Get the products
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,List<Product> products = getProducts(responseDocuments);
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,result.setProducts(products);
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.broadleafcommerce.core.catalog.domain.Sku;
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"@Value(""${solr.index.use.sku}"")"
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,protected boolean useSku;
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (useSku) {
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,List<Sku> skus = getSkus(responseDocuments);
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,result.setSkus(skus);
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,} else {
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,// Get the products
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,List<Product> products = getProducts(responseDocuments);
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,result.setProducts(products);
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,}
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,return buildSearchFacetDTOs(searchFacetDao.readAllSearchFacets(FieldEntity.SKU));
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,/**
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"* Given a list of Sku IDs from solr, this method will look up the IDs via the skuDao and build out"
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* actual Sku instances. It will return a Sku list that is sorted by the order of the IDs in the passed
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* in list.
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,*
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* @param response
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,* @return the actual Sku instances as a result of the search
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,*/
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,protected List<Sku> getSkus(List<SolrDocument> responseDocuments) {
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,final List<Long> skuIds = new ArrayList<>();
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,for (SolrDocument doc : responseDocuments) {
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,skuIds.add((Long) doc.getFieldValue(shs.getIndexableIdFieldName()));
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,List<Sku> skus = skuDao.readSkusByIds(skuIds);
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,// We have to sort the skus list by the order of the skuIds list to maintain sortability in the UI
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (skus != null) {
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"Collections.sort(skus, new Comparator<Sku>() {"
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,@Override
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public int compare(Sku o1, Sku o2) {"
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,return new Integer(skuIds.indexOf(o1.getId())).compareTo(skuIds.indexOf(o2.getId()));
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,});
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,return skus;
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,return productDao.readCountAllActiveProducts();
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"return productDao.readAllActiveProducts(pageSize, lastId);"
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.broadleafcommerce.core.catalog.dao.SkuDao;
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.broadleafcommerce.core.catalog.domain.ProductBundle;
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,import org.broadleafcommerce.core.catalog.domain.Sku;
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"@Value(""${solr.index.use.sku}"")"
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,protected boolean useSku;
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"@Resource(name = ""blSkuDao"")"
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,protected SkuDao skuDao;
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (useSku) {
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,return skuDao.readCountAllActiveSkus();
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,} else {
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,return productDao.readCountAllActiveProducts();
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,}
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"List<Sku> skus = skuDao.readAllActiveSkus(pageSize, lastId);"
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,return filterIndexableSkus(skus);
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"return productDao.readAllActiveProducts(pageSize, lastId);"
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,@Override
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public List<Sku> filterIndexableSkus(List<Sku> skus) {
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,ArrayList<Sku> skusToIndex = new ArrayList<>();
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (CollectionUtils.isNotEmpty(skus)) {
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,for (Sku sku : skus) {
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"//If the sku is not active, don't index it..."
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (!sku.isActive()) {
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,continue;
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,//If this is the default sku and the product has product options
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,//and is not allowed to be sold without product options
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (sku.getDefaultProduct() != null
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,&& !sku.getProduct().getCanSellWithoutOptions()
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,&& !sku.getProduct().getAdditionalSkus().isEmpty()) {
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (sku.getDefaultProduct() instanceof ProductBundle) {
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,skusToIndex.add(sku);
4e73ad4bb1dde50ab2178c2bd6c68bafb3b5d825,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,return skusToIndex;
1ecdf0452707f93528eae527ef71ed591368e8bb,b9113cc952405fc38bffc1a680d1ca93f4e2079c,added,0,import net.sf.ehcache.CacheException;
1ecdf0452707f93528eae527ef71ed591368e8bb,b9113cc952405fc38bffc1a680d1ca93f4e2079c,added,0,import net.sf.ehcache.Ehcache;
1ecdf0452707f93528eae527ef71ed591368e8bb,b9113cc952405fc38bffc1a680d1ca93f4e2079c,added,0,import net.sf.ehcache.Element;
1ecdf0452707f93528eae527ef71ed591368e8bb,b9113cc952405fc38bffc1a680d1ca93f4e2079c,added,0,import net.sf.ehcache.event.CacheEventListener;
1ecdf0452707f93528eae527ef71ed591368e8bb,b9113cc952405fc38bffc1a680d1ca93f4e2079c,added,0,@Override
1ecdf0452707f93528eae527ef71ed591368e8bb,b9113cc952405fc38bffc1a680d1ca93f4e2079c,added,0,"if (key.getClass().getName().equals(""org.hibernate.cache.internal.CacheKeyImplementation"")) {"
1ecdf0452707f93528eae527ef71ed591368e8bb,b9113cc952405fc38bffc1a680d1ca93f4e2079c,added,0,// Since CacheKeyImplementation is a protected Class we can't cast it nor can we access the entityOrRoleName property
1ecdf0452707f93528eae527ef71ed591368e8bb,b9113cc952405fc38bffc1a680d1ca93f4e2079c,added,0,"// therefore, to match how this worked in pre Hibernate 5, we split the toString since it's comprised of the fields we need"
1ecdf0452707f93528eae527ef71ed591368e8bb,b9113cc952405fc38bffc1a680d1ca93f4e2079c,added,0,"String[] keyPieces = key.toString().split(""#"");"
1ecdf0452707f93528eae527ef71ed591368e8bb,b9113cc952405fc38bffc1a680d1ca93f4e2079c,added,0,cacheName = keyPieces[0];
1ecdf0452707f93528eae527ef71ed591368e8bb,b9113cc952405fc38bffc1a680d1ca93f4e2079c,added,0,key = keyPieces[1];
1ecdf0452707f93528eae527ef71ed591368e8bb,b9113cc952405fc38bffc1a680d1ca93f4e2079c,added,0,}
1ecdf0452707f93528eae527ef71ed591368e8bb,b9113cc952405fc38bffc1a680d1ca93f4e2079c,deleted,1,import net.sf.ehcache.CacheException;
1ecdf0452707f93528eae527ef71ed591368e8bb,b9113cc952405fc38bffc1a680d1ca93f4e2079c,deleted,1,import net.sf.ehcache.Ehcache;
1ecdf0452707f93528eae527ef71ed591368e8bb,b9113cc952405fc38bffc1a680d1ca93f4e2079c,deleted,1,import net.sf.ehcache.Element;
1ecdf0452707f93528eae527ef71ed591368e8bb,b9113cc952405fc38bffc1a680d1ca93f4e2079c,deleted,1,import net.sf.ehcache.event.CacheEventListener;
1ecdf0452707f93528eae527ef71ed591368e8bb,b9113cc952405fc38bffc1a680d1ca93f4e2079c,deleted,1,//if (key instanceof CacheKey) {
1ecdf0452707f93528eae527ef71ed591368e8bb,b9113cc952405fc38bffc1a680d1ca93f4e2079c,deleted,1,//cacheName = ((CacheKey) key).getEntityOrRoleName();
1ecdf0452707f93528eae527ef71ed591368e8bb,b9113cc952405fc38bffc1a680d1ca93f4e2079c,deleted,1,//key = ((CacheKey) key).getKey();
1ecdf0452707f93528eae527ef71ed591368e8bb,b9113cc952405fc38bffc1a680d1ca93f4e2079c,deleted,1,//}
1ecdf0452707f93528eae527ef71ed591368e8bb,b9113cc952405fc38bffc1a680d1ca93f4e2079c,deleted,1,//TODO 3064 what is this an instance of now?
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,*
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,import org.broadleafcommerce.common.BroadleafEnumerationType;
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,"public class RatingSortType implements BroadleafEnumerationType, Serializable {"
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,"public static final RatingSortType MOST_HELPFUL = new RatingSortType(""MOST_HELPFUL"", ""Most Helpful"");"
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,"public static final RatingSortType MOST_RECENT = new RatingSortType(""MOST_RECENT"", ""Most Recent"");"
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,"public static final RatingSortType DEFAULT = new RatingSortType(""DEFAULT"", ""Default"");"
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,private String friendlyType;
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,//do nothing
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public RatingSortType(String type) {
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,"this(type, type);"
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,"public RatingSortType(String type, String friendlyType) {"
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,this.friendlyType = friendlyType;
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,this.setType(type);
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,}
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,@Override
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public String getFriendlyType() {
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,return friendlyType;
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,*
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public class RatingSortType implements Serializable {
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final RatingSortType MOST_HELPFUL = new RatingSortType(""MOST_HELPFUL"");"
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final RatingSortType MOST_RECENT = new RatingSortType(""MOST_RECENT"");"
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final RatingSortType DEFAULT = new RatingSortType(""DEFAULT"");"
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public RatingSortType(final String type) {
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,setType(type);
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,*
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,import org.broadleafcommerce.common.BroadleafEnumerationType;
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,import java.io.Serializable;
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,"public class RatingType implements BroadleafEnumerationType, Serializable {"
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,"public static final RatingType PRODUCT = new RatingType(""PRODUCT"", ""Product"");"
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,private String friendlyType;
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,//do nothing
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public RatingType(String type) {
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,"this(type, type);"
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,"public RatingType(String type, String friendlyType) {"
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,this.friendlyType = friendlyType;
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,this.setType(type);
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,}
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,@Override
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public String getFriendlyType() {
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,return friendlyType;
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,*
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public class RatingType {
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,"public static final RatingType PRODUCT = new RatingType(""PRODUCT"");"
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public RatingType(final String type) {
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,setType(type);
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,*
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,import org.broadleafcommerce.common.BroadleafEnumerationType;
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,import java.io.Serializable;
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,"public class ReviewStatusType implements BroadleafEnumerationType, Serializable {"
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,private String friendlyType;
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,//do nothing
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public ReviewStatusType(String type) {
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,"this(type, type);"
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,"public ReviewStatusType(String type, String friendlyType) {"
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,this.friendlyType = friendlyType;
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,this.setType(type);
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,}
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,@Override
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,public String getFriendlyType() {
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,return friendlyType;
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,added,0,private void setType(final String type) {
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,*
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public class ReviewStatusType {
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,public ReviewStatusType(final String type) {
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,setType(type);
0ad68df9ace41c0ed002fbf36b98c3f6e8285666,703ecd2c2389598d2f02d6eaaed8ed0cade50f11,deleted,1,private void setType(String type) {
8051aa3aec7fc446a7df3ef00ec901ad99f49d17,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,"protected static final String FOLDER_SUBSECTION = ""/folder"";"
8051aa3aec7fc446a7df3ef00ec901ad99f49d17,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,AdminSection section = context.parseExpression(attributeValue);
8051aa3aec7fc446a7df3ef00ec901ad99f49d17,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,"final boolean noFolder = Boolean.parseBoolean(tagAttributes.get(""data-no-folder""));"
8051aa3aec7fc446a7df3ef00ec901ad99f49d17,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,"final boolean requireFolder = Boolean.parseBoolean(tagAttributes.get(""data-require-folder""));"
8051aa3aec7fc446a7df3ef00ec901ad99f49d17,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,final boolean allowFolder = section.isFolderable();
8051aa3aec7fc446a7df3ef00ec901ad99f49d17,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,final boolean folderByDefault = section.isFolderedByDefault();
8051aa3aec7fc446a7df3ef00ec901ad99f49d17,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,final boolean shouldFolder;
8051aa3aec7fc446a7df3ef00ec901ad99f49d17,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,if (!allowFolder) {
8051aa3aec7fc446a7df3ef00ec901ad99f49d17,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,shouldFolder = false;
8051aa3aec7fc446a7df3ef00ec901ad99f49d17,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,} else {
8051aa3aec7fc446a7df3ef00ec901ad99f49d17,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,if (noFolder) {
8051aa3aec7fc446a7df3ef00ec901ad99f49d17,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,} else if (requireFolder) {
8051aa3aec7fc446a7df3ef00ec901ad99f49d17,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,shouldFolder = true;
8051aa3aec7fc446a7df3ef00ec901ad99f49d17,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,"// nothing specified, do default"
8051aa3aec7fc446a7df3ef00ec901ad99f49d17,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,shouldFolder = folderByDefault;
8051aa3aec7fc446a7df3ef00ec901ad99f49d17,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,}
8051aa3aec7fc446a7df3ef00ec901ad99f49d17,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,"final String folderPart = shouldFolder ? FOLDER_SUBSECTION : """";"
8051aa3aec7fc446a7df3ef00ec901ad99f49d17,f2ed6868ffa2a5a951d29b03c992a89744361379,added,0,href = request.getContextPath() + folderPart + section.getUrl();
8051aa3aec7fc446a7df3ef00ec901ad99f49d17,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,AdminSection section = (AdminSection) context.parseExpression(attributeValue);
8051aa3aec7fc446a7df3ef00ec901ad99f49d17,f2ed6868ffa2a5a951d29b03c992a89744361379,deleted,1,href = request.getContextPath() + section.getUrl();
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"deleteAllNamespaceDocuments(solrConfiguration.getReindexCollectionName(), solrConfiguration.getReindexServer());"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"optimizeIndex(solrConfiguration.getReindexCollectionName(), solrConfiguration.getReindexServer());"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"buildIncrementalIndex(getSolrCollectionForIndexing(), indexables, getSolrServerForIndexing());"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public void deleteAllNamespaceDocuments(String collection, SolrClient server) throws ServiceException {"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"server.deleteByQuery(collection, deleteQuery);"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,server.commit(collection);
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public void deleteAllDocuments(String collection, SolrClient server) throws ServiceException {"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public Collection<SolrInputDocument> buildIncrementalIndex(String collection, List<? extends Indexable> indexables, SolrClient solrServer) throws ServiceException {"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"solrServer.add(collection, documents);"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"commit(collection, solrServer);"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public void optimizeIndex(String collection, SolrClient server) throws ServiceException, IOException {"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"shs.optimizeIndex(collection, server);"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public void commit(String collection, SolrClient server) throws ServiceException, IOException {"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"commit(collection, server, this.softCommit, this.waitSearcher, this.waitFlush);"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public void commit(String collection, SolrClient server, boolean softCommit, boolean waitSearcher, boolean waitFlush) throws ServiceException, IOException {"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"server.commit(collection, waitFlush, waitSearcher, softCommit);"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"solrConfiguration.getServer().deleteByQuery(solrConfiguration.getQueryCollectionName(), childDeleteQuery);"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"solrConfiguration.getServer().deleteByQuery(solrConfiguration.getQueryCollectionName(), deleteQuery);"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"solrConfiguration.getServer().add(solrConfiguration.getQueryCollectionName(), documents);"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,@Override
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public Collection<SolrInputDocument> buildIncrementalIndex(List<? extends Indexable> indexables, SolrClient solrServer) throws ServiceException {"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"return buildIncrementalIndex(null, indexables, solrServer);"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,}
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public void optimizeIndex(SolrClient server) throws ServiceException, IOException {"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"optimizeIndex(null, server);"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public void commit(SolrClient server) throws ServiceException, IOException {"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"commit(null, server);"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"public void commit(SolrClient server, boolean softCommit, boolean waitSearcher, boolean waitFlush) throws ServiceException, IOException {"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"commit(null, server, softCommit, waitSearcher, waitFlush);"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void deleteAllNamespaceDocuments(SolrClient server) throws ServiceException {
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"deleteAllNamespaceDocuments(null, server);"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,public void deleteAllDocuments(SolrClient server) throws ServiceException {
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"deleteAllDocuments(null, server);"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,deleteAllNamespaceDocuments(solrConfiguration.getReindexServer());
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,optimizeIndex(solrConfiguration.getReindexServer());
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"buildIncrementalIndex(indexables, getSolrServerForIndexing());"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public void deleteAllNamespaceDocuments(SolrClient server) throws ServiceException {
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,server.deleteByQuery(deleteQuery);
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,server.commit();
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,public void deleteAllDocuments(SolrClient server) throws ServiceException {
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public Collection<SolrInputDocument> buildIncrementalIndex(List<? extends Indexable> indexables, SolrClient solrServer) throws ServiceException {"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,solrServer.add(documents);
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,commit(solrServer);
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public void optimizeIndex(SolrClient server) throws ServiceException, IOException {"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,shs.optimizeIndex(server);
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public void commit(SolrClient server) throws ServiceException, IOException {"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"commit(server, this.softCommit, this.waitSearcher, this.waitFlush);"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"public void commit(SolrClient server, boolean softCommit, boolean waitSearcher, boolean waitFlush) throws ServiceException, IOException {"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"server.commit(waitFlush, waitSearcher, softCommit);"
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,solrConfiguration.getServer().deleteByQuery(childDeleteQuery);
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,solrConfiguration.getServer().deleteByQuery(deleteQuery);
cbce6cef4f490a8a3b2e0afcff75737535525b39,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,solrConfiguration.getServer().add(documents);
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,import org.apache.commons.lang3.BooleanUtils;
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,import org.apache.commons.lang3.StringUtils;
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,import org.springframework.util.Assert;
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,if (StringUtils.isBlank(tagField) || StringUtils.isBlank(tag)) {
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"return """";"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,}
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,if (range != null) {
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"return buildSolrFacetQuery(tagField, range, true, tag);"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"return buildSolrFacetField(tagField, tag);"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,/**
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,* Builds a {@code facet.field} Solr param based on the {@code fieldName} provided.
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,*
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"* @param fieldName Name of the index field (e.g., mgf_s, heatRange_i, price_p)"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"* @param param Optional name of the param (e.g., tag, key, ex). Defaults to ""ex""."
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,* @return  a {@code facet.field} Solr param based on the {@code fieldName} provided.
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,*/
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"protected String buildSolrFacetField(String fieldName, String param) {"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"Assert.notNull(fieldName, ""FieldName cannot be null"");"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,if (StringUtils.isBlank(param)) {
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"param = ""ex"";"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"return String.format(""{!%s=%s}"", param, fieldName);"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,* Builds a {@code facet.query} Solr param based on the {@code range} and {@code fieldName} provided.
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,* <p>
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"* For example, if given the range of $0.00 - $5.00 on the price_p field, the default result would be"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,* {@code {!ex=price_p key=price_p[0.00:5.00] frange incl=false l=0.00 u=5.00}}.
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"* If {@code addExParam == false}, then this will produce"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,* {@code {!key=price_p[0.00:5.00] frange incl=false l=0.00 u=5.00}}.
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,* @param fieldName Name of the index field on which to query
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,* @param range {@link SearchFacetRange} representing the range for which to create a {@code facet.query}.
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"* @param addExParam Whether to add an exclude filter by tag (""ex"") parameter to the query. This assumes"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,*                  that the filter has a tag matching the {@code fieldName}. Defaults to true.
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"* @param param Optional name of the main param (e.g., tag, key, ex). Defaults to ""key""."
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,* @return a {@code facet.query} Solr param based on the {@code range} and {@code fieldName} provided.
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"protected String buildSolrFacetQuery(String fieldName, SearchFacetRange range, Boolean addExParam, String param) {"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"Assert.notNull(range, ""Range cannot be null"");"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"param = ""key"";"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,String rangeStart = range.getMinValue().toPlainString();
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"String rangeEnd = range.getMaxValue() != null ? range.getMaxValue().toPlainString() : ""*"";"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"String functions = getSolrRangeFunctionString(range.getMinValue(), range.getMaxValue());"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,if (BooleanUtils.isNotFalse(addExParam)) {
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"return String.format(""{!ex=%s %s=%s[%s:%s] %s}"", fieldName, param, fieldName, rangeStart, rangeEnd, functions);"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"return String.format(""{%s=%s[%s:%s] %s}"", param, fieldName, rangeStart, rangeEnd, functions);"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"for (Entry<String, String[]> filterCriteria : searchCriteria.getFilterCriteria().entrySet()) {"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"for (Entry<String, SearchFacetDTO> namedFacet : namedFacetMap.entrySet()) {"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,String facetFieldAbbreviation = namedFacet.getValue()
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,.getFacet()
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,.getField()
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,.getAbbreviation();
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,if (facetFieldAbbreviation.equals(filterCriteria.getKey())) {
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,solrKey = namedFacet.getKey();
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,namedFacet.getValue().setActive(true);
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,if (solrKey == null) {
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,continue;
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,String[] selectedValues = filterCriteria.getValue().clone();
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,for (int i = 0; i < selectedValues.length; i++) {
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"if (selectedValues[i].contains(""range["")) {"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"String rangeValue = selectedValues[i].substring(selectedValues[i].indexOf('[') + 1,"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,selectedValues[i].indexOf(']'));
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"String[] rangeValues = StringUtils.split(rangeValue, ':');"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,BigDecimal minValue = new BigDecimal(rangeValues[0]);
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,BigDecimal maxValue = null;
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"if (!rangeValues[1].equals(""null"")) {"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,maxValue = new BigDecimal(rangeValues[1]);
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"selectedValues[i] = getSolrRangeString(solrKey, minValue, maxValue);"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,} else {
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"selectedValues[i] = ""\"""" + scrubFacetValue(selectedValues[i]) + ""\"""";"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,List<String> valueStrings = new ArrayList<>();
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"ExtensionResultStatusType status = searchExtensionManager.getProxy().buildActiveFacetFilter(namedFacetMap.get(solrKey).getFacet(), selectedValues, valueStrings);"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,if (ExtensionResultStatusType.NOT_HANDLED.equals(status)) {
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"String range = StringUtils.join(selectedValues, "" OR "");"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,"valueStrings.add(String.format(""{!tag=%s}%s:(%s)"", solrKey, solrKey, range));"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,added,0,query.addFilterQuery(valueStrings.toArray(new String[valueStrings.size()]));
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,import org.apache.commons.lang.StringUtils;
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,StringBuilder sb = new StringBuilder();
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,if (StringUtils.isNotBlank(tag)) {
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"sb.append(""{!"").append(tag).append(""="").append(tagField);"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,if (range != null) {
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"sb.append(""["").append(range.getMinValue().toPlainString()).append("":"");"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,if (range.getMaxValue() != null) {
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,sb.append(range.getMaxValue().toPlainString());
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,} else {
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"sb.append(""*"");"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,}
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"sb.append(""]"");"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"sb.append("" "" + getSolrRangeFunctionString(range.getMinValue(), range.getMaxValue()));"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"sb.append(""}"");"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,return sb.toString();
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"for (Entry<String, String[]> entry : searchCriteria.getFilterCriteria().entrySet()) {"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"for (Entry<String, SearchFacetDTO> dtoEntry : namedFacetMap.entrySet()) {"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,if (dtoEntry.getValue().getFacet().getField().getAbbreviation().equals(entry.getKey())) {
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,solrKey = dtoEntry.getKey();
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,dtoEntry.getValue().setActive(true);
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,if (solrKey != null) {
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,String[] selectedValues = entry.getValue().clone();
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,boolean rangeQuery = false;
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,for (int i = 0; i < selectedValues.length; i++) {
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"if (selectedValues[i].contains(""range["")) {"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,rangeQuery = true;
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"String rangeValue = selectedValues[i].substring(selectedValues[i].indexOf('[') + 1,"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,selectedValues[i].indexOf(']'));
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"String[] rangeValues = StringUtils.split(rangeValue, ':');"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,BigDecimal minValue = new BigDecimal(rangeValues[0]);
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,BigDecimal maxValue = null;
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"if (!rangeValues[1].equals(""null"")) {"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,maxValue = new BigDecimal(rangeValues[1]);
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"selectedValues[i] = getSolrRangeString(solrKey, minValue, maxValue);"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"selectedValues[i] = ""\"""" + scrubFacetValue(selectedValues[i]) + ""\"""";"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,List<String> valueStrings = new ArrayList<>();
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"ExtensionResultStatusType status = searchExtensionManager.getProxy().buildActiveFacetFilter(namedFacetMap.get(solrKey).getFacet(), selectedValues, valueStrings);"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,if (ExtensionResultStatusType.NOT_HANDLED.equals(status)) {
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,StringBuilder valueString = new StringBuilder();
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,if (rangeQuery) {
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"valueString.append(solrKey).append("":("");"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"valueString.append(StringUtils.join(selectedValues, "" OR ""));"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"valueString.append("")"");"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,"valueString.append(""{!tag="").append(solrKey).append(""}"");"
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,valueStrings.add(valueString.toString());
2dc6d9cd439718bbd4328012f86074ec2e453484,fc6d6ed2e89b51332d0ae22ed604cbc68d9b6ab5,deleted,1,query.addFilterQuery(valueStrings.toArray(new String[valueStrings.size()]));
2150f29f13d5bc5e52fcea8e00ca55fe56d583dd,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,@Conditional(DemoCondition.class)
2150f29f13d5bc5e52fcea8e00ca55fe56d583dd,890d3bd7507b6843e8c814ac9ea719b7945fa177,added,0,"@Conditional({MTCondition.class, DemoCondition.class})"
2150f29f13d5bc5e52fcea8e00ca55fe56d583dd,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,@Bean
2150f29f13d5bc5e52fcea8e00ca55fe56d583dd,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,public AutoImportSql blLocaleData() {
2150f29f13d5bc5e52fcea8e00ca55fe56d583dd,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"return new AutoImportSql(AutoImportPersistenceUnit.BL_PU,""config/bc/sql/demo/load_locale.sql,"", BASIC_DATA_SPECIAL);"
2150f29f13d5bc5e52fcea8e00ca55fe56d583dd,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,}
671fa9414f725f00a01cb91c804e00691e4ae745,1b397c5267574a2aa47352245db66860acb1f75e,added,0,import javax.annotation.Resource;
671fa9414f725f00a01cb91c804e00691e4ae745,1b397c5267574a2aa47352245db66860acb1f75e,added,0,CustomerAddress savedAddress = customerAddressService.saveCustomerAddress(ca);
671fa9414f725f00a01cb91c804e00691e4ae745,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import javax.annotation.Resource;
671fa9414f725f00a01cb91c804e00691e4ae745,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,@Transactional
671fa9414f725f00a01cb91c804e00691e4ae745,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,CustomerAddress savedAddress = saveCustomerAddress(ca);
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,/*
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* #%L
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* BroadleafCommerce Common Libraries
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* %%
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* Copyright (C) 2009 - 2016 Broadleaf Commerce
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"* Licensed under the Broadleaf Fair Use License Agreement, Version 1.0"
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"* (the ""Fair Use License"" located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)"
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* unless the restrictions on use therein are violated and require payment to Broadleaf in which case
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"* the Broadleaf End User License Agreement (EULA), Version 1.1"
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"* (the ""Commercial License"" located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)"
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* shall apply.
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,*
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"* Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the ""Custom License"")"
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* #L%
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,*/
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,package org.broadleafcommerce.common.cache.engine;
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.ehcache.event.CacheEvent;
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.ehcache.event.CacheEventListener;
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.springframework.beans.factory.annotation.Autowired;
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.springframework.beans.factory.annotation.Qualifier;
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.springframework.beans.factory.annotation.Value;
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import org.springframework.stereotype.Component;
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import java.util.List;
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import javax.cache.Cache;
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import javax.cache.CacheManager;
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import javax.cache.configuration.FactoryBuilder;
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import javax.cache.configuration.MutableCacheEntryListenerConfiguration;
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,import javax.cache.event.CacheEntryListener;
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,/**
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,* @author jfischer
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Component(""blHydratedCacheEventListenerFactory"")"
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"public class HydratedCacheEventListenerFactory implements CacheEventListener, CacheEntryListener {"
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,private static HydratedCacheManager manager = null;
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public HydratedCacheEventListenerFactory() {
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,//todo what should be actually here for new ehcache ??
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,}
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,@Autowired
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"public HydratedCacheEventListenerFactory(@Qualifier(""blHydratedCacheMangager"") HydratedCacheManager hydratedCacheManager,"
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Qualifier(""blCacheManager"") CacheManager cacheManager,"
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Value(""${cache.hydratedCache.names}"") List<String> cacheNames,"
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Value(""${cache.hydratedCache.require.old.value:false}"") Boolean oldValue,"
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"@Value(""${cache.hydratedCache.require.synchronous:true}"") Boolean synchronous) {"
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,for (String cacheName : cacheNames) {
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"if(cacheName.startsWith(""$"")){"
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,continue;
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"Cache<?,?> cache = cacheManager.getCache(cacheName);"
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,"cache.registerCacheEntryListener(new MutableCacheEntryListenerConfiguration(FactoryBuilder.factoryOf(hydratedCacheManager), null, oldValue, synchronous));"
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,manager = hydratedCacheManager;
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public static HydratedCacheManager getConfiguredManager() {
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,return manager;
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,@Override
4bb4ac61f193919a7f8274e315ab2b83954dbf4f,1b397c5267574a2aa47352245db66860acb1f75e,deleted,1,public void onEvent(CacheEvent cacheEvent) {
ebe7dc347ee028ad8716a3687af112ee589c4966,88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,added,0,Class<?> aClass = entityConfiguration.createEntityInstance(entityType.getType()).getClass();
ebe7dc347ee028ad8716a3687af112ee589c4966,88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,added,0,"extensionManager.getProxy().setup(aClass, stage);"
ebe7dc347ee028ad8716a3687af112ee589c4966,88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,added,0,"extensionManager.getProxy().refineParameterRetrieve(aClass, stage, builder, criteria, root, restrictions);"
ebe7dc347ee028ad8716a3687af112ee589c4966,88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,added,0,"extensionManager.getProxy().refineQuery(aClass, stage, query);"
ebe7dc347ee028ad8716a3687af112ee589c4966,88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,deleted,1,"extensionManager.getProxy().setup(TranslationImpl.class, stage);"
ebe7dc347ee028ad8716a3687af112ee589c4966,88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,deleted,1,"extensionManager.getProxy().refineParameterRetrieve(TranslationImpl.class, stage, builder, criteria, root, restrictions);"
ebe7dc347ee028ad8716a3687af112ee589c4966,88e8ef9b7edbbb25587ddae2184ad2bd280a2a6b,deleted,1,"extensionManager.getProxy().refineQuery(TranslationImpl.class, stage, query);"
1b50e94e61d5c7ff4c326e438ebab194cd17e64c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (field.getTranslatable() && getTranslationEnabled()) {
1b50e94e61d5c7ff4c326e438ebab194cd17e64c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,if (getTranslationEnabled()) {
1b50e94e61d5c7ff4c326e438ebab194cd17e64c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"addEntitiesToTranslationCache(skuIds, TranslatedEntity.SKU);"
1b50e94e61d5c7ff4c326e438ebab194cd17e64c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"addEntitiesToTranslationCache(productIds, TranslatedEntity.PRODUCT);"
1b50e94e61d5c7ff4c326e438ebab194cd17e64c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"addEntitiesToTranslationCache(skuAttributeIds, TranslatedEntity.SKU_ATTRIBUTE);"
1b50e94e61d5c7ff4c326e438ebab194cd17e64c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,"addEntitiesToTranslationCache(productAttributeIds, TranslatedEntity.PRODUCT_ATTRIBUTE);"
1b50e94e61d5c7ff4c326e438ebab194cd17e64c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,added,0,}
1b50e94e61d5c7ff4c326e438ebab194cd17e64c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,if (field.getTranslatable()) {
1b50e94e61d5c7ff4c326e438ebab194cd17e64c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"addEntitiesToTranslationCache(skuIds, TranslatedEntity.SKU);"
1b50e94e61d5c7ff4c326e438ebab194cd17e64c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"addEntitiesToTranslationCache(productIds, TranslatedEntity.PRODUCT);"
1b50e94e61d5c7ff4c326e438ebab194cd17e64c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"addEntitiesToTranslationCache(skuAttributeIds, TranslatedEntity.SKU_ATTRIBUTE);"
1b50e94e61d5c7ff4c326e438ebab194cd17e64c,a3d8ed840d9f522b079e7b9e0494019cdc070eff,deleted,1,"addEntitiesToTranslationCache(productAttributeIds, TranslatedEntity.PRODUCT_ATTRIBUTE);"
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,@Bean
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,@Conditional(DemoCondition.class)
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,public AutoImportSql blCMSSequenceData() {
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"return new AutoImportSql(AutoImportPersistenceUnit.ALL,""config/bc/sql/demo/load_cms_table_sequences.sql"", AutoImportStage.ALL_TABLE_SEQUENCE);"
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,}
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,public AutoImportSql blFrameworkSequenceData() {
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"return new AutoImportSql(AutoImportPersistenceUnit.ALL,""config/bc/sql/demo/load_framework_table_sequences.sql"", AutoImportStage.ALL_TABLE_SEQUENCE);"
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,public AutoImportSql blProfileSequenceData() {
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"return new AutoImportSql(AutoImportPersistenceUnit.ALL,""config/bc/sql/demo/load_profile_table_sequences.sql"", AutoImportStage.ALL_TABLE_SEQUENCE);"
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,@Bean
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,@Conditional(DemoCondition.class)
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,public AutoImportSql blCMSSequenceData() {
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"return new AutoImportSql(AutoImportPersistenceUnit.ALL,""config/bc/sql/demo/load_cms_table_sequences.sql"", AutoImportStage.ALL_TABLE_SEQUENCE);"
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,}
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,public AutoImportSql blFrameworkSequenceData() {
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"return new AutoImportSql(AutoImportPersistenceUnit.ALL,""config/bc/sql/demo/load_framework_table_sequences.sql"", AutoImportStage.ALL_TABLE_SEQUENCE);"
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,public AutoImportSql blProfileSequenceData() {
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"return new AutoImportSql(AutoImportPersistenceUnit.ALL,""config/bc/sql/demo/load_profile_table_sequences.sql"", AutoImportStage.ALL_TABLE_SEQUENCE);"
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,@Bean
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,@Conditional(DemoCondition.class)
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,public AutoImportSql blCMSSequenceData() {
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"return new AutoImportSql(AutoImportPersistenceUnit.ALL,""config/bc/sql/demo/load_cms_table_sequences.sql"", AutoImportStage.ALL_TABLE_SEQUENCE);"
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,}
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,public AutoImportSql blFrameworkSequenceData() {
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"return new AutoImportSql(AutoImportPersistenceUnit.ALL,""config/bc/sql/demo/load_framework_table_sequences.sql"", AutoImportStage.ALL_TABLE_SEQUENCE);"
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,public AutoImportSql blProfileSequenceData() {
e0fc2c874ab9810b32a453a195f56d2fff7b645c,890d3bd7507b6843e8c814ac9ea719b7945fa177,deleted,1,"return new AutoImportSql(AutoImportPersistenceUnit.ALL,""config/bc/sql/demo/load_profile_table_sequences.sql"", AutoImportStage.ALL_TABLE_SEQUENCE);"
a47372e89d4751317288312d4fdf739046d45dd7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"String mvel = ""MvelHelper.toUpperCase(?discreteOrderItem.?category.?name)==MvelHelper.toUpperCase(\""merchandise\"")"";"
a47372e89d4751317288312d4fdf739046d45dd7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"String mvel = ""?order.?subTotal.getAmount()>=100"";"
a47372e89d4751317288312d4fdf739046d45dd7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"String d1Mvel = ""?discreteOrderItem.?category.?name==\""test category\"""";"
a47372e89d4751317288312d4fdf739046d45dd7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"String d2Mvel = ""!(?discreteOrderItem.?product.?manufacturer==\""test manufacturer\"")"";"
a47372e89d4751317288312d4fdf739046d45dd7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"String mvel = ""?fulfillmentGroup.?address.?state.?name==\""Texas\""&&(?fulfillmentGroup.?retailFulfillmentPrice.getAmount()>=99&&?fulfillmentGroup.?retailFulfillmentPrice.getAmount()<=199)"";"
a47372e89d4751317288312d4fdf739046d45dd7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,"String d1Mvel = ""CollectionUtils.intersection(?discreteOrderItem.?category.?name,[\""test category\"", \""test category 2\""]).size()>0"";"
a47372e89d4751317288312d4fdf739046d45dd7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"String mvel = ""MvelHelper.toUpperCase(discreteOrderItem.?category.?name)==MvelHelper.toUpperCase(\""merchandise\"")"";"
a47372e89d4751317288312d4fdf739046d45dd7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"String mvel = ""order.?subTotal.getAmount()>=100"";"
a47372e89d4751317288312d4fdf739046d45dd7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"String d1Mvel = ""discreteOrderItem.?category.?name==\""test category\"""";"
a47372e89d4751317288312d4fdf739046d45dd7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"String d2Mvel = ""!(discreteOrderItem.?product.?manufacturer==\""test manufacturer\"")"";"
a47372e89d4751317288312d4fdf739046d45dd7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"String mvel = ""fulfillmentGroup.?address.?state.?name==\""Texas\""&&(fulfillmentGroup.?retailFulfillmentPrice.getAmount()>=99&&fulfillmentGroup.?retailFulfillmentPrice.getAmount()<=199)"";"
a47372e89d4751317288312d4fdf739046d45dd7,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,"String d1Mvel = ""CollectionUtils.intersection(discreteOrderItem.?category.?name,[\""test category\"", \""test category 2\""]).size()>0"";"
0c1d19b239da6509582f8841e620b15fe8206ba8,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,import org.broadleafcommerce.common.security.service.ExploitProtectionService;
0c1d19b239da6509582f8841e620b15fe8206ba8,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,"@Resource(name = ""blExploitProtectionService"")"
0c1d19b239da6509582f8841e620b15fe8206ba8,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,ExploitProtectionService exploitProtectionService;
0c1d19b239da6509582f8841e620b15fe8206ba8,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,ef.setMainEntityName(exploitProtectionService.htmlDecode(p.getValue()));
0c1d19b239da6509582f8841e620b15fe8206ba8,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,field.setValue(exploitProtectionService.htmlDecode(entityProp.getValue()));
0c1d19b239da6509582f8841e620b15fe8206ba8,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,added,0,field.setValue(basicFM.isLargeEntry() ? entityProp.getValue() : exploitProtectionService.htmlDecode(entityProp.getValue()));
0c1d19b239da6509582f8841e620b15fe8206ba8,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,ef.setMainEntityName(p.getValue());
0c1d19b239da6509582f8841e620b15fe8206ba8,824d3ac5e805fbc4d0ccfc503adbc290a1d0521e,deleted,1,field.setValue(entityProp.getValue());
d6e37df807421162b69a1769fee3df49c9741220,3958e7959af5f39c7bbe15d8bbca97583e169a9f,added,0,if (customer != null && customer.isRegistered() && offer.isLimitedUsePerCustomer()) {
d6e37df807421162b69a1769fee3df49c9741220,3958e7959af5f39c7bbe15d8bbca97583e169a9f,deleted,1,if (offer.isLimitedUsePerCustomer()) {
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,import org.broadleafcommerce.common.currency.domain.BroadleafCurrencyImpl;
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,if (value == null) {
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,return null;
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,}
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,BroadleafCurrency currency = getCurrency();
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,// handle null currency by setting to system default
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,if (currency == null) {
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,currency = new BroadleafCurrencyImpl();
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,currency.setCurrencyCode(Money.defaultCurrency().getCurrencyCode());
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,"return new Money(value, currency, value.scale());"
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,"return value == null ? null : BroadleafCurrencyUtils.getMoney(value, getCurrency());"
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected Integer roundingScale;
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected RoundingMode roundingMode;
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,*
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"* It is sometimes problematic to offer percentage-off offers with regards to rounding. For example,"
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"* consider an item that costs 9.99 and has a 50% promotion. To be precise, the offer value is 4.995,"
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* but this may be a strange value to display to the user depending on the currency being used.
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (roundingMode != null) {
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return roundingMode;
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,} else {
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return RoundingMode.HALF_EVEN;
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public Integer getRoundingScale() {
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected boolean roundOfferValues = true;
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected int roundingScale = 2;
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected RoundingMode roundingMode = RoundingMode.HALF_EVEN;
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,*/
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public boolean isRoundOfferValues() {
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return roundOfferValues;
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,}
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,/**
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* @see #isRoundOfferValues()
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,*
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return roundingMode;
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public int getRoundingScale() {
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,BigDecimal offerValue = currentPriceDetailValue.getAmount().multiply(
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"offer.getValue().divide(new BigDecimal(""100""), 5, RoundingMode.HALF_EVEN));"
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,int scale = 2;
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (getCurrency() != null) {
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,// default scale to currency if currency is not null
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,scale = getCurrency().getJavaCurrency().getDefaultFractionDigits();
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (roundingScale != null) {
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,// override scale from rounding settings if set
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,scale = roundingScale;
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"adjustmentValue = new Money(offerValue, getCurrency(), scale);"
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,adjustmentValue = Money.trimUnnecessaryScaleToCurrency(adjustmentValue);
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"BigDecimal offerValue = currentPriceDetailValue.getAmount().multiply(offer.getValue().divide(new BigDecimal(""100""), 5, RoundingMode.HALF_EVEN));"
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (isRoundOfferValues()) {
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"offerValue = offerValue.setScale(roundingScale, roundingMode);"
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"adjustmentValue = new Money(offerValue, getCurrency(), 5);"
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"* It is sometimes problematic to offer percentage-off offers with regards to rounding. For example,"
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"* consider an item that costs 9.99 and has a 50% promotion. To be precise, the offer value is 4.995,"
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* but this may be a strange value to display to the user depending on the currency being used.
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,Integer getRoundingScale();
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,boolean isRoundOfferValues();
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,/**
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* Returns the rounding mode to use for rounding operations.
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* @return
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,*/
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* Returns the scale to use when rounding.
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,int getRoundingScale();
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,import org.apache.commons.lang3.StringUtils;
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,import org.broadleafcommerce.common.money.BankersRounding;
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,import org.broadleafcommerce.common.util.ApplicationContextHolder;
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,import org.broadleafcommerce.common.web.BroadleafRequestContext;
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,import org.broadleafcommerce.core.payment.service.OrderPaymentStatusService;
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,import org.springframework.context.ApplicationContext;
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,import java.math.RoundingMode;
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,private static RoundingMode _roundingMode;
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,if (! adjustment.isFutureCredit()) {
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,// preserve highest scale / allows adjustments to maintain more precision
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,// adjustments should only have more precision if the roundingScale was
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,// overridden
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,if (adjustment.getValue().getAmount().scale() >
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,adjustmentValue.getAmount().scale()) {
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,adjustmentValue = adjustment.getValue().add(adjustmentValue);
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,} else {
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,adjustmentValue = adjustmentValue.add(adjustment.getValue());
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,}
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,public RoundingMode getRoundingModeForAdj() {
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,RoundingMode mode = RoundingMode.HALF_EVEN;
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,if (_roundingMode == null) {
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,ApplicationContext ctx = ApplicationContextHolder.getApplicationContext();
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,if (ctx != null) {
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,String modeStr = ctx.getEnvironment().getProperty(
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,"""item.offer.percent.rounding.mode"");"
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,if (StringUtils.isNotEmpty(modeStr)) {
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,try {
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,mode = RoundingMode.valueOf(modeStr);
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,} catch (Exception e) {
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,e.printStackTrace();
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,_roundingMode = mode;
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,return _roundingMode;
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,"return getAdjustmentValue().multiplyWithRounding(quantity,"
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,getRoundingModeForAdj());
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,added,0,"return getFutureCreditAdjustmentValue().multiplyWithRounding(quantity,"
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,if (!adjustment.isFutureCredit()) {
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,adjustmentValue = adjustmentValue.add(adjustment.getValue());
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,return getAdjustmentValue().multiply(quantity);
a8b0e95b561232e35b7ef9e0007c0546e9dffdfd,62e9e329aac8eebda3431cd601360c9ffa46fc49,deleted,1,return getFutureCreditAdjustmentValue().multiply(quantity);
9e4165fee40aaf9741045f27e168187c3673bbc9,a4d551eb8e80d433566d7a54761750db6313563b,added,0,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region = ""blSearchElements"")"
9e4165fee40aaf9741045f27e168187c3673bbc9,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region = ""blStandardElements"")"
9e4165fee40aaf9741045f27e168187c3673bbc9,a4d551eb8e80d433566d7a54761750db6313563b,deleted,1,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region=""blStandardElements"")"
386a3fc3a504c62156477fe45d88f50c57783b88,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,if(subCriteria.getRules().size()==1){
386a3fc3a504c62156477fe45d88f50c57783b88,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,data.getRules().add(subCriteria.getRules().get(0));
386a3fc3a504c62156477fe45d88f50c57783b88,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,subCriteria.getRules().get(0).setCreatedFromSubGroup(false);
386a3fc3a504c62156477fe45d88f50c57783b88,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,}else {
386a3fc3a504c62156477fe45d88f50c57783b88,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,data.getRules().add(subCriteria);
386a3fc3a504c62156477fe45d88f50c57783b88,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,added,0,}
386a3fc3a504c62156477fe45d88f50c57783b88,4e7cd4c715216dfc86f0ece655f37de1e5aa654f,deleted,1,data.getRules().add(subCriteria);
f7603e6237de8e99638a5c31daccf7894270eca9,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* @see {@link org.broadleafcommerce.profile.web.site.security.CustomerStateFilter}
f7603e6237de8e99638a5c31daccf7894270eca9,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,*          <li>Create a new customer with null customer id</li>
f7603e6237de8e99638a5c31daccf7894270eca9,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* @see {@link #getAnonymousCustomerSessionAttributeName()}
f7603e6237de8e99638a5c31daccf7894270eca9,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* @see {@link #getAnonymousCustomerIdSessionAttributeName()}
f7603e6237de8e99638a5c31daccf7894270eca9,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,customer = customerService.createCustomerWithNullId();
f7603e6237de8e99638a5c31daccf7894270eca9,c791912933ec9b1311b63b4671d449207cad7e3f,added,0,* Once it has been persisted (like once the user has added something to the cart) then {@link #getAnonymousCustomerIdSessionAttributeName()}
f7603e6237de8e99638a5c31daccf7894270eca9,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,* @see {@link CustomerStateFilter}
f7603e6237de8e99638a5c31daccf7894270eca9,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,*          <li>Create a new customer</li>
f7603e6237de8e99638a5c31daccf7894270eca9,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,* @see {@link #getAnonymousCustomerAttributeName()}
f7603e6237de8e99638a5c31daccf7894270eca9,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,* @see {@link #getAnonymousCustomerIdAttributeName()}
f7603e6237de8e99638a5c31daccf7894270eca9,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,customer = customerService.createNewCustomer();
f7603e6237de8e99638a5c31daccf7894270eca9,c791912933ec9b1311b63b4671d449207cad7e3f,deleted,1,* Once it has been persisted (like once the user has added something to the cart) then {@link #getAnonymousCustomerIdAttributeName()}
f7603e6237de8e99638a5c31daccf7894270eca9,cdabda4e8cf99961c44011e9e015e13617026637,added,0,if (customer.getId() == null) {
f7603e6237de8e99638a5c31daccf7894270eca9,cdabda4e8cf99961c44011e9e015e13617026637,added,0,customer.setId(findNextCustomerId());
f7603e6237de8e99638a5c31daccf7894270eca9,cdabda4e8cf99961c44011e9e015e13617026637,added,0,}
f7603e6237de8e99638a5c31daccf7894270eca9,cdabda4e8cf99961c44011e9e015e13617026637,added,0,if (customer.getUsername() == null) {
f7603e6237de8e99638a5c31daccf7894270eca9,cdabda4e8cf99961c44011e9e015e13617026637,added,0,customer.setUsername(String.valueOf(customer.getId()));
f7603e6237de8e99638a5c31daccf7894270eca9,cdabda4e8cf99961c44011e9e015e13617026637,added,0,if (readCustomerById(customer.getId()) != null) {
f7603e6237de8e99638a5c31daccf7894270eca9,cdabda4e8cf99961c44011e9e015e13617026637,added,0,"throw new IllegalArgumentException(""Attempting to save a customer with an id ("" + customer.getId() + "") "" +"
f7603e6237de8e99638a5c31daccf7894270eca9,cdabda4e8cf99961c44011e9e015e13617026637,added,0,"""that already exists in the database. This can occur when legacy customers have been migrated to "" +"
f7603e6237de8e99638a5c31daccf7894270eca9,cdabda4e8cf99961c44011e9e015e13617026637,added,0,"""Broadleaf customers, but the batchStart setting has not been declared for id generation. In "" +"
f7603e6237de8e99638a5c31daccf7894270eca9,cdabda4e8cf99961c44011e9e015e13617026637,added,0,"""such a case, the defaultBatchStart property of IdGenerationDaoImpl (spring id of "" +"
f7603e6237de8e99638a5c31daccf7894270eca9,cdabda4e8cf99961c44011e9e015e13617026637,added,0,"""blIdGenerationDao) should be set to the appropriate start value."");"
f7603e6237de8e99638a5c31daccf7894270eca9,cdabda4e8cf99961c44011e9e015e13617026637,added,0,@Override
f7603e6237de8e99638a5c31daccf7894270eca9,cdabda4e8cf99961c44011e9e015e13617026637,added,0,public Customer createCustomerWithNullId() {
f7603e6237de8e99638a5c31daccf7894270eca9,cdabda4e8cf99961c44011e9e015e13617026637,added,0,return customerDao.create();
f7603e6237de8e99638a5c31daccf7894270eca9,cdabda4e8cf99961c44011e9e015e13617026637,added,0,@Deprecated
f7603e6237de8e99638a5c31daccf7894270eca9,cdabda4e8cf99961c44011e9e015e13617026637,deleted,1,/**
f7603e6237de8e99638a5c31daccf7894270eca9,cdabda4e8cf99961c44011e9e015e13617026637,deleted,1,* <p>This is simply a placeholder to be used by {@link #setupPasswordEncoder()} to determine if we're using the
f7603e6237de8e99638a5c31daccf7894270eca9,cdabda4e8cf99961c44011e9e015e13617026637,deleted,1,* new {@link PasswordEncoder} or the deprecated {@link org.springframework.security.authentication.encoding.PasswordEncoder PasswordEncoder}
f7603e6237de8e99638a5c31daccf7894270eca9,cdabda4e8cf99961c44011e9e015e13617026637,deleted,1,*/
f7603e6237de8e99638a5c31daccf7894270eca9,cdabda4e8cf99961c44011e9e015e13617026637,deleted,1,if (customer.getId() == null) {
f7603e6237de8e99638a5c31daccf7894270eca9,cdabda4e8cf99961c44011e9e015e13617026637,deleted,1,customer.setId(findNextCustomerId());
f7603e6237de8e99638a5c31daccf7894270eca9,cdabda4e8cf99961c44011e9e015e13617026637,deleted,1,}
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,/*-
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* #%L
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* BroadleafCommerce Framework
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* %%
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* Copyright (C) 2009 - 2022 Broadleaf Commerce
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"* Licensed under the Broadleaf Fair Use License Agreement, Version 1.0"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"* (the ""Fair Use License"" located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* unless the restrictions on use therein are violated and require payment to Broadleaf in which case
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"* the Broadleaf End User License Agreement (EULA), Version 1.1"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"* (the ""Commercial License"" located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* shall apply.
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,*
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"* Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the ""Custom License"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* #L%
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,*/
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,package org.broadleafcommerce.core.order.domain;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.copy.CreateResponse;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.copy.MultiTenantCopyContext;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.currency.util.BroadleafCurrencyUtils;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.currency.util.CurrencyCodeIdentifiable;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.extensibility.jpa.copy.DirectCopyTransform;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.extensibility.jpa.copy.DirectCopyTransformMember;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.extensibility.jpa.copy.DirectCopyTransformTypes;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.money.Money;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.presentation.AdminPresentation;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationClass;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationCollection;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.presentation.PopulateToOneFieldsEnum;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.presentation.client.SupportedFieldType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.presentation.override.AdminPresentationMergeEntry;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.presentation.override.AdminPresentationMergeOverride;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.presentation.override.AdminPresentationMergeOverrides;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.common.presentation.override.PropertyType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.core.offer.domain.CandidateFulfillmentGroupOffer;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.core.offer.domain.CandidateFulfillmentGroupOfferImpl;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.core.offer.domain.FulfillmentGroupAdjustment;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.core.offer.domain.FulfillmentGroupAdjustmentImpl;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.core.order.service.type.FulfillmentGroupStatusType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.core.order.service.type.FulfillmentType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.profile.core.domain.Address;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.profile.core.domain.AddressImpl;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.profile.core.domain.Phone;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.broadleafcommerce.profile.core.domain.PhoneImpl;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.hibernate.annotations.Cache;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.hibernate.annotations.CacheConcurrencyStrategy;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.hibernate.annotations.GenericGenerator;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.hibernate.annotations.Index;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import org.hibernate.annotations.Parameter;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import java.math.BigDecimal;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import java.util.ArrayList;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import java.util.List;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import java.util.Vector;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import javax.persistence.CascadeType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import javax.persistence.Column;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import javax.persistence.Entity;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import javax.persistence.FetchType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import javax.persistence.GeneratedValue;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import javax.persistence.Id;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import javax.persistence.Inheritance;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import javax.persistence.InheritanceType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import javax.persistence.JoinColumn;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import javax.persistence.JoinTable;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import javax.persistence.ManyToOne;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import javax.persistence.OneToMany;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,import javax.persistence.Table;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,@Entity
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,@Inheritance(strategy = InheritanceType.JOINED)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Table(name = ""BLC_FULFILLMENT_GROUP"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region = ""blOrderElements"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,@AdminPresentationMergeOverrides(
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,{
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentationMergeOverride(name = """", mergeEntries ="
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.READONLY,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"booleanOverrideValue = true)),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentationMergeOverride(name = ""currency"", mergeEntries ="
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.PROMINENT,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"booleanOverrideValue = false)),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentationMergeOverride(name = ""personalMessage"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.TAB,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"overrideValue = FulfillmentGroupImpl.Presentation.Tab.Name.Advanced),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.TABORDER,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,intOverrideValue = FulfillmentGroupImpl.Presentation.Tab.Order.Advanced)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"}),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentationMergeOverride(name = ""address"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"overrideValue = FulfillmentGroupImpl.Presentation.Tab.Name.Address),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,intOverrideValue = FulfillmentGroupImpl.Presentation.Tab.Order.Address)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentationMergeOverride(name = ""address.isDefault"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.EXCLUDED,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,booleanOverrideValue = true)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentationMergeOverride(name = ""address.isActive"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentationMergeOverride(name = ""address.isBusiness"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentationMergeOverride(name = ""phone"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentationMergeOverride(name = ""phone.phoneNumber"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"booleanOverrideValue = false),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.ORDER,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"intOverrideValue = FulfillmentGroupImpl.Presentation.FieldOrder.PHONE),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.GROUP,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"overrideValue = ""General""),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.REQUIREDOVERRIDE,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"overrideValue = ""NOT_REQUIRED"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,})
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,}
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentationClass(populateToOneFields = PopulateToOneFieldsEnum.TRUE, friendlyName = ""FulfillmentGroupImpl_baseFulfillmentGroup"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,@DirectCopyTransform({
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,@DirectCopyTransformMember(templateTokens = DirectCopyTransformTypes.MULTITENANT_SITE)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"public class FulfillmentGroupImpl implements FulfillmentGroup, CurrencyCodeIdentifiable {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,private static final long serialVersionUID = 1L;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,@Id
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@GeneratedValue(generator = ""FulfillmentGroupId"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,@GenericGenerator(
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"name=""FulfillmentGroupId"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"strategy=""org.broadleafcommerce.common.persistence.IdOverrideTableGenerator"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,parameters = {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Parameter(name=""segment_value"", value=""FulfillmentGroupImpl""),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Parameter(name=""entity_name"", value=""org.broadleafcommerce.core.order.domain.FulfillmentGroupImpl"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Column(name = ""FULFILLMENT_GROUP_ID"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected Long id;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Column(name = ""REFERENCE_NUMBER"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Index(name=""FG_REFERENCE_INDEX"", columnNames={""REFERENCE_NUMBER""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Reference_Number"", order=Presentation.FieldOrder.REFNUMBER,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,groupOrder = Presentation.Group.Order.General)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected String referenceNumber;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Column(name = ""METHOD"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Index(name=""FG_METHOD_INDEX"", columnNames={""METHOD""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,@AdminPresentation(excluded = true)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,@Deprecated
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected String method;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Column(name = ""SERVICE"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Index(name=""FG_SERVICE_INDEX"", columnNames={""SERVICE""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected String service;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Column(name = ""RETAIL_PRICE"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_Retail_Shipping_Price"", order=Presentation.FieldOrder.RETAIL,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"group = Presentation.Group.Name.Pricing, groupOrder = Presentation.Group.Order.Pricing,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"tab = Presentation.Tab.Name.Pricing, tabOrder = Presentation.Tab.Order.Pricing,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,fieldType=SupportedFieldType.MONEY)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected BigDecimal retailFulfillmentPrice;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Column(name = ""SALE_PRICE"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_Sale_Shipping_Price"", order=Presentation.FieldOrder.SALE,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected BigDecimal saleFulfillmentPrice;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Column(name = ""PRICE"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_Shipping_Price"", order=Presentation.FieldOrder.PRICE,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected BigDecimal fulfillmentPrice;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Column(name = ""TYPE"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Type"", order=Presentation.FieldOrder.TYPE,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"fieldType=SupportedFieldType.BROADLEAF_ENUMERATION,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"broadleafEnumeration=""org.broadleafcommerce.core.order.service.type.FulfillmentType"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"prominent = true, gridOrder = 3000)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected String type;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Column(name = ""TOTAL_TAX"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Total_Tax"", order=Presentation.FieldOrder.TOTALTAX,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected BigDecimal totalTax;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Column(name = ""TOTAL_ITEM_TAX"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Total_Item_Tax"", order=Presentation.FieldOrder.ITEMTAX,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected BigDecimal totalItemTax;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Column(name = ""TOTAL_FEE_TAX"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Total_Fee_Tax"", order=Presentation.FieldOrder.FEETAX,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected BigDecimal totalFeeTax;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Column(name = ""TOTAL_FG_TAX"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Total_FG_Tax"", order=Presentation.FieldOrder.FGTAX,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected BigDecimal totalFulfillmentGroupTax;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Column(name = ""DELIVERY_INSTRUCTION"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Delivery_Instruction"", order=Presentation.FieldOrder.DELIVERINSTRUCTION)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected String deliveryInstruction;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Column(name = ""IS_PRIMARY"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Index(name=""FG_PRIMARY_INDEX"", columnNames={""IS_PRIMARY""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_Primary_FG"", order=Presentation.FieldOrder.PRIMARY)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected boolean primary = false;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Column(name = ""MERCHANDISE_TOTAL"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Merchandise_Total"", order=Presentation.FieldOrder.MERCHANDISETOTAL,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected BigDecimal merchandiseTotal;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Column(name = ""TOTAL"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Total"", order=Presentation.FieldOrder.TOTAL,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"fieldType= SupportedFieldType.MONEY, prominent = true, gridOrder = 2000)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected BigDecimal total;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Column(name = ""STATUS"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Index(name=""FG_STATUS_INDEX"", columnNames={""STATUS""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Status"", order=Presentation.FieldOrder.STATUS,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"broadleafEnumeration=""org.broadleafcommerce.core.order.service.type.FulfillmentGroupStatusType"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"prominent = true, gridOrder = 4000)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected String status;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Column(name = ""SHIPPING_PRICE_TAXABLE"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_Shipping_Price_Taxable"", order=Presentation.FieldOrder.TAXABLE,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"tab = Presentation.Tab.Name.Pricing, tabOrder = Presentation.Tab.Order.Pricing)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected Boolean isShippingPriceTaxable = Boolean.FALSE;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@ManyToOne(targetEntity = FulfillmentOptionImpl.class, cascade = {CascadeType.PERSIST, CascadeType.MERGE, CascadeType.REFRESH})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@JoinColumn(name = ""FULFILLMENT_OPTION_ID"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected FulfillmentOption fulfillmentOption;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@ManyToOne(targetEntity = OrderImpl.class, optional=false)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@JoinColumn(name = ""ORDER_ID"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Index(name=""FG_ORDER_INDEX"", columnNames={""ORDER_ID""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected Order order;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Column(name = ""FULFILLMENT_GROUP_SEQUNCE"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected Integer sequence;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@ManyToOne(targetEntity = AddressImpl.class, cascade = {CascadeType.PERSIST, CascadeType.MERGE, CascadeType.REFRESH})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@JoinColumn(name = ""ADDRESS_ID"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Index(name=""FG_ADDRESS_INDEX"", columnNames={""ADDRESS_ID""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected Address address;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,/**
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* @deprecated uses the phonePrimary property on AddressImpl instead
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@ManyToOne(targetEntity = PhoneImpl.class, cascade = {CascadeType.PERSIST, CascadeType.MERGE, CascadeType.REFRESH})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@JoinColumn(name = ""PHONE_ID"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Index(name=""FG_PHONE_INDEX"", columnNames={""PHONE_ID""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected Phone phone;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@ManyToOne(targetEntity = PersonalMessageImpl.class, cascade = { CascadeType.ALL })"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@JoinColumn(name = ""PERSONAL_MESSAGE_ID"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Index(name=""FG_MESSAGE_INDEX"", columnNames={""PERSONAL_MESSAGE_ID""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected PersonalMessage personalMessage;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@OneToMany(mappedBy = ""fulfillmentGroup"", targetEntity = FulfillmentGroupItemImpl.class, cascade = CascadeType.ALL,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,orphanRemoval = true)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentationCollection(friendlyName=""FulfillmentGroupImpl_Items"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"tab = Presentation.Tab.Name.Items, tabOrder = Presentation.Tab.Order.Items)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected List<FulfillmentGroupItem> fulfillmentGroupItems = new ArrayList<FulfillmentGroupItem>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@OneToMany(mappedBy = ""fulfillmentGroup"", targetEntity = FulfillmentGroupFeeImpl.class, cascade = { CascadeType.ALL },"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentationCollection(friendlyName=""FulfillmentGroupImpl_Fees"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected List<FulfillmentGroupFee> fulfillmentGroupFees = new ArrayList<FulfillmentGroupFee>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@OneToMany(mappedBy = ""fulfillmentGroup"", targetEntity = CandidateFulfillmentGroupOfferImpl.class, cascade = { CascadeType.ALL },"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected List<CandidateFulfillmentGroupOffer> candidateOffers = new ArrayList<CandidateFulfillmentGroupOffer>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@OneToMany(mappedBy = ""fulfillmentGroup"", targetEntity = FulfillmentGroupAdjustmentImpl.class, cascade = { CascadeType.ALL },"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@AdminPresentationCollection(friendlyName=""FulfillmentGroupImpl_Adjustments"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"tab = Presentation.Tab.Name.Advanced, tabOrder = Presentation.Tab.Order.Advanced)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected List<FulfillmentGroupAdjustment> fulfillmentGroupAdjustments = new ArrayList<FulfillmentGroupAdjustment>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@OneToMany(fetch = FetchType.LAZY, targetEntity = TaxDetailImpl.class, cascade = { CascadeType.ALL }, orphanRemoval = true)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@JoinTable(name = ""BLC_FG_FG_TAX_XREF"", joinColumns = @JoinColumn(name = ""FULFILLMENT_GROUP_ID""),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"inverseJoinColumns = @JoinColumn(name = ""TAX_DETAIL_ID""))"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected List<TaxDetail> taxes = new ArrayList<TaxDetail>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"@Column(name = ""SHIPPING_OVERRIDE"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,protected Boolean shippingOverride;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,@Override
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public Long getId() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return id;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setId(Long id) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.id = id;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public Order getOrder() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return order;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setOrder(Order order) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.order = order;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public FulfillmentOption getFulfillmentOption() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return fulfillmentOption;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setFulfillmentOption(FulfillmentOption fulfillmentOption) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.fulfillmentOption = fulfillmentOption;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public String getReferenceNumber() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return referenceNumber;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setReferenceNumber(String referenceNumber) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.referenceNumber = referenceNumber;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public List<FulfillmentGroupItem> getFulfillmentGroupItems() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return fulfillmentGroupItems;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public List<DiscreteOrderItem> getDiscreteOrderItems() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,List<DiscreteOrderItem> discreteOrderItems = new ArrayList<DiscreteOrderItem>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,for (FulfillmentGroupItem fgItem : fulfillmentGroupItems) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,OrderItem orderItem = fgItem.getOrderItem();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (orderItem instanceof BundleOrderItem) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,BundleOrderItemImpl bundleOrderItem = (BundleOrderItemImpl)orderItem;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,for (DiscreteOrderItem discreteOrderItem : bundleOrderItem.getDiscreteOrderItems()) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,discreteOrderItems.add(discreteOrderItem);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,} else if (orderItem instanceof DiscreteOrderItem) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,DiscreteOrderItem discreteOrderItem = (DiscreteOrderItem)orderItem;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return discreteOrderItems;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setFulfillmentGroupItems(List<FulfillmentGroupItem> fulfillmentGroupItems) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.fulfillmentGroupItems = fulfillmentGroupItems;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void addFulfillmentGroupItem(FulfillmentGroupItem fulfillmentGroupItem) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (this.fulfillmentGroupItems == null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.fulfillmentGroupItems = new Vector<FulfillmentGroupItem>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.fulfillmentGroupItems.add(fulfillmentGroupItem);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public Address getAddress() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return address;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setAddress(Address address) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.address = address;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,* @deprecated use the phonePrimary property on the related Address instead
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public Phone getPhone() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return phone;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setPhone(Phone phone) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.phone = phone;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public String getMethod() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return method;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setMethod(String fulfillmentMethod) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.method = fulfillmentMethod;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public Money getRetailFulfillmentPrice() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return retailFulfillmentPrice == null ? null :
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"BroadleafCurrencyUtils.getMoney(retailFulfillmentPrice, getOrder().getCurrency());"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setRetailFulfillmentPrice(Money retailFulfillmentPrice) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.retailFulfillmentPrice = Money.toAmount(retailFulfillmentPrice);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public Money getRetailShippingPrice() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return getRetailFulfillmentPrice();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setRetailShippingPrice(Money retailShippingPrice) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,setRetailFulfillmentPrice(retailShippingPrice);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public FulfillmentType getType() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return FulfillmentType.getInstance(type);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setType(FulfillmentType type) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.type = type == null ? null : type.getType();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void addCandidateFulfillmentGroupOffer(CandidateFulfillmentGroupOffer candidateOffer) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,candidateOffers.add(candidateOffer);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public List<CandidateFulfillmentGroupOffer> getCandidateFulfillmentGroupOffers() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return candidateOffers;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setCandidateFulfillmentGroupOffer(List<CandidateFulfillmentGroupOffer> candidateOffers) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.candidateOffers = candidateOffers;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void removeAllCandidateOffers() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (candidateOffers != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,for (CandidateFulfillmentGroupOffer offer : candidateOffers) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,offer.setFulfillmentGroup(null);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,candidateOffers.clear();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public List<FulfillmentGroupAdjustment> getFulfillmentGroupAdjustments() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return this.fulfillmentGroupAdjustments;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public List<FulfillmentGroupAdjustment> getFutureCreditFulfillmentGroupAdjustments() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,List<FulfillmentGroupAdjustment> futureCreditAdjustments = new ArrayList<>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,for (FulfillmentGroupAdjustment adjustment : fulfillmentGroupAdjustments) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (adjustment.isFutureCredit()) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,futureCreditAdjustments.add(adjustment);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return futureCreditAdjustments;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public Money getFulfillmentGroupAdjustmentsValue() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"Money adjustmentsValue = BroadleafCurrencyUtils.getMoney(BigDecimal.ZERO, getOrder().getCurrency());"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (!adjustment.isFutureCredit()) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,adjustmentsValue = adjustmentsValue.add(adjustment.getValue());
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return adjustmentsValue;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public Money getFutureCreditFulfillmentGroupAdjustmentsValue() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,for (FulfillmentGroupAdjustment adjustment : getFutureCreditFulfillmentGroupAdjustments()) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void removeAllAdjustments() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (fulfillmentGroupAdjustments != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,adjustment.setFulfillmentGroup(null);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,fulfillmentGroupAdjustments.clear();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setFulfillmentGroupAdjustments(List<FulfillmentGroupAdjustment> fulfillmentGroupAdjustments) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.fulfillmentGroupAdjustments = fulfillmentGroupAdjustments;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public Money getSaleFulfillmentPrice() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"return saleFulfillmentPrice == null ? null : BroadleafCurrencyUtils.getMoney(saleFulfillmentPrice,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,getOrder().getCurrency());
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setSaleFulfillmentPrice(Money saleFulfillmentPrice) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.saleFulfillmentPrice = Money.toAmount(saleFulfillmentPrice);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public Money getSaleShippingPrice() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return getSaleFulfillmentPrice();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setSaleShippingPrice(Money saleShippingPrice) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,setSaleFulfillmentPrice(saleShippingPrice);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public Money getFulfillmentPrice() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"return fulfillmentPrice == null ? null : BroadleafCurrencyUtils.getMoney(fulfillmentPrice,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setFulfillmentPrice(Money fulfillmentPrice) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.fulfillmentPrice = Money.toAmount(fulfillmentPrice);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public Money getShippingPrice() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return getFulfillmentPrice();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setShippingPrice(Money shippingPrice) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,setFulfillmentPrice(shippingPrice);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public List<TaxDetail> getTaxes() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return taxes;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setTaxes(List<TaxDetail> taxes) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.taxes = taxes;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public Money getTotalTax() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"return totalTax == null ? null : BroadleafCurrencyUtils.getMoney(totalTax, getOrder().getCurrency());"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setTotalTax(Money totalTax) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.totalTax = Money.toAmount(totalTax);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public Money getTotalItemTax() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"return totalItemTax == null ? null : BroadleafCurrencyUtils.getMoney(totalItemTax, getOrder().getCurrency());"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setTotalItemTax(Money totalItemTax) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.totalItemTax = Money.toAmount(totalItemTax);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public Money getTotalFeeTax() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"return totalFeeTax == null ? null : BroadleafCurrencyUtils.getMoney(totalFeeTax, getOrder().getCurrency());"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setTotalFeeTax(Money totalFeeTax) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.totalFeeTax = Money.toAmount(totalFeeTax);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public Money getTotalFulfillmentGroupTax() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"return totalFulfillmentGroupTax == null ? null : BroadleafCurrencyUtils.getMoney(totalFulfillmentGroupTax,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setTotalFulfillmentGroupTax(Money totalFulfillmentGroupTax) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.totalFulfillmentGroupTax = Money.toAmount(totalFulfillmentGroupTax);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public String getDeliveryInstruction() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return deliveryInstruction;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setDeliveryInstruction(String deliveryInstruction) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.deliveryInstruction = deliveryInstruction;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public PersonalMessage getPersonalMessage() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return personalMessage;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setPersonalMessage(PersonalMessage personalMessage) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.personalMessage = personalMessage;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public boolean isPrimary() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return primary;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setPrimary(boolean primary) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.primary = primary;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public Money getMerchandiseTotal() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"return merchandiseTotal == null ? null : BroadleafCurrencyUtils.getMoney(merchandiseTotal,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setMerchandiseTotal(Money merchandiseTotal) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.merchandiseTotal = Money.toAmount(merchandiseTotal);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public Money getTotal() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"return total == null ? null : BroadleafCurrencyUtils.getMoney(total, getOrder().getCurrency());"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setTotal(Money orderTotal) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.total = Money.toAmount(orderTotal);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public FulfillmentGroupStatusType getStatus() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return FulfillmentGroupStatusType.getInstance(status);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setStatus(FulfillmentGroupStatusType status) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.status = status.getType();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public List<FulfillmentGroupFee> getFulfillmentGroupFees() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return fulfillmentGroupFees;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setFulfillmentGroupFees(List<FulfillmentGroupFee> fulfillmentGroupFees) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.fulfillmentGroupFees = fulfillmentGroupFees;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void addFulfillmentGroupFee(FulfillmentGroupFee fulfillmentGroupFee) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (fulfillmentGroupFees == null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,fulfillmentGroupFees = new ArrayList<FulfillmentGroupFee>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,fulfillmentGroupFees.add(fulfillmentGroupFee);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void removeAllFulfillmentGroupFees() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (fulfillmentGroupFees != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,fulfillmentGroupFees.clear();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public Boolean isShippingPriceTaxable() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return isShippingPriceTaxable;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setIsShippingPriceTaxable(Boolean isShippingPriceTaxable) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.isShippingPriceTaxable = isShippingPriceTaxable;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setSequence(Integer sequence) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.sequence = sequence;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public Integer getSequence() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return this.sequence;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public String getService() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return service;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setService(String service) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.service = service;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public String getCurrencyCode() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (getOrder().getCurrency() != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return getOrder().getCurrency().getCurrencyCode();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return null;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public Boolean getShippingOverride() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return shippingOverride == null ? false : shippingOverride;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public void setShippingOverride(Boolean shippingOverride) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,this.shippingOverride = shippingOverride;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public int hashCode() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,final int prime = 31;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,int result = 1;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,result = prime * result + ((address == null) ? 0 : address.hashCode());
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,result = prime * result + ((fulfillmentGroupItems == null) ? 0 : fulfillmentGroupItems.hashCode());
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return result;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public <G extends FulfillmentGroup> CreateResponse<G> createOrRetrieveCopyInstance(MultiTenantCopyContext context) throws CloneNotSupportedException {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,CreateResponse<G> createResponse = context.createOrRetrieveCopyInstance(this);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (createResponse.isAlreadyPopulated()) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return createResponse;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,FulfillmentGroup cloned = createResponse.getClone();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,cloned.setAddress(address == null ? null : address.createOrRetrieveCopyInstance(context).getClone());
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,cloned.setDeliveryInstruction(deliveryInstruction);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,cloned.setFulfillmentOption(fulfillmentOption);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,cloned.setFulfillmentPrice(fulfillmentPrice == null ? null : new Money(fulfillmentPrice));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,cloned.setIsShippingPriceTaxable(isShippingPriceTaxable == null ? null : isShippingPriceTaxable);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,cloned.setMerchandiseTotal(merchandiseTotal == null ? null : new Money(merchandiseTotal));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,cloned.setRetailFulfillmentPrice(fulfillmentPrice == null ? null : new Money(fulfillmentPrice));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"cloneTaxDetails(context, cloned);"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,cloned.setTotalItemTax(totalItemTax == null ? null : new Money(totalItemTax));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,cloned.setTotalFulfillmentGroupTax(totalFulfillmentGroupTax == null ? null : new Money(totalFulfillmentGroupTax));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,cloned.setTotalFeeTax(totalFeeTax == null ? null : new Money(totalFeeTax));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,cloned.setTotalTax(totalTax == null ? null : new Money(totalTax));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,cloned.setRetailFulfillmentPrice(retailFulfillmentPrice == null ? null : new Money(retailFulfillmentPrice));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,cloned.setSaleFulfillmentPrice(saleFulfillmentPrice == null ? null : new Money(saleFulfillmentPrice));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,cloned.setTotal(total == null ? null : new Money(total));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,cloned.setOrder(order);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,cloned.setPrimary(primary);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,cloned.setType(getType());
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,for (FulfillmentGroupItem fgi: fulfillmentGroupItems) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,FulfillmentGroupItem fulfillmentGroupItem = fgi.createOrRetrieveCopyInstance(context).getClone();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,fulfillmentGroupItem.setFulfillmentGroup(cloned);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,cloned.getFulfillmentGroupItems().add(fulfillmentGroupItem);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return  createResponse;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"protected void cloneTaxDetails(MultiTenantCopyContext context, FulfillmentGroup cloned) throws CloneNotSupportedException {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,for (TaxDetail taxDetail : getTaxes()) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,TaxDetail clonedTaxDetail = taxDetail.createOrRetrieveCopyInstance(context).getClone();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,cloned.getTaxes().add(clonedTaxDetail);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public boolean equals(Object obj) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (this == obj) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return true;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (obj == null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return false;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (!getClass().isAssignableFrom(obj.getClass())) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,FulfillmentGroupImpl other = (FulfillmentGroupImpl) obj;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (id != null && other.id != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,return id.equals(other.id);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (address == null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (other.address != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,} else if (!address.equals(other.address)) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (fulfillmentGroupItems == null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,if (other.fulfillmentGroupItems != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,} else if (!fulfillmentGroupItems.equals(other.fulfillmentGroupItems)) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static class Presentation {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static class Tab {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static class Name {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"public static final String Items = ""FulfillmentGroupImpl_Items_Tab"";"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"public static final String Pricing = ""FulfillmentGroupImpl_Pricing_Tab"";"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"public static final String Address = ""FulfillmentGroupImpl_Address_Tab"";"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"public static final String Advanced = ""FulfillmentGroupImpl_Advanced_Tab"";"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static class Order {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static final int Items = 2000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static final int Pricing = 3000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static final int Address = 4000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static final int Advanced = 5000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static class Group {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,"public static final String Pricing = ""FulfillmentGroupImpl_Pricing"";"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static final int General = 1000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static final int Pricing = 2000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static class FieldOrder {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static final int REFNUMBER = 3000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static final int STATUS = 4000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static final int TYPE = 5000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static final int DELIVERINSTRUCTION = 6000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static final int PRIMARY = 7000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static final int PHONE = 8000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static final int RETAIL = 1000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static final int SALE = 2000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static final int PRICE = 3000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static final int ITEMTAX = 4000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static final int FEETAX = 5000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static final int FGTAX = 6000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static final int TOTALTAX = 7000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static final int MERCHANDISETOTAL = 8000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static final int TOTAL = 9000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,added,0,public static final int TAXABLE = 10000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,/*
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* #%L
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* BroadleafCommerce Framework
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* %%
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* Copyright (C) 2009 - 2016 Broadleaf Commerce
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"* Licensed under the Broadleaf Fair Use License Agreement, Version 1.0"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"* (the ""Fair Use License"" located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* unless the restrictions on use therein are violated and require payment to Broadleaf in which case
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"* the Broadleaf End User License Agreement (EULA), Version 1.1"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"* (the ""Commercial License"" located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* shall apply.
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,*
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"* Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the ""Custom License"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* #L%
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,*/
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,package org.broadleafcommerce.core.order.domain;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.common.copy.CreateResponse;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.common.copy.MultiTenantCopyContext;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.common.currency.util.BroadleafCurrencyUtils;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.common.currency.util.CurrencyCodeIdentifiable;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.common.extensibility.jpa.copy.DirectCopyTransform;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.common.extensibility.jpa.copy.DirectCopyTransformMember;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.common.extensibility.jpa.copy.DirectCopyTransformTypes;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.common.money.Money;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentation;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentationClass;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentationCollection;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.common.presentation.PopulateToOneFieldsEnum;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.common.presentation.client.SupportedFieldType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.common.presentation.override.AdminPresentationMergeEntry;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.common.presentation.override.AdminPresentationMergeOverride;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.common.presentation.override.AdminPresentationMergeOverrides;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.common.presentation.override.PropertyType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.core.offer.domain.CandidateFulfillmentGroupOffer;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.core.offer.domain.CandidateFulfillmentGroupOfferImpl;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.core.offer.domain.FulfillmentGroupAdjustment;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.core.offer.domain.FulfillmentGroupAdjustmentImpl;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.core.order.service.type.FulfillmentGroupStatusType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.core.order.service.type.FulfillmentType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.profile.core.domain.Address;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.profile.core.domain.AddressImpl;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.profile.core.domain.Phone;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.broadleafcommerce.profile.core.domain.PhoneImpl;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.hibernate.annotations.Cache;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.hibernate.annotations.CacheConcurrencyStrategy;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.hibernate.annotations.GenericGenerator;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.hibernate.annotations.Index;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import org.hibernate.annotations.Parameter;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import java.math.BigDecimal;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import java.util.ArrayList;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import java.util.List;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import java.util.Vector;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import javax.persistence.CascadeType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import javax.persistence.Column;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import javax.persistence.Entity;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import javax.persistence.FetchType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import javax.persistence.GeneratedValue;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import javax.persistence.Id;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import javax.persistence.Inheritance;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import javax.persistence.InheritanceType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import javax.persistence.JoinColumn;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import javax.persistence.JoinTable;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import javax.persistence.ManyToOne;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import javax.persistence.OneToMany;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,import javax.persistence.Table;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,@Entity
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,@Inheritance(strategy = InheritanceType.JOINED)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Table(name = ""BLC_FULFILLMENT_GROUP"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region = ""blOrderElements"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,@AdminPresentationMergeOverrides(
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,{
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentationMergeOverride(name = """", mergeEntries ="
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.READONLY,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"booleanOverrideValue = true)),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentationMergeOverride(name = ""currency"", mergeEntries ="
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.PROMINENT,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"booleanOverrideValue = false)),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentationMergeOverride(name = ""personalMessage"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.TAB,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"overrideValue = FulfillmentGroupImpl.Presentation.Tab.Name.Advanced),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.TABORDER,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,intOverrideValue = FulfillmentGroupImpl.Presentation.Tab.Order.Advanced)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"}),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentationMergeOverride(name = ""address"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"overrideValue = FulfillmentGroupImpl.Presentation.Tab.Name.Address),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,intOverrideValue = FulfillmentGroupImpl.Presentation.Tab.Order.Address)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentationMergeOverride(name = ""address.isDefault"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.EXCLUDED,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,booleanOverrideValue = true)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentationMergeOverride(name = ""address.isActive"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentationMergeOverride(name = ""address.isBusiness"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentationMergeOverride(name = ""phone"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentationMergeOverride(name = ""phone.phoneNumber"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"booleanOverrideValue = false),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.ORDER,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"intOverrideValue = FulfillmentGroupImpl.Presentation.FieldOrder.PHONE),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.GROUP,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"overrideValue = ""General""),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.REQUIREDOVERRIDE,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"overrideValue = ""NOT_REQUIRED"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,})
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,}
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentationClass(populateToOneFields = PopulateToOneFieldsEnum.TRUE, friendlyName = ""FulfillmentGroupImpl_baseFulfillmentGroup"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,@DirectCopyTransform({
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,@DirectCopyTransformMember(templateTokens = DirectCopyTransformTypes.MULTITENANT_SITE)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"public class FulfillmentGroupImpl implements FulfillmentGroup, CurrencyCodeIdentifiable {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,private static final long serialVersionUID = 1L;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,@Id
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@GeneratedValue(generator = ""FulfillmentGroupId"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,@GenericGenerator(
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"name=""FulfillmentGroupId"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"strategy=""org.broadleafcommerce.common.persistence.IdOverrideTableGenerator"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,parameters = {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Parameter(name=""segment_value"", value=""FulfillmentGroupImpl""),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Parameter(name=""entity_name"", value=""org.broadleafcommerce.core.order.domain.FulfillmentGroupImpl"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Column(name = ""FULFILLMENT_GROUP_ID"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected Long id;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Column(name = ""REFERENCE_NUMBER"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Index(name=""FG_REFERENCE_INDEX"", columnNames={""REFERENCE_NUMBER""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Reference_Number"", order=Presentation.FieldOrder.REFNUMBER,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,groupOrder = Presentation.Group.Order.General)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected String referenceNumber;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Column(name = ""METHOD"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Index(name=""FG_METHOD_INDEX"", columnNames={""METHOD""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,@AdminPresentation(excluded = true)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,@Deprecated
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected String method;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Column(name = ""SERVICE"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Index(name=""FG_SERVICE_INDEX"", columnNames={""SERVICE""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected String service;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Column(name = ""RETAIL_PRICE"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_Retail_Shipping_Price"", order=Presentation.FieldOrder.RETAIL,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"group = Presentation.Group.Name.Pricing, groupOrder = Presentation.Group.Order.Pricing,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"tab = Presentation.Tab.Name.Pricing, tabOrder = Presentation.Tab.Order.Pricing,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,fieldType=SupportedFieldType.MONEY)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected BigDecimal retailFulfillmentPrice;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Column(name = ""SALE_PRICE"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_Sale_Shipping_Price"", order=Presentation.FieldOrder.SALE,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected BigDecimal saleFulfillmentPrice;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Column(name = ""PRICE"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_Shipping_Price"", order=Presentation.FieldOrder.PRICE,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected BigDecimal fulfillmentPrice;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Column(name = ""TYPE"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Type"", order=Presentation.FieldOrder.TYPE,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"fieldType=SupportedFieldType.BROADLEAF_ENUMERATION,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"broadleafEnumeration=""org.broadleafcommerce.core.order.service.type.FulfillmentType"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"prominent = true, gridOrder = 3000)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected String type;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Column(name = ""TOTAL_TAX"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Total_Tax"", order=Presentation.FieldOrder.TOTALTAX,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected BigDecimal totalTax;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Column(name = ""TOTAL_ITEM_TAX"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Total_Item_Tax"", order=Presentation.FieldOrder.ITEMTAX,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected BigDecimal totalItemTax;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Column(name = ""TOTAL_FEE_TAX"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Total_Fee_Tax"", order=Presentation.FieldOrder.FEETAX,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected BigDecimal totalFeeTax;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Column(name = ""TOTAL_FG_TAX"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Total_FG_Tax"", order=Presentation.FieldOrder.FGTAX,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected BigDecimal totalFulfillmentGroupTax;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Column(name = ""DELIVERY_INSTRUCTION"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Delivery_Instruction"", order=Presentation.FieldOrder.DELIVERINSTRUCTION)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected String deliveryInstruction;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Column(name = ""IS_PRIMARY"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Index(name=""FG_PRIMARY_INDEX"", columnNames={""IS_PRIMARY""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_Primary_FG"", order=Presentation.FieldOrder.PRIMARY)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected boolean primary = false;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Column(name = ""MERCHANDISE_TOTAL"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Merchandise_Total"", order=Presentation.FieldOrder.MERCHANDISETOTAL,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected BigDecimal merchandiseTotal;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Column(name = ""TOTAL"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Total"", order=Presentation.FieldOrder.TOTAL,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"fieldType= SupportedFieldType.MONEY, prominent = true, gridOrder = 2000)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected BigDecimal total;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Column(name = ""STATUS"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Index(name=""FG_STATUS_INDEX"", columnNames={""STATUS""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Status"", order=Presentation.FieldOrder.STATUS,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"broadleafEnumeration=""org.broadleafcommerce.core.order.service.type.FulfillmentGroupStatusType"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"prominent = true, gridOrder = 4000)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected String status;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Column(name = ""SHIPPING_PRICE_TAXABLE"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_Shipping_Price_Taxable"", order=Presentation.FieldOrder.TAXABLE,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"tab = Presentation.Tab.Name.Pricing, tabOrder = Presentation.Tab.Order.Pricing)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected Boolean isShippingPriceTaxable = Boolean.FALSE;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@ManyToOne(targetEntity = FulfillmentOptionImpl.class, cascade = {CascadeType.PERSIST, CascadeType.MERGE, CascadeType.REFRESH})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@JoinColumn(name = ""FULFILLMENT_OPTION_ID"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected FulfillmentOption fulfillmentOption;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@ManyToOne(targetEntity = OrderImpl.class, optional=false)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@JoinColumn(name = ""ORDER_ID"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Index(name=""FG_ORDER_INDEX"", columnNames={""ORDER_ID""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected Order order;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Column(name = ""FULFILLMENT_GROUP_SEQUNCE"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected Integer sequence;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@ManyToOne(targetEntity = AddressImpl.class, cascade = {CascadeType.PERSIST, CascadeType.MERGE, CascadeType.REFRESH})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@JoinColumn(name = ""ADDRESS_ID"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Index(name=""FG_ADDRESS_INDEX"", columnNames={""ADDRESS_ID""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected Address address;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,/**
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* @deprecated uses the phonePrimary property on AddressImpl instead
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@ManyToOne(targetEntity = PhoneImpl.class, cascade = {CascadeType.PERSIST, CascadeType.MERGE, CascadeType.REFRESH})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@JoinColumn(name = ""PHONE_ID"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Index(name=""FG_PHONE_INDEX"", columnNames={""PHONE_ID""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected Phone phone;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@ManyToOne(targetEntity = PersonalMessageImpl.class, cascade = { CascadeType.ALL })"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@JoinColumn(name = ""PERSONAL_MESSAGE_ID"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Index(name=""FG_MESSAGE_INDEX"", columnNames={""PERSONAL_MESSAGE_ID""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected PersonalMessage personalMessage;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@OneToMany(mappedBy = ""fulfillmentGroup"", targetEntity = FulfillmentGroupItemImpl.class, cascade = CascadeType.ALL,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,orphanRemoval = true)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentationCollection(friendlyName=""FulfillmentGroupImpl_Items"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"tab = Presentation.Tab.Name.Items, tabOrder = Presentation.Tab.Order.Items)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected List<FulfillmentGroupItem> fulfillmentGroupItems = new ArrayList<FulfillmentGroupItem>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@OneToMany(mappedBy = ""fulfillmentGroup"", targetEntity = FulfillmentGroupFeeImpl.class, cascade = { CascadeType.ALL },"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentationCollection(friendlyName=""FulfillmentGroupImpl_Fees"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected List<FulfillmentGroupFee> fulfillmentGroupFees = new ArrayList<FulfillmentGroupFee>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@OneToMany(mappedBy = ""fulfillmentGroup"", targetEntity = CandidateFulfillmentGroupOfferImpl.class, cascade = { CascadeType.ALL },"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected List<CandidateFulfillmentGroupOffer> candidateOffers = new ArrayList<CandidateFulfillmentGroupOffer>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@OneToMany(mappedBy = ""fulfillmentGroup"", targetEntity = FulfillmentGroupAdjustmentImpl.class, cascade = { CascadeType.ALL },"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@AdminPresentationCollection(friendlyName=""FulfillmentGroupImpl_Adjustments"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"tab = Presentation.Tab.Name.Advanced, tabOrder = Presentation.Tab.Order.Advanced)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected List<FulfillmentGroupAdjustment> fulfillmentGroupAdjustments = new ArrayList<FulfillmentGroupAdjustment>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@OneToMany(fetch = FetchType.LAZY, targetEntity = TaxDetailImpl.class, cascade = { CascadeType.ALL }, orphanRemoval = true)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@JoinTable(name = ""BLC_FG_FG_TAX_XREF"", joinColumns = @JoinColumn(name = ""FULFILLMENT_GROUP_ID""),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"inverseJoinColumns = @JoinColumn(name = ""TAX_DETAIL_ID""))"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected List<TaxDetail> taxes = new ArrayList<TaxDetail>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"@Column(name = ""SHIPPING_OVERRIDE"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,protected Boolean shippingOverride;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,@Override
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public Long getId() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return id;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setId(Long id) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.id = id;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public Order getOrder() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return order;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setOrder(Order order) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.order = order;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public FulfillmentOption getFulfillmentOption() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return fulfillmentOption;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setFulfillmentOption(FulfillmentOption fulfillmentOption) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.fulfillmentOption = fulfillmentOption;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public String getReferenceNumber() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return referenceNumber;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setReferenceNumber(String referenceNumber) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.referenceNumber = referenceNumber;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public List<FulfillmentGroupItem> getFulfillmentGroupItems() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return fulfillmentGroupItems;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public List<DiscreteOrderItem> getDiscreteOrderItems() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,List<DiscreteOrderItem> discreteOrderItems = new ArrayList<DiscreteOrderItem>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (FulfillmentGroupItem fgItem : fulfillmentGroupItems) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,OrderItem orderItem = fgItem.getOrderItem();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (orderItem instanceof BundleOrderItem) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,BundleOrderItemImpl bundleOrderItem = (BundleOrderItemImpl)orderItem;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (DiscreteOrderItem discreteOrderItem : bundleOrderItem.getDiscreteOrderItems()) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,discreteOrderItems.add(discreteOrderItem);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,} else if (orderItem instanceof DiscreteOrderItem) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,DiscreteOrderItem discreteOrderItem = (DiscreteOrderItem)orderItem;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return discreteOrderItems;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setFulfillmentGroupItems(List<FulfillmentGroupItem> fulfillmentGroupItems) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.fulfillmentGroupItems = fulfillmentGroupItems;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void addFulfillmentGroupItem(FulfillmentGroupItem fulfillmentGroupItem) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (this.fulfillmentGroupItems == null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.fulfillmentGroupItems = new Vector<FulfillmentGroupItem>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.fulfillmentGroupItems.add(fulfillmentGroupItem);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public Address getAddress() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return address;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setAddress(Address address) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.address = address;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,* @deprecated use the phonePrimary property on the related Address instead
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public Phone getPhone() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return phone;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setPhone(Phone phone) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.phone = phone;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public String getMethod() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return method;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setMethod(String fulfillmentMethod) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.method = fulfillmentMethod;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public Money getRetailFulfillmentPrice() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return retailFulfillmentPrice == null ? null :
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"BroadleafCurrencyUtils.getMoney(retailFulfillmentPrice, getOrder().getCurrency());"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setRetailFulfillmentPrice(Money retailFulfillmentPrice) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.retailFulfillmentPrice = Money.toAmount(retailFulfillmentPrice);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public Money getRetailShippingPrice() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return getRetailFulfillmentPrice();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setRetailShippingPrice(Money retailShippingPrice) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,setRetailFulfillmentPrice(retailShippingPrice);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public FulfillmentType getType() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return FulfillmentType.getInstance(type);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setType(FulfillmentType type) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.type = type == null ? null : type.getType();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void addCandidateFulfillmentGroupOffer(CandidateFulfillmentGroupOffer candidateOffer) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,candidateOffers.add(candidateOffer);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public List<CandidateFulfillmentGroupOffer> getCandidateFulfillmentGroupOffers() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return candidateOffers;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setCandidateFulfillmentGroupOffer(List<CandidateFulfillmentGroupOffer> candidateOffers) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.candidateOffers = candidateOffers;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void removeAllCandidateOffers() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (candidateOffers != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (CandidateFulfillmentGroupOffer offer : candidateOffers) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,offer.setFulfillmentGroup(null);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,candidateOffers.clear();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public List<FulfillmentGroupAdjustment> getFulfillmentGroupAdjustments() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return this.fulfillmentGroupAdjustments;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public List<FulfillmentGroupAdjustment> getFutureCreditFulfillmentGroupAdjustments() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,List<FulfillmentGroupAdjustment> futureCreditAdjustments = new ArrayList<>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (FulfillmentGroupAdjustment adjustment : fulfillmentGroupAdjustments) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (adjustment.isFutureCredit()) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,futureCreditAdjustments.add(adjustment);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return futureCreditAdjustments;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public Money getFulfillmentGroupAdjustmentsValue() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"Money adjustmentsValue = BroadleafCurrencyUtils.getMoney(BigDecimal.ZERO, getOrder().getCurrency());"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (!adjustment.isFutureCredit()) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,adjustmentsValue = adjustmentsValue.add(adjustment.getValue());
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return adjustmentsValue;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public Money getFutureCreditFulfillmentGroupAdjustmentsValue() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (FulfillmentGroupAdjustment adjustment : getFutureCreditFulfillmentGroupAdjustments()) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void removeAllAdjustments() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (fulfillmentGroupAdjustments != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,adjustment.setFulfillmentGroup(null);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,fulfillmentGroupAdjustments.clear();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setFulfillmentGroupAdjustments(List<FulfillmentGroupAdjustment> fulfillmentGroupAdjustments) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.fulfillmentGroupAdjustments = fulfillmentGroupAdjustments;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public Money getSaleFulfillmentPrice() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"return saleFulfillmentPrice == null ? null : BroadleafCurrencyUtils.getMoney(saleFulfillmentPrice,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,getOrder().getCurrency());
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setSaleFulfillmentPrice(Money saleFulfillmentPrice) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.saleFulfillmentPrice = Money.toAmount(saleFulfillmentPrice);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public Money getSaleShippingPrice() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return getSaleFulfillmentPrice();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setSaleShippingPrice(Money saleShippingPrice) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,setSaleFulfillmentPrice(saleShippingPrice);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public Money getFulfillmentPrice() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"return fulfillmentPrice == null ? null : BroadleafCurrencyUtils.getMoney(fulfillmentPrice,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setFulfillmentPrice(Money fulfillmentPrice) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.fulfillmentPrice = Money.toAmount(fulfillmentPrice);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public Money getShippingPrice() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return getFulfillmentPrice();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setShippingPrice(Money shippingPrice) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,setFulfillmentPrice(shippingPrice);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public List<TaxDetail> getTaxes() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return taxes;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setTaxes(List<TaxDetail> taxes) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.taxes = taxes;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public Money getTotalTax() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"return totalTax == null ? null : BroadleafCurrencyUtils.getMoney(totalTax, getOrder().getCurrency());"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setTotalTax(Money totalTax) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.totalTax = Money.toAmount(totalTax);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public Money getTotalItemTax() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"return totalItemTax == null ? null : BroadleafCurrencyUtils.getMoney(totalItemTax, getOrder().getCurrency());"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setTotalItemTax(Money totalItemTax) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.totalItemTax = Money.toAmount(totalItemTax);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public Money getTotalFeeTax() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"return totalFeeTax == null ? null : BroadleafCurrencyUtils.getMoney(totalFeeTax, getOrder().getCurrency());"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setTotalFeeTax(Money totalFeeTax) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.totalFeeTax = Money.toAmount(totalFeeTax);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public Money getTotalFulfillmentGroupTax() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"return totalFulfillmentGroupTax == null ? null : BroadleafCurrencyUtils.getMoney(totalFulfillmentGroupTax,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setTotalFulfillmentGroupTax(Money totalFulfillmentGroupTax) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.totalFulfillmentGroupTax = Money.toAmount(totalFulfillmentGroupTax);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public String getDeliveryInstruction() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return deliveryInstruction;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setDeliveryInstruction(String deliveryInstruction) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.deliveryInstruction = deliveryInstruction;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public PersonalMessage getPersonalMessage() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return personalMessage;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setPersonalMessage(PersonalMessage personalMessage) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.personalMessage = personalMessage;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public boolean isPrimary() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return primary;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setPrimary(boolean primary) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.primary = primary;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public Money getMerchandiseTotal() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"return merchandiseTotal == null ? null : BroadleafCurrencyUtils.getMoney(merchandiseTotal,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setMerchandiseTotal(Money merchandiseTotal) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.merchandiseTotal = Money.toAmount(merchandiseTotal);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public Money getTotal() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"return total == null ? null : BroadleafCurrencyUtils.getMoney(total, getOrder().getCurrency());"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setTotal(Money orderTotal) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.total = Money.toAmount(orderTotal);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public FulfillmentGroupStatusType getStatus() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return FulfillmentGroupStatusType.getInstance(status);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setStatus(FulfillmentGroupStatusType status) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.status = status.getType();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public List<FulfillmentGroupFee> getFulfillmentGroupFees() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return fulfillmentGroupFees;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setFulfillmentGroupFees(List<FulfillmentGroupFee> fulfillmentGroupFees) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.fulfillmentGroupFees = fulfillmentGroupFees;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void addFulfillmentGroupFee(FulfillmentGroupFee fulfillmentGroupFee) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (fulfillmentGroupFees == null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,fulfillmentGroupFees = new ArrayList<FulfillmentGroupFee>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,fulfillmentGroupFees.add(fulfillmentGroupFee);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void removeAllFulfillmentGroupFees() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (fulfillmentGroupFees != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,fulfillmentGroupFees.clear();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public Boolean isShippingPriceTaxable() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return isShippingPriceTaxable;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setIsShippingPriceTaxable(Boolean isShippingPriceTaxable) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.isShippingPriceTaxable = isShippingPriceTaxable;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setSequence(Integer sequence) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.sequence = sequence;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public Integer getSequence() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return this.sequence;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public String getService() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return service;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setService(String service) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.service = service;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public String getCurrencyCode() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (getOrder().getCurrency() != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return getOrder().getCurrency().getCurrencyCode();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return null;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public Boolean getShippingOverride() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return shippingOverride == null ? false : shippingOverride;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public void setShippingOverride(Boolean shippingOverride) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,this.shippingOverride = shippingOverride;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public int hashCode() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,final int prime = 31;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,int result = 1;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,result = prime * result + ((address == null) ? 0 : address.hashCode());
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,result = prime * result + ((fulfillmentGroupItems == null) ? 0 : fulfillmentGroupItems.hashCode());
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return result;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public <G extends FulfillmentGroup> CreateResponse<G> createOrRetrieveCopyInstance(MultiTenantCopyContext context) throws CloneNotSupportedException {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,CreateResponse<G> createResponse = context.createOrRetrieveCopyInstance(this);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (createResponse.isAlreadyPopulated()) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return createResponse;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,FulfillmentGroup cloned = createResponse.getClone();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,cloned.setAddress(address == null ? null : address.createOrRetrieveCopyInstance(context).getClone());
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,cloned.setDeliveryInstruction(deliveryInstruction);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,cloned.setFulfillmentOption(fulfillmentOption);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,cloned.setFulfillmentPrice(fulfillmentPrice == null ? null : new Money(fulfillmentPrice));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,cloned.setIsShippingPriceTaxable(isShippingPriceTaxable == null ? null : isShippingPriceTaxable);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,cloned.setMerchandiseTotal(merchandiseTotal == null ? null : new Money(merchandiseTotal));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,cloned.setRetailFulfillmentPrice(fulfillmentPrice == null ? null : new Money(fulfillmentPrice));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"cloneTaxDetails(context, cloned);"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,cloned.setTotalItemTax(totalItemTax == null ? null : new Money(totalItemTax));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,cloned.setTotalFulfillmentGroupTax(totalFulfillmentGroupTax == null ? null : new Money(totalFulfillmentGroupTax));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,cloned.setTotalFeeTax(totalFeeTax == null ? null : new Money(totalFeeTax));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,cloned.setTotalTax(totalTax == null ? null : new Money(totalTax));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,cloned.setRetailFulfillmentPrice(retailFulfillmentPrice == null ? null : new Money(retailFulfillmentPrice));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,cloned.setSaleFulfillmentPrice(saleFulfillmentPrice == null ? null : new Money(saleFulfillmentPrice));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,cloned.setTotal(total == null ? null : new Money(total));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,cloned.setOrder(order);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,cloned.setPrimary(primary);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,cloned.setType(getType());
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (FulfillmentGroupItem fgi: fulfillmentGroupItems) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,FulfillmentGroupItem fulfillmentGroupItem = fgi.createOrRetrieveCopyInstance(context).getClone();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,fulfillmentGroupItem.setFulfillmentGroup(cloned);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,cloned.getFulfillmentGroupItems().add(fulfillmentGroupItem);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return  createResponse;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"protected void cloneTaxDetails(MultiTenantCopyContext context, FulfillmentGroup cloned) throws CloneNotSupportedException {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,for (TaxDetail taxDetail : getTaxes()) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,TaxDetail clonedTaxDetail = taxDetail.createOrRetrieveCopyInstance(context).getClone();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,cloned.getTaxes().add(clonedTaxDetail);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public boolean equals(Object obj) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (this == obj) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return true;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (obj == null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return false;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (!getClass().isAssignableFrom(obj.getClass())) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,FulfillmentGroupImpl other = (FulfillmentGroupImpl) obj;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (id != null && other.id != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,return id.equals(other.id);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (address == null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (other.address != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,} else if (!address.equals(other.address)) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (fulfillmentGroupItems == null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,if (other.fulfillmentGroupItems != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,} else if (!fulfillmentGroupItems.equals(other.fulfillmentGroupItems)) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static class Presentation {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static class Tab {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static class Name {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"public static final String Items = ""FulfillmentGroupImpl_Items_Tab"";"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"public static final String Pricing = ""FulfillmentGroupImpl_Pricing_Tab"";"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"public static final String Address = ""FulfillmentGroupImpl_Address_Tab"";"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"public static final String Advanced = ""FulfillmentGroupImpl_Advanced_Tab"";"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static class Order {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static final int Items = 2000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static final int Pricing = 3000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static final int Address = 4000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static final int Advanced = 5000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static class Group {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,"public static final String Pricing = ""FulfillmentGroupImpl_Pricing"";"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static final int General = 1000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static final int Pricing = 2000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static class FieldOrder {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static final int REFNUMBER = 3000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static final int STATUS = 4000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static final int TYPE = 5000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static final int DELIVERINSTRUCTION = 6000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static final int PRIMARY = 7000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static final int PHONE = 8000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static final int RETAIL = 1000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static final int SALE = 2000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static final int PRICE = 3000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static final int ITEMTAX = 4000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static final int FEETAX = 5000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static final int FGTAX = 6000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static final int TOTALTAX = 7000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static final int MERCHANDISETOTAL = 8000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static final int TOTAL = 9000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,b842e4ba7fb4745f6ecfee6ababf1fdd8edac0f7,deleted,1,public static final int TAXABLE = 10000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,/*-
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,* #%L
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,* BroadleafCommerce Framework
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,* %%
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,* Copyright (C) 2009 - 2022 Broadleaf Commerce
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"* Licensed under the Broadleaf Fair Use License Agreement, Version 1.0"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"* (the ""Fair Use License"" located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,* unless the restrictions on use therein are violated and require payment to Broadleaf in which case
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"* the Broadleaf End User License Agreement (EULA), Version 1.1"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"* (the ""Commercial License"" located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,* shall apply.
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,*
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"* Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the ""Custom License"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,* between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,* #L%
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,*/
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,package org.broadleafcommerce.core.order.domain;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.copy.CreateResponse;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.copy.MultiTenantCopyContext;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.currency.util.BroadleafCurrencyUtils;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.currency.util.CurrencyCodeIdentifiable;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.extensibility.jpa.copy.DirectCopyTransform;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.extensibility.jpa.copy.DirectCopyTransformMember;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.extensibility.jpa.copy.DirectCopyTransformTypes;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.money.Money;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.AdminPresentation;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationClass;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.AdminPresentationCollection;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.PopulateToOneFieldsEnum;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.client.SupportedFieldType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.override.AdminPresentationMergeEntry;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.override.AdminPresentationMergeOverride;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.override.AdminPresentationMergeOverrides;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.common.presentation.override.PropertyType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.core.offer.domain.CandidateFulfillmentGroupOffer;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.core.offer.domain.CandidateFulfillmentGroupOfferImpl;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.core.offer.domain.FulfillmentGroupAdjustment;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.core.offer.domain.FulfillmentGroupAdjustmentImpl;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.core.order.service.type.FulfillmentGroupStatusType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.core.order.service.type.FulfillmentType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.profile.core.domain.Address;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.profile.core.domain.AddressImpl;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.profile.core.domain.Phone;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.broadleafcommerce.profile.core.domain.PhoneImpl;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.hibernate.annotations.Cache;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.hibernate.annotations.CacheConcurrencyStrategy;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.hibernate.annotations.GenericGenerator;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.hibernate.annotations.Index;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import org.hibernate.annotations.Parameter;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import java.math.BigDecimal;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import java.util.ArrayList;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import java.util.List;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import java.util.Vector;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.CascadeType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.Column;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.Entity;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.FetchType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.GeneratedValue;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.Id;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.Inheritance;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.InheritanceType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.JoinColumn;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.JoinTable;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.ManyToOne;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.OneToMany;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,import javax.persistence.Table;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@Entity
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@Inheritance(strategy = InheritanceType.JOINED)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Table(name = ""BLC_FULFILLMENT_GROUP"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region = ""blOrderElements"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@AdminPresentationMergeOverrides(
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,{
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeOverride(name = """", mergeEntries ="
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.READONLY,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"booleanOverrideValue = true)),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeOverride(name = ""currency"", mergeEntries ="
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.PROMINENT,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"booleanOverrideValue = false)),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeOverride(name = ""personalMessage"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.TAB,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"overrideValue = FulfillmentGroupImpl.Presentation.Tab.Name.Advanced),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.TABORDER,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,intOverrideValue = FulfillmentGroupImpl.Presentation.Tab.Order.Advanced)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"}),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeOverride(name = ""address"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"overrideValue = FulfillmentGroupImpl.Presentation.Tab.Name.Address),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,intOverrideValue = FulfillmentGroupImpl.Presentation.Tab.Order.Address)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeOverride(name = ""address.isDefault"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.EXCLUDED,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,booleanOverrideValue = true)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeOverride(name = ""address.isActive"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeOverride(name = ""address.isBusiness"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeOverride(name = ""phone"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeOverride(name = ""phone.phoneNumber"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"booleanOverrideValue = false),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.ORDER,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"intOverrideValue = FulfillmentGroupImpl.Presentation.FieldOrder.PHONE),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.GROUP,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"overrideValue = ""General""),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.REQUIREDOVERRIDE,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"overrideValue = ""NOT_REQUIRED"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,})
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,}
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationClass(populateToOneFields = PopulateToOneFieldsEnum.TRUE, friendlyName = ""FulfillmentGroupImpl_baseFulfillmentGroup"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@DirectCopyTransform({
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@DirectCopyTransformMember(templateTokens = DirectCopyTransformTypes.MULTITENANT_SITE)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"public class FulfillmentGroupImpl implements FulfillmentGroup, CurrencyCodeIdentifiable {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,private static final long serialVersionUID = 1L;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@Id
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@GeneratedValue(generator = ""FulfillmentGroupId"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@GenericGenerator(
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"name=""FulfillmentGroupId"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"strategy=""org.broadleafcommerce.common.persistence.IdOverrideTableGenerator"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,parameters = {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Parameter(name=""segment_value"", value=""FulfillmentGroupImpl""),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Parameter(name=""entity_name"", value=""org.broadleafcommerce.core.order.domain.FulfillmentGroupImpl"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""FULFILLMENT_GROUP_ID"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected Long id;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""REFERENCE_NUMBER"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Index(name=""FG_REFERENCE_INDEX"", columnNames={""REFERENCE_NUMBER""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Reference_Number"", order=Presentation.FieldOrder.REFNUMBER,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,groupOrder = Presentation.Group.Order.General)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected String referenceNumber;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""METHOD"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Index(name=""FG_METHOD_INDEX"", columnNames={""METHOD""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@AdminPresentation(excluded = true)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@Deprecated
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected String method;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""SERVICE"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Index(name=""FG_SERVICE_INDEX"", columnNames={""SERVICE""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected String service;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""RETAIL_PRICE"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_Retail_Shipping_Price"", order=Presentation.FieldOrder.RETAIL,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"group = Presentation.Group.Name.Pricing, groupOrder = Presentation.Group.Order.Pricing,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"tab = Presentation.Tab.Name.Pricing, tabOrder = Presentation.Tab.Order.Pricing,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,fieldType=SupportedFieldType.MONEY)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected BigDecimal retailFulfillmentPrice;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""SALE_PRICE"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_Sale_Shipping_Price"", order=Presentation.FieldOrder.SALE,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected BigDecimal saleFulfillmentPrice;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""PRICE"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_Shipping_Price"", order=Presentation.FieldOrder.PRICE,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected BigDecimal fulfillmentPrice;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""TYPE"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Type"", order=Presentation.FieldOrder.TYPE,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"fieldType=SupportedFieldType.BROADLEAF_ENUMERATION,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"broadleafEnumeration=""org.broadleafcommerce.core.order.service.type.FulfillmentType"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"prominent = true, gridOrder = 3000)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected String type;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""TOTAL_TAX"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Total_Tax"", order=Presentation.FieldOrder.TOTALTAX,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected BigDecimal totalTax;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""TOTAL_ITEM_TAX"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Total_Item_Tax"", order=Presentation.FieldOrder.ITEMTAX,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected BigDecimal totalItemTax;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""TOTAL_FEE_TAX"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Total_Fee_Tax"", order=Presentation.FieldOrder.FEETAX,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected BigDecimal totalFeeTax;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""TOTAL_FG_TAX"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Total_FG_Tax"", order=Presentation.FieldOrder.FGTAX,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected BigDecimal totalFulfillmentGroupTax;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""DELIVERY_INSTRUCTION"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Delivery_Instruction"", order=Presentation.FieldOrder.DELIVERINSTRUCTION)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected String deliveryInstruction;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""IS_PRIMARY"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Index(name=""FG_PRIMARY_INDEX"", columnNames={""IS_PRIMARY""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_Primary_FG"", order=Presentation.FieldOrder.PRIMARY)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected boolean primary = false;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""MERCHANDISE_TOTAL"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Merchandise_Total"", order=Presentation.FieldOrder.MERCHANDISETOTAL,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected BigDecimal merchandiseTotal;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""TOTAL"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Total"", order=Presentation.FieldOrder.TOTAL,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"fieldType= SupportedFieldType.MONEY, prominent = true, gridOrder = 2000)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected BigDecimal total;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""STATUS"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Index(name=""FG_STATUS_INDEX"", columnNames={""STATUS""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Status"", order=Presentation.FieldOrder.STATUS,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"broadleafEnumeration=""org.broadleafcommerce.core.order.service.type.FulfillmentGroupStatusType"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"prominent = true, gridOrder = 4000)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected String status;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""SHIPPING_PRICE_TAXABLE"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_Shipping_Price_Taxable"", order=Presentation.FieldOrder.TAXABLE,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"tab = Presentation.Tab.Name.Pricing, tabOrder = Presentation.Tab.Order.Pricing)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected Boolean isShippingPriceTaxable = Boolean.FALSE;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@ManyToOne(targetEntity = FulfillmentOptionImpl.class, cascade = {CascadeType.PERSIST, CascadeType.MERGE, CascadeType.REFRESH})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@JoinColumn(name = ""FULFILLMENT_OPTION_ID"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected FulfillmentOption fulfillmentOption;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@ManyToOne(targetEntity = OrderImpl.class, optional=false)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@JoinColumn(name = ""ORDER_ID"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Index(name=""FG_ORDER_INDEX"", columnNames={""ORDER_ID""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected Order order;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""FULFILLMENT_GROUP_SEQUNCE"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected Integer sequence;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@ManyToOne(targetEntity = AddressImpl.class, cascade = {CascadeType.PERSIST, CascadeType.MERGE, CascadeType.REFRESH})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@JoinColumn(name = ""ADDRESS_ID"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Index(name=""FG_ADDRESS_INDEX"", columnNames={""ADDRESS_ID""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected Address address;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,/**
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,* @deprecated uses the phonePrimary property on AddressImpl instead
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@ManyToOne(targetEntity = PhoneImpl.class, cascade = {CascadeType.PERSIST, CascadeType.MERGE, CascadeType.REFRESH})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@JoinColumn(name = ""PHONE_ID"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Index(name=""FG_PHONE_INDEX"", columnNames={""PHONE_ID""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected Phone phone;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@ManyToOne(targetEntity = PersonalMessageImpl.class, cascade = { CascadeType.ALL })"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@JoinColumn(name = ""PERSONAL_MESSAGE_ID"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Index(name=""FG_MESSAGE_INDEX"", columnNames={""PERSONAL_MESSAGE_ID""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected PersonalMessage personalMessage;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@OneToMany(mappedBy = ""fulfillmentGroup"", targetEntity = FulfillmentGroupItemImpl.class, cascade = CascadeType.ALL,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,orphanRemoval = true)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationCollection(friendlyName=""FulfillmentGroupImpl_Items"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"tab = Presentation.Tab.Name.Items, tabOrder = Presentation.Tab.Order.Items)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected List<FulfillmentGroupItem> fulfillmentGroupItems = new ArrayList<FulfillmentGroupItem>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@OneToMany(mappedBy = ""fulfillmentGroup"", targetEntity = FulfillmentGroupFeeImpl.class, cascade = { CascadeType.ALL },"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationCollection(friendlyName=""FulfillmentGroupImpl_Fees"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected List<FulfillmentGroupFee> fulfillmentGroupFees = new ArrayList<FulfillmentGroupFee>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@OneToMany(mappedBy = ""fulfillmentGroup"", targetEntity = CandidateFulfillmentGroupOfferImpl.class, cascade = { CascadeType.ALL },"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected List<CandidateFulfillmentGroupOffer> candidateOffers = new ArrayList<CandidateFulfillmentGroupOffer>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@OneToMany(mappedBy = ""fulfillmentGroup"", targetEntity = FulfillmentGroupAdjustmentImpl.class, cascade = { CascadeType.ALL },"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@AdminPresentationCollection(friendlyName=""FulfillmentGroupImpl_Adjustments"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"tab = Presentation.Tab.Name.Advanced, tabOrder = Presentation.Tab.Order.Advanced)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected List<FulfillmentGroupAdjustment> fulfillmentGroupAdjustments = new ArrayList<FulfillmentGroupAdjustment>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@OneToMany(fetch = FetchType.LAZY, targetEntity = TaxDetailImpl.class, cascade = { CascadeType.ALL }, orphanRemoval = true)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@JoinTable(name = ""BLC_FG_FG_TAX_XREF"", joinColumns = @JoinColumn(name = ""FULFILLMENT_GROUP_ID""),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"inverseJoinColumns = @JoinColumn(name = ""TAX_DETAIL_ID""))"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected List<TaxDetail> taxes = new ArrayList<TaxDetail>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"@Column(name = ""SHIPPING_OVERRIDE"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,protected Boolean shippingOverride;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,@Override
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Long getId() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return id;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setId(Long id) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.id = id;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Order getOrder() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return order;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setOrder(Order order) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.order = order;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public FulfillmentOption getFulfillmentOption() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return fulfillmentOption;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setFulfillmentOption(FulfillmentOption fulfillmentOption) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.fulfillmentOption = fulfillmentOption;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public String getReferenceNumber() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return referenceNumber;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setReferenceNumber(String referenceNumber) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.referenceNumber = referenceNumber;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public List<FulfillmentGroupItem> getFulfillmentGroupItems() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return fulfillmentGroupItems;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public List<DiscreteOrderItem> getDiscreteOrderItems() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,List<DiscreteOrderItem> discreteOrderItems = new ArrayList<DiscreteOrderItem>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,for (FulfillmentGroupItem fgItem : fulfillmentGroupItems) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,OrderItem orderItem = fgItem.getOrderItem();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (orderItem instanceof BundleOrderItem) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,BundleOrderItemImpl bundleOrderItem = (BundleOrderItemImpl)orderItem;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,for (DiscreteOrderItem discreteOrderItem : bundleOrderItem.getDiscreteOrderItems()) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,discreteOrderItems.add(discreteOrderItem);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,} else if (orderItem instanceof DiscreteOrderItem) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,DiscreteOrderItem discreteOrderItem = (DiscreteOrderItem)orderItem;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return discreteOrderItems;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setFulfillmentGroupItems(List<FulfillmentGroupItem> fulfillmentGroupItems) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.fulfillmentGroupItems = fulfillmentGroupItems;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void addFulfillmentGroupItem(FulfillmentGroupItem fulfillmentGroupItem) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (this.fulfillmentGroupItems == null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.fulfillmentGroupItems = new Vector<FulfillmentGroupItem>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.fulfillmentGroupItems.add(fulfillmentGroupItem);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Address getAddress() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return address;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setAddress(Address address) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.address = address;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,* @deprecated use the phonePrimary property on the related Address instead
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Phone getPhone() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return phone;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setPhone(Phone phone) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.phone = phone;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public String getMethod() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return method;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setMethod(String fulfillmentMethod) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.method = fulfillmentMethod;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Money getRetailFulfillmentPrice() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return retailFulfillmentPrice == null ? null :
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"BroadleafCurrencyUtils.getMoney(retailFulfillmentPrice, getOrder().getCurrency());"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setRetailFulfillmentPrice(Money retailFulfillmentPrice) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.retailFulfillmentPrice = Money.toAmount(retailFulfillmentPrice);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Money getRetailShippingPrice() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return getRetailFulfillmentPrice();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setRetailShippingPrice(Money retailShippingPrice) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,setRetailFulfillmentPrice(retailShippingPrice);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public FulfillmentType getType() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return FulfillmentType.getInstance(type);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setType(FulfillmentType type) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.type = type == null ? null : type.getType();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void addCandidateFulfillmentGroupOffer(CandidateFulfillmentGroupOffer candidateOffer) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,candidateOffers.add(candidateOffer);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public List<CandidateFulfillmentGroupOffer> getCandidateFulfillmentGroupOffers() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return candidateOffers;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setCandidateFulfillmentGroupOffer(List<CandidateFulfillmentGroupOffer> candidateOffers) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.candidateOffers = candidateOffers;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void removeAllCandidateOffers() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (candidateOffers != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,for (CandidateFulfillmentGroupOffer offer : candidateOffers) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,offer.setFulfillmentGroup(null);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,candidateOffers.clear();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public List<FulfillmentGroupAdjustment> getFulfillmentGroupAdjustments() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return this.fulfillmentGroupAdjustments;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public List<FulfillmentGroupAdjustment> getFutureCreditFulfillmentGroupAdjustments() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,List<FulfillmentGroupAdjustment> futureCreditAdjustments = new ArrayList<>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,for (FulfillmentGroupAdjustment adjustment : fulfillmentGroupAdjustments) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (adjustment.isFutureCredit()) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,futureCreditAdjustments.add(adjustment);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return futureCreditAdjustments;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Money getFulfillmentGroupAdjustmentsValue() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"Money adjustmentsValue = BroadleafCurrencyUtils.getMoney(BigDecimal.ZERO, getOrder().getCurrency());"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (!adjustment.isFutureCredit()) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,adjustmentsValue = adjustmentsValue.add(adjustment.getValue());
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return adjustmentsValue;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Money getFutureCreditFulfillmentGroupAdjustmentsValue() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,for (FulfillmentGroupAdjustment adjustment : getFutureCreditFulfillmentGroupAdjustments()) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void removeAllAdjustments() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (fulfillmentGroupAdjustments != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,adjustment.setFulfillmentGroup(null);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,fulfillmentGroupAdjustments.clear();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setFulfillmentGroupAdjustments(List<FulfillmentGroupAdjustment> fulfillmentGroupAdjustments) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.fulfillmentGroupAdjustments = fulfillmentGroupAdjustments;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Money getSaleFulfillmentPrice() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"return saleFulfillmentPrice == null ? null : BroadleafCurrencyUtils.getMoney(saleFulfillmentPrice,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,getOrder().getCurrency());
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setSaleFulfillmentPrice(Money saleFulfillmentPrice) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.saleFulfillmentPrice = Money.toAmount(saleFulfillmentPrice);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Money getSaleShippingPrice() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return getSaleFulfillmentPrice();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setSaleShippingPrice(Money saleShippingPrice) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,setSaleFulfillmentPrice(saleShippingPrice);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Money getFulfillmentPrice() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"return fulfillmentPrice == null ? null : BroadleafCurrencyUtils.getMoney(fulfillmentPrice,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setFulfillmentPrice(Money fulfillmentPrice) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.fulfillmentPrice = Money.toAmount(fulfillmentPrice);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Money getShippingPrice() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return getFulfillmentPrice();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setShippingPrice(Money shippingPrice) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,setFulfillmentPrice(shippingPrice);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public List<TaxDetail> getTaxes() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return taxes;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setTaxes(List<TaxDetail> taxes) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.taxes = taxes;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Money getTotalTax() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"return totalTax == null ? null : BroadleafCurrencyUtils.getMoney(totalTax, getOrder().getCurrency());"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setTotalTax(Money totalTax) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.totalTax = Money.toAmount(totalTax);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Money getTotalItemTax() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"return totalItemTax == null ? null : BroadleafCurrencyUtils.getMoney(totalItemTax, getOrder().getCurrency());"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setTotalItemTax(Money totalItemTax) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.totalItemTax = Money.toAmount(totalItemTax);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Money getTotalFeeTax() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"return totalFeeTax == null ? null : BroadleafCurrencyUtils.getMoney(totalFeeTax, getOrder().getCurrency());"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setTotalFeeTax(Money totalFeeTax) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.totalFeeTax = Money.toAmount(totalFeeTax);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Money getTotalFulfillmentGroupTax() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"return totalFulfillmentGroupTax == null ? null : BroadleafCurrencyUtils.getMoney(totalFulfillmentGroupTax,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setTotalFulfillmentGroupTax(Money totalFulfillmentGroupTax) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.totalFulfillmentGroupTax = Money.toAmount(totalFulfillmentGroupTax);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public String getDeliveryInstruction() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return deliveryInstruction;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setDeliveryInstruction(String deliveryInstruction) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.deliveryInstruction = deliveryInstruction;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public PersonalMessage getPersonalMessage() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return personalMessage;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setPersonalMessage(PersonalMessage personalMessage) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.personalMessage = personalMessage;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public boolean isPrimary() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return primary;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setPrimary(boolean primary) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.primary = primary;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Money getMerchandiseTotal() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"return merchandiseTotal == null ? null : BroadleafCurrencyUtils.getMoney(merchandiseTotal,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setMerchandiseTotal(Money merchandiseTotal) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.merchandiseTotal = Money.toAmount(merchandiseTotal);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Money getTotal() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"return total == null ? null : BroadleafCurrencyUtils.getMoney(total, getOrder().getCurrency());"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setTotal(Money orderTotal) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.total = Money.toAmount(orderTotal);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public FulfillmentGroupStatusType getStatus() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return FulfillmentGroupStatusType.getInstance(status);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setStatus(FulfillmentGroupStatusType status) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.status = status.getType();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public List<FulfillmentGroupFee> getFulfillmentGroupFees() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return fulfillmentGroupFees;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setFulfillmentGroupFees(List<FulfillmentGroupFee> fulfillmentGroupFees) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.fulfillmentGroupFees = fulfillmentGroupFees;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void addFulfillmentGroupFee(FulfillmentGroupFee fulfillmentGroupFee) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (fulfillmentGroupFees == null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,fulfillmentGroupFees = new ArrayList<FulfillmentGroupFee>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,fulfillmentGroupFees.add(fulfillmentGroupFee);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void removeAllFulfillmentGroupFees() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (fulfillmentGroupFees != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,fulfillmentGroupFees.clear();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Boolean isShippingPriceTaxable() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return isShippingPriceTaxable;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setIsShippingPriceTaxable(Boolean isShippingPriceTaxable) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.isShippingPriceTaxable = isShippingPriceTaxable;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setSequence(Integer sequence) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.sequence = sequence;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Integer getSequence() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return this.sequence;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public String getService() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return service;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setService(String service) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.service = service;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public String getCurrencyCode() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (getOrder().getCurrency() != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return getOrder().getCurrency().getCurrencyCode();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return null;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public Boolean getShippingOverride() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return shippingOverride == null ? false : shippingOverride;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public void setShippingOverride(Boolean shippingOverride) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,this.shippingOverride = shippingOverride;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public int hashCode() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,final int prime = 31;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,int result = 1;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,result = prime * result + ((address == null) ? 0 : address.hashCode());
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,result = prime * result + ((fulfillmentGroupItems == null) ? 0 : fulfillmentGroupItems.hashCode());
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return result;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public <G extends FulfillmentGroup> CreateResponse<G> createOrRetrieveCopyInstance(MultiTenantCopyContext context) throws CloneNotSupportedException {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,CreateResponse<G> createResponse = context.createOrRetrieveCopyInstance(this);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (createResponse.isAlreadyPopulated()) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return createResponse;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,FulfillmentGroup cloned = createResponse.getClone();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,cloned.setAddress(address == null ? null : address.createOrRetrieveCopyInstance(context).getClone());
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,cloned.setDeliveryInstruction(deliveryInstruction);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,cloned.setFulfillmentOption(fulfillmentOption);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,cloned.setFulfillmentPrice(fulfillmentPrice == null ? null : new Money(fulfillmentPrice));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,cloned.setIsShippingPriceTaxable(isShippingPriceTaxable == null ? null : isShippingPriceTaxable);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,cloned.setMerchandiseTotal(merchandiseTotal == null ? null : new Money(merchandiseTotal));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,cloned.setRetailFulfillmentPrice(fulfillmentPrice == null ? null : new Money(fulfillmentPrice));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"cloneTaxDetails(context, cloned);"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,cloned.setTotalItemTax(totalItemTax == null ? null : new Money(totalItemTax));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,cloned.setTotalFulfillmentGroupTax(totalFulfillmentGroupTax == null ? null : new Money(totalFulfillmentGroupTax));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,cloned.setTotalFeeTax(totalFeeTax == null ? null : new Money(totalFeeTax));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,cloned.setTotalTax(totalTax == null ? null : new Money(totalTax));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,cloned.setRetailFulfillmentPrice(retailFulfillmentPrice == null ? null : new Money(retailFulfillmentPrice));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,cloned.setSaleFulfillmentPrice(saleFulfillmentPrice == null ? null : new Money(saleFulfillmentPrice));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,cloned.setTotal(total == null ? null : new Money(total));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,cloned.setOrder(order);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,cloned.setPrimary(primary);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,cloned.setType(getType());
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,for (FulfillmentGroupItem fgi: fulfillmentGroupItems) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,FulfillmentGroupItem fulfillmentGroupItem = fgi.createOrRetrieveCopyInstance(context).getClone();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,fulfillmentGroupItem.setFulfillmentGroup(cloned);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,cloned.getFulfillmentGroupItems().add(fulfillmentGroupItem);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return  createResponse;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"protected void cloneTaxDetails(MultiTenantCopyContext context, FulfillmentGroup cloned) throws CloneNotSupportedException {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,for (TaxDetail taxDetail : getTaxes()) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,TaxDetail clonedTaxDetail = taxDetail.createOrRetrieveCopyInstance(context).getClone();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,cloned.getTaxes().add(clonedTaxDetail);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public boolean equals(Object obj) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (this == obj) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return true;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (obj == null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return false;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (!getClass().isAssignableFrom(obj.getClass())) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,FulfillmentGroupImpl other = (FulfillmentGroupImpl) obj;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (id != null && other.id != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,return id.equals(other.id);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (address == null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (other.address != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,} else if (!address.equals(other.address)) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (fulfillmentGroupItems == null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,if (other.fulfillmentGroupItems != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,} else if (!fulfillmentGroupItems.equals(other.fulfillmentGroupItems)) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static class Presentation {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static class Tab {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static class Name {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"public static final String Items = ""FulfillmentGroupImpl_Items_Tab"";"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"public static final String Pricing = ""FulfillmentGroupImpl_Pricing_Tab"";"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"public static final String Address = ""FulfillmentGroupImpl_Address_Tab"";"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"public static final String Advanced = ""FulfillmentGroupImpl_Advanced_Tab"";"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static class Order {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int Items = 2000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int Pricing = 3000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int Address = 4000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int Advanced = 5000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static class Group {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,"public static final String Pricing = ""FulfillmentGroupImpl_Pricing"";"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int General = 1000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int Pricing = 2000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static class FieldOrder {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int REFNUMBER = 3000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int STATUS = 4000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int TYPE = 5000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int DELIVERINSTRUCTION = 6000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int PRIMARY = 7000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int PHONE = 8000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int RETAIL = 1000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int SALE = 2000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int PRICE = 3000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int ITEMTAX = 4000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int FEETAX = 5000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int FGTAX = 6000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int TOTALTAX = 7000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int MERCHANDISETOTAL = 8000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int TOTAL = 9000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,added,0,public static final int TAXABLE = 10000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,/*
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* #%L
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* BroadleafCommerce Framework
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* %%
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* Copyright (C) 2009 - 2016 Broadleaf Commerce
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"* Licensed under the Broadleaf Fair Use License Agreement, Version 1.0"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"* (the ""Fair Use License"" located  at http://license.broadleafcommerce.org/fair_use_license-1.0.txt)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* unless the restrictions on use therein are violated and require payment to Broadleaf in which case
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"* the Broadleaf End User License Agreement (EULA), Version 1.1"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"* (the ""Commercial License"" located at http://license.broadleafcommerce.org/commercial_license-1.1.txt)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* shall apply.
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,*
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"* Alternatively, the Commercial License may be replaced with a mutually agreed upon license (the ""Custom License"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* between you and Broadleaf Commerce. You may not use this file except in compliance with the applicable license.
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* #L%
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,*/
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,package org.broadleafcommerce.core.order.domain;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.copy.CreateResponse;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.copy.MultiTenantCopyContext;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.currency.util.BroadleafCurrencyUtils;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.currency.util.CurrencyCodeIdentifiable;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.extensibility.jpa.copy.DirectCopyTransform;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.extensibility.jpa.copy.DirectCopyTransformMember;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.extensibility.jpa.copy.DirectCopyTransformTypes;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.money.Money;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentation;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentationClass;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.presentation.AdminPresentationCollection;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.presentation.PopulateToOneFieldsEnum;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.presentation.client.SupportedFieldType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.presentation.override.AdminPresentationMergeEntry;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.presentation.override.AdminPresentationMergeOverride;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.presentation.override.AdminPresentationMergeOverrides;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.common.presentation.override.PropertyType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.core.offer.domain.CandidateFulfillmentGroupOffer;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.core.offer.domain.CandidateFulfillmentGroupOfferImpl;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.core.offer.domain.FulfillmentGroupAdjustment;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.core.offer.domain.FulfillmentGroupAdjustmentImpl;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.core.order.service.type.FulfillmentGroupStatusType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.core.order.service.type.FulfillmentType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.profile.core.domain.Address;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.profile.core.domain.AddressImpl;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.profile.core.domain.Phone;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.broadleafcommerce.profile.core.domain.PhoneImpl;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.hibernate.annotations.Cache;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.hibernate.annotations.CacheConcurrencyStrategy;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.hibernate.annotations.GenericGenerator;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.hibernate.annotations.Index;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import org.hibernate.annotations.Parameter;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import java.math.BigDecimal;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import java.util.ArrayList;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import java.util.List;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import java.util.Vector;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.CascadeType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Column;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Entity;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.FetchType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.GeneratedValue;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Id;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Inheritance;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.InheritanceType;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.JoinColumn;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.JoinTable;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.ManyToOne;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.OneToMany;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,import javax.persistence.Table;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@Entity
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@Inheritance(strategy = InheritanceType.JOINED)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Table(name = ""BLC_FULFILLMENT_GROUP"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Cache(usage = CacheConcurrencyStrategy.READ_WRITE, region = ""blOrderElements"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@AdminPresentationMergeOverrides(
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,{
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeOverride(name = """", mergeEntries ="
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.READONLY,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"booleanOverrideValue = true)),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeOverride(name = ""currency"", mergeEntries ="
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.PROMINENT,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"booleanOverrideValue = false)),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeOverride(name = ""personalMessage"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.TAB,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"overrideValue = FulfillmentGroupImpl.Presentation.Tab.Name.Advanced),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.TABORDER,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,intOverrideValue = FulfillmentGroupImpl.Presentation.Tab.Order.Advanced)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"}),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeOverride(name = ""address"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"overrideValue = FulfillmentGroupImpl.Presentation.Tab.Name.Address),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,intOverrideValue = FulfillmentGroupImpl.Presentation.Tab.Order.Address)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeOverride(name = ""address.isDefault"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.EXCLUDED,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,booleanOverrideValue = true)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeOverride(name = ""address.isActive"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeOverride(name = ""address.isBusiness"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeOverride(name = ""phone"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeOverride(name = ""phone.phoneNumber"", mergeEntries = {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"booleanOverrideValue = false),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.ORDER,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"intOverrideValue = FulfillmentGroupImpl.Presentation.FieldOrder.PHONE),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.GROUP,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"overrideValue = ""General""),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationMergeEntry(propertyType = PropertyType.AdminPresentation.REQUIREDOVERRIDE,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"overrideValue = ""NOT_REQUIRED"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,})
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,}
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationClass(populateToOneFields = PopulateToOneFieldsEnum.TRUE, friendlyName = ""FulfillmentGroupImpl_baseFulfillmentGroup"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@DirectCopyTransform({
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@DirectCopyTransformMember(templateTokens = DirectCopyTransformTypes.MULTITENANT_SITE)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"public class FulfillmentGroupImpl implements FulfillmentGroup, CurrencyCodeIdentifiable {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,private static final long serialVersionUID = 1L;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@Id
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@GeneratedValue(generator = ""FulfillmentGroupId"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@GenericGenerator(
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"name=""FulfillmentGroupId"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"strategy=""org.broadleafcommerce.common.persistence.IdOverrideTableGenerator"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,parameters = {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Parameter(name=""segment_value"", value=""FulfillmentGroupImpl""),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Parameter(name=""entity_name"", value=""org.broadleafcommerce.core.order.domain.FulfillmentGroupImpl"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""FULFILLMENT_GROUP_ID"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected Long id;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""REFERENCE_NUMBER"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""FG_REFERENCE_INDEX"", columnNames={""REFERENCE_NUMBER""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Reference_Number"", order=Presentation.FieldOrder.REFNUMBER,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,groupOrder = Presentation.Group.Order.General)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected String referenceNumber;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""METHOD"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""FG_METHOD_INDEX"", columnNames={""METHOD""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@AdminPresentation(excluded = true)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@Deprecated
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected String method;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""SERVICE"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""FG_SERVICE_INDEX"", columnNames={""SERVICE""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected String service;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""RETAIL_PRICE"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_Retail_Shipping_Price"", order=Presentation.FieldOrder.RETAIL,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"group = Presentation.Group.Name.Pricing, groupOrder = Presentation.Group.Order.Pricing,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"tab = Presentation.Tab.Name.Pricing, tabOrder = Presentation.Tab.Order.Pricing,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,fieldType=SupportedFieldType.MONEY)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected BigDecimal retailFulfillmentPrice;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""SALE_PRICE"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_Sale_Shipping_Price"", order=Presentation.FieldOrder.SALE,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected BigDecimal saleFulfillmentPrice;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""PRICE"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_Shipping_Price"", order=Presentation.FieldOrder.PRICE,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected BigDecimal fulfillmentPrice;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""TYPE"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Type"", order=Presentation.FieldOrder.TYPE,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"fieldType=SupportedFieldType.BROADLEAF_ENUMERATION,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"broadleafEnumeration=""org.broadleafcommerce.core.order.service.type.FulfillmentType"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"prominent = true, gridOrder = 3000)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected String type;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""TOTAL_TAX"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Total_Tax"", order=Presentation.FieldOrder.TOTALTAX,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected BigDecimal totalTax;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""TOTAL_ITEM_TAX"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Total_Item_Tax"", order=Presentation.FieldOrder.ITEMTAX,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected BigDecimal totalItemTax;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""TOTAL_FEE_TAX"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Total_Fee_Tax"", order=Presentation.FieldOrder.FEETAX,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected BigDecimal totalFeeTax;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""TOTAL_FG_TAX"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Total_FG_Tax"", order=Presentation.FieldOrder.FGTAX,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected BigDecimal totalFulfillmentGroupTax;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""DELIVERY_INSTRUCTION"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Delivery_Instruction"", order=Presentation.FieldOrder.DELIVERINSTRUCTION)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected String deliveryInstruction;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""IS_PRIMARY"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""FG_PRIMARY_INDEX"", columnNames={""IS_PRIMARY""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_Primary_FG"", order=Presentation.FieldOrder.PRIMARY)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected boolean primary = false;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""MERCHANDISE_TOTAL"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Merchandise_Total"", order=Presentation.FieldOrder.MERCHANDISETOTAL,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected BigDecimal merchandiseTotal;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""TOTAL"", precision=19, scale=5)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Total"", order=Presentation.FieldOrder.TOTAL,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"fieldType= SupportedFieldType.MONEY, prominent = true, gridOrder = 2000)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected BigDecimal total;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""STATUS"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""FG_STATUS_INDEX"", columnNames={""STATUS""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_FG_Status"", order=Presentation.FieldOrder.STATUS,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"broadleafEnumeration=""org.broadleafcommerce.core.order.service.type.FulfillmentGroupStatusType"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"prominent = true, gridOrder = 4000)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected String status;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""SHIPPING_PRICE_TAXABLE"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentation(friendlyName = ""FulfillmentGroupImpl_Shipping_Price_Taxable"", order=Presentation.FieldOrder.TAXABLE,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"tab = Presentation.Tab.Name.Pricing, tabOrder = Presentation.Tab.Order.Pricing)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected Boolean isShippingPriceTaxable = Boolean.FALSE;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@ManyToOne(targetEntity = FulfillmentOptionImpl.class, cascade = {CascadeType.PERSIST, CascadeType.MERGE, CascadeType.REFRESH})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@JoinColumn(name = ""FULFILLMENT_OPTION_ID"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected FulfillmentOption fulfillmentOption;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@ManyToOne(targetEntity = OrderImpl.class, optional=false)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@JoinColumn(name = ""ORDER_ID"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""FG_ORDER_INDEX"", columnNames={""ORDER_ID""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected Order order;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""FULFILLMENT_GROUP_SEQUNCE"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected Integer sequence;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@ManyToOne(targetEntity = AddressImpl.class, cascade = {CascadeType.PERSIST, CascadeType.MERGE, CascadeType.REFRESH})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@JoinColumn(name = ""ADDRESS_ID"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""FG_ADDRESS_INDEX"", columnNames={""ADDRESS_ID""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected Address address;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,/**
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* @deprecated uses the phonePrimary property on AddressImpl instead
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@ManyToOne(targetEntity = PhoneImpl.class, cascade = {CascadeType.PERSIST, CascadeType.MERGE, CascadeType.REFRESH})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@JoinColumn(name = ""PHONE_ID"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""FG_PHONE_INDEX"", columnNames={""PHONE_ID""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected Phone phone;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@ManyToOne(targetEntity = PersonalMessageImpl.class, cascade = { CascadeType.ALL })"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@JoinColumn(name = ""PERSONAL_MESSAGE_ID"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Index(name=""FG_MESSAGE_INDEX"", columnNames={""PERSONAL_MESSAGE_ID""})"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected PersonalMessage personalMessage;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@OneToMany(mappedBy = ""fulfillmentGroup"", targetEntity = FulfillmentGroupItemImpl.class, cascade = CascadeType.ALL,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,orphanRemoval = true)
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationCollection(friendlyName=""FulfillmentGroupImpl_Items"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"tab = Presentation.Tab.Name.Items, tabOrder = Presentation.Tab.Order.Items)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected List<FulfillmentGroupItem> fulfillmentGroupItems = new ArrayList<FulfillmentGroupItem>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@OneToMany(mappedBy = ""fulfillmentGroup"", targetEntity = FulfillmentGroupFeeImpl.class, cascade = { CascadeType.ALL },"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationCollection(friendlyName=""FulfillmentGroupImpl_Fees"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected List<FulfillmentGroupFee> fulfillmentGroupFees = new ArrayList<FulfillmentGroupFee>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@OneToMany(mappedBy = ""fulfillmentGroup"", targetEntity = CandidateFulfillmentGroupOfferImpl.class, cascade = { CascadeType.ALL },"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected List<CandidateFulfillmentGroupOffer> candidateOffers = new ArrayList<CandidateFulfillmentGroupOffer>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@OneToMany(mappedBy = ""fulfillmentGroup"", targetEntity = FulfillmentGroupAdjustmentImpl.class, cascade = { CascadeType.ALL },"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@AdminPresentationCollection(friendlyName=""FulfillmentGroupImpl_Adjustments"","
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"tab = Presentation.Tab.Name.Advanced, tabOrder = Presentation.Tab.Order.Advanced)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected List<FulfillmentGroupAdjustment> fulfillmentGroupAdjustments = new ArrayList<FulfillmentGroupAdjustment>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@OneToMany(fetch = FetchType.LAZY, targetEntity = TaxDetailImpl.class, cascade = { CascadeType.ALL }, orphanRemoval = true)"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@JoinTable(name = ""BLC_FG_FG_TAX_XREF"", joinColumns = @JoinColumn(name = ""FULFILLMENT_GROUP_ID""),"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"inverseJoinColumns = @JoinColumn(name = ""TAX_DETAIL_ID""))"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected List<TaxDetail> taxes = new ArrayList<TaxDetail>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"@Column(name = ""SHIPPING_OVERRIDE"")"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,protected Boolean shippingOverride;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,@Override
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Long getId() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return id;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setId(Long id) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.id = id;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Order getOrder() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return order;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setOrder(Order order) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.order = order;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public FulfillmentOption getFulfillmentOption() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return fulfillmentOption;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setFulfillmentOption(FulfillmentOption fulfillmentOption) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.fulfillmentOption = fulfillmentOption;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public String getReferenceNumber() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return referenceNumber;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setReferenceNumber(String referenceNumber) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.referenceNumber = referenceNumber;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public List<FulfillmentGroupItem> getFulfillmentGroupItems() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return fulfillmentGroupItems;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public List<DiscreteOrderItem> getDiscreteOrderItems() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,List<DiscreteOrderItem> discreteOrderItems = new ArrayList<DiscreteOrderItem>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,for (FulfillmentGroupItem fgItem : fulfillmentGroupItems) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,OrderItem orderItem = fgItem.getOrderItem();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (orderItem instanceof BundleOrderItem) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,BundleOrderItemImpl bundleOrderItem = (BundleOrderItemImpl)orderItem;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,for (DiscreteOrderItem discreteOrderItem : bundleOrderItem.getDiscreteOrderItems()) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,discreteOrderItems.add(discreteOrderItem);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,} else if (orderItem instanceof DiscreteOrderItem) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,DiscreteOrderItem discreteOrderItem = (DiscreteOrderItem)orderItem;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return discreteOrderItems;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setFulfillmentGroupItems(List<FulfillmentGroupItem> fulfillmentGroupItems) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.fulfillmentGroupItems = fulfillmentGroupItems;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void addFulfillmentGroupItem(FulfillmentGroupItem fulfillmentGroupItem) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (this.fulfillmentGroupItems == null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.fulfillmentGroupItems = new Vector<FulfillmentGroupItem>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.fulfillmentGroupItems.add(fulfillmentGroupItem);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Address getAddress() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return address;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setAddress(Address address) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.address = address;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,* @deprecated use the phonePrimary property on the related Address instead
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Phone getPhone() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return phone;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setPhone(Phone phone) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.phone = phone;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public String getMethod() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return method;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setMethod(String fulfillmentMethod) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.method = fulfillmentMethod;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Money getRetailFulfillmentPrice() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return retailFulfillmentPrice == null ? null :
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"BroadleafCurrencyUtils.getMoney(retailFulfillmentPrice, getOrder().getCurrency());"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setRetailFulfillmentPrice(Money retailFulfillmentPrice) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.retailFulfillmentPrice = Money.toAmount(retailFulfillmentPrice);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Money getRetailShippingPrice() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return getRetailFulfillmentPrice();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setRetailShippingPrice(Money retailShippingPrice) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,setRetailFulfillmentPrice(retailShippingPrice);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public FulfillmentType getType() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return FulfillmentType.getInstance(type);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setType(FulfillmentType type) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.type = type == null ? null : type.getType();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void addCandidateFulfillmentGroupOffer(CandidateFulfillmentGroupOffer candidateOffer) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,candidateOffers.add(candidateOffer);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public List<CandidateFulfillmentGroupOffer> getCandidateFulfillmentGroupOffers() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return candidateOffers;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setCandidateFulfillmentGroupOffer(List<CandidateFulfillmentGroupOffer> candidateOffers) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.candidateOffers = candidateOffers;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void removeAllCandidateOffers() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (candidateOffers != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,for (CandidateFulfillmentGroupOffer offer : candidateOffers) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,offer.setFulfillmentGroup(null);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,candidateOffers.clear();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public List<FulfillmentGroupAdjustment> getFulfillmentGroupAdjustments() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return this.fulfillmentGroupAdjustments;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public List<FulfillmentGroupAdjustment> getFutureCreditFulfillmentGroupAdjustments() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,List<FulfillmentGroupAdjustment> futureCreditAdjustments = new ArrayList<>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,for (FulfillmentGroupAdjustment adjustment : fulfillmentGroupAdjustments) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (adjustment.isFutureCredit()) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,futureCreditAdjustments.add(adjustment);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return futureCreditAdjustments;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Money getFulfillmentGroupAdjustmentsValue() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"Money adjustmentsValue = BroadleafCurrencyUtils.getMoney(BigDecimal.ZERO, getOrder().getCurrency());"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (!adjustment.isFutureCredit()) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,adjustmentsValue = adjustmentsValue.add(adjustment.getValue());
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return adjustmentsValue;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Money getFutureCreditFulfillmentGroupAdjustmentsValue() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,for (FulfillmentGroupAdjustment adjustment : getFutureCreditFulfillmentGroupAdjustments()) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void removeAllAdjustments() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (fulfillmentGroupAdjustments != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,adjustment.setFulfillmentGroup(null);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,fulfillmentGroupAdjustments.clear();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setFulfillmentGroupAdjustments(List<FulfillmentGroupAdjustment> fulfillmentGroupAdjustments) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.fulfillmentGroupAdjustments = fulfillmentGroupAdjustments;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Money getSaleFulfillmentPrice() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"return saleFulfillmentPrice == null ? null : BroadleafCurrencyUtils.getMoney(saleFulfillmentPrice,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,getOrder().getCurrency());
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setSaleFulfillmentPrice(Money saleFulfillmentPrice) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.saleFulfillmentPrice = Money.toAmount(saleFulfillmentPrice);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Money getSaleShippingPrice() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return getSaleFulfillmentPrice();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setSaleShippingPrice(Money saleShippingPrice) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,setSaleFulfillmentPrice(saleShippingPrice);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Money getFulfillmentPrice() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"return fulfillmentPrice == null ? null : BroadleafCurrencyUtils.getMoney(fulfillmentPrice,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setFulfillmentPrice(Money fulfillmentPrice) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.fulfillmentPrice = Money.toAmount(fulfillmentPrice);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Money getShippingPrice() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return getFulfillmentPrice();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setShippingPrice(Money shippingPrice) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,setFulfillmentPrice(shippingPrice);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public List<TaxDetail> getTaxes() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return taxes;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setTaxes(List<TaxDetail> taxes) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.taxes = taxes;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Money getTotalTax() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"return totalTax == null ? null : BroadleafCurrencyUtils.getMoney(totalTax, getOrder().getCurrency());"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setTotalTax(Money totalTax) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.totalTax = Money.toAmount(totalTax);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Money getTotalItemTax() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"return totalItemTax == null ? null : BroadleafCurrencyUtils.getMoney(totalItemTax, getOrder().getCurrency());"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setTotalItemTax(Money totalItemTax) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.totalItemTax = Money.toAmount(totalItemTax);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Money getTotalFeeTax() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"return totalFeeTax == null ? null : BroadleafCurrencyUtils.getMoney(totalFeeTax, getOrder().getCurrency());"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setTotalFeeTax(Money totalFeeTax) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.totalFeeTax = Money.toAmount(totalFeeTax);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Money getTotalFulfillmentGroupTax() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"return totalFulfillmentGroupTax == null ? null : BroadleafCurrencyUtils.getMoney(totalFulfillmentGroupTax,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setTotalFulfillmentGroupTax(Money totalFulfillmentGroupTax) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.totalFulfillmentGroupTax = Money.toAmount(totalFulfillmentGroupTax);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public String getDeliveryInstruction() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return deliveryInstruction;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setDeliveryInstruction(String deliveryInstruction) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.deliveryInstruction = deliveryInstruction;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public PersonalMessage getPersonalMessage() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return personalMessage;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setPersonalMessage(PersonalMessage personalMessage) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.personalMessage = personalMessage;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public boolean isPrimary() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return primary;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setPrimary(boolean primary) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.primary = primary;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Money getMerchandiseTotal() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"return merchandiseTotal == null ? null : BroadleafCurrencyUtils.getMoney(merchandiseTotal,"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setMerchandiseTotal(Money merchandiseTotal) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.merchandiseTotal = Money.toAmount(merchandiseTotal);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Money getTotal() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"return total == null ? null : BroadleafCurrencyUtils.getMoney(total, getOrder().getCurrency());"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setTotal(Money orderTotal) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.total = Money.toAmount(orderTotal);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public FulfillmentGroupStatusType getStatus() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return FulfillmentGroupStatusType.getInstance(status);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setStatus(FulfillmentGroupStatusType status) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.status = status.getType();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public List<FulfillmentGroupFee> getFulfillmentGroupFees() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return fulfillmentGroupFees;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setFulfillmentGroupFees(List<FulfillmentGroupFee> fulfillmentGroupFees) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.fulfillmentGroupFees = fulfillmentGroupFees;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void addFulfillmentGroupFee(FulfillmentGroupFee fulfillmentGroupFee) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (fulfillmentGroupFees == null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,fulfillmentGroupFees = new ArrayList<FulfillmentGroupFee>();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,fulfillmentGroupFees.add(fulfillmentGroupFee);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void removeAllFulfillmentGroupFees() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (fulfillmentGroupFees != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,fulfillmentGroupFees.clear();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Boolean isShippingPriceTaxable() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return isShippingPriceTaxable;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setIsShippingPriceTaxable(Boolean isShippingPriceTaxable) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.isShippingPriceTaxable = isShippingPriceTaxable;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setSequence(Integer sequence) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.sequence = sequence;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Integer getSequence() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return this.sequence;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public String getService() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return service;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setService(String service) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.service = service;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public String getCurrencyCode() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (getOrder().getCurrency() != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return getOrder().getCurrency().getCurrencyCode();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return null;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public Boolean getShippingOverride() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return shippingOverride == null ? false : shippingOverride;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public void setShippingOverride(Boolean shippingOverride) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,this.shippingOverride = shippingOverride;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public int hashCode() {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,final int prime = 31;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,int result = 1;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,result = prime * result + ((address == null) ? 0 : address.hashCode());
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,result = prime * result + ((fulfillmentGroupItems == null) ? 0 : fulfillmentGroupItems.hashCode());
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return result;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public <G extends FulfillmentGroup> CreateResponse<G> createOrRetrieveCopyInstance(MultiTenantCopyContext context) throws CloneNotSupportedException {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,CreateResponse<G> createResponse = context.createOrRetrieveCopyInstance(this);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (createResponse.isAlreadyPopulated()) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return createResponse;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,FulfillmentGroup cloned = createResponse.getClone();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,cloned.setAddress(address == null ? null : address.createOrRetrieveCopyInstance(context).getClone());
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,cloned.setDeliveryInstruction(deliveryInstruction);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,cloned.setFulfillmentOption(fulfillmentOption);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,cloned.setFulfillmentPrice(fulfillmentPrice == null ? null : new Money(fulfillmentPrice));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,cloned.setIsShippingPriceTaxable(isShippingPriceTaxable == null ? null : isShippingPriceTaxable);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,cloned.setMerchandiseTotal(merchandiseTotal == null ? null : new Money(merchandiseTotal));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,cloned.setRetailFulfillmentPrice(fulfillmentPrice == null ? null : new Money(fulfillmentPrice));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"cloneTaxDetails(context, cloned);"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,cloned.setTotalItemTax(totalItemTax == null ? null : new Money(totalItemTax));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,cloned.setTotalFulfillmentGroupTax(totalFulfillmentGroupTax == null ? null : new Money(totalFulfillmentGroupTax));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,cloned.setTotalFeeTax(totalFeeTax == null ? null : new Money(totalFeeTax));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,cloned.setTotalTax(totalTax == null ? null : new Money(totalTax));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,cloned.setRetailFulfillmentPrice(retailFulfillmentPrice == null ? null : new Money(retailFulfillmentPrice));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,cloned.setSaleFulfillmentPrice(saleFulfillmentPrice == null ? null : new Money(saleFulfillmentPrice));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,cloned.setTotal(total == null ? null : new Money(total));
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,cloned.setOrder(order);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,cloned.setPrimary(primary);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,cloned.setType(getType());
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,for (FulfillmentGroupItem fgi: fulfillmentGroupItems) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,FulfillmentGroupItem fulfillmentGroupItem = fgi.createOrRetrieveCopyInstance(context).getClone();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,fulfillmentGroupItem.setFulfillmentGroup(cloned);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,cloned.getFulfillmentGroupItems().add(fulfillmentGroupItem);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return  createResponse;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"protected void cloneTaxDetails(MultiTenantCopyContext context, FulfillmentGroup cloned) throws CloneNotSupportedException {"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,for (TaxDetail taxDetail : getTaxes()) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,TaxDetail clonedTaxDetail = taxDetail.createOrRetrieveCopyInstance(context).getClone();
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,cloned.getTaxes().add(clonedTaxDetail);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public boolean equals(Object obj) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (this == obj) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return true;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (obj == null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return false;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (!getClass().isAssignableFrom(obj.getClass())) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,FulfillmentGroupImpl other = (FulfillmentGroupImpl) obj;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (id != null && other.id != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,return id.equals(other.id);
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (address == null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (other.address != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,} else if (!address.equals(other.address)) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (fulfillmentGroupItems == null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,if (other.fulfillmentGroupItems != null) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,} else if (!fulfillmentGroupItems.equals(other.fulfillmentGroupItems)) {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static class Presentation {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static class Tab {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static class Name {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"public static final String Items = ""FulfillmentGroupImpl_Items_Tab"";"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"public static final String Pricing = ""FulfillmentGroupImpl_Pricing_Tab"";"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"public static final String Address = ""FulfillmentGroupImpl_Address_Tab"";"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"public static final String Advanced = ""FulfillmentGroupImpl_Advanced_Tab"";"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static class Order {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static final int Items = 2000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static final int Pricing = 3000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static final int Address = 4000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static final int Advanced = 5000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static class Group {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,"public static final String Pricing = ""FulfillmentGroupImpl_Pricing"";"
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static final int General = 1000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static final int Pricing = 2000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static class FieldOrder {
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static final int REFNUMBER = 3000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static final int STATUS = 4000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static final int TYPE = 5000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static final int DELIVERINSTRUCTION = 6000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static final int PRIMARY = 7000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static final int PHONE = 8000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static final int RETAIL = 1000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static final int SALE = 2000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static final int PRICE = 3000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static final int ITEMTAX = 4000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static final int FEETAX = 5000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static final int FGTAX = 6000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static final int TOTALTAX = 7000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static final int MERCHANDISETOTAL = 8000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static final int TOTAL = 9000;
8b27dae7286c6d7a195f000dfddf48a2b5d8bb4d,0d2a5ecdd979ebc977172e7045cbd0930962f6c1,deleted,1,public static final int TAXABLE = 10000;
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,protected EntityManagerFactory emf;
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,emf = ((JpaTransactionManager) getTransactionManager()).getEntityManagerFactory();
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,private EntityManager getEntityManager() {
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,return emf.createEntityManager();
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,}
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,EntityManager em = getEntityManager();
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,try {
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,StreamCapableTransactionalOperation operation = new StreamCapableTransactionalOperationAdapter() {
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,@Override
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,public void execute() throws Throwable {
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,"pagedItems = streamOperation.retrievePage(holder.getVal(), pageSize);"
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,streamOperation.pagedExecute(pagedItems);
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,int pagedItemCount = ((Collection) pagedItems[0]).size();
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,if (pagedItemCount == 0) {
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,holder.setVal(totalCount.intValue());
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,"if (LOG.isDebugEnabled() && !isFinalPage(holder, pagedItemCount, totalCount) && (pagedItemCount != pageSize)) {"
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,"LOG.debug(String.format(""In the previous iteration of this streaming transactional operation, "" +"
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,"""(%s) pagedItems were processed when we were expecting a full page of (%s) items. "" +"
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,"""Please ensure that your StreamCapableTransactionalOperation#retrieveTotalCount() "" +"
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,"""and StreamCapableTransactionalOperation#retrievePage(int startPos, int pageSize) "" +"
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,"""queries contain the same conditions as to ultimately provide the number of entities "" +"
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,"""equal to the declared total count. Stream operation: %s"","
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,"pagedItemCount, pageSize, streamOperation.getClass()));"
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,if (pagedItemCount < pageSize) {
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,holder.setVal(holder.getVal() + pageSize);
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,} else {
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,holder.setVal(holder.getVal() + pagedItemCount);
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,"private boolean isFinalPage(Holder holder, int pagedItemCount, Long totalCount) {"
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,int processedItemCount = holder.getVal() + pagedItemCount;
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,return processedItemCount >= totalCount;
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,};
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,while (holder.getVal() < totalCount) {
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,"runOptionalTransactionalOperation(operation, exceptionType, true, transactionBehavior, isolationLevel, false, getTransactionManager());"
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,if (em != null) {
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,"//The idea behind using this class is that it will likely process a lot of records. As such, it is necessary"
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,//to clear the level 1 cache after each iteration so that we don't run out of heap
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,em.clear();
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,streamOperation.executeAfterCommit(((StreamCapableTransactionalOperationAdapter) operation).getPagedItems());
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,finally {
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,if (em != null && em.isOpen()) {
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,added,0,em.close();
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,protected EntityManager em;
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,em = ((JpaTransactionManager) getTransactionManager()).getEntityManagerFactory().createEntityManager();
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,StreamCapableTransactionalOperation operation = new StreamCapableTransactionalOperationAdapter() {
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,@Override
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,public void execute() throws Throwable {
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,"pagedItems = streamOperation.retrievePage(holder.getVal(), pageSize);"
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,streamOperation.pagedExecute(pagedItems);
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,int pagedItemCount = ((Collection) pagedItems[0]).size();
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,if (pagedItemCount == 0) {
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,holder.setVal(totalCount.intValue());
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,} else {
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,"if (LOG.isDebugEnabled() && !isFinalPage(holder, pagedItemCount, totalCount) && (pagedItemCount != pageSize)) {"
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,"LOG.debug(String.format(""In the previous iteration of this streaming transactional operation, "" +"
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,"""(%s) pagedItems were processed when we were expecting a full page of (%s) items. "" +"
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,"""Please ensure that your StreamCapableTransactionalOperation#retrieveTotalCount() "" +"
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,"""and StreamCapableTransactionalOperation#retrievePage(int startPos, int pageSize) "" +"
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,"""queries contain the same conditions as to ultimately provide the number of entities "" +"
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,"""equal to the declared total count. Stream operation: %s"","
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,"pagedItemCount, pageSize, streamOperation.getClass()));"
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,}
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,if (pagedItemCount < pageSize) {
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,holder.setVal(holder.getVal() + pageSize);
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,holder.setVal(holder.getVal() + pagedItemCount);
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,"private boolean isFinalPage(Holder holder, int pagedItemCount, Long totalCount) {"
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,int processedItemCount = holder.getVal() + pagedItemCount;
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,return processedItemCount >= totalCount;
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,};
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,while (holder.getVal() < totalCount) {
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,"runOptionalTransactionalOperation(operation, exceptionType, true, transactionBehavior, isolationLevel, false, getTransactionManager());"
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,if (em != null) {
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,"//The idea behind using this class is that it will likely process a lot of records. As such, it is necessary"
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,//to clear the level 1 cache after each iteration so that we don't run out of heap
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,em.clear();
0b31e235d7fbbe1aeddfc3c8c8474dae47f14629,11e87bfde5b3f0d09d9a3bb098c35ef1f34195e2,deleted,1,streamOperation.executeAfterCommit(((StreamCapableTransactionalOperationAdapter) operation).getPagedItems());
