commit_id,line,line_level_label,count,line_score,row
836867e0413d6087a4520a5b8653b089cad28244,"getLog().warn(""Not adding annotation `"" + annotation + ""` to "" + KubernetesHelper.getKind(resource) + "" "" + KubernetesHelper.getName(resource) + "" with value `"" + value + ""` as there is already an annotation value of `"" + oldValue + ""`"");",0,14,1.0,1
836867e0413d6087a4520a5b8653b089cad28244,"throw new MojoExecutionException(""Failed to load environment properties file: "" + envPropertiesFile + "". "" + e, e);",1,7,0.5,2
836867e0413d6087a4520a5b8653b089cad28244,"throw new MojoExecutionException(""Failed to load properties file: "" + file + "". "" + e, e);",0,6,0.42857142857142855,3
836867e0413d6087a4520a5b8653b089cad28244,"throw new MojoExecutionException(""Failed to load properties URL: "" + url + "". "" + e, e);",0,6,0.42857142857142855,4
836867e0413d6087a4520a5b8653b089cad28244,"throw new MojoExecutionException(""Failed to parse JSON "" + file + "". "" + e, e);",0,4,0.2857142857142857,5
836867e0413d6087a4520a5b8653b089cad28244,"throw new MojoExecutionException(""Failed to updated JSON file "" + json + "". "" + e, e);",0,4,0.2857142857142857,6
836867e0413d6087a4520a5b8653b089cad28244,"protected static void addPropertiesFileToMap(File file, Map<String, String> answer) throws MojoExecutionException {",0,3,0.21428571428571427,7
836867e0413d6087a4520a5b8653b089cad28244,if (envPropertiesFile != null && envPropertiesFile.isFile() && envPropertiesFile.exists()) {,1,3,0.21428571428571427,8
836867e0413d6087a4520a5b8653b089cad28244,"protected static void addPropertiesFileToMap(URL url, Map<String, String> answer) throws MojoExecutionException {",0,3,0.21428571428571427,9
836867e0413d6087a4520a5b8653b089cad28244,"Map<String, String> map = toMap(properties);",0,3,0.21428571428571427,10
836867e0413d6087a4520a5b8653b089cad28244,if (file != null && file.isFile() && file.exists()) {,0,3,0.21428571428571427,11
836867e0413d6087a4520a5b8653b089cad28244,Properties properties = new Properties();,0,3,0.21428571428571427,12
836867e0413d6087a4520a5b8653b089cad28244,String value = Systems.getEnvVarOrSystemProperty(envVar);,0,3,0.21428571428571427,13
836867e0413d6087a4520a5b8653b089cad28244,"for (Map.Entry<String, String> entry : entries) {",0,3,0.21428571428571427,14
836867e0413d6087a4520a5b8653b089cad28244,"Map<String, String> annotations = KubernetesHelper.getOrCreateAnnotations(resource);",0,3,0.21428571428571427,15
836867e0413d6087a4520a5b8653b089cad28244,"Map<String, String> mapEnvVarToAnnotation = new HashMap<>();",0,3,0.21428571428571427,16
836867e0413d6087a4520a5b8653b089cad28244,* Specifies a file which maps environment variables or system properties to annotations which are then recorded on the,0,3,0.21428571428571427,17
836867e0413d6087a4520a5b8653b089cad28244,"String resourceName = ""environmentAnnotations.properties"";",0,2,0.14285714285714285,18
836867e0413d6087a4520a5b8653b089cad28244,try (InputStream in = url.openStream()) {,0,2,0.14285714285714285,19
836867e0413d6087a4520a5b8653b089cad28244,if (url != null) {,0,2,0.14285714285714285,20
836867e0413d6087a4520a5b8653b089cad28244,} else {,0,2,0.14285714285714285,21
836867e0413d6087a4520a5b8653b089cad28244,String oldValue = annotations.get(annotation);,0,2,0.14285714285714285,22
836867e0413d6087a4520a5b8653b089cad28244,String annotation = entry.getValue();,0,2,0.14285714285714285,23
836867e0413d6087a4520a5b8653b089cad28244,String envVar = entry.getKey();,0,2,0.14285714285714285,24
836867e0413d6087a4520a5b8653b089cad28244,"Set<Map.Entry<String, String>> entries = mapEnvVarToAnnotation.entrySet();",0,2,0.14285714285714285,25
836867e0413d6087a4520a5b8653b089cad28244,"throw new MojoExecutionException(""Could not find resource `"" + resourceName + ""` on the classpath!"");",0,2,0.14285714285714285,26
836867e0413d6087a4520a5b8653b089cad28244,if (items != null) {,0,2,0.14285714285714285,27
836867e0413d6087a4520a5b8653b089cad28244,} else if (item instanceof DeploymentConfig) {,0,2,0.14285714285714285,28
836867e0413d6087a4520a5b8653b089cad28244,} else if (item instanceof Template) {,0,2,0.14285714285714285,29
836867e0413d6087a4520a5b8653b089cad28244,"@Parameter(property = ""fabric8.environmentVariableToAnnotationsFile"", defaultValue = ""${basedir}/src/main/fabric8/environemntToAnnotations.properties"")",0,2,0.14285714285714285,30
836867e0413d6087a4520a5b8653b089cad28244,} else if (dto instanceof Template) {,0,2,0.14285714285714285,31
836867e0413d6087a4520a5b8653b089cad28244,Object dto = loadJsonFile(json);,0,2,0.14285714285714285,32
836867e0413d6087a4520a5b8653b089cad28244,} catch (IOException e) {,0,2,0.14285714285714285,33
836867e0413d6087a4520a5b8653b089cad28244,protected static Object loadJsonFile(File file) throws MojoExecutionException {,0,2,0.14285714285714285,34
836867e0413d6087a4520a5b8653b089cad28244,} else if (item instanceof ReplicationController) {,0,2,0.14285714285714285,35
836867e0413d6087a4520a5b8653b089cad28244,if (url == null) {,0,1,0.07142857142857142,36
836867e0413d6087a4520a5b8653b089cad28244,Template template = (Template) item;,0,1,0.07142857142857142,37
836867e0413d6087a4520a5b8653b089cad28244,protected void addEnvironmentAnnotations(HasMetadata resource) throws MojoExecutionException {,0,1,0.07142857142857142,38
836867e0413d6087a4520a5b8653b089cad28244,URL url = getClass().getResource(resourceName);,0,1,0.07142857142857142,39
836867e0413d6087a4520a5b8653b089cad28244,try (FileInputStream in = new FileInputStream(file)){,0,1,0.07142857142857142,40
836867e0413d6087a4520a5b8653b089cad28244,if (Strings.isNotBlank(value)) {,0,1,0.07142857142857142,41
836867e0413d6087a4520a5b8653b089cad28244,if (Strings.isNotBlank(oldValue)) {,0,1,0.07142857142857142,42
836867e0413d6087a4520a5b8653b089cad28244,try {,1,1,0.07142857142857142,43
836867e0413d6087a4520a5b8653b089cad28244,if (item instanceof KubernetesList) {,0,1,0.07142857142857142,44
836867e0413d6087a4520a5b8653b089cad28244,KubernetesList list = (KubernetesList) item;,0,1,0.07142857142857142,45
836867e0413d6087a4520a5b8653b089cad28244,List<HasMetadata> items = container.getObjects();,0,1,0.07142857142857142,46
836867e0413d6087a4520a5b8653b089cad28244,for (HasMetadata item : items) {,0,1,0.07142857142857142,47
836867e0413d6087a4520a5b8653b089cad28244,Template container = (Template) dto;,0,1,0.07142857142857142,48
836867e0413d6087a4520a5b8653b089cad28244,List<HasMetadata> items = container.getItems();,0,1,0.07142857142857142,49
836867e0413d6087a4520a5b8653b089cad28244,KubernetesList container = (KubernetesList) dto;,0,1,0.07142857142857142,50
836867e0413d6087a4520a5b8653b089cad28244,if (dto instanceof KubernetesList) {,0,1,0.07142857142857142,51
836867e0413d6087a4520a5b8653b089cad28244,protected void addEnvironmentAnnotations(File json) throws MojoExecutionException {,0,1,0.07142857142857142,52
836867e0413d6087a4520a5b8653b089cad28244,},0,1,0.07142857142857142,53
836867e0413d6087a4520a5b8653b089cad28244,try {,0,1,0.07142857142857142,54
836867e0413d6087a4520a5b8653b089cad28244,protected File environmentVariableToAnnotationsFile;,0,1,0.07142857142857142,55
836867e0413d6087a4520a5b8653b089cad28244,protected void addEnvironmentAnnotations(Iterable<HasMetadata> items) throws MojoExecutionException {,0,1,0.07142857142857142,56
836867e0413d6087a4520a5b8653b089cad28244,"annotations.put(annotation, value);",0,0,0.0,57
836867e0413d6087a4520a5b8653b089cad28244,addEnvironmentAnnotations(list.getItems());,0,0,0.0,58
836867e0413d6087a4520a5b8653b089cad28244,addEnvironmentAnnotations(template.getObjects());,0,0,0.0,59
836867e0413d6087a4520a5b8653b089cad28244,addEnvironmentAnnotations(item);,0,0,0.0,60
836867e0413d6087a4520a5b8653b089cad28244,"addPropertiesFileToMap(url, mapEnvVarToAnnotation);",0,0,0.0,61
836867e0413d6087a4520a5b8653b089cad28244,"addPropertiesFileToMap(this.environmentVariableToAnnotationsFile, mapEnvVarToAnnotation);",0,0,0.0,62
836867e0413d6087a4520a5b8653b089cad28244,answer.putAll(map);,0,0,0.0,63
836867e0413d6087a4520a5b8653b089cad28244,"addPropertiesFileToMap(this.envPropertiesFile, answer);",0,0,0.0,64
836867e0413d6087a4520a5b8653b089cad28244,return answer;,0,0,0.0,65
836867e0413d6087a4520a5b8653b089cad28244,properties.load(in);,0,0,0.0,66
836867e0413d6087a4520a5b8653b089cad28244,"getLog().info(""Template is now:"");",0,0,0.0,67
836867e0413d6087a4520a5b8653b089cad28244,// lets override with these values,1,0,0.0,68
836867e0413d6087a4520a5b8653b089cad28244,properties.load(new FileInputStream(envPropertiesFile));,1,0,0.0,69
836867e0413d6087a4520a5b8653b089cad28244,printSummary(container.getObjects());,0,0,0.0,70
836867e0413d6087a4520a5b8653b089cad28244,"getLog().info(""Added enviroment annotations:"");",0,0,0.0,71
836867e0413d6087a4520a5b8653b089cad28244,container.setObjects(items);,0,0,0.0,72
836867e0413d6087a4520a5b8653b089cad28244,"KubernetesHelper.saveJson(json, container);",0,0,0.0,73
836867e0413d6087a4520a5b8653b089cad28244,container.setItems(items);,0,0,0.0,74
836867e0413d6087a4520a5b8653b089cad28244,printSummary(items);,0,0,0.0,75
836867e0413d6087a4520a5b8653b089cad28244,addEnvironmentAnnotations(items);,0,0,0.0,76
836867e0413d6087a4520a5b8653b089cad28244,return KubernetesHelper.loadJson(file);,0,0,0.0,77
836867e0413d6087a4520a5b8653b089cad28244,*/,0,0,0.0,78
836867e0413d6087a4520a5b8653b089cad28244,* ReplicationController of the generated or applied JSON,0,0,0.0,79
836867e0413d6087a4520a5b8653b089cad28244,/**,0,0,0.0,80
836867e0413d6087a4520a5b8653b089cad28244,import io.fabric8.utils.Systems;,0,0,0.0,81
836867e0413d6087a4520a5b8653b089cad28244,import io.fabric8.openshift.api.model.DeploymentConfig;,0,0,0.0,82
836867e0413d6087a4520a5b8653b089cad28244,import io.fabric8.kubernetes.api.model.ReplicationController;,0,0,0.0,83
836867e0413d6087a4520a5b8653b089cad28244,import io.fabric8.kubernetes.api.model.ObjectMeta;,0,0,0.0,84
836867e0413d6087a4520a5b8653b089cad28244,import io.fabric8.kubernetes.api.model.KubernetesList;,0,0,0.0,85
836867e0413d6087a4520a5b8653b089cad28244,return answer;,1,0,0.0,86
