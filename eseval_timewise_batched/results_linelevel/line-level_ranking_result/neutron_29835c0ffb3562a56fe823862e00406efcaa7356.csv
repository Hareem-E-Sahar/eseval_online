commit_id,line,line_level_label,count,line_score,row
29835c0ffb3562a56fe823862e00406efcaa7356,are creating a security group rule on behalf of another use.,1,7,1.0,1
29835c0ffb3562a56fe823862e00406efcaa7356,"'security_group_rules': {'allow_post': False, 'allow_put': False,",1,5,0.7142857142857142,2
29835c0ffb3562a56fe823862e00406efcaa7356,group rule on behalf of another use.,0,5,0.7142857142857142,3
29835c0ffb3562a56fe823862e00406efcaa7356,"""""""Tenant id is given to handle the case when creating a security",0,4,0.5714285714285714,4
29835c0ffb3562a56fe823862e00406efcaa7356,"SECURITYGROUPRULES: {'allow_post': False, 'allow_put': False,",0,4,0.5714285714285714,5
29835c0ffb3562a56fe823862e00406efcaa7356,"context, id), fields)",1,3,0.42857142857142855,6
29835c0ffb3562a56fe823862e00406efcaa7356,"direction = ""ingress""",1,2,0.2857142857142857,7
29835c0ffb3562a56fe823862e00406efcaa7356,protocol = const.PROTO_NAME_TCP,0,2,0.2857142857142857,8
29835c0ffb3562a56fe823862e00406efcaa7356,port_range_min = 22,0,2,0.2857142857142857,9
29835c0ffb3562a56fe823862e00406efcaa7356,port_range_max = 22,0,2,0.2857142857142857,10
29835c0ffb3562a56fe823862e00406efcaa7356,group = self.deserialize(,0,2,0.2857142857142857,11
29835c0ffb3562a56fe823862e00406efcaa7356,port_range_max = 22,1,2,0.2857142857142857,12
29835c0ffb3562a56fe823862e00406efcaa7356,protocol = const.PROTO_NAME_TCP,1,2,0.2857142857142857,13
29835c0ffb3562a56fe823862e00406efcaa7356,port_range_min = 22,1,2,0.2857142857142857,14
29835c0ffb3562a56fe823862e00406efcaa7356,"sg = self._get_security_group(context, id)",1,2,0.2857142857142857,15
29835c0ffb3562a56fe823862e00406efcaa7356,"keys = [('remote_ip_prefix', remote_ip_prefix),",1,2,0.2857142857142857,16
29835c0ffb3562a56fe823862e00406efcaa7356,group = self.deserialize(,1,2,0.2857142857142857,17
29835c0ffb3562a56fe823862e00406efcaa7356,"direction = ""ingress""",0,2,0.2857142857142857,18
29835c0ffb3562a56fe823862e00406efcaa7356,"keys = [('remote_ip_prefix', remote_ip_prefix),",0,2,0.2857142857142857,19
29835c0ffb3562a56fe823862e00406efcaa7356,"sg = sg_obj.SecurityGroup.get_object(context, id=id)",1,2,0.2857142857142857,20
29835c0ffb3562a56fe823862e00406efcaa7356,if (fields is None or len(fields) == 0 or,0,2,0.2857142857142857,21
29835c0ffb3562a56fe823862e00406efcaa7356,"context, {'security_group_id': [id]})",1,2,0.2857142857142857,22
29835c0ffb3562a56fe823862e00406efcaa7356,Check that all rules belong to the same security,0,2,0.2857142857142857,23
29835c0ffb3562a56fe823862e00406efcaa7356,"""""""Tenant id is given to handle the case when we",1,2,0.2857142857142857,24
29835c0ffb3562a56fe823862e00406efcaa7356,"""""""Check that rules being installed all belong to the same security",1,2,0.2857142857142857,25
29835c0ffb3562a56fe823862e00406efcaa7356,"'is_visible': True},",1,2,0.2857142857142857,26
29835c0ffb3562a56fe823862e00406efcaa7356,"'is_visible': True},",0,2,0.2857142857142857,27
29835c0ffb3562a56fe823862e00406efcaa7356,"rules = self.get_security_group_rules(context,",0,2,0.2857142857142857,28
29835c0ffb3562a56fe823862e00406efcaa7356,ret['security_group_rules'] = rules,0,2,0.2857142857142857,29
29835c0ffb3562a56fe823862e00406efcaa7356,"sg = sg_obj.SecurityGroup.get_object(context, fields=fields, id=id)",0,2,0.2857142857142857,30
29835c0ffb3562a56fe823862e00406efcaa7356,"sg = self._get_security_group(context, id, fields=['id', 'name'])",0,2,0.2857142857142857,31
29835c0ffb3562a56fe823862e00406efcaa7356,# Verify that default egress rules have been created,1,1,0.14285714285714285,32
29835c0ffb3562a56fe823862e00406efcaa7356,# Verify that egress rules have been created as defined in the template,0,1,0.14285714285714285,33
29835c0ffb3562a56fe823862e00406efcaa7356,remote_group_id = sg['security_group']['id'],0,1,0.14285714285714285,34
29835c0ffb3562a56fe823862e00406efcaa7356,"res = self.new_show_request('security-groups', remote_group_id)",0,1,0.14285714285714285,35
29835c0ffb3562a56fe823862e00406efcaa7356,"remote_ip_prefix = ""10.0.0.0/24""",0,1,0.14285714285714285,36
29835c0ffb3562a56fe823862e00406efcaa7356,"('direction', direction),",0,1,0.14285714285714285,37
29835c0ffb3562a56fe823862e00406efcaa7356,sg_rules = group['security_group']['security_group_rules'],0,1,0.14285714285714285,38
29835c0ffb3562a56fe823862e00406efcaa7356,sg_rule = group['security_group']['security_group_rules'],1,1,0.14285714285714285,39
29835c0ffb3562a56fe823862e00406efcaa7356,remote_group_id = sg['security_group']['id'],1,1,0.14285714285714285,40
29835c0ffb3562a56fe823862e00406efcaa7356,"res = self.new_show_request('security-groups', remote_group_id)",1,1,0.14285714285714285,41
29835c0ffb3562a56fe823862e00406efcaa7356,security_group_id = sg['security_group']['id'],1,1,0.14285714285714285,42
29835c0ffb3562a56fe823862e00406efcaa7356,"remote_ip_prefix = ""10.0.0.0/24""",1,1,0.14285714285714285,43
29835c0ffb3562a56fe823862e00406efcaa7356,"('direction', direction),",1,1,0.14285714285714285,44
29835c0ffb3562a56fe823862e00406efcaa7356,sg_rule = [r for r in sg_rule if r['direction'] == 'ingress'],1,1,0.14285714285714285,45
29835c0ffb3562a56fe823862e00406efcaa7356,RULES_TEMPLATE_FOR_DEFAULT_SG = RULES_TEMPLATE_FOR_CUSTOM_SG + [,0,1,0.14285714285714285,46
29835c0ffb3562a56fe823862e00406efcaa7356,'used_in_non_default_sg': False,0,1,0.14285714285714285,47
29835c0ffb3562a56fe823862e00406efcaa7356,security_group_id = sg['security_group']['id'],0,1,0.14285714285714285,48
29835c0ffb3562a56fe823862e00406efcaa7356,'used_in_non_default_sg': True,0,1,0.14285714285714285,49
29835c0ffb3562a56fe823862e00406efcaa7356,fields),0,1,0.14285714285714285,50
29835c0ffb3562a56fe823862e00406efcaa7356,RULES_TEMPLATE_FOR_CUSTOM_SG = [,0,1,0.14285714285714285,51
29835c0ffb3562a56fe823862e00406efcaa7356,SECURITYGROUPS = 'security_groups',0,1,0.14285714285714285,52
29835c0ffb3562a56fe823862e00406efcaa7356,SECURITYGROUPRULES = 'security_group_rules',0,1,0.14285714285714285,53
29835c0ffb3562a56fe823862e00406efcaa7356,'security_group_rules': {,1,1,0.14285714285714285,54
29835c0ffb3562a56fe823862e00406efcaa7356,SECURITYGROUPS = 'security_groups',1,1,0.14285714285714285,55
29835c0ffb3562a56fe823862e00406efcaa7356,"""""""Check that rules being installed.",0,1,0.14285714285714285,56
29835c0ffb3562a56fe823862e00406efcaa7356,"context, id,",0,1,0.14285714285714285,57
29835c0ffb3562a56fe823862e00406efcaa7356,"context, _pager=pager, validate_filters=False,",0,1,0.14285714285714285,58
29835c0ffb3562a56fe823862e00406efcaa7356,{'security_group_id': [id]}),0,1,0.14285714285714285,59
29835c0ffb3562a56fe823862e00406efcaa7356,"def _get_security_group(self, context, id, fields=None):",0,1,0.14285714285714285,60
29835c0ffb3562a56fe823862e00406efcaa7356,res['security_group_rules'] = [,0,1,0.14285714285714285,61
29835c0ffb3562a56fe823862e00406efcaa7356,"context, _pager=pager, validate_filters=False, **filters)",1,1,0.14285714285714285,62
29835c0ffb3562a56fe823862e00406efcaa7356,ret['security_group_rules'] = self.get_security_group_rules(,1,1,0.14285714285714285,63
29835c0ffb3562a56fe823862e00406efcaa7356,"def _get_security_group(self, context, id):",1,1,0.14285714285714285,64
29835c0ffb3562a56fe823862e00406efcaa7356,res['security_group_rules'] = [,1,1,0.14285714285714285,65
29835c0ffb3562a56fe823862e00406efcaa7356,"with self.security_group(name, description) as security_group:",1,0,0.0,66
29835c0ffb3562a56fe823862e00406efcaa7356,return_value=copy.deepcopy(RULES_TEMPLATE_FOR_DEFAULT_SG)):,0,0,0.0,67
29835c0ffb3562a56fe823862e00406efcaa7356,"self.assertEqual('admin-tenant', rules[2]['tenant_id'])",0,0,0.0,68
29835c0ffb3562a56fe823862e00406efcaa7356,"self.assertNotEqual('admin-tenant', rules[1]['tenant_id'])",0,0,0.0,69
29835c0ffb3562a56fe823862e00406efcaa7356,"self.assertEqual(3, len(rules))",0,0,0.0,70
29835c0ffb3562a56fe823862e00406efcaa7356,"self.assertEqual(v, sg_rules[0][k])",0,0,0.0,71
29835c0ffb3562a56fe823862e00406efcaa7356,"self.assertEqual(1, len(sg_rules))",0,0,0.0,72
29835c0ffb3562a56fe823862e00406efcaa7356,group['security_group']['id']),0,0,0.0,73
29835c0ffb3562a56fe823862e00406efcaa7356,"security_group_id,",0,0,0.0,74
29835c0ffb3562a56fe823862e00406efcaa7356,"self.assertEqual(remote_group_id,",0,0,0.0,75
29835c0ffb3562a56fe823862e00406efcaa7356,"self.fmt, res.get_response(self.ext_api))",0,0,0.0,76
29835c0ffb3562a56fe823862e00406efcaa7356,remote_ip_prefix=remote_ip_prefix):,0,0,0.0,77
29835c0ffb3562a56fe823862e00406efcaa7356,"port_range_max=port_range_max,",0,0,0.0,78
29835c0ffb3562a56fe823862e00406efcaa7356,"port_range_min=port_range_min,",0,0,0.0,79
29835c0ffb3562a56fe823862e00406efcaa7356,"protocol=protocol,",0,0,0.0,80
29835c0ffb3562a56fe823862e00406efcaa7356,"direction=direction,",0,0,0.0,81
29835c0ffb3562a56fe823862e00406efcaa7356,"self.assertEqual(v, security_group['security_group'][k])",1,0,0.0,82
29835c0ffb3562a56fe823862e00406efcaa7356,with self.security_group_rule(,0,0,0.0,83
29835c0ffb3562a56fe823862e00406efcaa7356,"('port_range_max', port_range_max)]",0,0,0.0,84
29835c0ffb3562a56fe823862e00406efcaa7356,"for k, v, in keys:",1,0,0.0,85
29835c0ffb3562a56fe823862e00406efcaa7356,"protocol=protocol,",1,0,0.0,86
29835c0ffb3562a56fe823862e00406efcaa7356,"with self.security_group(name, description) as sg:",1,0,0.0,87
29835c0ffb3562a56fe823862e00406efcaa7356,"('security_group_id', security_group_id),",1,0,0.0,88
29835c0ffb3562a56fe823862e00406efcaa7356,"('protocol', protocol),",0,0,0.0,89
29835c0ffb3562a56fe823862e00406efcaa7356,"self.assertEqual('admin-tenant', rules[4]['tenant_id'])",1,0,0.0,90
29835c0ffb3562a56fe823862e00406efcaa7356,"self.assertNotEqual('admin-tenant', rules[3]['tenant_id'])",1,0,0.0,91
29835c0ffb3562a56fe823862e00406efcaa7356,"self.assertEqual(5, len(rules))",1,0,0.0,92
29835c0ffb3562a56fe823862e00406efcaa7356,"self.assertEqual(v, sg_rule[0][k])",1,0,0.0,93
29835c0ffb3562a56fe823862e00406efcaa7356,"self.assertEqual(3, len(sg_rule))",1,0,0.0,94
29835c0ffb3562a56fe823862e00406efcaa7356,group['security_group']['id']),1,0,0.0,95
29835c0ffb3562a56fe823862e00406efcaa7356,"self.assertEqual(remote_group_id,",1,0,0.0,96
29835c0ffb3562a56fe823862e00406efcaa7356,"self.fmt, res.get_response(self.ext_api))",1,0,0.0,97
29835c0ffb3562a56fe823862e00406efcaa7356,remote_ip_prefix=remote_ip_prefix):,1,0,0.0,98
29835c0ffb3562a56fe823862e00406efcaa7356,"port_range_max=port_range_max,",1,0,0.0,99
29835c0ffb3562a56fe823862e00406efcaa7356,"port_range_min=port_range_min,",1,0,0.0,100
29835c0ffb3562a56fe823862e00406efcaa7356,"direction=direction,",1,0,0.0,101
29835c0ffb3562a56fe823862e00406efcaa7356,"with self.security_group_rule(security_group_id,",1,0,0.0,102
29835c0ffb3562a56fe823862e00406efcaa7356,"('port_range_max', port_range_max)]",1,0,0.0,103
29835c0ffb3562a56fe823862e00406efcaa7356,"('port_range_min', port_range_min),",1,0,0.0,104
29835c0ffb3562a56fe823862e00406efcaa7356,"('protocol', protocol),",1,0,0.0,105
29835c0ffb3562a56fe823862e00406efcaa7356,"('port_range_min', port_range_min),",0,0,0.0,106
29835c0ffb3562a56fe823862e00406efcaa7356,],0,0,0.0,107
29835c0ffb3562a56fe823862e00406efcaa7356,"('security_group_id', security_group_id),",0,0,0.0,108
29835c0ffb3562a56fe823862e00406efcaa7356,"'remote_ip_prefix': None,",0,0,0.0,109
29835c0ffb3562a56fe823862e00406efcaa7356,"'ethertype': const.IPv4,",0,0,0.0,110
29835c0ffb3562a56fe823862e00406efcaa7356,"'direction': 'egress',",0,0,0.0,111
29835c0ffb3562a56fe823862e00406efcaa7356,{,0,0,0.0,112
29835c0ffb3562a56fe823862e00406efcaa7356,ext_sg_default_rules,0,0,0.0,113
29835c0ffb3562a56fe823862e00406efcaa7356,from neutron.extensions import security_groups_default_rules as \,0,0,0.0,114
29835c0ffb3562a56fe823862e00406efcaa7356,],1,0,0.0,115
29835c0ffb3562a56fe823862e00406efcaa7356,for r in security_group.rules,1,0,0.0,116
29835c0ffb3562a56fe823862e00406efcaa7356,self._make_security_group_rule_dict(r.db_obj),1,0,0.0,117
29835c0ffb3562a56fe823862e00406efcaa7356,for r in security_group.rules,0,0,0.0,118
29835c0ffb3562a56fe823862e00406efcaa7356,self._make_security_group_rule_dict(r.db_obj),0,0,0.0,119
29835c0ffb3562a56fe823862e00406efcaa7356,if security_group.rules:,0,0,0.0,120
29835c0ffb3562a56fe823862e00406efcaa7356,'security_group_rules' in fields):,0,0,0.0,121
29835c0ffb3562a56fe823862e00406efcaa7356,"fields=fields),",0,0,0.0,122
29835c0ffb3562a56fe823862e00406efcaa7356,"fields=fields, **filters)",0,0,0.0,123
29835c0ffb3562a56fe823862e00406efcaa7356,'security_groups': {,1,0,0.0,124
29835c0ffb3562a56fe823862e00406efcaa7356,SECURITYGROUPRULES: {,0,0,0.0,125
29835c0ffb3562a56fe823862e00406efcaa7356,SECURITYGROUPS: {,0,0,0.0,126
29835c0ffb3562a56fe823862e00406efcaa7356,"'remote_group_id': None,",0,0,0.0,127
29835c0ffb3562a56fe823862e00406efcaa7356,"'protocol': None,",0,0,0.0,128
29835c0ffb3562a56fe823862e00406efcaa7356,"with self.security_group(name, description) as sg:",0,0,0.0,129
29835c0ffb3562a56fe823862e00406efcaa7356,"'port_range_max': None,",0,0,0.0,130
29835c0ffb3562a56fe823862e00406efcaa7356,"'get_default_security_group_rules', return_value=[]):",0,0,0.0,131
29835c0ffb3562a56fe823862e00406efcaa7356,# above,0,0,0.0,132
29835c0ffb3562a56fe823862e00406efcaa7356,"self.assertEqual(v, security_group['security_group'][k])",0,0,0.0,133
29835c0ffb3562a56fe823862e00406efcaa7356,"for k, v, in keys:",0,0,0.0,134
29835c0ffb3562a56fe823862e00406efcaa7356,"with self.security_group(name, description) as security_group:",0,0,0.0,135
29835c0ffb3562a56fe823862e00406efcaa7356,return_value=RULES_TEMPLATE_FOR_CUSTOM_SG):,0,0,0.0,136
29835c0ffb3562a56fe823862e00406efcaa7356,"'get_default_security_group_rules',",0,0,0.0,137
29835c0ffb3562a56fe823862e00406efcaa7356,"SecurityGroupTestPlugin,",0,0,0.0,138
29835c0ffb3562a56fe823862e00406efcaa7356,with mock.patch.object(,0,0,0.0,139
29835c0ffb3562a56fe823862e00406efcaa7356,"'remote_group_id': ext_sg_default_rules.PARENT_SG,",0,0,0.0,140
29835c0ffb3562a56fe823862e00406efcaa7356,"'direction': 'ingress',",0,0,0.0,141
29835c0ffb3562a56fe823862e00406efcaa7356,],0,0,0.0,142
29835c0ffb3562a56fe823862e00406efcaa7356,},0,0,0.0,143
29835c0ffb3562a56fe823862e00406efcaa7356,"'ethertype': const.IPv6,",0,0,0.0,144
29835c0ffb3562a56fe823862e00406efcaa7356,"}, {",0,0,0.0,145
29835c0ffb3562a56fe823862e00406efcaa7356,"'used_in_default_sg': True,",0,0,0.0,146
29835c0ffb3562a56fe823862e00406efcaa7356,"'port_range_min': None,",0,0,0.0,147
29835c0ffb3562a56fe823862e00406efcaa7356,with self.network():,1,0,0.0,148
