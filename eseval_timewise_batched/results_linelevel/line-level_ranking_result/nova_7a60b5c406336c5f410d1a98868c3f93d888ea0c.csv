commit_id,line,line_level_label,count,line_score,row
7a60b5c406336c5f410d1a98868c3f93d888ea0c,2.1. Create a dummy vmdk of the size of the disk file that is to be,0,9,1.0,1
7a60b5c406336c5f410d1a98868c3f93d888ea0c,2. Create a dummy vmdk of the size of the disk file that is to be,1,9,1.0,2
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# Copyright (c) 2011 Citrix Systems, Inc.",0,7,0.7777777777777777,3
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"#    distributed under the License is distributed on an ""AS IS"" BASIS, WITHOUT",0,7,0.7777777777777777,4
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# Copyright (c) 2011 Citrix Systems, Inc.",1,7,0.7777777777777777,5
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"#    distributed under the License is distributed on an ""AS IS"" BASIS, WITHOUT",1,7,0.7777777777777777,6
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Downloaded image file data %(image_ref)s to the ESX """,1,7,0.7777777777777777,7
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# Copyright (c) 2011 Citrix Systems, Inc.",1,7,0.7777777777777777,8
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"#    distributed under the License is distributed on an ""AS IS"" BASIS, WITHOUT",1,7,0.7777777777777777,9
7a60b5c406336c5f410d1a98868c3f93d888ea0c,Attach the vmdk uploaded to the VM. VM reconfigure is done,1,6,0.6666666666666666,10
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# way to differentiate. We thus check if the session is,0,6,0.6666666666666666,11
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# The data file is the one occupying space, and likelier to see",0,6,0.6666666666666666,12
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Login and setup the session with the ESX host for making,1,6,0.6666666666666666,13
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get size of the vmdk file that is to be downloaded for attach in spawn.",1,6,0.6666666666666666,14
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Naming the VM files in correspondence with the VM instance name,1,6,0.6666666666666666,15
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# There is only one default datacenter in a standalone ESX host,0,6,0.6666666666666666,16
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# better approximation would use the percentage of the VM image that,0,6,0.6666666666666666,17
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Naming the VM files in correspondence with the VM instance,0,6,0.6666666666666666,18
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# There is only one default datacenter in a standalone ESX host,1,6,0.6666666666666666,19
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Create a snapshot of the VM,1,5,0.5555555555555556,20
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Reconfiguring VM instance to attach the image disk""),",1,5,0.5555555555555556,21
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Reconfigured VM instance to attach the image disk""),",1,5,0.5555555555555556,22
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Login and setup the session with the host for making,0,5,0.5555555555555556,23
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if not self._host_ip or host_username is None or host_password is None:,1,5,0.5555555555555556,24
7a60b5c406336c5f410d1a98868c3f93d888ea0c,Sets up a session with the ESX host and handles all,1,5,0.5555555555555556,25
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# to ensure that the session is not left active.,1,5,0.5555555555555556,26
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# The controller Key pertains to the Key of the LSI Logic Controller, which",1,5,0.5555555555555556,27
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# node is not set in instance. Perform destroy only if node is set,1,5,0.5555555555555556,28
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# Copy the contents of the disk (or disks, if there were snapshots",1,5,0.5555555555555556,29
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Get the list of clusters to be used,0,5,0.5555555555555556,30
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return 'Please refer to %s for the uptime' % CONF.vmware.host_ip,1,5,0.5555555555555556,31
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#    not use this file except in compliance with the License. You may obtain,1,5,0.5555555555555556,32
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#    a copy of the License at,1,5,0.5555555555555556,33
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"base_url = base_url + ""?"" + urllib.urlencode(param_list)",1,5,0.5555555555555556,34
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# We are ignoring the chunk size passed for we want the pipe to hold,1,5,0.5555555555555556,35
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Delete the -flat.vmdk file created. .vmdk file is retained.,1,5,0.5555555555555556,36
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Upload the -flat.vmdk file whose meta-data file we just created,1,5,0.5555555555555556,37
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Get the list of clusters to be used,1,5,0.5555555555555556,38
7a60b5c406336c5f410d1a98868c3f93d888ea0c,""" KB on the ESX host local store """,1,5,0.5555555555555556,39
7a60b5c406336c5f410d1a98868c3f93d888ea0c,4. Attach the disk to the VM by reconfiguring the same.,0,5,0.5555555555555556,40
7a60b5c406336c5f410d1a98868c3f93d888ea0c,5. Attach the disk to the VM by reconfiguring the same.,1,5,0.5555555555555556,41
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Copyright 2011 OpenStack LLC.,0,5,0.5555555555555556,42
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#    not use this file except in compliance with the License. You may obtain,0,5,0.5555555555555556,43
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#    a copy of the License at,0,5,0.5555555555555556,44
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Copyright 2011 OpenStack LLC.,1,5,0.5555555555555556,45
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#    a copy of the License at,1,5,0.5555555555555556,46
7a60b5c406336c5f410d1a98868c3f93d888ea0c,3.1. Upload the disk file to a -sparse.vmdk file.,0,5,0.5555555555555556,47
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#    not use this file except in compliance with the License. You may obtain,1,5,0.5555555555555556,48
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# Set the vnc configuration of the instance, vnc port starts from 5900",0,5,0.5555555555555556,49
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Copy a sparse virtual disk to a thin virtual disk. This is also,0,5,0.5555555555555556,50
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Check if the file exists or not.,0,5,0.5555555555555556,51
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# depend on the size of the disk, thin/thick provisioning and the",0,5,0.5555555555555556,52
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Attach the vmdk uploaded to the VM.,0,5,0.5555555555555556,53
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Attach vmdk to the rescue VM,0,5,0.5555555555555556,54
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Raise Exception if VM is suspended,0,5,0.5555555555555556,55
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Downloaded image file data %(image_ref)s to """,0,5,0.5555555555555556,56
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get info about the host on which the VM resides.""""""",1,4,0.4444444444444444,57
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# The ESXi API are a proper sub-set of the vCenter API.,1,4,0.4444444444444444,58
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# NOTE(hartsocks): we lean on the init_host to force the vim object,1,4,0.4444444444444444,59
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Retrieves the IP address of the ESX host.""""""",1,4,0.4444444444444444,60
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Sets up a session with the VC/ESX host and handles all",1,4,0.4444444444444444,61
7a60b5c406336c5f410d1a98868c3f93d888ea0c,as part of a periodic task that records the results in the DB.,1,4,0.4444444444444444,62
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# The _resources is used to maintain the vmops, volumeops and vcstate",1,4,0.4444444444444444,63
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Sets up a session with the VC host and handles all",0,4,0.4444444444444444,64
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# is not a problem as long as the import order doesn't change.,0,4,0.4444444444444444,65
7a60b5c406336c5f410d1a98868c3f93d888ea0c,help='Name of a VMware Cluster ComputeResource. Used only if ',1,4,0.4444444444444444,66
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Deleted the file %(vmdk_path)s on the """,1,4,0.4444444444444444,67
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# The _resources is used to maintain the vmops, volumeops and vcstate",0,4,0.4444444444444444,68
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# of ESX hosts in clusters or non-cluster logical-groupings.,0,4,0.4444444444444444,69
7a60b5c406336c5f410d1a98868c3f93d888ea0c,host    : ESX IPAddress[:port] or ESX Hostname[:port],1,4,0.4444444444444444,70
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# done earlier) to a temporary vmdk file.,1,4,0.4444444444444444,71
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Consolidate the snapshotted disk to a temporary vmdk.,0,4,0.4444444444444444,72
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# It is just cautionary on our part to do a logout in del just,1,4,0.4444444444444444,73
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# May not have been able to connect to VC, so vim is still None",1,4,0.4444444444444444,74
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Logout to avoid un-necessary increase in session count at the,1,4,0.4444444444444444,75
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(""Got image size of %(size)s for the image %(image)s"",",1,4,0.4444444444444444,76
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# it when the data disk it refers to still lingers.,0,4,0.4444444444444444,77
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"base_url = ""%s://%s/folder/%s"" % (scheme, host, file_path)",1,4,0.4444444444444444,78
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# calculate linked_clone flag, allow image properties to override the",0,4,0.4444444444444444,79
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"base_url = ""%s://%s/folder/%s"" % (scheme, host,",0,4,0.4444444444444444,80
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Copyright 2011 OpenStack Foundation,1,4,0.4444444444444444,81
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"base_url = ""%s://%s/folder/%s"" % (scheme, host,",1,4,0.4444444444444444,82
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"base_url = ""%s://[%s]/folder/%s"" % (scheme, host, file_path)",0,4,0.4444444444444444,83
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Return a Deferred that will give the result of the given task.",1,4,0.4444444444444444,84
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Check if the module is a VIM Object instance.""""""",1,4,0.4444444444444444,85
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Sets up a session with the VC/ESX host and handles all",1,4,0.4444444444444444,86
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# data items of the chunk-size that Glance Client uses for read,1,4,0.4444444444444444,87
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get size of the file to be read.""""""",1,4,0.4444444444444444,88
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Check if the end of file has been reached.""""""",1,4,0.4444444444444444,89
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"base_url = ""%s://%s:%s/folder/%s"" % (scheme, host, port,",0,4,0.4444444444444444,90
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"base_url = ""%s://[%s]:%s/folder/%s"" % (scheme, host, port,",0,4,0.4444444444444444,91
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"base_url = ""%s://[%s]/folder/%s"" % (scheme, host,",1,4,0.4444444444444444,92
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"#    Licensed under the Apache License, Version 2.0 (the ""License""); you may",1,4,0.4444444444444444,93
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"base_url = ""%s://%s/folder/%s"" % (scheme, host,",1,4,0.4444444444444444,94
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"base_url = ""%s://%s/folder/%s"" % (scheme, host, file_path)",1,4,0.4444444444444444,95
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"base_url = ""%s://[%s]/folder/%s"" % (scheme, host, file_path)",1,4,0.4444444444444444,96
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"base_url = ""%s://[%s]/folder/%s"" % (scheme, host,",0,4,0.4444444444444444,97
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if adapter_name and not ip_address == current_ip_address:,1,4,0.4444444444444444,98
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"cmd = ['""' + vmware_tools_bin + '""', '--cmd', 'machine.id.get']",1,4,0.4444444444444444,99
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"elif os.path.exists(os.path.join(program_files, 'VMware', 'VMware Tools',",1,4,0.4444444444444444,100
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if os.path.exists(os.path.join(program_files, 'VMware', 'VMware Tools',",1,4,0.4444444444444444,101
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#    under the License.,1,4,0.4444444444444444,102
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"base_url = ""%s://%s/folder/%s"" % (scheme, host, file_path)",0,4,0.4444444444444444,103
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if not (self._host_ip or CONF.vmware.host_username is None or,1,4,0.4444444444444444,104
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Creates a session with the ESX host.""""""",1,4,0.4444444444444444,105
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"elif os.path.exists(os.path.join(program_files, 'VMware', 'VMware Tools',",1,4,0.4444444444444444,106
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# done to generate the meta-data file whose specifics,0,4,0.4444444444444444,107
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""%(upload_vmdk_name)s on the ESX data store """,0,4,0.4444444444444444,108
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# For sparse disk, upload the -sparse.vmdk file to be copied into",0,4,0.4444444444444444,109
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# For flat disk, upload the -flat.vmdk file whose meta-data file",0,4,0.4444444444444444,110
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Deleted the file %(vmdk_path)s on the """,0,4,0.4444444444444444,111
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""%(adapter_type)s on the ESX host local store """,0,4,0.4444444444444444,112
7a60b5c406336c5f410d1a98868c3f93d888ea0c,3.2. Copy/Clone the -sparse.vmdk file to a thin vmdk.,0,4,0.4444444444444444,113
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if wbem_network_adapter.NetConnectionStatus == 2 or \,1,4,0.4444444444444444,114
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if adapter_name and not ip_address == current_ip_address:,1,4,0.4444444444444444,115
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"cmd = ['""' + vmware_tools_bin + '""', '--cmd', 'machine.id.get']",1,4,0.4444444444444444,116
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if os.path.exists(os.path.join(program_files, 'VMware', 'VMware Tools',",1,4,0.4444444444444444,117
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Copy the sparse virtual disk to a thin virtual disk.,0,4,0.4444444444444444,118
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if wbem_network_adapter.NetConnectionStatus == 2 or \,1,4,0.4444444444444444,119
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#    under the License.,1,4,0.4444444444444444,120
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"#    Licensed under the Apache License, Version 2.0 (the ""License""); you may",1,4,0.4444444444444444,121
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if adapter_name and not ip_address == current_ip_address:,0,4,0.4444444444444444,122
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"cmd = ['""' + vmware_tools_bin + '""', '--cmd', 'machine.id.get']",0,4,0.4444444444444444,123
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"elif os.path.exists(os.path.join(program_files, 'VMware', 'VMware Tools',",0,4,0.4444444444444444,124
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if wbem_network_adapter.NetConnectionStatus == 2 or \,0,4,0.4444444444444444,125
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#    under the License.,0,4,0.4444444444444444,126
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"#    Licensed under the Apache License, Version 2.0 (the ""License""); you may",0,4,0.4444444444444444,127
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# May not have been able to connect to VC, so vim is still None",0,4,0.4444444444444444,128
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# The sparse vmdk file name for sparse disk image,0,4,0.4444444444444444,129
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if os.path.exists(os.path.join(program_files, 'VMware', 'VMware Tools',",0,4,0.4444444444444444,130
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Attach the root disk to the VM.,0,4,0.4444444444444444,131
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Reconfigured VM instance to enable vnc on """,0,4,0.4444444444444444,132
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# the clone disk step begins to dominate the equation. A,0,4,0.4444444444444444,133
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if not (self._host_ip or CONF.vmware.host_username is None or,0,4,0.4444444444444444,134
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Deleted the file %(flat_uploaded_vmdk_path)s on the """,1,4,0.4444444444444444,135
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Get the resource pool. Taking the first resource pool coming our,1,4,0.4444444444444444,136
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# Check if the folder exists or not. If not, create one",0,4,0.4444444444444444,137
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Wait till the state changes from queued or running.,0,4,0.4444444444444444,138
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Check if the path and file exists on the datastore.""""""",0,4,0.4444444444444444,139
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Get the resource pool. Taking the first resource pool coming our,0,4,0.4444444444444444,140
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get reference to the host with the name specified.""""""",0,4,0.4444444444444444,141
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get reference to the VM with the name specified.""""""",1,4,0.4444444444444444,142
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Reconfiguring VM instance to enable vnc on """,0,4,0.4444444444444444,143
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# 3. Clone VM on ESX host,0,4,0.4444444444444444,144
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"Transfers the disk of a running instance in multiple phases, turning",0,4,0.4444444444444444,145
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Migrated VM to host %s"") % dest, instance=instance_ref)",0,4,0.4444444444444444,146
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Renaming the VM to %s"") % name_label,",0,4,0.4444444444444444,147
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Renamed the VM to %s"") % name_label,",0,4,0.4444444444444444,148
7a60b5c406336c5f410d1a98868c3f93d888ea0c,Sets up a session with the VC/ESX host and handles all,0,4,0.4444444444444444,149
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Migrating VM to host %s"") % dest, instance=instance_ref)",0,4,0.4444444444444444,150
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Cloned VM to host %s"") % dest, instance=instance)",0,4,0.4444444444444444,151
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Cloning VM to host %s"") % dest, instance=instance)",0,4,0.4444444444444444,152
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Creates a session with the VC host.""""""",0,3,0.3333333333333333,153
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Created Snapshot of the VM instance""), instance=instance)",0,3,0.3333333333333333,154
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Deleting Snapshot of the VM instance""), instance=instance)",0,3,0.3333333333333333,155
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Deleted Snapshot of the VM instance""), instance=instance)",0,3,0.3333333333333333,156
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Creating Snapshot of the VM instance""),",1,3,0.3333333333333333,157
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Created Snapshot of the VM instance""),",1,3,0.3333333333333333,158
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_('Copying disk data before snapshot of the VM'),",1,3,0.3333333333333333,159
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Copied disk data before snapshot of the VM""),",1,3,0.3333333333333333,160
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Ignoring the orphaned or inaccessible VMs,0,3,0.3333333333333333,161
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Got total of %s instances"") % str(len(lst_vm_names)))",0,3,0.3333333333333333,162
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Ignoring the orphaned or inaccessible VMs,1,3,0.3333333333333333,163
7a60b5c406336c5f410d1a98868c3f93d888ea0c,host    : ESX IPAddress or Hostname,0,3,0.3333333333333333,164
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# The following class was removed in the transition from Icehouse to,0,3,0.3333333333333333,165
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# following stub allow those configurations to work while logging a,0,3,0.3333333333333333,166
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# That is to say, nearly all valid ESXi calls are",1,3,0.3333333333333333,167
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# vCenter is not a hypervisor itself, it works with multiple",0,3,0.3333333333333333,168
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Check if there are any clusters that were specified in the nova.conf,0,3,0.3333333333333333,169
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# but are not in the vCenter, for missing clusters log a warning.",0,3,0.3333333333333333,170
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# The following initialization is necessary since the base class does,0,3,0.3333333333333333,171
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Creating Snapshot of the VM instance""), instance=instance)",0,3,0.3333333333333333,172
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# The vCenter driver includes API that acts on ESX hosts or groups,0,3,0.3333333333333333,173
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# ESX host,1,3,0.3333333333333333,174
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if adapter_type == ""ide"":",1,3,0.3333333333333333,175
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""on the ESX host local""",1,3,0.3333333333333333,176
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.critical(_(""Unable to connect to server at %(server)s, """,0,3,0.3333333333333333,177
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Return the current state of the host.",1,3,0.3333333333333333,178
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def __init__(self, host_ip, host_username, host_password,",1,3,0.3333333333333333,179
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Gets the specified properties of the Managed Object.""""""",0,3,0.3333333333333333,180
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Deleting the datastore file %s"") % datastore_path,",0,3,0.3333333333333333,181
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# unlikely event that its deletion fails, the small descriptor file",0,3,0.3333333333333333,182
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# is retained too by design since it makes little sense to remove,0,3,0.3333333333333333,183
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Deleting the file %(vmdk_path)s """,1,3,0.3333333333333333,184
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Delete the vmdk file.,1,3,0.3333333333333333,185
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if controller_key is None:,1,3,0.3333333333333333,186
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Delete the temporary vmdk created above.,1,3,0.3333333333333333,187
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# For exceptions with connections we create the session,0,3,0.3333333333333333,188
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# So if the previous response was also am empty response,1,3,0.3333333333333333,189
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# and after creating a new session, we get the same empty",1,3,0.3333333333333333,190
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# response, then we are sure of the response being supposed",1,3,0.3333333333333333,191
7a60b5c406336c5f410d1a98868c3f93d888ea0c,Return dictionary which maps controller_key to list of allocated unit,0,3,0.3333333333333333,192
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if adapter_type == 'ide':,0,3,0.3333333333333333,193
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# create new controller with the specified type and return its spec,0,3,0.3333333333333333,194
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# is not successful. When resource claim is not successful,",1,3,0.3333333333333333,195
7a60b5c406336c5f410d1a98868c3f93d888ea0c,Each of the NIC will have record NIC_record in the form,1,3,0.3333333333333333,196
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# capabilities that include API that act on hosts or groups of,1,3,0.3333333333333333,197
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# vCenter is not a hypervisor itself, it works with multiple",1,3,0.3333333333333333,198
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return adapter_name, ip_address",1,3,0.3333333333333333,199
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Executes the command with the list of arguments specified.""""""",1,3,0.3333333333333333,200
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vmware_tools_bin = os.path.join(program_files, 'VMware',",1,3,0.3333333333333333,201
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'VMware', 'VMware Tools',",1,3,0.3333333333333333,202
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vmware_tools_bin = os.path.join(program_files_x86, 'VMware',",1,3,0.3333333333333333,203
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'name=""%s""' % adapter_name, 'source=static', ip_address,",1,3,0.3333333333333333,204
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._base_url = self._base_url + ""?"" + urllib.urlencode(param_list)",0,3,0.3333333333333333,205
7a60b5c406336c5f410d1a98868c3f93d888ea0c,The chunk size is ignored for the Client ImageBodyIterator,1,3,0.3333333333333333,206
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get the next item from the image iterator.""""""",1,3,0.3333333333333333,207
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Set the end of file marker.""""""",1,3,0.3333333333333333,208
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.eof = eof,1,3,0.3333333333333333,209
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Build ESX host session cookie headers.""""""",1,3,0.3333333333333333,210
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"cookie_header = vim_cookie.name + ""="" + vim_cookie.value",1,3,0.3333333333333333,211
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Write data to the file.""""""",1,3,0.3333333333333333,212
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Read a chunk of data.""""""",1,3,0.3333333333333333,213
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Returns information for the primary VMDK attached to the given VM.""""""",0,3,0.3333333333333333,214
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Returns information for the primary VMDK attached to the given VM.""""""",1,3,0.3333333333333333,215
7a60b5c406336c5f410d1a98868c3f93d888ea0c,the calls made to the host.,1,3,0.3333333333333333,216
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if vm_ref is None:,1,3,0.3333333333333333,217
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if (adapter.NetConnectionStatus == 2 or,1,3,0.3333333333333333,218
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"machine_id is of the form ('NIC_record#NIC_record#', '')",1,3,0.3333333333333333,219
7a60b5c406336c5f410d1a98868c3f93d888ea0c,intgr = (intgr << 8) + _byte(byt),1,3,0.3333333333333333,220
7a60b5c406336c5f410d1a98868c3f93d888ea0c,:param image_id - image id of image,0,3,0.3333333333333333,221
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# but are not in the vCenter, for missing clusters log a warning.",1,3,0.3333333333333333,222
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# The following initialization is necessary since the base class does,1,3,0.3333333333333333,223
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# API logic to create a valid VNC console connection object.,1,3,0.3333333333333333,224
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Creates a session with the VC/ESX host.""""""",1,3,0.3333333333333333,225
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# because nova.virt.vmwareapi.driver is imported first. In fact, it is not",0,3,0.3333333333333333,226
7a60b5c406336c5f410d1a98868c3f93d888ea0c,image_id (str): uuid of the image,0,3,0.3333333333333333,227
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_type (str): name of the adapter's type,0,3,0.3333333333333333,228
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Returns VMwareImage, the subset of properties the driver uses.",0,3,0.3333333333333333,229
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# catch any string values that need to be interpreted as boolean values,0,3,0.3333333333333333,230
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_byte = int    # 3.x byte to integer,1,3,0.3333333333333333,231
7a60b5c406336c5f410d1a98868c3f93d888ea0c,Need this to create the dummy virtual disk for the meta-data file. The,1,3,0.3333333333333333,232
7a60b5c406336c5f410d1a98868c3f93d888ea0c,geometry of the disk created depends on the size.,1,3,0.3333333333333333,233
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(""Getting image size for the image %s"", image,",1,3,0.3333333333333333,234
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"#    Unless required by applicable law or agreed to in writing, software",1,3,0.3333333333333333,235
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"#    WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the",1,3,0.3333333333333333,236
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#    License for the specific language governing permissions and limitations,1,3,0.3333333333333333,237
7a60b5c406336c5f410d1a98868c3f93d888ea0c,Guest tools for ESX to set up network in the guest.,1,3,0.3333333333333333,238
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_byte = ord    # 2.x chr to integer,1,3,0.3333333333333333,239
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Creates a session with the VC/ESX host.""""""",0,3,0.3333333333333333,240
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Check if there are any clusters that were specified in the nova.conf,1,3,0.3333333333333333,241
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if vm_ref is None:,0,3,0.3333333333333333,242
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vmware_tools_bin = os.path.join(program_files_x86, 'VMware',",0,3,0.3333333333333333,243
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'name=""%s""' % adapter_name, 'source=static', ip_address,",0,3,0.3333333333333333,244
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"#    Unless required by applicable law or agreed to in writing, software",1,3,0.3333333333333333,245
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"#    WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the",1,3,0.3333333333333333,246
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#    License for the specific language governing permissions and limitations,1,3,0.3333333333333333,247
7a60b5c406336c5f410d1a98868c3f93d888ea0c,Guest tools for ESX to set up network in the guest.,1,3,0.3333333333333333,248
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_byte = ord    # 2.x chr to integer,1,3,0.3333333333333333,249
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_byte = int    # 3.x byte to integer,1,3,0.3333333333333333,250
7a60b5c406336c5f410d1a98868c3f93d888ea0c,intgr = (intgr << 8) + _byte(byt),1,3,0.3333333333333333,251
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"machine_id is of the form ('NIC_record#NIC_record#', '')",1,3,0.3333333333333333,252
7a60b5c406336c5f410d1a98868c3f93d888ea0c,Each of the NIC will have record NIC_record in the form,1,3,0.3333333333333333,253
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return adapter_name, ip_address",1,3,0.3333333333333333,254
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Executes the command with the list of arguments specified.""""""",1,3,0.3333333333333333,255
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vmware_tools_bin = os.path.join(program_files, 'VMware',",1,3,0.3333333333333333,256
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'VMware', 'VMware Tools',",1,3,0.3333333333333333,257
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vmware_tools_bin = os.path.join(program_files_x86, 'VMware',",1,3,0.3333333333333333,258
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"adapter_name, current_ip_address = \",1,3,0.3333333333333333,259
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'name=""%s""' % adapter_name, 'source=static', ip_address,",1,3,0.3333333333333333,260
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if (adapter.NetConnectionStatus == 2 or,0,3,0.3333333333333333,261
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"adapter_name, current_ip_address = \",1,3,0.3333333333333333,262
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"adapter_name, current_ip_address = \",0,3,0.3333333333333333,263
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'VMware', 'VMware Tools',",0,3,0.3333333333333333,264
7a60b5c406336c5f410d1a98868c3f93d888ea0c,uploaded. This is required just to create the metadata file.,0,3,0.3333333333333333,265
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vmware_tools_bin = os.path.join(program_files, 'VMware',",0,3,0.3333333333333333,266
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Deleting the file %(flat_uploaded_vmdk_path)s """,1,3,0.3333333333333333,267
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"(scheme, netloc, path, params, query, fragment) = \",1,3,0.3333333333333333,268
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'Due to a bug in vSphere ESX 4.1 default wsdl. ',0,3,0.3333333333333333,269
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'Due to a bug in vSphere ESX 4.1 default wsdl. ',1,3,0.3333333333333333,270
7a60b5c406336c5f410d1a98868c3f93d888ea0c,virtual_device_config = \,1,3,0.3333333333333333,271
7a60b5c406336c5f410d1a98868c3f93d888ea0c,connectable_spec = \,1,3,0.3333333333333333,272
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if device.__class__.__name__ == ""VirtualDisk"" and \",1,3,0.3333333333333333,273
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vmdk_file_path_before_snapshot, adapter_type = \",1,3,0.3333333333333333,274
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"interface_str = ""%s;%s;%s;%s;%s;%s"" % \",1,3,0.3333333333333333,275
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"#    Unless required by applicable law or agreed to in writing, software",0,3,0.3333333333333333,276
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"#    WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the",0,3,0.3333333333333333,277
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#    License for the specific language governing permissions and limitations,0,3,0.3333333333333333,278
7a60b5c406336c5f410d1a98868c3f93d888ea0c,Guest tools for ESX to set up network in the guest.,0,3,0.3333333333333333,279
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_byte = ord    # 2.x chr to integer,0,3,0.3333333333333333,280
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_byte = int    # 3.x byte to integer,0,3,0.3333333333333333,281
7a60b5c406336c5f410d1a98868c3f93d888ea0c,intgr = (intgr << 8) + _byte(byt),0,3,0.3333333333333333,282
7a60b5c406336c5f410d1a98868c3f93d888ea0c,Each of the NIC will have record NIC_record in the form,0,3,0.3333333333333333,283
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return adapter_name, ip_address",0,3,0.3333333333333333,284
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Executes the command with the list of arguments specified.""""""",0,3,0.3333333333333333,285
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Ignoring the orphaned or inaccessible VMs,0,3,0.3333333333333333,286
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"machine_id is of the form ('NIC_record#NIC_record#', '')",0,3,0.3333333333333333,287
7a60b5c406336c5f410d1a98868c3f93d888ea0c,2.2. Delete the -flat.vmdk file created in the above step and retain,0,3,0.3333333333333333,288
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# 0. Zero out the progress to begin,0,3,0.3333333333333333,289
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# 2. Rename the original VM with suffix '-orig',0,3,0.3333333333333333,290
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Get the clone vm spec,0,3,0.3333333333333333,291
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# the old suffix, remove the suffix, then power it back on.",0,3,0.3333333333333333,292
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Renaming the VM from %s"") % name_label,",0,3,0.3333333333333333,293
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Renamed the VM from %s"") % name_label,",0,3,0.3333333333333333,294
7a60b5c406336c5f410d1a98868c3f93d888ea0c,port = CONF.vnc_port + vm_id % CONF.vnc_port_total,0,3,0.3333333333333333,295
7a60b5c406336c5f410d1a98868c3f93d888ea0c,Set the vnc configuration of the VM.,0,3,0.3333333333333333,296
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# way. Assuming that is the default resource pool.,0,3,0.3333333333333333,297
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# If an error state is returned, it means that the path doesn't exist.",0,3,0.3333333333333333,298
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Ignoring the oprhaned or inaccessible VMs,1,3,0.3333333333333333,299
7a60b5c406336c5f410d1a98868c3f93d888ea0c,uploaded. This is required just to create the metadata file.,1,3,0.3333333333333333,300
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vm_ref = self._get_vm_ref_from_the_name(instance.name),1,3,0.3333333333333333,301
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# way. Assuming that is the default resource pool.,1,3,0.3333333333333333,302
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Creating VM on the ESX  host""), instance=instance)",1,3,0.3333333333333333,303
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Created VM on the ESX  host""), instance=instance)",1,3,0.3333333333333333,304
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# The flat vmdk file name,1,3,0.3333333333333333,305
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# The vmdk meta-data file,1,3,0.3333333333333333,306
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"uploaded_vmdk_name = ""%s/%s.vmdk"" % (instance.name, instance.name)",1,3,0.3333333333333333,307
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""%(adapter_type)s on the ESX host local store""",1,3,0.3333333333333333,308
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# 1. Power off the instance,0,3,0.3333333333333333,309
7a60b5c406336c5f410d1a98868c3f93d888ea0c,3. Delete the -flat.vmdk file created in the above step and retain,1,3,0.3333333333333333,310
7a60b5c406336c5f410d1a98868c3f93d888ea0c,off the instance before the end.,0,3,0.3333333333333333,311
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Create a flat virtual disk and retain the metadata file.,0,3,0.3333333333333333,312
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Creating VM on the ESX host""), instance=instance)",0,3,0.3333333333333333,313
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# has been streamed to the destination host.,0,3,0.3333333333333333,314
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Created VM on the ESX host""), instance=instance)",0,3,0.3333333333333333,315
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""the ESX host local store %(data_store_name)s"") %",0,3,0.3333333333333333,316
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Deleting the file %(vmdk_path)s """,0,3,0.3333333333333333,317
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Delete the vmdk file.,0,3,0.3333333333333333,318
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Copy a sparse virtual disk to a thin virtual disk.""""""",0,3,0.3333333333333333,319
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# The vmdk meta-data file,0,3,0.3333333333333333,320
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# The flat vmdk file name,0,3,0.3333333333333333,321
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# a flat vmdk,0,3,0.3333333333333333,322
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"1. Power off the VM, if it is in poweredOn state.",0,3,0.3333333333333333,323
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if vm_ref is None:,0,3,0.3333333333333333,324
7a60b5c406336c5f410d1a98868c3f93d888ea0c,""" while destroying the VM: %s"") % str(excep),",0,3,0.3333333333333333,325
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# For a first cut this should be fine, however, for large VM images,",0,3,0.3333333333333333,326
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"pwr_state = self._session._call_method(vim_util,",0,3,0.3333333333333333,327
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if pwr_state == ""poweredOn"":",0,3,0.3333333333333333,328
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"elif pwr_state == ""suspended"":",0,3,0.3333333333333333,329
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# Divide the action's workflow into discrete steps and ""bump"" the",0,3,0.3333333333333333,330
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# subtly alter how vSphere and OpenStack interoperate.,0,2,0.2222222222222222,331
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"help='Name of a VMware Cluster ComputeResource.'),",0,2,0.2222222222222222,332
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# Juno, but may still be referenced in configuration files.  The",0,2,0.2222222222222222,333
7a60b5c406336c5f410d1a98868c3f93d888ea0c,LOG.warn(_LW('The VMware ESX driver is now deprecated and has been ',0,2,0.2222222222222222,334
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# hypervisor host machines and their guests. This fact can,0,2,0.2222222222222222,335
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.warn(_LW(""The following clusters could not be found in the """,0,2,0.2222222222222222,336
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"raise exception.NotFound(_(""All clusters specified %s were not""",0,2,0.2222222222222222,337
7a60b5c406336c5f410d1a98868c3f93d888ea0c,""" found in the vCenter"")",0,2,0.2222222222222222,338
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# vCenter does not actually run the VNC service,0,2,0.2222222222222222,339
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._resources = {},0,2,0.2222222222222222,340
7a60b5c406336c5f410d1a98868c3f93d888ea0c,A connection to the VMware ESX/vCenter platform.,1,2,0.2222222222222222,341
7a60b5c406336c5f410d1a98868c3f93d888ea0c,A connection to the VMware vCenter platform.,0,2,0.2222222222222222,342
7a60b5c406336c5f410d1a98868c3f93d888ea0c,help='Hostname or IP address for connection to VMware VC ',0,2,0.2222222222222222,343
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Lists the VM instances that are registered with vCenter cluster.""""""",0,2,0.2222222222222222,344
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return '%s://%s/sdk' % (protocol, host_name)",1,2,0.2222222222222222,345
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return '%s://[%s]/sdk' % (protocol, host_name)",1,2,0.2222222222222222,346
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return Vim.get_soap_url(protocol, host_name) + ""/vimService.wsdl""",1,2,0.2222222222222222,347
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return '%s://%s:%d/sdk' % (protocol, host_name, port)",0,2,0.2222222222222222,348
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return '%s://[%s]:%d/sdk' % (protocol, host_name, port)",0,2,0.2222222222222222,349
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return Vim.get_soap_url(protocol, host_name, port) + ""/vimService.wsdl""",0,2,0.2222222222222222,350
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vms = self._session._call_method(vim_util,",1,2,0.2222222222222222,351
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"elif prop.name == ""runtime.connectionState"":",1,2,0.2222222222222222,352
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if prop.name == ""name"":",1,2,0.2222222222222222,353
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"retrieve_result = self._session._call_method(vim_util,",0,2,0.2222222222222222,354
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"elif prop.name == ""runtime.connectionState"":",0,2,0.2222222222222222,355
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if prop.name == ""name"":",0,2,0.2222222222222222,356
7a60b5c406336c5f410d1a98868c3f93d888ea0c,LOG.warning(_('The VMware ESX driver is now deprecated and will be ',1,2,0.2222222222222222,357
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"description=""Taking Snapshot of the VM"",",1,2,0.2222222222222222,358
7a60b5c406336c5f410d1a98868c3f93d888ea0c,help='Hostname or IP address for connection to VMware ESX/VC ',1,2,0.2222222222222222,359
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Return info about the VM instance.""""""",1,2,0.2222222222222222,360
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"raise Exception(_(""Must specify host_ip, """,1,2,0.2222222222222222,361
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""and host_password to use """,1,2,0.2222222222222222,362
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"task_info = self._session._call_method(vim_util,",0,2,0.2222222222222222,363
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def get_vnc_console(self, context, instance):",1,2,0.2222222222222222,364
7a60b5c406336c5f410d1a98868c3f93d888ea0c,data = self._vmops.get_instance_diagnostics(instance),1,2,0.2222222222222222,365
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def get_instance_diagnostics(self, instance):",1,2,0.2222222222222222,366
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return data,1,2,0.2222222222222222,367
7a60b5c406336c5f410d1a98868c3f93d888ea0c,data = self._vmops.get_diagnostics(instance),1,2,0.2222222222222222,368
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Return data about VM diagnostics.""""""",1,2,0.2222222222222222,369
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def get_diagnostics(self, instance):",1,2,0.2222222222222222,370
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def attach_volume(self, context, connection_info, instance, mountpoint,",1,2,0.2222222222222222,371
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def get_info(self, instance):",1,2,0.2222222222222222,372
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def power_on(self, context, instance, network_info,",1,2,0.2222222222222222,373
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def power_off(self, instance):",1,2,0.2222222222222222,374
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def unrescue(self, instance, network_info):",1,2,0.2222222222222222,375
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def rescue(self, context, instance, network_info, image_meta,",1,2,0.2222222222222222,376
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Resume the suspended VM instance.""""""",1,2,0.2222222222222222,377
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def resume(self, context, instance, network_info, block_device_info=None):",1,2,0.2222222222222222,378
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def suspend(self, instance):",1,2,0.2222222222222222,379
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def unpause(self, instance):",1,2,0.2222222222222222,380
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def pause(self, instance):",1,2,0.2222222222222222,381
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def destroy(self, context, instance, network_info, block_device_info=None,",1,2,0.2222222222222222,382
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def reboot(self, context, instance, network_info, reboot_type,",1,2,0.2222222222222222,383
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Create snapshot from a running VM instance.""""""",1,2,0.2222222222222222,384
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def snapshot(self, context, instance, image_id, update_task_state):",1,2,0.2222222222222222,385
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def spawn(self, context, instance, image_meta, injected_files,",1,2,0.2222222222222222,386
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# to not be None.,1,2,0.2222222222222222,387
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if vim is None:,1,2,0.2222222222222222,388
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""compute_driver=vmwareapi.VMwareESXDriver or """,1,2,0.2222222222222222,389
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _delete_vm_snapshot(self, instance, vm_ref, snapshot):",0,2,0.2222222222222222,390
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""ESX host local store %(data_store_name)s"") %",1,2,0.2222222222222222,391
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"description=""Taking Snapshot of the VM"",",0,2,0.2222222222222222,392
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _delete_datastore_file(self, instance, datastore_path, dc_ref):",0,2,0.2222222222222222,393
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"dcs = self._session._call_method(vim_util, ""get_objects"",",0,2,0.2222222222222222,394
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get the datacenter name and the reference.""""""",0,2,0.2222222222222222,395
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"dcs = self._session._call_method(vim_util,",0,2,0.2222222222222222,396
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if p.name == 'vmFolder':,0,2,0.2222222222222222,397
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if p.name == 'datastore':,0,2,0.2222222222222222,398
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if p.name == 'name':,0,2,0.2222222222222222,399
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"dc_obj = self._session._call_method(vim_util, ""get_objects"",",0,2,0.2222222222222222,400
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._datastore_dc_mapping = {},0,2,0.2222222222222222,401
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Deleted temporary vmdk file %s"")",1,2,0.2222222222222222,402
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Deleting temporary vmdk file %s"")",1,2,0.2222222222222222,403
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def detach_volume(self, connection_info, instance, mountpoint,",1,2,0.2222222222222222,404
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _extend_virtual_disk(self, instance, requested_size, name,",1,2,0.2222222222222222,405
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# deletion problems, so prioritize its deletion first. In the",0,2,0.2222222222222222,406
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _extend_virtual_disk(self, instance, requested_size, name, dc_ref):",0,2,0.2222222222222222,407
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _create_vm_snapshot(self, instance, vm_ref):",0,2,0.2222222222222222,408
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get the About Info from the service content.""""""",0,2,0.2222222222222222,409
7a60b5c406336c5f410d1a98868c3f93d888ea0c,property_dict = {},0,2,0.2222222222222222,410
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if retry_count > self.api_retry_count:,1,2,0.2222222222222222,411
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""got this exception: %s"") % excep)",1,2,0.2222222222222222,412
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"host_username, host_password,",1,2,0.2222222222222222,413
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if retry_count > self._api_retry_count:,0,2,0.2222222222222222,414
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._api_retry_count = retry_count,0,2,0.2222222222222222,415
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""and host_password to use """,0,2,0.2222222222222222,416
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"raise Exception(_(""Must specify host_ip, """,0,2,0.2222222222222222,417
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_ref = vm_util.get_vm_ref_from_name(self._session, instance_ref.name)",1,2,0.2222222222222222,418
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_ref = vm_util.get_vm_ref_from_name(self._session, instance_name)",1,2,0.2222222222222222,419
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_ref = vm_util.get_vm_ref_from_name(self._session,",1,2,0.2222222222222222,420
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_ref = vm_util.get_vm_ref_from_name(self._session, instance['name'])",1,2,0.2222222222222222,421
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"dc_obj = self._session._call_method(vim_util, ""get_objects"",",1,2,0.2222222222222222,422
7a60b5c406336c5f410d1a98868c3f93d888ea0c,except Exception as excep:,1,2,0.2222222222222222,423
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._session = session,0,2,0.2222222222222222,424
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.warning(_(""Unable to validate session %s!""),",0,2,0.2222222222222222,425
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Multiple processes/threads are trying to create """,0,2,0.2222222222222222,426
7a60b5c406336c5f410d1a98868c3f93d888ea0c,unit_number = unit_number + 1,1,2,0.2222222222222222,427
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Figure out the correct unit number,1,2,0.2222222222222222,428
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"hardware_devices = self._session._call_method(vim_util,",1,2,0.2222222222222222,429
7a60b5c406336c5f410d1a98868c3f93d888ea0c,1 if adapter_type in ['ide'] else 0),1,2,0.2222222222222222,430
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"hw_devices = self._session._call_method(vim_util,",0,2,0.2222222222222222,431
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"devices = self._session._call_method(vim_util,",0,2,0.2222222222222222,432
7a60b5c406336c5f410d1a98868c3f93d888ea0c,controller_key = -101,1,2,0.2222222222222222,433
7a60b5c406336c5f410d1a98868c3f93d888ea0c,controller_key = 200,1,2,0.2222222222222222,434
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# VM having keys 200 and 201,1,2,0.2222222222222222,435
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# For IDE devices, there are these two default controllers created in the",1,2,0.2222222222222222,436
7a60b5c406336c5f410d1a98868c3f93d888ea0c,controller_key = -101,0,2,0.2222222222222222,437
7a60b5c406336c5f410d1a98868c3f93d888ea0c,scsi_keys = [dev.key for dev in devices if _is_scsi_controller(dev)],0,2,0.2222222222222222,438
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"elif adapter_type in ['lsiLogic', 'lsiLogicsas', 'busLogic']:",0,2,0.2222222222222222,439
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ide_keys = [dev.key for dev in devices if _is_ide_controller(dev)],0,2,0.2222222222222222,440
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if devices.__class__.__name__ == ""ArrayOfVirtualDevice"":",0,2,0.2222222222222222,441
7a60b5c406336c5f410d1a98868c3f93d888ea0c,disk to adapter with the given adapter_type.,0,2,0.2222222222222222,442
7a60b5c406336c5f410d1a98868c3f93d888ea0c,controller_key and unit_number that can be used for attaching a new virtual,0,2,0.2222222222222222,443
7a60b5c406336c5f410d1a98868c3f93d888ea0c,This function inspects the current set of hardware devices and returns,0,2,0.2222222222222222,444
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# the SCSI controller sits on its own bus,0,2,0.2222222222222222,445
7a60b5c406336c5f410d1a98868c3f93d888ea0c,taken = {},0,2,0.2222222222222222,446
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return device.__class__.__name__ == 'VirtualIDEController',0,2,0.2222222222222222,447
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ret_val = done.wait(),1,2,0.2222222222222222,448
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ret_val = done.wait(),0,2,0.2222222222222222,449
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# to be empty.,1,2,0.2222222222222222,450
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# way to differentiate.,1,2,0.2222222222222222,451
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.warning(_(""Session %s is inactive!""),",0,2,0.2222222222222222,452
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Attach volume storage to VM instance.""""""",1,2,0.2222222222222222,453
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_adapters = [],1,2,0.2222222222222222,454
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Detach volume storage to VM instance.""""""",1,2,0.2222222222222222,455
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"base_url = self._get_base_url(scheme, host, port, file_path)",0,2,0.2222222222222222,456
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"% (scheme, host, port, urllib.pathname2url(file_path)))",0,2,0.2222222222222222,457
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"base_url = (""%s://[%s]:%s/folder/%s""",0,2,0.2222222222222222,458
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"base_url = self._get_base_url(scheme, host, file_path)",0,2,0.2222222222222222,459
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return base_url,0,2,0.2222222222222222,460
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"raise NotImplementedError(_(""Platform not implemented: '%s'"") % pltfrm)",1,2,0.2222222222222222,461
7a60b5c406336c5f410d1a98868c3f93d888ea0c,elif pltfrm == PLATFORM_LINUX:,1,2,0.2222222222222222,462
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if pltfrm == PLATFORM_WIN:,1,2,0.2222222222222222,463
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if __name__ == '__main__':,1,2,0.2222222222222222,464
7a60b5c406336c5f410d1a98868c3f93d888ea0c,elif (platform.dist()[0] == 'redhat'):,1,2,0.2222222222222222,465
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmware_tools_bin = '/usr/bin/vmware-guestd',1,2,0.2222222222222222,466
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmware_tools_bin = '/usr/sbin/vmware-guestd',1,2,0.2222222222222222,467
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmware_tools_bin = '/usr/bin/vmtoolsd',1,2,0.2222222222222222,468
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmware_tools_bin = '/usr/sbin/vmtoolsd',1,2,0.2222222222222222,469
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\niface %s inet static' % adapter_name),1,2,0.2222222222222222,470
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Touch file,1,2,0.2222222222222222,471
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Remove file,1,2,0.2222222222222222,472
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file_name = ('/etc/sysconfig/network-scripts/ifcfg-%s' %,1,2,0.2222222222222222,473
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_details = network_details or [],1,2,0.2222222222222222,474
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'name=""%s""' % adapter_name, dns_server]",1,2,0.2222222222222222,475
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Windows doesn't let you manually set the broadcast address,1,2,0.2222222222222222,476
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"adapter_name, current_ip_address = name_and_ip",1,2,0.2222222222222222,477
7a60b5c406336c5f410d1a98868c3f93d888ea0c,dns_servers) = network_detail,1,2,0.2222222222222222,478
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'VMware Tools', 'VMwareService.exe')",1,2,0.2222222222222222,479
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'VMware Tools', 'vmtoolsd.exe')",1,2,0.2222222222222222,480
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmware_tools_bin = None,1,2,0.2222222222222222,481
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if process_input is not None:,1,2,0.2222222222222222,482
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_adapters = _get_linux_network_adapters(),1,2,0.2222222222222222,483
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"base_url = (""%s://%s:%s/folder/%s""",0,2,0.2222222222222222,484
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"base_url = self._get_base_url(scheme, host, file_path)",1,2,0.2222222222222222,485
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_adapters = _get_windows_network_adapters(),1,2,0.2222222222222222,486
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""VMware file read handler class.""""""",0,2,0.2222222222222222,487
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_ref = vm_util.get_vm_ref_from_name(self._session, instance_name)",0,2,0.2222222222222222,488
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Calls a method within the module specified with",1,2,0.2222222222222222,489
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _call_method(self, module, method, *args, **kwargs):",1,2,0.2222222222222222,490
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"elif device.__class__.__name__ == ""ParaVirtualSCSIController"":",1,2,0.2222222222222222,491
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"elif device.__class__.__name__ == ""VirtualLsiLogicSASController"":",1,2,0.2222222222222222,492
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"elif device.__class__.__name__ == ""VirtualIDEController"":",1,2,0.2222222222222222,493
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"elif device.__class__.__name__ == ""VirtualBusLogicController"":",1,2,0.2222222222222222,494
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"elif device.__class__.__name__ == ""VirtualLsiLogicController"":",1,2,0.2222222222222222,495
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if hardware_devices.__class__.__name__ == ""ArrayOfVirtualDevice"":",1,2,0.2222222222222222,496
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"request = urllib2.Request(base_url, None, headers)",1,2,0.2222222222222222,497
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""VMware file read handler class.""""""",1,2,0.2222222222222222,498
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get the response and close the connection.""""""",1,2,0.2222222222222222,499
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Write to the file.""""""",1,2,0.2222222222222222,500
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"conn.putrequest(""PUT"", path + ""?"" + query)",1,2,0.2222222222222222,501
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"elif scheme == ""https"":",1,2,0.2222222222222222,502
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if scheme == ""http"":",1,2,0.2222222222222222,503
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"base_url = self._get_base_url(scheme, host, port, file_path)",1,2,0.2222222222222222,504
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""VMware file write handler class.""""""",1,2,0.2222222222222222,505
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"base_url = (""%s://%s:%s/folder/%s""",1,2,0.2222222222222222,506
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"% (scheme, host, port, urllib.pathname2url(file_path)))",1,2,0.2222222222222222,507
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"base_url = (""%s://[%s]:%s/folder/%s""",1,2,0.2222222222222222,508
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def write(self, data):",1,2,0.2222222222222222,509
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Close the file handle.""""""",1,2,0.2222222222222222,510
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return self.eof,1,2,0.2222222222222222,511
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.eof = False,1,2,0.2222222222222222,512
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def read(self, chunk_size):",1,2,0.2222222222222222,513
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Glance file read handler class.""""""",1,2,0.2222222222222222,514
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return _get_adapter_name_and_ip_address(network_adapters, mac_address)",1,2,0.2222222222222222,515
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ip_address = network_adapter['ip-address'],1,2,0.2222222222222222,516
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Updating host information,1,2,0.2222222222222222,517
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if image_meta is None:,0,2,0.2222222222222222,518
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return self.disk_type == constants.DISK_TYPE_SPARSE,0,2,0.2222222222222222,519
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if linked_clone is not None:,0,2,0.2222222222222222,520
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if (self.file_type is not None and,0,2,0.2222222222222222,521
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# NOTE(vui): This should be removed when we restore the,0,2,0.2222222222222222,522
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.adapter_type = adapter_type,0,2,0.2222222222222222,523
7a60b5c406336c5f410d1a98868c3f93d888ea0c,file_type (str): vmdk or iso,0,2,0.2222222222222222,524
7a60b5c406336c5f410d1a98868c3f93d888ea0c,file_size (int): size of file in bytes,0,2,0.2222222222222222,525
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# CONF.register_opts() after the import chain which imports this module. This,0,2,0.2222222222222222,526
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# possible to import it here, as nova.virt.vmwareapi.driver calls",0,2,0.2222222222222222,527
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# NOTE(mdbooth): We use use_linked_clone below, but don't have to import it",0,2,0.2222222222222222,528
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# In specific, vCenter does not actually run the VNC service",1,2,0.2222222222222222,529
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._resources = {},1,2,0.2222222222222222,530
7a60b5c406336c5f410d1a98868c3f93d888ea0c,""" vCenter %s"") % list(missing_clusters))",1,2,0.2222222222222222,531
7a60b5c406336c5f410d1a98868c3f93d888ea0c,""" found in the vCenter"")",1,2,0.2222222222222222,532
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"raise exception.NotFound(_(""All clusters specified %s were not""",1,2,0.2222222222222222,533
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# subtly alter how vSphere and OpenStack interoperate.,1,2,0.2222222222222222,534
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# hypervisor host machines and their guests. This fact can,1,2,0.2222222222222222,535
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# hosts in clusters or non-cluster logical-groupings.,1,2,0.2222222222222222,536
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def detach_interface(self, instance, vif):",1,2,0.2222222222222222,537
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Attach an interface to the instance.""""""",1,2,0.2222222222222222,538
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def attach_interface(self, instance, image_meta, vif):",1,2,0.2222222222222222,539
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def instance_exists(self, instance):",1,2,0.2222222222222222,540
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Manage the local cache of images.""""""",1,2,0.2222222222222222,541
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def inject_network_info(self, instance, nw_info):",1,2,0.2222222222222222,542
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Sets the specified host's ability to accept new instances.""""""",1,2,0.2222222222222222,543
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Reboots, shuts down or powers up the host.""""""",1,2,0.2222222222222222,544
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"If 'refresh' is True, run the update first.",1,2,0.2222222222222222,545
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return self.file_type == constants.DISK_FORMAT_ISO,0,2,0.2222222222222222,546
7a60b5c406336c5f410d1a98868c3f93d888ea0c,image_meta = {},0,2,0.2222222222222222,547
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_name = network_adapter['name'],1,2,0.2222222222222222,548
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# global property set in the configurations.,0,2,0.2222222222222222,549
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if network_adapter['mac-address'] == mac_address.lower():,1,2,0.2222222222222222,550
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ip_address = None,1,2,0.2222222222222222,551
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_name = None,1,2,0.2222222222222222,552
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get the adapter name based on the MAC address.""""""",1,2,0.2222222222222222,553
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _get_adapter_name_and_ip_address(network_adapters, mac_address):",1,2,0.2222222222222222,554
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"mac_address = "":"".join([raw_mac_address[m_counter:m_counter + 2]",1,2,0.2222222222222222,555
7a60b5c406336c5f410d1a98868c3f93d888ea0c,raw_mac_address = '%012x' % _bytes2int(fcntl.ioctl(,1,2,0.2222222222222222,556
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ip_address = socket.inet_ntoa(fcntl.ioctl(,1,2,0.2222222222222222,557
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"adapter_names = [names.tostring()[n_cnt:n_cnt + offset1].split('\0', 1)[0]",1,2,0.2222222222222222,558
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"raise OSError(_(""Unknown architecture: %s"") % arch)",1,2,0.2222222222222222,559
7a60b5c406336c5f410d1a98868c3f93d888ea0c,elif arch == ARCH_64_BIT:,1,2,0.2222222222222222,560
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if arch == ARCH_32_BIT:,1,2,0.2222222222222222,561
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get the list of Linux network adapters.""""""",1,2,0.2222222222222222,562
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return network_adapters,1,2,0.2222222222222222,563
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ip_address = config.IPAddress[0],1,2,0.2222222222222222,564
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ip_address = '',1,2,0.2222222222222222,565
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_name = adapter.NetConnectionID,1,2,0.2222222222222222,566
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get the list of windows network adapters.""""""",1,2,0.2222222222222222,567
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if len(network_info_list) % 6 != 0:,1,2,0.2222222222222222,568
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if machine_id[1].strip() == ""1"":",1,2,0.2222222222222222,569
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"Parse the machine_id to get MAC, IP, Netmask and Gateway fields per NIC.",1,2,0.2222222222222222,570
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return intgr,1,2,0.2222222222222222,571
7a60b5c406336c5f410d1a98868c3f93d888ea0c,intgr = 0,1,2,0.2222222222222222,572
7a60b5c406336c5f410d1a98868c3f93d888ea0c,elif sys.platform == PLATFORM_LINUX:,1,2,0.2222222222222222,573
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if sys.platform == PLATFORM_WIN:,1,2,0.2222222222222222,574
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"meta_data = IMAGE_API.get(context, image)",1,2,0.2222222222222222,575
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def get_vmdk_size_and_properties(context, image, instance):",1,2,0.2222222222222222,576
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_ref = vm_util.get_vm_ref(self._session, instance_ref)",0,2,0.2222222222222222,577
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def get_volume_connector(self, instance):",1,2,0.2222222222222222,578
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_ref = vm_util.get_vm_ref_from_uuid(self._session, instance['uuid'])",0,2,0.2222222222222222,579
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'name=""%s""' % adapter_name, dns_server]",0,2,0.2222222222222222,580
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if pltfrm == PLATFORM_WIN:,0,2,0.2222222222222222,581
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if __name__ == '__main__':,0,2,0.2222222222222222,582
7a60b5c406336c5f410d1a98868c3f93d888ea0c,elif (platform.dist()[0] == 'redhat'):,0,2,0.2222222222222222,583
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmware_tools_bin = '/usr/bin/vmware-guestd',0,2,0.2222222222222222,584
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmware_tools_bin = '/usr/sbin/vmware-guestd',0,2,0.2222222222222222,585
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmware_tools_bin = '/usr/bin/vmtoolsd',0,2,0.2222222222222222,586
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmware_tools_bin = '/usr/sbin/vmtoolsd',0,2,0.2222222222222222,587
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\niface %s inet static' % adapter_name),0,2,0.2222222222222222,588
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Touch file,0,2,0.2222222222222222,589
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Remove file,0,2,0.2222222222222222,590
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'/etc/sysconfig/network-scripts/ifcfg-%s' % adapter_name,0,2,0.2222222222222222,591
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file_name = \,0,2,0.2222222222222222,592
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_details = network_details or [],0,2,0.2222222222222222,593
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Windows doesn't let you manually set the broadcast address,0,2,0.2222222222222222,594
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get the adapter name based on the MAC address.""""""",0,2,0.2222222222222222,595
7a60b5c406336c5f410d1a98868c3f93d888ea0c,dns_servers = network_detail,0,2,0.2222222222222222,596
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"mac_address, ip_address, subnet_mask, gateway, broadcast,\",0,2,0.2222222222222222,597
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'VMware Tools', 'VMwareService.exe')",0,2,0.2222222222222222,598
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'VMware Tools', 'vmtoolsd.exe')",0,2,0.2222222222222222,599
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmware_tools_bin = None,0,2,0.2222222222222222,600
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if process_input is not None:,0,2,0.2222222222222222,601
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_adapters = _get_linux_network_adapters(),0,2,0.2222222222222222,602
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return _get_adapter_name_and_ip_address(network_adapters, mac_address)",0,2,0.2222222222222222,603
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_adapters = _get_windows_network_adapters(),0,2,0.2222222222222222,604
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ip_address = network_adapter['ip-address'],0,2,0.2222222222222222,605
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_name = network_adapter['name'],0,2,0.2222222222222222,606
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if network_adapter['mac-address'] == mac_address.lower():,0,2,0.2222222222222222,607
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ip_address = None,0,2,0.2222222222222222,608
7a60b5c406336c5f410d1a98868c3f93d888ea0c,elif pltfrm == PLATFORM_LINUX:,0,2,0.2222222222222222,609
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"raise NotImplementedError(_(""Platform not implemented: '%s'"") % pltfrm)",0,2,0.2222222222222222,610
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# vim: tabstop=4 shiftwidth=4 softtabstop=4,1,2,0.2222222222222222,611
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if sys.platform == PLATFORM_WIN:,1,2,0.2222222222222222,612
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_name = network_adapter['name'],1,2,0.2222222222222222,613
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if network_adapter['mac-address'] == mac_address.lower():,1,2,0.2222222222222222,614
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ip_address = None,1,2,0.2222222222222222,615
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_name = None,1,2,0.2222222222222222,616
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get the adapter name based on the MAC address.""""""",1,2,0.2222222222222222,617
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _get_adapter_name_and_ip_address(network_adapters, mac_address):",1,2,0.2222222222222222,618
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"mac_address = "":"".join([raw_mac_address[m_counter:m_counter + 2]",1,2,0.2222222222222222,619
7a60b5c406336c5f410d1a98868c3f93d888ea0c,raw_mac_address = '%012x' % _bytes2int(fcntl.ioctl(,1,2,0.2222222222222222,620
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ip_address = socket.inet_ntoa(fcntl.ioctl(,1,2,0.2222222222222222,621
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_names = \,1,2,0.2222222222222222,622
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"raise OSError(_(""Unknown architecture: %s"") % arch)",1,2,0.2222222222222222,623
7a60b5c406336c5f410d1a98868c3f93d888ea0c,elif arch == ARCH_64_BIT:,1,2,0.2222222222222222,624
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if arch == ARCH_32_BIT:,1,2,0.2222222222222222,625
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get the list of Linux network adapters.""""""",1,2,0.2222222222222222,626
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return network_adapters,1,2,0.2222222222222222,627
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ip_address = wbem_network_adapter_config.IPAddress[0],1,2,0.2222222222222222,628
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ip_address = '',1,2,0.2222222222222222,629
7a60b5c406336c5f410d1a98868c3f93d888ea0c,wbem_network_adapter_config = \,1,2,0.2222222222222222,630
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_name = wbem_network_adapter.NetConnectionID,1,2,0.2222222222222222,631
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_adapters = [],1,2,0.2222222222222222,632
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get the list of windows network adapters.""""""",1,2,0.2222222222222222,633
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if len(network_info_list) % 6 != 0:,1,2,0.2222222222222222,634
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if machine_id[1].strip() == ""1"":",1,2,0.2222222222222222,635
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"Parse the machine_id to get MAC, IP, Netmask and Gateway fields per NIC.",1,2,0.2222222222222222,636
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return intgr,1,2,0.2222222222222222,637
7a60b5c406336c5f410d1a98868c3f93d888ea0c,intgr = 0,1,2,0.2222222222222222,638
7a60b5c406336c5f410d1a98868c3f93d888ea0c,elif sys.platform == PLATFORM_LINUX:,1,2,0.2222222222222222,639
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_name = None,0,2,0.2222222222222222,640
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _get_adapter_name_and_ip_address(network_adapters, mac_address):",0,2,0.2222222222222222,641
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_adapters = _get_windows_network_adapters(),1,2,0.2222222222222222,642
7a60b5c406336c5f410d1a98868c3f93d888ea0c,backing_name = \,1,2,0.2222222222222222,643
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_ref = \,1,2,0.2222222222222222,644
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"image_size, image_properties = \",1,2,0.2222222222222222,645
7a60b5c406336c5f410d1a98868c3f93d888ea0c,help='The VMWare VIF driver to configure the VIFs.'),1,2,0.2222222222222222,646
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmware_vif_driver_opt = \,1,2,0.2222222222222222,647
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"path = ""/console?ref=%s&session_id=%s"" % (str(vm_ref), session_id)",0,2,0.2222222222222222,648
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""%(old_gb)dGB to %(new_gb)dGB"") % locals())",0,2,0.2222222222222222,649
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vmdk_file_path_before_snapshot, adapter_type = _vmdk_info",0,2,0.2222222222222222,650
7a60b5c406336c5f410d1a98868c3f93d888ea0c,help='The VMWare VIF driver to configure the VIFs.'),0,2,0.2222222222222222,651
7a60b5c406336c5f410d1a98868c3f93d888ea0c,virtual_machine_config_spec = \,1,2,0.2222222222222222,652
7a60b5c406336c5f410d1a98868c3f93d888ea0c,disk_file_backing = \,1,2,0.2222222222222222,653
7a60b5c406336c5f410d1a98868c3f93d888ea0c,create_vmdk_spec = \,1,2,0.2222222222222222,654
7a60b5c406336c5f410d1a98868c3f93d888ea0c,portgroup = \,1,2,0.2222222222222222,655
7a60b5c406336c5f410d1a98868c3f93d888ea0c,backing = \,1,2,0.2222222222222222,656
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_spec = \,1,2,0.2222222222222222,657
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"mac_address = "":"".join([raw_mac_address[m_counter:m_counter + 2]",0,2,0.2222222222222222,658
7a60b5c406336c5f410d1a98868c3f93d888ea0c,virtual_lsi = \,1,2,0.2222222222222222,659
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if (device.__class__.__name__ == ""VirtualDisk"" and",0,2,0.2222222222222222,660
7a60b5c406336c5f410d1a98868c3f93d888ea0c,connectable_spec = client_factory.create('ns0:VirtualDeviceConnectInfo'),0,2,0.2222222222222222,661
7a60b5c406336c5f410d1a98868c3f93d888ea0c,virtual_device_config = client_factory.create(,0,2,0.2222222222222222,662
7a60b5c406336c5f410d1a98868c3f93d888ea0c,prop_filter_spec = \,1,2,0.2222222222222222,663
7a60b5c406336c5f410d1a98868c3f93d888ea0c,obj_content = \,1,2,0.2222222222222222,664
7a60b5c406336c5f410d1a98868c3f93d888ea0c,request_mo = \,1,2,0.2222222222222222,665
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._service_content = \,1,2,0.2222222222222222,666
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmwareapi_wsdl_loc_opt = \,1,2,0.2222222222222222,667
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if type(managed_object) == type(""""):",1,2,0.2222222222222222,668
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"RESP_NOT_XML_ERROR = 'Response is ""text/html"", not ""text/xml'",1,2,0.2222222222222222,669
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"RESP_NOT_XML_ERROR = 'Response is ""text/html"", not ""text/xml""'",0,2,0.2222222222222222,670
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if rescue_vm_ref is None:,0,2,0.2222222222222222,671
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"datastore_name, vmx_file_path = \",1,2,0.2222222222222222,672
7a60b5c406336c5f410d1a98868c3f93d888ea0c,machine_id_change_spec = \,1,2,0.2222222222222222,673
7a60b5c406336c5f410d1a98868c3f93d888ea0c,LOG.info(_('Latest agent build for %(hypervisor)s/%(os)s' + \,1,2,0.2222222222222222,674
7a60b5c406336c5f410d1a98868c3f93d888ea0c,LOG.info(_('No agent build found for %(hypervisor)s/%(os)s' + \,1,2,0.2222222222222222,675
7a60b5c406336c5f410d1a98868c3f93d888ea0c,raw_mac_address = '%012x' % _bytes2int(fcntl.ioctl(,0,2,0.2222222222222222,676
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ip_address = socket.inet_ntoa(fcntl.ioctl(,0,2,0.2222222222222222,677
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_names = \,0,2,0.2222222222222222,678
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"raise OSError(_(""Unknown architecture: %s"") % arch)",0,2,0.2222222222222222,679
7a60b5c406336c5f410d1a98868c3f93d888ea0c,elif arch == ARCH_64_BIT:,0,2,0.2222222222222222,680
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get the list of Linux network adapters.""""""",0,2,0.2222222222222222,681
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return network_adapters,0,2,0.2222222222222222,682
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ip_address = wbem_network_adapter_config.IPAddress[0],0,2,0.2222222222222222,683
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ip_address = '',0,2,0.2222222222222222,684
7a60b5c406336c5f410d1a98868c3f93d888ea0c,wbem_network_adapter_config = \,0,2,0.2222222222222222,685
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_name = wbem_network_adapter.NetConnectionID,0,2,0.2222222222222222,686
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_adapters = [],0,2,0.2222222222222222,687
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get the list of windows network adapters.""""""",0,2,0.2222222222222222,688
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if len(network_info_list) % 6 != 0:,0,2,0.2222222222222222,689
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if machine_id[1].strip() == ""1"":",0,2,0.2222222222222222,690
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"Parse the machine_id to get MAC, IP, Netmask and Gateway fields per NIC.",0,2,0.2222222222222222,691
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return intgr,0,2,0.2222222222222222,692
7a60b5c406336c5f410d1a98868c3f93d888ea0c,intgr = 0,0,2,0.2222222222222222,693
7a60b5c406336c5f410d1a98868c3f93d888ea0c,elif sys.platform == PLATFORM_LINUX:,0,2,0.2222222222222222,694
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if sys.platform == PLATFORM_WIN:,0,2,0.2222222222222222,695
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# vim: tabstop=4 shiftwidth=4 softtabstop=4,0,2,0.2222222222222222,696
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_('Creating VIF for VM %(vm_ref)s,' \",1,2,0.2222222222222222,697
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""%(old_gb)dGB to %(new_gb)dGB"") % locals())",1,2,0.2222222222222222,698
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if instance['auto_disk_config'] and \,1,2,0.2222222222222222,699
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vdi_ref, vm_vdi_rec = \",1,2,0.2222222222222222,700
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"template_vm_ref, template_vdi_uuids = \",1,2,0.2222222222222222,701
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if version and agent_build and \,1,2,0.2222222222222222,702
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ip_address = network_adapter['ip-address'],1,2,0.2222222222222222,703
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if arch == ARCH_32_BIT:,0,2,0.2222222222222222,704
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return _get_adapter_name_and_ip_address(network_adapters, mac_address)",1,2,0.2222222222222222,705
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if host_ref is None:,0,2,0.2222222222222222,706
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def get_vnc_console(self, instance):",0,2,0.2222222222222222,707
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_ref = vm_util.get_vm_ref_from_name(self._session, instance_ref.name)",0,2,0.2222222222222222,708
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# 4. Start VM,0,2,0.2222222222222222,709
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Completes a resize, turning on the migrated instance.""""""",0,2,0.2222222222222222,710
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def finish_migration(self, context, migration, instance, disk_info,",0,2,0.2222222222222222,711
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_ref = vm_util.get_vm_ref_from_name(self._session, name_label)",0,2,0.2222222222222222,712
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Finish reverting a resize, powering back on the instance.""""""",0,2,0.2222222222222222,713
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def finish_revert_migration(self, instance):",0,2,0.2222222222222222,714
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""exception while destroying the VM: %s"") % str(excep))",0,2,0.2222222222222222,715
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_ref = vm_util.get_vm_ref_from_name(self._session, instance_name)",0,2,0.2222222222222222,716
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Destroy the original VM.,0,2,0.2222222222222222,717
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Confirms a resize, destroying the source VM.""""""",0,2,0.2222222222222222,718
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def confirm_migration(self, migration, instance, network_info):",0,2,0.2222222222222222,719
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def migrate_disk_and_power_off(self, context, instance, dest,",0,2,0.2222222222222222,720
7a60b5c406336c5f410d1a98868c3f93d888ea0c,- spawn a rescue VM (the vm name-label will be instance-N-rescue).,0,2,0.2222222222222222,721
7a60b5c406336c5f410d1a98868c3f93d888ea0c,""" %(progress)d"") % locals(), instance=instance)",0,2,0.2222222222222222,722
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# instance's progress field as each step is completed.,0,2,0.2222222222222222,723
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Update instance progress percent to reflect current step number",0,2,0.2222222222222222,724
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _update_instance_progress(self, context, instance, step, total_steps):",0,2,0.2222222222222222,725
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return instance['name'] + '-orig',0,2,0.2222222222222222,726
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _get_orig_vm_name_label(self, instance):",0,2,0.2222222222222222,727
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def power_on(self, instance):",0,2,0.2222222222222222,728
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"reason = _(""instance is suspended and cannot be powered off."")",0,2,0.2222222222222222,729
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def power_off(self, instance):",0,2,0.2222222222222222,730
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def unrescue(self, instance):",0,2,0.2222222222222222,731
7a60b5c406336c5f410d1a98868c3f93d888ea0c,unit_number = unit_number + 1,0,2,0.2222222222222222,732
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Figure out the correct unit number,0,2,0.2222222222222222,733
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"hardware_devices = self._session._call_method(vim_util,",0,2,0.2222222222222222,734
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _set_vnc_config(self, client_factory, instance, port, password):",0,2,0.2222222222222222,735
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"reconfig_task = self._session._call_method(self._session._get_vim(),",0,2,0.2222222222222222,736
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if vm.propSet[0].val == vm_name:,1,2,0.2222222222222222,737
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if host.propSet[0].val == host_name:,0,2,0.2222222222222222,738
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_ref = vm_util.get_vm_ref(self._session, instance)",0,2,0.2222222222222222,739
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_adapters = _get_linux_network_adapters(),1,2,0.2222222222222222,740
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vms = self._session._call_method(vim_util, ""get_objects"",",1,2,0.2222222222222222,741
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vm_ref = self._get_vm_ref_from_the_name(instance['name']),1,2,0.2222222222222222,742
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"reason = _(""instance is powered off and can not be suspended."")",1,2,0.2222222222222222,743
7a60b5c406336c5f410d1a98868c3f93d888ea0c,""" %(data_store_name)s"") %",1,2,0.2222222222222222,744
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"flat_uploaded_vmdk_name = ""%s/%s-flat.vmdk"" % (instance.name,",1,2,0.2222222222222222,745
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"res_pool_mor = self._session._call_method(vim_util, ""get_objects"",",1,2,0.2222222222222222,746
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"dc_objs = self._session._call_method(vim_util, ""get_objects"",",1,2,0.2222222222222222,747
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get the Vm folder ref from the datacenter.""""""",1,2,0.2222222222222222,748
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vmdk_file_size_in_kb, os_type, adapter_type = _get_image_properties()",1,2,0.2222222222222222,749
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return vmdk_file_size_in_kb, os_type, adapter_type",1,2,0.2222222222222222,750
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"msg = _(""Couldn't get a local Datastore reference"")",1,2,0.2222222222222222,751
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if data_store_name is None:,1,2,0.2222222222222222,752
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if ds_type == ""VMFS"":",1,2,0.2222222222222222,753
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"elif prop.name == ""summary.name"":",1,2,0.2222222222222222,754
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if prop.name == ""summary.type"":",1,2,0.2222222222222222,755
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"data_stores = self._session._call_method(vim_util, ""get_objects"",",1,2,0.2222222222222222,756
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get the datastore list and choose the first local storage.""""""",1,2,0.2222222222222222,757
7a60b5c406336c5f410d1a98868c3f93d888ea0c,4. Upload the disk file.,1,2,0.2222222222222222,758
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def spawn(self, context, instance, image_meta, network_info):",1,2,0.2222222222222222,759
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if task_info.state == ""error"":",0,2,0.2222222222222222,760
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"task_info = self._session._call_method(vim_util,",0,2,0.2222222222222222,761
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"search_task = self._session._call_method(self._session._get_vim(),",0,2,0.2222222222222222,762
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"res_pool_ref = self._session._call_method(vim_util, ""get_objects"",",0,2,0.2222222222222222,763
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"dc_objs = self._session._call_method(vim_util, ""get_objects"",",0,2,0.2222222222222222,764
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get the Vm folder ref from the datacenter.""""""",0,2,0.2222222222222222,765
7a60b5c406336c5f410d1a98868c3f93d888ea0c,instance['name'] = instance['name'] + self._rescue_suffix,0,2,0.2222222222222222,766
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"host_objs = self._session._call_method(vim_util, ""get_objects"",",0,2,0.2222222222222222,767
7a60b5c406336c5f410d1a98868c3f93d888ea0c,- shutdown the instance VM.,0,2,0.2222222222222222,768
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file_name = ('/etc/sysconfig/network-scripts/ifcfg-%s' %,0,2,0.2222222222222222,769
7a60b5c406336c5f410d1a98868c3f93d888ea0c,dns_servers) = network_detail,0,2,0.2222222222222222,770
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"adapter_names = [names.tostring()[n_cnt:n_cnt + offset1].split('\0', 1)[0]",0,2,0.2222222222222222,771
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ip_address = config.IPAddress[0],0,2,0.2222222222222222,772
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_name = adapter.NetConnectionID,0,2,0.2222222222222222,773
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"raise NotImplementedError(_(""Platform not implemented: '%s'"") % pltfrm)",1,2,0.2222222222222222,774
7a60b5c406336c5f410d1a98868c3f93d888ea0c,elif pltfrm == PLATFORM_LINUX:,1,2,0.2222222222222222,775
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if pltfrm == PLATFORM_WIN:,1,2,0.2222222222222222,776
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if __name__ == '__main__':,1,2,0.2222222222222222,777
7a60b5c406336c5f410d1a98868c3f93d888ea0c,elif (platform.dist()[0] == 'redhat'):,1,2,0.2222222222222222,778
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmware_tools_bin = '/usr/bin/vmware-guestd',1,2,0.2222222222222222,779
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmware_tools_bin = '/usr/sbin/vmware-guestd',1,2,0.2222222222222222,780
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmware_tools_bin = '/usr/bin/vmtoolsd',1,2,0.2222222222222222,781
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmware_tools_bin = '/usr/sbin/vmtoolsd',1,2,0.2222222222222222,782
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Touch file,1,2,0.2222222222222222,783
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Remove file,1,2,0.2222222222222222,784
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'/etc/sysconfig/network-scripts/ifcfg-%s' % adapter_name,1,2,0.2222222222222222,785
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file_name = \,1,2,0.2222222222222222,786
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_details = network_details or [],1,2,0.2222222222222222,787
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'name=""%s""' % adapter_name, dns_server]",1,2,0.2222222222222222,788
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Windows doesn't let you manually set the broadcast address,1,2,0.2222222222222222,789
7a60b5c406336c5f410d1a98868c3f93d888ea0c,dns_servers = network_detail,1,2,0.2222222222222222,790
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"mac_address, ip_address, subnet_mask, gateway, broadcast,\",1,2,0.2222222222222222,791
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'VMware Tools', 'VMwareService.exe')",1,2,0.2222222222222222,792
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'VMware Tools', 'vmtoolsd.exe')",1,2,0.2222222222222222,793
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmware_tools_bin = None,1,2,0.2222222222222222,794
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def rescue(self, context, instance, network_info, image_meta):",0,2,0.2222222222222222,795
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if process_input is not None:,1,2,0.2222222222222222,796
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"adapter_name, current_ip_address = name_and_ip",0,2,0.2222222222222222,797
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\niface %s inet static' % adapter_name),1,2,0.2222222222222222,798
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_name = wbem_network_adapter.NetConnectionID,1,2,0.2222222222222222,799
7a60b5c406336c5f410d1a98868c3f93d888ea0c,upload_vmdk_name = sparse_uploaded_vmdk_name \,0,2,0.2222222222222222,800
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"reason = _(""instance is powered off and cannot be suspended."")",0,2,0.2222222222222222,801
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_ref = vm_util.get_vm_ref_from_name(self._session,",0,2,0.2222222222222222,802
7a60b5c406336c5f410d1a98868c3f93d888ea0c,wbem_network_adapter_config = \,1,2,0.2222222222222222,803
7a60b5c406336c5f410d1a98868c3f93d888ea0c,Destroy a VM instance. Steps followed are:,0,2,0.2222222222222222,804
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _delete(self, instance, network_info):",0,2,0.2222222222222222,805
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if disk_type == ""sparse"":",0,2,0.2222222222222222,806
7a60b5c406336c5f410d1a98868c3f93d888ea0c,cookies = \,0,2,0.2222222222222222,807
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"flat_uploaded_vmdk_name = ""%s/%s-flat.vmdk"" % (",0,2,0.2222222222222222,808
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"uploaded_vmdk_name = ""%s/%s.vmdk"" % (upload_folder, upload_name)",0,2,0.2222222222222222,809
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""%(data_store_name)s to disk type %(disk_type)s"") %",0,2,0.2222222222222222,810
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Copying Virtual Disk of size """,0,2,0.2222222222222222,811
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if disk_type == ""sparse"" else flat_uploaded_vmdk_name",0,2,0.2222222222222222,812
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"sparse_uploaded_vmdk_name = ""%s/%s-sparse.vmdk"" % (",0,2,0.2222222222222222,813
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vnc_pass = CONF.vnc_password or '',0,2,0.2222222222222222,814
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if network_info is None:,0,2,0.2222222222222222,815
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_ref = vm_util.get_vm_ref_from_name(self._session, instance['name'])",0,2,0.2222222222222222,816
7a60b5c406336c5f410d1a98868c3f93d888ea0c,2.3. Upload the disk file.,0,2,0.2222222222222222,817
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def spawn(self, context, instance, image_meta, network_info,",0,2,0.2222222222222222,818
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_names = \,1,2,0.2222222222222222,819
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._instance_path_base = VMWARE_PREFIX + CONF.base_dir_name,0,2,0.2222222222222222,820
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'/etc/sysconfig/network-scripts/ifcfg-%s' % adapter_name,1,2,0.2222222222222222,821
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ip_address = wbem_network_adapter_config.IPAddress[0],1,2,0.2222222222222222,822
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file_name = \,1,2,0.2222222222222222,823
7a60b5c406336c5f410d1a98868c3f93d888ea0c,dns_servers = network_detail,1,2,0.2222222222222222,824
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"mac_address, ip_address, subnet_mask, gateway, broadcast,\",1,2,0.2222222222222222,825
7a60b5c406336c5f410d1a98868c3f93d888ea0c,""" KB and type %(disk_type)s on """,0,2,0.2222222222222222,826
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def __init__(self, virtapi, read_only=False, scheme=""https""):",0,1,0.1111111111111111,827
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""vCenter %s"") % list(missing_clusters))",0,1,0.1111111111111111,828
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._resource_keys = set(),0,1,0.1111111111111111,829
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# objects per cluster,0,1,0.1111111111111111,830
7a60b5c406336c5f410d1a98868c3f93d888ea0c,missing_clusters = set(self._cluster_names) - set(clusters_found),0,1,0.1111111111111111,831
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._virtapi = virtapi,0,1,0.1111111111111111,832
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if missing_clusters:,0,1,0.1111111111111111,833
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._cluster_names = CONF.vmware.cluster_name,0,1,0.1111111111111111,834
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"clusters_found = [v.get('name') for k, v in self.dict_mors.iteritems()]",0,1,0.1111111111111111,835
7a60b5c406336c5f410d1a98868c3f93d888ea0c,% self._cluster_names),0,1,0.1111111111111111,836
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if not self.dict_mors:,0,1,0.1111111111111111,837
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self.dict_mors = vm_util.get_all_cluster_refs_by_name(self._session,",0,1,0.1111111111111111,838
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#,0,1,0.1111111111111111,839
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""The VC host connection object.""""""",0,1,0.1111111111111111,840
7a60b5c406336c5f410d1a98868c3f93d888ea0c,first_cluster = self._resources.keys()[0],0,1,0.1111111111111111,841
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# not use VC state.,0,1,0.1111111111111111,842
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# valid vCenter calls. There are some small edge-case,1,1,0.1111111111111111,843
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._vmops = self._resources.get(first_cluster).get('vmops'),0,1,0.1111111111111111,844
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'compute_driver is vmwareapi.VMwareVCDriver.'),",1,1,0.1111111111111111,845
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'removed in the Juno release. The VC driver will remain ',0,1,0.1111111111111111,846
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'and continue to be supported.')),1,1,0.1111111111111111,847
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'removed in the Juno release. The VC driver will remain ',1,1,0.1111111111111111,848
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _do_deprecation_warning(self):,1,1,0.1111111111111111,849
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# exceptions regarding VNC, CIM, User management & SSO.",1,1,0.1111111111111111,850
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# VMwareAPI has both ESXi and vCenter API sets.,1,1,0.1111111111111111,851
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"help='Password for connection to VMware ESX/VC host.',",1,1,0.1111111111111111,852
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._volumeops = self._resources.get(first_cluster).get('volumeops'),0,1,0.1111111111111111,853
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"help='Username for connection to VMware ESX/VC host.'),",1,1,0.1111111111111111,854
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"help='Port for connection to VMware ESX/VC host.'),",1,1,0.1111111111111111,855
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return {'vcpus': host_stats['vcpus'],",0,1,0.1111111111111111,856
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _get_available_resources(self, host_stats):",0,1,0.1111111111111111,857
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.warn(_LW('Instance cannot be found in host, or in an unknown'",0,1,0.1111111111111111,858
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._vc_state = self._resources.get(first_cluster).get('vcstate'),0,1,0.1111111111111111,859
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'and continue to be supported.')),0,1,0.1111111111111111,860
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"properties = ['name', 'runtime.connectionState']",0,1,0.1111111111111111,861
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _do_deprecation_warning(self):,0,1,0.1111111111111111,862
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vms = [],0,1,0.1111111111111111,863
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vm_name = None,1,1,0.1111111111111111,864
7a60b5c406336c5f410d1a98868c3f93d888ea0c,token = vm_util._get_token(vms),1,1,0.1111111111111111,865
7a60b5c406336c5f410d1a98868c3f93d888ea0c,lst_vm_names = [],1,1,0.1111111111111111,866
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vms = self._session._call_method(,0,1,0.1111111111111111,867
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if root_res_pool:,0,1,0.1111111111111111,868
7a60b5c406336c5f410d1a98868c3f93d888ea0c,root_res_pool = self._session._call_method(,0,1,0.1111111111111111,869
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Getting list of instances from cluster %s""),",0,1,0.1111111111111111,870
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# deprecation warning.,0,1,0.1111111111111111,871
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def list_instances(self):,0,1,0.1111111111111111,872
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return lst_vm_names,0,1,0.1111111111111111,873
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if token:,0,1,0.1111111111111111,874
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if conn_state not in [""orphaned"", ""inaccessible""]:",0,1,0.1111111111111111,875
7a60b5c406336c5f410d1a98868c3f93d888ea0c,conn_state = prop.val,0,1,0.1111111111111111,876
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vm_name = prop.val,0,1,0.1111111111111111,877
7a60b5c406336c5f410d1a98868c3f93d888ea0c,conn_state = None,1,1,0.1111111111111111,878
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vm_name = prop.val,1,1,0.1111111111111111,879
7a60b5c406336c5f410d1a98868c3f93d888ea0c,conn_state = prop.val,1,1,0.1111111111111111,880
7a60b5c406336c5f410d1a98868c3f93d888ea0c,conn_state = None,0,1,0.1111111111111111,881
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if conn_state not in [""orphaned"", ""inaccessible""]:",1,1,0.1111111111111111,882
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if token:,1,1,0.1111111111111111,883
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self.wsdl_url = Vim.get_wsdl_url(protocol, host, port)",0,1,0.1111111111111111,884
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self.url = Vim.get_soap_url(protocol, host, port)",0,1,0.1111111111111111,885
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def get_wsdl_url(protocol, host_name, port):",0,1,0.1111111111111111,886
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def get_soap_url(protocol, host_name, port):",0,1,0.1111111111111111,887
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self.wsdl_url = Vim.get_wsdl_url(protocol, host)",1,1,0.1111111111111111,888
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self.url = Vim.get_soap_url(protocol, host)",1,1,0.1111111111111111,889
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def get_wsdl_url(protocol, host_name):",1,1,0.1111111111111111,890
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def get_soap_url(protocol, host_name):",1,1,0.1111111111111111,891
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"help='Port for connection to VMware VC host.'),",0,1,0.1111111111111111,892
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"help='Username for connection to VMware VC host.'),",0,1,0.1111111111111111,893
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"help='Password for connection to VMware VC host.',",0,1,0.1111111111111111,894
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._host_ip = CONF.vmware.host_ip,1,1,0.1111111111111111,895
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def host_maintenance_mode(self, host, mode):",1,1,0.1111111111111111,896
7a60b5c406336c5f410d1a98868c3f93d888ea0c,CONF.vmware.host_password is None):,1,1,0.1111111111111111,897
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""host_username """,1,1,0.1111111111111111,898
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""",1,1,0.1111111111111111,899
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"This method is called when nova-compute launches, and",1,1,0.1111111111111111,900
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def get_available_resource(self, nodename):",1,1,0.1111111111111111,901
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return {'vcpus': host_stats['vcpus'],",1,1,0.1111111111111111,902
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _get_available_resources(self, host_stats):",1,1,0.1111111111111111,903
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return {'address': CONF.vmware.host_ip,",1,1,0.1111111111111111,904
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def get_console_pool_info(self, console_type):",1,1,0.1111111111111111,905
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return self._volumeops.detach_volume(connection_info,",1,1,0.1111111111111111,906
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"instance,",1,1,0.1111111111111111,907
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return self._volumeops.attach_volume(connection_info,",1,1,0.1111111111111111,908
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return self._host_ip,1,1,0.1111111111111111,909
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def get_host_ip_addr(self):,1,1,0.1111111111111111,910
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return self._volumeops.get_volume_connector(instance),1,1,0.1111111111111111,911
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return self._vmops.get_vnc_console(instance),1,1,0.1111111111111111,912
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Return link to instance's VNC console.""""""",1,1,0.1111111111111111,913
7a60b5c406336c5f410d1a98868c3f93d888ea0c,host_stats = self.get_host_stats(refresh=True),1,1,0.1111111111111111,914
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return self._get_available_resources(host_stats),1,1,0.1111111111111111,915
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def get_host_stats(self, refresh=False):",1,1,0.1111111111111111,916
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def manage_image_cache(self, context, all_instances):",1,1,0.1111111111111111,917
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# The vCenter driver includes several additional VMware vSphere,1,1,0.1111111111111111,918
7a60b5c406336c5f410d1a98868c3f93d888ea0c,token = vm_util._get_token(retrieve_result),0,1,0.1111111111111111,919
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""The VC host connection object.""""""",1,1,0.1111111111111111,920
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Detach an interface from the instance.""""""",1,1,0.1111111111111111,921
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return self._vmops.instance_exists(instance),1,1,0.1111111111111111,922
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Efficient override of base instance_exists method.""""""",1,1,0.1111111111111111,923
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def get_host_uptime(self, host):",1,1,0.1111111111111111,924
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return self.host_state.get_host_stats(refresh=refresh),1,1,0.1111111111111111,925
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return self._host.set_host_enabled(host, enabled)",1,1,0.1111111111111111,926
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def set_host_enabled(self, host, enabled):",1,1,0.1111111111111111,927
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return self._host.host_maintenance_mode(host, mode)",1,1,0.1111111111111111,928
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Start/Stop host maintenance window. On start, it triggers",1,1,0.1111111111111111,929
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return self._host.host_power_action(host, action)",1,1,0.1111111111111111,930
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def host_power_action(self, host, action):",1,1,0.1111111111111111,931
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return self._vmops.get_info(instance),1,1,0.1111111111111111,932
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def poll_rebooting_instances(self, timeout, instances):",1,1,0.1111111111111111,933
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.warn(_('Instance cannot be found in host, or in an unknown'",1,1,0.1111111111111111,934
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return self._host_state,1,1,0.1111111111111111,935
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(""No vSphere session was open during cleanup_host."")",1,1,0.1111111111111111,936
7a60b5c406336c5f410d1a98868c3f93d888ea0c,session_manager = service_content.sessionManager,1,1,0.1111111111111111,937
7a60b5c406336c5f410d1a98868c3f93d888ea0c,service_content = vim.get_service_content(),1,1,0.1111111111111111,938
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def cleanup_host(self, host):",1,1,0.1111111111111111,939
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vim = self._session.vim,1,1,0.1111111111111111,940
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def init_host(self, host):",1,1,0.1111111111111111,941
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._host_state = host.HostState(self._session,",1,1,0.1111111111111111,942
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""List VM instances.""""""",1,1,0.1111111111111111,943
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if not self._host_state:,1,1,0.1111111111111111,944
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def host_state(self):,1,1,0.1111111111111111,945
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._host_state = None,1,1,0.1111111111111111,946
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._host = host.Host(self._session),1,1,0.1111111111111111,947
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._vmops = vmops.VMwareVMOps(self._session, self.virtapi,",1,1,0.1111111111111111,948
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._volumeops = volumeops.VMwareVolumeOps(self._session),1,1,0.1111111111111111,949
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def list_instances(self):,1,1,0.1111111111111111,950
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return self._vmops.list_instances(),1,1,0.1111111111111111,951
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Power on the specified instance.""""""",1,1,0.1111111111111111,952
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Pause VM instance.""""""",1,1,0.1111111111111111,953
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Power off the specified instance.""""""",1,1,0.1111111111111111,954
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Unrescue the specified instance.""""""",1,1,0.1111111111111111,955
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._vmops.rescue(context, instance, network_info, image_meta)",1,1,0.1111111111111111,956
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Rescue the specified instance.""""""",1,1,0.1111111111111111,957
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Suspend the specified instance.""""""",1,1,0.1111111111111111,958
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Unpause paused VM instance.""""""",1,1,0.1111111111111111,959
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return,1,1,0.1111111111111111,960
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Create VM instance.""""""",1,1,0.1111111111111111,961
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if not instance['node']:,1,1,0.1111111111111111,962
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Destroy gets triggered when Resource Claim in resource_tracker,1,1,0.1111111111111111,963
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Destroy VM instance.""""""",1,1,0.1111111111111111,964
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Reboot VM instance.""""""",1,1,0.1111111111111111,965
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._vmops.snapshot(context, instance, image_id, update_task_state)",1,1,0.1111111111111111,966
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._vmops.spawn(context, instance, image_meta, injected_files,",1,1,0.1111111111111111,967
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vm_name = None,0,1,0.1111111111111111,968
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"% dest_vmdk_file_location, instance=instance)",1,1,0.1111111111111111,969
7a60b5c406336c5f410d1a98868c3f93d888ea0c,lst_vm_names = [],0,1,0.1111111111111111,970
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ds_refs = [],0,1,0.1111111111111111,971
7a60b5c406336c5f410d1a98868c3f93d888ea0c,dc_info = self._datastore_dc_mapping.get(ds_ref.value),0,1,0.1111111111111111,972
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if token:,0,1,0.1111111111111111,973
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._datastore_dc_mapping[ds_ref] = DcInfo(ref=dc_ref,",0,1,0.1111111111111111,974
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmFolder = p.val,0,1,0.1111111111111111,975
7a60b5c406336c5f410d1a98868c3f93d888ea0c,datastore_refs = p.val.ManagedObjectReference,0,1,0.1111111111111111,976
7a60b5c406336c5f410d1a98868c3f93d888ea0c,name = p.val,0,1,0.1111111111111111,977
7a60b5c406336c5f410d1a98868c3f93d888ea0c,dc_ref = dco.obj,0,1,0.1111111111111111,978
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return dc_info,0,1,0.1111111111111111,979
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmFolder = None,0,1,0.1111111111111111,980
7a60b5c406336c5f410d1a98868c3f93d888ea0c,name = None,0,1,0.1111111111111111,981
7a60b5c406336c5f410d1a98868c3f93d888ea0c,token = vm_util._get_token(dcs),0,1,0.1111111111111111,982
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Updates the datastore/datacenter cache.""""""",0,1,0.1111111111111111,983
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _update_datacenter_cache_from_objects(self, dcs):",0,1,0.1111111111111111,984
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _mkdir(self, ds_path, ds_ref):",0,1,0.1111111111111111,985
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if not dc_info:,0,1,0.1111111111111111,986
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vm_folder_ref = self._get_vmfolder_ref(),1,1,0.1111111111111111,987
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._datastore_dc_mapping[ds_ref.value] = map,0,1,0.1111111111111111,988
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ds_ref_ret = self._session._call_method(,0,1,0.1111111111111111,989
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if self._session:,0,1,0.1111111111111111,990
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._session = None,0,1,0.1111111111111111,991
7a60b5c406336c5f410d1a98868c3f93d888ea0c,TIME_BETWEEN_API_CALL_RETRIES = 1.0,0,1,0.1111111111111111,992
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ds_browser = vim_util.get_dynamic_property(,1,1,0.1111111111111111,993
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ds_ref_ret = vim_util.get_dynamic_property(,1,1,0.1111111111111111,994
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ds_browser = self._session._call_method(,0,1,0.1111111111111111,995
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if self.vim:,1,1,0.1111111111111111,996
7a60b5c406336c5f410d1a98868c3f93d888ea0c,dc_ref = self._get_datacenter_ref_and_name()[0],1,1,0.1111111111111111,997
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if hasattr(self, 'vim') and self.vim:",0,1,0.1111111111111111,998
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _mkdir(self, ds_path):",1,1,0.1111111111111111,999
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return dc_obj.objects[0].obj, dc_obj.objects[0].propSet[0].val",1,1,0.1111111111111111,1000
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _get_datacenter_ref_and_name(self):,1,1,0.1111111111111111,1001
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"lst_properties = [""config.files.vmPathName"", ""runtime.powerState""]",1,1,0.1111111111111111,1002
7a60b5c406336c5f410d1a98868c3f93d888ea0c,dc_name = self._get_datacenter_ref_and_name()[1],1,1,0.1111111111111111,1003
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return map,0,1,0.1111111111111111,1004
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"map = DcInfo(ref=dc_obj.objects[0].obj,",0,1,0.1111111111111111,1005
7a60b5c406336c5f410d1a98868c3f93d888ea0c,active = False,0,1,0.1111111111111111,1006
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return _vmops.get_info(instance),1,1,0.1111111111111111,1007
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"dest_vmdk_data_file_path = vm_util.build_datastore_path(datastore_name,",0,1,0.1111111111111111,1008
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"dest_vmdk_file_path = vm_util.build_datastore_path(datastore_name,",0,1,0.1111111111111111,1009
7a60b5c406336c5f410d1a98868c3f93d888ea0c,random_name = uuidutils.generate_uuid(),0,1,0.1111111111111111,1010
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Deleted the datastore file""), instance=instance)",0,1,0.1111111111111111,1011
7a60b5c406336c5f410d1a98868c3f93d888ea0c,file_delete_task = self._session._call_method(,0,1,0.1111111111111111,1012
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vim = self._session._get_vim(),0,1,0.1111111111111111,1013
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return self._vmops.get_info(instance),1,1,0.1111111111111111,1014
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _delete_disk_file(vmdk_path):,1,1,0.1111111111111111,1015
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return _vmops.get_diagnostics(instance),0,1,0.1111111111111111,1016
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return self._vmops.get_diagnostics(instance),0,1,0.1111111111111111,1017
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return property_value,1,1,0.1111111111111111,1018
7a60b5c406336c5f410d1a98868c3f93d888ea0c,property_value = dynamic_property[0].val,1,1,0.1111111111111111,1019
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if dynamic_property:,1,1,0.1111111111111111,1020
7a60b5c406336c5f410d1a98868c3f93d888ea0c,dynamic_property = obj_content.objects[0].propSet,1,1,0.1111111111111111,1021
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""vmware-tmp/%s-flat.vmdk"" % random_name)",0,1,0.1111111111111111,1022
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""store %(data_store_name)s"") %",1,1,0.1111111111111111,1023
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if not map:,0,1,0.1111111111111111,1024
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ds_ref = _check_if_tmp_folder_exists(),0,1,0.1111111111111111,1025
7a60b5c406336c5f410d1a98868c3f93d888ea0c,map = self._datastore_dc_mapping.get(ds_ref.value),0,1,0.1111111111111111,1026
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def get_datacenter_ref_and_name(self, ds_ref):",0,1,0.1111111111111111,1027
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ds_ref = ds_ref_ret.ManagedObjectReference[0],0,1,0.1111111111111111,1028
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ds_ref_ret = query['datastore'],0,1,0.1111111111111111,1029
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"lst_properties = [""config.files.vmPathName"", ""runtime.powerState"",",0,1,0.1111111111111111,1030
7a60b5c406336c5f410d1a98868c3f93d888ea0c,dc_info = self.get_datacenter_ref_and_name(ds_ref),0,1,0.1111111111111111,1031
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return ds_ref,0,1,0.1111111111111111,1032
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmdk_delete_task = self._session._call_method(,1,1,0.1111111111111111,1033
7a60b5c406336c5f410d1a98868c3f93d888ea0c,dc_info = self.get_datacenter_ref_and_name(data_store_ref),0,1,0.1111111111111111,1034
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"DcInfo = collections.namedtuple('DcInfo',",0,1,0.1111111111111111,1035
7a60b5c406336c5f410d1a98868c3f93d888ea0c,remove_disk_task = self._session._call_method(,1,1,0.1111111111111111,1036
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Driver validated by VMware's Minesweeper CI,1,1,0.1111111111111111,1037
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"dest_vmdk_file_location = vm_util.build_datastore_path(datastore_name,",1,1,0.1111111111111111,1038
7a60b5c406336c5f410d1a98868c3f93d888ea0c,random_name = str(uuid.uuid4()),1,1,0.1111111111111111,1039
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _session_is_active(self):,0,1,0.1111111111111111,1040
7a60b5c406336c5f410d1a98868c3f93d888ea0c,active = self.vim.SessionIsActive(,0,1,0.1111111111111111,1041
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Returns list of valid vms from RetrieveResult object.""""""",0,1,0.1111111111111111,1042
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if device.unitNumber > unit_number:,1,1,0.1111111111111111,1043
7a60b5c406336c5f410d1a98868c3f93d888ea0c,disk_type) = vm_util.get_vmdk_path_and_adapter_type(,0,1,0.1111111111111111,1044
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if controller_spec:,0,1,0.1111111111111111,1045
7a60b5c406336c5f410d1a98868c3f93d888ea0c,cdrom_attach_config_spec = vm_util.get_cdrom_attach_config_spec(,0,1,0.1111111111111111,1046
7a60b5c406336c5f410d1a98868c3f93d888ea0c,controller_spec) = vm_util.allocate_controller_key_and_unit_number(,0,1,0.1111111111111111,1047
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return (vmdk_file_path, vmdk_controller_key, adapter_type,",1,1,0.1111111111111111,1048
7a60b5c406336c5f410d1a98868c3f93d888ea0c,unit_number = device.unitNumber,1,1,0.1111111111111111,1049
7a60b5c406336c5f410d1a98868c3f93d888ea0c,unit_number = 0,1,1,0.1111111111111111,1050
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"disk_type, unit_number) = vm_util.get_vmdk_path_and_adapter_type(",1,1,0.1111111111111111,1051
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"controller_spec = create_controller_spec(client_factory,",1,1,0.1111111111111111,1052
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# controls this Hard Disk,1,1,0.1111111111111111,1053
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return controller_key, 0, controller_spec",0,1,0.1111111111111111,1054
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"controller_spec = create_controller_spec(client_factory, controller_key,",0,1,0.1111111111111111,1055
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return ret[0], ret[1], None",0,1,0.1111111111111111,1056
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if ret:,0,1,0.1111111111111111,1057
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmdk_attach_config_spec = vm_util.get_cdrom_attach_config_spec(,1,1,0.1111111111111111,1058
7a60b5c406336c5f410d1a98868c3f93d888ea0c,unit_number) = vm_util.get_vmdk_path_and_adapter_type(,1,1,0.1111111111111111,1059
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"ret = _find_controller_slot(ide_keys, taken, 2)",0,1,0.1111111111111111,1060
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"snapshot = self._create_vm_snapshot(instance, vm_ref)",0,1,0.1111111111111111,1061
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _get_valid_vms_from_retrieve_result(self, retrieve_result):",0,1,0.1111111111111111,1062
7a60b5c406336c5f410d1a98868c3f93d888ea0c,lst_vm_names = self._get_valid_vms_from_retrieve_result(vms),0,1,0.1111111111111111,1063
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"name=""%s-snapshot"" % instance['uuid'],",1,1,0.1111111111111111,1064
7a60b5c406336c5f410d1a98868c3f93d888ea0c,snapshot_task = self._session._call_method(,1,1,0.1111111111111111,1065
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _create_vm_snapshot():,1,1,0.1111111111111111,1066
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Note(vui): handle snapshot cleanup on exceptions.,0,1,0.1111111111111111,1067
7a60b5c406336c5f410d1a98868c3f93d888ea0c,delete_snapshot_task = self._session._call_method(,0,1,0.1111111111111111,1068
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Creating directory with path %s"") % ds_path)",1,1,0.1111111111111111,1069
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return snapshot,0,1,0.1111111111111111,1070
7a60b5c406336c5f410d1a98868c3f93d888ea0c,snapshot = task_info.result,0,1,0.1111111111111111,1071
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"name=""%s-snapshot"" % instance['uuid'],",0,1,0.1111111111111111,1072
7a60b5c406336c5f410d1a98868c3f93d888ea0c,snapshot_task = self._session._call_method(,0,1,0.1111111111111111,1073
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Created directory with path %s"") % ds_path)",1,1,0.1111111111111111,1074
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._session._call_method(self._session._get_vim(), ""MakeDirectory"",",1,1,0.1111111111111111,1075
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"ret = _find_controller_slot(scsi_keys, taken, 16)",0,1,0.1111111111111111,1076
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ret = None,0,1,0.1111111111111111,1077
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return active,0,1,0.1111111111111111,1078
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._session_id = session.key,1,1,0.1111111111111111,1079
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _stop_loop(self, loop):",0,1,0.1111111111111111,1080
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""got this exception: %s"") % exc)",1,1,0.1111111111111111,1081
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.critical(_(""In vmwareapi:_call_method, """,1,1,0.1111111111111111,1082
7a60b5c406336c5f410d1a98868c3f93d888ea0c,last_fault_list = excep.fault_list,1,1,0.1111111111111111,1083
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if error_util.FAULT_NOT_AUTHENTICATED in last_fault_list:,1,1,0.1111111111111111,1084
7a60b5c406336c5f410d1a98868c3f93d888ea0c,last_fault_list = [],1,1,0.1111111111111111,1085
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if self._session_id:,1,1,0.1111111111111111,1086
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return (vmdk_file_path, adapter_type, disk_type)",0,1,0.1111111111111111,1087
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._session_id = None,1,1,0.1111111111111111,1088
7a60b5c406336c5f410d1a98868c3f93d888ea0c,TIME_BETWEEN_API_CALL_RETRIES = 2.0,1,1,0.1111111111111111,1089
7a60b5c406336c5f410d1a98868c3f93d888ea0c,exc = excep,0,1,0.1111111111111111,1090
7a60b5c406336c5f410d1a98868c3f93d888ea0c,except error_util.SessionConnectionException as excep:,0,1,0.1111111111111111,1091
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if self._session_is_active():,0,1,0.1111111111111111,1092
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# active,0,1,0.1111111111111111,1093
7a60b5c406336c5f410d1a98868c3f93d888ea0c,raise,0,1,0.1111111111111111,1094
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _find_controller_slot(controller_keys, taken, max_unit_number):",0,1,0.1111111111111111,1095
7a60b5c406336c5f410d1a98868c3f93d888ea0c,taken = _find_allocated_slots(devices),0,1,0.1111111111111111,1096
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if hasattr(device, 'controllerKey') and hasattr(device, 'unitNumber'):",0,1,0.1111111111111111,1097
7a60b5c406336c5f410d1a98868c3f93d888ea0c,devices = devices.VirtualDevice,0,1,0.1111111111111111,1098
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def allocate_controller_key_and_unit_number(client_factory, devices,",0,1,0.1111111111111111,1099
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return taken,0,1,0.1111111111111111,1100
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"unit_numbers = taken.setdefault(device.key, [])",0,1,0.1111111111111111,1101
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if _is_scsi_controller(device):,0,1,0.1111111111111111,1102
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"unit_numbers = taken.setdefault(device.controllerKey, [])",0,1,0.1111111111111111,1103
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""",0,1,0.1111111111111111,1104
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for controller_key in controller_keys:,0,1,0.1111111111111111,1105
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _find_allocated_slots(devices):,0,1,0.1111111111111111,1106
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return device.__class__.__name__ in ['VirtualLsiLogicController',",0,1,0.1111111111111111,1107
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _is_scsi_controller(device):,0,1,0.1111111111111111,1108
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _is_ide_controller(device):,0,1,0.1111111111111111,1109
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return controller_key, unit_number",0,1,0.1111111111111111,1110
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if not unit_number in taken.get(controller_key, []):",0,1,0.1111111111111111,1111
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#,1,1,0.1111111111111111,1112
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"outbytes = struct.unpack('iL', fcntl.ioctl(",1,1,0.1111111111111111,1113
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def __init__(self, virtapi, scheme=""https""):",1,1,0.1111111111111111,1114
7a60b5c406336c5f410d1a98868c3f93d888ea0c,elif os.path.exists('/usr/sbin/vmware-guestd'):,1,1,0.1111111111111111,1115
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.warn(_(""Distro '%s' not supported"") % platform.dist()[0])",1,1,0.1111111111111111,1116
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if(platform.dist()[0] == 'Ubuntu'):,1,1,0.1111111111111111,1117
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# TODO(sateesh): For other distros like suse, debian, BSD, etc.",1,1,0.1111111111111111,1118
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_details = _parse_network_details(_execute(cmd,",1,1,0.1111111111111111,1119
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"cmd = [vmware_tools_bin, '--cmd', 'machine.id.get']",1,1,0.1111111111111111,1120
7a60b5c406336c5f410d1a98868c3f93d888ea0c,elif os.path.exists('/usr/bin/vmware-guestd'):,1,1,0.1111111111111111,1121
7a60b5c406336c5f410d1a98868c3f93d888ea0c,elif os.path.exists('/usr/bin/vmtoolsd'):,1,1,0.1111111111111111,1122
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _get_base_url(self, scheme, host, file_path):",0,1,0.1111111111111111,1123
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if os.path.exists('/usr/sbin/vmtoolsd'):,1,1,0.1111111111111111,1124
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Set IP address for the Linux VM.""""""",1,1,0.1111111111111111,1125
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _linux_set_networking():,1,1,0.1111111111111111,1126
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.debug(_(""Successfully configured NIC %(device)d with """,1,1,0.1111111111111111,1127
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\naddress %s\n' % ip_address),1,1,0.1111111111111111,1128
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nnetmask %s' % subnet_mask),1,1,0.1111111111111111,1129
7a60b5c406336c5f410d1a98868c3f93d888ea0c,pltfrm = sys.platform,1,1,0.1111111111111111,1130
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if utils.is_valid_ipv6(host):,0,1,0.1111111111111111,1131
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nbroadcast %s' % broadcast),1,1,0.1111111111111111,1132
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._conn = self._create_read_connection(self._base_url,",0,1,0.1111111111111111,1133
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def __init__(self, glance_read_iter):",1,1,0.1111111111111111,1134
7a60b5c406336c5f410d1a98868c3f93d888ea0c,READ_CHUNKSIZE = 65536,1,1,0.1111111111111111,1135
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"USER_AGENT = ""OpenStack-ESX-Adapter""",1,1,0.1111111111111111,1136
7a60b5c406336c5f410d1a98868c3f93d888ea0c,LOG = logging.getLogger(__name__),1,1,0.1111111111111111,1137
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return self._file_handle.headers.get(""Content-Length"", -1)",0,1,0.1111111111111111,1138
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return self._file_handle.read(rw_handles.READ_CHUNKSIZE),0,1,0.1111111111111111,1139
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"param_list = {""dcPath"": data_center_name, ""dsName"": datastore_name}",0,1,0.1111111111111111,1140
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if utils.is_valid_ipv6(host):,1,1,0.1111111111111111,1141
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._base_url = self._get_base_url(scheme, host, port, file_path)",0,1,0.1111111111111111,1142
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def __init__(self, host, port, data_center_name, datastore_name, cookies,",0,1,0.1111111111111111,1143
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def __init__(self, host, data_center_name, datastore_name, cookies,",1,1,0.1111111111111111,1144
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _get_base_url(self, scheme, host, file_path):",1,1,0.1111111111111111,1145
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def __init__(self, host, port, data_center_name, datastore_name, cookies,",0,1,0.1111111111111111,1146
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _get_base_url(self, scheme, host, port, file_path):",0,1,0.1111111111111111,1147
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\ngateway %s' % gateway),1,1,0.1111111111111111,1148
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nauto %s' % adapter_name),1,1,0.1111111111111111,1149
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.iter = self.get_next(),1,1,0.1111111111111111,1150
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.warn(_(""VMware Tools is not installed""))",1,1,0.1111111111111111,1151
7a60b5c406336c5f410d1a98868c3f93d888ea0c,all_dns_servers = [],1,1,0.1111111111111111,1152
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _set_rhel_networking(network_details=None):,1,1,0.1111111111111111,1153
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return final_list,1,1,0.1111111111111111,1154
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if entry and entry not in final_list:,1,1,0.1111111111111111,1155
7a60b5c406336c5f410d1a98868c3f93d888ea0c,final_list = [],1,1,0.1111111111111111,1156
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _filter_duplicates(all_entries):,1,1,0.1111111111111111,1157
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"cmd = ['netsh', 'interface', 'ip', 'add', 'dns',",1,1,0.1111111111111111,1158
7a60b5c406336c5f410d1a98868c3f93d888ea0c,name_and_ip = _get_linux_adapter_name_and_ip_address(mac_address),1,1,0.1111111111111111,1159
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if dns_server:,1,1,0.1111111111111111,1160
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"cmd = ['netsh', 'interface', 'ip', 'set', 'address',",1,1,0.1111111111111111,1161
7a60b5c406336c5f410d1a98868c3f93d888ea0c,name_and_ip = _get_win_adapter_name_and_ip_address(mac_address),1,1,0.1111111111111111,1162
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"(mac_address, ip_address, subnet_mask, gateway, broadcast,",1,1,0.1111111111111111,1163
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"for network_detail in _parse_network_details(_execute(cmd,",1,1,0.1111111111111111,1164
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if vmware_tools_bin:,1,1,0.1111111111111111,1165
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for network_detail in network_details:,1,1,0.1111111111111111,1166
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"interface_file = open(interface_file_name, 'w')",1,1,0.1111111111111111,1167
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if adapter_name:,1,1,0.1111111111111111,1168
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"dns_file = open(dns_file_name, 'w')",1,1,0.1111111111111111,1169
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"for device, network_detail in enumerate(network_details):",1,1,0.1111111111111111,1170
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file_name = '/etc/network/interfaces',1,1,0.1111111111111111,1171
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _set_ubuntu_networking(network_details=None):,1,1,0.1111111111111111,1172
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"dns_file.write(""\nnameserver %s"" % dns_server)",1,1,0.1111111111111111,1173
7a60b5c406336c5f410d1a98868c3f93d888ea0c,unique_entries = _filter_duplicates(all_dns_servers),1,1,0.1111111111111111,1174
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"dns_file.write(""; generated by OpenStack guest tools"")",1,1,0.1111111111111111,1175
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"dns_file_name = ""/etc/resolv.conf""",1,1,0.1111111111111111,1176
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nDEVICE=%s' % adapter_name),1,1,0.1111111111111111,1177
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if all_dns_servers:,1,1,0.1111111111111111,1178
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nMACADDR=%s' % mac_address),1,1,0.1111111111111111,1179
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nIPADDR=%s' % ip_address),1,1,0.1111111111111111,1180
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nNETMASK=%s' % subnet_mask),1,1,0.1111111111111111,1181
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nGATEWAY=%s' % gateway),1,1,0.1111111111111111,1182
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nBROADCAST=%s' % broadcast),1,1,0.1111111111111111,1183
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.glance_read_iter = glance_read_iter,1,1,0.1111111111111111,1184
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Read an item from the queue.",1,1,0.1111111111111111,1185
7a60b5c406336c5f410d1a98868c3f93d888ea0c,program_files_x86 = os.environ.get('PROGRAMFILES(X86)'),1,1,0.1111111111111111,1186
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def get_vmdk_info(session, vm_ref, uuid=None):",0,1,0.1111111111111111,1187
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_type_dict[device.key] = constants.DEFAULT_ADAPTER_TYPE,1,1,0.1111111111111111,1188
7a60b5c406336c5f410d1a98868c3f93d888ea0c,hardware_devices = hardware_devices.VirtualDevice,1,1,0.1111111111111111,1189
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def get_vmdk_info(session, vm_ref, uuid=None):",1,1,0.1111111111111111,1190
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_type_dict[device.key] = CONTROLLER_TO_ADAPTER_TYPE[,0,1,0.1111111111111111,1191
7a60b5c406336c5f410d1a98868c3f93d888ea0c,elif device.__class__.__name__ in CONTROLLER_TO_ADAPTER_TYPE:,0,1,0.1111111111111111,1192
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"hardware_devices = get_hardware_devices(session, vm_ref)",0,1,0.1111111111111111,1193
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return vim_util.get_array_items(hardware_devices),0,1,0.1111111111111111,1194
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_type_dict[device.key] = constants.ADAPTER_TYPE_IDE,1,1,0.1111111111111111,1195
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def get_hardware_devices(session, vm_ref):",0,1,0.1111111111111111,1196
7a60b5c406336c5f410d1a98868c3f93d888ea0c,CONTROLLER_TO_ADAPTER_TYPE = {,0,1,0.1111111111111111,1197
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"num_cpu = int(vm_props.get('summary.config.numCpu', 0))",1,1,0.1111111111111111,1198
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"max_mem = int(vm_props.get('summary.config.memorySizeMB', 0)) * 1024",1,1,0.1111111111111111,1199
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"lst_properties = [""summary.config.numCpu"",",1,1,0.1111111111111111,1200
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return hardware.InstanceInfo(state=state,",1,1,0.1111111111111111,1201
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_type_dict[device.key] = constants.ADAPTER_TYPE_BUSLOGIC,1,1,0.1111111111111111,1202
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_type_dict[device.key] = constants.ADAPTER_TYPE_LSILOGICSAS,1,1,0.1111111111111111,1203
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return hardware.InstanceInfo(state=state),0,1,0.1111111111111111,1204
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if not self._is_vim_object(module):,1,1,0.1111111111111111,1205
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"obj_content = get_object_properties(vim, None, mobj, type, [property_name])",1,1,0.1111111111111111,1206
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return self.wait_for_task(task_ref),1,1,0.1111111111111111,1207
7a60b5c406336c5f410d1a98868c3f93d888ea0c,The task is polled until it completes.,1,1,0.1111111111111111,1208
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _wait_for_task(self, task_ref):",1,1,0.1111111111111111,1209
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return self.invoke_api(module, method, *args, **kwargs)",1,1,0.1111111111111111,1210
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return self.invoke_api(module, method, self.vim, *args, **kwargs)",1,1,0.1111111111111111,1211
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return isinstance(module, vim.Vim)",1,1,0.1111111111111111,1212
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_type_dict[device.key] = constants.ADAPTER_TYPE_PARAVIRTUAL,1,1,0.1111111111111111,1213
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _is_vim_object(self, module):",1,1,0.1111111111111111,1214
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def __init__(self, host_ip=CONF.vmware.host_ip,",1,1,0.1111111111111111,1215
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""",1,1,0.1111111111111111,1216
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._session = VMwareAPISession(scheme=scheme),1,1,0.1111111111111111,1217
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._session = session.VMwareAPISession(scheme=scheme),0,1,0.1111111111111111,1218
7a60b5c406336c5f410d1a98868c3f93d888ea0c,from nova.virt.vmwareapi import session,0,1,0.1111111111111111,1219
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"lst_properties = [""runtime.powerState""]",0,1,0.1111111111111111,1220
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_props = self._session._call_method(vutil,",1,1,0.1111111111111111,1221
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""",1,1,0.1111111111111111,1222
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def __init__(self, file_handle):",1,1,0.1111111111111111,1223
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"cookie_header = """"",1,1,0.1111111111111111,1224
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _build_vim_cookie_headers(self, vim_cookies):",1,1,0.1111111111111111,1225
7a60b5c406336c5f410d1a98868c3f93d888ea0c,except Exception as exc:,1,1,0.1111111111111111,1226
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def get_eof(self):,1,1,0.1111111111111111,1227
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def set_eof(self, eof):",1,1,0.1111111111111111,1228
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.file_handle = file_handle,1,1,0.1111111111111111,1229
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""A dummy close just to maintain consistency.""""""",1,1,0.1111111111111111,1230
7a60b5c406336c5f410d1a98868c3f93d888ea0c,raise NotImplementedError(),1,1,0.1111111111111111,1231
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def close(self):,1,1,0.1111111111111111,1232
7a60b5c406336c5f410d1a98868c3f93d888ea0c,yield data,1,1,0.1111111111111111,1233
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for data in self.glance_read_iter:,1,1,0.1111111111111111,1234
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def get_next(self):,1,1,0.1111111111111111,1235
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return """"",1,1,0.1111111111111111,1236
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return self.iter.next(),1,1,0.1111111111111111,1237
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return cookie_header,1,1,0.1111111111111111,1238
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def get_size(self):,1,1,0.1111111111111111,1239
7a60b5c406336c5f410d1a98868c3f93d888ea0c,raise exception.InstanceNotFound(instance_id=instance.uuid),0,1,0.1111111111111111,1240
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(""Exception during HTTP connection close in """,1,1,0.1111111111111111,1241
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_props = self._session._call_method(vutil,",0,1,0.1111111111111111,1242
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return self.file_handle.headers.get(""Content-Length"", -1)",1,1,0.1111111111111111,1243
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return self.file_handle.read(READ_CHUNKSIZE),1,1,0.1111111111111111,1244
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# while writing.,1,1,0.1111111111111111,1245
7a60b5c406336c5f410d1a98868c3f93d888ea0c,conn = urllib2.urlopen(request),1,1,0.1111111111111111,1246
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"headers = {'User-Agent': USER_AGENT,",1,1,0.1111111111111111,1247
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.conn = conn,1,1,0.1111111111111111,1248
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def __init__(self, host, port, data_center_name, datastore_name, cookies,",1,1,0.1111111111111111,1249
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"conn.putheader(""Content-Length"", file_size)",1,1,0.1111111111111111,1250
7a60b5c406336c5f410d1a98868c3f93d888ea0c,conn = httplib.HTTPSConnection(netloc),1,1,0.1111111111111111,1251
7a60b5c406336c5f410d1a98868c3f93d888ea0c,conn = httplib.HTTPConnection(netloc),1,1,0.1111111111111111,1252
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"scheme, netloc, path, params, query, fragment = _urlparse",1,1,0.1111111111111111,1253
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_urlparse = urlparse.urlparse(base_url),1,1,0.1111111111111111,1254
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"param_list = {""dcPath"": data_center_name, ""dsName"": datastore_name}",1,1,0.1111111111111111,1255
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"elif program_files_x86 and os.path.exists(os.path.join(program_files_x86,",1,1,0.1111111111111111,1256
7a60b5c406336c5f410d1a98868c3f93d888ea0c,program_files = os.environ.get('PROGRAMFILES'),1,1,0.1111111111111111,1257
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._cluster_names = CONF.vmware.cluster_name,1,1,0.1111111111111111,1258
7a60b5c406336c5f410d1a98868c3f93d888ea0c,linked_clone = strutils.bool_from_string(image_linked_clone),0,1,0.1111111111111111,1259
7a60b5c406336c5f410d1a98868c3f93d888ea0c,props_map = {,0,1,0.1111111111111111,1260
7a60b5c406336c5f410d1a98868c3f93d888ea0c,props['file_type'] = image_meta['disk_format'],0,1,0.1111111111111111,1261
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if 'disk_format' in image_meta:,0,1,0.1111111111111111,1262
7a60b5c406336c5f410d1a98868c3f93d888ea0c,props['file_size'] = image_meta['size'],0,1,0.1111111111111111,1263
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if 'size' in image_meta:,0,1,0.1111111111111111,1264
7a60b5c406336c5f410d1a98868c3f93d888ea0c,props = {,0,1,0.1111111111111111,1265
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"image_linked_clone = properties.get(LINKED_CLONE_PROPERTY,",0,1,0.1111111111111111,1266
7a60b5c406336c5f410d1a98868c3f93d888ea0c,props[v] = properties[k],0,1,0.1111111111111111,1267
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"properties = image_meta.get(""properties"", {})",0,1,0.1111111111111111,1268
7a60b5c406336c5f410d1a98868c3f93d888ea0c,:return: vmware image object,0,1,0.1111111111111111,1269
7a60b5c406336c5f410d1a98868c3f93d888ea0c,:param image_meta - image metadata we are working with,0,1,0.1111111111111111,1270
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def from_image(cls, image_id, image_meta=None):",0,1,0.1111111111111111,1271
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def is_iso(self):,0,1,0.1111111111111111,1272
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def is_sparse(self):,0,1,0.1111111111111111,1273
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if k in properties:,0,1,0.1111111111111111,1274
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return cls(**props),0,1,0.1111111111111111,1275
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def file_size_in_gb(self):,0,1,0.1111111111111111,1276
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ARCH_32_BIT = '32bit',1,1,0.1111111111111111,1277
7a60b5c406336c5f410d1a98868c3f93d888ea0c,LOG_DIR = '/var/log/openstack',1,1,0.1111111111111111,1278
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG_DIR = os.path.join(os.environ.get('ALLUSERSPROFILE'), 'openstack')",1,1,0.1111111111111111,1279
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"FORMAT = ""%(asctime)s - %(levelname)s - %(message)s""",1,1,0.1111111111111111,1280
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Logging,1,1,0.1111111111111111,1281
7a60b5c406336c5f410d1a98868c3f93d888ea0c,NO_MACHINE_ID = 'No machine id',1,1,0.1111111111111111,1282
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ARCH_64_BIT = '64bit',1,1,0.1111111111111111,1283
7a60b5c406336c5f410d1a98868c3f93d888ea0c,PLATFORM_LINUX = 'linux2',1,1,0.1111111111111111,1284
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""",1,1,0.1111111111111111,1285
7a60b5c406336c5f410d1a98868c3f93d888ea0c,PLATFORM_WIN = 'win32',1,1,0.1111111111111111,1286
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""",1,1,0.1111111111111111,1287
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#         http://www.apache.org/licenses/LICENSE-2.0,1,1,0.1111111111111111,1288
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#,1,1,0.1111111111111111,1289
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return size, properties",1,1,0.1111111111111111,1290
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"size, properties = meta_data[""size""], meta_data[""properties""]",1,1,0.1111111111111111,1291
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return self.file_size / units.Gi,0,1,0.1111111111111111,1292
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return self.file_size / units.Ki,0,1,0.1111111111111111,1293
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if not os.path.exists(LOG_DIR):,1,1,0.1111111111111111,1294
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._resource_keys = set(),1,1,0.1111111111111111,1295
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._vc_state = self._resources.get(first_cluster).get('vcstate'),1,1,0.1111111111111111,1296
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._volumeops = self._resources.get(first_cluster).get('volumeops'),1,1,0.1111111111111111,1297
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._vmops = self._resources.get(first_cluster).get('vmops'),1,1,0.1111111111111111,1298
7a60b5c406336c5f410d1a98868c3f93d888ea0c,first_cluster = self._resources.keys()[0],1,1,0.1111111111111111,1299
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# not use VC state.,1,1,0.1111111111111111,1300
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._virtapi = virtapi,1,1,0.1111111111111111,1301
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# objects per cluster,1,1,0.1111111111111111,1302
7a60b5c406336c5f410d1a98868c3f93d888ea0c,CONF = cfg.CONF,0,1,0.1111111111111111,1303
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if missing_clusters:,1,1,0.1111111111111111,1304
7a60b5c406336c5f410d1a98868c3f93d888ea0c,missing_clusters = set(self._cluster_names) - set(clusters_found),1,1,0.1111111111111111,1305
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"clusters_found = [v.get('name') for k, v in self.dict_mors.iteritems()]",1,1,0.1111111111111111,1306
7a60b5c406336c5f410d1a98868c3f93d888ea0c,% self._cluster_names),1,1,0.1111111111111111,1307
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if not self.dict_mors:,1,1,0.1111111111111111,1308
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self.dict_mors = vm_util.get_all_cluster_refs_by_name(self._session,",1,1,0.1111111111111111,1309
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# In this situation, ESXi and vCenter require different",1,1,0.1111111111111111,1310
7a60b5c406336c5f410d1a98868c3f93d888ea0c,LINKED_CLONE_PROPERTY = 'vmware_linked_clone',0,1,0.1111111111111111,1311
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def file_size_in_kb(self):,0,1,0.1111111111111111,1312
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.disk_type = disk_type,0,1,0.1111111111111111,1313
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.vif_model = vif_model,0,1,0.1111111111111111,1314
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.linked_clone = CONF.vmware.use_linked_clone,0,1,0.1111111111111111,1315
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.linked_clone = linked_clone,0,1,0.1111111111111111,1316
7a60b5c406336c5f410d1a98868c3f93d888ea0c,raise exception.InvalidDiskFormat(disk_format=self.file_type),0,1,0.1111111111111111,1317
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# descriptor-based validation.,0,1,0.1111111111111111,1318
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.file_type = file_type,0,1,0.1111111111111111,1319
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.os_type = os_type,0,1,0.1111111111111111,1320
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def __init__(self, image_id,",0,1,0.1111111111111111,1321
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.file_size = file_size,0,1,0.1111111111111111,1322
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.image_id = image_id,0,1,0.1111111111111111,1323
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""",0,1,0.1111111111111111,1324
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"linked_clone(bool): use linked clone, or don't",0,1,0.1111111111111111,1325
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"disk_type (str): type of disk in thin, thick, etc",0,1,0.1111111111111111,1326
7a60b5c406336c5f410d1a98868c3f93d888ea0c,os_type (str): name of guest os (use vSphere names only),0,1,0.1111111111111111,1327
7a60b5c406336c5f410d1a98868c3f93d888ea0c,LOG_DIR = 'logs',1,1,0.1111111111111111,1328
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG_FILENAME = os.path.join(LOG_DIR, 'openstack-guest-tools.log')",1,1,0.1111111111111111,1329
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Set IP address for the windows VM.""""""",1,1,0.1111111111111111,1330
7a60b5c406336c5f410d1a98868c3f93d888ea0c,offset2 = 32,1,1,0.1111111111111111,1331
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for adapter_name in adapter_names:,1,1,0.1111111111111111,1332
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"sock.fileno(),",1,1,0.1111111111111111,1333
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"names = array.array('B', '\0' * max_bytes)",1,1,0.1111111111111111,1334
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)",1,1,0.1111111111111111,1335
7a60b5c406336c5f410d1a98868c3f93d888ea0c,offset2 = 40,1,1,0.1111111111111111,1336
7a60b5c406336c5f410d1a98868c3f93d888ea0c,offset1 = 16,1,1,0.1111111111111111,1337
7a60b5c406336c5f410d1a98868c3f93d888ea0c,offset1 = 32,1,1,0.1111111111111111,1338
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _get_win_adapter_name_and_ip_address(mac_address):,1,1,0.1111111111111111,1339
7a60b5c406336c5f410d1a98868c3f93d888ea0c,arch = platform.architecture()[0],1,1,0.1111111111111111,1340
7a60b5c406336c5f410d1a98868c3f93d888ea0c,max_bytes = 8096,1,1,0.1111111111111111,1341
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _get_linux_network_adapters():,1,1,0.1111111111111111,1342
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'ip-address': ip_address,",1,1,0.1111111111111111,1343
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'mac-address': mac_address,",1,1,0.1111111111111111,1344
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_adapters.append({'name': adapter_name,",1,1,0.1111111111111111,1345
7a60b5c406336c5f410d1a98868c3f93d888ea0c,subnet_mask = socket.inet_ntoa(fcntl.ioctl(,1,1,0.1111111111111111,1346
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _get_linux_adapter_name_and_ip_address(mac_address):,1,1,0.1111111111111111,1347
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if config.IPEnabled:,1,1,0.1111111111111111,1348
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if obj.returncode:,1,1,0.1111111111111111,1349
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _windows_set_networking():,1,1,0.1111111111111111,1350
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return result,1,1,0.1111111111111111,1351
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"raise ProcessExecutionError(exit_code=obj.returncode,",1,1,0.1111111111111111,1352
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"(stdout, stderr) = result",1,1,0.1111111111111111,1353
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if check_exit_code and obj.returncode != 0:,1,1,0.1111111111111111,1354
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.debug(_(""Result was %s"") % obj.returncode)",1,1,0.1111111111111111,1355
7a60b5c406336c5f410d1a98868c3f93d888ea0c,result = obj.communicate(),1,1,0.1111111111111111,1356
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _execute(cmd_list, process_input=None, check_exit_code=True):",1,1,0.1111111111111111,1357
7a60b5c406336c5f410d1a98868c3f93d888ea0c,result = obj.communicate(process_input),1,1,0.1111111111111111,1358
7a60b5c406336c5f410d1a98868c3f93d888ea0c,result = None,1,1,0.1111111111111111,1359
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"obj = subprocess.Popen(cmd, shell=True, stdin=subprocess.PIPE,",1,1,0.1111111111111111,1360
7a60b5c406336c5f410d1a98868c3f93d888ea0c,env = os.environ.copy(),1,1,0.1111111111111111,1361
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.debug(_(""Executing command: '%s'"") % cmd)",1,1,0.1111111111111111,1362
7a60b5c406336c5f410d1a98868c3f93d888ea0c,cmd = ' '.join(cmd_list),1,1,0.1111111111111111,1363
7a60b5c406336c5f410d1a98868c3f93d888ea0c,subnet_mask = config.IPSubnet[0],1,1,0.1111111111111111,1364
7a60b5c406336c5f410d1a98868c3f93d888ea0c,subnet_mask = '',1,1,0.1111111111111111,1365
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if sys.hexversion < 0x3000000:,1,1,0.1111111111111111,1366
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _bytes2int(bytes):,1,1,0.1111111111111111,1367
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_details = [],1,1,0.1111111111111111,1368
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.debug(_(""Received machine_id from vmtools : %s"") % machine_id[0])",1,1,0.1111111111111111,1369
7a60b5c406336c5f410d1a98868c3f93d888ea0c,Each record is separated by '#' from next record.,1,1,0.1111111111111111,1370
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'MAC;IP;Netmask;Gateway;Broadcast;DNS' where ';' is field separator.,1,1,0.1111111111111111,1371
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _parse_network_details(machine_id):,1,1,0.1111111111111111,1372
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Convert bytes to int.""""""",1,1,0.1111111111111111,1373
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return str(self.exit_code),1,1,0.1111111111111111,1374
7a60b5c406336c5f410d1a98868c3f93d888ea0c,no_grps = len(network_info_list) / 6,1,1,0.1111111111111111,1375
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def __str__(self):,1,1,0.1111111111111111,1376
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.cmd = cmd,1,1,0.1111111111111111,1377
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.stderr = stderr,1,1,0.1111111111111111,1378
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.stdout = stdout,1,1,0.1111111111111111,1379
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.exit_code = exit_code,1,1,0.1111111111111111,1380
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def __init__(self, exit_code, stdout, stderr, cmd):",1,1,0.1111111111111111,1381
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_info_list = machine_id_str.split(';'),1,1,0.1111111111111111,1382
7a60b5c406336c5f410d1a98868c3f93d888ea0c,i = 0,1,1,0.1111111111111111,1383
7a60b5c406336c5f410d1a98868c3f93d888ea0c,config = adapter.associators_(,1,1,0.1111111111111111,1384
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return network_details,1,1,0.1111111111111111,1385
7a60b5c406336c5f410d1a98868c3f93d888ea0c,mac_address = adapter.MacAddress.lower(),1,1,0.1111111111111111,1386
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter.NetConnectionStatus == 7):,1,1,0.1111111111111111,1387
7a60b5c406336c5f410d1a98868c3f93d888ea0c,wbem_network_adapters = wbem_service.InstancesOf('Win32_NetworkAdapter'),1,1,0.1111111111111111,1388
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"wbem_service = wbem_locator.ConnectServer('.', 'root\cimv2')",1,1,0.1111111111111111,1389
7a60b5c406336c5f410d1a98868c3f93d888ea0c,wbem_locator = win32com.client.Dispatch('WbemScripting.SWbemLocator'),1,1,0.1111111111111111,1390
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _get_windows_network_adapters():,1,1,0.1111111111111111,1391
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.debug(_(""NIC information from vmtools : %s"") % network_details)",1,1,0.1111111111111111,1392
7a60b5c406336c5f410d1a98868c3f93d888ea0c,k = i * 6,1,1,0.1111111111111111,1393
7a60b5c406336c5f410d1a98868c3f93d888ea0c,i += 1,1,1,0.1111111111111111,1394
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_info_list[k + 5].strip().split(',')))",1,1,0.1111111111111111,1395
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_info_list[k + 4].strip(),",1,1,0.1111111111111111,1396
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_info_list[k + 3].strip(),",1,1,0.1111111111111111,1397
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_info_list[k + 2].strip(),",1,1,0.1111111111111111,1398
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_info_list[k + 1].strip(),",1,1,0.1111111111111111,1399
7a60b5c406336c5f410d1a98868c3f93d888ea0c,property_value = None,1,1,0.1111111111111111,1400
7a60b5c406336c5f410d1a98868c3f93d888ea0c,except Exception as e:,0,1,0.1111111111111111,1401
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return vim.get_service_content().about,0,1,0.1111111111111111,1402
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#,1,1,0.1111111111111111,1403
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ARCH_64_BIT = '64bit',1,1,0.1111111111111111,1404
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ARCH_32_BIT = '32bit',1,1,0.1111111111111111,1405
7a60b5c406336c5f410d1a98868c3f93d888ea0c,PLATFORM_LINUX = 'linux2',1,1,0.1111111111111111,1406
7a60b5c406336c5f410d1a98868c3f93d888ea0c,PLATFORM_WIN = 'win32',1,1,0.1111111111111111,1407
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""",1,1,0.1111111111111111,1408
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#         http://www.apache.org/licenses/LICENSE-2.0,1,1,0.1111111111111111,1409
7a60b5c406336c5f410d1a98868c3f93d888ea0c,pltfrm = sys.platform,0,1,0.1111111111111111,1410
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Logging,1,1,0.1111111111111111,1411
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.warn(_(""Distro '%s' not supported"") % platform.dist()[0])",0,1,0.1111111111111111,1412
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if(platform.dist()[0] == 'Ubuntu'):,0,1,0.1111111111111111,1413
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# TODO(sateesh): For other distros like suse, debian, BSD, etc.",0,1,0.1111111111111111,1414
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_details = _parse_network_details(_execute(cmd,",0,1,0.1111111111111111,1415
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"cmd = [vmware_tools_bin, '--cmd', 'machine.id.get']",0,1,0.1111111111111111,1416
7a60b5c406336c5f410d1a98868c3f93d888ea0c,elif os.path.exists('/usr/bin/vmware-guestd'):,0,1,0.1111111111111111,1417
7a60b5c406336c5f410d1a98868c3f93d888ea0c,NO_MACHINE_ID = 'No machine id',1,1,0.1111111111111111,1418
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"FORMAT = ""%(asctime)s - %(levelname)s - %(message)s""",1,1,0.1111111111111111,1419
7a60b5c406336c5f410d1a98868c3f93d888ea0c,elif os.path.exists('/usr/bin/vmtoolsd'):,0,1,0.1111111111111111,1420
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.stdout = stdout,1,1,0.1111111111111111,1421
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Convert bytes to int.""""""",1,1,0.1111111111111111,1422
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _bytes2int(bytes):,1,1,0.1111111111111111,1423
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return str(self.exit_code),1,1,0.1111111111111111,1424
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def __str__(self):,1,1,0.1111111111111111,1425
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.cmd = cmd,1,1,0.1111111111111111,1426
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.stderr = stderr,1,1,0.1111111111111111,1427
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.exit_code = exit_code,1,1,0.1111111111111111,1428
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG_DIR = os.path.join(os.environ.get('ALLUSERSPROFILE'), 'openstack')",1,1,0.1111111111111111,1429
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def __init__(self, exit_code, stdout, stderr, cmd):",1,1,0.1111111111111111,1430
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if sys.hexversion < 0x3000000:,1,1,0.1111111111111111,1431
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG_FILENAME = os.path.join(LOG_DIR, 'openstack-guest-tools.log')",1,1,0.1111111111111111,1432
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if not os.path.exists(LOG_DIR):,1,1,0.1111111111111111,1433
7a60b5c406336c5f410d1a98868c3f93d888ea0c,LOG_DIR = 'logs',1,1,0.1111111111111111,1434
7a60b5c406336c5f410d1a98868c3f93d888ea0c,LOG_DIR = '/var/log/openstack',1,1,0.1111111111111111,1435
7a60b5c406336c5f410d1a98868c3f93d888ea0c,elif os.path.exists('/usr/sbin/vmware-guestd'):,0,1,0.1111111111111111,1436
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if os.path.exists('/usr/sbin/vmtoolsd'):,0,1,0.1111111111111111,1437
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'MAC;IP;Netmask;Gateway;Broadcast;DNS' where ';' is field separator.,1,1,0.1111111111111111,1438
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"interface_file = open(interface_file_name, 'w')",0,1,0.1111111111111111,1439
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nMACADDR=%s' % mac_address),0,1,0.1111111111111111,1440
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nIPADDR=%s' % ip_address),0,1,0.1111111111111111,1441
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nNETMASK=%s' % subnet_mask),0,1,0.1111111111111111,1442
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nGATEWAY=%s' % gateway),0,1,0.1111111111111111,1443
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nBROADCAST=%s' % broadcast),0,1,0.1111111111111111,1444
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nDEVICE=%s' % adapter_name),0,1,0.1111111111111111,1445
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for network_detail in network_details:,0,1,0.1111111111111111,1446
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"dns_file_name = ""/etc/resolv.conf""",0,1,0.1111111111111111,1447
7a60b5c406336c5f410d1a98868c3f93d888ea0c,all_dns_servers = [],0,1,0.1111111111111111,1448
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _set_rhel_networking(network_details=None):,0,1,0.1111111111111111,1449
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return final_list,0,1,0.1111111111111111,1450
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if entry and entry not in final_list:,0,1,0.1111111111111111,1451
7a60b5c406336c5f410d1a98868c3f93d888ea0c,final_list = [],0,1,0.1111111111111111,1452
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _filter_duplicates(all_entries):,0,1,0.1111111111111111,1453
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if all_dns_servers:,0,1,0.1111111111111111,1454
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"dns_file = open(dns_file_name, 'w')",0,1,0.1111111111111111,1455
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Set IP address for the Linux VM.""""""",0,1,0.1111111111111111,1456
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nbroadcast %s' % broadcast),0,1,0.1111111111111111,1457
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _linux_set_networking():,0,1,0.1111111111111111,1458
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""NIC info %s"") % (device, network_detail))",0,1,0.1111111111111111,1459
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.debug(_(""Successfully configured NIC %d with """,0,1,0.1111111111111111,1460
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\naddress %s\n' % ip_address),0,1,0.1111111111111111,1461
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nnetmask %s' % subnet_mask),0,1,0.1111111111111111,1462
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\ngateway %s' % gateway),0,1,0.1111111111111111,1463
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nauto %s' % adapter_name),0,1,0.1111111111111111,1464
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"dns_file.write(""; generated by OpenStack guest tools"")",0,1,0.1111111111111111,1465
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if adapter_name:,0,1,0.1111111111111111,1466
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"for device, network_detail in enumerate(network_details):",0,1,0.1111111111111111,1467
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file_name = '/etc/network/interfaces',0,1,0.1111111111111111,1468
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _set_ubuntu_networking(network_details=None):,0,1,0.1111111111111111,1469
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"dns_file.write(""\nnameserver %s"" % dns_server)",0,1,0.1111111111111111,1470
7a60b5c406336c5f410d1a98868c3f93d888ea0c,unique_entries = _filter_duplicates(all_dns_servers),0,1,0.1111111111111111,1471
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _parse_network_details(machine_id):,1,1,0.1111111111111111,1472
7a60b5c406336c5f410d1a98868c3f93d888ea0c,Each record is separated by '#' from next record.,1,1,0.1111111111111111,1473
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"cmd = ['netsh', 'interface', 'ip', 'add', 'dns',",0,1,0.1111111111111111,1474
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.debug(_(""Executing command: '%s'"") % cmd)",1,1,0.1111111111111111,1475
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if obj.returncode:,1,1,0.1111111111111111,1476
7a60b5c406336c5f410d1a98868c3f93d888ea0c,result = obj.communicate(),1,1,0.1111111111111111,1477
7a60b5c406336c5f410d1a98868c3f93d888ea0c,result = obj.communicate(process_input),1,1,0.1111111111111111,1478
7a60b5c406336c5f410d1a98868c3f93d888ea0c,result = None,1,1,0.1111111111111111,1479
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"obj = subprocess.Popen(cmd, shell=True, stdin=subprocess.PIPE,",1,1,0.1111111111111111,1480
7a60b5c406336c5f410d1a98868c3f93d888ea0c,env = os.environ.copy(),1,1,0.1111111111111111,1481
7a60b5c406336c5f410d1a98868c3f93d888ea0c,cmd = ' '.join(cmd_list),1,1,0.1111111111111111,1482
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if check_exit_code and obj.returncode != 0:,1,1,0.1111111111111111,1483
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _execute(cmd_list, process_input=None, check_exit_code=True):",1,1,0.1111111111111111,1484
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _get_linux_adapter_name_and_ip_address(mac_address):,1,1,0.1111111111111111,1485
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _get_win_adapter_name_and_ip_address(mac_address):,1,1,0.1111111111111111,1486
7a60b5c406336c5f410d1a98868c3f93d888ea0c,subnet_mask = socket.inet_ntoa(fcntl.ioctl(,1,1,0.1111111111111111,1487
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for adapter_name in adapter_names:,1,1,0.1111111111111111,1488
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"[names.tostring()[n_counter:n_counter + offset1].split('\0', 1)[0]",1,1,0.1111111111111111,1489
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.debug(_(""Result was %s"") % obj.returncode)",1,1,0.1111111111111111,1490
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"(stdout, stderr) = result",1,1,0.1111111111111111,1491
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"outbytes = struct.unpack('iL', fcntl.ioctl(",1,1,0.1111111111111111,1492
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"for network_detail in _parse_network_details(_execute(cmd,",1,1,0.1111111111111111,1493
7a60b5c406336c5f410d1a98868c3f93d888ea0c,final_list = [],1,1,0.1111111111111111,1494
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _filter_duplicates(all_entries):,1,1,0.1111111111111111,1495
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.warn(_(""VMware Tools is not installed""))",1,1,0.1111111111111111,1496
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"cmd = ['netsh', 'interface', 'ip', 'add', 'dns',",1,1,0.1111111111111111,1497
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if dns_server:,1,1,0.1111111111111111,1498
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"cmd = ['netsh', 'interface', 'ip', 'set', 'address',",1,1,0.1111111111111111,1499
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if vmware_tools_bin:,1,1,0.1111111111111111,1500
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"raise ProcessExecutionError(exit_code=obj.returncode,",1,1,0.1111111111111111,1501
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"elif program_files_x86 and os.path.exists(os.path.join(program_files_x86,",1,1,0.1111111111111111,1502
7a60b5c406336c5f410d1a98868c3f93d888ea0c,program_files_x86 = os.environ.get('PROGRAMFILES(X86)'),1,1,0.1111111111111111,1503
7a60b5c406336c5f410d1a98868c3f93d888ea0c,program_files = os.environ.get('PROGRAMFILES'),1,1,0.1111111111111111,1504
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Set IP address for the windows VM.""""""",1,1,0.1111111111111111,1505
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _windows_set_networking():,1,1,0.1111111111111111,1506
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return result,1,1,0.1111111111111111,1507
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"sock.fileno(),",1,1,0.1111111111111111,1508
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"names = array.array('B', '\0' * max_bytes)",1,1,0.1111111111111111,1509
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.debug(_(""Received machine_id from vmtools : %s"") % machine_id[0])",1,1,0.1111111111111111,1510
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_info_list[k + 3].strip(),",1,1,0.1111111111111111,1511
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _get_windows_network_adapters():,1,1,0.1111111111111111,1512
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return network_details,1,1,0.1111111111111111,1513
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.debug(_(""NIC information from vmtools : %s"") % network_details)",1,1,0.1111111111111111,1514
7a60b5c406336c5f410d1a98868c3f93d888ea0c,i += 1,1,1,0.1111111111111111,1515
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_info_list[k + 5].strip().split(',')))",1,1,0.1111111111111111,1516
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_info_list[k + 4].strip(),",1,1,0.1111111111111111,1517
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_info_list[k + 2].strip(),",1,1,0.1111111111111111,1518
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"wbem_service = wbem_locator.ConnectServer('.', 'root\cimv2')",1,1,0.1111111111111111,1519
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_info_list[k + 1].strip(),",1,1,0.1111111111111111,1520
7a60b5c406336c5f410d1a98868c3f93d888ea0c,k = i * 6,1,1,0.1111111111111111,1521
7a60b5c406336c5f410d1a98868c3f93d888ea0c,i = 0,1,1,0.1111111111111111,1522
7a60b5c406336c5f410d1a98868c3f93d888ea0c,no_grps = len(network_info_list) / 6,1,1,0.1111111111111111,1523
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_info_list = machine_id_str.split(';'),1,1,0.1111111111111111,1524
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_details = [],1,1,0.1111111111111111,1525
7a60b5c406336c5f410d1a98868c3f93d888ea0c,wbem_locator = win32com.client.Dispatch('WbemScripting.SWbemLocator'),1,1,0.1111111111111111,1526
7a60b5c406336c5f410d1a98868c3f93d888ea0c,wbem_network_adapters = wbem_service.InstancesOf('Win32_NetworkAdapter'),1,1,0.1111111111111111,1527
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)",1,1,0.1111111111111111,1528
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _get_linux_network_adapters():,1,1,0.1111111111111111,1529
7a60b5c406336c5f410d1a98868c3f93d888ea0c,offset2 = 40,1,1,0.1111111111111111,1530
7a60b5c406336c5f410d1a98868c3f93d888ea0c,offset1 = 16,1,1,0.1111111111111111,1531
7a60b5c406336c5f410d1a98868c3f93d888ea0c,offset2 = 32,1,1,0.1111111111111111,1532
7a60b5c406336c5f410d1a98868c3f93d888ea0c,offset1 = 32,1,1,0.1111111111111111,1533
7a60b5c406336c5f410d1a98868c3f93d888ea0c,arch = platform.architecture()[0],1,1,0.1111111111111111,1534
7a60b5c406336c5f410d1a98868c3f93d888ea0c,max_bytes = 8096,1,1,0.1111111111111111,1535
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'ip-address': ip_address,",1,1,0.1111111111111111,1536
7a60b5c406336c5f410d1a98868c3f93d888ea0c,wbem_network_adapter.NetConnectionStatus == 7:,1,1,0.1111111111111111,1537
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'mac-address': mac_address,",1,1,0.1111111111111111,1538
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_adapters.append({'name': adapter_name,",1,1,0.1111111111111111,1539
7a60b5c406336c5f410d1a98868c3f93d888ea0c,subnet_mask = wbem_network_adapter_config.IPSubnet[0],1,1,0.1111111111111111,1540
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if wbem_network_adapter_config.IPEnabled:,1,1,0.1111111111111111,1541
7a60b5c406336c5f410d1a98868c3f93d888ea0c,subnet_mask = '',1,1,0.1111111111111111,1542
7a60b5c406336c5f410d1a98868c3f93d888ea0c,mac_address = wbem_network_adapter.MacAddress.lower(),1,1,0.1111111111111111,1543
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.warn(_(""VMware Tools is not installed""))",0,1,0.1111111111111111,1544
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if dns_server:,0,1,0.1111111111111111,1545
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return final_list,1,1,0.1111111111111111,1546
7a60b5c406336c5f410d1a98868c3f93d888ea0c,os_type = _get_vm_and_vmdk_attribs(),1,1,0.1111111111111111,1547
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#,0,1,0.1111111111111111,1548
7a60b5c406336c5f410d1a98868c3f93d888ea0c,' network %(network_ref)s.') % locals()),1,1,0.1111111111111111,1549
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"% (str(vm_ref), session_id)",1,1,0.1111111111111111,1550
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"path = ""/console?ref=%s&session_id=%s""\",1,1,0.1111111111111111,1551
7a60b5c406336c5f410d1a98868c3f93d888ea0c,LOG.debug(_('Removing VDI %(vdi_ref)s' +,1,1,0.1111111111111111,1552
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"ip_v4 and ip_v4['ip'] or '',",1,1,0.1111111111111111,1553
7a60b5c406336c5f410d1a98868c3f93d888ea0c,' network %(network_ref)s.') % locals()),0,1,0.1111111111111111,1554
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""",0,1,0.1111111111111111,1555
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_('Creating VIF for VM %(vm_ref)s,'",0,1,0.1111111111111111,1556
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if (instance['auto_disk_config'] and,0,1,0.1111111111111111,1557
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vdi_ref, vm_vdi_rec = _vdi_info",0,1,0.1111111111111111,1558
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"_vdi_info = VMHelper.get_vdi_for_vm_safely(self._session, vm_ref)",0,1,0.1111111111111111,1559
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"template_vm_ref, template_vdi_uuids = _snapshot_info",0,1,0.1111111111111111,1560
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_snapshot_info = self._create_snapshot(instance),0,1,0.1111111111111111,1561
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#         http://www.apache.org/licenses/LICENSE-2.0,0,1,0.1111111111111111,1562
7a60b5c406336c5f410d1a98868c3f93d888ea0c,PLATFORM_WIN = 'win32',0,1,0.1111111111111111,1563
7a60b5c406336c5f410d1a98868c3f93d888ea0c,machine_id_change_spec = vm_util.get_machine_id_change_spec(,0,1,0.1111111111111111,1564
7a60b5c406336c5f410d1a98868c3f93d888ea0c,LOG_DIR = 'logs',0,1,0.1111111111111111,1565
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.stdout = stdout,0,1,0.1111111111111111,1566
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.exit_code = exit_code,0,1,0.1111111111111111,1567
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def __init__(self, exit_code, stdout, stderr, cmd):",0,1,0.1111111111111111,1568
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if sys.hexversion < 0x3000000:,0,1,0.1111111111111111,1569
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG_FILENAME = os.path.join(LOG_DIR, 'openstack-guest-tools.log')",0,1,0.1111111111111111,1570
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if not os.path.exists(LOG_DIR):,0,1,0.1111111111111111,1571
7a60b5c406336c5f410d1a98868c3f93d888ea0c,LOG_DIR = '/var/log/openstack',0,1,0.1111111111111111,1572
7a60b5c406336c5f410d1a98868c3f93d888ea0c,PLATFORM_LINUX = 'linux2',0,1,0.1111111111111111,1573
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG_DIR = os.path.join(os.environ.get('ALLUSERSPROFILE'), 'openstack')",0,1,0.1111111111111111,1574
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"FORMAT = ""%(asctime)s - %(levelname)s - %(message)s""",0,1,0.1111111111111111,1575
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Logging,0,1,0.1111111111111111,1576
7a60b5c406336c5f410d1a98868c3f93d888ea0c,NO_MACHINE_ID = 'No machine id',0,1,0.1111111111111111,1577
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ARCH_64_BIT = '64bit',0,1,0.1111111111111111,1578
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ARCH_32_BIT = '32bit',0,1,0.1111111111111111,1579
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if (version and agent_build and,0,1,0.1111111111111111,1580
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"ip_v4 and ip_v4['netmask'] or '',",0,1,0.1111111111111111,1581
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.cmd = cmd,0,1,0.1111111111111111,1582
7a60b5c406336c5f410d1a98868c3f93d888ea0c,request_mo = self._request_managed_object_builder(,0,1,0.1111111111111111,1583
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"backing_name = ''.join(['ns0:VirtualEthernetCardDistributed',",0,1,0.1111111111111111,1584
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_spec = client_factory.create('ns0:VirtualDeviceConfigSpec'),0,1,0.1111111111111111,1585
7a60b5c406336c5f410d1a98868c3f93d888ea0c,virtual_lsi = client_factory.create('ns0:VirtualLsiLogicController'),0,1,0.1111111111111111,1586
7a60b5c406336c5f410d1a98868c3f93d888ea0c,prop_filter_spec = client_factory.create('ns0:PropertyFilterSpec'),0,1,0.1111111111111111,1587
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"obj_content = get_object_properties(vim, None, mobj, type, [property_name])",0,1,0.1111111111111111,1588
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'Refer readme-vmware to setup'),1,1,0.1111111111111111,1589
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._service_content = self.RetrieveServiceContent(""ServiceInstance"")",0,1,0.1111111111111111,1590
7a60b5c406336c5f410d1a98868c3f93d888ea0c,portgroup = client_factory.create(,0,1,0.1111111111111111,1591
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'Refer readme-vmware to setup'),0,1,0.1111111111111111,1592
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vmwareapi_wsdl_loc_opt = cfg.StrOpt('vmwareapi_wsdl_loc',",0,1,0.1111111111111111,1593
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"scheme, netloc, path, params, query, fragment = _urlparse",0,1,0.1111111111111111,1594
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_urlparse = urlparse.urlparse(base_url),0,1,0.1111111111111111,1595
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if isinstance(managed_object, str):",0,1,0.1111111111111111,1596
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def get_about_info(vim):,0,1,0.1111111111111111,1597
7a60b5c406336c5f410d1a98868c3f93d888ea0c,backing = client_factory.create(backing_name),0,1,0.1111111111111111,1598
7a60b5c406336c5f410d1a98868c3f93d888ea0c,backing = client_factory.create(,0,1,0.1111111111111111,1599
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"ip_v4 and ip_v4['ip'] or '',",0,1,0.1111111111111111,1600
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"image_size, image_properties = _image_info",0,1,0.1111111111111111,1601
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"interface_str = "";"".join([info['mac'],",0,1,0.1111111111111111,1602
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"datastore_name, vmx_file_path = _ds_path",0,1,0.1111111111111111,1603
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_ds_path = vm_util.split_datastore_path(vm_config_pathname),0,1,0.1111111111111111,1604
7a60b5c406336c5f410d1a98868c3f93d888ea0c,os_type) = _get_vm_and_vmdk_attribs(),0,1,0.1111111111111111,1605
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_vmdk_info = vm_util.get_vmdk_file_path_and_adapter_type(,0,1,0.1111111111111111,1606
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_ref = network_utils.get_network_with_the_name(,0,1,0.1111111111111111,1607
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"_image_info = vmware_images.get_vmdk_size_and_properties(context,",0,1,0.1111111111111111,1608
7a60b5c406336c5f410d1a98868c3f93d888ea0c,device.backing.__class__.__name__ ==,0,1,0.1111111111111111,1609
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vmware_vif_driver_opt = cfg.StrOpt('vmware_vif_driver',",0,1,0.1111111111111111,1610
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"== ""VirtualDiskFlatVer2BackingInfo"":",1,1,0.1111111111111111,1611
7a60b5c406336c5f410d1a98868c3f93d888ea0c,device.backing.__class__.__name__ \,1,1,0.1111111111111111,1612
7a60b5c406336c5f410d1a98868c3f93d888ea0c,virtual_machine_config_spec = client_factory.create(,0,1,0.1111111111111111,1613
7a60b5c406336c5f410d1a98868c3f93d888ea0c,disk_file_backing = client_factory.create(,0,1,0.1111111111111111,1614
7a60b5c406336c5f410d1a98868c3f93d888ea0c,create_vmdk_spec = client_factory.create('ns0:FileBackedVirtualDiskSpec'),0,1,0.1111111111111111,1615
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.stderr = stderr,0,1,0.1111111111111111,1616
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def __str__(self):,0,1,0.1111111111111111,1617
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"cmd = ['netsh', 'interface', 'ip', 'set', 'address',",0,1,0.1111111111111111,1618
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for adapter_name in adapter_names:,0,1,0.1111111111111111,1619
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.debug(_(""Executing command: '%s'"") % cmd)",0,1,0.1111111111111111,1620
7a60b5c406336c5f410d1a98868c3f93d888ea0c,cmd = ' '.join(cmd_list),0,1,0.1111111111111111,1621
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _execute(cmd_list, process_input=None, check_exit_code=True):",0,1,0.1111111111111111,1622
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _get_linux_adapter_name_and_ip_address(mac_address):,0,1,0.1111111111111111,1623
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _get_win_adapter_name_and_ip_address(mac_address):,0,1,0.1111111111111111,1624
7a60b5c406336c5f410d1a98868c3f93d888ea0c,subnet_mask = socket.inet_ntoa(fcntl.ioctl(,0,1,0.1111111111111111,1625
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"[names.tostring()[n_counter:n_counter + offset1].split('\0', 1)[0]",0,1,0.1111111111111111,1626
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"obj = subprocess.Popen(cmd, shell=True, stdin=subprocess.PIPE,",0,1,0.1111111111111111,1627
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"sock.fileno(),",0,1,0.1111111111111111,1628
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"outbytes = struct.unpack('iL', fcntl.ioctl(",0,1,0.1111111111111111,1629
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"names = array.array('B', '\0' * max_bytes)",0,1,0.1111111111111111,1630
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)",0,1,0.1111111111111111,1631
7a60b5c406336c5f410d1a98868c3f93d888ea0c,offset2 = 40,0,1,0.1111111111111111,1632
7a60b5c406336c5f410d1a98868c3f93d888ea0c,offset1 = 16,0,1,0.1111111111111111,1633
7a60b5c406336c5f410d1a98868c3f93d888ea0c,env = os.environ.copy(),0,1,0.1111111111111111,1634
7a60b5c406336c5f410d1a98868c3f93d888ea0c,result = None,0,1,0.1111111111111111,1635
7a60b5c406336c5f410d1a98868c3f93d888ea0c,offset1 = 32,0,1,0.1111111111111111,1636
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _windows_set_networking():,0,1,0.1111111111111111,1637
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"for network_detail in _parse_network_details(_execute(cmd,",0,1,0.1111111111111111,1638
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if vmware_tools_bin:,0,1,0.1111111111111111,1639
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"elif program_files_x86 and os.path.exists(os.path.join(program_files_x86,",0,1,0.1111111111111111,1640
7a60b5c406336c5f410d1a98868c3f93d888ea0c,program_files_x86 = os.environ.get('PROGRAMFILES(X86)'),0,1,0.1111111111111111,1641
7a60b5c406336c5f410d1a98868c3f93d888ea0c,program_files = os.environ.get('PROGRAMFILES'),0,1,0.1111111111111111,1642
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Set IP address for the windows VM.""""""",0,1,0.1111111111111111,1643
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return result,0,1,0.1111111111111111,1644
7a60b5c406336c5f410d1a98868c3f93d888ea0c,result = obj.communicate(process_input),0,1,0.1111111111111111,1645
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"raise ProcessExecutionError(exit_code=obj.returncode,",0,1,0.1111111111111111,1646
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"(stdout, stderr) = result",0,1,0.1111111111111111,1647
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if check_exit_code and obj.returncode != 0:,0,1,0.1111111111111111,1648
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.debug(_(""Result was %s"") % obj.returncode)",0,1,0.1111111111111111,1649
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if obj.returncode:,0,1,0.1111111111111111,1650
7a60b5c406336c5f410d1a98868c3f93d888ea0c,result = obj.communicate(),0,1,0.1111111111111111,1651
7a60b5c406336c5f410d1a98868c3f93d888ea0c,offset2 = 32,0,1,0.1111111111111111,1652
7a60b5c406336c5f410d1a98868c3f93d888ea0c,arch = platform.architecture()[0],0,1,0.1111111111111111,1653
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return str(self.exit_code),0,1,0.1111111111111111,1654
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_info_list = machine_id_str.split(';'),0,1,0.1111111111111111,1655
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_info_list[k + 3].strip(),",0,1,0.1111111111111111,1656
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_info_list[k + 2].strip(),",0,1,0.1111111111111111,1657
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_info_list[k + 1].strip(),",0,1,0.1111111111111111,1658
7a60b5c406336c5f410d1a98868c3f93d888ea0c,k = i * 6,0,1,0.1111111111111111,1659
7a60b5c406336c5f410d1a98868c3f93d888ea0c,i = 0,0,1,0.1111111111111111,1660
7a60b5c406336c5f410d1a98868c3f93d888ea0c,no_grps = len(network_info_list) / 6,0,1,0.1111111111111111,1661
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_details = [],0,1,0.1111111111111111,1662
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_info_list[k + 5].strip().split(',')))",0,1,0.1111111111111111,1663
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.debug(_(""Received machine_id from vmtools : %s"") % machine_id[0])",0,1,0.1111111111111111,1664
7a60b5c406336c5f410d1a98868c3f93d888ea0c,Each record is separated by '#' from next record.,0,1,0.1111111111111111,1665
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'MAC;IP;Netmask;Gateway;Broadcast;DNS' where ';' is field separator.,0,1,0.1111111111111111,1666
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _parse_network_details(machine_id):,0,1,0.1111111111111111,1667
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Convert bytes to int.""""""",0,1,0.1111111111111111,1668
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _bytes2int(bytes):,0,1,0.1111111111111111,1669
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_info_list[k + 4].strip(),",0,1,0.1111111111111111,1670
7a60b5c406336c5f410d1a98868c3f93d888ea0c,i += 1,0,1,0.1111111111111111,1671
7a60b5c406336c5f410d1a98868c3f93d888ea0c,max_bytes = 8096,0,1,0.1111111111111111,1672
7a60b5c406336c5f410d1a98868c3f93d888ea0c,subnet_mask = '',0,1,0.1111111111111111,1673
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _get_linux_network_adapters():,0,1,0.1111111111111111,1674
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'ip-address': ip_address,",0,1,0.1111111111111111,1675
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'mac-address': mac_address,",0,1,0.1111111111111111,1676
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_adapters.append({'name': adapter_name,",0,1,0.1111111111111111,1677
7a60b5c406336c5f410d1a98868c3f93d888ea0c,subnet_mask = wbem_network_adapter_config.IPSubnet[0],0,1,0.1111111111111111,1678
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if wbem_network_adapter_config.IPEnabled:,0,1,0.1111111111111111,1679
7a60b5c406336c5f410d1a98868c3f93d888ea0c,mac_address = wbem_network_adapter.MacAddress.lower(),0,1,0.1111111111111111,1680
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.debug(_(""NIC information from vmtools : %s"") % network_details)",0,1,0.1111111111111111,1681
7a60b5c406336c5f410d1a98868c3f93d888ea0c,wbem_network_adapter.NetConnectionStatus == 7:,0,1,0.1111111111111111,1682
7a60b5c406336c5f410d1a98868c3f93d888ea0c,wbem_network_adapters = wbem_service.InstancesOf('Win32_NetworkAdapter'),0,1,0.1111111111111111,1683
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"wbem_service = wbem_locator.ConnectServer('.', 'root\cimv2')",0,1,0.1111111111111111,1684
7a60b5c406336c5f410d1a98868c3f93d888ea0c,wbem_locator = win32com.client.Dispatch('WbemScripting.SWbemLocator'),0,1,0.1111111111111111,1685
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _get_windows_network_adapters():,0,1,0.1111111111111111,1686
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return network_details,0,1,0.1111111111111111,1687
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if entry and entry not in final_list:,1,1,0.1111111111111111,1688
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"ip_v4 and ip_v4['netmask'] or '',",1,1,0.1111111111111111,1689
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _set_rhel_networking(network_details=None):,1,1,0.1111111111111111,1690
7a60b5c406336c5f410d1a98868c3f93d888ea0c,task_info.result.file[0].path == file_name),0,1,0.1111111111111111,1691
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if not folder_exists:,0,1,0.1111111111111111,1692
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"folder_exists, file_exists = self._path_file_exists(ds_browser,",0,1,0.1111111111111111,1693
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"folder_path = vm_util.build_datastore_path(ds_name, folder_name)",0,1,0.1111111111111111,1694
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ds_browser = vim_util.get_dynamic_property(,0,1,0.1111111111111111,1695
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _check_if_folder_file_exists(self, ds_ref, ds_name,",0,1,0.1111111111111111,1696
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return True, file_exists",0,1,0.1111111111111111,1697
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"file_exists = (getattr(task_info.result, 'file', False) and",0,1,0.1111111111111111,1698
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _volume_in_mapping(mount_device, block_device_info):",0,1,0.1111111111111111,1699
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return False, False",0,1,0.1111111111111111,1700
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if task_info.state in ['queued', 'running']:",0,1,0.1111111111111111,1701
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"search_spec = vm_util.search_datastore_spec(client_factory, file_name)",0,1,0.1111111111111111,1702
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _path_file_exists(self, ds_browser, ds_path, file_name):",0,1,0.1111111111111111,1703
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return vm_folder_ref, res_pool_ref",0,1,0.1111111111111111,1704
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vm_folder_ref = dc_objs[0].propSet[0].val,0,1,0.1111111111111111,1705
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return file_exists,0,1,0.1111111111111111,1706
7a60b5c406336c5f410d1a98868c3f93d888ea0c,block_device_list = [block_device.strip_dev(vol['mount_device']),0,1,0.1111111111111111,1707
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return None,0,1,0.1111111111111111,1708
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _get_datastore_ref():,1,1,0.1111111111111111,1709
7a60b5c406336c5f410d1a98868c3f93d888ea0c,data_store_name = ds_name,1,1,0.1111111111111111,1710
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Local storage identifier,1,1,0.1111111111111111,1711
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ds_name = prop.val,1,1,0.1111111111111111,1712
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ds_type = prop.val,1,1,0.1111111111111111,1713
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ds_type = None,1,1,0.1111111111111111,1714
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ds_name = None,1,1,0.1111111111111111,1715
7a60b5c406336c5f410d1a98868c3f93d888ea0c,raise exception.InstanceExists(name=instance.name),1,1,0.1111111111111111,1716
7a60b5c406336c5f410d1a98868c3f93d888ea0c,swap = driver.block_device_info_get_swap(block_device_info),0,1,0.1111111111111111,1717
7a60b5c406336c5f410d1a98868c3f93d888ea0c,6. Power on the VM.,1,1,0.1111111111111111,1718
7a60b5c406336c5f410d1a98868c3f93d888ea0c,the metadata .vmdk file.,1,1,0.1111111111111111,1719
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def __init__(self, session):",1,1,0.1111111111111111,1720
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return block_device.strip_dev(mount_device) in block_device_list,0,1,0.1111111111111111,1721
7a60b5c406336c5f410d1a98868c3f93d888ea0c,block_device_list += [block_device.strip_dev(ephemeral['device_name']),0,1,0.1111111111111111,1722
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if driver.swap_is_usable(swap):,0,1,0.1111111111111111,1723
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _get_vmfolder_and_res_pool_refs(self):,0,1,0.1111111111111111,1724
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return host.obj,0,1,0.1111111111111111,1725
7a60b5c406336c5f410d1a98868c3f93d888ea0c,raise exception.NovaException(msg),1,1,0.1111111111111111,1726
7a60b5c406336c5f410d1a98868c3f93d888ea0c,instance_name = self._get_orig_vm_name_label(instance),0,1,0.1111111111111111,1727
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vm_migrate_task = self._session._call_method(,0,1,0.1111111111111111,1728
7a60b5c406336c5f410d1a98868c3f93d888ea0c,raise exception.InstanceNotFound(instance_id=instance_ref.name),0,1,0.1111111111111111,1729
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def live_migration(self, context, instance_ref, dest,",0,1,0.1111111111111111,1730
7a60b5c406336c5f410d1a98868c3f93d888ea0c,raise exception.InstanceNotFound(instance_id=name_label),0,1,0.1111111111111111,1731
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# The original vm was suffixed with '-orig'; find it using,0,1,0.1111111111111111,1732
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.warn(_(""In vmwareapi:vmops:confirm_migration, got this """,0,1,0.1111111111111111,1733
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vm_clone_task = self._session._call_method(,0,1,0.1111111111111111,1734
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ctxt = nova_context.get_admin_context(),0,1,0.1111111111111111,1735
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"clone_spec = vm_util.clone_vm_spec(client_factory, rel_spec)",0,1,0.1111111111111111,1736
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"rel_spec = vm_util.relocate_vm_spec(client_factory, ds_ref, host_ref)",0,1,0.1111111111111111,1737
7a60b5c406336c5f410d1a98868c3f93d888ea0c,client_factory = self._session._get_vim().client.factory,0,1,0.1111111111111111,1738
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ds_ref = vm_util.get_datastore_ref_and_name(self._session)[0],0,1,0.1111111111111111,1739
7a60b5c406336c5f410d1a98868c3f93d888ea0c,rename_task = self._session._call_method(,0,1,0.1111111111111111,1740
7a60b5c406336c5f410d1a98868c3f93d888ea0c,name_label = self._get_orig_vm_name_label(instance),0,1,0.1111111111111111,1741
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def poll_rebooting_instances(self, timeout, instances):",0,1,0.1111111111111111,1742
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"instances_info = dict(instance_count=len(instances),",0,1,0.1111111111111111,1743
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for host in host_objs:,0,1,0.1111111111111111,1744
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _get_vnc_port(vm_ref):,0,1,0.1111111111111111,1745
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _get_host_ref_from_name(self, host_name):",0,1,0.1111111111111111,1746
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _get_datacenter_ref_and_name(self):,0,1,0.1111111111111111,1747
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""port - %(port)s"") % {'port': port},",0,1,0.1111111111111111,1748
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vnc_config_spec = vm_util.get_vnc_config_spec(,0,1,0.1111111111111111,1749
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return port,0,1,0.1111111111111111,1750
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_id = int(vm_ref.value.replace('vm-', ''))",0,1,0.1111111111111111,1751
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return {'host': CONF.vmwareapi_host_ip,",0,1,0.1111111111111111,1752
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if instances_info[""instance_count""] > 0:",0,1,0.1111111111111111,1753
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Return connection info for a vnc console.""""""",0,1,0.1111111111111111,1754
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self.compute_api.reboot(ctxt, instance, ""HARD"")",0,1,0.1111111111111111,1755
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.info(_(""Automatically hard rebooting %d"") % instance['uuid'])",0,1,0.1111111111111111,1756
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for instance in instances:,0,1,0.1111111111111111,1757
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""older than %(timeout)d seconds"") % instances_info)",0,1,0.1111111111111111,1758
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.info(_(""Found %(instance_count)d hung reboots """,0,1,0.1111111111111111,1759
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return data_store_name,1,1,0.1111111111111111,1760
7a60b5c406336c5f410d1a98868c3f93d888ea0c,data_store_name = _get_datastore_ref(),1,1,0.1111111111111111,1761
7a60b5c406336c5f410d1a98868c3f93d888ea0c,host_ref = self._get_host_ref_from_name(dest),0,1,0.1111111111111111,1762
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._host_password = password,0,1,0.1111111111111111,1763
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"raise Exception(_(""Must specify vmwareapi_host_ip,""",1,1,0.1111111111111111,1764
7a60b5c406336c5f410d1a98868c3f93d888ea0c,api_retry_count = CONF.vmware.api_retry_count,1,1,0.1111111111111111,1765
7a60b5c406336c5f410d1a98868c3f93d888ea0c,host_password = CONF.vmware.host_password,1,1,0.1111111111111111,1766
7a60b5c406336c5f410d1a98868c3f93d888ea0c,host_username = CONF.vmware.host_username,1,1,0.1111111111111111,1767
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if self.vim:,0,1,0.1111111111111111,1768
7a60b5c406336c5f410d1a98868c3f93d888ea0c,delay = 1,0,1,0.1111111111111111,1769
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._host_username = username,0,1,0.1111111111111111,1770
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""and vmwareapi_host_password to use""",1,1,0.1111111111111111,1771
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def __init__(self, host_ip=CONF.vmware.host_ip,",0,1,0.1111111111111111,1772
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._session = VMwareAPISession(scheme=scheme),0,1,0.1111111111111111,1773
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""host_username """,0,1,0.1111111111111111,1774
7a60b5c406336c5f410d1a98868c3f93d888ea0c,CONF.vmware.host_password is None):,0,1,0.1111111111111111,1775
7a60b5c406336c5f410d1a98868c3f93d888ea0c,raise exception.InstanceNotFound(instance_id=instance_ref.name),1,1,0.1111111111111111,1776
7a60b5c406336c5f410d1a98868c3f93d888ea0c,raise exception.InstanceNotFound(instance_id=instance['name']),1,1,0.1111111111111111,1777
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""vmwareapi_host_username """,1,1,0.1111111111111111,1778
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._session = VMwareAPISession(self._host_ip,",1,1,0.1111111111111111,1779
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return,1,1,0.1111111111111111,1780
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def get_dynamic_properties(vim, mobj, type, property_names):",0,1,0.1111111111111111,1781
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return property_dict,0,1,0.1111111111111111,1782
7a60b5c406336c5f410d1a98868c3f93d888ea0c,all_dns_servers = [],1,1,0.1111111111111111,1783
7a60b5c406336c5f410d1a98868c3f93d888ea0c,property_dict[prop.name] = prop.val,0,1,0.1111111111111111,1784
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if dynamic_properties:,0,1,0.1111111111111111,1785
7a60b5c406336c5f410d1a98868c3f93d888ea0c,dynamic_properties = obj_content.objects[0].propSet,0,1,0.1111111111111111,1786
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"obj_content = get_object_properties(vim, None, mobj, type, property_names)",0,1,0.1111111111111111,1787
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return property_dict.get(property_name),0,1,0.1111111111111111,1788
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._host_username = host_username,1,1,0.1111111111111111,1789
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"property_dict = get_dynamic_properties(vim, mobj, type, [property_name])",0,1,0.1111111111111111,1790
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if utils.is_valid_ipv6(host):,0,1,0.1111111111111111,1791
7a60b5c406336c5f410d1a98868c3f93d888ea0c,raise exception.NovaException(excep),1,1,0.1111111111111111,1792
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.critical(_(""In vmwareapi:_create_session, """,1,1,0.1111111111111111,1793
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.api_retry_count = api_retry_count,1,1,0.1111111111111111,1794
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._host_password = host_password,1,1,0.1111111111111111,1795
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"rescue_vm_ref = vm_util.get_vm_ref_from_name(self._session,",1,1,0.1111111111111111,1796
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"name=""%s-snapshot"" % instance['name'],",1,1,0.1111111111111111,1797
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _get_vmfolder_and_res_pool_mors():,1,1,0.1111111111111111,1798
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""%(data_store_name)s"") %",1,1,0.1111111111111111,1799
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""",1,1,0.1111111111111111,1800
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _attach_vmdk_to_the_vm():,1,1,0.1111111111111111,1801
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""data store %(data_store_name)s"") %",1,1,0.1111111111111111,1802
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# above,1,1,0.1111111111111111,1803
7a60b5c406336c5f410d1a98868c3f93d888ea0c,cookies = self._session._get_vim().client.options.transport.cookiejar,1,1,0.1111111111111111,1804
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _delete_disk_file():,1,1,0.1111111111111111,1805
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""%(vmdk_file_size_in_kb)s KB and adapter type  """,1,1,0.1111111111111111,1806
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmdk_attach_config_spec = vm_util.get_vmdk_attach_config_spec(,1,1,0.1111111111111111,1807
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"uploaded_vmdk_path = vm_util.build_datastore_path(data_store_name,",1,1,0.1111111111111111,1808
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"flat_uploaded_vmdk_path = vm_util.build_datastore_path(data_store_name,",1,1,0.1111111111111111,1809
7a60b5c406336c5f410d1a98868c3f93d888ea0c,instance.name),1,1,0.1111111111111111,1810
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_folder_mor, res_pool_mor = _get_vmfolder_and_res_pool_mors()",1,1,0.1111111111111111,1811
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return vm_folder_mor, res_pool_mor",1,1,0.1111111111111111,1812
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vm_folder_mor = dc_objs[0].propSet[0].val,1,1,0.1111111111111111,1813
7a60b5c406336c5f410d1a98868c3f93d888ea0c,to do so.,1,1,0.1111111111111111,1814
7a60b5c406336c5f410d1a98868c3f93d888ea0c,reconfig_task = self._session._call_method(,1,1,0.1111111111111111,1815
7a60b5c406336c5f410d1a98868c3f93d888ea0c,raise exception.InstanceNotFound(instance_id=instance['uuid']),1,1,0.1111111111111111,1816
7a60b5c406336c5f410d1a98868c3f93d888ea0c,upload_folder = instance['uuid'],0,1,0.1111111111111111,1817
7a60b5c406336c5f410d1a98868c3f93d888ea0c,upload_folder = instance['name'],1,1,0.1111111111111111,1818
7a60b5c406336c5f410d1a98868c3f93d888ea0c,raise exception.InstanceExists(name=instance['name']),1,1,0.1111111111111111,1819
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if vm_ref:,1,1,0.1111111111111111,1820
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"rescue_vm_ref = vm_util.get_vm_ref_from_name(self._session,",0,1,0.1111111111111111,1821
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"rescue_vm_ref = vm_util.get_vm_ref_from_uuid(self._session,",0,1,0.1111111111111111,1822
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"name=""%s-snapshot"" % instance['uuid'],",0,1,0.1111111111111111,1823
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return None,1,1,0.1111111111111111,1824
7a60b5c406336c5f410d1a98868c3f93d888ea0c,raise exception.InstanceNotFound(instance_id=instance.id),1,1,0.1111111111111111,1825
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return vm.obj,1,1,0.1111111111111111,1826
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def _get_vm_ref_from_the_name(self, vm_name):",1,1,0.1111111111111111,1827
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _get_datacenter_name_and_ref(self):,1,1,0.1111111111111111,1828
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""VM was already in suspended state. So returning """,1,1,0.1111111111111111,1829
7a60b5c406336c5f410d1a98868c3f93d888ea0c,dc_ref = self._get_datacenter_name_and_ref()[0],1,1,0.1111111111111111,1830
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"name=""%s-snapshot"" % instance.name,",1,1,0.1111111111111111,1831
7a60b5c406336c5f410d1a98868c3f93d888ea0c,raise exception.HostNotFound(host=dest),0,1,0.1111111111111111,1832
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"delay = min(2 * delay, 60)",0,1,0.1111111111111111,1833
7a60b5c406336c5f410d1a98868c3f93d888ea0c,raise exception.InstanceNotFound(instance_id=instance['name']),0,1,0.1111111111111111,1834
7a60b5c406336c5f410d1a98868c3f93d888ea0c,name_and_ip = _get_win_adapter_name_and_ip_address(mac_address),0,1,0.1111111111111111,1835
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"[names.tostring()[n_counter:n_counter + offset1].split('\0', 1)[0]",1,1,0.1111111111111111,1836
7a60b5c406336c5f410d1a98868c3f93d888ea0c,subnet_mask = wbem_network_adapter_config.IPSubnet[0],1,1,0.1111111111111111,1837
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if wbem_network_adapter_config.IPEnabled:,1,1,0.1111111111111111,1838
7a60b5c406336c5f410d1a98868c3f93d888ea0c,mac_address = wbem_network_adapter.MacAddress.lower(),1,1,0.1111111111111111,1839
7a60b5c406336c5f410d1a98868c3f93d888ea0c,wbem_network_adapter.NetConnectionStatus == 7:,1,1,0.1111111111111111,1840
7a60b5c406336c5f410d1a98868c3f93d888ea0c,name_and_ip = _get_linux_adapter_name_and_ip_address(mac_address),0,1,0.1111111111111111,1841
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"(mac_address, ip_address, subnet_mask, gateway, broadcast,",0,1,0.1111111111111111,1842
7a60b5c406336c5f410d1a98868c3f93d888ea0c,RESIZE_TOTAL_STEPS = 4,0,1,0.1111111111111111,1843
7a60b5c406336c5f410d1a98868c3f93d888ea0c,subnet_mask = config.IPSubnet[0],0,1,0.1111111111111111,1844
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if config.IPEnabled:,0,1,0.1111111111111111,1845
7a60b5c406336c5f410d1a98868c3f93d888ea0c,config = adapter.associators_(,0,1,0.1111111111111111,1846
7a60b5c406336c5f410d1a98868c3f93d888ea0c,mac_address = adapter.MacAddress.lower(),0,1,0.1111111111111111,1847
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter.NetConnectionStatus == 7):,0,1,0.1111111111111111,1848
7a60b5c406336c5f410d1a98868c3f93d888ea0c,pltfrm = sys.platform,1,1,0.1111111111111111,1849
7a60b5c406336c5f410d1a98868c3f93d888ea0c,VMWARE_PREFIX = 'vmware',0,1,0.1111111111111111,1850
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"def __init__(self, session, virtapi, volumeops):",0,1,0.1111111111111111,1851
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if(platform.dist()[0] == 'Ubuntu'):,1,1,0.1111111111111111,1852
7a60b5c406336c5f410d1a98868c3f93d888ea0c,5. Power on the VM.,0,1,0.1111111111111111,1853
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"return vmdk_file_size_in_kb, os_type, adapter_type, disk_type",0,1,0.1111111111111111,1854
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"disk_type = image_properties.get(""vmware_disktype"",",0,1,0.1111111111111111,1855
7a60b5c406336c5f410d1a98868c3f93d888ea0c,data_store_name = ds[1],0,1,0.1111111111111111,1856
7a60b5c406336c5f410d1a98868c3f93d888ea0c,data_store_ref = ds[0],0,1,0.1111111111111111,1857
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ds = vm_util.get_datastore_ref_and_name(self._session),0,1,0.1111111111111111,1858
7a60b5c406336c5f410d1a98868c3f93d888ea0c,raise exception.InstanceExists(name=instance['name']),0,1,0.1111111111111111,1859
7a60b5c406336c5f410d1a98868c3f93d888ea0c,3.3. Delete the -sparse.vmdk file.,0,1,0.1111111111111111,1860
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.compute_api = compute.API(),0,1,0.1111111111111111,1861
7a60b5c406336c5f410d1a98868c3f93d888ea0c,the metadata .vmdk file.,0,1,0.1111111111111111,1862
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._poll_rescue_last_ran = None,0,1,0.1111111111111111,1863
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._rescue_suffix = '-rescue',0,1,0.1111111111111111,1864
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._default_root_device = 'vda',0,1,0.1111111111111111,1865
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._volumeops = volumeops,0,1,0.1111111111111111,1866
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._virtapi = virtapi,0,1,0.1111111111111111,1867
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.warn(_(""Distro '%s' not supported"") % platform.dist()[0])",1,1,0.1111111111111111,1868
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"# TODO(sateesh): For other distros like suse, debian, BSD, etc.",1,1,0.1111111111111111,1869
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_folder_ref, res_pool_ref = self._get_vmfolder_and_res_pool_refs()",0,1,0.1111111111111111,1870
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nIPADDR=%s' % ip_address),1,1,0.1111111111111111,1871
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"dns_file.write(""\nnameserver %s"" % dns_server)",1,1,0.1111111111111111,1872
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"dns_file.write(""; generated by OpenStack guest tools"")",1,1,0.1111111111111111,1873
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"dns_file = open(dns_file_name, 'w')",1,1,0.1111111111111111,1874
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"dns_file_name = ""/etc/resolv.conf""",1,1,0.1111111111111111,1875
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if all_dns_servers:,1,1,0.1111111111111111,1876
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nMACADDR=%s' % mac_address),1,1,0.1111111111111111,1877
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nNETMASK=%s' % subnet_mask),1,1,0.1111111111111111,1878
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file_name = '/etc/network/interfaces',1,1,0.1111111111111111,1879
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nGATEWAY=%s' % gateway),1,1,0.1111111111111111,1880
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nBROADCAST=%s' % broadcast),1,1,0.1111111111111111,1881
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nDEVICE=%s' % adapter_name),1,1,0.1111111111111111,1882
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for network_detail in network_details:,1,1,0.1111111111111111,1883
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._update_instance_progress(context, instance,",0,1,0.1111111111111111,1884
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"interface_file = open(interface_file_name, 'w')",1,1,0.1111111111111111,1885
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _set_ubuntu_networking(network_details=None):,1,1,0.1111111111111111,1886
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"for device, network_detail in enumerate(network_details):",1,1,0.1111111111111111,1887
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_details = _parse_network_details(_execute(cmd,",1,1,0.1111111111111111,1888
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _linux_set_networking():,1,1,0.1111111111111111,1889
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"cmd = [vmware_tools_bin, '--cmd', 'machine.id.get']",1,1,0.1111111111111111,1890
7a60b5c406336c5f410d1a98868c3f93d888ea0c,elif os.path.exists('/usr/bin/vmware-guestd'):,1,1,0.1111111111111111,1891
7a60b5c406336c5f410d1a98868c3f93d888ea0c,elif os.path.exists('/usr/sbin/vmware-guestd'):,1,1,0.1111111111111111,1892
7a60b5c406336c5f410d1a98868c3f93d888ea0c,elif os.path.exists('/usr/bin/vmtoolsd'):,1,1,0.1111111111111111,1893
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if os.path.exists('/usr/sbin/vmtoolsd'):,1,1,0.1111111111111111,1894
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Set IP address for the Linux VM.""""""",1,1,0.1111111111111111,1895
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""NIC info %s"") % (device, network_detail))",1,1,0.1111111111111111,1896
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if adapter_name:,1,1,0.1111111111111111,1897
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.debug(_(""Successfully configured NIC %d with """,1,1,0.1111111111111111,1898
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\naddress %s\n' % ip_address),1,1,0.1111111111111111,1899
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nnetmask %s' % subnet_mask),1,1,0.1111111111111111,1900
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\ngateway %s' % gateway),1,1,0.1111111111111111,1901
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nbroadcast %s' % broadcast),1,1,0.1111111111111111,1902
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nauto %s' % adapter_name),1,1,0.1111111111111111,1903
7a60b5c406336c5f410d1a98868c3f93d888ea0c,disk_type) = _get_image_properties(),0,1,0.1111111111111111,1904
7a60b5c406336c5f410d1a98868c3f93d888ea0c,unique_entries = _filter_duplicates(all_dns_servers),1,1,0.1111111111111111,1905
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return vif_infos,0,1,0.1111111111111111,1906
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""",0,1,0.1111111111111111,1907
7a60b5c406336c5f410d1a98868c3f93d888ea0c,instance_orig_name = instance['name'],0,1,0.1111111111111111,1908
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Unrescue the specified instance.""""""",0,1,0.1111111111111111,1909
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"rescue_vm_ref, instance,",0,1,0.1111111111111111,1910
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"rescue_vm_ref = vm_util.get_vm_ref_from_name(self._session,",0,1,0.1111111111111111,1911
7a60b5c406336c5f410d1a98868c3f93d888ea0c,= vm_util.get_vmdk_path_and_adapter_type(hardware_devices),0,1,0.1111111111111111,1912
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vmdk_path, controller_key, adapter_type, disk_type, unit_number \",0,1,0.1111111111111111,1913
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self.spawn(context, instance, image_meta, network_info)",0,1,0.1111111111111111,1914
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Rescue the specified instance.",0,1,0.1111111111111111,1915
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""VM was already in suspended state. So returning """,0,1,0.1111111111111111,1916
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if network_info:,0,1,0.1111111111111111,1917
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"except Exception, excep:",0,1,0.1111111111111111,1918
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Destroyed the VM""), instance=instance)",0,1,0.1111111111111111,1919
7a60b5c406336c5f410d1a98868c3f93d888ea0c,destroy_task = self._session._call_method(,0,1,0.1111111111111111,1920
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Destroying the VM""), instance=instance)",0,1,0.1111111111111111,1921
7a60b5c406336c5f410d1a98868c3f93d888ea0c,return,0,1,0.1111111111111111,1922
7a60b5c406336c5f410d1a98868c3f93d888ea0c,instance['name'] = instance_orig_name,0,1,0.1111111111111111,1923
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Power off the specified instance.""""""",0,1,0.1111111111111111,1924
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Only PoweredOn VMs can be powered off.,0,1,0.1111111111111111,1925
7a60b5c406336c5f410d1a98868c3f93d888ea0c,poweron_task = self._session._call_method(,0,1,0.1111111111111111,1926
7a60b5c406336c5f410d1a98868c3f93d888ea0c,instance_uuid = instance['uuid'],0,1,0.1111111111111111,1927
7a60b5c406336c5f410d1a98868c3f93d888ea0c,progress = round(float(step) / total_steps * 100),0,1,0.1111111111111111,1928
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if CONF.vnc_enabled:,0,1,0.1111111111111111,1929
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Updating instance '%(instance_uuid)s' progress to""",0,1,0.1111111111111111,1930
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#,0,1,0.1111111111111111,1931
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Powered on the VM""), instance=instance)",0,1,0.1111111111111111,1932
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Powering on the VM""), instance=instance)",0,1,0.1111111111111111,1933
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Powering off the VM""), instance=instance)",0,1,0.1111111111111111,1934
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# Only PoweredOff and Suspended VMs can be powered on.,0,1,0.1111111111111111,1935
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Power on the specified instance.""""""",0,1,0.1111111111111111,1936
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""VM was already in powered off state. So returning """,0,1,0.1111111111111111,1937
7a60b5c406336c5f410d1a98868c3f93d888ea0c,raise exception.InstancePowerOffFailure(reason=reason),0,1,0.1111111111111111,1938
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Powered off the VM""), instance=instance)",0,1,0.1111111111111111,1939
7a60b5c406336c5f410d1a98868c3f93d888ea0c,poweroff_task = self._session._call_method(,0,1,0.1111111111111111,1940
7a60b5c406336c5f410d1a98868c3f93d888ea0c,2. Destroy the VM.,0,1,0.1111111111111111,1941
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""VM was already in powered on state. So returning """,0,1,0.1111111111111111,1942
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"name=""%s-snapshot"" % instance['name'],",0,1,0.1111111111111111,1943
7a60b5c406336c5f410d1a98868c3f93d888ea0c,upload_name = instance['image_ref'],0,1,0.1111111111111111,1944
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if linked_clone:,0,1,0.1111111111111111,1945
7a60b5c406336c5f410d1a98868c3f93d888ea0c,linked_clone = CONF.use_linked_clone,0,1,0.1111111111111111,1946
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if not ebs_root:,0,1,0.1111111111111111,1947
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"ebs_root = self._volume_in_mapping(self._default_root_device,",0,1,0.1111111111111111,1948
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Copied Virtual Disk of size %(vmdk_file_size_in_kb)s""",0,1,0.1111111111111111,1949
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmdk_copy_task = self._session._call_method(,0,1,0.1111111111111111,1950
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vmdk_copy_spec = vm_util.get_vmdk_create_spec(client_factory,",0,1,0.1111111111111111,1951
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# storage adapter type.,0,1,0.1111111111111111,1952
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# we just created above,0,1,0.1111111111111111,1953
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _delete_disk_file(vmdk_path):,0,1,0.1111111111111111,1954
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vnc_port = self._get_vnc_port(vm_ref),0,1,0.1111111111111111,1955
7a60b5c406336c5f410d1a98868c3f93d888ea0c,raise exception.InstanceNotFound(instance_id=instance['uuid']),0,1,0.1111111111111111,1956
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._set_vnc_config(client_factory, instance, vnc_port, vnc_pass)",0,1,0.1111111111111111,1957
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""%(data_store_name)s"") %",0,1,0.1111111111111111,1958
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""%(vmdk_file_size_in_kb)s KB and adapter type """,0,1,0.1111111111111111,1959
7a60b5c406336c5f410d1a98868c3f93d888ea0c,upload_folder = self._instance_path_base,0,1,0.1111111111111111,1960
7a60b5c406336c5f410d1a98868c3f93d888ea0c,def _copy_virtual_disk():,0,1,0.1111111111111111,1961
7a60b5c406336c5f410d1a98868c3f93d888ea0c,upload_folder = instance['name'],0,1,0.1111111111111111,1962
7a60b5c406336c5f410d1a98868c3f93d888ea0c,sparse_uploaded_vmdk_path = vm_util.build_datastore_path(,0,1,0.1111111111111111,1963
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_ref, instance,",0,1,0.1111111111111111,1964
7a60b5c406336c5f410d1a98868c3f93d888ea0c,upload_name = instance['name'],0,1,0.1111111111111111,1965
7a60b5c406336c5f410d1a98868c3f93d888ea0c,root_disk = driver.block_device_info_get_mapping(,0,1,0.1111111111111111,1966
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"disk_type = ""thin""",0,1,0.1111111111111111,1967
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"if disk_type != ""sparse"":",0,1,0.1111111111111111,1968
7a60b5c406336c5f410d1a98868c3f93d888ea0c,dc_ref = self._get_datacenter_ref_and_name()[0],0,1,0.1111111111111111,1969
7a60b5c406336c5f410d1a98868c3f93d888ea0c,# linked clone base disk exists,0,1,0.1111111111111111,1970
7a60b5c406336c5f410d1a98868c3f93d888ea0c,connection_info = root_disk['connection_info'],0,1,0.1111111111111111,1971
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"uploaded_vmdk_path = vm_util.build_datastore_path(data_store_name,",0,1,0.1111111111111111,1972
7a60b5c406336c5f410d1a98868c3f93d888ea0c,flat_uploaded_vmdk_path = vm_util.build_datastore_path(,0,1,0.1111111111111111,1973
7a60b5c406336c5f410d1a98868c3f93d888ea0c,if not (linked_clone and self._check_if_folder_file_exists(,0,1,0.1111111111111111,1974
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"upload_folder, upload_name + "".vmdk"")):",0,1,0.1111111111111111,1975
7a60b5c406336c5f410d1a98868c3f93d888ea0c,instance=instance),1,0,0.0,1976
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""CreateSnapshot_Task"", vm_ref,",1,0,0.0,1977
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""RemoveSnapshot_Task"", snapshot,",0,0,0.0,1978
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._session._get_vim(),",1,0,0.0,1979
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"removeChildren=False, consolidate=True)",0,0,0.0,1980
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._session._wait_for_task(delete_snapshot_task),0,0,0.0,1981
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_('Copied snapshotted disk %s.'),",0,0,0.0,1982
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vmdk_file_path_before_snapshot,",0,0,0.0,1983
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"memory=False,",1,0,0.0,1984
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_('Copying snapshotted disk %s.'),",0,0,0.0,1985
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._delete_vm_snapshot(instance, vm_ref, snapshot)",0,0,0.0,1986
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for vm in retrieve_result.objects:,0,0,0.0,1987
7a60b5c406336c5f410d1a98868c3f93d888ea0c,quiesce=True),1,0,0.0,1988
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._session._wait_for_task(snapshot_task),1,0,0.0,1989
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_create_vm_snapshot(),1,0,0.0,1990
7a60b5c406336c5f410d1a98868c3f93d888ea0c,while retrieve_result:,0,0,0.0,1991
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for prop in vm.propSet:,0,0,0.0,1992
7a60b5c406336c5f410d1a98868c3f93d888ea0c,lst_vm_names.append(vm_name),0,0,0.0,1993
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""continue_to_get_objects"",",0,0,0.0,1994
7a60b5c406336c5f410d1a98868c3f93d888ea0c,token),0,0,0.0,1995
7a60b5c406336c5f410d1a98868c3f93d888ea0c,else:,0,0,0.0,1996
7a60b5c406336c5f410d1a98868c3f93d888ea0c,break,0,0,0.0,1997
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""get_dynamic_property"",",0,0,0.0,1998
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vim_util, 'get_inner_objects', root_res_pool, 'vm',",0,0,0.0,1999
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._cluster),0,0,0.0,2000
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'ClusterComputeResource', 'resourcePool')",0,0,0.0,2001
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vim_util, ""get_dynamic_property"", self._cluster,",0,0,0.0,2002
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"snapshot_task, ""Task"", ""info"")",0,0,0.0,2003
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Creating directory with path %s""), ds_path)",0,0,0.0,2004
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._session._wait_for_task(snapshot_task),0,0,0.0,2005
7a60b5c406336c5f410d1a98868c3f93d888ea0c,quiesce=True),0,0,0.0,2006
7a60b5c406336c5f410d1a98868c3f93d888ea0c,spec=cdrom_attach_config_spec),0,0,0.0,2007
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"(vmdk_file_path_before_snapshot, adapter_type,",0,0,0.0,2008
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"hw_devices, uuid=instance['uuid'])",0,0,0.0,2009
7a60b5c406336c5f410d1a98868c3f93d888ea0c,while vms:,1,0,0.0,2010
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"(vmdk_path, adapter_type,",0,0,0.0,2011
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"adapter_type, disk_type, vmdk_path)",0,0,0.0,2012
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"uploaded_iso_path,",1,0,0.0,2013
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"datastore, file_path,",1,0,0.0,2014
7a60b5c406336c5f410d1a98868c3f93d888ea0c,cdrom_unit_number):,1,0,0.0,2015
7a60b5c406336c5f410d1a98868c3f93d888ea0c,cdrom_unit_number),1,0,0.0,2016
7a60b5c406336c5f410d1a98868c3f93d888ea0c,spec=vmdk_attach_config_spec),1,0,0.0,2017
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"(vmdk_file_path_before_snapshot, controller_key, adapter_type,",1,0,0.0,2018
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"hardware_devices, uuid=instance['uuid'])",1,0,0.0,2019
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"(vmdk_path, controller_key, adapter_type, disk_type,",1,0,0.0,2020
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"adapter_type, disk_type, vmdk_path,",1,0,0.0,2021
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"controller_key=controller_key,",1,0,0.0,2022
7a60b5c406336c5f410d1a98868c3f93d888ea0c,unit_number=unit_number),1,0,0.0,2023
7a60b5c406336c5f410d1a98868c3f93d888ea0c,try:,0,0,0.0,2024
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._session._call_method(,0,0,0.0,2025
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._session._get_vim(), ""MakeDirectory"",",0,0,0.0,2026
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""Created directory with path %s""), ds_path)",0,0,0.0,2027
7a60b5c406336c5f410d1a98868c3f93d888ea0c,except error_util.FileAlreadyExistsException:,0,0,0.0,2028
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""directory %(ds_path)s on %(ds)s.""),",0,0,0.0,2029
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"{'ds_path': ds_path, 'ds': dc_info.name})",0,0,0.0,2030
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._session._get_vim(),",0,0,0.0,2031
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""CreateSnapshot_Task"", vm_ref,",0,0,0.0,2032
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"memory=False,",0,0,0.0,2033
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'VirtualMachine', properties)",0,0,0.0,2034
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'supported_instances': jsonutils.dumps(,0,0,0.0,2035
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for vm in vms.objects:,1,0,0.0,2036
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for prop in vm.propSet:,1,0,0.0,2037
7a60b5c406336c5f410d1a98868c3f93d888ea0c,},0,0,0.0,2038
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import suds,1,0,0.0,2039
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"from nova.i18n import _, _LC",1,0,0.0,2040
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"super(VMwareESXDriver, self).__init__(virtapi)",1,0,0.0,2041
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._do_deprecation_warning(),1,0,0.0,2042
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""vmwareapi.VMwareVCDriver""))",1,0,0.0,2043
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._volumeops,",1,0,0.0,2044
7a60b5c406336c5f410d1a98868c3f93d888ea0c,datastore_regex=self._datastore_regex),1,0,0.0,2045
7a60b5c406336c5f410d1a98868c3f93d888ea0c,@property,1,0,0.0,2046
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._host_ip),1,0,0.0,2047
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._session._create_session(),1,0,0.0,2048
7a60b5c406336c5f410d1a98868c3f93d888ea0c,try:,1,0,0.0,2049
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vim.client.service.Logout(session_manager),1,0,0.0,2050
7a60b5c406336c5f410d1a98868c3f93d888ea0c,except suds.WebFault:,1,0,0.0,2051
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"admin_password, network_info=None, block_device_info=None):",1,0,0.0,2052
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"admin_password, network_info, block_device_info)",1,0,0.0,2053
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"block_device_info=None, bad_volumes_callback=None):",1,0,0.0,2054
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._vmops.reboot(instance, network_info)",1,0,0.0,2055
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"destroy_disks=True, migrate_data=None):",1,0,0.0,2056
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._vmops.destroy(instance, destroy_disks)",1,0,0.0,2057
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._vmops.pause(instance),1,0,0.0,2058
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._vmops.unpause(instance),1,0,0.0,2059
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._vmops.suspend(instance),1,0,0.0,2060
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._vmops.resume(instance),1,0,0.0,2061
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"controller_key, unit_number)",0,0,0.0,2062
7a60b5c406336c5f410d1a98868c3f93d888ea0c,rescue_password):,1,0,0.0,2063
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._vmops.unrescue(instance),1,0,0.0,2064
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"host_stats['supported_instances']),",0,0,0.0,2065
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'cpu_info': jsonutils.dumps(host_stats['cpu_info']),",0,0,0.0,2066
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'hypervisor_hostname': host_stats['hypervisor_hostname'],",0,0,0.0,2067
7a60b5c406336c5f410d1a98868c3f93d888ea0c,class VMwareVCDriver(driver.ComputeDriver):,0,0,0.0,2068
7a60b5c406336c5f410d1a98868c3f93d888ea0c,lst_vm_names.append(vm_name),1,0,0.0,2069
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""continue_to_get_objects"",",1,0,0.0,2070
7a60b5c406336c5f410d1a98868c3f93d888ea0c,token),1,0,0.0,2071
7a60b5c406336c5f410d1a98868c3f93d888ea0c,else:,1,0,0.0,2072
7a60b5c406336c5f410d1a98868c3f93d888ea0c,break,1,0,0.0,2073
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"host=""localhost"",",0,0,0.0,2074
7a60b5c406336c5f410d1a98868c3f93d888ea0c,port=443):,0,0,0.0,2075
7a60b5c406336c5f410d1a98868c3f93d888ea0c,port    : port for connection,0,0,0.0,2076
7a60b5c406336c5f410d1a98868c3f93d888ea0c,:param port: port for connection,0,0,0.0,2077
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"host=""localhost""):",1,0,0.0,2078
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"from nova.i18n import _, _LC, _LW",0,0,0.0,2079
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._do_deprecation_warning(),0,0,0.0,2080
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"super(VMwareVCDriver, self).__init__(virtapi)",0,0,0.0,2081
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'hypervisor_version': host_stats['hypervisor_version'],",0,0,0.0,2082
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._cluster_names),0,0,0.0,2083
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._update_resources(),0,0,0.0,2084
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'state.'), instance=instance)",0,0,0.0,2085
7a60b5c406336c5f410d1a98868c3f93d888ea0c,instance['uuid']),0,0,0.0,2086
7a60b5c406336c5f410d1a98868c3f93d888ea0c,block_device_info),0,0,0.0,2087
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'memory_mb': host_stats['host_memory_total'],",0,0,0.0,2088
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'local_gb': host_stats['disk_total'],",0,0,0.0,2089
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'vcpus_used': 0,",0,0,0.0,2090
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'memory_mb_used': host_stats['host_memory_total'] -,0,0,0.0,2091
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"host_stats['host_memory_free'],",0,0,0.0,2092
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'local_gb_used': host_stats['disk_used'],",0,0,0.0,2093
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'hypervisor_type': host_stats['hypervisor_type'],",0,0,0.0,2094
7a60b5c406336c5f410d1a98868c3f93d888ea0c,cdrom_attach_config_spec.deviceChange.append(controller_spec),0,0,0.0,2095
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"sourceDatacenter=dc_ref,",1,0,0.0,2096
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'ide'),0,0,0.0,2097
7a60b5c406336c5f410d1a98868c3f93d888ea0c,datacenter=self._get_datacenter_ref_and_name()[0]),1,0,0.0,2098
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmFolder=self._get_vmfolder_ref()),0,0,0.0,2099
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"name=ds_path, datacenter=dc_info.ref,",0,0,0.0,2100
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._mkdir(vm_util.build_datastore_path(ds_name, folder_name),",0,0,0.0,2101
7a60b5c406336c5f410d1a98868c3f93d888ea0c,while dcs:,0,0,0.0,2102
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for dco in dcs.objects:,0,0,0.0,2103
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for p in dco.propSet:,0,0,0.0,2104
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for ds in datastore_refs:,0,0,0.0,2105
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ds_refs.append(ds.value),0,0,0.0,2106
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for ds_ref in ds_refs:,0,0,0.0,2107
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"name=name, vmFolder=vmFolder)",0,0,0.0,2108
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""continue_to_get_objects"",",0,0,0.0,2109
7a60b5c406336c5f410d1a98868c3f93d888ea0c,token),0,0,0.0,2110
7a60b5c406336c5f410d1a98868c3f93d888ea0c,else:,0,0,0.0,2111
7a60b5c406336c5f410d1a98868c3f93d888ea0c,break,0,0,0.0,2112
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""Datacenter"", [""name"", ""datastore"", ""vmFolder""])",0,0,0.0,2113
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._update_datacenter_cache_from_objects(dcs),0,0,0.0,2114
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""CreateVM_Task"", vm_folder_ref,",1,0,0.0,2115
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"datacenter=dc_ref,",1,0,0.0,2116
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"data_center_name=self._get_datacenter_ref_and_name()[1],",1,0,0.0,2117
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"sourceDatacenter=self._get_datacenter_ref_and_name()[0],",1,0,0.0,2118
7a60b5c406336c5f410d1a98868c3f93d888ea0c,dc_ref),1,0,0.0,2119
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"root_vmdk_path, dc_ref)",1,0,0.0,2120
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"data_store_name, upload_folder, cookies):",1,0,0.0,2121
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""vmware-tmp""))",1,0,0.0,2122
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_check_if_tmp_folder_exists(),1,0,0.0,2123
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"destDatacenter=dc_ref,",1,0,0.0,2124
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._delete_datastore_file(instance, f, dc_ref)",1,0,0.0,2125
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"name=dc_obj.objects[0].propSet[0].val,",0,0,0.0,2126
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_util._cancel_retrieve_if_necessary(self._session, dc_obj)",0,0,0.0,2127
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""Datacenter"", [""name""])",0,0,0.0,2128
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"data_center_name=dc_info.name,",0,0,0.0,2129
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_delete_disk_file(flat_uploaded_vmdk_path),1,0,0.0,2130
7a60b5c406336c5f410d1a98868c3f93d888ea0c,block_device_info=None):,1,0,0.0,2131
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_delete_disk_file(sparse_uploaded_vmdk_path),1,0,0.0,2132
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"destName=dest_vmdk_file_location,",1,0,0.0,2133
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""DeleteVirtualDisk_Task"",",1,0,0.0,2134
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"service_content.virtualDiskManager,",1,0,0.0,2135
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"name=dest_vmdk_file_location,",1,0,0.0,2136
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._session._wait_for_task(instance['uuid'], remove_disk_task)",1,0,0.0,2137
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import collections,0,0,0.0,2138
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"['ref', 'name', 'vmFolder'])",0,0,0.0,2139
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""CreateVM_Task"", dc_info.vmFolder,",0,0,0.0,2140
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"datacenter=dc_info.ref,",0,0,0.0,2141
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"sourceDatacenter=dc_info.ref,",0,0,0.0,2142
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"folder=dc_info.vmFolder,",0,0,0.0,2143
7a60b5c406336c5f410d1a98868c3f93d888ea0c,dc_info.ref),0,0,0.0,2144
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"root_vmdk_path, dc_info.ref)",0,0,0.0,2145
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"dc_info.name,",0,0,0.0,2146
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"data_store_name, dc_name, upload_folder, cookies):",0,0,0.0,2147
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""vmware-tmp""),",0,0,0.0,2148
7a60b5c406336c5f410d1a98868c3f93d888ea0c,ds_ref),0,0,0.0,2149
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"destDatacenter=dc_info.ref,",0,0,0.0,2150
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._delete_datastore_file(instance, f, dc_info.ref)",0,0,0.0,2151
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""datastore""]",0,0,0.0,2152
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'config.files.vmPathName': None,",0,0,0.0,2153
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'datastore': None},0,0,0.0,2154
7a60b5c406336c5f410d1a98868c3f93d888ea0c,datacenter=dc_info.ref),0,0,0.0,2155
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'config.files.vmPathName': None},1,0,0.0,2156
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"folder=vm_folder_ref,",1,0,0.0,2157
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"devices,",0,0,0.0,2158
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""Datacenter"", [""name""])",1,0,0.0,2159
7a60b5c406336c5f410d1a98868c3f93d888ea0c,try:,0,0,0.0,2160
7a60b5c406336c5f410d1a98868c3f93d888ea0c,except Exception:,0,0,0.0,2161
7a60b5c406336c5f410d1a98868c3f93d888ea0c,finally:,0,0,0.0,2162
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._stop_loop(loop),0,0,0.0,2163
7a60b5c406336c5f410d1a98868c3f93d888ea0c,loop.stop(),1,0,0.0,2164
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"controller_key,",0,0,0.0,2165
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for unit_number in range(max_unit_number):,0,0,0.0,2166
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'VirtualLsiLogicSASController',",0,0,0.0,2167
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'VirtualBusLogicController'],0,0,0.0,2168
7a60b5c406336c5f410d1a98868c3f93d888ea0c,numbers for that controller_key.,0,0,0.0,2169
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for device in devices:,0,0,0.0,2170
7a60b5c406336c5f410d1a98868c3f93d888ea0c,unit_numbers.append(device.unitNumber),0,0,0.0,2171
7a60b5c406336c5f410d1a98868c3f93d888ea0c,unit_numbers.append(device.scsiCtlrUnitNumber),0,0,0.0,2172
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_type):,0,0,0.0,2173
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_type),0,0,0.0,2174
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"adapter_type=""lsiLogic"",",1,0,0.0,2175
7a60b5c406336c5f410d1a98868c3f93d888ea0c,else:,1,0,0.0,2176
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"controller_key,",1,0,0.0,2177
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_type),1,0,0.0,2178
7a60b5c406336c5f410d1a98868c3f93d888ea0c,device_config_spec.append(controller_spec),1,0,0.0,2179
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"disk_type, unit_number)",1,0,0.0,2180
7a60b5c406336c5f410d1a98868c3f93d888ea0c,uploaded_iso_path),0,0,0.0,2181
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"datastore, file_path):",0,0,0.0,2182
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""get_dynamic_property"", vm_ref,",0,0,0.0,2183
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""VirtualMachine"", ""config.hardware.device"")",0,0,0.0,2184
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"(controller_key, unit_number,",0,0,0.0,2185
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"client_factory,",0,0,0.0,2186
7a60b5c406336c5f410d1a98868c3f93d888ea0c,loop.stop(),0,0,0.0,2187
7a60b5c406336c5f410d1a98868c3f93d888ea0c,sessionId=[self._session_id]),1,0,0.0,2188
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._session.key, exc_info=True)",0,0,0.0,2189
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._session._get_vim(),",1,0,0.0,2190
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_util._cancel_retrieve_if_necessary(self._session, dc_obj)",1,0,0.0,2191
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"name=ds_path, datacenter=dc_ref,",1,0,0.0,2192
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._mkdir(vm_util.build_datastore_path(ds_name, folder_name))",1,0,0.0,2193
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.vim.Logout(self.vim.get_service_content().sessionManager),0,0,0.0,2194
7a60b5c406336c5f410d1a98868c3f93d888ea0c,try:,1,0,0.0,2195
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.vim.Logout(self.vim.get_service_content().sessionManager),1,0,0.0,2196
7a60b5c406336c5f410d1a98868c3f93d888ea0c,LOG.debug(excep),1,0,0.0,2197
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vim_util, ""get_dynamic_property"", vm_ref, ""VirtualMachine"",",0,0,0.0,2198
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""datastore"")",0,0,0.0,2199
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vim_util, ""get_dynamic_property"", ds_ref, ""Datastore"",",0,0,0.0,2200
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""browser"")",0,0,0.0,2201
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vim_util, ""get_dynamic_property"", ds_ref, ""Datastore"", ""browser"")",0,0,0.0,2202
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_ref,",1,0,0.0,2203
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.critical(_(""In vmwareapi: _call_method (session=%s)""),",0,0,0.0,2204
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""VirtualMachine"",",1,0,0.0,2205
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""datastore"")",1,0,0.0,2206
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"ds_ref,",1,0,0.0,2207
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""Datastore"",",1,0,0.0,2208
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""browser"")",1,0,0.0,2209
7a60b5c406336c5f410d1a98868c3f93d888ea0c,sessionId=[self._session.key]),0,0,0.0,2210
7a60b5c406336c5f410d1a98868c3f93d888ea0c,try:,0,0,0.0,2211
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self.vim.get_service_content().sessionManager,",0,0,0.0,2212
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"sessionID=self._session.key,",0,0,0.0,2213
7a60b5c406336c5f410d1a98868c3f93d888ea0c,userName=self._session.userName),0,0,0.0,2214
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._session.key),0,0,0.0,2215
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._create_session(),0,0,0.0,2216
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._vmops.power_off(instance),1,0,0.0,2217
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Set IPv4 network settings for Ubuntu.""""""",1,0,0.0,2218
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._vmops.power_on(instance),1,0,0.0,2219
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"VMwareHTTPFile.__init__(self, conn)",1,0,0.0,2220
7a60b5c406336c5f410d1a98868c3f93d888ea0c,urllib.pathname2url(file_path)),1,0,0.0,2221
7a60b5c406336c5f410d1a98868c3f93d888ea0c,urllib.pathname2url(file_path)),1,0,0.0,2222
7a60b5c406336c5f410d1a98868c3f93d888ea0c,from oslo.vmware import rw_handles,0,0,0.0,2223
7a60b5c406336c5f410d1a98868c3f93d888ea0c,class VMwareHTTPReadFile(rw_handles.FileHandle):,0,0,0.0,2224
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"file_path, scheme=""https""):",0,0,0.0,2225
7a60b5c406336c5f410d1a98868c3f93d888ea0c,cookies=cookies),0,0,0.0,2226
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"rw_handles.FileHandle.__init__(self, self._conn)",0,0,0.0,2227
7a60b5c406336c5f410d1a98868c3f93d888ea0c,urllib.pathname2url(file_path)),0,0,0.0,2228
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import httplib,1,0,0.0,2229
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import urllib2,1,0,0.0,2230
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import six.moves.urllib.parse as urlparse,1,0,0.0,2231
7a60b5c406336c5f410d1a98868c3f93d888ea0c,from nova.openstack.common import log as logging,1,0,0.0,2232
7a60b5c406336c5f410d1a98868c3f93d888ea0c,class GlanceFileRead(object):,1,0,0.0,2233
7a60b5c406336c5f410d1a98868c3f93d888ea0c,uses its own CHUNKSIZE.,1,0,0.0,2234
7a60b5c406336c5f410d1a98868c3f93d888ea0c,try:,1,0,0.0,2235
7a60b5c406336c5f410d1a98868c3f93d888ea0c,except StopIteration:,1,0,0.0,2236
7a60b5c406336c5f410d1a98868c3f93d888ea0c,pass,1,0,0.0,2237
7a60b5c406336c5f410d1a98868c3f93d888ea0c,class VMwareHTTPFile(object):,1,0,0.0,2238
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Base class for HTTP file.""""""",1,0,0.0,2239
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.file_handle.close(),1,0,0.0,2240
7a60b5c406336c5f410d1a98868c3f93d888ea0c,LOG.exception(exc),1,0,0.0,2241
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for vim_cookie in vim_cookies:,1,0,0.0,2242
7a60b5c406336c5f410d1a98868c3f93d888ea0c,break,1,0,0.0,2243
7a60b5c406336c5f410d1a98868c3f93d888ea0c,class VMwareHTTPWriteFile(VMwareHTTPFile):,1,0,0.0,2244
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"file_path, file_size, scheme=""https""):",1,0,0.0,2245
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"conn.putheader(""User-Agent"", USER_AGENT)",1,0,0.0,2246
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"conn.putheader(""Cookie"", self._build_vim_cookie_headers(cookies))",1,0,0.0,2247
7a60b5c406336c5f410d1a98868c3f93d888ea0c,else:,1,0,0.0,2248
7a60b5c406336c5f410d1a98868c3f93d888ea0c,else:,0,0,0.0,2249
7a60b5c406336c5f410d1a98868c3f93d888ea0c,urllib.pathname2url(file_path)),0,0,0.0,2250
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.close(),1,0,0.0,2251
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for dns_server in dns_servers:,1,0,0.0,2252
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for entry in all_entries:,1,0,0.0,2253
7a60b5c406336c5f410d1a98868c3f93d888ea0c,final_list.append(entry),1,0,0.0,2254
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Set IPv4 network settings for RHEL distros.""""""",1,0,0.0,2255
7a60b5c406336c5f410d1a98868c3f93d888ea0c,all_dns_servers.extend(dns_servers),1,0,0.0,2256
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_name),1,0,0.0,2257
7a60b5c406336c5f410d1a98868c3f93d888ea0c,os.remove(interface_file_name),1,0,0.0,2258
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"_execute(['touch', interface_file_name])",1,0,0.0,2259
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nUSERCTL=yes'),1,0,0.0,2260
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nONBOOT=yes'),1,0,0.0,2261
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nBOOTPROTO=static'),1,0,0.0,2262
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nNETWORK='),1,0,0.0,2263
7a60b5c406336c5f410d1a98868c3f93d888ea0c,os.remove(dns_file_name),1,0,0.0,2264
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_linux_set_networking(),1,0,0.0,2265
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"_execute(['touch', dns_file_name])",1,0,0.0,2266
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for dns_server in unique_entries:,1,0,0.0,2267
7a60b5c406336c5f410d1a98868c3f93d888ea0c,dns_file.close(),1,0,0.0,2268
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"_execute(['/sbin/service', 'network', 'restart'])",1,0,0.0,2269
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""NIC info %(detail)s""), {'device': device,",1,0,0.0,2270
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'detail': network_detail}),1,0,0.0,2271
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.debug(_(""Restarting networking....\n""))",1,0,0.0,2272
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"_execute(['/etc/init.d/networking', 'restart'])",1,0,0.0,2273
7a60b5c406336c5f410d1a98868c3f93d888ea0c,check_exit_code=False)),1,0,0.0,2274
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_set_ubuntu_networking(network_details),1,0,0.0,2275
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_set_rhel_networking(network_details),1,0,0.0,2276
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_windows_set_networking(),1,0,0.0,2277
7a60b5c406336c5f410d1a98868c3f93d888ea0c,conn.endheaders(),1,0,0.0,2278
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.file_handle.send(data),1,0,0.0,2279
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'state.'), instance=instance)",1,0,0.0,2280
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.conn.getresponse(),1,0,0.0,2281
7a60b5c406336c5f410d1a98868c3f93d888ea0c,},0,0,0.0,2282
7a60b5c406336c5f410d1a98868c3f93d888ea0c,device.__class__.__name__],0,0,0.0,2283
7a60b5c406336c5f410d1a98868c3f93d888ea0c,from oslo_vmware import api,1,0,0.0,2284
7a60b5c406336c5f410d1a98868c3f93d888ea0c,from oslo_vmware import vim,1,0,0.0,2285
7a60b5c406336c5f410d1a98868c3f93d888ea0c,class VMwareAPISession(api.VMwareAPISession):,1,0,0.0,2286
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"host_port=CONF.vmware.host_port,",1,0,0.0,2287
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"username=CONF.vmware.host_username,",1,0,0.0,2288
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"password=CONF.vmware.host_password,",1,0,0.0,2289
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"retry_count=CONF.vmware.api_retry_count,",1,0,0.0,2290
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"scheme=""https"",",1,0,0.0,2291
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"cacert=CONF.vmware.ca_file,",1,0,0.0,2292
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"insecure=CONF.vmware.insecure,",1,0,0.0,2293
7a60b5c406336c5f410d1a98868c3f93d888ea0c,pool_size=CONF.vmware.connection_pool_size):,1,0,0.0,2294
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"super(VMwareAPISession, self).__init__(",1,0,0.0,2295
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"host=host_ip,",1,0,0.0,2296
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"port=host_port,",1,0,0.0,2297
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"server_username=username,",1,0,0.0,2298
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"server_password=password,",1,0,0.0,2299
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"api_retry_count=retry_count,",1,0,0.0,2300
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"task_poll_interval=CONF.vmware.task_poll_interval,",1,0,0.0,2301
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"scheme=scheme,",1,0,0.0,2302
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"create_session=True,",1,0,0.0,2303
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"cacert=cacert,",1,0,0.0,2304
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"insecure=insecure,",1,0,0.0,2305
7a60b5c406336c5f410d1a98868c3f93d888ea0c,pool_size=pool_size),1,0,0.0,2306
7a60b5c406336c5f410d1a98868c3f93d888ea0c,args provided.,1,0,0.0,2307
7a60b5c406336c5f410d1a98868c3f93d888ea0c,datacenter=dc_ref),1,0,0.0,2308
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""ParaVirtualSCSIController"": constants.ADAPTER_TYPE_PARAVIRTUAL",0,0,0.0,2309
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""VirtualLsiLogicSASController"": constants.ADAPTER_TYPE_LSILOGICSAS,",0,0,0.0,2310
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""VirtualIDEController"": constants.ADAPTER_TYPE_IDE,",0,0,0.0,2311
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_ref,",1,0,0.0,2312
7a60b5c406336c5f410d1a98868c3f93d888ea0c,except Exception:,1,0,0.0,2313
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""VMwareHTTPWrite"", exc_info=True)",1,0,0.0,2314
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"super(VMwareHTTPWriteFile, self).close()",1,0,0.0,2315
7a60b5c406336c5f410d1a98868c3f93d888ea0c,class VMwareHTTPReadFile(VMwareHTTPFile):,1,0,0.0,2316
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"file_path, scheme=""https""):",1,0,0.0,2317
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'Cookie': self._build_vim_cookie_headers(cookies)},1,0,0.0,2318
7a60b5c406336c5f410d1a98868c3f93d888ea0c,try:,0,0,0.0,2319
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""get_object_properties_dict"",",0,0,0.0,2320
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_ref,",0,0,0.0,2321
7a60b5c406336c5f410d1a98868c3f93d888ea0c,lst_properties),0,0,0.0,2322
7a60b5c406336c5f410d1a98868c3f93d888ea0c,except vexc.ManagedObjectNotFoundException:,0,0,0.0,2323
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""get_object_properties_dict"",",1,0,0.0,2324
7a60b5c406336c5f410d1a98868c3f93d888ea0c,lst_properties),1,0,0.0,2325
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""VirtualBusLogicController"": constants.ADAPTER_TYPE_BUSLOGIC,",0,0,0.0,2326
7a60b5c406336c5f410d1a98868c3f93d888ea0c,state=constants.POWER_STATES[vm_props['runtime.powerState']]),0,0,0.0,2327
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"max_mem_kb=info['MemoryUsage'],",1,0,0.0,2328
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"mem_kb=info['MemoryUsage'],",1,0,0.0,2329
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"num_cpu=info['NumberOfProcessors'],",1,0,0.0,2330
7a60b5c406336c5f410d1a98868c3f93d888ea0c,cpu_time_ns=info['UpTime']),1,0,0.0,2331
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""summary.config.memorySizeMB"",",1,0,0.0,2332
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""runtime.powerState""]",1,0,0.0,2333
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"state=constants.POWER_STATES[vm_props['runtime.powerState']],",1,0,0.0,2334
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"max_mem_kb=max_mem,",1,0,0.0,2335
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"mem_kb=max_mem,",1,0,0.0,2336
7a60b5c406336c5f410d1a98868c3f93d888ea0c,num_cpu=num_cpu),1,0,0.0,2337
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""VirtualLsiLogicController"": constants.DEFAULT_ADAPTER_TYPE,",0,0,0.0,2338
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_execute(cmd),1,0,0.0,2339
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"subnet_mask, gateway, '1']",1,0,0.0,2340
7a60b5c406336c5f410d1a98868c3f93d888ea0c,check_exit_code=False)):,1,0,0.0,2341
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'VMwareService.exe')):,1,0,0.0,2342
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._vmops.detach_interface(instance, vif)",1,0,0.0,2343
7a60b5c406336c5f410d1a98868c3f93d888ea0c,class VMwareVCDriver(VMwareESXDriver):,1,0,0.0,2344
7a60b5c406336c5f410d1a98868c3f93d888ea0c,pass,1,0,0.0,2345
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"super(VMwareVCDriver, self).__init__(virtapi, scheme)",1,0,0.0,2346
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._cluster_names),1,0,0.0,2347
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.warn(_(""The following clusters could not be found in the""",1,0,0.0,2348
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._update_resources(),1,0,0.0,2349
7a60b5c406336c5f410d1a98868c3f93d888ea0c,Utility functions for Image transfer and manipulation.,0,0,0.0,2350
7a60b5c406336c5f410d1a98868c3f93d888ea0c,from oslo.config import cfg,0,0,0.0,2351
7a60b5c406336c5f410d1a98868c3f93d888ea0c,from nova.openstack.common import strutils,0,0,0.0,2352
7a60b5c406336c5f410d1a98868c3f93d888ea0c,from nova.openstack.common import units,0,0,0.0,2353
7a60b5c406336c5f410d1a98868c3f93d888ea0c,from nova.virt.vmwareapi import constants,0,0,0.0,2354
7a60b5c406336c5f410d1a98868c3f93d888ea0c,class VMwareImage(object):,0,0,0.0,2355
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"file_size=0,",0,0,0.0,2356
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"os_type=constants.DEFAULT_OS_TYPE,",0,0,0.0,2357
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"adapter_type=constants.DEFAULT_ADAPTER_TYPE,",0,0,0.0,2358
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"disk_type=constants.DEFAULT_DISK_TYPE,",0,0,0.0,2359
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"file_type=constants.DEFAULT_DISK_FORMAT,",0,0,0.0,2360
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"linked_clone=None,",0,0,0.0,2361
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vif_model=constants.DEFAULT_VIF_MODEL):,0,0,0.0,2362
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""VMwareImage holds values for use in building VMs.",0,0,0.0,2363
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.file_type not in constants.DISK_FORMATS_ALL):,0,0,0.0,2364
7a60b5c406336c5f410d1a98868c3f93d888ea0c,else:,0,0,0.0,2365
7a60b5c406336c5f410d1a98868c3f93d888ea0c,@property,0,0,0.0,2366
7a60b5c406336c5f410d1a98868c3f93d888ea0c,@classmethod,0,0,0.0,2367
7a60b5c406336c5f410d1a98868c3f93d888ea0c,:rtype: nova.virt.vmwareapi.vmware_images.VmwareImage,0,0,0.0,2368
7a60b5c406336c5f410d1a98868c3f93d888ea0c,CONF.vmware.use_linked_clone),0,0,0.0,2369
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._vmops.attach_interface(instance, image_meta, vif)",1,0,0.0,2370
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._vmops.manage_image_cache(context, all_instances)",1,0,0.0,2371
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._vmops.inject_network_info(instance, nw_info)",1,0,0.0,2372
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'vcpus_used': 0,",1,0,0.0,2373
7a60b5c406336c5f410d1a98868c3f93d888ea0c,instance['uuid']),1,0,0.0,2374
7a60b5c406336c5f410d1a98868c3f93d888ea0c,block_device_info),1,0,0.0,2375
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Poll for rebooting instances.""""""",1,0,0.0,2376
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._vmops.poll_rebooting_instances(timeout, instances)",1,0,0.0,2377
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Return volume connector information.""""""",1,0,0.0,2378
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"disk_bus=None, device_type=None, encryption=None):",1,0,0.0,2379
7a60b5c406336c5f410d1a98868c3f93d888ea0c,mountpoint),1,0,0.0,2380
7a60b5c406336c5f410d1a98868c3f93d888ea0c,encryption=None):,1,0,0.0,2381
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'username': CONF.vmware.host_username,",1,0,0.0,2382
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'password': CONF.vmware.host_password},1,0,0.0,2383
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'memory_mb': host_stats['host_memory_total'],",1,0,0.0,2384
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'local_gb': host_stats['disk_total'],",1,0,0.0,2385
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'memory_mb_used': host_stats['host_memory_total'] -,1,0,0.0,2386
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""inject network info for specified instance.""""""",1,0,0.0,2387
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"host_stats['host_memory_free'],",1,0,0.0,2388
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'local_gb_used': host_stats['disk_used'],",1,0,0.0,2389
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'hypervisor_type': host_stats['hypervisor_type'],",1,0,0.0,2390
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'hypervisor_version': host_stats['hypervisor_version'],",1,0,0.0,2391
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'hypervisor_hostname': host_stats['hypervisor_hostname'],",1,0,0.0,2392
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'cpu_info': jsonutils.dumps(host_stats['cpu_info']),",1,0,0.0,2393
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'supported_instances': jsonutils.dumps(,1,0,0.0,2394
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"host_stats['supported_instances']),",1,0,0.0,2395
7a60b5c406336c5f410d1a98868c3f93d888ea0c,},1,0,0.0,2396
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Retrieve resource information.",1,0,0.0,2397
7a60b5c406336c5f410d1a98868c3f93d888ea0c,:returns: dictionary describing resources,1,0,0.0,2398
7a60b5c406336c5f410d1a98868c3f93d888ea0c,guest VMs evacuation.,1,0,0.0,2399
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'image_id': image_id,",0,0,0.0,2400
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'linked_clone': linked_clone,0,0,0.0,2401
7a60b5c406336c5f410d1a98868c3f93d888ea0c,},0,0,0.0,2402
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"0x891b,",1,0,0.0,2403
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import win32com.client,1,0,0.0,2404
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for adapter in wbem_network_adapters:,1,0,0.0,2405
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'Win32_NetworkAdapterSetting',",1,0,0.0,2406
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'Win32_NetworkAdapterConfiguration')[0],1,0,0.0,2407
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#config.DefaultIPGateway[0],1,0,0.0,2408
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'subnet-mask': subnet_mask}),1,0,0.0,2409
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import fcntl,1,0,0.0,2410
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"0x8912,",1,0,0.0,2411
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"struct.pack('iL', max_bytes, names.buffer_info()[0])))[0]",1,0,0.0,2412
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"for n_cnt in xrange(0, outbytes, offset2)]",1,0,0.0,2413
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"0x8915,",1,0,0.0,2414
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"struct.pack('256s', adapter_name))[20:24])",1,0,0.0,2415
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"0x8927,",1,0,0.0,2416
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_details.append((,1,0,0.0,2417
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"struct.pack('256s', adapter_name))[18:24])",1,0,0.0,2418
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"for m_counter in range(0, len(raw_mac_address), 2)]).lower()",1,0,0.0,2419
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for network_adapter in network_adapters:,1,0,0.0,2420
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get Windows network adapter name.""""""",1,0,0.0,2421
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get Linux network adapter name.""""""",1,0,0.0,2422
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"stdout=subprocess.PIPE, stderr=subprocess.PIPE, env=env)",1,0,0.0,2423
7a60b5c406336c5f410d1a98868c3f93d888ea0c,obj.stdin.close(),1,0,0.0,2424
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"stdout=stdout,",1,0,0.0,2425
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"stderr=stderr,",1,0,0.0,2426
7a60b5c406336c5f410d1a98868c3f93d888ea0c,cmd=cmd),1,0,0.0,2427
7a60b5c406336c5f410d1a98868c3f93d888ea0c,time.sleep(0.1),1,0,0.0,2428
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'vmtoolsd.exe')):,1,0,0.0,2429
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_info_list[k].strip().lower(),",1,0,0.0,2430
7a60b5c406336c5f410d1a98868c3f93d888ea0c,while i < no_grps:,1,0,0.0,2431
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'vmware_ostype': 'os_type',",0,0,0.0,2432
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import socket,1,0,0.0,2433
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'vmware_adaptertype': 'adapter_type',",0,0,0.0,2434
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'vmware_disktype': 'disk_type',",0,0,0.0,2435
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'hw_vif_model': 'vif_model',0,0,0.0,2436
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"for k, v in props_map.iteritems():",0,0,0.0,2437
7a60b5c406336c5f410d1a98868c3f93d888ea0c,Utility functions for Image transfer.,1,0,0.0,2438
7a60b5c406336c5f410d1a98868c3f93d888ea0c,instance=instance),1,0,0.0,2439
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"{'size': size, 'image': image}, instance=instance)",1,0,0.0,2440
7a60b5c406336c5f410d1a98868c3f93d888ea0c,On Windows we require pyWin32 installed on Python.,1,0,0.0,2441
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import array,1,0,0.0,2442
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import logging,1,0,0.0,2443
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import os,1,0,0.0,2444
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import platform,1,0,0.0,2445
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import struct,1,0,0.0,2446
7a60b5c406336c5f410d1a98868c3f93d888ea0c,break,1,0,0.0,2447
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import subprocess,1,0,0.0,2448
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import sys,1,0,0.0,2449
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import time,1,0,0.0,2450
7a60b5c406336c5f410d1a98868c3f93d888ea0c,from nova.i18n import _,1,0,0.0,2451
7a60b5c406336c5f410d1a98868c3f93d888ea0c,else:,1,0,0.0,2452
7a60b5c406336c5f410d1a98868c3f93d888ea0c,os.mkdir(LOG_DIR),1,0,0.0,2453
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.basicConfig(filename=LOG_FILENAME, format=FORMAT)",1,0,0.0,2454
7a60b5c406336c5f410d1a98868c3f93d888ea0c,class ProcessExecutionError:,1,0,0.0,2455
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Process Execution Error Class.""""""",1,0,0.0,2456
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for byt in bytes:,1,0,0.0,2457
7a60b5c406336c5f410d1a98868c3f93d888ea0c,pass,1,0,0.0,2458
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for machine_id_str in machine_id[0].split('#'):,1,0,0.0,2459
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._session._wait_for_task(instance['uuid'], vmdk_delete_task)",1,0,0.0,2460
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'VMwareService.exe')):,1,0,0.0,2461
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"name=vmdk_path,",1,0,0.0,2462
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"0x8912,",1,0,0.0,2463
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import os,1,0,0.0,2464
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import platform,1,0,0.0,2465
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import socket,1,0,0.0,2466
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import struct,1,0,0.0,2467
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import subprocess,1,0,0.0,2468
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import sys,1,0,0.0,2469
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import time,1,0,0.0,2470
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"gettext.install('nova', unicode=1)",1,0,0.0,2471
7a60b5c406336c5f410d1a98868c3f93d888ea0c,else:,1,0,0.0,2472
7a60b5c406336c5f410d1a98868c3f93d888ea0c,os.mkdir(LOG_DIR),1,0,0.0,2473
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.basicConfig(filename=LOG_FILENAME, format=FORMAT)",1,0,0.0,2474
7a60b5c406336c5f410d1a98868c3f93d888ea0c,class ProcessExecutionError:,1,0,0.0,2475
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Process Execution Error Class.""""""",1,0,0.0,2476
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for byt in bytes:,1,0,0.0,2477
7a60b5c406336c5f410d1a98868c3f93d888ea0c,pass,1,0,0.0,2478
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for machine_id_str in machine_id[0].split('#'):,1,0,0.0,2479
7a60b5c406336c5f410d1a98868c3f93d888ea0c,break,1,0,0.0,2480
7a60b5c406336c5f410d1a98868c3f93d888ea0c,while i < no_grps:,1,0,0.0,2481
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_details.append((,1,0,0.0,2482
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_info_list[k].strip().lower(),",1,0,0.0,2483
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import win32com.client,1,0,0.0,2484
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for wbem_network_adapter in wbem_network_adapters:,1,0,0.0,2485
7a60b5c406336c5f410d1a98868c3f93d888ea0c,wbem_network_adapter.associators_(,1,0,0.0,2486
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'Win32_NetworkAdapterSetting',",1,0,0.0,2487
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'Win32_NetworkAdapterConfiguration')[0],1,0,0.0,2488
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#wbem_network_adapter_config.DefaultIPGateway[0],1,0,0.0,2489
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'subnet-mask': subnet_mask}),1,0,0.0,2490
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import logging,1,0,0.0,2491
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import gettext,1,0,0.0,2492
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import array,1,0,0.0,2493
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.close(),0,0,0.0,2494
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for dns_server in dns_servers:,0,0,0.0,2495
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for entry in all_entries:,0,0,0.0,2496
7a60b5c406336c5f410d1a98868c3f93d888ea0c,final_list.append(entry),0,0,0.0,2497
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Set IPv4 network settings for RHEL distros.""""""",0,0,0.0,2498
7a60b5c406336c5f410d1a98868c3f93d888ea0c,all_dns_servers.extend(dns_servers),0,0,0.0,2499
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_get_linux_adapter_name_and_ip_address(mac_address),0,0,0.0,2500
7a60b5c406336c5f410d1a98868c3f93d888ea0c,os.remove(interface_file_name),0,0,0.0,2501
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"_execute(['touch', interface_file_name])",0,0,0.0,2502
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nUSERCTL=yes'),0,0,0.0,2503
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nONBOOT=yes'),0,0,0.0,2504
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nBOOTPROTO=static'),0,0,0.0,2505
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nNETWORK='),0,0,0.0,2506
7a60b5c406336c5f410d1a98868c3f93d888ea0c,os.remove(dns_file_name),0,0,0.0,2507
7a60b5c406336c5f410d1a98868c3f93d888ea0c,On Windows we require pyWin32 installed on Python.,1,0,0.0,2508
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"_execute(['touch', dns_file_name])",0,0,0.0,2509
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for dns_server in unique_entries:,0,0,0.0,2510
7a60b5c406336c5f410d1a98868c3f93d888ea0c,dns_file.close(),0,0,0.0,2511
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"_execute(['/sbin/service', 'network', 'restart'])",0,0,0.0,2512
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Set IPv4 network settings for Ubuntu.""""""",0,0,0.0,2513
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.debug(_(""Restarting networking....\n""))",0,0,0.0,2514
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"_execute(['/etc/init.d/networking', 'restart'])",0,0,0.0,2515
7a60b5c406336c5f410d1a98868c3f93d888ea0c,check_exit_code=False)),0,0,0.0,2516
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_set_ubuntu_networking(network_details),0,0,0.0,2517
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_set_rhel_networking(network_details),0,0,0.0,2518
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_windows_set_networking(),0,0,0.0,2519
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_linux_set_networking(),0,0,0.0,2520
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import fcntl,1,0,0.0,2521
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"struct.pack('iL', max_bytes, names.buffer_info()[0])))[0]",1,0,0.0,2522
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"subnet_mask, gateway, '1']",0,0,0.0,2523
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"for n_counter in xrange(0, outbytes, offset2)]",1,0,0.0,2524
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nBOOTPROTO=static'),1,0,0.0,2525
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nNETWORK='),1,0,0.0,2526
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.close(),1,0,0.0,2527
7a60b5c406336c5f410d1a98868c3f93d888ea0c,os.remove(dns_file_name),1,0,0.0,2528
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"_execute(['touch', dns_file_name])",1,0,0.0,2529
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for dns_server in unique_entries:,1,0,0.0,2530
7a60b5c406336c5f410d1a98868c3f93d888ea0c,dns_file.close(),1,0,0.0,2531
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"_execute(['/sbin/service', 'network', 'restart'])",1,0,0.0,2532
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Set IPv4 network settings for Ubuntu.""""""",1,0,0.0,2533
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.debug(_(""Restarting networking....\n""))",1,0,0.0,2534
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"_execute(['/etc/init.d/networking', 'restart'])",1,0,0.0,2535
7a60b5c406336c5f410d1a98868c3f93d888ea0c,check_exit_code=False)),1,0,0.0,2536
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_set_ubuntu_networking(network_details),1,0,0.0,2537
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_set_rhel_networking(network_details),1,0,0.0,2538
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_windows_set_networking(),1,0,0.0,2539
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_linux_set_networking(),1,0,0.0,2540
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for adapter in wbem_network_adapters:,0,0,0.0,2541
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#config.DefaultIPGateway[0],0,0,0.0,2542
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"for n_cnt in xrange(0, outbytes, offset2)]",0,0,0.0,2543
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_name),0,0,0.0,2544
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for wbem_network_adapter in wbem_network_adapters:,1,0,0.0,2545
7a60b5c406336c5f410d1a98868c3f93d888ea0c,wbem_network_adapter.associators_(,1,0,0.0,2546
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#wbem_network_adapter_config.DefaultIPGateway[0],1,0,0.0,2547
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"for n_counter in xrange(0, outbytes, offset2)]",1,0,0.0,2548
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_get_win_adapter_name_and_ip_address(mac_address),1,0,0.0,2549
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_get_linux_adapter_name_and_ip_address(mac_address),1,0,0.0,2550
7a60b5c406336c5f410d1a98868c3f93d888ea0c,from nova import context,1,0,0.0,2551
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nONBOOT=yes'),1,0,0.0,2552
7a60b5c406336c5f410d1a98868c3f93d888ea0c,interface_file.write('\nUSERCTL=yes'),1,0,0.0,2553
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"_execute(['touch', interface_file_name])",1,0,0.0,2554
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"stderr=stderr,",1,0,0.0,2555
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"0x8915,",1,0,0.0,2556
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"struct.pack('256s', adapter_name))[20:24])",1,0,0.0,2557
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"0x891b,",1,0,0.0,2558
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"0x8927,",1,0,0.0,2559
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"struct.pack('256s', adapter_name))[18:24])",1,0,0.0,2560
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"for m_counter in range(0, len(raw_mac_address), 2)]).lower()",1,0,0.0,2561
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for network_adapter in network_adapters:,1,0,0.0,2562
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get Windows network adapter name.""""""",1,0,0.0,2563
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get Linux network adapter name.""""""",1,0,0.0,2564
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"stdout=subprocess.PIPE, stderr=subprocess.PIPE, env=env)",1,0,0.0,2565
7a60b5c406336c5f410d1a98868c3f93d888ea0c,obj.stdin.close(),1,0,0.0,2566
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"stdout=stdout,",1,0,0.0,2567
7a60b5c406336c5f410d1a98868c3f93d888ea0c,cmd=cmd),1,0,0.0,2568
7a60b5c406336c5f410d1a98868c3f93d888ea0c,os.remove(interface_file_name),1,0,0.0,2569
7a60b5c406336c5f410d1a98868c3f93d888ea0c,time.sleep(0.1),1,0,0.0,2570
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'vmtoolsd.exe')):,1,0,0.0,2571
7a60b5c406336c5f410d1a98868c3f93d888ea0c,check_exit_code=False)):,1,0,0.0,2572
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_get_win_adapter_name_and_ip_address(mac_address),1,0,0.0,2573
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"subnet_mask, gateway, '1']",1,0,0.0,2574
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_execute(cmd),1,0,0.0,2575
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for dns_server in dns_servers:,1,0,0.0,2576
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for entry in all_entries:,1,0,0.0,2577
7a60b5c406336c5f410d1a98868c3f93d888ea0c,final_list.append(entry),1,0,0.0,2578
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Set IPv4 network settings for RHEL distros.""""""",1,0,0.0,2579
7a60b5c406336c5f410d1a98868c3f93d888ea0c,all_dns_servers.extend(dns_servers),1,0,0.0,2580
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_get_linux_adapter_name_and_ip_address(mac_address),1,0,0.0,2581
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_execute(cmd),0,0,0.0,2582
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_get_win_adapter_name_and_ip_address(mac_address),0,0,0.0,2583
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"service_content.fileManager,",1,0,0.0,2584
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"info['broadcast'],",1,0,0.0,2585
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"default='nova.virt.vmwareapi.vif.VMWareVlanBridgeDriver',",0,0,0.0,2586
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"instance.image_ref,",0,0,0.0,2587
7a60b5c406336c5f410d1a98868c3f93d888ea0c,instance),0,0,0.0,2588
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._session, network_name)",0,0,0.0,2589
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"client_factory, hardware_devices)",0,0,0.0,2590
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"(vmdk_file_path_before_snapshot, adapter_type, datastore_name,",0,0,0.0,2591
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"info['gateway'],",0,0,0.0,2592
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"info['broadcast'],",0,0,0.0,2593
7a60b5c406336c5f410d1a98868c3f93d888ea0c,dns]),0,0,0.0,2594
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"client_factory, machine_id_str)",0,0,0.0,2595
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""install"")",0,0,0.0,2596
7a60b5c406336c5f410d1a98868c3f93d888ea0c,LOG.info(_('Latest agent build for %(hypervisor)s/%(os)s',0,0,0.0,2597
7a60b5c406336c5f410d1a98868c3f93d888ea0c,LOG.info(_('No agent build found for %(hypervisor)s/%(os)s',0,0,0.0,2598
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"cmp_version(version, agent_build['version']) < 0):",0,0,0.0,2599
7a60b5c406336c5f410d1a98868c3f93d888ea0c,LOG.debug(_('Removing VDI %(vdi_ref)s',0,0,0.0,2600
7a60b5c406336c5f410d1a98868c3f93d888ea0c,instance['root_gb'] > instance_type['root_gb']):,0,0,0.0,2601
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"cfg.StrOpt('vmware_vif_driver',",1,0,0.0,2602
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"default='nova.virt.vmwareapi.vif.VMWareVlanBridgeDriver',",1,0,0.0,2603
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vmware_images.get_vmdk_size_and_properties(context,",1,0,0.0,2604
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"instance.image_ref, instance)",1,0,0.0,2605
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_utils.get_network_with_the_name(self._session,",1,0,0.0,2606
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_name),1,0,0.0,2607
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_util.get_vmdk_file_path_and_adapter_type(client_factory,",1,0,0.0,2608
7a60b5c406336c5f410d1a98868c3f93d888ea0c,hardware_devices),1,0,0.0,2609
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vmdk_file_path_before_snapshot, adapter_type, datastore_name,\",1,0,0.0,2610
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vm_util.split_datastore_path(vm_config_pathname),1,0,0.0,2611
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"(info['mac'],",1,0,0.0,2612
7a60b5c406336c5f410d1a98868c3f93d888ea0c,client_factory.create('ns0:VirtualMachineConfigSpec'),1,0,0.0,2613
7a60b5c406336c5f410d1a98868c3f93d888ea0c,client_factory.create('ns0:VirtualDiskFlatVer2BackingInfo'),1,0,0.0,2614
7a60b5c406336c5f410d1a98868c3f93d888ea0c,client_factory.create('ns0:FileBackedVirtualDiskSpec'),1,0,0.0,2615
7a60b5c406336c5f410d1a98868c3f93d888ea0c,client_factory.create('ns0:PropertyFilterSpec'),1,0,0.0,2616
7a60b5c406336c5f410d1a98868c3f93d888ea0c,urlparse.urlparse(base_url),1,0,0.0,2617
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"default=None,",0,0,0.0,2618
7a60b5c406336c5f410d1a98868c3f93d888ea0c,help='VIM Service WSDL Location ',0,0,0.0,2619
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'e.g http://<server>/vimService.wsdl. ',0,0,0.0,2620
7a60b5c406336c5f410d1a98868c3f93d888ea0c,managed_object),0,0,0.0,2621
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"cfg.StrOpt('vmwareapi_wsdl_loc',",1,0,0.0,2622
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"default=None,",1,0,0.0,2623
7a60b5c406336c5f410d1a98868c3f93d888ea0c,help='VIM Service WSDL Location ',1,0,0.0,2624
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'e.g http://<server>/vimService.wsdl. ',1,0,0.0,2625
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self.RetrieveServiceContent(""ServiceInstance"")",1,0,0.0,2626
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._request_managed_object_builder(managed_object),1,0,0.0,2627
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"get_object_properties(vim, None, mobj, type, [property_name])",1,0,0.0,2628
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'ns0:VirtualDeviceConfigSpec'),0,0,0.0,2629
7a60b5c406336c5f410d1a98868c3f93d888ea0c,client_factory.create('ns0:VirtualDeviceConnectInfo'),1,0,0.0,2630
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'VirtualPortBackingInfo']),0,0,0.0,2631
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'ns0:DistributedVirtualSwitchPortConnection'),0,0,0.0,2632
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'ns0:VirtualEthernetCardNetworkBackingInfo'),0,0,0.0,2633
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""VirtualDiskFlatVer2BackingInfo""):",0,0,0.0,2634
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'ns0:VirtualDiskFlatVer2BackingInfo'),0,0,0.0,2635
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'ns0:VirtualMachineConfigSpec'),0,0,0.0,2636
7a60b5c406336c5f410d1a98868c3f93d888ea0c,client_factory.create('ns0:VirtualDeviceConfigSpec'),1,0,0.0,2637
7a60b5c406336c5f410d1a98868c3f93d888ea0c,client_factory.create('ns0:VirtualLsiLogicController'),1,0,0.0,2638
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'ns0:VirtualEthernetCardDistributedVirtualPortBackingInfo',1,0,0.0,2639
7a60b5c406336c5f410d1a98868c3f93d888ea0c,client_factory.create(backing_name),1,0,0.0,2640
7a60b5c406336c5f410d1a98868c3f93d888ea0c,client_factory.create('ns0:DistributedVirtualSwitchPortConnection'),1,0,0.0,2641
7a60b5c406336c5f410d1a98868c3f93d888ea0c,client_factory.create('ns0:VirtualEthernetCardNetworkBackingInfo'),1,0,0.0,2642
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"info['gateway'],",1,0,0.0,2643
7a60b5c406336c5f410d1a98868c3f93d888ea0c,dns),1,0,0.0,2644
7a60b5c406336c5f410d1a98868c3f93d888ea0c,check_exit_code=False)):,0,0,0.0,2645
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vm_util.get_machine_id_change_spec(client_factory, machine_id_str)",1,0,0.0,2646
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for wbem_network_adapter in wbem_network_adapters:,0,0,0.0,2647
7a60b5c406336c5f410d1a98868c3f93d888ea0c,wbem_network_adapter.associators_(,0,0,0.0,2648
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'Win32_NetworkAdapterSetting',",0,0,0.0,2649
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'Win32_NetworkAdapterConfiguration')[0],0,0,0.0,2650
7a60b5c406336c5f410d1a98868c3f93d888ea0c,#wbem_network_adapter_config.DefaultIPGateway[0],0,0,0.0,2651
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'subnet-mask': subnet_mask}),0,0,0.0,2652
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import fcntl,0,0,0.0,2653
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"0x8912,",0,0,0.0,2654
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"struct.pack('iL', max_bytes, names.buffer_info()[0])))[0]",0,0,0.0,2655
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"for n_counter in xrange(0, outbytes, offset2)]",0,0,0.0,2656
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"0x8915,",0,0,0.0,2657
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"struct.pack('256s', adapter_name))[20:24])",0,0,0.0,2658
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"0x891b,",0,0,0.0,2659
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"0x8927,",0,0,0.0,2660
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"struct.pack('256s', adapter_name))[18:24])",0,0,0.0,2661
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"for m_counter in range(0, len(raw_mac_address), 2)]).lower()",0,0,0.0,2662
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for network_adapter in network_adapters:,0,0,0.0,2663
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get Windows network adapter name.""""""",0,0,0.0,2664
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Get Linux network adapter name.""""""",0,0,0.0,2665
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"stdout=subprocess.PIPE, stderr=subprocess.PIPE, env=env)",0,0,0.0,2666
7a60b5c406336c5f410d1a98868c3f93d888ea0c,obj.stdin.close(),0,0,0.0,2667
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"stdout=stdout,",0,0,0.0,2668
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"stderr=stderr,",0,0,0.0,2669
7a60b5c406336c5f410d1a98868c3f93d888ea0c,cmd=cmd),0,0,0.0,2670
7a60b5c406336c5f410d1a98868c3f93d888ea0c,time.sleep(0.1),0,0,0.0,2671
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'vmtoolsd.exe')):,0,0,0.0,2672
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'VMwareService.exe')):,0,0,0.0,2673
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import win32com.client,0,0,0.0,2674
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_info_list[k].strip().lower(),",0,0,0.0,2675
7a60b5c406336c5f410d1a98868c3f93d888ea0c,network_details.append((,0,0,0.0,2676
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import struct,0,0,0.0,2677
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""install"")",1,0,0.0,2678
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"cmp_version(version, agent_build['version']) < 0:",1,0,0.0,2679
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._create_snapshot(instance),1,0,0.0,2680
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"VMHelper.get_vdi_for_vm_safely(self._session, vm_ref)",1,0,0.0,2681
7a60b5c406336c5f410d1a98868c3f93d888ea0c,instance['root_gb'] > instance_type['root_gb']:,1,0,0.0,2682
7a60b5c406336c5f410d1a98868c3f93d888ea0c,On Windows we require pyWin32 installed on Python.,0,0,0.0,2683
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import array,0,0,0.0,2684
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import gettext,0,0,0.0,2685
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import logging,0,0,0.0,2686
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import os,0,0,0.0,2687
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import platform,0,0,0.0,2688
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import socket,0,0,0.0,2689
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import subprocess,0,0,0.0,2690
7a60b5c406336c5f410d1a98868c3f93d888ea0c,while i < no_grps:,0,0,0.0,2691
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import sys,0,0,0.0,2692
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import time,0,0,0.0,2693
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"gettext.install('nova', unicode=1)",0,0,0.0,2694
7a60b5c406336c5f410d1a98868c3f93d888ea0c,else:,0,0,0.0,2695
7a60b5c406336c5f410d1a98868c3f93d888ea0c,os.mkdir(LOG_DIR),0,0,0.0,2696
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"logging.basicConfig(filename=LOG_FILENAME, format=FORMAT)",0,0,0.0,2697
7a60b5c406336c5f410d1a98868c3f93d888ea0c,class ProcessExecutionError:,0,0,0.0,2698
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Process Execution Error Class.""""""",0,0,0.0,2699
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for byt in bytes:,0,0,0.0,2700
7a60b5c406336c5f410d1a98868c3f93d888ea0c,pass,0,0,0.0,2701
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for machine_id_str in machine_id[0].split('#'):,0,0,0.0,2702
7a60b5c406336c5f410d1a98868c3f93d888ea0c,break,0,0,0.0,2703
7a60b5c406336c5f410d1a98868c3f93d888ea0c,from nova import db,1,0,0.0,2704
7a60b5c406336c5f410d1a98868c3f93d888ea0c,from nova import block_device,0,0,0.0,2705
7a60b5c406336c5f410d1a98868c3f93d888ea0c,from nova.compute import api as compute,0,0,0.0,2706
7a60b5c406336c5f410d1a98868c3f93d888ea0c,instance=instance),1,0,0.0,2707
7a60b5c406336c5f410d1a98868c3f93d888ea0c,driver.block_device_info_get_ephemerals(,0,0,0.0,2708
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""block_device_list %s""), block_device_list)",0,0,0.0,2709
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'suspended': power_state.PAUSED},1,0,0.0,2710
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""Datastore"", [""summary.type"", ""summary.name""])",1,0,0.0,2711
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for elem in data_stores:,1,0,0.0,2712
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for prop in elem.propSet:,1,0,0.0,2713
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.error(msg, instance=instance)",1,0,0.0,2714
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"instance.image_ref,",1,0,0.0,2715
7a60b5c406336c5f410d1a98868c3f93d888ea0c,instance),1,0,0.0,2716
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""Datacenter"", [""vmFolder""])",1,0,0.0,2717
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""ResourcePool"")[0].obj",1,0,0.0,2718
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""CreateVM_Task"", vm_folder_mor,",1,0,0.0,2719
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"config=config_spec, pool=res_pool_mor)",1,0,0.0,2720
7a60b5c406336c5f410d1a98868c3f93d888ea0c,flat_uploaded_vmdk_name),1,0,0.0,2721
7a60b5c406336c5f410d1a98868c3f93d888ea0c,uploaded_vmdk_name),1,0,0.0,2722
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vmdk_file_size_in_kb, adapter_type)",1,0,0.0,2723
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"datacenter=self._get_datacenter_name_and_ref()[0],",1,0,0.0,2724
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_create_virtual_disk(),1,0,0.0,2725
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"{""flat_uploaded_vmdk_path"": flat_uploaded_vmdk_path,",1,0,0.0,2726
7a60b5c406336c5f410d1a98868c3f93d888ea0c,name=flat_uploaded_vmdk_path),1,0,0.0,2727
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_delete_disk_file(),1,0,0.0,2728
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"{'image_ref': instance.image_ref,",1,0,0.0,2729
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"data_center_name=self._get_datacenter_name_and_ref()[1],",1,0,0.0,2730
7a60b5c406336c5f410d1a98868c3f93d888ea0c,file_path=flat_uploaded_vmdk_name),1,0,0.0,2731
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_fetch_image_on_esx_datastore(),1,0,0.0,2732
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"client_factory,",1,0,0.0,2733
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"adapter_type, ""preallocated"",",1,0,0.0,2734
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for ephemeral in,0,0,0.0,2735
7a60b5c406336c5f410d1a98868c3f93d888ea0c,block_device.strip_dev(swap['device_name'])),0,0,0.0,2736
7a60b5c406336c5f410d1a98868c3f93d888ea0c,block_device_list.append(,0,0,0.0,2737
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""get_dynamic_property"",",0,0,0.0,2738
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"client_factory, port, password)",0,0,0.0,2739
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""ReconfigVM_Task"", vm_ref,",0,0,0.0,2740
7a60b5c406336c5f410d1a98868c3f93d888ea0c,spec=vnc_config_spec),0,0,0.0,2741
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._session._wait_for_task(instance['uuid'], reconfig_task)",0,0,0.0,2742
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""HostSystem"", [""name""])",0,0,0.0,2743
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""Datacenter"", [""vmFolder""])",0,0,0.0,2744
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""ResourcePool"")[0].obj",0,0,0.0,2745
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""SearchDatastore_Task"",",0,0,0.0,2746
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"ds_browser,",0,0,0.0,2747
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"datastorePath=ds_path,",0,0,0.0,2748
7a60b5c406336c5f410d1a98868c3f93d888ea0c,searchSpec=search_spec),0,0,0.0,2749
7a60b5c406336c5f410d1a98868c3f93d888ea0c,while True:,0,0,0.0,2750
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"search_task, ""Task"", ""info"")",0,0,0.0,2751
7a60b5c406336c5f410d1a98868c3f93d888ea0c,block_device_info)],0,0,0.0,2752
7a60b5c406336c5f410d1a98868c3f93d888ea0c,time.sleep(2),0,0,0.0,2753
7a60b5c406336c5f410d1a98868c3f93d888ea0c,continue,0,0,0.0,2754
7a60b5c406336c5f410d1a98868c3f93d888ea0c,break,0,0,0.0,2755
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"folder_name, file_name):",0,0,0.0,2756
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"ds_ref,",0,0,0.0,2757
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""Datastore"",",0,0,0.0,2758
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""browser"")",0,0,0.0,2759
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"folder_path,",0,0,0.0,2760
7a60b5c406336c5f410d1a98868c3f93d888ea0c,file_name),0,0,0.0,2761
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._mkdir(vm_util.build_datastore_path(ds_name, folder_name))",0,0,0.0,2762
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for vol in,0,0,0.0,2763
7a60b5c406336c5f410d1a98868c3f93d888ea0c,driver.block_device_info_get_mapping(,0,0,0.0,2764
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"uploaded_vmdk_path, vmdk_file_size_in_kb)",1,0,0.0,2765
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._session._get_vim(),",1,0,0.0,2766
7a60b5c406336c5f410d1a98868c3f93d888ea0c,from nova import context as nova_context,0,0,0.0,2767
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""ReconfigVM_Task"", vm_ref,",1,0,0.0,2768
7a60b5c406336c5f410d1a98868c3f93d888ea0c,else:,0,0,0.0,2769
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for prop in dynamic_properties:,0,0,0.0,2770
7a60b5c406336c5f410d1a98868c3f93d888ea0c,from nova.openstack.common import uuidutils,0,0,0.0,2771
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"datacenter=dc_ref,",0,0,0.0,2772
7a60b5c406336c5f410d1a98868c3f93d888ea0c,instance=instance),0,0,0.0,2773
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._session._get_vim(),",0,0,0.0,2774
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""DeleteDatastoreFile_Task"",",0,0,0.0,2775
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vim.get_service_content().fileManager,",0,0,0.0,2776
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"name=datastore_path,",0,0,0.0,2777
7a60b5c406336c5f410d1a98868c3f93d888ea0c,datacenter=dc_ref),0,0,0.0,2778
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._session._wait_for_task(instance['uuid'],",0,0,0.0,2779
7a60b5c406336c5f410d1a98868c3f93d888ea0c,file_delete_task),0,0,0.0,2780
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._delete_datastore_file(instance,",0,0,0.0,2781
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"flat_uploaded_vmdk_path,",0,0,0.0,2782
7a60b5c406336c5f410d1a98868c3f93d888ea0c,dc_ref),0,0,0.0,2783
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"sparse_uploaded_vmdk_path,",0,0,0.0,2784
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"destName=dest_vmdk_file_path,",0,0,0.0,2785
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"for f in dest_vmdk_data_file_path, dest_vmdk_file_path:",0,0,0.0,2786
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._delete_datastore_file(instance, f, dc_ref)",0,0,0.0,2787
7a60b5c406336c5f410d1a98868c3f93d888ea0c,import uuid,1,0,0.0,2788
7a60b5c406336c5f410d1a98868c3f93d888ea0c,datacenter):,1,0,0.0,2789
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"datacenter=datacenter,",1,0,0.0,2790
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"{""vmdk_path"": vmdk_path,",1,0,0.0,2791
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""data_store_name"": data_store_name},",1,0,0.0,2792
7a60b5c406336c5f410d1a98868c3f93d888ea0c,instance=instance),1,0,0.0,2793
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._session._get_vim(),",1,0,0.0,2794
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""DeleteDatastoreFile_Task"",",1,0,0.0,2795
7a60b5c406336c5f410d1a98868c3f93d888ea0c,from nova import utils,0,0,0.0,2796
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.vim.Logout(self.vim.get_service_content().sessionManager),1,0,0.0,2797
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"api_retry_count, scheme=""https""):",1,0,0.0,2798
7a60b5c406336c5f410d1a98868c3f93d888ea0c,instance['uuid']),0,0,0.0,2799
7a60b5c406336c5f410d1a98868c3f93d888ea0c,spec=vmdk_attach_config_spec),1,0,0.0,2800
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._session._wait_for_task(instance['uuid'], reconfig_task)",1,0,0.0,2801
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_attach_vmdk_to_the_vm(),1,0,0.0,2802
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmdk_file_path_before_snapshot)[0],1,0,0.0,2803
7a60b5c406336c5f410d1a98868c3f93d888ea0c,adapter_type),1,0,0.0,2804
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""UnregisterVM"", vm_ref)",1,0,0.0,2805
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self.unplug_vifs(instance, network_info)",1,0,0.0,2806
7a60b5c406336c5f410d1a98868c3f93d888ea0c,name=dir_ds_compliant_path),1,0,0.0,2807
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""without doing anything""), instance=instance)",1,0,0.0,2808
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""VirtualMachine"", [""name""])",1,0,0.0,2809
7a60b5c406336c5f410d1a98868c3f93d888ea0c,for vm in vms:,1,0,0.0,2810
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._volumeops.attach_volume(connection_info, instance['uuid'],",0,0,0.0,2811
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""Rename_Task"", vm_ref, newName=instance['uuid'])",0,0,0.0,2812
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"api_retry_count, scheme=scheme)",1,0,0.0,2813
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._volumeops.attach_volume(connection_info, instance['name'],",1,0,0.0,2814
7a60b5c406336c5f410d1a98868c3f93d888ea0c,instance['name']),1,0,0.0,2815
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""instance not present""), instance=instance)",1,0,0.0,2816
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""Rename_Task"", vm_ref, newName=instance['name'])",1,0,0.0,2817
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"username=CONF.vmware.host_username,",0,0,0.0,2818
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"password=CONF.vmware.host_password,",0,0,0.0,2819
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"retry_count=CONF.vmware.api_retry_count,",0,0,0.0,2820
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"scheme=""https""):",0,0,0.0,2821
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""sleeping for %(seconds)s seconds""),",0,0,0.0,2822
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"{'server': self._host_ip, 'seconds': delay})",0,0,0.0,2823
7a60b5c406336c5f410d1a98868c3f93d888ea0c,time.sleep(delay),0,0,0.0,2824
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.vim.Logout(self.vim.get_service_content().sessionManager),0,0,0.0,2825
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Return VNC port for an VM.""""""",0,0,0.0,2826
7a60b5c406336c5f410d1a98868c3f93d888ea0c,@staticmethod,0,0,0.0,2827
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'internal_access_path': None},0,0,0.0,2828
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'port': self._get_vnc_port(vm_ref),",0,0,0.0,2829
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""CopyVirtualDisk_Task"",",0,0,0.0,2830
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"service_content.virtualDiskManager,",0,0,0.0,2831
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"sourceName=sparse_uploaded_vmdk_path,",0,0,0.0,2832
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"sourceDatacenter=self._get_datacenter_ref_and_name()[0],",0,0,0.0,2833
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"destName=uploaded_vmdk_path,",0,0,0.0,2834
7a60b5c406336c5f410d1a98868c3f93d888ea0c,destSpec=vmdk_copy_spec),0,0,0.0,2835
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._session._wait_for_task(instance['uuid'], vmdk_copy_task)",0,0,0.0,2836
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""data_store_name"": data_store_name},",0,0,0.0,2837
7a60b5c406336c5f410d1a98868c3f93d888ea0c,instance=instance),0,0,0.0,2838
7a60b5c406336c5f410d1a98868c3f93d888ea0c,block_device_info),0,0,0.0,2839
7a60b5c406336c5f410d1a98868c3f93d888ea0c,else:,0,0,0.0,2840
7a60b5c406336c5f410d1a98868c3f93d888ea0c,uploaded_vmdk_name),0,0,0.0,2841
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"data_store_ref, data_store_name,",0,0,0.0,2842
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"upload_folder, upload_name)",0,0,0.0,2843
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"data_store_name,",0,0,0.0,2844
7a60b5c406336c5f410d1a98868c3f93d888ea0c,flat_uploaded_vmdk_name),0,0,0.0,2845
7a60b5c406336c5f410d1a98868c3f93d888ea0c,sparse_uploaded_vmdk_name),0,0,0.0,2846
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_create_virtual_disk(),0,0,0.0,2847
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_delete_disk_file(flat_uploaded_vmdk_path),0,0,0.0,2848
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._session._get_vim().client.options.transport.cookiejar,0,0,0.0,2849
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_fetch_image_on_esx_datastore(),0,0,0.0,2850
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_copy_virtual_disk(),0,0,0.0,2851
7a60b5c406336c5f410d1a98868c3f93d888ea0c,_delete_disk_file(sparse_uploaded_vmdk_path),0,0,0.0,2852
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._volumeops.attach_disk_to_vm(,0,0,0.0,2853
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"adapter_type, disk_type, uploaded_vmdk_path,",0,0,0.0,2854
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vmdk_file_size_in_kb, linked_clone)",0,0,0.0,2855
7a60b5c406336c5f410d1a98868c3f93d888ea0c,block_device_info)[0],0,0,0.0,2856
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._session._get_vim(),",0,0,0.0,2857
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""disk_type"": disk_type},",0,0,0.0,2858
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""data_store_name"": data_store_name,",0,0,0.0,2859
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""CreateVM_Task"", vm_folder_ref,",0,0,0.0,2860
7a60b5c406336c5f410d1a98868c3f93d888ea0c,from nova.openstack.common import excutils,0,0,0.0,2861
7a60b5c406336c5f410d1a98868c3f93d888ea0c,from nova.openstack.common import timeutils,0,0,0.0,2862
7a60b5c406336c5f410d1a98868c3f93d888ea0c,from nova.virt import driver,0,0,0.0,2863
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"CONF.import_opt('vnc_enabled', 'nova.vnc')",0,0,0.0,2864
7a60b5c406336c5f410d1a98868c3f93d888ea0c,'suspended': power_state.SUSPENDED},0,0,0.0,2865
7a60b5c406336c5f410d1a98868c3f93d888ea0c,block_device_info=None):,0,0,0.0,2866
7a60b5c406336c5f410d1a98868c3f93d888ea0c,2. For flat disk,0,0,0.0,2867
7a60b5c406336c5f410d1a98868c3f93d888ea0c,3. For sparse disk,0,0,0.0,2868
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"instance['image_ref'],",0,0,0.0,2869
7a60b5c406336c5f410d1a98868c3f93d888ea0c,instance),0,0,0.0,2870
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""preallocated"")",0,0,0.0,2871
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"(vmdk_file_size_in_kb, os_type, adapter_type,",0,0,0.0,2872
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"config=config_spec, pool=res_pool_ref)",0,0,0.0,2873
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""adapter_type"": adapter_type,",0,0,0.0,2874
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"vmdk_file_size_in_kb, adapter_type,",0,0,0.0,2875
7a60b5c406336c5f410d1a98868c3f93d888ea0c,disk_type),0,0,0.0,2876
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"datacenter=dc_ref,",0,0,0.0,2877
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""disk_type"": disk_type,",0,0,0.0,2878
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"{""vmdk_path"": vmdk_path,",0,0,0.0,2879
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"name=vmdk_path,",0,0,0.0,2880
7a60b5c406336c5f410d1a98868c3f93d888ea0c,datacenter=dc_ref),0,0,0.0,2881
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"{'image_ref': instance['image_ref'],",0,0,0.0,2882
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"data_center_name=self._get_datacenter_ref_and_name()[1],",0,0,0.0,2883
7a60b5c406336c5f410d1a98868c3f93d888ea0c,file_path=upload_vmdk_name),0,0,0.0,2884
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"'upload_vmdk_name': upload_vmdk_name,",0,0,0.0,2885
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"{""vmdk_file_size_in_kb"": vmdk_file_size_in_kb,",0,0,0.0,2886
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._volumeops.attach_volume(connection_info, instance['name'],",0,0,0.0,2887
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self._default_root_device),0,0,0.0,2888
7a60b5c406336c5f410d1a98868c3f93d888ea0c,vmdk_file_path_before_snapshot)[0],0,0,0.0,2889
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"network_info, image_meta, resize_instance=False):",0,0,0.0,2890
7a60b5c406336c5f410d1a98868c3f93d888ea0c,total_steps=RESIZE_TOTAL_STEPS),0,0,0.0,2891
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"step=1,",0,0,0.0,2892
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""Rename_Task"", vm_ref, newName=name_label)",0,0,0.0,2893
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._session._wait_for_task(instance['uuid'], rename_task)",0,0,0.0,2894
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"step=2,",0,0,0.0,2895
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""CloneVM_Task"", vm_ref,",0,0,0.0,2896
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"folder=vm_folder_ref,",0,0,0.0,2897
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"name=instance['name'],",0,0,0.0,2898
7a60b5c406336c5f410d1a98868c3f93d888ea0c,spec=clone_spec),0,0,0.0,2899
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._session._wait_for_task(instance['uuid'], vm_clone_task)",0,0,0.0,2900
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"step=3,",0,0,0.0,2901
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""Rename_Task"", vm_ref, newName=instance['name'])",0,0,0.0,2902
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"step=4,",0,0,0.0,2903
7a60b5c406336c5f410d1a98868c3f93d888ea0c,instance_type):,0,0,0.0,2904
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"post_method, recover_method, block_migration=False):",0,0,0.0,2905
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Spawning live_migration operation for distributing high-load.""""""",0,0,0.0,2906
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""MigrateVM_Task"", vm_ref,",0,0,0.0,2907
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"host=host_ref,",0,0,0.0,2908
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"priority=""defaultPriority"")",0,0,0.0,2909
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._session._wait_for_task(instance_ref['uuid'], vm_migrate_task)",0,0,0.0,2910
7a60b5c406336c5f410d1a98868c3f93d888ea0c,except Exception:,0,0,0.0,2911
7a60b5c406336c5f410d1a98868c3f93d888ea0c,with excutils.save_and_reraise_exception():,0,0,0.0,2912
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"recover_method(context, instance_ref, dest, block_migration)",0,0,0.0,2913
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"post_method(context, instance_ref, dest, block_migration)",0,0,0.0,2914
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""""""Poll for rebooting instances.""""""",0,0,0.0,2915
7a60b5c406336c5f410d1a98868c3f93d888ea0c,timeout=timeout),0,0,0.0,2916
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"step=0,",0,0,0.0,2917
7a60b5c406336c5f410d1a98868c3f93d888ea0c,{'progress': progress}),0,0,0.0,2918
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"adapter_type,",0,0,0.0,2919
7a60b5c406336c5f410d1a98868c3f93d888ea0c,datacenter=self._get_datacenter_ref_and_name()[0]),0,0,0.0,2920
7a60b5c406336c5f410d1a98868c3f93d888ea0c,try:,0,0,0.0,2921
7a60b5c406336c5f410d1a98868c3f93d888ea0c,instance['name']),0,0,0.0,2922
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.debug(_(""instance not present""), instance=instance)",0,0,0.0,2923
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.power_off(instance),0,0,0.0,2924
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""Destroy_Task"", vm_ref)",0,0,0.0,2925
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._session._wait_for_task(instance['uuid'], destroy_task)",0,0,0.0,2926
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.warn(_(""In vmwareapi:vmops:delete, got this exception""",0,0,0.0,2927
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self.unplug_vifs(instance, network_info)",0,0,0.0,2928
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"except Exception, exc:",0,0,0.0,2929
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"LOG.exception(exc, instance=instance)",0,0,0.0,2930
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""UnregisterVM"", vm_ref)",0,0,0.0,2931
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"name=dir_ds_compliant_path,",0,0,0.0,2932
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""without doing anything""), instance=instance)",0,0,0.0,2933
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._virtapi.instance_update(context, instance_uuid,",0,0,0.0,2934
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""get_dynamic_property"", vm_ref,",0,0,0.0,2935
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""VirtualMachine"", ""config.hardware.device"")",0,0,0.0,2936
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"adapter_type, disk_type, vmdk_path,",0,0,0.0,2937
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"controller_key=controller_key,",0,0,0.0,2938
7a60b5c406336c5f410d1a98868c3f93d888ea0c,unit_number=unit_number),0,0,0.0,2939
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self.destroy(instance, None)",0,0,0.0,2940
7a60b5c406336c5f410d1a98868c3f93d888ea0c,self.power_on(instance),0,0,0.0,2941
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""VirtualMachine"", ""runtime.powerState"")",0,0,0.0,2942
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""PowerOffVM_Task"", vm_ref)",0,0,0.0,2943
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._session._wait_for_task(instance['uuid'], poweroff_task)",0,0,0.0,2944
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"""PowerOnVM_Task"", vm_ref)",0,0,0.0,2945
7a60b5c406336c5f410d1a98868c3f93d888ea0c,"self._session._wait_for_task(instance['uuid'], poweron_task)",0,0,0.0,2946
7a60b5c406336c5f410d1a98868c3f93d888ea0c,else:,1,0,0.0,2947
