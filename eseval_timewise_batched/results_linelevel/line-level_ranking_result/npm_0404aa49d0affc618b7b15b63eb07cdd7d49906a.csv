commit_id,line,line_level_label,count,line_score,row
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"addLocalTarball(tmp, null, null, function(er, data) {",1,6,1.0,1
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"tar.unpack(tgz, target, null, null, cs.uid, cs.gid, function (er, data) {",0,5,0.8333333333333333,2
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"function addLocalTarball (p, pkgData, shasum, cb) {",0,4,0.6666666666666666,3
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"addTmpTarball(p, pkgData, shasum, function (er, data) {",0,4,0.6666666666666666,4
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"addTmpTarball_(tgz, data, shasum, cb)",0,4,0.6666666666666666,5
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"function addLocalTarball (p, pkgData, shasum, cb_) {",1,4,0.6666666666666666,6
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"function cb (er, data) {",1,4,0.6666666666666666,7
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"addTmpTarball_(tgz, data, shasum, cb)",1,4,0.6666666666666666,8
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"addLocal(spec, null, function (er, data) {",0,4,0.6666666666666666,9
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"readJson(pj, function (er, data) {",1,3,0.5,10
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"function archiveGitRemote (p, u, co, origUrl, cb) {",1,3,0.5,11
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"function cache (p, u, treeish, resolved, cb) {",0,3,0.5,12
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"function fetchRemote (p, u, co, origUrl, cb) {",0,3,0.5,13
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"function needVersion(er, data) {",1,3,0.5,14
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"function needName(er, data) {",1,3,0.5,15
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"function resolveHead (p, u, co, origUrl, cb) {",0,3,0.5,16
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"addTmpTarball_(tgz, pkgData, shasum, cb)",1,3,0.5,17
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"addLocalTarball(p, pkgData, shasum, cb_)",1,3,0.5,18
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"// If we don't have a shasum yet, then get the shasum now.",1,3,0.5,19
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"return addTmpTarball_(tgz, pkgData, shasum, cb)",0,3,0.5,20
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"addLocalTarball(p, pkgData, shasum, cb)",0,3,0.5,21
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"// then unzip to .tmp, add the tmp folder, and clean up tmp",1,3,0.5,22
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"git.whichAndExec(args, {cwd: p, env: env}, function (er, stdout, stderr) {",1,2,0.3333333333333333,23
0404aa49d0affc618b7b15b63eb07cdd7d49906a,return er ? er,1,2,0.3333333333333333,24
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"function (er, stdout, stderr) {",0,2,0.3333333333333333,25
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"{ cwd : p, env : gitEnv() },",0,2,0.3333333333333333,26
0404aa49d0affc618b7b15b63eb07cdd7d49906a,} else {,0,2,0.3333333333333333,27
0404aa49d0affc618b7b15b63eb07cdd7d49906a,else {,0,2,0.3333333333333333,28
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"{ cwd : tmp, env : gitEnv() },",0,2,0.3333333333333333,29
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"realizePackageSpecifier(tmp, function (er, spec) {",0,2,0.3333333333333333,30
0404aa49d0affc618b7b15b63eb07cdd7d49906a,function resolveHead () {,1,2,0.3333333333333333,31
0404aa49d0affc618b7b15b63eb07cdd7d49906a,} else {,1,2,0.3333333333333333,32
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"git.whichAndExec(archive, {cwd: p, env: env}, function (er, stdout, stderr) {",1,2,0.3333333333333333,33
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"git.whichAndExec(resolve, {cwd: p, env: env}, function (er, stdout, stderr) {",1,2,0.3333333333333333,34
0404aa49d0affc618b7b15b63eb07cdd7d49906a,function next () {,1,2,0.3333333333333333,35
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"mkdir(path.dirname(tmp), function (er) {",1,2,0.3333333333333333,36
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"var cp = git.spawn(args, { env: env, cwd: p })",1,2,0.3333333333333333,37
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"er = needName(er, data)",1,2,0.3333333333333333,38
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"er = needVersion(er, data)",1,2,0.3333333333333333,39
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"{ cwd : p, env : gitEnv },",0,2,0.3333333333333333,40
0404aa49d0affc618b7b15b63eb07cdd7d49906a,function next (er) {,1,2,0.3333333333333333,41
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"return addTmpTarball(p, pkgData, shasum, cb_)",1,2,0.3333333333333333,42
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"tar.unpack(tgz, target, null, null, cs.uid, cs.gid, next)",1,2,0.3333333333333333,43
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"assert(typeof cb === ""function"", ""must have callback"")",0,2,0.3333333333333333,44
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"// If we don't have a shasum yet, compute it.",0,2,0.3333333333333333,45
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"assert(shasum, ""must have shasum by now"")",0,2,0.3333333333333333,46
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"randomBytes(6, function (er, random) {",0,2,0.3333333333333333,47
0404aa49d0affc618b7b15b63eb07cdd7d49906a,else if (pkgData.name && data.name !== pkgData.name) {,0,2,0.3333333333333333,48
0404aa49d0affc618b7b15b63eb07cdd7d49906a,else if (pkgData.version && data.version !== pkgData.version) {,0,2,0.3333333333333333,49
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"var name = pkgData.name || """"",1,2,0.3333333333333333,50
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"return addPlacedTarball(p, pkgData, shasum, cb)",0,2,0.3333333333333333,51
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"return addPlacedTarball(p, pkgData, shasum, cb_)",1,2,0.3333333333333333,52
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"mkdir(path.dirname(tmp), function (er) {",1,2,0.3333333333333333,53
0404aa49d0affc618b7b15b63eb07cdd7d49906a,function errHandler (er) {,1,2,0.3333333333333333,54
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"to.on(""close"", function () {",1,2,0.3333333333333333,55
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"addTmpTarball(tmp, pkgData, shasum, cb)",1,2,0.3333333333333333,56
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"var tmp = path.join(npm.tmp, name + Date.now()",1,2,0.3333333333333333,57
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"assert(shasum, ""should have shasum by now"")",1,2,0.3333333333333333,58
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"[ ""clone"", p, tmp ],",0,1,0.16666666666666666,59
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"archiveGitRemote(p, u, co, origUrl, cb)",1,1,0.16666666666666666,60
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"cloneGitRemote(p, u, co, origUrl, silent, cb)",1,1,0.16666666666666666,61
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"return rm(p, function (er){",1,1,0.16666666666666666,62
0404aa49d0affc618b7b15b63eb07cdd7d49906a,if (er || u !== stdout.trim()) {,1,1,0.16666666666666666,63
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"cb(er, data)",0,1,0.16666666666666666,64
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"if (spo[1].charAt(0) === "":"" && spr[1].charAt(0) === ""/"") {",0,1,0.16666666666666666,65
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"var tmp = path.join(npm.tmp, Date.now()+""-""+Math.random(), treeish)",0,1,0.16666666666666666,66
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"cache(p, u, stdout, resolved, cb)",0,1,0.16666666666666666,67
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"resolveHead(p, u, co, origUrl, cb)",0,1,0.16666666666666666,68
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"getCacheStat(function(er, cs) {",0,1,0.16666666666666666,69
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"if (process.platform === ""win32"") {",0,1,0.16666666666666666,70
0404aa49d0affc618b7b15b63eb07cdd7d49906a,if (er) {,1,1,0.16666666666666666,71
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"""_git_remotes"", ""_templates""), ""--mirror"", u, p ]",1,1,0.16666666666666666,72
0404aa49d0affc618b7b15b63eb07cdd7d49906a,cb = once(cb),1,1,0.16666666666666666,73
0404aa49d0affc618b7b15b63eb07cdd7d49906a,if (silent) {,1,1,0.16666666666666666,74
0404aa49d0affc618b7b15b63eb07cdd7d49906a,var resolved = null,1,1,0.16666666666666666,75
0404aa49d0affc618b7b15b63eb07cdd7d49906a,var tmp,1,1,0.16666666666666666,76
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"tmp = path.join(npm.tmp, Date.now()+""-""+Math.random(), ""tmp.tgz"")",1,1,0.16666666666666666,77
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"if (process.platform === ""win32"") {",1,1,0.16666666666666666,78
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"getCacheStat(function(er, cs) {",1,1,0.16666666666666666,79
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"chownr(p, cs.uid, cs.gid, function(er) {",1,1,0.16666666666666666,80
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"if (parsed.protocol !== ""git:"") {",1,1,0.16666666666666666,81
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"cp.on(""error"", cb)",1,1,0.16666666666666666,82
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"cp.stderr.on(""data"", function(chunk) {",1,1,0.16666666666666666,83
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"cp.stdout.pipe(gzip).pipe(out).on(""close"", function() {",1,1,0.16666666666666666,84
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"cb(er, data)",1,1,0.16666666666666666,85
0404aa49d0affc618b7b15b63eb07cdd7d49906a,if (er) {,0,1,0.16666666666666666,86
0404aa49d0affc618b7b15b63eb07cdd7d49906a,if (silent) {,0,1,0.16666666666666666,87
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"chownr(p, cs.uid, cs.gid, function(er) {",0,1,0.16666666666666666,88
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"[ ""clone"", ""--template="" + templates, ""--mirror"", u, p ],",0,1,0.16666666666666666,89
0404aa49d0affc618b7b15b63eb07cdd7d49906a,", to = writeStream(tmp, { mode: npm.modes.file })",1,1,0.16666666666666666,90
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"fetchRemote(p, u, co, origUrl, cb)",0,1,0.16666666666666666,91
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"if (path.basename(p) !== ""package.tgz"") {",0,1,0.16666666666666666,92
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"return cb(new Error(""Not a valid cache tarball name: ""+p))",0,1,0.16666666666666666,93
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"return cb(er, data)",0,1,0.16666666666666666,94
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.verbose(""addTmpTarball"", ""already have metadata; skipping unpack"")",0,1,0.16666666666666666,95
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"// NOTE: we might not have any clue what we think it is, for example if the",0,1,0.16666666666666666,96
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"getCacheStat(function (er, cs) {",0,1,0.16666666666666666,97
0404aa49d0affc618b7b15b63eb07cdd7d49906a,if (!data.name) {,0,1,0.16666666666666666,98
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"return cb(new Error(""No name provided""))",0,1,0.16666666666666666,99
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"return cb(new Error(""No version provided""))",0,1,0.16666666666666666,100
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"assert(typeof cb_ === ""function"", ""must have callback"")",1,1,0.16666666666666666,101
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"""Not a valid cache tarball name: ""+p))",1,1,0.16666666666666666,102
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"return cb_(er, data)",1,1,0.16666666666666666,103
0404aa49d0affc618b7b15b63eb07cdd7d49906a,// just copy it over and then add the temp tarball file.,1,1,0.16666666666666666,104
0404aa49d0affc618b7b15b63eb07cdd7d49906a,if (!data.version) {,0,1,0.16666666666666666,105
0404aa49d0affc618b7b15b63eb07cdd7d49906a,", errState = null",1,1,0.16666666666666666,106
0404aa49d0affc618b7b15b63eb07cdd7d49906a,if (!er && pkgData.version && pkgData.version !== data.version) {,1,1,0.16666666666666666,107
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"// Note: we might not have any clue what we think it is, for",1,1,0.16666666666666666,108
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"cloneGitRemote(p, u, co, origUrl, silent, cb)",0,1,0.16666666666666666,109
0404aa49d0affc618b7b15b63eb07cdd7d49906a,if (er || u !== stdout.trim()) {,0,1,0.16666666666666666,110
0404aa49d0affc618b7b15b63eb07cdd7d49906a,": (data && !data.version) ? new Error(""No version provided"")",1,1,0.16666666666666666,111
0404aa49d0affc618b7b15b63eb07cdd7d49906a,": (data && !data.name) ? new Error(""No name provided"")",1,1,0.16666666666666666,112
0404aa49d0affc618b7b15b63eb07cdd7d49906a,: null,1,1,0.16666666666666666,113
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"er = new Error( ""Invalid Package: expected """,1,1,0.16666666666666666,114
0404aa49d0affc618b7b15b63eb07cdd7d49906a,if (!er && pkgData.name && pkgData.name !== data.name) {,1,1,0.16666666666666666,115
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"getCacheStat(function (er, cs) {",1,1,0.16666666666666666,116
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"var target = tgz + ""-unpack""",1,1,0.16666666666666666,117
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"return rm(p, function (er){",0,1,0.16666666666666666,118
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.verbose(""git checkout"", stdout)",0,0,0.0,119
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.error(""Failed to clone ""+resolved+"" from ""+u, stderr)",0,0,0.0,120
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.verbose(""git clone"", ""from"", p)",0,0,0.0,121
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.verbose(""git clone"", stdout)",0,0,0.0,122
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"[ ""checkout"", treeish ],",0,0,0.0,123
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.error(""Failed to check out ""+treeish, stderr)",0,0,0.0,124
0404aa49d0affc618b7b15b63eb07cdd7d49906a,", once = require(""once"")",1,0,0.0,125
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.error(""Failed to map"", tmp, ""to a package specifier"")",0,0,0.0,126
0404aa49d0affc618b7b15b63eb07cdd7d49906a,// https://github.com/npm/npm/issues/6400,0,0,0.0,127
0404aa49d0affc618b7b15b63eb07cdd7d49906a,// ensure pack logic is applied,0,0,0.0,128
0404aa49d0affc618b7b15b63eb07cdd7d49906a,if (data) data._resolved = resolved,0,0,0.0,129
0404aa49d0affc618b7b15b63eb07cdd7d49906a,", zlib = require(""zlib"")",1,0,0.0,130
0404aa49d0affc618b7b15b63eb07cdd7d49906a,", addLocalTarball = require(""./add-local-tarball.js"")",1,0,0.0,131
0404aa49d0affc618b7b15b63eb07cdd7d49906a,* this has to be two steps.,0,0,0.0,132
0404aa49d0affc618b7b15b63eb07cdd7d49906a,*/,0,0,0.0,133
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.verbose(""git fetch -a origin (""+u+"")"", stdout)",0,0,0.0,134
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"* do a one-step clone to a treeish that isn't guaranteed to be a branch, so",0,0,0.0,135
0404aa49d0affc618b7b15b63eb07cdd7d49906a,* Make an actual clone from the bare (mirrored) cache. There is no safe way to,0,0,0.0,136
0404aa49d0affc618b7b15b63eb07cdd7d49906a,/**,0,0,0.0,137
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"// host won't change, so split and detect this",0,0,0.0,138
0404aa49d0affc618b7b15b63eb07cdd7d49906a,// node incorrectly sticks a / at the start of the path We know that the,0,0,0.0,139
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"if (parsed.protocol !== ""git:"") resolved = ""git+"" + resolved",0,0,0.0,140
0404aa49d0affc618b7b15b63eb07cdd7d49906a,var resolved = url.format(parsed),0,0,0.0,141
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"[ ""rev-list"", ""-n1"", co ],",0,0,0.0,142
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.error(""Failed to change folder ownership under npm cache for %s"", p)",0,0,0.0,143
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.error(""Could not get cache stat"")",0,0,0.0,144
0404aa49d0affc618b7b15b63eb07cdd7d49906a,resolveHead(),0,0,0.0,145
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.silly(""verifyOwnership"", ""skipping for windows"")",0,0,0.0,146
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"var args = [ ""config"", ""--get"", ""remote.origin.url"" ]",1,0,0.0,147
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.error(""git fetch -a origin (""+u+"")"", stdout)",0,0,0.0,148
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"[ ""fetch"", ""-a"", ""origin"" ],",0,0,0.0,149
0404aa49d0affc618b7b15b63eb07cdd7d49906a,", writeStream = require(""fs-write-stream-atomic"")",1,0,0.0,150
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"var resolve = [ ""rev-list"", ""-n1"", co ]",1,0,0.0,151
0404aa49d0affc618b7b15b63eb07cdd7d49906a,var env = gitEnv(),1,0,0.0,152
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.silly(""verifyOwnership"", ""skipping for windows"")",1,0,0.0,153
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.error(""git clone "" + u, stdout)",0,0,0.0,154
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.silly(chunk.toString(), ""git archive"")",1,0,0.0,155
0404aa49d0affc618b7b15b63eb07cdd7d49906a,var out = writeStream(tmp),1,0,0.0,156
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"var args = [""archive"", co, ""--format=tar"", ""--prefix=package/""]",1,0,0.0,157
0404aa49d0affc618b7b15b63eb07cdd7d49906a,var gzip = zlib.createGzip({ level: 9 }),1,0,0.0,158
0404aa49d0affc618b7b15b63eb07cdd7d49906a,next(),1,0,0.0,159
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"if (spo[1].charAt(0) === "":"" && spr[1].charAt(0) === ""/"")",1,0,0.0,160
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"// We know that the host won't change, so split and detect this",1,0,0.0,161
0404aa49d0affc618b7b15b63eb07cdd7d49906a,// node incorrectly sticks a / at the start of the path,1,0,0.0,162
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"resolved = ""git+"" + resolved",1,0,0.0,163
0404aa49d0affc618b7b15b63eb07cdd7d49906a,resolved = url.format(parsed),1,0,0.0,164
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.error(""Failed to change folder ownership under npm cache for %s"", p)",1,0,0.0,165
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.error(""Could not get cache stat"")",1,0,0.0,166
0404aa49d0affc618b7b15b63eb07cdd7d49906a,resolveHead(),1,0,0.0,167
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.verbose(""git fetch -a origin (""+u+"")"", stdout)",1,0,0.0,168
0404aa49d0affc618b7b15b63eb07cdd7d49906a,// check for git,1,0,0.0,169
0404aa49d0affc618b7b15b63eb07cdd7d49906a,},1,0,0.0,170
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.error(""git fetch -a origin (""+u+"")"", stdout)",1,0,0.0,171
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"var archive = [ ""fetch"", ""-a"", ""origin"" ]",1,0,0.0,172
0404aa49d0affc618b7b15b63eb07cdd7d49906a,return cb(er),1,0,0.0,173
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.error(""git clone "" + u, stdout)",1,0,0.0,174
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.verbose(""git clone "" + u, stdout)",1,0,0.0,175
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"stdout = (stdout + ""\n"" + stderr).trim()",1,0,0.0,176
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"var args = [ ""clone"", ""--template="" + path.join(npm.config.get(""cache""),",1,0,0.0,177
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.verbose(""git remote.origin.url"", stdoutTrimmed)",1,0,0.0,178
0404aa49d0affc618b7b15b63eb07cdd7d49906a,}),1,0,0.0,179
0404aa49d0affc618b7b15b63eb07cdd7d49906a,if (er) return cb(er),1,0,0.0,180
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"+ ""wrong result (""+u+"")"", stdoutTrimmed )",1,0,0.0,181
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.warn( ""`git config --get remote.origin.url` returned """,1,0,0.0,182
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"var stdoutTrimmed = (stdout + ""\n"" + stderr).trim()",1,0,0.0,183
0404aa49d0affc618b7b15b63eb07cdd7d49906a,return cb(er),0,0,0.0,184
0404aa49d0affc618b7b15b63eb07cdd7d49906a,// This is a tarball we probably downloaded from the internet.  The shasum's,0,0,0.0,185
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.verbose(""git clone "" + u, stdout)",0,0,0.0,186
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"return cb(new Error(""Invalid Package: expected "" + pkgData.name +",0,0,0.0,187
0404aa49d0affc618b7b15b63eb07cdd7d49906a,var from = fs.createReadStream(p),1,0,0.0,188
0404aa49d0affc618b7b15b63eb07cdd7d49906a,if (er) return cb(er),1,0,0.0,189
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"+ ""-"" + Math.random(), ""tmp.tgz"")",1,0,0.0,190
0404aa49d0affc618b7b15b63eb07cdd7d49906a,},1,0,0.0,191
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"if (path.basename(p) !== ""package.tgz"") return cb_(new Error(",1,0,0.0,192
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"if (pathIsInside(p, npm.tmp))",1,0,0.0,193
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"// if it's a tar, and not in place,",1,0,0.0,194
0404aa49d0affc618b7b15b63eb07cdd7d49906a,if (er) return cb_(er),1,0,0.0,195
0404aa49d0affc618b7b15b63eb07cdd7d49906a,", readJson = require(""read-package-json"")",1,0,0.0,196
0404aa49d0affc618b7b15b63eb07cdd7d49906a,}),0,0,0.0,197
0404aa49d0affc618b7b15b63eb07cdd7d49906a,""" but found "" + data.name + ""@"" + data.version))",0,0,0.0,198
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"pkgData.name + ""@"" + pkgData.version +",0,0,0.0,199
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"return cb(new Error(""Invalid Package: expected "" +",0,0,0.0,200
0404aa49d0affc618b7b15b63eb07cdd7d49906a,""" but found "" + data.name))",0,0,0.0,201
0404aa49d0affc618b7b15b63eb07cdd7d49906a,// check that this is what we expected.,0,0,0.0,202
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"stdout = (stdout + ""\n"" + stderr).trim()",0,0,0.0,203
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.verbose(""addTmpTarball"", ""validating metadata from"", tgz)",0,0,0.0,204
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"var target = path.join(npm.tmp, ""unpack-"" + random.toString(""hex""))",0,0,0.0,205
0404aa49d0affc618b7b15b63eb07cdd7d49906a,// generate a unique filename,0,0,0.0,206
0404aa49d0affc618b7b15b63eb07cdd7d49906a,// user just did `npm install ./foo.tgz`,0,0,0.0,207
0404aa49d0affc618b7b15b63eb07cdd7d49906a,//,0,0,0.0,208
0404aa49d0affc618b7b15b63eb07cdd7d49906a,// it here just to make sure it is what it says it is.,0,0,0.0,209
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"// already been checked, but we haven't ever had a peek inside, so we unpack",0,0,0.0,210
0404aa49d0affc618b7b15b63eb07cdd7d49906a,if (!cb) return undefined,0,0,0.0,211
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.verbose(""addLocalTarball"", ""adding from inside cache"", p)",0,0,0.0,212
0404aa49d0affc618b7b15b63eb07cdd7d49906a,},0,0,0.0,213
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.silly(""addLocalTarball"", ""shasum (computed)"", shasum)",0,0,0.0,214
0404aa49d0affc618b7b15b63eb07cdd7d49906a,if (er) return cb(er),0,0,0.0,215
0404aa49d0affc618b7b15b63eb07cdd7d49906a,", randomBytes = require(""crypto"").pseudoRandomBytes // only need uniqueness",0,0,0.0,216
0404aa49d0affc618b7b15b63eb07cdd7d49906a,", log = require(""npmlog"")",0,0,0.0,217
0404aa49d0affc618b7b15b63eb07cdd7d49906a,if (errState) return,1,0,0.0,218
0404aa49d0affc618b7b15b63eb07cdd7d49906a,cb(errState = er),1,0,0.0,219
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"from.on(""error"", errHandler)",1,0,0.0,220
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"to.on(""error"", errHandler)",1,0,0.0,221
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"var templates = path.join(npm.config.get(""cache""), ""_git_remotes"", ""_templates"")",0,0,0.0,222
0404aa49d0affc618b7b15b63eb07cdd7d49906a,),0,0,0.0,223
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.verbose(""git remote.origin.url"", stdoutTrimmed)",0,0,0.0,224
0404aa49d0affc618b7b15b63eb07cdd7d49906a,},0,0,0.0,225
0404aa49d0affc618b7b15b63eb07cdd7d49906a,}),0,0,0.0,226
0404aa49d0affc618b7b15b63eb07cdd7d49906a,if (er) return cb(er),0,0,0.0,227
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"+ ""wrong result (""+u+"")"", stdoutTrimmed )",0,0,0.0,228
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"log.warn( ""`git config --get remote.origin.url` returned """,0,0,0.0,229
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"var stdoutTrimmed = (stdout + ""\n"" + stderr).trim()",0,0,0.0,230
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"[ ""config"", ""--get"", ""remote.origin.url"" ],",0,0,0.0,231
0404aa49d0affc618b7b15b63eb07cdd7d49906a,git.whichAndExec(,0,0,0.0,232
0404aa49d0affc618b7b15b63eb07cdd7d49906a,", realizePackageSpecifier = require(""realize-package-specifier"")",0,0,0.0,233
0404aa49d0affc618b7b15b63eb07cdd7d49906a,", addLocal = require(""./add-local.js"")",0,0,0.0,234
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"+ data.name + ""@"" + data.version )",1,0,0.0,235
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"+ "" but found """,1,0,0.0,236
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"+ pkgData.name + ""@"" + pkgData.version",1,0,0.0,237
0404aa49d0affc618b7b15b63eb07cdd7d49906a,+ data.name ),1,0,0.0,238
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"+ pkgData.name + "" but found """,1,0,0.0,239
0404aa49d0affc618b7b15b63eb07cdd7d49906a,// check that this is what we expected.,1,0,0.0,240
0404aa49d0affc618b7b15b63eb07cdd7d49906a,// XXX dry with similar stanza in add-local.js,1,0,0.0,241
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"var pj = path.join(target, ""package.json"")",1,0,0.0,242
0404aa49d0affc618b7b15b63eb07cdd7d49906a,// example if the user just did `npm install ./foo.tgz`,1,0,0.0,243
0404aa49d0affc618b7b15b63eb07cdd7d49906a,// what it says it is.,1,0,0.0,244
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"// a peek inside, so we unpack it here just to make sure it is",1,0,0.0,245
0404aa49d0affc618b7b15b63eb07cdd7d49906a,"// The shasum's already been checked, but we haven't ever had",1,0,0.0,246
0404aa49d0affc618b7b15b63eb07cdd7d49906a,// This is a tarball we probably downloaded from the internet.,1,0,0.0,247
0404aa49d0affc618b7b15b63eb07cdd7d49906a,if (!cb) return,1,0,0.0,248
0404aa49d0affc618b7b15b63eb07cdd7d49906a,from.pipe(to),1,0,0.0,249
0404aa49d0affc618b7b15b63eb07cdd7d49906a,}),1,0,0.0,250
0404aa49d0affc618b7b15b63eb07cdd7d49906a,if (data) data._resolved = resolved,1,0,0.0,251
