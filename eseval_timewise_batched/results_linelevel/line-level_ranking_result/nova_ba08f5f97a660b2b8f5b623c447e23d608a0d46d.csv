commit_id,line,line_level_label,count,line_score,row
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Get the list of windows network adapters.""""""",0,4,1.0,1
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Set IP address for the windows VM.""""""",1,4,1.0,2
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Get the list of Linux network adapters.""""""",0,4,1.0,3
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Set IP address for the Linux VM.""""""",1,4,1.0,4
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Set IP address for the windows VM.""""""",1,4,1.0,5
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Get Linux network adapter name.""""""",1,4,1.0,6
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Get the adapter name based on the MAC address.""""""",1,4,1.0,7
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Get the list of windows network adapters.""""""",1,4,1.0,8
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Set IP address for the Linux VM.""""""",1,4,1.0,9
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Get the list of Linux network adapters.""""""",1,4,1.0,10
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Get Linux network adapter name.""""""",1,4,1.0,11
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Set IP address for the Linux VM.""""""",0,4,1.0,12
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Get the adapter name based on the MAC address.""""""",1,4,1.0,13
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Get Linux network adapter name.""""""",0,4,1.0,14
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Set IP address for the windows VM.""""""",0,4,1.0,15
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Get the adapter name based on the MAC address.""""""",0,4,1.0,16
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Get the list of windows network adapters.""""""",1,4,1.0,17
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Get the list of Linux network adapters.""""""",1,4,1.0,18
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.warn(_(""VMware Tools is not installed""))",1,3,0.75,19
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,elif pltfrm == PLATFORM_LINUX:,1,3,0.75,20
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if pltfrm == PLATFORM_WIN:,1,3,0.75,21
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.warn(_(""VMware Tools is not installed""))",1,3,0.75,22
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Get Windows network adapter name.""""""",1,3,0.75,23
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,elif sys.platform == PLATFORM_LINUX:,1,3,0.75,24
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if sys.platform == PLATFORM_WIN:,1,3,0.75,25
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,elif pltfrm == PLATFORM_LINUX:,1,3,0.75,26
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if pltfrm == PLATFORM_WIN:,1,3,0.75,27
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if pltfrm == PLATFORM_WIN:,0,3,0.75,28
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Get Windows network adapter name.""""""",1,3,0.75,29
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.warn(_(""VMware Tools is not installed""))",0,3,0.75,30
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,elif sys.platform == PLATFORM_LINUX:,1,3,0.75,31
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,elif sys.platform == PLATFORM_LINUX:,0,3,0.75,32
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Get Windows network adapter name.""""""",0,3,0.75,33
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if sys.platform == PLATFORM_WIN:,0,3,0.75,34
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,elif pltfrm == PLATFORM_LINUX:,0,3,0.75,35
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if sys.platform == PLATFORM_WIN:,1,3,0.75,36
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Set IPv4 network settings for RHEL distros.""""""",1,2,0.5,37
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,pltfrm = sys.platform,1,2,0.5,38
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Set IPv4 network settings for Ubuntu.""""""",1,2,0.5,39
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Set IPv4 network settings for RHEL distros.""""""",1,2,0.5,40
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Executes the command with the list of arguments specified.""""""",1,2,0.5,41
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,Each of the NIC will have record NIC_record in the form,1,2,0.5,42
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,Guest tools for ESX to set up network in the guest.,1,2,0.5,43
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,pltfrm = sys.platform,1,2,0.5,44
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Set IPv4 network settings for Ubuntu.""""""",1,2,0.5,45
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,Each of the NIC will have record NIC_record in the form,1,2,0.5,46
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Executes the command with the list of arguments specified.""""""",1,2,0.5,47
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,Guest tools for ESX to set up network in the guest.,1,2,0.5,48
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,pltfrm = sys.platform,0,2,0.5,49
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Set IPv4 network settings for Ubuntu.""""""",0,2,0.5,50
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Set IPv4 network settings for RHEL distros.""""""",0,2,0.5,51
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Executes the command with the list of arguments specified.""""""",0,2,0.5,52
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,Each of the NIC will have record NIC_record in the form,0,2,0.5,53
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,Guest tools for ESX to set up network in the guest.,0,2,0.5,54
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if __name__ == '__main__':,1,1,0.25,55
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"#    WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the",1,1,0.25,56
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"#    distributed under the License is distributed on an ""AS IS"" BASIS, WITHOUT",1,1,0.25,57
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,#    a copy of the License at,1,1,0.25,58
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,#    not use this file except in compliance with the License. You may obtain,1,1,0.25,59
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"#    Licensed under the Apache License, Version 2.0 (the ""License""); you may",1,1,0.25,60
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"raise NotImplementedError(_(""Platform not implemented: '%s'"") % pltfrm)",1,1,0.25,61
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if adapter_name and not ip_address == current_ip_address:,1,1,0.25,62
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,elif (platform.dist()[0] == 'redhat'):,1,1,0.25,63
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if(platform.dist()[0] == 'Ubuntu'):,1,1,0.25,64
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,# Windows doesn't let you manually set the broadcast address,1,1,0.25,65
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,#    under the License.,1,1,0.25,66
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.debug(_(""Executing command: '%s'"") % cmd)",1,1,0.25,67
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if network_adapter['mac-address'] == mac_address.lower():,1,1,0.25,68
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,elif arch == ARCH_64_BIT:,1,1,0.25,69
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,#    License for the specific language governing permissions and limitations,1,1,0.25,70
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for adapter in wbem_network_adapters:,1,1,0.25,71
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"Parse the machine_id to get MAC, IP, Netmask and Gateway fields per NIC.",1,1,0.25,72
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"machine_id is of the form ('NIC_record#NIC_record#', '')",1,1,0.25,73
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"if machine_id[1].strip() == ""1"":",1,1,0.25,74
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,wbem_network_adapter.NetConnectionStatus == 7:,1,1,0.25,75
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,adapter.NetConnectionStatus == 7):,1,1,0.25,76
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if arch == ARCH_32_BIT:,1,1,0.25,77
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,elif arch == ARCH_64_BIT:,1,1,0.25,78
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if network_adapter['mac-address'] == mac_address.lower():,1,1,0.25,79
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.debug(_(""Executing command: '%s'"") % cmd)",1,1,0.25,80
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if adapter_name and not ip_address == current_ip_address:,1,1,0.25,81
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,# Windows doesn't let you manually set the broadcast address,1,1,0.25,82
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if(platform.dist()[0] == 'Ubuntu'):,1,1,0.25,83
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,elif (platform.dist()[0] == 'redhat'):,1,1,0.25,84
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if __name__ == '__main__':,1,1,0.25,85
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"raise NotImplementedError(_(""Platform not implemented: '%s'"") % pltfrm)",1,1,0.25,86
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if arch == ARCH_32_BIT:,1,1,0.25,87
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if (adapter.NetConnectionStatus == 2 or,1,1,0.25,88
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if wbem_network_adapter.NetConnectionStatus == 2 or \,1,1,0.25,89
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"Parse the machine_id to get MAC, IP, Netmask and Gateway fields per NIC.",0,1,0.25,90
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,elif arch == ARCH_64_BIT:,0,1,0.25,91
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if arch == ARCH_32_BIT:,0,1,0.25,92
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,wbem_network_adapter.NetConnectionStatus == 7:,0,1,0.25,93
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if wbem_network_adapter.NetConnectionStatus == 2 or \,0,1,0.25,94
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"if machine_id[1].strip() == ""1"":",0,1,0.25,95
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"machine_id is of the form ('NIC_record#NIC_record#', '')",0,1,0.25,96
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,#    License for the specific language governing permissions and limitations,0,1,0.25,97
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.debug(_(""Executing command: '%s'"") % cmd)",0,1,0.25,98
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"#    WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the",0,1,0.25,99
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"#    distributed under the License is distributed on an ""AS IS"" BASIS, WITHOUT",0,1,0.25,100
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,#    a copy of the License at,0,1,0.25,101
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,#    not use this file except in compliance with the License. You may obtain,0,1,0.25,102
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"#    Licensed under the Apache License, Version 2.0 (the ""License""); you may",0,1,0.25,103
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"if machine_id[1].strip() == ""1"":",1,1,0.25,104
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if network_adapter['mac-address'] == mac_address.lower():,0,1,0.25,105
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,#    under the License.,0,1,0.25,106
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if adapter_name and not ip_address == current_ip_address:,0,1,0.25,107
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,#    a copy of the License at,1,1,0.25,108
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"machine_id is of the form ('NIC_record#NIC_record#', '')",1,1,0.25,109
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"Parse the machine_id to get MAC, IP, Netmask and Gateway fields per NIC.",1,1,0.25,110
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,# Windows doesn't let you manually set the broadcast address,0,1,0.25,111
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,#    under the License.,1,1,0.25,112
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,#    License for the specific language governing permissions and limitations,1,1,0.25,113
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"#    distributed under the License is distributed on an ""AS IS"" BASIS, WITHOUT",1,1,0.25,114
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"#    WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the",1,1,0.25,115
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,#    not use this file except in compliance with the License. You may obtain,1,1,0.25,116
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"#    Licensed under the Apache License, Version 2.0 (the ""License""); you may",1,1,0.25,117
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"raise NotImplementedError(_(""Platform not implemented: '%s'"") % pltfrm)",0,1,0.25,118
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if __name__ == '__main__':,0,1,0.25,119
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,elif (platform.dist()[0] == 'redhat'):,0,1,0.25,120
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if(platform.dist()[0] == 'Ubuntu'):,0,1,0.25,121
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"network_details = _parse_network_details(_execute(cmd,",1,0,0.0,122
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"# Copyright (c) 2011 Citrix Systems, Inc.",1,0,0.0,123
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,check_exit_code=False)),1,0,0.0,124
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"# TODO(sateesh): For other distros like suse, debian, BSD, etc.",1,0,0.0,125
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_set_ubuntu_networking(network_details),1,0,0.0,126
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_set_rhel_networking(network_details),1,0,0.0,127
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.warn(_(""Distro '%s' not supported"") % platform.dist()[0])",1,0,0.0,128
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_windows_set_networking(),1,0,0.0,129
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"cmd = [vmware_tools_bin, '--cmd', 'machine.id.get']",1,0,0.0,130
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_linux_set_networking(),1,0,0.0,131
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,On Windows we require pyWin32 installed on Python.,1,0,0.0,132
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,# Copyright 2011 OpenStack Foundation,1,0,0.0,133
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,#,1,0,0.0,134
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,#         http://www.apache.org/licenses/LICENSE-2.0,1,0,0.0,135
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"#    Unless required by applicable law or agreed to in writing, software",1,0,0.0,136
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""",1,0,0.0,137
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import array,1,0,0.0,138
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import logging,1,0,0.0,139
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import os,1,0,0.0,140
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,elif os.path.exists('/usr/bin/vmware-guestd'):,1,0,0.0,141
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import platform,1,0,0.0,142
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,vmware_tools_bin = '/usr/bin/vmware-guestd',1,0,0.0,143
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nbroadcast %s' % broadcast),1,0,0.0,144
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,vmware_tools_bin = '/usr/sbin/vmware-guestd',1,0,0.0,145
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,elif os.path.exists('/usr/sbin/vmware-guestd'):,1,0,0.0,146
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,dns_file.close(),1,0,0.0,147
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"_execute(['/sbin/service', 'network', 'restart'])",1,0,0.0,148
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _set_ubuntu_networking(network_details=None):,1,0,0.0,149
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file_name = '/etc/network/interfaces',1,0,0.0,150
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"for device, network_detail in enumerate(network_details):",1,0,0.0,151
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if adapter_name:,1,0,0.0,152
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nauto %s' % adapter_name),1,0,0.0,153
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\niface %s inet static' % adapter_name),1,0,0.0,154
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import struct,1,0,0.0,155
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\ngateway %s' % gateway),1,0,0.0,156
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nnetmask %s' % subnet_mask),1,0,0.0,157
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\naddress %s\n' % ip_address),1,0,0.0,158
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.debug(_(""Successfully configured NIC %d with """,1,0,0.0,159
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""NIC info %s"") % (device, network_detail))",1,0,0.0,160
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.debug(_(""Restarting networking....\n""))",1,0,0.0,161
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"_execute(['/etc/init.d/networking', 'restart'])",1,0,0.0,162
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _linux_set_networking():,1,0,0.0,163
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if os.path.exists('/usr/sbin/vmtoolsd'):,1,0,0.0,164
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,vmware_tools_bin = '/usr/sbin/vmtoolsd',1,0,0.0,165
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,elif os.path.exists('/usr/bin/vmtoolsd'):,1,0,0.0,166
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,vmware_tools_bin = '/usr/bin/vmtoolsd',1,0,0.0,167
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import socket,1,0,0.0,168
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if not os.path.exists(LOG_DIR):,1,0,0.0,169
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import subprocess,1,0,0.0,170
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,self.stdout = stdout,1,0,0.0,171
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,self.cmd = cmd,1,0,0.0,172
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def __str__(self):,1,0,0.0,173
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,return str(self.exit_code),1,0,0.0,174
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _bytes2int(bytes):,1,0,0.0,175
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Convert bytes to int.""""""",1,0,0.0,176
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,intgr = 0,1,0,0.0,177
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for byt in bytes:,1,0,0.0,178
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,intgr = (intgr << 8) + _byte(byt),1,0,0.0,179
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,return intgr,1,0,0.0,180
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _parse_network_details(machine_id):,1,0,0.0,181
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,'MAC;IP;Netmask;Gateway;Broadcast;DNS' where ';' is field separator.,1,0,0.0,182
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,Each record is separated by '#' from next record.,1,0,0.0,183
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.debug(_(""Received machine_id from vmtools : %s"") % machine_id[0])",1,0,0.0,184
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,network_details = [],1,0,0.0,185
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,pass,1,0,0.0,186
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for machine_id_str in machine_id[0].split('#'):,1,0,0.0,187
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,network_info_list = machine_id_str.split(';'),1,0,0.0,188
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if len(network_info_list) % 6 != 0:,1,0,0.0,189
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,break,1,0,0.0,190
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,no_grps = len(network_info_list) / 6,1,0,0.0,191
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for dns_server in unique_entries:,1,0,0.0,192
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,self.stderr = stderr,1,0,0.0,193
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,self.exit_code = exit_code,1,0,0.0,194
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import sys,1,0,0.0,195
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"def __init__(self, exit_code, stdout, stderr, cmd):",1,0,0.0,196
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import time,1,0,0.0,197
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,from nova.i18n import _,1,0,0.0,198
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,PLATFORM_WIN = 'win32',1,0,0.0,199
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,PLATFORM_LINUX = 'linux2',1,0,0.0,200
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,ARCH_32_BIT = '32bit',1,0,0.0,201
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,ARCH_64_BIT = '64bit',1,0,0.0,202
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,NO_MACHINE_ID = 'No machine id',1,0,0.0,203
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,# Logging,1,0,0.0,204
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"FORMAT = ""%(asctime)s - %(levelname)s - %(message)s""",1,0,0.0,205
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"LOG_DIR = os.path.join(os.environ.get('ALLUSERSPROFILE'), 'openstack')",1,0,0.0,206
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,LOG_DIR = '/var/log/openstack',1,0,0.0,207
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,else:,1,0,0.0,208
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,LOG_DIR = 'logs',1,0,0.0,209
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,os.mkdir(LOG_DIR),1,0,0.0,210
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"LOG_FILENAME = os.path.join(LOG_DIR, 'openstack-guest-tools.log')",1,0,0.0,211
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.basicConfig(filename=LOG_FILENAME, format=FORMAT)",1,0,0.0,212
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if sys.hexversion < 0x3000000:,1,0,0.0,213
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_byte = ord    # 2.x chr to integer,1,0,0.0,214
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_byte = int    # 3.x byte to integer,1,0,0.0,215
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,class ProcessExecutionError:,1,0,0.0,216
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Process Execution Error Class.""""""",1,0,0.0,217
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"dns_file.write(""\nnameserver %s"" % dns_server)",1,0,0.0,218
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"elif os.path.exists(os.path.join(program_files, 'VMware', 'VMware Tools',",1,0,0.0,219
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,unique_entries = _filter_duplicates(all_dns_servers),1,0,0.0,220
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,check_exit_code=False)):,1,0,0.0,221
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"stdout=stdout,",1,0,0.0,222
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"stderr=stderr,",1,0,0.0,223
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,cmd=cmd),1,0,0.0,224
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,time.sleep(0.1),1,0,0.0,225
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,return result,1,0,0.0,226
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _windows_set_networking():,1,0,0.0,227
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,program_files = os.environ.get('PROGRAMFILES'),1,0,0.0,228
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,program_files_x86 = os.environ.get('PROGRAMFILES(X86)'),1,0,0.0,229
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,vmware_tools_bin = None,1,0,0.0,230
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"if os.path.exists(os.path.join(program_files, 'VMware', 'VMware Tools',",1,0,0.0,231
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,'vmtoolsd.exe')):,1,0,0.0,232
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"vmware_tools_bin = os.path.join(program_files, 'VMware',",1,0,0.0,233
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"'VMware Tools', 'vmtoolsd.exe')",1,0,0.0,234
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,while i < no_grps:,1,0,0.0,235
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,'VMwareService.exe')):,1,0,0.0,236
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"'VMware Tools', 'VMwareService.exe')",1,0,0.0,237
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"elif program_files_x86 and os.path.exists(os.path.join(program_files_x86,",1,0,0.0,238
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"'VMware', 'VMware Tools',",1,0,0.0,239
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"vmware_tools_bin = os.path.join(program_files_x86, 'VMware',",1,0,0.0,240
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if vmware_tools_bin:,1,0,0.0,241
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"cmd = ['""' + vmware_tools_bin + '""', '--cmd', 'machine.id.get']",1,0,0.0,242
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"raise ProcessExecutionError(exit_code=obj.returncode,",1,0,0.0,243
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"(stdout, stderr) = result",1,0,0.0,244
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if check_exit_code and obj.returncode != 0:,1,0,0.0,245
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"def _execute(cmd_list, process_input=None, check_exit_code=True):",1,0,0.0,246
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for network_adapter in network_adapters:,1,0,0.0,247
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,adapter_name = network_adapter['name'],1,0,0.0,248
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,ip_address = network_adapter['ip-address'],1,0,0.0,249
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"return adapter_name, ip_address",1,0,0.0,250
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _get_win_adapter_name_and_ip_address(mac_address):,1,0,0.0,251
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,network_adapters = _get_windows_network_adapters(),1,0,0.0,252
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"return _get_adapter_name_and_ip_address(network_adapters, mac_address)",1,0,0.0,253
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _get_linux_adapter_name_and_ip_address(mac_address):,1,0,0.0,254
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,network_adapters = _get_linux_network_adapters(),1,0,0.0,255
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,cmd = ' '.join(cmd_list),1,0,0.0,256
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.debug(_(""Result was %s"") % obj.returncode)",1,0,0.0,257
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,env = os.environ.copy(),1,0,0.0,258
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"obj = subprocess.Popen(cmd, shell=True, stdin=subprocess.PIPE,",1,0,0.0,259
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"stdout=subprocess.PIPE, stderr=subprocess.PIPE, env=env)",1,0,0.0,260
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,result = None,1,0,0.0,261
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if process_input is not None:,1,0,0.0,262
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,result = obj.communicate(process_input),1,0,0.0,263
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,result = obj.communicate(),1,0,0.0,264
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,obj.stdin.close(),1,0,0.0,265
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if obj.returncode:,1,0,0.0,266
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"for network_detail in _parse_network_details(_execute(cmd,",1,0,0.0,267
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"mac_address, ip_address, subnet_mask, gateway, broadcast,\",1,0,0.0,268
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"dns_file.write(""; generated by OpenStack guest tools"")",1,0,0.0,269
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,dns_servers = network_detail,1,0,0.0,270
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,# Remove file,1,0,0.0,271
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,os.remove(interface_file_name),1,0,0.0,272
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,# Touch file,1,0,0.0,273
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"_execute(['touch', interface_file_name])",1,0,0.0,274
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"interface_file = open(interface_file_name, 'w')",1,0,0.0,275
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nDEVICE=%s' % adapter_name),1,0,0.0,276
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nUSERCTL=yes'),1,0,0.0,277
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nONBOOT=yes'),1,0,0.0,278
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nBOOTPROTO=static'),1,0,0.0,279
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nBROADCAST=%s' % broadcast),1,0,0.0,280
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nNETWORK='),1,0,0.0,281
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nGATEWAY=%s' % gateway),1,0,0.0,282
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nNETMASK=%s' % subnet_mask),1,0,0.0,283
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nIPADDR=%s' % ip_address),1,0,0.0,284
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nMACADDR=%s' % mac_address),1,0,0.0,285
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.close(),1,0,0.0,286
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if all_dns_servers:,1,0,0.0,287
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"dns_file_name = ""/etc/resolv.conf""",1,0,0.0,288
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,os.remove(dns_file_name),1,0,0.0,289
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"_execute(['touch', dns_file_name])",1,0,0.0,290
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"dns_file = open(dns_file_name, 'w')",1,0,0.0,291
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,'/etc/sysconfig/network-scripts/ifcfg-%s' % adapter_name,1,0,0.0,292
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file_name = \,1,0,0.0,293
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_get_linux_adapter_name_and_ip_address(mac_address),1,0,0.0,294
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"'name=""%s""' % adapter_name, dns_server]",1,0,0.0,295
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"adapter_name, current_ip_address = \",1,0,0.0,296
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_get_win_adapter_name_and_ip_address(mac_address),1,0,0.0,297
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"cmd = ['netsh', 'interface', 'ip', 'set', 'address',",1,0,0.0,298
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"'name=""%s""' % adapter_name, 'source=static', ip_address,",1,0,0.0,299
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"subnet_mask, gateway, '1']",1,0,0.0,300
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_execute(cmd),1,0,0.0,301
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for dns_server in dns_servers:,1,0,0.0,302
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if dns_server:,1,0,0.0,303
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"cmd = ['netsh', 'interface', 'ip', 'add', 'dns',",1,0,0.0,304
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _filter_duplicates(all_entries):,1,0,0.0,305
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,all_dns_servers.extend(dns_servers),1,0,0.0,306
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,final_list = [],1,0,0.0,307
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for entry in all_entries:,1,0,0.0,308
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if entry and entry not in final_list:,1,0,0.0,309
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,final_list.append(entry),1,0,0.0,310
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,return final_list,1,0,0.0,311
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _set_rhel_networking(network_details=None):,1,0,0.0,312
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,network_details = network_details or [],1,0,0.0,313
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,all_dns_servers = [],1,0,0.0,314
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for network_detail in network_details:,1,0,0.0,315
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,i = 0,1,0,0.0,316
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"mac_address = "":"".join([raw_mac_address[m_counter:m_counter + 2]",1,0,0.0,317
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,k = i * 6,1,0,0.0,318
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,final_list = [],1,0,0.0,319
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if entry and entry not in final_list:,1,0,0.0,320
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,final_list.append(entry),1,0,0.0,321
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,return final_list,1,0,0.0,322
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _set_rhel_networking(network_details=None):,1,0,0.0,323
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,network_details = network_details or [],1,0,0.0,324
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,all_dns_servers = [],1,0,0.0,325
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for network_detail in network_details:,1,0,0.0,326
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,all_dns_servers.extend(dns_servers),1,0,0.0,327
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,name_and_ip = _get_linux_adapter_name_and_ip_address(mac_address),1,0,0.0,328
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file_name = ('/etc/sysconfig/network-scripts/ifcfg-%s' %,1,0,0.0,329
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,adapter_name),1,0,0.0,330
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,# Remove file,1,0,0.0,331
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,os.remove(interface_file_name),1,0,0.0,332
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,# Touch file,1,0,0.0,333
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"_execute(['touch', interface_file_name])",1,0,0.0,334
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"interface_file = open(interface_file_name, 'w')",1,0,0.0,335
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nDEVICE=%s' % adapter_name),1,0,0.0,336
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nUSERCTL=yes'),1,0,0.0,337
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nONBOOT=yes'),1,0,0.0,338
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nBOOTPROTO=static'),1,0,0.0,339
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nBROADCAST=%s' % broadcast),1,0,0.0,340
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for entry in all_entries:,1,0,0.0,341
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _filter_duplicates(all_entries):,1,0,0.0,342
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"vmware_tools_bin = os.path.join(program_files, 'VMware',",1,0,0.0,343
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"'name=""%s""' % adapter_name, dns_server]",1,0,0.0,344
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"elif os.path.exists(os.path.join(program_files, 'VMware', 'VMware Tools',",1,0,0.0,345
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,'VMwareService.exe')):,1,0,0.0,346
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"'VMware Tools', 'VMwareService.exe')",1,0,0.0,347
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"elif program_files_x86 and os.path.exists(os.path.join(program_files_x86,",1,0,0.0,348
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"'VMware', 'VMware Tools',",1,0,0.0,349
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"vmware_tools_bin = os.path.join(program_files_x86, 'VMware',",1,0,0.0,350
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if vmware_tools_bin:,1,0,0.0,351
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"cmd = ['""' + vmware_tools_bin + '""', '--cmd', 'machine.id.get']",1,0,0.0,352
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"for network_detail in _parse_network_details(_execute(cmd,",1,0,0.0,353
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,check_exit_code=False)):,1,0,0.0,354
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"(mac_address, ip_address, subnet_mask, gateway, broadcast,",1,0,0.0,355
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,dns_servers) = network_detail,1,0,0.0,356
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,name_and_ip = _get_win_adapter_name_and_ip_address(mac_address),1,0,0.0,357
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"adapter_name, current_ip_address = name_and_ip",1,0,0.0,358
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"cmd = ['netsh', 'interface', 'ip', 'set', 'address',",1,0,0.0,359
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"'name=""%s""' % adapter_name, 'source=static', ip_address,",1,0,0.0,360
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"subnet_mask, gateway, '1']",1,0,0.0,361
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_execute(cmd),1,0,0.0,362
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for dns_server in dns_servers:,1,0,0.0,363
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if dns_server:,1,0,0.0,364
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"cmd = ['netsh', 'interface', 'ip', 'add', 'dns',",1,0,0.0,365
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nNETWORK='),1,0,0.0,366
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nGATEWAY=%s' % gateway),1,0,0.0,367
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nNETMASK=%s' % subnet_mask),1,0,0.0,368
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nIPADDR=%s' % ip_address),1,0,0.0,369
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""NIC info %(detail)s""), {'device': device,",1,0,0.0,370
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,'detail': network_detail}),1,0,0.0,371
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.debug(_(""Restarting networking....\n""))",1,0,0.0,372
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"_execute(['/etc/init.d/networking', 'restart'])",1,0,0.0,373
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _linux_set_networking():,1,0,0.0,374
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if os.path.exists('/usr/sbin/vmtoolsd'):,1,0,0.0,375
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,vmware_tools_bin = '/usr/sbin/vmtoolsd',1,0,0.0,376
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,elif os.path.exists('/usr/bin/vmtoolsd'):,1,0,0.0,377
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,vmware_tools_bin = '/usr/bin/vmtoolsd',1,0,0.0,378
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,elif os.path.exists('/usr/sbin/vmware-guestd'):,1,0,0.0,379
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,vmware_tools_bin = '/usr/sbin/vmware-guestd',1,0,0.0,380
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,elif os.path.exists('/usr/bin/vmware-guestd'):,1,0,0.0,381
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,vmware_tools_bin = '/usr/bin/vmware-guestd',1,0,0.0,382
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"cmd = [vmware_tools_bin, '--cmd', 'machine.id.get']",1,0,0.0,383
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"network_details = _parse_network_details(_execute(cmd,",1,0,0.0,384
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,check_exit_code=False)),1,0,0.0,385
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"# TODO(sateesh): For other distros like suse, debian, BSD, etc.",1,0,0.0,386
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_set_ubuntu_networking(network_details),1,0,0.0,387
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_set_rhel_networking(network_details),1,0,0.0,388
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.warn(_(""Distro '%s' not supported"") % platform.dist()[0])",1,0,0.0,389
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_windows_set_networking(),1,0,0.0,390
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.debug(_(""Successfully configured NIC %(device)d with """,1,0,0.0,391
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\naddress %s\n' % ip_address),1,0,0.0,392
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nnetmask %s' % subnet_mask),1,0,0.0,393
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for dns_server in unique_entries:,1,0,0.0,394
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nMACADDR=%s' % mac_address),1,0,0.0,395
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.close(),1,0,0.0,396
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if all_dns_servers:,1,0,0.0,397
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"dns_file_name = ""/etc/resolv.conf""",1,0,0.0,398
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,os.remove(dns_file_name),1,0,0.0,399
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"_execute(['touch', dns_file_name])",1,0,0.0,400
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"dns_file = open(dns_file_name, 'w')",1,0,0.0,401
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"dns_file.write(""; generated by OpenStack guest tools"")",1,0,0.0,402
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,unique_entries = _filter_duplicates(all_dns_servers),1,0,0.0,403
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"dns_file.write(""\nnameserver %s"" % dns_server)",1,0,0.0,404
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\ngateway %s' % gateway),1,0,0.0,405
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,dns_file.close(),1,0,0.0,406
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"_execute(['/sbin/service', 'network', 'restart'])",1,0,0.0,407
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _set_ubuntu_networking(network_details=None):,1,0,0.0,408
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file_name = '/etc/network/interfaces',1,0,0.0,409
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"for device, network_detail in enumerate(network_details):",1,0,0.0,410
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if adapter_name:,1,0,0.0,411
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nauto %s' % adapter_name),1,0,0.0,412
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\niface %s inet static' % adapter_name),1,0,0.0,413
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nbroadcast %s' % broadcast),1,0,0.0,414
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"'VMware Tools', 'vmtoolsd.exe')",1,0,0.0,415
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,'vmtoolsd.exe')):,1,0,0.0,416
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,network_details.append((,1,0,0.0,417
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,ip_address = config.IPAddress[0],1,0,0.0,418
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,#config.DefaultIPGateway[0],1,0,0.0,419
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"network_adapters.append({'name': adapter_name,",1,0,0.0,420
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"'mac-address': mac_address,",1,0,0.0,421
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"'ip-address': ip_address,",1,0,0.0,422
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,'subnet-mask': subnet_mask}),1,0,0.0,423
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,return network_adapters,1,0,0.0,424
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _get_linux_network_adapters():,1,0,0.0,425
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import fcntl,1,0,0.0,426
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,max_bytes = 8096,1,0,0.0,427
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,arch = platform.architecture()[0],1,0,0.0,428
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,offset1 = 32,1,0,0.0,429
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,offset2 = 32,1,0,0.0,430
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,offset1 = 16,1,0,0.0,431
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,offset2 = 40,1,0,0.0,432
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"raise OSError(_(""Unknown architecture: %s"") % arch)",1,0,0.0,433
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)",1,0,0.0,434
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"names = array.array('B', '\0' * max_bytes)",1,0,0.0,435
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"outbytes = struct.unpack('iL', fcntl.ioctl(",1,0,0.0,436
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"sock.fileno(),",1,0,0.0,437
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"0x8912,",1,0,0.0,438
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"struct.pack('iL', max_bytes, names.buffer_info()[0])))[0]",1,0,0.0,439
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,subnet_mask = config.IPSubnet[0],1,0,0.0,440
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if config.IPEnabled:,1,0,0.0,441
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"if os.path.exists(os.path.join(program_files, 'VMware', 'VMware Tools',",1,0,0.0,442
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,subnet_mask = '',1,0,0.0,443
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"network_info_list[k].strip().lower(),",1,0,0.0,444
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"network_info_list[k + 1].strip(),",1,0,0.0,445
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"network_info_list[k + 2].strip(),",1,0,0.0,446
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"network_info_list[k + 3].strip(),",1,0,0.0,447
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"network_info_list[k + 4].strip(),",1,0,0.0,448
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"network_info_list[k + 5].strip().split(',')))",1,0,0.0,449
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,i += 1,1,0,0.0,450
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.debug(_(""NIC information from vmtools : %s"") % network_details)",1,0,0.0,451
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,return network_details,1,0,0.0,452
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _get_windows_network_adapters():,1,0,0.0,453
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import win32com.client,1,0,0.0,454
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,wbem_locator = win32com.client.Dispatch('WbemScripting.SWbemLocator'),1,0,0.0,455
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"wbem_service = wbem_locator.ConnectServer('.', 'root\cimv2')",1,0,0.0,456
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,wbem_network_adapters = wbem_service.InstancesOf('Win32_NetworkAdapter'),1,0,0.0,457
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,network_adapters = [],1,0,0.0,458
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,adapter_name = adapter.NetConnectionID,1,0,0.0,459
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,mac_address = adapter.MacAddress.lower(),1,0,0.0,460
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,config = adapter.associators_(,1,0,0.0,461
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"'Win32_NetworkAdapterSetting',",1,0,0.0,462
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,'Win32_NetworkAdapterConfiguration')[0],1,0,0.0,463
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,ip_address = '',1,0,0.0,464
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"adapter_names = [names.tostring()[n_cnt:n_cnt + offset1].split('\0', 1)[0]",1,0,0.0,465
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"for n_cnt in xrange(0, outbytes, offset2)]",1,0,0.0,466
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for adapter_name in adapter_names:,1,0,0.0,467
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,ip_address = socket.inet_ntoa(fcntl.ioctl(,1,0,0.0,468
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"obj = subprocess.Popen(cmd, shell=True, stdin=subprocess.PIPE,",1,0,0.0,469
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"stdout=subprocess.PIPE, stderr=subprocess.PIPE, env=env)",1,0,0.0,470
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,result = None,1,0,0.0,471
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if process_input is not None:,1,0,0.0,472
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,result = obj.communicate(process_input),1,0,0.0,473
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,result = obj.communicate(),1,0,0.0,474
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,obj.stdin.close(),1,0,0.0,475
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if obj.returncode:,1,0,0.0,476
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.debug(_(""Result was %s"") % obj.returncode)",1,0,0.0,477
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if check_exit_code and obj.returncode != 0:,1,0,0.0,478
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"(stdout, stderr) = result",1,0,0.0,479
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"raise ProcessExecutionError(exit_code=obj.returncode,",1,0,0.0,480
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"stdout=stdout,",1,0,0.0,481
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"stderr=stderr,",1,0,0.0,482
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,cmd=cmd),1,0,0.0,483
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,time.sleep(0.1),1,0,0.0,484
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,return result,1,0,0.0,485
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _windows_set_networking():,1,0,0.0,486
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,program_files = os.environ.get('PROGRAMFILES'),1,0,0.0,487
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,program_files_x86 = os.environ.get('PROGRAMFILES(X86)'),1,0,0.0,488
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,vmware_tools_bin = None,1,0,0.0,489
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,env = os.environ.copy(),1,0,0.0,490
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,cmd = ' '.join(cmd_list),1,0,0.0,491
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"def _execute(cmd_list, process_input=None, check_exit_code=True):",1,0,0.0,492
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"def _get_adapter_name_and_ip_address(network_adapters, mac_address):",1,0,0.0,493
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"0x8915,",1,0,0.0,494
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"struct.pack('256s', adapter_name))[20:24])",1,0,0.0,495
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,subnet_mask = socket.inet_ntoa(fcntl.ioctl(,1,0,0.0,496
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"0x891b,",1,0,0.0,497
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,raw_mac_address = '%012x' % _bytes2int(fcntl.ioctl(,1,0,0.0,498
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"0x8927,",1,0,0.0,499
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"struct.pack('256s', adapter_name))[18:24])",1,0,0.0,500
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,adapter_name = None,1,0,0.0,501
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"for m_counter in range(0, len(raw_mac_address), 2)]).lower()",1,0,0.0,502
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,adapter_name = None,1,0,0.0,503
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,network_adapters = _get_linux_network_adapters(),1,0,0.0,504
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,ip_address = None,1,0,0.0,505
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for network_adapter in network_adapters:,1,0,0.0,506
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,adapter_name = network_adapter['name'],1,0,0.0,507
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,ip_address = network_adapter['ip-address'],1,0,0.0,508
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"return adapter_name, ip_address",1,0,0.0,509
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _get_win_adapter_name_and_ip_address(mac_address):,1,0,0.0,510
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,network_adapters = _get_windows_network_adapters(),1,0,0.0,511
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"return _get_adapter_name_and_ip_address(network_adapters, mac_address)",1,0,0.0,512
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _get_linux_adapter_name_and_ip_address(mac_address):,1,0,0.0,513
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,ip_address = None,1,0,0.0,514
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"network_info_list[k + 2].strip(),",1,0,0.0,515
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"def _get_adapter_name_and_ip_address(network_adapters, mac_address):",1,0,0.0,516
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,subnet_mask = socket.inet_ntoa(fcntl.ioctl(,0,0,0.0,517
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,raw_mac_address = '%012x' % _bytes2int(fcntl.ioctl(,0,0,0.0,518
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"0x8927,",0,0,0.0,519
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"struct.pack('256s', adapter_name))[18:24])",0,0,0.0,520
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"mac_address = "":"".join([raw_mac_address[m_counter:m_counter + 2]",0,0,0.0,521
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"for m_counter in range(0, len(raw_mac_address), 2)]).lower()",0,0,0.0,522
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"def _get_adapter_name_and_ip_address(network_adapters, mac_address):",0,0,0.0,523
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,adapter_name = None,0,0,0.0,524
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,ip_address = None,0,0,0.0,525
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for network_adapter in network_adapters:,0,0,0.0,526
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,adapter_name = network_adapter['name'],0,0,0.0,527
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,ip_address = network_adapter['ip-address'],0,0,0.0,528
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"return adapter_name, ip_address",0,0,0.0,529
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _get_win_adapter_name_and_ip_address(mac_address):,0,0,0.0,530
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,network_adapters = _get_windows_network_adapters(),0,0,0.0,531
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"return _get_adapter_name_and_ip_address(network_adapters, mac_address)",0,0,0.0,532
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _get_linux_adapter_name_and_ip_address(mac_address):,0,0,0.0,533
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,network_adapters = _get_linux_network_adapters(),0,0,0.0,534
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"def _execute(cmd_list, process_input=None, check_exit_code=True):",0,0,0.0,535
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,cmd = ' '.join(cmd_list),0,0,0.0,536
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,env = os.environ.copy(),0,0,0.0,537
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"obj = subprocess.Popen(cmd, shell=True, stdin=subprocess.PIPE,",0,0,0.0,538
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"0x891b,",0,0,0.0,539
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"struct.pack('256s', adapter_name))[20:24])",0,0,0.0,540
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"'ip-address': ip_address,",0,0,0.0,541
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"0x8915,",0,0,0.0,542
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,return network_adapters,0,0,0.0,543
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _get_linux_network_adapters():,0,0,0.0,544
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import fcntl,0,0,0.0,545
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,max_bytes = 8096,0,0,0.0,546
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,arch = platform.architecture()[0],0,0,0.0,547
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,offset1 = 32,0,0,0.0,548
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,offset2 = 32,0,0,0.0,549
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,offset1 = 16,0,0,0.0,550
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,offset2 = 40,0,0,0.0,551
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"raise OSError(_(""Unknown architecture: %s"") % arch)",0,0,0.0,552
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)",0,0,0.0,553
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"names = array.array('B', '\0' * max_bytes)",0,0,0.0,554
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"outbytes = struct.unpack('iL', fcntl.ioctl(",0,0,0.0,555
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"sock.fileno(),",0,0,0.0,556
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"0x8912,",0,0,0.0,557
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"struct.pack('iL', max_bytes, names.buffer_info()[0])))[0]",0,0,0.0,558
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,adapter_names = \,0,0,0.0,559
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"[names.tostring()[n_counter:n_counter + offset1].split('\0', 1)[0]",0,0,0.0,560
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"for n_counter in xrange(0, outbytes, offset2)]",0,0,0.0,561
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for adapter_name in adapter_names:,0,0,0.0,562
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,ip_address = socket.inet_ntoa(fcntl.ioctl(,0,0,0.0,563
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"stdout=subprocess.PIPE, stderr=subprocess.PIPE, env=env)",0,0,0.0,564
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,result = None,0,0,0.0,565
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if process_input is not None:,0,0,0.0,566
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,result = obj.communicate(process_input),0,0,0.0,567
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"'VMware', 'VMware Tools',",0,0,0.0,568
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"vmware_tools_bin = os.path.join(program_files_x86, 'VMware',",0,0,0.0,569
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if vmware_tools_bin:,0,0,0.0,570
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"cmd = ['""' + vmware_tools_bin + '""', '--cmd', 'machine.id.get']",0,0,0.0,571
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"for network_detail in _parse_network_details(_execute(cmd,",0,0,0.0,572
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,check_exit_code=False)):,0,0,0.0,573
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"mac_address, ip_address, subnet_mask, gateway, broadcast,\",0,0,0.0,574
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,dns_servers = network_detail,0,0,0.0,575
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"adapter_name, current_ip_address = \",0,0,0.0,576
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_get_win_adapter_name_and_ip_address(mac_address),0,0,0.0,577
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"cmd = ['netsh', 'interface', 'ip', 'set', 'address',",0,0,0.0,578
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"'name=""%s""' % adapter_name, 'source=static', ip_address,",0,0,0.0,579
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"subnet_mask, gateway, '1']",0,0,0.0,580
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_execute(cmd),0,0,0.0,581
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for dns_server in dns_servers:,0,0,0.0,582
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if dns_server:,0,0,0.0,583
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"cmd = ['netsh', 'interface', 'ip', 'add', 'dns',",0,0,0.0,584
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"'name=""%s""' % adapter_name, dns_server]",0,0,0.0,585
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _filter_duplicates(all_entries):,0,0,0.0,586
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,final_list = [],0,0,0.0,587
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for entry in all_entries:,0,0,0.0,588
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"elif program_files_x86 and os.path.exists(os.path.join(program_files_x86,",0,0,0.0,589
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"'VMware Tools', 'VMwareService.exe')",0,0,0.0,590
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,'VMwareService.exe')):,0,0,0.0,591
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,cmd=cmd),0,0,0.0,592
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,result = obj.communicate(),0,0,0.0,593
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,obj.stdin.close(),0,0,0.0,594
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if obj.returncode:,0,0,0.0,595
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.debug(_(""Result was %s"") % obj.returncode)",0,0,0.0,596
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if check_exit_code and obj.returncode != 0:,0,0,0.0,597
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"(stdout, stderr) = result",0,0,0.0,598
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"raise ProcessExecutionError(exit_code=obj.returncode,",0,0,0.0,599
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"stdout=stdout,",0,0,0.0,600
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"stderr=stderr,",0,0,0.0,601
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,time.sleep(0.1),0,0,0.0,602
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"elif os.path.exists(os.path.join(program_files, 'VMware', 'VMware Tools',",0,0,0.0,603
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,return result,0,0,0.0,604
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _windows_set_networking():,0,0,0.0,605
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,program_files = os.environ.get('PROGRAMFILES'),0,0,0.0,606
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,program_files_x86 = os.environ.get('PROGRAMFILES(X86)'),0,0,0.0,607
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,vmware_tools_bin = None,0,0,0.0,608
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"if os.path.exists(os.path.join(program_files, 'VMware', 'VMware Tools',",0,0,0.0,609
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,'vmtoolsd.exe')):,0,0,0.0,610
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"vmware_tools_bin = os.path.join(program_files, 'VMware',",0,0,0.0,611
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"'VMware Tools', 'vmtoolsd.exe')",0,0,0.0,612
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,'subnet-mask': subnet_mask}),0,0,0.0,613
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"'mac-address': mac_address,",0,0,0.0,614
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"for m_counter in range(0, len(raw_mac_address), 2)]).lower()",1,0,0.0,615
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,NO_MACHINE_ID = 'No machine id',0,0,0.0,616
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"FORMAT = ""%(asctime)s - %(levelname)s - %(message)s""",0,0,0.0,617
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"LOG_DIR = os.path.join(os.environ.get('ALLUSERSPROFILE'), 'openstack')",0,0,0.0,618
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,LOG_DIR = '/var/log/openstack',0,0,0.0,619
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,else:,0,0,0.0,620
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,LOG_DIR = 'logs',0,0,0.0,621
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if not os.path.exists(LOG_DIR):,0,0,0.0,622
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,os.mkdir(LOG_DIR),0,0,0.0,623
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"LOG_FILENAME = os.path.join(LOG_DIR, 'openstack-guest-tools.log')",0,0,0.0,624
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.basicConfig(filename=LOG_FILENAME, format=FORMAT)",0,0,0.0,625
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if sys.hexversion < 0x3000000:,0,0,0.0,626
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_byte = ord    # 2.x chr to integer,0,0,0.0,627
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_byte = int    # 3.x byte to integer,0,0,0.0,628
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,class ProcessExecutionError:,0,0,0.0,629
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Process Execution Error Class.""""""",0,0,0.0,630
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"def __init__(self, exit_code, stdout, stderr, cmd):",0,0,0.0,631
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,self.exit_code = exit_code,0,0,0.0,632
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,self.stdout = stdout,0,0,0.0,633
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,self.stderr = stderr,0,0,0.0,634
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,self.cmd = cmd,0,0,0.0,635
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def __str__(self):,0,0,0.0,636
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,return str(self.exit_code),0,0,0.0,637
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,# Logging,0,0,0.0,638
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,ARCH_64_BIT = '64bit',0,0,0.0,639
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"network_adapters.append({'name': adapter_name,",0,0,0.0,640
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,ARCH_32_BIT = '32bit',0,0,0.0,641
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,# vim: tabstop=4 shiftwidth=4 softtabstop=4,0,0,0.0,642
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"# Copyright (c) 2011 Citrix Systems, Inc.",0,0,0.0,643
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,# Copyright 2011 OpenStack LLC.,0,0,0.0,644
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,#,0,0,0.0,645
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,#         http://www.apache.org/licenses/LICENSE-2.0,0,0,0.0,646
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"#    Unless required by applicable law or agreed to in writing, software",0,0,0.0,647
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""",0,0,0.0,648
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,On Windows we require pyWin32 installed on Python.,0,0,0.0,649
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import array,0,0,0.0,650
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import gettext,0,0,0.0,651
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import logging,0,0,0.0,652
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import os,0,0,0.0,653
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import platform,0,0,0.0,654
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import socket,0,0,0.0,655
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import struct,0,0,0.0,656
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import subprocess,0,0,0.0,657
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import sys,0,0,0.0,658
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import time,0,0,0.0,659
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"gettext.install('nova', unicode=1)",0,0,0.0,660
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,PLATFORM_WIN = 'win32',0,0,0.0,661
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,PLATFORM_LINUX = 'linux2',0,0,0.0,662
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _bytes2int(bytes):,0,0,0.0,663
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Convert bytes to int.""""""",0,0,0.0,664
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,intgr = 0,0,0,0.0,665
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for byt in bytes:,0,0,0.0,666
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.debug(_(""NIC information from vmtools : %s"") % network_details)",0,0,0.0,667
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,return network_details,0,0,0.0,668
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _get_windows_network_adapters():,0,0,0.0,669
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import win32com.client,0,0,0.0,670
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,wbem_locator = win32com.client.Dispatch('WbemScripting.SWbemLocator'),0,0,0.0,671
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"wbem_service = wbem_locator.ConnectServer('.', 'root\cimv2')",0,0,0.0,672
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,wbem_network_adapters = wbem_service.InstancesOf('Win32_NetworkAdapter'),0,0,0.0,673
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,network_adapters = [],0,0,0.0,674
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for wbem_network_adapter in wbem_network_adapters:,0,0,0.0,675
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,adapter_name = wbem_network_adapter.NetConnectionID,0,0,0.0,676
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,mac_address = wbem_network_adapter.MacAddress.lower(),0,0,0.0,677
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,wbem_network_adapter_config = \,0,0,0.0,678
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,wbem_network_adapter.associators_(,0,0,0.0,679
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"'Win32_NetworkAdapterSetting',",0,0,0.0,680
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,'Win32_NetworkAdapterConfiguration')[0],0,0,0.0,681
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,ip_address = '',0,0,0.0,682
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,subnet_mask = '',0,0,0.0,683
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if wbem_network_adapter_config.IPEnabled:,0,0,0.0,684
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,ip_address = wbem_network_adapter_config.IPAddress[0],0,0,0.0,685
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,subnet_mask = wbem_network_adapter_config.IPSubnet[0],0,0,0.0,686
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,#wbem_network_adapter_config.DefaultIPGateway[0],0,0,0.0,687
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,i += 1,0,0,0.0,688
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"network_info_list[k + 5].strip().split(',')))",0,0,0.0,689
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"network_info_list[k + 4].strip(),",0,0,0.0,690
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,network_info_list = machine_id_str.split(';'),0,0,0.0,691
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,intgr = (intgr << 8) + _byte(byt),0,0,0.0,692
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,return intgr,0,0,0.0,693
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _parse_network_details(machine_id):,0,0,0.0,694
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,'MAC;IP;Netmask;Gateway;Broadcast;DNS' where ';' is field separator.,0,0,0.0,695
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,Each record is separated by '#' from next record.,0,0,0.0,696
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.debug(_(""Received machine_id from vmtools : %s"") % machine_id[0])",0,0,0.0,697
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,network_details = [],0,0,0.0,698
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,pass,0,0,0.0,699
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for machine_id_str in machine_id[0].split('#'):,0,0,0.0,700
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if len(network_info_list) % 6 != 0:,0,0,0.0,701
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"network_info_list[k + 3].strip(),",0,0,0.0,702
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,break,0,0,0.0,703
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,no_grps = len(network_info_list) / 6,0,0,0.0,704
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,i = 0,0,0,0.0,705
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,while i < no_grps:,0,0,0.0,706
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,k = i * 6,0,0,0.0,707
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,network_details.append((,0,0,0.0,708
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"network_info_list[k].strip().lower(),",0,0,0.0,709
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"network_info_list[k + 1].strip(),",0,0,0.0,710
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"network_info_list[k + 2].strip(),",0,0,0.0,711
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if entry and entry not in final_list:,0,0,0.0,712
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,final_list.append(entry),0,0,0.0,713
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,return final_list,0,0,0.0,714
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.debug(_(""Received machine_id from vmtools : %s"") % machine_id[0])",1,0,0.0,715
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,pass,1,0,0.0,716
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for machine_id_str in machine_id[0].split('#'):,1,0,0.0,717
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,network_info_list = machine_id_str.split(';'),1,0,0.0,718
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if len(network_info_list) % 6 != 0:,1,0,0.0,719
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,break,1,0,0.0,720
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,no_grps = len(network_info_list) / 6,1,0,0.0,721
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,i = 0,1,0,0.0,722
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,while i < no_grps:,1,0,0.0,723
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,k = i * 6,1,0,0.0,724
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,network_details.append((,1,0,0.0,725
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"network_info_list[k].strip().lower(),",1,0,0.0,726
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"network_info_list[k + 1].strip(),",1,0,0.0,727
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"network_info_list[k + 3].strip(),",1,0,0.0,728
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"network_info_list[k + 4].strip(),",1,0,0.0,729
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"network_info_list[k + 5].strip().split(',')))",1,0,0.0,730
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,i += 1,1,0,0.0,731
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.debug(_(""NIC information from vmtools : %s"") % network_details)",1,0,0.0,732
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,return network_details,1,0,0.0,733
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _get_windows_network_adapters():,1,0,0.0,734
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import win32com.client,1,0,0.0,735
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,wbem_locator = win32com.client.Dispatch('WbemScripting.SWbemLocator'),1,0,0.0,736
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,network_details = [],1,0,0.0,737
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,Each record is separated by '#' from next record.,1,0,0.0,738
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _set_rhel_networking(network_details=None):,0,0,0.0,739
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,'MAC;IP;Netmask;Gateway;Broadcast;DNS' where ';' is field separator.,1,0,0.0,740
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"LOG_FILENAME = os.path.join(LOG_DIR, 'openstack-guest-tools.log')",1,0,0.0,741
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.basicConfig(filename=LOG_FILENAME, format=FORMAT)",1,0,0.0,742
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if sys.hexversion < 0x3000000:,1,0,0.0,743
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_byte = ord    # 2.x chr to integer,1,0,0.0,744
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_byte = int    # 3.x byte to integer,1,0,0.0,745
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,class ProcessExecutionError:,1,0,0.0,746
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Process Execution Error Class.""""""",1,0,0.0,747
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"def __init__(self, exit_code, stdout, stderr, cmd):",1,0,0.0,748
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,self.exit_code = exit_code,1,0,0.0,749
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,self.stdout = stdout,1,0,0.0,750
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,self.stderr = stderr,1,0,0.0,751
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,self.cmd = cmd,1,0,0.0,752
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def __str__(self):,1,0,0.0,753
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,return str(self.exit_code),1,0,0.0,754
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _bytes2int(bytes):,1,0,0.0,755
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""Convert bytes to int.""""""",1,0,0.0,756
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,intgr = 0,1,0,0.0,757
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for byt in bytes:,1,0,0.0,758
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,intgr = (intgr << 8) + _byte(byt),1,0,0.0,759
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,return intgr,1,0,0.0,760
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _parse_network_details(machine_id):,1,0,0.0,761
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"wbem_service = wbem_locator.ConnectServer('.', 'root\cimv2')",1,0,0.0,762
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,wbem_network_adapters = wbem_service.InstancesOf('Win32_NetworkAdapter'),1,0,0.0,763
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,network_adapters = [],1,0,0.0,764
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for wbem_network_adapter in wbem_network_adapters:,1,0,0.0,765
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,offset2 = 40,1,0,0.0,766
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"raise OSError(_(""Unknown architecture: %s"") % arch)",1,0,0.0,767
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)",1,0,0.0,768
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"names = array.array('B', '\0' * max_bytes)",1,0,0.0,769
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"outbytes = struct.unpack('iL', fcntl.ioctl(",1,0,0.0,770
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"sock.fileno(),",1,0,0.0,771
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"0x8912,",1,0,0.0,772
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"struct.pack('iL', max_bytes, names.buffer_info()[0])))[0]",1,0,0.0,773
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,adapter_names = \,1,0,0.0,774
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"[names.tostring()[n_counter:n_counter + offset1].split('\0', 1)[0]",1,0,0.0,775
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"for n_counter in xrange(0, outbytes, offset2)]",1,0,0.0,776
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for adapter_name in adapter_names:,1,0,0.0,777
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,ip_address = socket.inet_ntoa(fcntl.ioctl(,1,0,0.0,778
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"0x8915,",1,0,0.0,779
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"struct.pack('256s', adapter_name))[20:24])",1,0,0.0,780
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,subnet_mask = socket.inet_ntoa(fcntl.ioctl(,1,0,0.0,781
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"0x891b,",1,0,0.0,782
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,raw_mac_address = '%012x' % _bytes2int(fcntl.ioctl(,1,0,0.0,783
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"0x8927,",1,0,0.0,784
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"struct.pack('256s', adapter_name))[18:24])",1,0,0.0,785
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"mac_address = "":"".join([raw_mac_address[m_counter:m_counter + 2]",1,0,0.0,786
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,offset1 = 16,1,0,0.0,787
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,offset2 = 32,1,0,0.0,788
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,offset1 = 32,1,0,0.0,789
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,ip_address = wbem_network_adapter_config.IPAddress[0],1,0,0.0,790
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,adapter_name = wbem_network_adapter.NetConnectionID,1,0,0.0,791
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,mac_address = wbem_network_adapter.MacAddress.lower(),1,0,0.0,792
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,wbem_network_adapter_config = \,1,0,0.0,793
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,wbem_network_adapter.associators_(,1,0,0.0,794
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"'Win32_NetworkAdapterSetting',",1,0,0.0,795
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,'Win32_NetworkAdapterConfiguration')[0],1,0,0.0,796
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,ip_address = '',1,0,0.0,797
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,subnet_mask = '',1,0,0.0,798
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if wbem_network_adapter_config.IPEnabled:,1,0,0.0,799
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,subnet_mask = wbem_network_adapter_config.IPSubnet[0],1,0,0.0,800
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,arch = platform.architecture()[0],1,0,0.0,801
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,#wbem_network_adapter_config.DefaultIPGateway[0],1,0,0.0,802
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"network_adapters.append({'name': adapter_name,",1,0,0.0,803
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"'mac-address': mac_address,",1,0,0.0,804
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"'ip-address': ip_address,",1,0,0.0,805
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,'subnet-mask': subnet_mask}),1,0,0.0,806
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,return network_adapters,1,0,0.0,807
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _get_linux_network_adapters():,1,0,0.0,808
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import fcntl,1,0,0.0,809
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,max_bytes = 8096,1,0,0.0,810
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,os.mkdir(LOG_DIR),1,0,0.0,811
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if not os.path.exists(LOG_DIR):,1,0,0.0,812
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,LOG_DIR = 'logs',1,0,0.0,813
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.debug(_(""Restarting networking....\n""))",0,0,0.0,814
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"dns_file_name = ""/etc/resolv.conf""",0,0,0.0,815
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,os.remove(dns_file_name),0,0,0.0,816
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"_execute(['touch', dns_file_name])",0,0,0.0,817
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"dns_file = open(dns_file_name, 'w')",0,0,0.0,818
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"dns_file.write(""; generated by OpenStack guest tools"")",0,0,0.0,819
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,unique_entries = _filter_duplicates(all_dns_servers),0,0,0.0,820
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for dns_server in unique_entries:,0,0,0.0,821
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"dns_file.write(""\nnameserver %s"" % dns_server)",0,0,0.0,822
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,dns_file.close(),0,0,0.0,823
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"_execute(['/sbin/service', 'network', 'restart'])",0,0,0.0,824
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _set_ubuntu_networking(network_details=None):,0,0,0.0,825
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file_name = '/etc/network/interfaces',0,0,0.0,826
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"for device, network_detail in enumerate(network_details):",0,0,0.0,827
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if adapter_name:,0,0,0.0,828
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nauto %s' % adapter_name),0,0,0.0,829
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\niface %s inet static' % adapter_name),0,0,0.0,830
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nbroadcast %s' % broadcast),0,0,0.0,831
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\ngateway %s' % gateway),0,0,0.0,832
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nnetmask %s' % subnet_mask),0,0,0.0,833
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\naddress %s\n' % ip_address),0,0,0.0,834
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.debug(_(""Successfully configured NIC %d with """,0,0,0.0,835
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if all_dns_servers:,0,0,0.0,836
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.close(),0,0,0.0,837
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nMACADDR=%s' % mac_address),0,0,0.0,838
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,# Touch file,0,0,0.0,839
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,network_details = network_details or [],0,0,0.0,840
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,all_dns_servers = [],0,0,0.0,841
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,for network_detail in network_details:,0,0,0.0,842
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,all_dns_servers.extend(dns_servers),0,0,0.0,843
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_get_linux_adapter_name_and_ip_address(mac_address),0,0,0.0,844
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file_name = \,0,0,0.0,845
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,'/etc/sysconfig/network-scripts/ifcfg-%s' % adapter_name,0,0,0.0,846
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,# Remove file,0,0,0.0,847
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,os.remove(interface_file_name),0,0,0.0,848
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"_execute(['touch', interface_file_name])",0,0,0.0,849
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nIPADDR=%s' % ip_address),0,0,0.0,850
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"interface_file = open(interface_file_name, 'w')",0,0,0.0,851
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nDEVICE=%s' % adapter_name),0,0,0.0,852
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nUSERCTL=yes'),0,0,0.0,853
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nONBOOT=yes'),0,0,0.0,854
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nBOOTPROTO=static'),0,0,0.0,855
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nBROADCAST=%s' % broadcast),0,0,0.0,856
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nNETWORK='),0,0,0.0,857
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nGATEWAY=%s' % gateway),0,0,0.0,858
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,interface_file.write('\nNETMASK=%s' % subnet_mask),0,0,0.0,859
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""NIC info %s"") % (device, network_detail))",0,0,0.0,860
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"_execute(['/etc/init.d/networking', 'restart'])",0,0,0.0,861
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,else:,1,0,0.0,862
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,def _linux_set_networking():,0,0,0.0,863
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,On Windows we require pyWin32 installed on Python.,1,0,0.0,864
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import array,1,0,0.0,865
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import gettext,1,0,0.0,866
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import logging,1,0,0.0,867
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import os,1,0,0.0,868
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import platform,1,0,0.0,869
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import socket,1,0,0.0,870
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import struct,1,0,0.0,871
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import subprocess,1,0,0.0,872
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import sys,1,0,0.0,873
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,import time,1,0,0.0,874
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"gettext.install('nova', unicode=1)",1,0,0.0,875
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,PLATFORM_WIN = 'win32',1,0,0.0,876
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,PLATFORM_LINUX = 'linux2',1,0,0.0,877
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,ARCH_32_BIT = '32bit',1,0,0.0,878
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,ARCH_64_BIT = '64bit',1,0,0.0,879
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,NO_MACHINE_ID = 'No machine id',1,0,0.0,880
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,# Logging,1,0,0.0,881
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"FORMAT = ""%(asctime)s - %(levelname)s - %(message)s""",1,0,0.0,882
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"LOG_DIR = os.path.join(os.environ.get('ALLUSERSPROFILE'), 'openstack')",1,0,0.0,883
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,LOG_DIR = '/var/log/openstack',1,0,0.0,884
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"""""""",1,0,0.0,885
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"#    Unless required by applicable law or agreed to in writing, software",1,0,0.0,886
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,#         http://www.apache.org/licenses/LICENSE-2.0,1,0,0.0,887
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"network_details = _parse_network_details(_execute(cmd,",0,0,0.0,888
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,if os.path.exists('/usr/sbin/vmtoolsd'):,0,0,0.0,889
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,vmware_tools_bin = '/usr/sbin/vmtoolsd',0,0,0.0,890
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,elif os.path.exists('/usr/bin/vmtoolsd'):,0,0,0.0,891
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,vmware_tools_bin = '/usr/bin/vmtoolsd',0,0,0.0,892
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,elif os.path.exists('/usr/sbin/vmware-guestd'):,0,0,0.0,893
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,vmware_tools_bin = '/usr/sbin/vmware-guestd',0,0,0.0,894
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,elif os.path.exists('/usr/bin/vmware-guestd'):,0,0,0.0,895
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,vmware_tools_bin = '/usr/bin/vmware-guestd',0,0,0.0,896
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"cmd = [vmware_tools_bin, '--cmd', 'machine.id.get']",0,0,0.0,897
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,check_exit_code=False)),0,0,0.0,898
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,#,1,0,0.0,899
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"# TODO(sateesh): For other distros like suse, debian, BSD, etc.",0,0,0.0,900
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_set_ubuntu_networking(network_details),0,0,0.0,901
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_set_rhel_networking(network_details),0,0,0.0,902
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"logging.warn(_(""Distro '%s' not supported"") % platform.dist()[0])",0,0,0.0,903
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_windows_set_networking(),0,0,0.0,904
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_linux_set_networking(),0,0,0.0,905
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,# vim: tabstop=4 shiftwidth=4 softtabstop=4,1,0,0.0,906
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,"# Copyright (c) 2011 Citrix Systems, Inc.",1,0,0.0,907
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,# Copyright 2011 OpenStack LLC.,1,0,0.0,908
ba08f5f97a660b2b8f5b623c447e23d608a0d46d,_linux_set_networking(),1,0,0.0,909
