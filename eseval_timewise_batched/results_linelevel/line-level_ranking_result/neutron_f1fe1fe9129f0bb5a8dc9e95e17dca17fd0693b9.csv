commit_id,line,line_level_label,count,line_score,row
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"# no filtered ports in 'fake_sgid', so all rules and members",1,4,1.0,1
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall.filtered_ports['tapfake_dev'] = port,0,1,0.25,2
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self._setup_fake_firewall_members_and_rules(self.firewall),1,1,0.25,3
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,# are not needed and we expect them to be cleaned up,1,1,0.25,4
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,port = self._fake_port(),1,1,0.25,5
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,port = self._fake_port(),0,1,0.25,6
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall.prepare_port_filter(self._fake_port()),1,0,0.0,7
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"self.firewall.ipset.assert_has_calls(calls, True)",1,0,0.0,8
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"mock.call.set_members('fake_sgid', 'IPv6', ['fe80::1'])]",1,0,0.0,9
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"'10.0.0.5']),",1,0,0.0,10
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"['10.0.0.1', '10.0.0.3', '10.0.0.4',",1,0,0.0,11
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"mock.call.set_members('fake_sgid', 'IPv4',",1,0,0.0,12
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,calls = [,1,0,0.0,13
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,'IPv6': ['fe80::1']}},1,0,0.0,14
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"'IPv4': ['10.0.0.2'],",1,0,0.0,15
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall.pre_sg_members = {'fake_sgid': {,1,0,0.0,16
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,def test_prepare_port_filter_with_sg_no_member(self):,1,0,0.0,17
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"'10.0.0.1', '10.0.0.3', '10.0.0.4', '10.0.0.5'],",1,0,0.0,18
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,'IPv4': [,1,0,0.0,19
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall.pre_sg_rules = self._fake_sg_rules(),1,0,0.0,20
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,def test_prepare_port_filter_with_deleted_member(self):,1,0,0.0,21
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"'IPv4': ['10.0.0.1'],",1,0,0.0,22
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"{'direction': 'ingress', 'remote_group_id': 'fake_sgid2',",1,0,0.0,23
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall.sg_rules[FAKE_SGID].append(,1,0,0.0,24
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"self.firewall.ipset.assert_has_calls(calls, any_order=True)",1,0,0.0,25
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"calls = [mock.call.set_members(FAKE_SGID, constants.IPv4, [])]",1,0,0.0,26
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall._update_ipset_members(sg_info),1,0,0.0,27
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,sg_info = {constants.IPv4: [FAKE_SGID]},1,0,0.0,28
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall.sg_members[FAKE_SGID][_IPv6] = [],1,0,0.0,29
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall.sg_members[FAKE_SGID][_IPv4] = [],1,0,0.0,30
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,def test_update_ipset_members(self):,1,0,0.0,31
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"['10.0.0.1', '10.0.0.2']),",1,0,0.0,32
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall.pre_sg_members = {},1,0,0.0,33
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"calls = [mock.call.set_members('fake_sgid', 'IPv4',",1,0,0.0,34
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,port['security_group_source_groups'].append('fake_sgid2'),1,0,0.0,35
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"'IPv4': ['10.0.0.1', '10.0.0.2'], 'IPv6': ['fe80::1']}",1,0,0.0,36
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall.sg_members['fake_sgid'] = {,1,0,0.0,37
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall.sg_rules.update(),1,0,0.0,38
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,'ethertype': 'IPv4'}),1,0,0.0,39
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall.prepare_port_filter(port),1,0,0.0,40
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall.sg_rules = self._fake_sg_rules(),1,0,0.0,41
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"'IPv4': ['10.0.0.1', '10.0.0.2'], 'IPv6': ['fe80::1']}}",1,0,0.0,42
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"remote_groups={_IPv4: [FAKE_SGID], _IPv6: [FAKE_SGID]})",0,0,0.0,43
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"self.assertIn(OTHER_SGID, self.firewall.sg_members)",0,0,0.0,44
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall._remove_unused_security_group_info(),0,0,0.0,45
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"remote_groups={_IPv4: [OTHER_SGID], _IPv6: [OTHER_SGID]})",0,0,0.0,46
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,def test_not_remove_used_security_group_info(self):,0,0,0.0,47
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"self.assertNotIn(OTHER_SGID, self.firewall.sg_members)",0,0,0.0,48
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall.pre_sg_rules = self.firewall.sg_rules,0,0,0.0,49
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall.sg_rules = self._fake_sg_rules(,0,0,0.0,50
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall.sg_members = {'fake_sgid': {,1,0,0.0,51
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall.pre_sg_members = self.firewall.sg_members,0,0,0.0,52
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"self.firewall.sg_members = {OTHER_SGID: {_IPv4: [], _IPv6: []}}",0,0,0.0,53
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall._remove_sg_members(remote_sgs_to_remove),0,0,0.0,54
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"_IPv6: set([FAKE_SGID, OTHER_SGID])}",0,0,0.0,55
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"remote_sgs_to_remove = {_IPv4: set([FAKE_SGID]),",0,0,0.0,56
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,def test_remove_sg_members(self):,0,0,0.0,57
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,def test_clear_sg_members(self):,1,0,0.0,58
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall.sg_members = self._fake_sg_members(,1,0,0.0,59
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"sg_ids=[FAKE_SGID, OTHER_SGID])",1,0,0.0,60
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"self.firewall._clear_sg_members(_IPv4, [OTHER_SGID])",1,0,0.0,61
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"self.assertEqual(0, len(self.firewall.sg_members[OTHER_SGID][_IPv4]))",1,0,0.0,62
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,def test_remove_unused_sg_members(self):,1,0,0.0,63
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall.sg_members[FAKE_SGID][_IPv4] = [],1,0,0.0,64
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall.sg_members[FAKE_SGID][_IPv6] = [],1,0,0.0,65
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall.sg_members[OTHER_SGID][_IPv6] = [],1,0,0.0,66
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall._remove_unused_sg_members(),1,0,0.0,67
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall.prepare_port_filter(self._fake_port(OTHER_SGID)),1,0,0.0,68
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"self.assertNotIn(FAKE_SGID, self.firewall.sg_members)",1,0,0.0,69
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,def test_update_security_group_members(self):,0,0,0.0,70
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"sg_members = {'IPv4': ['10.0.0.1', '10.0.0.2'], 'IPv6': ['fe80::1']}",0,0,0.0,71
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"self.firewall.update_security_group_members('fake_sgid', sg_members)",0,0,0.0,72
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,"sg_members = {'IPv4': ['10.0.0.1'], 'IPv6': ['fe80::1']}",0,0,0.0,73
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,def test_prepare_port_filter_with_new_members(self):,1,0,0.0,74
f1fe1fe9129f0bb5a8dc9e95e17dca17fd0693b9,self.firewall.ipset.assert_has_calls(calls),1,0,0.0,75
