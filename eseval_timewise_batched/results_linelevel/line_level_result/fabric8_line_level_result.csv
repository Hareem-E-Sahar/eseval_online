line,commit_id,count,line_level_label
import org.fusesource.fabric.zookeeper.IZKClient;,e27aa353ba59de8fc406fa37f26cb2adcf65b4ef,0,0
import org.linkedin.zookeeper.client.IZKClient;,e27aa353ba59de8fc406fa37f26cb2adcf65b4ef,0,1
"@Property(name = ""dataDir"", label = ""Container Data Dir"", description = ""The data directory of the container"", value = ""${runtime.data}"", propertyPrivate = true)",5c3a7a14634906c1d14cab27a51da8deb7ed4090,6,1
"@Property(name = ""runtime.id"", label = ""Container Name"", description = ""The name of the container"", value = ""${runtime.id}"", propertyPrivate = true)",5c3a7a14634906c1d14cab27a51da8deb7ed4090,5,1
"@Property(name = ""homeDir"", label = ""Container Home"", description = ""The homeDir directory of the container"", value = ""${runtime.home}"", propertyPrivate = true)",5c3a7a14634906c1d14cab27a51da8deb7ed4090,5,1
"@Property(name = ""confDir"", label = ""Container Conf"", description = ""The configuration directory of the container"", value = ""${runtime.conf}"", propertyPrivate = true)",5c3a7a14634906c1d14cab27a51da8deb7ed4090,5,1
"@Property(name = ""zookeeper.url"", label = ""ZooKeeper URL"", description = ""The url to an existing zookeeper ensemble"", value = ""${zookeeper.url}"", propertyPrivate = true)",5c3a7a14634906c1d14cab27a51da8deb7ed4090,5,1
"@Property(name = ""ensemble.auto.start"", label = ""Ensemble Auto Start"", description = ""Flag to automatically start a zookeeper ensemble"", value = ""${ensemble.auto.start}"")",5c3a7a14634906c1d14cab27a51da8deb7ed4090,4,1
"@Property(name = ""agent.auto.start"", label = ""Agent Auto Start"", description = ""Flag to automatically start the provisioning agent"", value = ""${agent.auto.start}"")",5c3a7a14634906c1d14cab27a51da8deb7ed4090,4,1
"@Property(name = ""bind.address"", label = ""Bind Address"", description = ""The Bind Address"", value = ""${bind.address}"")",5c3a7a14634906c1d14cab27a51da8deb7ed4090,4,1
"@Property(name = ""zookeeper.password"", label = ""ZooKeeper Password"", description = ""The zookeeper password"", value = ""${zookeeper.password}"")",5c3a7a14634906c1d14cab27a51da8deb7ed4090,4,1
"@Property(name = ""zookeeper.server.port"", label = ""ZooKeeper Server Port"", description = ""The zookeeper server binding port"", value = ""${zookeeper.server.port}"")",5c3a7a14634906c1d14cab27a51da8deb7ed4090,4,1
"@Property(name = ""zookeeper.server.connection.port"", label = ""ZooKeeper Client Port"", description = ""The zookeeper server connection port"", value = ""${zookeeper.server.connection.port}"")",5c3a7a14634906c1d14cab27a51da8deb7ed4090,4,1
"@Property(name = ""profiles.auto.import"", label = ""Auto Import Enabled"", description = ""Flag to automatically import the default profiles"", value = ""${profiles.auto.import}"")",5c3a7a14634906c1d14cab27a51da8deb7ed4090,4,1
"@Property(name = ""profiles.auto.import.path"", label = ""Auto Import Enabled"", description = ""Flag to automatically import the default profiles"", value = ""${profiles.auto.import.path}"")",5c3a7a14634906c1d14cab27a51da8deb7ed4090,4,1
"@Property(name = ""local.resolver"", label = ""Resolver"", description = ""The container resolver"", value = ""${local.resolver}"")",5c3a7a14634906c1d14cab27a51da8deb7ed4090,4,1
"@Property(name = ""global.resolver"", label = ""Global Resolver"", description = ""The global resolver"", value = ""${global.resolver}"")",5c3a7a14634906c1d14cab27a51da8deb7ed4090,4,1
"@Property(name = ""manualip"", label = ""Global Resolver"", description = ""The manally set ip"", value = ""${manualip}"")",5c3a7a14634906c1d14cab27a51da8deb7ed4090,4,1
"@Property(name = ""publichostname"", label = ""Public Hostname"", description = ""The public hostname"", value = ""${publichostname}"")",5c3a7a14634906c1d14cab27a51da8deb7ed4090,4,1
"org.apache.felix.utils.properties.Properties props = new org.apache.felix.utils.properties.Properties(new File(dataDir, ENSEMBLE_MARKER));",5c3a7a14634906c1d14cab27a51da8deb7ed4090,4,1
"@Reference(referenceInterface = RuntimeProperties.class, bind = ""bindRuntimeProperties"", unbind = ""unbindRuntimeProperties"")",5c3a7a14634906c1d14cab27a51da8deb7ed4090,3,1
Properties properties = new Properties();,5c3a7a14634906c1d14cab27a51da8deb7ed4090,3,1
"public static final String DEFAULT_ADMIN_USER = ""admin"";",5c3a7a14634906c1d14cab27a51da8deb7ed4090,2,1
"public static final String ROLE_DELIMITER = "","";",5c3a7a14634906c1d14cab27a51da8deb7ed4090,2,1
"@Property(name = ""profiles"", value = ""${profiles}"")",5c3a7a14634906c1d14cab27a51da8deb7ed4090,2,1
"@Property(name = ""version"", value = ""${version}"")",5c3a7a14634906c1d14cab27a51da8deb7ed4090,2,1
Properties userProps = new Properties();,5c3a7a14634906c1d14cab27a51da8deb7ed4090,2,1
"File marker = new File(dataDir, ENSEMBLE_MARKER);",5c3a7a14634906c1d14cab27a51da8deb7ed4090,2,1
org.apache.felix.utils.properties.Properties props = new org.apache.felix.utils.properties.Properties(marker);,5c3a7a14634906c1d14cab27a51da8deb7ed4090,2,1
"Dictionary<String, Object> properties = new Hashtable<String, Object>();",5c3a7a14634906c1d14cab27a51da8deb7ed4090,2,1
static final Logger LOGGER = LoggerFactory.getLogger(BootstrapConfiguration.class);,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
"public static final String ENSEMBLE_MARKER = ""ensemble-created.properties"";",5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
"public static final String COMPONENT_PID = ""io.fabric8.bootstrap.configuration"";",5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
public static final String COMPONENT_NAME = COMPONENT_PID;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
"public static final String DEFAULT_ADMIN_ROLE = ""admin,manager,viewer"";",5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
private final ValidatingReference<RuntimeProperties> runtimeProperties = new ValidatingReference<RuntimeProperties>();,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
private boolean agentAutoStart = true;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
"private String bindAddress = ""0.0.0.0"";",5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
private String zookeeperPassword = null;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
private int zookeeperServerPort = 2181;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
private int zookeeperServerConnectionPort = 2181;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
private boolean profilesAutoImport = true;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
"private String profilesAutoImportPath = ""fabric/import"";",5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
private Set<String> profiles = Collections.emptySet();,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
private String version = ContainerOptions.DEFAULT_VERSION;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
"private String globalResolver = ""localhostname"";",5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
this.componentContext = componentContext;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
"configuration = configurer.configure(conf, this);",5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
localResolver = globalResolver;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
String decodedZookeeperPassword = null;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
decodedZookeeperPassword = PasswordEncoder.decode(zookeeperPassword);,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
String passwordAndRole = userProps.getProperty(DEFAULT_ADMIN_USER).trim();,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
"decodedZookeeperPassword = passwordAndRole.substring(0, passwordAndRole.indexOf(ROLE_DELIMITER));",5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
decodedZookeeperPassword = PasswordEncoder.encode(CreateEnsembleOptions.generatePassword());,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
"userProps.put(DEFAULT_ADMIN_USER, decodedZookeeperPassword+ ROLE_DELIMITER + DEFAULT_ADMIN_ROLE);",5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
options = CreateEnsembleOptions.builder().bindAddress(bindAddress).agentEnabled(agentAutoStart).ensembleStart(ensembleAutoStart).zookeeperPassword(decodedZookeeperPassword),5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
BundleContext bundleContext = componentContext.getBundleContext();,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
boolean isCreated = checkCreated(bundleContext);,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
String connectionUrl = getConnectionUrl(options);,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
"DataStoreOptions bootOptions = new DataStoreOptions(runtimeId, homeDir, connectionUrl, options);",5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
int zooKeeperServerConnectionPort = options.getZooKeeperServerConnectionPort();,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
"String connectionUrl = getConnectionAddress(options) + "":"" + zooKeeperServerConnectionPort;",5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
"int serverPort = Ports.mapPortToRange(options.getZooKeeperServerPort(), options.getMinimumPort(), options.getMaximumPort());",5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
String serverHost = options.getBindAddress();,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
"Configuration config = configAdmin.get().createFactoryConfiguration(Constants.ZOOKEEPER_SERVER_PID, null);",5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
properties,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
"Configuration config = configAdmin.get().getConfiguration(Constants.ZOOKEEPER_CLIENT_PID, null);",5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
String oResolver = Strings.isNotBlank(options.getResolver()) ? options.getResolver() : localResolver;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
String oManualIp = Strings.isNotBlank(options.getManualIp()) ? options.getManualIp() : manualip;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
InputStream is = null;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
is = new FileInputStream(from);,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
this.connectionUrl = connectionUrl;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
this.containerId = containerId;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
this.homeDir = homeDir;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
this.options = options;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,1,1
/**,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"*  Copyright 2005-2014 Red Hat, Inc.",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
*,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"*  Red Hat licenses this file to you under the Apache License, version",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
*  with the License.  You may obtain a copy of the License at,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"*  Unless required by applicable law or agreed to in writing, software",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
*  implied.  See the License for the specific language governing,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
*  permissions and limitations under the License.,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
*/,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
package io.fabric8.zookeeper.bootstrap;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"* Copyright (C) FuseSource, Inc.",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
* http://fusesource.com,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"* Licensed under the Apache License, Version 2.0 (the ""License"");",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
* you may not use this file except in compliance with the License.,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
* You may obtain a copy of the License at,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
*    http://www.apache.org/licenses/LICENSE-2.0,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"* Unless required by applicable law or agreed to in writing, software",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"* distributed under the License is distributed on an ""AS IS"" BASIS,",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
* See the License for the specific language governing permissions and,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
* limitations under the License.,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
public class BootstrapConfiguration {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
},5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
/*,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import io.fabric8.api.Constants;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import io.fabric8.api.ContainerOptions;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import io.fabric8.api.CreateEnsembleOptions;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import io.fabric8.api.DataStoreTemplate;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import io.fabric8.api.RuntimeProperties;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import io.fabric8.api.ZkDefs;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import io.fabric8.api.jcip.ThreadSafe;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import io.fabric8.api.scr.AbstractComponent;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import io.fabric8.api.scr.Configurer;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import io.fabric8.api.scr.ValidatingReference;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import io.fabric8.utils.Strings;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import io.fabric8.utils.HostUtils;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import io.fabric8.utils.PasswordEncoder;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import io.fabric8.utils.Ports;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import java.io.File;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import java.io.FileInputStream;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import java.io.IOException;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import java.io.InputStream;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import java.net.UnknownHostException;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import java.util.Collections;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import java.util.Dictionary;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import java.util.Hashtable;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import java.util.Map;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import java.util.Set;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import Activate;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import Component;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import ConfigurationPolicy;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import Deactivate;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import Modified;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import org.apache.felix.scr.annotations.Property;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import org.apache.felix.scr.annotations.Reference;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import org.apache.felix.scr.annotations.Service;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import org.apache.felix.utils.properties.Properties;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import org.osgi.framework.BundleContext;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import org.osgi.service.cm.Configuration;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import org.osgi.service.cm.ConfigurationAdmin;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import org.osgi.service.component.ComponentContext;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import org.slf4j.Logger;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
import org.slf4j.LoggerFactory;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
private CreateEnsembleOptions options;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
private boolean ensembleAutoStart;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
private String localResolver;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
private String manualip;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
private String publichostname;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
private String runtimeId;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
private File homeDir;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
private File confDir;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
private File dataDir;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
private String zookeeperUrl;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
private ComponentContext componentContext;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"private Map<String, ?> configuration;",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
@Activate,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"void activate(ComponentContext componentContext, Map<String, ?> conf) throws Exception {",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
configureInternal(conf);,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
bootIfNeeded();,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
activateComponent();,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
@Modified,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"void modified(Map<String, ?> conf) throws Exception {",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
@Deactivate,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
void deactivate() {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
deactivateComponent();,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"void configureInternal(Map<String, ?> conf) throws Exception {",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
if (Strings.isNullOrBlank(runtimeId)) {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"throw new IllegalArgumentException(""Runtime id must not be null or empty."");",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
if (Strings.isNullOrBlank(localResolver)) {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
try {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"userProps.load(new File(confDir , ""users.properties""));",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
} catch (IOException e) {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"LOGGER.warn(""Failed to load users from etc/users.properties. No users will be imported."", e);",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
if (Strings.isNotBlank(zookeeperPassword)) {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
} else if (userProps.containsKey(DEFAULT_ADMIN_USER)) {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
} else {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
if (userProps.isEmpty()) {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
.zooKeeperServerPort(zookeeperServerPort).zooKeeperServerConnectionPort(zookeeperServerConnectionPort).autoImportEnabled(profilesAutoImport),5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
.importPath(profilesAutoImportPath).resolver(localResolver).globalResolver(globalResolver).users(userProps).profiles(profiles).version(version).build();,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
void bootIfNeeded() throws IOException {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
if (!Strings.isNotBlank(zookeeperUrl) && !isCreated && options.isEnsembleStart()) {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"runtimeProperties.get().putRuntimeAttribute(DataStoreTemplate.class, new DataStoreBootstrapTemplate(bootOptions));",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
createOrUpdateDataStoreConfig(options);,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
*//*,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
createZooKeeeperServerConfig(options);,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"createZooKeeeperClientConfig(connectionUrl, options);",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"// On restart, the configuration should be available in configadmin",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
markCreated(bundleContext);,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
public ComponentContext getComponentContext() {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
return componentContext;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
private boolean checkCreated(BundleContext bundleContext) throws IOException {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"return props.containsKey(""created"");",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
private void markCreated(BundleContext bundleContext) throws IOException {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
if (!marker.exists() && !marker.getParentFile().exists() && !marker.getParentFile().mkdirs()) {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"throw new IOException(""Cannot create marker file"");",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"props.put(""created"", ""true"");",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
props.save();,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
public CreateEnsembleOptions getBootstrapOptions() {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
assertValid();,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
return options;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
public String getConnectionUrl(CreateEnsembleOptions options) throws UnknownHostException {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
return connectionUrl;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
* Creates ZooKeeper server configuration,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
public void createZooKeeeperServerConfig(CreateEnsembleOptions options) throws IOException {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
if (options.isAutoImportEnabled()) {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"loadPropertiesFrom(properties, options.getImportPath() + ""/fabric/profiles/default.profile/io.fabric8.zookeeper.server.properties"");",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"properties.put(""tickTime"", String.valueOf(options.getZooKeeperServerTickTime()));",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"properties.put(""initLimit"", String.valueOf(options.getZooKeeperServerInitLimit()));",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"properties.put(""syncLimit"", String.valueOf(options.getZooKeeperServerSyncLimit()));",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"properties.put(""dataDir"", options.getZooKeeperServerDataDir() + File.separator + ""0000"");",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"properties.put(""clientPort"", Integer.toString(serverPort));",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"properties.put(""clientPortAddress"", serverHost);",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"properties.put(""fabric.zookeeper.pid"", ""io.fabric8.zookeeper.server-0000"");",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
config.update(properties);,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
* Creates ZooKeeper client configuration.,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"public void createZooKeeeperClientConfig(String connectionUrl, CreateEnsembleOptions options) throws IOException {",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"loadPropertiesFrom(properties, options.getImportPath() + ""/fabric/profiles/default.profile/io.fabric8.zookeeper.properties"");",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"properties.put(""zookeeper.url"", connectionUrl);",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
".put(""zookeeper.timeout"", System.getProperties().containsKey(""zookeeper.timeout"") ? System.getProperties().getProperty(""zookeeper.timeout"") : ""30000"");",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"properties.put(""fabric.zookeeper.pid"", Constants.ZOOKEEPER_CLIENT_PID);",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"properties.put(""zookeeper.password"", PasswordEncoder.encode(options.getZookeeperPassword()));",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
private String getConnectionAddress(CreateEnsembleOptions options) throws UnknownHostException {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
if (oResolver.equals(ZkDefs.LOCAL_HOSTNAME)) {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
return HostUtils.getLocalHostName();,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
} else if (oResolver.equals(ZkDefs.LOCAL_IP)) {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
return HostUtils.getLocalIp();,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
} else if (oResolver.equals(ZkDefs.PUBLIC_HOSTNAME) && (publichostname != null && !publichostname.isEmpty())) {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
return publichostname;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
} else if (oResolver.equals(ZkDefs.MANUAL_IP) && (oManualIp != null && !oManualIp.isEmpty())) {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
return oManualIp;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"private void loadPropertiesFrom(Dictionary<String, Object> dictionary, String from) {",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
properties.load(is);,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
for (String key : properties.keySet()) {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"dictionary.put(key, properties.get(key));",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
} catch (Exception e) {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
// Ignore,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
} finally {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
if (is != null) {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
is.close();,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
public String getLocalResolver() {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
return localResolver;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
public String getGlobalResolver() {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
return globalResolver;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
public String getManualip() {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
return manualip;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
public String getVersion() {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
return version;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
public Set<String> getProfiles() {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
return Collections.unmodifiableSet(profiles);,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
public String getBindAddress() {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
return bindAddress;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"public Map<String, ?> getConfiguration() {",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
return Collections.unmodifiableMap(configuration);,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
public static class DataStoreOptions {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
private final String containerId;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
private final File homeDir;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
private final String connectionUrl;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
private final CreateEnsembleOptions options;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"public DataStoreOptions(String containerId, File homeDir, String connectionUrl, CreateEnsembleOptions options) {",5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
public String getContainerId() {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
return containerId;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
public File getHomeDir() {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
return homeDir;,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
public String getConnectionUrl() {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
public CreateEnsembleOptions getCreateOptions() {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
void bindConfigAdmin(ConfigurationAdmin service) {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
this.configAdmin.bind(service);,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
void unbindConfigAdmin(ConfigurationAdmin service) {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
this.configAdmin.unbind(service);,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
void bindRuntimeProperties(RuntimeProperties service) {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
this.runtimeProperties.bind(service);,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
void unbindRuntimeProperties(RuntimeProperties service) {,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
this.runtimeProperties.unbind(service);,5c3a7a14634906c1d14cab27a51da8deb7ed4090,0,1
"String tag = ""fabric8-"" + Strings.join(names, ""-"").replace('.', '-');",7f34e0184a3e81a89f31e8eab3721d197d9a3688,4,0
"String tag = ""fabric8-"" + Strings.join(names, ""-"").replace('.', '-');",7f34e0184a3e81a89f31e8eab3721d197d9a3688,4,1
"environmentVariables.put(""FABRIC8_"" + portName + ""_PORT"", """" + port);",7f34e0184a3e81a89f31e8eab3721d197d9a3688,3,0
"environmentVariables.put(""FABRIC8_"" + portName + ""_PROXY_PORT"", """" + externalPort);",7f34e0184a3e81a89f31e8eab3721d197d9a3688,3,0
"@Reference(referenceInterface = FabricService.class, bind = ""bindFabricService"", unbind = ""unbindFabricService"")",7f34e0184a3e81a89f31e8eab3721d197d9a3688,3,1
"env.add(""FABRIC8_"" + portName + ""_PORT="" + port);",7f34e0184a3e81a89f31e8eab3721d197d9a3688,3,1
"env.add(""FABRIC8_"" + portName + ""_PROXY_PORT="" + externalPort);",7f34e0184a3e81a89f31e8eab3721d197d9a3688,3,1
String libDir = configOverlay.get(DockerConstants.PROPERTIES.JAVA_LIBRARY_PATH);,7f34e0184a3e81a89f31e8eab3721d197d9a3688,2,0
String imageRepository = configOverlay.get(DockerConstants.PROPERTIES.IMAGE_REPOSITORY);,7f34e0184a3e81a89f31e8eab3721d197d9a3688,2,0
String entryPoint = configOverlay.get(DockerConstants.PROPERTIES.IMAGE_ENTRY_POINT);,7f34e0184a3e81a89f31e8eab3721d197d9a3688,2,0
List<String> names = new ArrayList<String>(profileIds);,7f34e0184a3e81a89f31e8eab3721d197d9a3688,2,0
"String actualImage = builder.generateContainerImage(service, container, profileOverlays, docker, javaContainerOptions, downloadExecutor, environmentVariables);",7f34e0184a3e81a89f31e8eab3721d197d9a3688,2,0
String key = entry.getKey();,7f34e0184a3e81a89f31e8eab3721d197d9a3688,2,0
String value = entry.getValue();,7f34e0184a3e81a89f31e8eab3721d197d9a3688,2,0
"env.add(key + ""="" + value);",7f34e0184a3e81a89f31e8eab3721d197d9a3688,2,0
String libDir = configOverlay.get(DockerConstants.PROPERTIES.JAVA_LIBRARY_PATH);,7f34e0184a3e81a89f31e8eab3721d197d9a3688,2,1
String imageRepository = configOverlay.get(DockerConstants.PROPERTIES.IMAGE_REPOSITORY);,7f34e0184a3e81a89f31e8eab3721d197d9a3688,2,1
String entryPoint = configOverlay.get(DockerConstants.PROPERTIES.IMAGE_ENTRY_POINT);,7f34e0184a3e81a89f31e8eab3721d197d9a3688,2,1
List<String> names = new ArrayList<String>(profileIds);,7f34e0184a3e81a89f31e8eab3721d197d9a3688,2,1
"String actualImage = builder.generateContainerImage(service, container, profileOverlays, docker, javaContainerOptions, downloadExecutor, environmentVariables);",7f34e0184a3e81a89f31e8eab3721d197d9a3688,2,1
String key = entry.getKey();,7f34e0184a3e81a89f31e8eab3721d197d9a3688,2,1
String value = entry.getValue();,7f34e0184a3e81a89f31e8eab3721d197d9a3688,2,1
"env.add(key + ""="" + value);",7f34e0184a3e81a89f31e8eab3721d197d9a3688,2,1
"env.add(EnvironmentVariables.FABRIC8_MANUALIP + ""="" + dockerHost);",7f34e0184a3e81a89f31e8eab3721d197d9a3688,2,1
"env.add(EnvironmentVariables.FABRIC8_GLOBAL_RESOLVER + ""="" + ZkDefs.MANUAL_IP);",7f34e0184a3e81a89f31e8eab3721d197d9a3688,2,1
"env.add(EnvironmentVariables.FABRIC8_FABRIC_ENVIRONMENT + ""="" + DockerConstants.SCHEME);",7f34e0184a3e81a89f31e8eab3721d197d9a3688,2,1
@Reference(referenceInterface = FabricService.class),7f34e0184a3e81a89f31e8eab3721d197d9a3688,1,0
"Map<String, String> javaContainerConfig = Profiles.getOverlayConfiguration(service, profileIds, versionId, ChildConstants.JAVA_CONTAINER_PID);",7f34e0184a3e81a89f31e8eab3721d197d9a3688,1,0
JavaContainerConfig javaConfig = new JavaContainerConfig();,7f34e0184a3e81a89f31e8eab3721d197d9a3688,1,0
javaContainerImageBuilder builder = new javaContainerImageBuilder();,7f34e0184a3e81a89f31e8eab3721d197d9a3688,1,0
"JavaContainerOptions javaContainerOptions = new JavaContainerOptions(image, imageRepository, tag, libDir, entryPoint);",7f34e0184a3e81a89f31e8eab3721d197d9a3688,1,0
List<String> env = containerConfig.getEnv();,7f34e0184a3e81a89f31e8eab3721d197d9a3688,1,0
env = new ArrayList<String>();,7f34e0184a3e81a89f31e8eab3721d197d9a3688,1,0
"Set<Map.Entry<String, String>> entries = environmentVariables.entrySet();",7f34e0184a3e81a89f31e8eab3721d197d9a3688,1,0
"Map<String, ?> javaContainerConfig = Profiles.getOverlayConfiguration(service, profileIds, versionId, ChildConstants.JAVA_CONTAINER_PID);",7f34e0184a3e81a89f31e8eab3721d197d9a3688,1,1
JavaContainerConfig javaConfig = new JavaContainerConfig();,7f34e0184a3e81a89f31e8eab3721d197d9a3688,1,1
javaContainerImageBuilder builder = new javaContainerImageBuilder();,7f34e0184a3e81a89f31e8eab3721d197d9a3688,1,1
"JavaContainerOptions javaContainerOptions = new JavaContainerOptions(image, imageRepository, tag, libDir, entryPoint);",7f34e0184a3e81a89f31e8eab3721d197d9a3688,1,1
List<String> env = containerConfig.getEnv();,7f34e0184a3e81a89f31e8eab3721d197d9a3688,1,1
env = new ArrayList<String>();,7f34e0184a3e81a89f31e8eab3721d197d9a3688,1,1
"Set<Map.Entry<String, String>> entries = environmentVariables.entrySet();",7f34e0184a3e81a89f31e8eab3721d197d9a3688,1,1
import io.fabric8.container.process.JolokiaAgentHelper;,7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,0
"configurer.configure(javaContainerConfig, javaConfig);",7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,0
"JolokiaAgentHelper.updateJolokiaPort(javaConfig, environmentVariables, port);",7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,0
javaConfig.updateEnvironmentVariables(environmentVariables);,7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,0
"environmentVariables.put(EnvironmentVariables.FABRIC8_MANUALIP, dockerHost);",7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,0
"environmentVariables.put(EnvironmentVariables.FABRIC8_GLOBAL_RESOLVER, ZkDefs.MANUAL_IP);",7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,0
"environmentVariables.put(EnvironmentVariables.FABRIC8_FABRIC_ENVIRONMENT, DockerConstants.SCHEME);",7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,0
// now the environment variables are all set lets see if we need to make a custom image,7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,0
if (!Strings.isNullOrBlank(libDir)) {,7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,0
if (container != null) {,7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,0
"container.setProvisionResult(""preparing"");",7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,0
container.setAlive(true);,7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,0
},7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,0
names.add(versionId);,7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,0
containerConfig.setImage(actualImage);,7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,0
if (env == null) {,7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,0
"for (Map.Entry<String, String> entry : entries) {",7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,0
if (key != null && value != null) {,7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,0
"configurer.configure(javaContainerConfig, javaConfig);",7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,1
javaConfig.updateEnvironmentVariables(environmentVariables);,7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,1
if (!Strings.isNullOrBlank(libDir)) {,7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,1
if (container != null) {,7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,1
"container.setProvisionResult(""preparing"");",7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,1
container.setAlive(true);,7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,1
},7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,1
names.add(versionId);,7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,1
containerConfig.setImage(actualImage);,7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,1
if (env == null) {,7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,1
"for (Map.Entry<String, String> entry : entries) {",7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,1
if (key != null && value != null) {,7f34e0184a3e81a89f31e8eab3721d197d9a3688,0,1
"Service service = assertParseExampleFile(""service.json"", Service.class);",1729161d246f39cbf1945e066fd9075e3128984e,2,0
"ServiceSchema service = assertParseExampleFile(""service.json"", ServiceSchema.class);",1729161d246f39cbf1945e066fd9075e3128984e,2,1
import io.fabric8.kubernetes.api.model.Container;,1729161d246f39cbf1945e066fd9075e3128984e,0,0
import io.fabric8.kubernetes.api.model.ContainerManifest;,1729161d246f39cbf1945e066fd9075e3128984e,0,0
import io.fabric8.kubernetes.api.model.Pod;,1729161d246f39cbf1945e066fd9075e3128984e,0,0
import io.fabric8.kubernetes.api.model.PodList;,1729161d246f39cbf1945e066fd9075e3128984e,0,0
import io.fabric8.kubernetes.api.model.PodState;,1729161d246f39cbf1945e066fd9075e3128984e,0,0
import io.fabric8.kubernetes.api.model.Service;,1729161d246f39cbf1945e066fd9075e3128984e,0,0
import java.io.File;,1729161d246f39cbf1945e066fd9075e3128984e,0,0
import java.util.Collection;,1729161d246f39cbf1945e066fd9075e3128984e,0,0
import java.util.List;,1729161d246f39cbf1945e066fd9075e3128984e,0,0
import static io.fabric8.kubernetes.api.KubernetesHelper.getId;,1729161d246f39cbf1945e066fd9075e3128984e,0,0
"PodList podList = assertParseExampleFile(""pod-list.json"", PodList.class);",1729161d246f39cbf1945e066fd9075e3128984e,0,0
List<Pod> items = podList.getItems();,1729161d246f39cbf1945e066fd9075e3128984e,0,0
Pod pod = items.get(0);,1729161d246f39cbf1945e066fd9075e3128984e,0,0
"assertEquals(""pod1.id"", ""my-pod-1"", getId(pod));",1729161d246f39cbf1945e066fd9075e3128984e,0,0
PodState desiredState = pod.getDesiredState();,1729161d246f39cbf1945e066fd9075e3128984e,0,0
ContainerManifest manifest = desiredState.getManifest();,1729161d246f39cbf1945e066fd9075e3128984e,0,0
List<Container> containers = manifest.getContainers();,1729161d246f39cbf1945e066fd9075e3128984e,0,0
Container container = containers.get(0);,1729161d246f39cbf1945e066fd9075e3128984e,0,0
"PodList podList = assertParseExampleFile(""pod-list-empty-results.json"", PodList.class);",1729161d246f39cbf1945e066fd9075e3128984e,0,0
"assertEquals(""127.0.0.1"", pod.getCurrentState().getHost());",1729161d246f39cbf1945e066fd9075e3128984e,0,0
"assertEquals(""pod1.desiredState.manifest.version"", """", pod.getDesiredState().getManifest().getVersion());",1729161d246f39cbf1945e066fd9075e3128984e,0,0
"assertEquals(expectedPort, service.getSpec().getContainerPort().getIntVal());",1729161d246f39cbf1945e066fd9075e3128984e,0,0
"//mapper.writer().writeValue(System.out, service);",1729161d246f39cbf1945e066fd9075e3128984e,0,0
"assertParseExampleFile(""pod.json"", Pod.class);",1729161d246f39cbf1945e066fd9075e3128984e,0,0
"+ "" does not exist! Please supply the correct value in the "" + SYSTEM_PROPERTY_KUBE_DIR + "" system property value"",",1729161d246f39cbf1945e066fd9075e3128984e,0,0
import java.io.File;,1729161d246f39cbf1945e066fd9075e3128984e,0,1
import java.util.Collection;,1729161d246f39cbf1945e066fd9075e3128984e,0,1
import java.util.List;,1729161d246f39cbf1945e066fd9075e3128984e,0,1
import io.fabric8.kubernetes.api.model.DesiredState;,1729161d246f39cbf1945e066fd9075e3128984e,0,1
import io.fabric8.kubernetes.api.model.Manifest;,1729161d246f39cbf1945e066fd9075e3128984e,0,1
import io.fabric8.kubernetes.api.model.ManifestContainer;,1729161d246f39cbf1945e066fd9075e3128984e,0,1
import io.fabric8.kubernetes.api.model.PodListSchema;,1729161d246f39cbf1945e066fd9075e3128984e,0,1
import io.fabric8.kubernetes.api.model.PodSchema;,1729161d246f39cbf1945e066fd9075e3128984e,0,1
import io.fabric8.kubernetes.api.model.ServiceSchema;,1729161d246f39cbf1945e066fd9075e3128984e,0,1
"PodListSchema podList = assertParseExampleFile(""pod-list.json"", PodListSchema.class);",1729161d246f39cbf1945e066fd9075e3128984e,0,1
List<PodSchema> items = podList.getItems();,1729161d246f39cbf1945e066fd9075e3128984e,0,1
PodSchema pod = items.get(0);,1729161d246f39cbf1945e066fd9075e3128984e,0,1
"assertEquals(""pod1.id"", ""my-pod-1"", pod.getId());",1729161d246f39cbf1945e066fd9075e3128984e,0,1
DesiredState desiredState = pod.getDesiredState();,1729161d246f39cbf1945e066fd9075e3128984e,0,1
Manifest manifest = desiredState.getManifest();,1729161d246f39cbf1945e066fd9075e3128984e,0,1
List<ManifestContainer> containers = manifest.getContainers();,1729161d246f39cbf1945e066fd9075e3128984e,0,1
ManifestContainer container = containers.get(0);,1729161d246f39cbf1945e066fd9075e3128984e,0,1
"PodListSchema podList = assertParseExampleFile(""pod-list-empty-results.json"", PodListSchema.class);",1729161d246f39cbf1945e066fd9075e3128984e,0,1
"assertEquals(""127.0.0.1"", pod.getDesiredState().getHost());",1729161d246f39cbf1945e066fd9075e3128984e,0,1
"assertEquals(""pod1.desiredState.manifest.version"", ""__EMPTY__"",pod.getDesiredState().getManifest().getVersion().name());",1729161d246f39cbf1945e066fd9075e3128984e,0,1
"assertEquals(expectedPort, service.getContainerPort().getIntValue());",1729161d246f39cbf1945e066fd9075e3128984e,0,1
"mapper.writer().writeValue(System.out, service);",1729161d246f39cbf1945e066fd9075e3128984e,0,1
"assertParseExampleFile(""pod.json"", PodSchema.class);",1729161d246f39cbf1945e066fd9075e3128984e,0,1
"+ "" does not exist! Please supply the correct value in the "" + SYSTEM_PROPERTY_KUBE_DIR + "" system property value"",",1729161d246f39cbf1945e066fd9075e3128984e,0,1
* The name label used in the generated Kubernetes JSON template,2e0227114d54e2ead452eaec7f7a74fe11290830,5,0
* The name label used in the generated Kubernetes JSON template,2e0227114d54e2ead452eaec7f7a74fe11290830,5,1
* The replication controller name used in the generated Kubernetes JSON template,2e0227114d54e2ead452eaec7f7a74fe11290830,4,0
"@Parameter(property = ""fabric8.replicationController.name"", defaultValue = ""${project.artifactId}-controller"")",2e0227114d54e2ead452eaec7f7a74fe11290830,3,0
"@Parameter(property = ""fabric8.kubernetes.name"", defaultValue = ""${project.artifactId}"")",2e0227114d54e2ead452eaec7f7a74fe11290830,3,0
"@Parameter(property = ""fabric8.container.name"", defaultValue = ""${project.artifactId}-container"")",2e0227114d54e2ead452eaec7f7a74fe11290830,3,0
"@Parameter(property = ""fabric8.service.name"", defaultValue = ""${project.artifactId}-service"")",2e0227114d54e2ead452eaec7f7a74fe11290830,3,0
"@Parameter(property = ""fabric8.service.name"", defaultValue = ""${project.artifactId}"")",2e0227114d54e2ead452eaec7f7a74fe11290830,3,1
"@Parameter(property = ""fabric8.label.project"", defaultValue = ""${project.artifactId}"")",2e0227114d54e2ead452eaec7f7a74fe11290830,3,0
String name = getProjectName();,2e0227114d54e2ead452eaec7f7a74fe11290830,3,0
public String getProjectName() {,2e0227114d54e2ead452eaec7f7a74fe11290830,3,0
"@Parameter(property = ""fabric8.kubernetes.name"", defaultValue = ""${project.artifactId}"")",2e0227114d54e2ead452eaec7f7a74fe11290830,3,1
String name = getKubernetesName();,2e0227114d54e2ead452eaec7f7a74fe11290830,3,1
public String getKubernetesName() {,2e0227114d54e2ead452eaec7f7a74fe11290830,3,1
"@Parameter(property = ""fabric8.container.name"")",2e0227114d54e2ead452eaec7f7a74fe11290830,2,0
"@Parameter(property = ""fabric8.kubernetes.containerName"")",2e0227114d54e2ead452eaec7f7a74fe11290830,2,1
"@Parameter(property = ""fabric8.kubernetes.name"")",2e0227114d54e2ead452eaec7f7a74fe11290830,2,1
"@Parameter(property = ""fabric8.container.name"")",2e0227114d54e2ead452eaec7f7a74fe11290830,2,1
// lets add a project label,2e0227114d54e2ead452eaec7f7a74fe11290830,2,0
public void setProjectName(String projectName) {,2e0227114d54e2ead452eaec7f7a74fe11290830,2,0
public void setKubernetesName(String kubernetesName) {,2e0227114d54e2ead452eaec7f7a74fe11290830,2,1
if (shouldGenerateForThisProject() && !isIgnoreProject() && generateJson) {,2e0227114d54e2ead452eaec7f7a74fe11290830,1,0
if (!isPom(getProject()) && !isIgnoreProject() && generateJson) {,2e0227114d54e2ead452eaec7f7a74fe11290830,1,1
private String replicationControllerName;,2e0227114d54e2ead452eaec7f7a74fe11290830,1,0
private String kubernetesName;,2e0227114d54e2ead452eaec7f7a74fe11290830,1,0
private String kubernetesContainerName;,2e0227114d54e2ead452eaec7f7a74fe11290830,1,0
private String kubernetesName;,2e0227114d54e2ead452eaec7f7a74fe11290830,1,1
private String kubernetesContainerName;,2e0227114d54e2ead452eaec7f7a74fe11290830,1,1
if (Strings.isNullOrBlank(kubernetesName)) {,2e0227114d54e2ead452eaec7f7a74fe11290830,1,1
"kubernetesName = Strings.convertToCamelCase(getKubernetesContainerName(), ""-"");",2e0227114d54e2ead452eaec7f7a74fe11290830,1,1
},2e0227114d54e2ead452eaec7f7a74fe11290830,1,1
private String projectName;,2e0227114d54e2ead452eaec7f7a74fe11290830,1,0
"if (!labelMap.containsKey(""version"")) {",2e0227114d54e2ead452eaec7f7a74fe11290830,1,0
},2e0227114d54e2ead452eaec7f7a74fe11290830,1,0
"if (!labelMap.containsKey(""project"") && Strings.isNotBlank(name)) {",2e0227114d54e2ead452eaec7f7a74fe11290830,1,0
this.projectName = projectName;,2e0227114d54e2ead452eaec7f7a74fe11290830,1,0
private String kubernetesName;,2e0227114d54e2ead452eaec7f7a74fe11290830,1,1
if (labelMap.isEmpty() && Strings.isNotBlank(name)) {,2e0227114d54e2ead452eaec7f7a74fe11290830,1,1
// lets add a default label,2e0227114d54e2ead452eaec7f7a74fe11290830,1,1
this.kubernetesName = kubernetesName;,2e0227114d54e2ead452eaec7f7a74fe11290830,1,1
/**,2e0227114d54e2ead452eaec7f7a74fe11290830,0,0
*/,2e0227114d54e2ead452eaec7f7a74fe11290830,0,0
// replication controllers,2e0227114d54e2ead452eaec7f7a74fe11290830,0,0
config.setReplicaCount(replicaCount);,2e0227114d54e2ead452eaec7f7a74fe11290830,0,0
"config.setReplicationControllerName(KubernetesHelper.validateKubernetesId(replicationControllerName, ""fabric8.replicationController.name""));",2e0227114d54e2ead452eaec7f7a74fe11290830,0,0
// services,2e0227114d54e2ead452eaec7f7a74fe11290830,0,0
"config.setServiceName(KubernetesHelper.validateKubernetesId(serviceName, ""fabric8.service.name""));",2e0227114d54e2ead452eaec7f7a74fe11290830,0,0
config.setServicePort(servicePort);,2e0227114d54e2ead452eaec7f7a74fe11290830,0,0
config.setServiceContainerPort(serviceContainerPort);,2e0227114d54e2ead452eaec7f7a74fe11290830,0,0
import io.fabric8.utils.Function;,2e0227114d54e2ead452eaec7f7a74fe11290830,0,1
/**,2e0227114d54e2ead452eaec7f7a74fe11290830,0,1
*/,2e0227114d54e2ead452eaec7f7a74fe11290830,0,1
config.setReplicaCount(replicaCount);,2e0227114d54e2ead452eaec7f7a74fe11290830,0,1
config.setServiceName(serviceName);,2e0227114d54e2ead452eaec7f7a74fe11290830,0,1
config.setServicePort(servicePort);,2e0227114d54e2ead452eaec7f7a74fe11290830,0,1
config.setServiceContainerPort(serviceContainerPort);,2e0227114d54e2ead452eaec7f7a74fe11290830,0,1
"setName(template, getProjectName());",2e0227114d54e2ead452eaec7f7a74fe11290830,0,0
"labelMap.put(""version"", project.getVersion());",2e0227114d54e2ead452eaec7f7a74fe11290830,0,0
"labelMap.put(""project"", name);",2e0227114d54e2ead452eaec7f7a74fe11290830,0,0
return projectName;,2e0227114d54e2ead452eaec7f7a74fe11290830,0,0
"setName(template, getKubernetesName());",2e0227114d54e2ead452eaec7f7a74fe11290830,0,1
"labelMap.put(""component"", name);",2e0227114d54e2ead452eaec7f7a74fe11290830,0,1
return kubernetesName;,2e0227114d54e2ead452eaec7f7a74fe11290830,0,1
if (replicationController != null) {,6fc0cd56989d7c65c5625ed19fc79b6b5be251e6,2,0
ReplicationControllerSchema replicationController = client.getReplicationControllerForPod(podID);,6fc0cd56989d7c65c5625ed19fc79b6b5be251e6,2,1
ReplicationController replicationController = client.getReplicationControllerForPod(podID);,6fc0cd56989d7c65c5625ed19fc79b6b5be251e6,1,0
String id = getId(replicationController);,6fc0cd56989d7c65c5625ed19fc79b6b5be251e6,1,0
if (replicationController != null ){,6fc0cd56989d7c65c5625ed19fc79b6b5be251e6,1,1
String id = replicationController.getId();,6fc0cd56989d7c65c5625ed19fc79b6b5be251e6,1,1
import io.fabric8.kubernetes.api.model.ReplicationController;,6fc0cd56989d7c65c5625ed19fc79b6b5be251e6,0,0
import static io.fabric8.kubernetes.api.KubernetesHelper.getId;,6fc0cd56989d7c65c5625ed19fc79b6b5be251e6,0,0
import io.fabric8.kubernetes.api.model.ReplicationControllerSchema;,6fc0cd56989d7c65c5625ed19fc79b6b5be251e6,0,1
"String service = ""http://localhost:"" + spec.getPort() + ""/"" + getId(service1);",fa232bb69f1d254c53df9bf83a765dd93caf64c2,6,0
"String service = ""http://localhost:"" + schema.getPort() + ""/"" + schema.getId();",fa232bb69f1d254c53df9bf83a765dd93caf64c2,6,1
String contextPath = getId(service1);,fa232bb69f1d254c53df9bf83a765dd93caf64c2,2,0
for (ServiceSchema schema : serviceListSchema.getItems()) {,fa232bb69f1d254c53df9bf83a765dd93caf64c2,2,1
String contextPath = schema.getId();,fa232bb69f1d254c53df9bf83a765dd93caf64c2,2,1
import static io.fabric8.kubernetes.api.KubernetesHelper.getId;,fa232bb69f1d254c53df9bf83a765dd93caf64c2,1,0
import io.fabric8.kubernetes.api.model.ServiceList;,fa232bb69f1d254c53df9bf83a765dd93caf64c2,1,0
import io.fabric8.kubernetes.api.model.Service;,fa232bb69f1d254c53df9bf83a765dd93caf64c2,1,0
import io.fabric8.kubernetes.api.model.ServiceSpec;,fa232bb69f1d254c53df9bf83a765dd93caf64c2,1,0
* @param selector,fa232bb69f1d254c53df9bf83a765dd93caf64c2,1,0
ServiceList serviceList = client.getServices();,fa232bb69f1d254c53df9bf83a765dd93caf64c2,1,0
for (Service service1 : serviceList.getItems()) {,fa232bb69f1d254c53df9bf83a765dd93caf64c2,1,0
ServiceSpec spec = service1.getSpec();,fa232bb69f1d254c53df9bf83a765dd93caf64c2,1,0
if (spec != null && selectorMatch(spec.getSelector())) {,fa232bb69f1d254c53df9bf83a765dd93caf64c2,1,0
import io.fabric8.kubernetes.api.model.ServiceListSchema;,fa232bb69f1d254c53df9bf83a765dd93caf64c2,1,1
import io.fabric8.kubernetes.api.model.ServiceSchema;,fa232bb69f1d254c53df9bf83a765dd93caf64c2,1,1
ServiceListSchema serviceListSchema = client.getServices();,fa232bb69f1d254c53df9bf83a765dd93caf64c2,1,1
if (selectorMatch(schema.getSelector())) {,fa232bb69f1d254c53df9bf83a765dd93caf64c2,1,1
dto.setId(getId(service1));,fa232bb69f1d254c53df9bf83a765dd93caf64c2,0,0
"dto.setContainer(spec.getSelector().get(""container""));",fa232bb69f1d254c53df9bf83a765dd93caf64c2,0,0
"dto.setVersion(spec.getSelector().get(""version""));",fa232bb69f1d254c53df9bf83a765dd93caf64c2,0,0
* @param serviceSelector,fa232bb69f1d254c53df9bf83a765dd93caf64c2,0,1
dto.setId(schema.getId());,fa232bb69f1d254c53df9bf83a765dd93caf64c2,0,1
"dto.setContainer(schema.getSelector().get(""container""));",fa232bb69f1d254c53df9bf83a765dd93caf64c2,0,1
"dto.setVersion(schema.getSelector().get(""version""));",fa232bb69f1d254c53df9bf83a765dd93caf64c2,0,1
"Map<String, String> envs = getEnvironmentVariableProperties();",1302566811aeffbc515b9aa5b75906b41e2fe147,4,1
"Map<String, String> envs = getExportedEnvironmentVariables();",1302566811aeffbc515b9aa5b75906b41e2fe147,4,0
"Map<String, String> envs = getEnvironmentVariableProperties();",1302566811aeffbc515b9aa5b75906b41e2fe147,4,1
"Map<String, String> answer = new TreeMap<>();",1302566811aeffbc515b9aa5b75906b41e2fe147,3,0
String name = entry.getKey();,1302566811aeffbc515b9aa5b75906b41e2fe147,3,0
"Map<String, String> map = toMap(properties);",1302566811aeffbc515b9aa5b75906b41e2fe147,3,0
* Whether the plugin should discover all the environment variable json schema files in the classpath and export those into the generated kubernetes JSON,1302566811aeffbc515b9aa5b75906b41e2fe147,2,0
"@Parameter(property = ""fabric8.includeAllEnvironmentVariables"", defaultValue = ""true"")",1302566811aeffbc515b9aa5b75906b41e2fe147,2,0
"public Map<String, String> getExportedEnvironmentVariables() throws MojoExecutionException {",1302566811aeffbc515b9aa5b75906b41e2fe147,2,0
"Map<String, JsonSchemaProperty> properties = schema.getProperties();",1302566811aeffbc515b9aa5b75906b41e2fe147,2,0
"Set<Map.Entry<String, JsonSchemaProperty>> entries = properties.entrySet();",1302566811aeffbc515b9aa5b75906b41e2fe147,2,0
String value = entry.getValue().getDefaultValue();,1302566811aeffbc515b9aa5b75906b41e2fe147,2,0
"throw new MojoExecutionException(""Failed to load environment variable json schema files: "" + e, e);",1302566811aeffbc515b9aa5b75906b41e2fe147,2,0
"@Parameter(property = ""fabric8.envFile"", defaultValue = ""${basedir}/src/main/fabric8/env.properties"")",1302566811aeffbc515b9aa5b75906b41e2fe147,2,0
"public Map<String, String> getEnvironmentVariableProperties() throws MojoExecutionException {",1302566811aeffbc515b9aa5b75906b41e2fe147,2,0
Properties properties = new Properties();,1302566811aeffbc515b9aa5b75906b41e2fe147,2,0
"public Map<String, String> getEnvironmentVariableProperties() {",1302566811aeffbc515b9aa5b75906b41e2fe147,2,1
"@Parameter(defaultValue = ""${project}"", readonly = true)",1302566811aeffbc515b9aa5b75906b41e2fe147,2,0
JsonSchema schema = getEnvironmentVariableJsonSchema();,1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
import java.util.StringTokenizer;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,1
"JsonSchema schema = JsonSchemas.loadEnvironmentSchemas(getCompileClassLoader(), getProject().getBuild().getOutputDirectory());",1302566811aeffbc515b9aa5b75906b41e2fe147,1,1
"getLog().warn(""No environment schemas found for file: "" + JsonSchemas.ENVIRONMENT_SCHEMA_FILE);",1302566811aeffbc515b9aa5b75906b41e2fe147,1,1
} else {,1302566811aeffbc515b9aa5b75906b41e2fe147,1,1
"JsonSchemas.addEnvironmentVariables(schema, envs);",1302566811aeffbc515b9aa5b75906b41e2fe147,1,1
},1302566811aeffbc515b9aa5b75906b41e2fe147,1,1
import io.fabric8.maven.support.JsonSchema;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
import io.fabric8.maven.support.JsonSchemaProperty;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
import java.util.TreeMap;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
private boolean includeAllEnvironmentVariables;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
JsonSchema schema = getEnvironmentVariableJsonSchema();,1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
"for (Map.Entry<String, JsonSchemaProperty> entry : entries) {",1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
"value = """";",1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
},1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
} catch (IOException e) {,1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
} else {,1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
import java.io.FileInputStream;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
import java.util.Properties;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
import static io.fabric8.utils.PropertiesHelper.toMap;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
* The properties file used to specify environment variables which allows ${FOO_BAR} expressions to be used,1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
} catch (IOException e) {,1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
"throw new MojoExecutionException(""Failed to load environment properties file: "" + envPropertiesFile + "". "" + e, e);",1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
},1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
import io.fabric8.kubernetes.api.KubernetesHelper;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
import io.fabric8.kubernetes.api.model.HasMetadata;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
import io.fabric8.maven.support.JsonSchema;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
import io.fabric8.maven.support.JsonSchemas;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
import io.fabric8.openshift.api.model.template.Template;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
import io.fabric8.utils.Files;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
import io.fabric8.utils.Strings;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
import org.apache.maven.plugin.MojoExecutionException;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
import org.apache.maven.plugins.annotations.Parameter;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
import org.apache.maven.project.MavenProject;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,0
import io.fabric8.kubernetes.api.KubernetesHelper;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,1
import io.fabric8.kubernetes.api.model.HasMetadata;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,1
import io.fabric8.maven.support.JsonSchema;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,1
import io.fabric8.maven.support.JsonSchemas;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,1
import io.fabric8.openshift.api.model.template.Template;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,1
import io.fabric8.utils.Files;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,1
import io.fabric8.utils.Strings;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,1
import org.apache.maven.plugin.AbstractMojo;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,1
import org.apache.maven.plugin.MojoExecutionException;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,1
import org.apache.maven.plugins.annotations.Component;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,1
import org.apache.maven.plugins.annotations.Parameter;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,1
import org.apache.maven.project.MavenProject;,1302566811aeffbc515b9aa5b75906b41e2fe147,1,1
displaySchema(schema);,1302566811aeffbc515b9aa5b75906b41e2fe147,0,0
if (schema == null) {,1302566811aeffbc515b9aa5b75906b41e2fe147,0,1
displaySchema(schema);,1302566811aeffbc515b9aa5b75906b41e2fe147,0,1
/**,1302566811aeffbc515b9aa5b75906b41e2fe147,0,0
*/,1302566811aeffbc515b9aa5b75906b41e2fe147,0,0
public List<EnvVar> getEnvironmentVariables() throws MojoExecutionException {,1302566811aeffbc515b9aa5b75906b41e2fe147,0,0
if (includeAllEnvironmentVariables) {,1302566811aeffbc515b9aa5b75906b41e2fe147,0,0
try {,1302566811aeffbc515b9aa5b75906b41e2fe147,0,0
if (value == null) {,1302566811aeffbc515b9aa5b75906b41e2fe147,0,0
"answer.put(name, value);",1302566811aeffbc515b9aa5b75906b41e2fe147,0,0
return answer;,1302566811aeffbc515b9aa5b75906b41e2fe147,0,0
return getEnvironmentVariableProperties();,1302566811aeffbc515b9aa5b75906b41e2fe147,0,0
public List<EnvVar> getEnvironmentVariables() {,1302566811aeffbc515b9aa5b75906b41e2fe147,0,1
/**,1302566811aeffbc515b9aa5b75906b41e2fe147,0,0
* without any Maven property expansion,1302566811aeffbc515b9aa5b75906b41e2fe147,0,0
*/,1302566811aeffbc515b9aa5b75906b41e2fe147,0,0
protected File envPropertiesFile;,1302566811aeffbc515b9aa5b75906b41e2fe147,0,0
if (envPropertiesFile != null && envPropertiesFile.isFile() && envPropertiesFile.exists()) {,1302566811aeffbc515b9aa5b75906b41e2fe147,0,0
// lets override with these values,1302566811aeffbc515b9aa5b75906b41e2fe147,0,0
try {,1302566811aeffbc515b9aa5b75906b41e2fe147,0,0
properties.load(new FileInputStream(envPropertiesFile));,1302566811aeffbc515b9aa5b75906b41e2fe147,0,0
answer.putAll(map);,1302566811aeffbc515b9aa5b75906b41e2fe147,0,0
@Component,1302566811aeffbc515b9aa5b75906b41e2fe147,0,1
"getLog().info(""No environment schemas found for file: "" + JsonSchemas.ENVIRONMENT_SCHEMA_FILE);",f7c578c1f6e4e317384fa39eec541a8a6bdd3641,3,1
"@Parameter(defaultValue = ""${project}"", readonly = true)",f7c578c1f6e4e317384fa39eec541a8a6bdd3641,2,0
} catch (Exception e) {,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,2,0
"getLog().debug(""No environment schemas found for file: "" + JsonSchemas.ENVIRONMENT_SCHEMA_FILE);",f7c578c1f6e4e317384fa39eec541a8a6bdd3641,2,0
try {,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,1,0
},f7c578c1f6e4e317384fa39eec541a8a6bdd3641,1,0
"warnIfInCDBuild(""Cannot create default value for $"" + envVarName + "" as no .git/config file could be found"");",f7c578c1f6e4e317384fa39eec541a8a6bdd3641,1,0
"getLog().warn(""Cannot create default value for $"" + envVarName + "" as no .git/config file could be found"");",f7c578c1f6e4e317384fa39eec541a8a6bdd3641,1,1
import io.fabric8.kubernetes.api.KubernetesHelper;,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,0
import io.fabric8.kubernetes.api.model.HasMetadata;,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,0
import io.fabric8.maven.support.JsonSchema;,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,0
import io.fabric8.maven.support.JsonSchemas;,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,0
import io.fabric8.openshift.api.model.template.Template;,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,0
import io.fabric8.utils.Files;,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,0
import io.fabric8.utils.Strings;,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,0
import org.apache.maven.plugin.MojoExecutionException;,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,0
import org.apache.maven.plugins.annotations.Parameter;,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,0
import org.apache.maven.project.MavenProject;,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,0
import io.fabric8.kubernetes.api.KubernetesHelper;,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,1
import io.fabric8.kubernetes.api.model.HasMetadata;,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,1
import io.fabric8.maven.support.JsonSchema;,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,1
import io.fabric8.maven.support.JsonSchemas;,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,1
import io.fabric8.openshift.api.model.template.Template;,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,1
import io.fabric8.utils.Files;,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,1
import io.fabric8.utils.Strings;,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,1
import org.apache.maven.plugin.AbstractMojo;,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,1
import org.apache.maven.plugin.MojoExecutionException;,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,1
import org.apache.maven.plugins.annotations.Component;,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,1
import org.apache.maven.plugins.annotations.Parameter;,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,1
import org.apache.maven.project.MavenProject;,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,1
@Component,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,1
"getLog().info(""Looking at repo with directory "" + repository.getDirectory());",f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,0
repository.close();,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,0
// ignore,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,0
"warnIfInCDBuild(""Could not find .git folder based on the current basedir of "" + basedir);",f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,0
"warnIfInCDBuild(""Failed to initialise Git Repository: "" + e, e);",f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,0
"System.out.println(""Looking at repo with directory "" + repository.getDirectory());",f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,1
repository.close();,f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,1
"getLog().warn(""Could not find .git folder based on the current basedir of "" + basedir);",f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,1
"getLog().warn(""Failed to initialise Git Repository: "" + e, e);",f7c578c1f6e4e317384fa39eec541a8a6bdd3641,0,1
"@WithAttributes(label = ""Filter"", required = false, description = ""To filter components"")",d752295c0b614743c2e7a06546870ce124e9fe91,7,1
CamelComponentCatalog catalog = new DefaultCamelComponentCatalog();,d752295c0b614743c2e7a06546870ce124e9fe91,5,0
CamelComponentCatalog catalog = new DefaultCamelComponentCatalog();,d752295c0b614743c2e7a06546870ce124e9fe91,5,1
*  with the License.  You may obtain a copy of the License at,d752295c0b614743c2e7a06546870ce124e9fe91,4,1
*  implied.  See the License for the specific language governing,d752295c0b614743c2e7a06546870ce124e9fe91,4,1
"@WithAttributes(label = ""Name"", required = true, description = ""Name of component type to add"")",d752295c0b614743c2e7a06546870ce124e9fe91,4,1
*  with the License.  You may obtain a copy of the License at,d752295c0b614743c2e7a06546870ce124e9fe91,4,1
*  implied.  See the License for the specific language governing,d752295c0b614743c2e7a06546870ce124e9fe91,4,1
final Project project = getSelectedProject(builder);,d752295c0b614743c2e7a06546870ce124e9fe91,3,0
String label = filter.getValue();,d752295c0b614743c2e7a06546870ce124e9fe91,3,0
Project project = getSelectedProject(builder);,d752295c0b614743c2e7a06546870ce124e9fe91,3,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",d752295c0b614743c2e7a06546870ce124e9fe91,3,1
final Project project = getSelectedProject(builder);,d752295c0b614743c2e7a06546870ce124e9fe91,3,1
Project project = getSelectedProject(context);,d752295c0b614743c2e7a06546870ce124e9fe91,3,1
Dependency core = findCamelCoreDependency(project);,d752295c0b614743c2e7a06546870ce124e9fe91,3,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",d752295c0b614743c2e7a06546870ce124e9fe91,3,1
// need to find camel-core so we known the camel version,d752295c0b614743c2e7a06546870ce124e9fe91,3,1
List<String> filtered = new ArrayList<String>();,d752295c0b614743c2e7a06546870ce124e9fe91,3,1
// use callbable so we can live update the filter,d752295c0b614743c2e7a06546870ce124e9fe91,2,0
private UIInput<String> filter;,d752295c0b614743c2e7a06546870ce124e9fe91,2,1
// find all available component labels,d752295c0b614743c2e7a06546870ce124e9fe91,2,0
"*  Red Hat licenses this file to you under the Apache License, version",d752295c0b614743c2e7a06546870ce124e9fe91,2,1
*  permissions and limitations under the License.,d752295c0b614743c2e7a06546870ce124e9fe91,2,1
".description(""Adds a Camel component to your project dependencies"");",d752295c0b614743c2e7a06546870ce124e9fe91,2,1
String description = component.getDescription();,d752295c0b614743c2e7a06546870ce124e9fe91,2,1
} else {,d752295c0b614743c2e7a06546870ce124e9fe91,2,1
// does the project already have camel?,d752295c0b614743c2e7a06546870ce124e9fe91,2,1
// otherwise use the version from the dto,d752295c0b614743c2e7a06546870ce124e9fe91,2,1
"return Results.success(""Added Camel component "" + dto.getScheme() + "" ("" + dto.getArtifactId() + "") to the project"");",d752295c0b614743c2e7a06546870ce124e9fe91,2,1
"*  Red Hat licenses this file to you under the Apache License, version",d752295c0b614743c2e7a06546870ce124e9fe91,2,1
*  permissions and limitations under the License.,d752295c0b614743c2e7a06546870ce124e9fe91,2,1
private final Project project;,d752295c0b614743c2e7a06546870ce124e9fe91,2,1
this.project = project;,d752295c0b614743c2e7a06546870ce124e9fe91,2,1
"public Iterable<String> getCompletionProposals(UIContext context, InputComponent input, String value) {",d752295c0b614743c2e7a06546870ce124e9fe91,2,1
// find all available component labels,d752295c0b614743c2e7a06546870ce124e9fe91,2,1
import java.util.concurrent.Callable;,d752295c0b614743c2e7a06546870ce124e9fe91,1,0
import org.jboss.forge.addon.ui.input.UISelectOne;,d752295c0b614743c2e7a06546870ce124e9fe91,1,0
private UISelectOne<String> filter;,d752295c0b614743c2e7a06546870ce124e9fe91,1,0
name.setValueChoices(new Callable<Iterable<String>>() {,d752295c0b614743c2e7a06546870ce124e9fe91,1,0
public Iterable<String> call() throws Exception {,d752295c0b614743c2e7a06546870ce124e9fe91,1,0
"return new CamelComponentsCompleter(project, null).getValueChoices(label);",d752295c0b614743c2e7a06546870ce124e9fe91,1,0
},d752295c0b614743c2e7a06546870ce124e9fe91,1,0
import org.jboss.forge.addon.ui.input.UIInput;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
private UIInput<String> name;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
"name.setCompleter(new CamelComponentsCompleter(project, filter));",d752295c0b614743c2e7a06546870ce124e9fe91,1,1
Iterable<String> names = getValueChoices();,d752295c0b614743c2e7a06546870ce124e9fe91,1,0
public Iterable<String> getValueChoices() {,d752295c0b614743c2e7a06546870ce124e9fe91,1,0
Set<String> names = catalog.findComponentLabels();,d752295c0b614743c2e7a06546870ce124e9fe91,1,0
},d752295c0b614743c2e7a06546870ce124e9fe91,1,0
Set<String> names = catalog.findComponentLabels();,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
"*  Copyright 2005-2015 Red Hat, Inc.",d752295c0b614743c2e7a06546870ce124e9fe91,1,1
*,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",d752295c0b614743c2e7a06546870ce124e9fe91,1,1
*     http://www.apache.org/licenses/LICENSE-2.0,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
"*  Unless required by applicable law or agreed to in writing, software",d752295c0b614743c2e7a06546870ce124e9fe91,1,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import javax.inject.Inject;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import org.jboss.forge.addon.convert.Converter;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import org.jboss.forge.addon.dependencies.Dependency;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import org.jboss.forge.addon.projects.Project;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import org.jboss.forge.addon.ui.context.UIContext;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import org.jboss.forge.addon.ui.input.UISelectOne;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import org.jboss.forge.addon.ui.result.Result;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import org.jboss.forge.addon.ui.result.Results;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import org.jboss.forge.addon.ui.util.Categories;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import org.jboss.forge.addon.ui.util.Metadata;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createComponentDto;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
public class CamelAddComponentCommand extends AbstractCamelProjectCommand {,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
@Inject,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
private UISelectOne<String> filter;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
public UICommandMetadata getMetadata(UIContext context) {,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
},d752295c0b614743c2e7a06546870ce124e9fe91,1,1
public void initializeUI(UIBuilder builder) throws Exception {,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
"name.setValueConverter(new Converter<String, ComponentDto>() {",d752295c0b614743c2e7a06546870ce124e9fe91,1,1
public ComponentDto convert(String text) {,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
// show note about the chosen component,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
name.addValueChangeListener(new ValueChangeListener() {,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
public void valueChanged(ValueChangeEvent event) {,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
ComponentDto component = (ComponentDto) event.getNewValue();,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
if (component != null) {,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
public Result execute(UIExecutionContext context) throws Exception {,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
if (core == null) {,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
"return Results.fail(""The project does not include camel-core"");",d752295c0b614743c2e7a06546870ce124e9fe91,1,1
ComponentDto dto = name.getValue();,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
if (dto != null) {,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
// we want to use same version as camel-core if its a camel component,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
String version;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
"if (""org.apache.camel"".equals(dto.getGroupId())) {",d752295c0b614743c2e7a06546870ce124e9fe91,1,1
version = core.getCoordinate().getVersion();,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
version = dto.getVersion();,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
DependencyBuilder component = DependencyBuilder.create().setGroupId(dto.getGroupId()),d752295c0b614743c2e7a06546870ce124e9fe91,1,1
// install the component,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
"return Results.fail(""Unknown Camel component"");",d752295c0b614743c2e7a06546870ce124e9fe91,1,1
"*  Copyright 2005-2015 Red Hat, Inc.",d752295c0b614743c2e7a06546870ce124e9fe91,1,1
*,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",d752295c0b614743c2e7a06546870ce124e9fe91,1,1
*     http://www.apache.org/licenses/LICENSE-2.0,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
"*  Unless required by applicable law or agreed to in writing, software",d752295c0b614743c2e7a06546870ce124e9fe91,1,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import java.util.ArrayList;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import java.util.List;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import java.util.Set;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import io.fabric8.forge.addon.utils.CamelProjectHelper;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import org.apache.camel.catalog.CamelCatalog;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import org.jboss.forge.addon.dependencies.Dependency;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import org.jboss.forge.addon.projects.Project;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import org.jboss.forge.addon.ui.context.UIContext;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
import org.jboss.forge.addon.ui.input.UICompleter;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
public class CamelComponentsLabelCompleter implements UICompleter<String> {,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
private final Dependency core;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
"public CamelComponentsLabelCompleter(Project project, CamelCatalog camelCatalog) {",d752295c0b614743c2e7a06546870ce124e9fe91,1,1
this.camelCatalog = camelCatalog;,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
this.core = CamelProjectHelper.findCamelCoreDependency(project);,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
},d752295c0b614743c2e7a06546870ce124e9fe91,1,1
if (core == null) {,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
Iterable<String> names = getValueChoices();,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
for (String name : names) {,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
if (value == null || name.startsWith(value)) {,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
public Iterable<String> getValueChoices() {,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
Set<String> names = camelCatalog.findComponentLabels();,d752295c0b614743c2e7a06546870ce124e9fe91,1,1
private UISelectOne<String> name;,d752295c0b614743c2e7a06546870ce124e9fe91,0,0
filter.setValueChoices(new CamelComponentsLabelCompleter(project).getValueChoices());,d752295c0b614743c2e7a06546870ce124e9fe91,0,0
"filter.setDefaultValue(""<all>"");",d752295c0b614743c2e7a06546870ce124e9fe91,0,0
@Override,d752295c0b614743c2e7a06546870ce124e9fe91,0,0
});,d752295c0b614743c2e7a06546870ce124e9fe91,0,0
filter.setCompleter(new CamelComponentsLabelCompleter(project));,d752295c0b614743c2e7a06546870ce124e9fe91,0,1
"names.add(""<all>"");",d752295c0b614743c2e7a06546870ce124e9fe91,0,0
return names;,d752295c0b614743c2e7a06546870ce124e9fe91,0,0
/**,d752295c0b614743c2e7a06546870ce124e9fe91,0,1
*/,d752295c0b614743c2e7a06546870ce124e9fe91,0,1
package io.fabric8.forge.camel.commands.project;,d752295c0b614743c2e7a06546870ce124e9fe91,0,1
private UISelectOne<ComponentDto> name;,d752295c0b614743c2e7a06546870ce124e9fe91,0,1
private DependencyInstaller dependencyInstaller;,d752295c0b614743c2e7a06546870ce124e9fe91,0,1
@Override,d752295c0b614743c2e7a06546870ce124e9fe91,0,1
return Metadata.forCommand(CamelAddComponentCommand.class).name(,d752295c0b614743c2e7a06546870ce124e9fe91,0,1
"""Camel: Add Component"").category(Categories.create(CATEGORY))",d752295c0b614743c2e7a06546870ce124e9fe91,0,1
"filter.setValueChoices(CamelCommandsHelper.createComponentLabelValues(project, getCamelCatalog()));",d752295c0b614743c2e7a06546870ce124e9fe91,0,1
"filter.setDefaultValue(""<all>"");",d752295c0b614743c2e7a06546870ce124e9fe91,0,1
"name.setValueChoices(CamelCommandsHelper.createComponentDtoValues(project, getCamelCatalog(), filter, false));",d752295c0b614743c2e7a06546870ce124e9fe91,0,1
// include converter from string->dto,d752295c0b614743c2e7a06546870ce124e9fe91,0,1
"return createComponentDto(getCamelCatalog(), text);",d752295c0b614743c2e7a06546870ce124e9fe91,0,1
});,d752295c0b614743c2e7a06546870ce124e9fe91,0,1
"name.setNote(description != null ? description : """");",d752295c0b614743c2e7a06546870ce124e9fe91,0,1
"name.setNote("""");",d752295c0b614743c2e7a06546870ce124e9fe91,0,1
builder.add(filter).add(name);,d752295c0b614743c2e7a06546870ce124e9fe91,0,1
.setArtifactId(dto.getArtifactId()).setVersion(version);,d752295c0b614743c2e7a06546870ce124e9fe91,0,1
"dependencyInstaller.install(project, component);",d752295c0b614743c2e7a06546870ce124e9fe91,0,1
/**,d752295c0b614743c2e7a06546870ce124e9fe91,0,1
*/,d752295c0b614743c2e7a06546870ce124e9fe91,0,1
package io.fabric8.forge.camel.commands.project.completer;,d752295c0b614743c2e7a06546870ce124e9fe91,0,1
private final CamelCatalog camelCatalog;,d752295c0b614743c2e7a06546870ce124e9fe91,0,1
@Override,d752295c0b614743c2e7a06546870ce124e9fe91,0,1
return null;,d752295c0b614743c2e7a06546870ce124e9fe91,0,1
filtered.add(name);,d752295c0b614743c2e7a06546870ce124e9fe91,0,1
return filtered;,d752295c0b614743c2e7a06546870ce124e9fe91,0,1
"names.add(""<all>"");",d752295c0b614743c2e7a06546870ce124e9fe91,0,1
return names;,d752295c0b614743c2e7a06546870ce124e9fe91,0,1
// need to parse to be able to extends another class,3f59103dea335f65dbce7316ae95192f5567a9e7,6,1
"@WithAttributes(label = ""Target Package"", required = false, description = ""The package name where this type will be created"")",3f59103dea335f65dbce7316ae95192f5567a9e7,5,1
"*  Red Hat licenses this file to you under the Apache License, version",3f59103dea335f65dbce7316ae95192f5567a9e7,4,1
*  with the License.  You may obtain a copy of the License at,3f59103dea335f65dbce7316ae95192f5567a9e7,4,1
*  implied.  See the License for the specific language governing,3f59103dea335f65dbce7316ae95192f5567a9e7,4,1
// do we already have a class with the name,3f59103dea335f65dbce7316ae95192f5567a9e7,4,1
"*  Red Hat licenses this file to you under the Apache License, version",3f59103dea335f65dbce7316ae95192f5567a9e7,4,1
*  with the License.  You may obtain a copy of the License at,3f59103dea335f65dbce7316ae95192f5567a9e7,4,1
*  implied.  See the License for the specific language governing,3f59103dea335f65dbce7316ae95192f5567a9e7,4,1
"*  Red Hat licenses this file to you under the Apache License, version",3f59103dea335f65dbce7316ae95192f5567a9e7,4,1
*  with the License.  You may obtain a copy of the License at,3f59103dea335f65dbce7316ae95192f5567a9e7,4,1
*  implied.  See the License for the specific language governing,3f59103dea335f65dbce7316ae95192f5567a9e7,4,1
"*  2.0 (the ""License""); you may not use this file except in compliance",3f59103dea335f65dbce7316ae95192f5567a9e7,3,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",3f59103dea335f65dbce7316ae95192f5567a9e7,3,1
"@WithAttributes(label = ""Class Name"", required = true, description = ""Name of RouteBuilder class"")",3f59103dea335f65dbce7316ae95192f5567a9e7,3,1
Project project = getSelectedProject(builder.getUIContext());,3f59103dea335f65dbce7316ae95192f5567a9e7,3,1
Project project = getSelectedProject(context);,3f59103dea335f65dbce7316ae95192f5567a9e7,3,1
// does the project already have camel?,3f59103dea335f65dbce7316ae95192f5567a9e7,3,1
"*  2.0 (the ""License""); you may not use this file except in compliance",3f59103dea335f65dbce7316ae95192f5567a9e7,3,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",3f59103dea335f65dbce7316ae95192f5567a9e7,3,1
* A completer of java source package names,3f59103dea335f65dbce7316ae95192f5567a9e7,3,1
// find package names in the source code,3f59103dea335f65dbce7316ae95192f5567a9e7,3,1
"*  2.0 (the ""License""); you may not use this file except in compliance",3f59103dea335f65dbce7316ae95192f5567a9e7,3,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",3f59103dea335f65dbce7316ae95192f5567a9e7,3,1
* A completer of java test source package names,3f59103dea335f65dbce7316ae95192f5567a9e7,3,1
// find package names in the source code,3f59103dea335f65dbce7316ae95192f5567a9e7,3,1
"*  Unless required by applicable law or agreed to in writing, software",3f59103dea335f65dbce7316ae95192f5567a9e7,2,1
*  permissions and limitations under the License.,3f59103dea335f65dbce7316ae95192f5567a9e7,2,1
public class CamelNewRouteBuilderCommand extends AbstractCamelProjectCommand {,3f59103dea335f65dbce7316ae95192f5567a9e7,2,1
JavaSourceFacet facet = project.getFacet(JavaSourceFacet.class);,3f59103dea335f65dbce7316ae95192f5567a9e7,2,1
"return Results.fail(""The project does not include camel-core"");",3f59103dea335f65dbce7316ae95192f5567a9e7,2,1
"String fqn = targetPackage.getValue() != null ? targetPackage.getValue() + ""."" + name.getValue() : name.getValue();",3f59103dea335f65dbce7316ae95192f5567a9e7,2,1
"return Results.success(""Created new RouteBuilder class "" + name.getValue());",3f59103dea335f65dbce7316ae95192f5567a9e7,2,1
"*  Unless required by applicable law or agreed to in writing, software",3f59103dea335f65dbce7316ae95192f5567a9e7,2,1
*  permissions and limitations under the License.,3f59103dea335f65dbce7316ae95192f5567a9e7,2,1
public class PackageNameCompleter implements UICompleter<String> {,3f59103dea335f65dbce7316ae95192f5567a9e7,2,1
private final SortedSet<String> packageNames = new TreeSet<>();,3f59103dea335f65dbce7316ae95192f5567a9e7,2,1
String packageName = clazz.getPackage();,3f59103dea335f65dbce7316ae95192f5567a9e7,2,1
} catch (FileNotFoundException e) {,3f59103dea335f65dbce7316ae95192f5567a9e7,2,1
"public Iterable<String> getCompletionProposals(UIContext context, InputComponent input, String value) {",3f59103dea335f65dbce7316ae95192f5567a9e7,2,1
List<String> answer = new ArrayList<String>();,3f59103dea335f65dbce7316ae95192f5567a9e7,2,1
"*  Unless required by applicable law or agreed to in writing, software",3f59103dea335f65dbce7316ae95192f5567a9e7,2,1
*  permissions and limitations under the License.,3f59103dea335f65dbce7316ae95192f5567a9e7,2,1
public class TestPackageNameCompleter implements UICompleter<String> {,3f59103dea335f65dbce7316ae95192f5567a9e7,2,1
private final SortedSet<String> packageNames = new TreeSet<>();,3f59103dea335f65dbce7316ae95192f5567a9e7,2,1
String packageName = clazz.getPackage();,3f59103dea335f65dbce7316ae95192f5567a9e7,2,1
} catch (FileNotFoundException e) {,3f59103dea335f65dbce7316ae95192f5567a9e7,2,1
"public Iterable<String> getCompletionProposals(UIContext context, InputComponent input, String value) {",3f59103dea335f65dbce7316ae95192f5567a9e7,2,1
List<String> answer = new ArrayList<String>();,3f59103dea335f65dbce7316ae95192f5567a9e7,2,1
"*  Copyright 2005-2015 Red Hat, Inc.",3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
*,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
*     http://www.apache.org/licenses/LICENSE-2.0,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
package io.fabric8.forge.camel.commands.project;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import javax.inject.Inject;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import io.fabric8.forge.addon.utils.completer.PackageNameCompleter;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import io.fabric8.forge.addon.utils.validator.ClassNameValidator;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import io.fabric8.forge.addon.utils.validator.PackageNameValidator;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.dependencies.Dependency;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.facets.constraints.FacetConstraint;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.parser.java.facets.JavaSourceFacet;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.parser.java.resources.JavaResource;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.projects.Project;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.ui.context.UIContext;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.ui.facets.HintsFacet;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.ui.hints.InputType;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.ui.input.UIInput;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.ui.result.Result;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.ui.result.Results;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.ui.util.Categories;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.ui.util.Metadata;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.roaster.Roaster;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.roaster.model.source.JavaClassSource;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
public UICommandMetadata getMetadata(UIContext context) {,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
".description(""Creates a new Camel RouteBuilder class"");",3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
},3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
public void initializeUI(UIBuilder builder) throws Exception {,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
public Result execute(UIExecutionContext context) throws Exception {,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
Dependency core = findCamelCoreDependency(project);,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
if (core == null) {,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
JavaResource existing = facet.getJavaResource(fqn);,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
if (existing != null && existing.exists()) {,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
"return Results.fail(""A class with name "" + fqn + "" already exists"");",3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
final JavaClassSource javaClass = Roaster.create(JavaClassSource.class);,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
if (targetPackage.getValue() != null) {,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
"*  Copyright 2005-2015 Red Hat, Inc.",3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
*,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
*     http://www.apache.org/licenses/LICENSE-2.0,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
package io.fabric8.forge.addon.utils.completer;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import java.io.FileNotFoundException;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import java.util.ArrayList;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import java.util.List;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import java.util.SortedSet;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import java.util.TreeSet;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.parser.java.facets.JavaSourceFacet;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.parser.java.resources.JavaResource;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.parser.java.resources.JavaResourceVisitor;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.resource.visit.VisitContext;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.ui.context.UIContext;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.ui.input.UICompleter;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.roaster.model.JavaClass;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
public PackageNameCompleter(JavaSourceFacet facet) {,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
facet.visitJavaSources(new JavaResourceVisitor() {,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
"public void visit(VisitContext context, JavaResource javaResource) {",3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
try {,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
JavaClass clazz = javaResource.getJavaType();,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
if (packageName != null) {,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
},3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
// ignore,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
for (String name : packageNames) {,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
if (value == null || name.startsWith(value)) {,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
"*  Copyright 2005-2015 Red Hat, Inc.",3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
*,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
*     http://www.apache.org/licenses/LICENSE-2.0,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
package io.fabric8.forge.addon.utils.completer;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import java.io.FileNotFoundException;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import java.util.ArrayList;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import java.util.List;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import java.util.SortedSet;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import java.util.TreeSet;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.parser.java.facets.JavaSourceFacet;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.parser.java.resources.JavaResource;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.parser.java.resources.JavaResourceVisitor;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.resource.visit.VisitContext;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.ui.context.UIContext;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.addon.ui.input.UICompleter;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
import org.jboss.forge.roaster.model.JavaClass;,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
public TestPackageNameCompleter(JavaSourceFacet facet) {,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
facet.visitJavaTestSources(new JavaResourceVisitor() {,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
"public void visit(VisitContext context, JavaResource javaResource) {",3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
try {,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
JavaClass clazz = javaResource.getJavaType();,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
if (packageName != null) {,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
},3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
// ignore,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
for (String name : packageNames) {,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
if (value == null || name.startsWith(value)) {,3f59103dea335f65dbce7316ae95192f5567a9e7,1,1
/**,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
*/,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
"@FacetConstraint({JavaSourceFacet.class, ResourcesFacet.class})",3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
@Inject,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
private UIInput<String> targetPackage;,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
private UIInput<String> name;,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
@Override,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
return Metadata.forCommand(CamelNewRouteBuilderCommand.class).name(,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
"""Camel: New RouteBuilder"").category(Categories.create(CATEGORY))",3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
targetPackage.setCompleter(new PackageNameCompleter(facet));,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
targetPackage.addValidator(new PackageNameValidator());,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
targetPackage.getFacet(HintsFacet.class).setInputType(InputType.JAVA_PACKAGE_PICKER);,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
name.addValidator(new ClassNameValidator(false));,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
name.getFacet(HintsFacet.class).setInputType(InputType.JAVA_CLASS_PICKER);,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
builder.add(targetPackage).add(name);,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
javaClass.setName(name.getValue());,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
javaClass.setPackage(targetPackage.getValue());,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
"javaClass.setSuperType(""RouteBuilder"");",3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
"javaClass.addImport(""org.apache.camel.builder.RouteBuilder"");",3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
javaClass.addMethod(),3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
.setPublic(),3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
.setReturnTypeVoid(),3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
".setName(""configure"")",3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
".addThrows(Exception.class).setBody("""");",3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
facet.saveJavaSource(javaClass);,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
/**,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
*/,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
@Override,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
packageNames.add(packageName);,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
});,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
answer.add(name);,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
return answer;,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
/**,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
*/,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
@Override,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
packageNames.add(packageName);,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
});,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
answer.add(name);,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
return answer;,3f59103dea335f65dbce7316ae95192f5567a9e7,0,1
// need to find camel-core so we known the camel version,9b3bcfd5dedb971b5114ea84b99af516c930208a,6,1
// need to find camel-core so we known the camel version,9b3bcfd5dedb971b5114ea84b99af516c930208a,6,1
// need to find camel-core so we known the camel version,9b3bcfd5dedb971b5114ea84b99af516c930208a,6,1
Dependency core = CamelProjectHelper.findCamelCoreDependency(project);,9b3bcfd5dedb971b5114ea84b99af516c930208a,3,1
// find the version of Apache Camel we use,9b3bcfd5dedb971b5114ea84b99af516c930208a,3,1
Dependency core = CamelProjectHelper.findCamelCoreDependency(project);,9b3bcfd5dedb971b5114ea84b99af516c930208a,3,1
// find all available dataformat names,9b3bcfd5dedb971b5114ea84b99af516c930208a,3,1
// find all available language names,9b3bcfd5dedb971b5114ea84b99af516c930208a,3,1
List<String> names = catalog.findDataFormatNames();,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,0
List<String> names = catalog.findLanguageNames();,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,0
private UISelectOne<DataFormatDto> name;,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,0
// name -> artifactId,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,0
private UISelectOne<String> name;,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
String dataFormat = event.getNewValue() != null ? event.getNewValue().toString() : null;,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
"public Iterable<String> getCompletionProposals(UIContext context, InputComponent input, String value) {",9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
private UISelectOne<LanguageDto> name;,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,0
// we want to use same version as camel-core,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,0
private UISelectOne<String> name;,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
String language = event.getNewValue() != null ? event.getNewValue().toString() : null;,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
// name -> artifactId,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
"public Iterable<String> getCompletionProposals(UIContext context, InputComponent input, String value) {",9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
private UISelectOne<DataFormatDto> name;,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
".description(""Adds a Camel dataformat to your project dependencies"");",9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
Project project = getSelectedProject(builder);,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
Project project = getSelectedProject(context);,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
// does the project already have camel?,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
Dependency core = findCamelCoreDependency(project);,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
// we want to use same version as camel-core,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
private UISelectOne<LanguageDto> name;,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
".description(""Adds a Camel language to your project dependencies"");",9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
Project project = getSelectedProject(builder);,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
Project project = getSelectedProject(context);,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
// does the project already have camel?,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
Dependency core = findCamelCoreDependency(project);,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
// we want to use same version as camel-core,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
private final Project project;,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
private final Dependency core;,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
core = CamelProjectHelper.findCamelCoreDependency(project);,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
// filter non matching names first,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
// filter names which are already on the classpath,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
private static String findArtifactId(String json) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
private final Project project;,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
private final Dependency core;,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
core = CamelProjectHelper.findCamelCoreDependency(project);,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
// filter non matching names first,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
// filter names which are already on the classpath,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
private static String findArtifactId(String json) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,2,1
import java.util.Set;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
import static io.fabric8.forge.camel.commands.project.CamelCatalogHelper.dataFormatsFromArtifact;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
import static io.fabric8.forge.camel.commands.project.CamelProjectHelper.findCamelArtifacts;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
// filter out existing dataformats we already have,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
return catalog.findDataFormatNames();,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import java.util.Set;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
import static io.fabric8.forge.camel.commands.project.CamelCatalogHelper.languagesFromArtifact;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
import static io.fabric8.forge.camel.commands.project.CamelProjectHelper.findCamelArtifacts;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
// filter out existing languages we already have,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
return catalog.findLanguageNames();,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import io.fabric8.forge.camel.commands.project.dto.DataFormatDto;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
String description = dataFormat.getDescription();,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
// install the component,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
"return Results.success(""Added Camel dataformat "" + name.getValue().getName() + "" ("" + dto.getArtifactId() + "") to the project"");",9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
"return Results.fail(""Unknown Camel dataformat"");",9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
import io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.findDataFormatArchetype;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
String description = CamelCatalogHelper.getDataFormatDescription(dataFormat);,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
String artifactId = findDataFormatArchetype(name.getValue());,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
// install the component,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
"return Results.success(""Added Camel dataformat "" + name.getValue() + "" ("" + artifactId + "") to the project"");",9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import io.fabric8.forge.camel.commands.project.dto.DataFormatDto;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createDataFormatDto;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
"public Iterable<DataFormatDto> getCompletionProposals(UIContext context, InputComponent input, String value) {",9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
List<DataFormatDto> answer = new ArrayList<>();,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
for (String name : names) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
String json = camelCatalog.dataFormatJSonSchema(name);,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
List<String> answer = new ArrayList<String>();,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
public Iterable<String> getValueChoices() {,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import io.fabric8.forge.camel.commands.project.dto.LanguageDto;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
String description = language.getDescription();,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
// install the component,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
"return Results.success(""Added Camel language "" + dto.getName() + "" ("" + dto.getArtifactId() + "") to the project"");",9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
"return Results.fail(""Unknown Camel language"");",9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
import io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.findLanguageArchetype;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
String description = CamelCatalogHelper.getLanguageDescription(language);,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
String artifactId = findLanguageArchetype(name.getValue());,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
// install the component,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
"return Results.success(""Added Camel language "" + name.getValue() + "" ("" + artifactId + "") to the project"");",9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import io.fabric8.forge.camel.commands.project.dto.LanguageDto;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createLanguageDto;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
"public Iterable<LanguageDto> getCompletionProposals(UIContext context, InputComponent input, String value) {",9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
List<LanguageDto> answer = new ArrayList<>();,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
for (String name : names) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
String json = camelCatalog.languageJSonSchema(name);,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,0
List<String> answer = new ArrayList<String>();,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
public Iterable<String> getValueChoices() {,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import javax.inject.Inject;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import io.fabric8.forge.camel.commands.project.completer.CamelDataFormatsCompleter;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import io.fabric8.forge.camel.commands.project.dto.DataFormatDto;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.convert.Converter;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.dependencies.Dependency;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.projects.Project;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.context.UIContext;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.input.UISelectOne;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.result.Result;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.result.Results;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.util.Categories;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.util.Metadata;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createDataFormatDto;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
private DependencyInstaller dependencyInstaller;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
// use value choices instead of completer as that works better in web console,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
// include converter from string->dto,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
// show note about the chosen data format,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
String description = dataFormat.getDescription();,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
"name.setNote(description != null ? description : """");",9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
if (core == null) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
"return Results.fail(""The project does not include camel-core"");",9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
// install the component,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
"return Results.success(""Added Camel dataformat "" + dto.getName() + "" ("" + dto.getArtifactId() + "") to the project"");",9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
"return Results.fail(""Unknown Camel dataformat"");",9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import javax.inject.Inject;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import io.fabric8.forge.camel.commands.project.completer.CamelLanguagesCompleter;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import io.fabric8.forge.camel.commands.project.dto.LanguageDto;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.convert.Converter;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.dependencies.Dependency;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.projects.Project;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.context.UIContext;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.input.UISelectOne;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.result.Result;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.result.Results;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.util.Categories;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.util.Metadata;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createLanguageDto;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
private DependencyInstaller dependencyInstaller;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
// use value choices instead of completer as that works better in web console,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
// include converter from string->dto,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
// show note about the chosen language,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
String description = language.getDescription();,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
"name.setNote(description != null ? description : """");",9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
if (core == null) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
"return Results.fail(""The project does not include camel-core"");",9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
// install the component,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
"return Results.success(""Added Camel language "" + dto.getName() + "" ("" + dto.getArtifactId() + "") to the project"");",9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
"return Results.fail(""Unknown Camel language"");",9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import java.util.ArrayList;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import java.util.List;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import java.util.Map;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import java.util.Set;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import io.fabric8.forge.addon.utils.CamelProjectHelper;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import io.fabric8.forge.camel.commands.project.dto.DataFormatDto;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.apache.camel.catalog.CamelCatalog;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.apache.camel.catalog.JSonSchemaHelper;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.dependencies.Dependency;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.projects.Project;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.context.UIContext;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.input.UICompleter;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import static io.fabric8.forge.addon.utils.CamelProjectHelper.findCamelArtifacts;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createDataFormatDto;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.dataFormatsFromArtifact;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
private final CamelCatalog camelCatalog;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
"public Iterable<DataFormatDto> getCompletionProposals(UIContext context, InputComponent input, String value) {",9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
if (core == null) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
List<DataFormatDto> answer = new ArrayList<>();,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
List<String> names = camelCatalog.findDataFormatNames();,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
List<String> filtered = new ArrayList<String>();,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
for (String name : names) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
if (value == null || name.startsWith(value)) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
for (String name : filtered) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
String json = camelCatalog.dataFormatJSonSchema(name);,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
String artifactId = findArtifactId(json);,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
// skip if we already have the dependency,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
// filter out existing dataformats we already have,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import java.util.ArrayList;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import java.util.List;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import java.util.Map;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import java.util.Set;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import io.fabric8.forge.addon.utils.CamelProjectHelper;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import io.fabric8.forge.camel.commands.project.dto.LanguageDto;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.apache.camel.catalog.CamelCatalog;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.apache.camel.catalog.JSonSchemaHelper;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.dependencies.Dependency;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.projects.Project;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.context.UIContext;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import org.jboss.forge.addon.ui.input.UICompleter;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import static io.fabric8.forge.addon.utils.CamelProjectHelper.findCamelArtifacts;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createLanguageDto;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.languagesFromArtifact;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
private final CamelCatalog camelCatalog;,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
"public Iterable<LanguageDto> getCompletionProposals(UIContext context, InputComponent input, String value) {",9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
if (core == null) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
List<LanguageDto> answer = new ArrayList<>();,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
List<String> names = camelCatalog.findLanguageNames();,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
List<String> filtered = new ArrayList<String>();,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
for (String name : names) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
if (value == null || name.startsWith(value)) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
for (String name : filtered) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
String json = camelCatalog.languageJSonSchema(name);,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
String artifactId = findArtifactId(json);,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
// skip if we already have the dependency,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
// filter out existing languages we already have,9b3bcfd5dedb971b5114ea84b99af516c930208a,1,1
Set<Dependency> artifacts = findCamelArtifacts(project);,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
for (Dependency dep : artifacts) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
Set<String> languages = dataFormatsFromArtifact(dep.getCoordinate().getArtifactId());,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
names.removeAll(languages);,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
},9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
return names;,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
Set<Dependency> artifacts = findCamelArtifacts(project);,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
for (Dependency dep : artifacts) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
Set<String> languages = languagesFromArtifact(dep.getCoordinate().getArtifactId());,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
names.removeAll(languages);,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
},9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
return names;,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
DataFormatDto dataFormat = (DataFormatDto) event.getNewValue();,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
DataFormatDto dto = name.getValue();,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
if (dto != null) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
DependencyBuilder component = DependencyBuilder.create().setGroupId(dto.getGroupId()),9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
.setArtifactId(dto.getArtifactId()).setVersion(core.getCoordinate().getVersion());,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
"dependencyInstaller.install(project, component);",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
} else {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
},9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
if (artifactId == null) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"return Results.fail(""Camel dataformat "" + name.getValue() + "" is unknown."");",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
},9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"DependencyBuilder component = DependencyBuilder.create().setGroupId(""org.apache.camel"")",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
.setArtifactId(artifactId).setVersion(core.getCoordinate().getVersion());,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"dependencyInstaller.install(project, component);",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
public class CamelDataFormatsCompleter implements UICompleter<DataFormatDto> {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
"DataFormatDto dto = createDataFormatDto(camelCatalog, json);",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
answer.add(dto);,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
public Iterable<DataFormatDto> getValueChoices() {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
},9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
return answer;,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
public class CamelDataFormatsCompleter implements UICompleter<String> {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
answer.add(name);,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
return names;,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
LanguageDto language = (LanguageDto) event.getNewValue();,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
LanguageDto dto = name.getValue();,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
if (dto != null) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
DependencyBuilder component = DependencyBuilder.create().setGroupId(dto.getGroupId()),9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
.setArtifactId(dto.getArtifactId()).setVersion(core.getCoordinate().getVersion());,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
"dependencyInstaller.install(project, component);",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
} else {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
},9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
if (artifactId == null) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"return Results.fail(""Camel language "" + name.getValue() + "" is unknown."");",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
},9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"DependencyBuilder component = DependencyBuilder.create().setGroupId(""org.apache.camel"")",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
.setArtifactId(artifactId).setVersion(core.getCoordinate().getVersion());,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"dependencyInstaller.install(project, component);",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
public class CamelLanguagesCompleter implements UICompleter<LanguageDto> {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
"LanguageDto dto = createLanguageDto(camelCatalog, json);",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
answer.add(dto);,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
public Iterable<LanguageDto> getValueChoices() {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
},9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
return answer;,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,0
public class CamelLanguagesCompleter implements UICompleter<String> {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
answer.add(name);,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
return names;,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
/**,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
*,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"*  Red Hat licenses this file to you under the Apache License, version",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
*  with the License.  You may obtain a copy of the License at,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"*  Unless required by applicable law or agreed to in writing, software",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
*  implied.  See the License for the specific language governing,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
*  permissions and limitations under the License.,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
*/,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
package io.fabric8.forge.camel.commands.project;,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
public class CamelAddDataFormatCommand extends AbstractCamelProjectCommand {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
@Inject,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"@WithAttributes(label = ""Name"", required = true, description = ""Name of dataformat to add"")",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
@Override,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
public UICommandMetadata getMetadata(UIContext context) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
return Metadata.forCommand(CamelAddDataFormatCommand.class).name(,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"""Camel: Add DataFormat"").category(Categories.create(CATEGORY))",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
},9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
public void initializeUI(UIBuilder builder) throws Exception {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"name.setValueChoices(new CamelDataFormatsCompleter(project, getCamelCatalog()).getValueChoices());",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"name.setValueConverter(new Converter<String, DataFormatDto>() {",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
public DataFormatDto convert(String text) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"return createDataFormatDto(getCamelCatalog(), text);",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
});,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
name.addValueChangeListener(new ValueChangeListener() {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
public void valueChanged(ValueChangeEvent event) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
DataFormatDto dataFormat = (DataFormatDto) event.getNewValue();,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
if (dataFormat != null) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
} else {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"name.setNote("""");",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
builder.add(name);,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
public Result execute(UIExecutionContext context) throws Exception {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
DataFormatDto dto = name.getValue();,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
if (dto != null) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
DependencyBuilder component = DependencyBuilder.create().setGroupId(dto.getGroupId()),9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
.setArtifactId(dto.getArtifactId()).setVersion(core.getCoordinate().getVersion());,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"dependencyInstaller.install(project, component);",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
/**,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
*,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"*  Red Hat licenses this file to you under the Apache License, version",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
*  with the License.  You may obtain a copy of the License at,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"*  Unless required by applicable law or agreed to in writing, software",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
*  implied.  See the License for the specific language governing,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
*  permissions and limitations under the License.,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
*/,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
package io.fabric8.forge.camel.commands.project;,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
public class CamelAddLanguageCommand extends AbstractCamelProjectCommand {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
@Inject,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"@WithAttributes(label = ""Name"", required = true, description = ""Name of language to add"")",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
@Override,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
public UICommandMetadata getMetadata(UIContext context) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
return Metadata.forCommand(CamelAddLanguageCommand.class).name(,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"""Camel: Add Language"").category(Categories.create(CATEGORY))",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
},9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
public void initializeUI(UIBuilder builder) throws Exception {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"name.setValueChoices(new CamelLanguagesCompleter(project, getCamelCatalog()).getValueChoices());",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"name.setValueConverter(new Converter<String, LanguageDto>() {",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
public LanguageDto convert(String text) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"return createLanguageDto(getCamelCatalog(), text);",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
});,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
name.addValueChangeListener(new ValueChangeListener() {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
public void valueChanged(ValueChangeEvent event) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
LanguageDto language = (LanguageDto) event.getNewValue();,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
if (language != null) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
} else {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"name.setNote("""");",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
builder.add(name);,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
public Result execute(UIExecutionContext context) throws Exception {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
LanguageDto dto = name.getValue();,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
if (dto != null) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
DependencyBuilder component = DependencyBuilder.create().setGroupId(dto.getGroupId()),9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
.setArtifactId(dto.getArtifactId()).setVersion(core.getCoordinate().getVersion());,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"dependencyInstaller.install(project, component);",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
/**,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
*,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"*  Red Hat licenses this file to you under the Apache License, version",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
*  with the License.  You may obtain a copy of the License at,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"*  Unless required by applicable law or agreed to in writing, software",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
*  implied.  See the License for the specific language governing,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
*  permissions and limitations under the License.,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
*/,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
package io.fabric8.forge.camel.commands.project.completer;,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
public class CamelDataFormatsCompleter implements UICompleter<DataFormatDto> {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"public CamelDataFormatsCompleter(Project project, CamelCatalog camelCatalog) {",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
this.project = project;,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
this.camelCatalog = camelCatalog;,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
},9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
@Override,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
return null;,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
filtered.add(name);,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
boolean already = false;,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
if (artifactId != null) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"already = CamelProjectHelper.hasDependency(project, ""org.apache.camel"", artifactId);",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
if (!already) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"DataFormatDto dto = createDataFormatDto(camelCatalog, json);",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
answer.add(dto);,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
return answer;,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
public Iterable<DataFormatDto> getValueChoices() {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
Set<Dependency> artifacts = findCamelArtifacts(project);,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
for (Dependency dep : artifacts) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"Set<String> languages = dataFormatsFromArtifact(camelCatalog, dep.getCoordinate().getArtifactId());",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
names.removeAll(languages);,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"DataFormatDto dto = createDataFormatDto(camelCatalog, name);",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""dataformat"", json, false);",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"for (Map<String, String> row : data) {",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"if (row.get(""artifactId"") != null) {",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"return row.get(""artifactId"");",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
/**,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
*,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"*  Red Hat licenses this file to you under the Apache License, version",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
*  with the License.  You may obtain a copy of the License at,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"*  Unless required by applicable law or agreed to in writing, software",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
*  implied.  See the License for the specific language governing,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
*  permissions and limitations under the License.,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
*/,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
package io.fabric8.forge.camel.commands.project.completer;,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
public class CamelLanguagesCompleter implements UICompleter<LanguageDto> {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"public CamelLanguagesCompleter(Project project, CamelCatalog camelCatalog) {",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
this.project = project;,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
this.camelCatalog = camelCatalog;,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
},9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
@Override,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
return null;,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
filtered.add(name);,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
boolean already = false;,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
if (artifactId != null) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"already = CamelProjectHelper.hasDependency(project, ""org.apache.camel"", artifactId);",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
if (!already) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"LanguageDto dto = createLanguageDto(camelCatalog, json);",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
answer.add(dto);,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
return answer;,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
public Iterable<LanguageDto> getValueChoices() {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
Set<Dependency> artifacts = findCamelArtifacts(project);,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
for (Dependency dep : artifacts) {,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"Set<String> languages = languagesFromArtifact(camelCatalog, dep.getCoordinate().getArtifactId());",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
names.removeAll(languages);,9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"LanguageDto dto = createLanguageDto(camelCatalog, name);",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""language"", json, false);",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"for (Map<String, String> row : data) {",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"if (row.get(""artifactId"") != null) {",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
"return row.get(""artifactId"");",9b3bcfd5dedb971b5114ea84b99af516c930208a,0,1
Set<Dependency> artifacts = findCamelArtifacts(project);,005e055a2a58f99090ed1e3396084dec6571c4f3,3,1
Set<Dependency> artifacts = findCamelArtifacts(project);,005e055a2a58f99090ed1e3396084dec6571c4f3,3,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createDataFormatDto;,005e055a2a58f99090ed1e3396084dec6571c4f3,2,0
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createLanguageDto;,005e055a2a58f99090ed1e3396084dec6571c4f3,2,0
// find the version of Apache Camel we use,005e055a2a58f99090ed1e3396084dec6571c4f3,2,1
// need to find camel-core so we known the camel version,005e055a2a58f99090ed1e3396084dec6571c4f3,2,1
import static io.fabric8.forge.addon.utils.CamelProjectHelper.findCamelArtifacts;,005e055a2a58f99090ed1e3396084dec6571c4f3,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createDataFormatDto;,005e055a2a58f99090ed1e3396084dec6571c4f3,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.dataFormatsFromArtifact;,005e055a2a58f99090ed1e3396084dec6571c4f3,2,1
// need to find camel-core so we known the camel version,005e055a2a58f99090ed1e3396084dec6571c4f3,2,1
// find all available dataformat names,005e055a2a58f99090ed1e3396084dec6571c4f3,2,1
for (Dependency dep : artifacts) {,005e055a2a58f99090ed1e3396084dec6571c4f3,2,1
import static io.fabric8.forge.addon.utils.CamelProjectHelper.findCamelArtifacts;,005e055a2a58f99090ed1e3396084dec6571c4f3,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createLanguageDto;,005e055a2a58f99090ed1e3396084dec6571c4f3,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.languagesFromArtifact;,005e055a2a58f99090ed1e3396084dec6571c4f3,2,1
// need to find camel-core so we known the camel version,005e055a2a58f99090ed1e3396084dec6571c4f3,2,1
// find all available language names,005e055a2a58f99090ed1e3396084dec6571c4f3,2,1
for (Dependency dep : artifacts) {,005e055a2a58f99090ed1e3396084dec6571c4f3,2,1
import io.fabric8.forge.camel.commands.project.dto.DataFormatDto;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,0
Dependency core = CamelProjectHelper.findCamelCoreDependency(project);,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import io.fabric8.forge.camel.commands.project.dto.LanguageDto;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,0
Dependency core = CamelProjectHelper.findCamelCoreDependency(project);,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import java.util.ArrayList;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import java.util.List;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import java.util.Map;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import java.util.Set;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import io.fabric8.forge.addon.utils.CamelProjectHelper;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import io.fabric8.forge.camel.commands.project.dto.DataFormatDto;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import org.apache.camel.catalog.CamelCatalog;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import org.apache.camel.catalog.JSonSchemaHelper;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import org.jboss.forge.addon.dependencies.Dependency;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import org.jboss.forge.addon.projects.Project;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import org.jboss.forge.addon.ui.context.UIContext;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import org.jboss.forge.addon.ui.input.UICompleter;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
private final Project project;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
private final Dependency core;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
List<String> names = camelCatalog.findDataFormatNames();,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
// filter non matching names first,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
// filter names which are already on the classpath,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
"Set<String> languages = dataFormatsFromArtifact(camelCatalog, dep.getCoordinate().getArtifactId());",005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
private static String findArtifactId(String json) {,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import java.util.ArrayList;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import java.util.List;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import java.util.Map;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import java.util.Set;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import io.fabric8.forge.addon.utils.CamelProjectHelper;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import io.fabric8.forge.camel.commands.project.dto.LanguageDto;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import org.apache.camel.catalog.CamelCatalog;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import org.apache.camel.catalog.JSonSchemaHelper;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import org.jboss.forge.addon.dependencies.Dependency;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import org.jboss.forge.addon.projects.Project;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import org.jboss.forge.addon.ui.context.UIContext;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
import org.jboss.forge.addon.ui.input.UICompleter;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
private final Project project;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
private final Dependency core;,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
List<String> names = camelCatalog.findLanguageNames();,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
// filter non matching names first,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
// filter names which are already on the classpath,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
// filter out existing languages we already have,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
"Set<String> languages = languagesFromArtifact(camelCatalog, dep.getCoordinate().getArtifactId());",005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
private static String findArtifactId(String json) {,005e055a2a58f99090ed1e3396084dec6571c4f3,1,1
public class CamelDataFormatsCompleter implements UICompleter<DataFormatDto> {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,0
"public Iterable<DataFormatDto> getCompletionProposals(UIContext context, InputComponent input, String value) {",005e055a2a58f99090ed1e3396084dec6571c4f3,0,0
List<DataFormatDto> answer = new ArrayList<>();,005e055a2a58f99090ed1e3396084dec6571c4f3,0,0
"DataFormatDto dto = createDataFormatDto(camelCatalog, json);",005e055a2a58f99090ed1e3396084dec6571c4f3,0,0
answer.add(dto);,005e055a2a58f99090ed1e3396084dec6571c4f3,0,0
public Iterable<DataFormatDto> getValueChoices() {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,0
for (String name : names) {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,0
String json = camelCatalog.dataFormatJSonSchema(name);,005e055a2a58f99090ed1e3396084dec6571c4f3,0,0
},005e055a2a58f99090ed1e3396084dec6571c4f3,0,0
return answer;,005e055a2a58f99090ed1e3396084dec6571c4f3,0,0
public class CamelDataFormatsCompleter implements UICompleter<String> {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"public Iterable<String> getCompletionProposals(UIContext context, InputComponent input, String value) {",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
List<String> answer = new ArrayList<String>();,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
answer.add(name);,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
public Iterable<String> getValueChoices() {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
return names;,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
public class CamelLanguagesCompleter implements UICompleter<LanguageDto> {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,0
"public Iterable<LanguageDto> getCompletionProposals(UIContext context, InputComponent input, String value) {",005e055a2a58f99090ed1e3396084dec6571c4f3,0,0
List<LanguageDto> answer = new ArrayList<>();,005e055a2a58f99090ed1e3396084dec6571c4f3,0,0
"LanguageDto dto = createLanguageDto(camelCatalog, json);",005e055a2a58f99090ed1e3396084dec6571c4f3,0,0
answer.add(dto);,005e055a2a58f99090ed1e3396084dec6571c4f3,0,0
public Iterable<LanguageDto> getValueChoices() {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,0
for (String name : names) {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,0
String json = camelCatalog.languageJSonSchema(name);,005e055a2a58f99090ed1e3396084dec6571c4f3,0,0
},005e055a2a58f99090ed1e3396084dec6571c4f3,0,0
return answer;,005e055a2a58f99090ed1e3396084dec6571c4f3,0,0
public class CamelLanguagesCompleter implements UICompleter<String> {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"public Iterable<String> getCompletionProposals(UIContext context, InputComponent input, String value) {",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
List<String> answer = new ArrayList<String>();,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
answer.add(name);,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
public Iterable<String> getValueChoices() {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
return names;,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
/**,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
*,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"*  Red Hat licenses this file to you under the Apache License, version",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
*  with the License.  You may obtain a copy of the License at,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"*  Unless required by applicable law or agreed to in writing, software",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
*  implied.  See the License for the specific language governing,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
*  permissions and limitations under the License.,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
*/,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
package io.fabric8.forge.camel.commands.project.completer;,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
public class CamelDataFormatsCompleter implements UICompleter<DataFormatDto> {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
private final CamelCatalog camelCatalog;,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"public CamelDataFormatsCompleter(Project project, CamelCatalog camelCatalog) {",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
this.project = project;,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
this.camelCatalog = camelCatalog;,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
core = CamelProjectHelper.findCamelCoreDependency(project);,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
},005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
@Override,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"public Iterable<DataFormatDto> getCompletionProposals(UIContext context, InputComponent input, String value) {",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
if (core == null) {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
return null;,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
List<DataFormatDto> answer = new ArrayList<>();,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
List<String> filtered = new ArrayList<String>();,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
for (String name : names) {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
if (value == null || name.startsWith(value)) {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
filtered.add(name);,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
for (String name : filtered) {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
String json = camelCatalog.dataFormatJSonSchema(name);,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
String artifactId = findArtifactId(json);,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
// skip if we already have the dependency,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
boolean already = false;,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
if (artifactId != null) {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"already = CamelProjectHelper.hasDependency(project, ""org.apache.camel"", artifactId);",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
if (!already) {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"DataFormatDto dto = createDataFormatDto(camelCatalog, json);",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
answer.add(dto);,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
return answer;,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
public Iterable<DataFormatDto> getValueChoices() {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
// filter out existing dataformats we already have,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
names.removeAll(languages);,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"DataFormatDto dto = createDataFormatDto(camelCatalog, name);",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""dataformat"", json, false);",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"for (Map<String, String> row : data) {",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"if (row.get(""artifactId"") != null) {",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"return row.get(""artifactId"");",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
/**,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
*,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"*  Red Hat licenses this file to you under the Apache License, version",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
*  with the License.  You may obtain a copy of the License at,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"*  Unless required by applicable law or agreed to in writing, software",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
*  implied.  See the License for the specific language governing,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
*  permissions and limitations under the License.,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
*/,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
package io.fabric8.forge.camel.commands.project.completer;,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
public class CamelLanguagesCompleter implements UICompleter<LanguageDto> {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
private final CamelCatalog camelCatalog;,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"public CamelLanguagesCompleter(Project project, CamelCatalog camelCatalog) {",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
this.project = project;,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
this.camelCatalog = camelCatalog;,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
core = CamelProjectHelper.findCamelCoreDependency(project);,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
},005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
@Override,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"public Iterable<LanguageDto> getCompletionProposals(UIContext context, InputComponent input, String value) {",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
if (core == null) {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
return null;,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
List<LanguageDto> answer = new ArrayList<>();,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
List<String> filtered = new ArrayList<String>();,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
for (String name : names) {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
if (value == null || name.startsWith(value)) {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
filtered.add(name);,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
for (String name : filtered) {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
String json = camelCatalog.languageJSonSchema(name);,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
String artifactId = findArtifactId(json);,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
// skip if we already have the dependency,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
boolean already = false;,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
if (artifactId != null) {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"already = CamelProjectHelper.hasDependency(project, ""org.apache.camel"", artifactId);",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
if (!already) {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"LanguageDto dto = createLanguageDto(camelCatalog, json);",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
answer.add(dto);,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
return answer;,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
public Iterable<LanguageDto> getValueChoices() {,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
names.removeAll(languages);,005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"LanguageDto dto = createLanguageDto(camelCatalog, name);",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""language"", json, false);",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"for (Map<String, String> row : data) {",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"if (row.get(""artifactId"") != null) {",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
"return row.get(""artifactId"");",005e055a2a58f99090ed1e3396084dec6571c4f3,0,1
// we want to use same version as camel-core if its a camel component,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,2,1
"return Results.success(""Added Camel component "" + dto.getScheme() + "" ("" + dto.getArtifactId() + "") to the project"");",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,2,1
"return Results.fail(""Unknown Camel component"");",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,2,1
// use value choices instead of completer as that works better in web console,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,2,1
// we want to use same version as camel-core,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,2,1
"return Results.success(""Added Camel dataformat "" + dto.getName() + "" ("" + dto.getArtifactId() + "") to the project"");",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,2,1
"return Results.fail(""Unknown Camel dataformat"");",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,2,1
// use value choices instead of completer as that works better in web console,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,2,1
// we want to use same version as camel-core,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,2,1
"return Results.success(""Added Camel language "" + dto.getName() + "" ("" + dto.getArtifactId() + "") to the project"");",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,2,1
"return Results.fail(""Unknown Camel language"");",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,2,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
*  implied.  See the License for the specific language governing,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
public class CamelAddComponentCommand extends AbstractCamelProjectCommand {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
@Override,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
public UICommandMetadata getMetadata(UIContext context) {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
return Metadata.forCommand(CamelAddComponentCommand.class).name(,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
"""Camel: Add Component"").category(Categories.create(CATEGORY))",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
".description(""Adds a Camel component to your project dependencies"");",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
// include converter from string->dto,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
"return createComponentDto(getCamelCatalog(), text);",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
// show note about the chosen component,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
public Result execute(UIExecutionContext context) throws Exception {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
// does the project already have camel?,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
"return Results.fail(""The project does not include camel-core"");",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
// otherwise use the version from the dto,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
// install the component,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
*  implied.  See the License for the specific language governing,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
public class CamelAddDataFormatCommand extends AbstractCamelProjectCommand {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
@Override,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
public UICommandMetadata getMetadata(UIContext context) {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
return Metadata.forCommand(CamelAddDataFormatCommand.class).name(,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
"""Camel: Add DataFormat"").category(Categories.create(CATEGORY))",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
".description(""Adds a Camel dataformat to your project dependencies"");",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
// include converter from string->dto,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
"return createDataFormatDto(getCamelCatalog(), text);",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
// show note about the chosen data format,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
public Result execute(UIExecutionContext context) throws Exception {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
// does the project already have camel?,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
"return Results.fail(""The project does not include camel-core"");",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
// install the component,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
*  implied.  See the License for the specific language governing,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
public class CamelAddLanguageCommand extends AbstractCamelProjectCommand {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
@Override,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
public UICommandMetadata getMetadata(UIContext context) {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
return Metadata.forCommand(CamelAddLanguageCommand.class).name(,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
"""Camel: Add Language"").category(Categories.create(CATEGORY))",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
".description(""Adds a Camel language to your project dependencies"");",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
// include converter from string->dto,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
"return createLanguageDto(getCamelCatalog(), text);",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
// show note about the chosen language,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
public Result execute(UIExecutionContext context) throws Exception {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
// does the project already have camel?,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
"return Results.fail(""The project does not include camel-core"");",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
// install the component,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,1,1
/**,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
*,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"*  Red Hat licenses this file to you under the Apache License, version",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
*  with the License.  You may obtain a copy of the License at,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"*  Unless required by applicable law or agreed to in writing, software",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
*  permissions and limitations under the License.,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
*/,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
package io.fabric8.forge.camel.commands.project;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import javax.inject.Inject;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.convert.Converter;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.dependencies.Dependency;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.projects.Project;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.context.UIContext;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.input.UISelectOne;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.result.Result;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.result.Results;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.util.Categories;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.util.Metadata;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createComponentDto;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
@Inject,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"@WithAttributes(label = ""Filter"", required = false, description = ""To filter components"")",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
private UISelectOne<String> filter;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"@WithAttributes(label = ""Name"", required = true, description = ""Name of component type to add"")",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
private UISelectOne<ComponentDto> name;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
private DependencyInstaller dependencyInstaller;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
},1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
public void initializeUI(UIBuilder builder) throws Exception {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
final Project project = getSelectedProject(builder);,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"filter.setValueChoices(CamelCommandsHelper.createComponentLabelValues(project, getCamelCatalog()));",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"filter.setDefaultValue(""<all>"");",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"name.setValueChoices(CamelCommandsHelper.createComponentDtoValues(project, getCamelCatalog(), filter, false));",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"name.setValueConverter(new Converter<String, ComponentDto>() {",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
public ComponentDto convert(String text) {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
});,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
name.addValueChangeListener(new ValueChangeListener() {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
public void valueChanged(ValueChangeEvent event) {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
ComponentDto component = (ComponentDto) event.getNewValue();,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
if (component != null) {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
String description = component.getDescription();,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"name.setNote(description != null ? description : """");",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
} else {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"name.setNote("""");",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
builder.add(filter).add(name);,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
Project project = getSelectedProject(context);,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
Dependency core = findCamelCoreDependency(project);,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
if (core == null) {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
ComponentDto dto = name.getValue();,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
if (dto != null) {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
String version;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"if (""org.apache.camel"".equals(dto.getGroupId())) {",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
version = core.getCoordinate().getVersion();,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
version = dto.getVersion();,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
DependencyBuilder component = DependencyBuilder.create().setGroupId(dto.getGroupId()),1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
.setArtifactId(dto.getArtifactId()).setVersion(version);,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"dependencyInstaller.install(project, component);",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
/**,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
*,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"*  Red Hat licenses this file to you under the Apache License, version",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
*  with the License.  You may obtain a copy of the License at,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"*  Unless required by applicable law or agreed to in writing, software",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
*  permissions and limitations under the License.,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
*/,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
package io.fabric8.forge.camel.commands.project;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import javax.inject.Inject;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import io.fabric8.forge.camel.commands.project.completer.CamelDataFormatsCompleter;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import io.fabric8.forge.camel.commands.project.dto.DataFormatDto;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.convert.Converter;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.dependencies.Dependency;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.projects.Project;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.context.UIContext;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.input.UISelectOne;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.result.Result;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.result.Results;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.util.Categories;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.util.Metadata;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createDataFormatDto;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
@Inject,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"@WithAttributes(label = ""Name"", required = true, description = ""Name of dataformat to add"")",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
private UISelectOne<DataFormatDto> name;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
private DependencyInstaller dependencyInstaller;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
},1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
public void initializeUI(UIBuilder builder) throws Exception {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
Project project = getSelectedProject(builder);,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"name.setValueChoices(new CamelDataFormatsCompleter(project, getCamelCatalog()).getValueChoices());",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"name.setValueConverter(new Converter<String, DataFormatDto>() {",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
public DataFormatDto convert(String text) {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
});,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
name.addValueChangeListener(new ValueChangeListener() {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
public void valueChanged(ValueChangeEvent event) {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
DataFormatDto dataFormat = (DataFormatDto) event.getNewValue();,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
if (dataFormat != null) {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
String description = dataFormat.getDescription();,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"name.setNote(description != null ? description : """");",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
} else {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"name.setNote("""");",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
builder.add(name);,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
Project project = getSelectedProject(context);,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
Dependency core = findCamelCoreDependency(project);,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
if (core == null) {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
DataFormatDto dto = name.getValue();,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
if (dto != null) {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
DependencyBuilder component = DependencyBuilder.create().setGroupId(dto.getGroupId()),1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
.setArtifactId(dto.getArtifactId()).setVersion(core.getCoordinate().getVersion());,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"dependencyInstaller.install(project, component);",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
/**,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
*,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"*  Red Hat licenses this file to you under the Apache License, version",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
*  with the License.  You may obtain a copy of the License at,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"*  Unless required by applicable law or agreed to in writing, software",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
*  permissions and limitations under the License.,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
*/,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
package io.fabric8.forge.camel.commands.project;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import javax.inject.Inject;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import io.fabric8.forge.camel.commands.project.completer.CamelLanguagesCompleter;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import io.fabric8.forge.camel.commands.project.dto.LanguageDto;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.convert.Converter;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.dependencies.Dependency;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.projects.Project;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.context.UIContext;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.input.UISelectOne;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.result.Result;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.result.Results;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.util.Categories;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import org.jboss.forge.addon.ui.util.Metadata;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createLanguageDto;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
@Inject,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"@WithAttributes(label = ""Name"", required = true, description = ""Name of language to add"")",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
private UISelectOne<LanguageDto> name;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
private DependencyInstaller dependencyInstaller;,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
},1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
public void initializeUI(UIBuilder builder) throws Exception {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
Project project = getSelectedProject(builder);,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"name.setValueChoices(new CamelLanguagesCompleter(project, getCamelCatalog()).getValueChoices());",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"name.setValueConverter(new Converter<String, LanguageDto>() {",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
public LanguageDto convert(String text) {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
});,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
name.addValueChangeListener(new ValueChangeListener() {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
public void valueChanged(ValueChangeEvent event) {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
LanguageDto language = (LanguageDto) event.getNewValue();,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
if (language != null) {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
String description = language.getDescription();,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"name.setNote(description != null ? description : """");",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
} else {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"name.setNote("""");",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
builder.add(name);,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
Project project = getSelectedProject(context);,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
Dependency core = findCamelCoreDependency(project);,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
if (core == null) {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
LanguageDto dto = name.getValue();,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
if (dto != null) {,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
DependencyBuilder component = DependencyBuilder.create().setGroupId(dto.getGroupId()),1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
.setArtifactId(dto.getArtifactId()).setVersion(core.getCoordinate().getVersion());,1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
"dependencyInstaller.install(project, component);",1dcbe87c07f8c163f18ae6cc13999ae5dff742c3,0,1
// use the camel catalog to load the archetypes,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,4,1
*  with the License.  You may obtain a copy of the License at,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,3,1
*  implied.  See the License for the specific language governing,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,3,1
// load the archetype-catalog.xml from inside the JAR,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,2,0
} catch (Exception e) {,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,2,0
} catch (Exception e) {,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,2,1
"*  Red Hat licenses this file to you under the Apache License, version",234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,2,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,2,1
*  permissions and limitations under the License.,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,2,1
* The Fabric8 archetypes,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,2,1
// load the archetype-catalog.xml from inside the JAR,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,2,1
} catch (Exception e) {,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,2,1
import java.net.URL;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,0
import java.net.URLClassLoader;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,0
try {,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,0
if (is != null) {,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,0
import org.jboss.forge.addon.parser.xml.resources.XMLResource;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
XMLResource xml = (XMLResource) dependency.getArtifact();,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
if (xml != null) {,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
try (InputStream is = xml.getResourceInputStream()) {,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
"*  Copyright 2005-2015 Red Hat, Inc.",234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
*,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
*     http://www.apache.org/licenses/LICENSE-2.0,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
"*  Unless required by applicable law or agreed to in writing, software",234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
import java.io.InputStream;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
import java.net.URL;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
import java.net.URLClassLoader;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
import java.util.logging.Level;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
import java.util.logging.Logger;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
import javax.inject.Inject;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
import io.fabric8.forge.addon.utils.VersionHelper;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
import org.apache.maven.archetype.catalog.ArchetypeCatalog;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
import org.apache.maven.archetype.catalog.io.xpp3.ArchetypeCatalogXpp3Reader;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
import org.jboss.forge.addon.dependencies.Coordinate;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
import org.jboss.forge.addon.dependencies.Dependency;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
import org.jboss.forge.addon.dependencies.DependencyResolver;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
import org.jboss.forge.addon.dependencies.builder.CoordinateBuilder;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
import org.jboss.forge.addon.dependencies.builder.DependencyQueryBuilder;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
import org.jboss.forge.addon.maven.archetype.ArchetypeCatalogFactory;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
import org.jboss.forge.furnace.services.Imported;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
public class FabricArchetypeCatalogFactory implements ArchetypeCatalogFactory {,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
public String toString() {,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
},234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
public String getName() {,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
public ArchetypeCatalog getArchetypeCatalog() {,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
if (cachedArchetypes == null) {,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
Coordinate coordinate = CoordinateBuilder.create(),234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
Dependency dependency = resolver.get().resolveArtifact(DependencyQueryBuilder.create(coordinate));,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
if (dependency != null) {,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
try {,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
if (is != null) {,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
public boolean equals(Object o) {,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
public int hashCode() {,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,1,1
String version = VersionHelper.fabric8Version();,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,0
.setVersion(version),234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,0
// TODO: version should be not hardcoded,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
".setVersion(""2.2-SNAPSHOT"")",234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
".setPackaging(""jar"");",234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,0
String name = dependency.getArtifact().getFullyQualifiedName();,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,0
"URL url = new URL(""file"", null, name);",234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,0
URLClassLoader loader = new URLClassLoader(new URL[]{url});,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,0
"InputStream is = loader.getResourceAsStream(""archetype-catalog.xml"");",234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,0
"logger.log(Level.SEVERE, ""Error while retrieving archetypes"", e);",234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,0
".setClassifier(""archetype-catalog"")",234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
".setPackaging(""xml"");",234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
"logger.log(Level.SEVERE, ""Error while retrieving archetypes"", e);",234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
/**,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
*/,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
package io.fabric8.forge.camel.commands.project.archetype;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
private final Logger logger = Logger.getLogger(getClass().getName());,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
"private static final String NAME = ""fabric8"";",234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
@Inject,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
Imported<DependencyResolver> resolver;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
private ArchetypeCatalog cachedArchetypes;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
return NAME;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
@Override,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
String version = VersionHelper.fabric8ArchetypesVersion();,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
".setGroupId(""io.fabric8.archetypes"")",234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
".setArtifactId(""archetypes-catalog"")",234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
.setVersion(version),234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
".setPackaging(""jar"");",234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
String name = dependency.getArtifact().getFullyQualifiedName();,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
"URL url = new URL(""file"", null, name);",234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
URLClassLoader loader = new URLClassLoader(new URL[]{url});,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
"InputStream is = loader.getResourceAsStream(""archetype-catalog.xml"");",234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
cachedArchetypes = new ArchetypeCatalogXpp3Reader().read(is);,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
"logger.log(Level.SEVERE, ""Error while retrieving archetypes"", e);",234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
return cachedArchetypes;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
if (this == o) return true;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
if (o == null || getClass() != o.getClass()) return false;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
FabricArchetypeCatalogFactory that = (FabricArchetypeCatalogFactory) o;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
if (!NAME.equals(that.NAME)) return false;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
return true;,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
return NAME.hashCode();,234baf2590bb43f07f2e87dc8d4e0bfe446e0ab5,0,1
"@WithAttributes(label = ""Replication Controller ID"", description = ""The ID of the replication controller to delete."", required = true)",bc5eedffd29f7921df7c0eec29cac742fc356951,6,1
"@WithAttributes(name = ""filter"", label = ""The text filter used to filter pods using label selectors"")",bc5eedffd29f7921df7c0eec29cac742fc356951,5,1
"@WithAttributes(name = ""filter"", label = ""The text filter used to filter pods using label selectors"")",bc5eedffd29f7921df7c0eec29cac742fc356951,5,1
"@WithAttributes(name = ""filter"", label = ""The text filter used to filter pods using label selectors"")",bc5eedffd29f7921df7c0eec29cac742fc356951,5,1
"String updateNamespace(@PathParam(""name"") @NotNull String namespaceId, Namespace entity) throws Exception;",bc5eedffd29f7921df7c0eec29cac742fc356951,4,0
"podMap = getPodMap(kubernetes, namespace);",bc5eedffd29f7921df7c0eec29cac742fc356951,4,1
"@WithAttributes(label = ""Service ID"", description = ""The ID of the service to delete."", required = true)",bc5eedffd29f7921df7c0eec29cac742fc356951,4,1
private String namespace = defaultNamespace();,bc5eedffd29f7921df7c0eec29cac742fc356951,3,0
"String namespace = System.getenv(""KUBERNETES_NAMESPACE"");",bc5eedffd29f7921df7c0eec29cac742fc356951,3,0
private String namespace = Kubernetes.NAMESPACE_ALL;,bc5eedffd29f7921df7c0eec29cac742fc356951,3,1
"public void deletePod(Pod entity, String namespace) throws Exception {",bc5eedffd29f7921df7c0eec29cac742fc356951,3,0
String id = getId(entity);,bc5eedffd29f7921df7c0eec29cac742fc356951,3,0
"public void deleteService(Service entity, String namespace) throws Exception {",bc5eedffd29f7921df7c0eec29cac742fc356951,3,0
String id = getId(replicationController);,bc5eedffd29f7921df7c0eec29cac742fc356951,3,0
String id = KubernetesHelper.getId(entity);,bc5eedffd29f7921df7c0eec29cac742fc356951,3,1
String id = KubernetesHelper.getId(replicationController);,bc5eedffd29f7921df7c0eec29cac742fc356951,3,1
"Namespace getNamespace(@PathParam(""name"") @NotNull String name);",bc5eedffd29f7921df7c0eec29cac742fc356951,3,0
"String deleteNamespace(@PathParam(""name"") @NotNull String name) throws Exception;",bc5eedffd29f7921df7c0eec29cac742fc356951,3,0
"return getKubernetes().updateReplicationController(controllerId, entity, namespace);",bc5eedffd29f7921df7c0eec29cac742fc356951,3,0
"return getKubernetes().updateService(serviceId, entity, namespace);",bc5eedffd29f7921df7c0eec29cac742fc356951,3,0
"return getWriteableKubernetes().deletePod(podId, namespace);",bc5eedffd29f7921df7c0eec29cac742fc356951,3,1
"return getWriteableKubernetes().updateReplicationController(controllerId, entity, namespace);",bc5eedffd29f7921df7c0eec29cac742fc356951,3,1
"return getWriteableKubernetes().updateService(serviceId, entity, namespace);",bc5eedffd29f7921df7c0eec29cac742fc356951,3,1
PodList pods = kube.getPods(Kubernetes.NAMESPACE_DEFAULT);,bc5eedffd29f7921df7c0eec29cac742fc356951,3,0
PodList pods = kube.getPods(Kubernetes.NAMESPACE_ALL);,bc5eedffd29f7921df7c0eec29cac742fc356951,3,1
"Service old = kubernetes.getService(id, namespace);",bc5eedffd29f7921df7c0eec29cac742fc356951,3,0
"ReplicationController old = kubernetes.getReplicationController(id, namespace);",bc5eedffd29f7921df7c0eec29cac742fc356951,3,0
"Pod old = kubernetes.getPod(id, namespace);",bc5eedffd29f7921df7c0eec29cac742fc356951,3,0
"serviceMap = getServiceMap(kubernetes, namespace);",bc5eedffd29f7921df7c0eec29cac742fc356951,3,1
"replicationControllerMap = getReplicationControllerMap(kubernetes, namespace);",bc5eedffd29f7921df7c0eec29cac742fc356951,3,1
PodList pods = getKubernetes().pods().inNamespace(getNamespace()).list();,bc5eedffd29f7921df7c0eec29cac742fc356951,3,1
String id = KubernetesHelper.getName(item);,bc5eedffd29f7921df7c0eec29cac742fc356951,3,1
* Deletes a replication controller from kubernetes,bc5eedffd29f7921df7c0eec29cac742fc356951,3,1
".description(""Deletes the given replication controller from the kubernetes cloud"");",bc5eedffd29f7921df7c0eec29cac742fc356951,3,1
String id = KubernetesHelper.getName(item);,bc5eedffd29f7921df7c0eec29cac742fc356951,3,1
ReplicationController replicationController = getKubernetes().replicationControllers().inNamespace(getNamespace()).withName(idText).get();,bc5eedffd29f7921df7c0eec29cac742fc356951,3,1
String id = KubernetesHelper.getName(item);,bc5eedffd29f7921df7c0eec29cac742fc356951,3,1
String selector = null;,bc5eedffd29f7921df7c0eec29cac742fc356951,3,1
String id = KubernetesHelper.getName(item);,bc5eedffd29f7921df7c0eec29cac742fc356951,3,1
Service service = getKubernetes().services().inNamespace(getNamespace()).withName(idText).get();,bc5eedffd29f7921df7c0eec29cac742fc356951,3,1
String selector = KubernetesHelper.toLabelsString(getSelector(service));,bc5eedffd29f7921df7c0eec29cac742fc356951,3,1
protected static String defaultNamespace() {,bc5eedffd29f7921df7c0eec29cac742fc356951,2,0
import static io.fabric8.kubernetes.api.KubernetesHelper.getId;,bc5eedffd29f7921df7c0eec29cac742fc356951,2,0
import static io.fabric8.kubernetes.api.KubernetesHelper.getPort;,bc5eedffd29f7921df7c0eec29cac742fc356951,2,0
import static io.fabric8.kubernetes.api.KubernetesHelper.getSelector;,bc5eedffd29f7921df7c0eec29cac742fc356951,2,0
import static io.fabric8.kubernetes.api.KubernetesHelper.*;,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
import static io.fabric8.kubernetes.api.KubernetesHelper.*;,bc5eedffd29f7921df7c0eec29cac742fc356951,2,0
"public void deleteReplicationControllerAndPods(ReplicationController replicationController, String namespace) throws Exception {",bc5eedffd29f7921df7c0eec29cac742fc356951,2,0
"public void deleteReplicationController(ReplicationController replicationController, String namespace) throws Exception {",bc5eedffd29f7921df7c0eec29cac742fc356951,2,0
String sid = getId(s);,bc5eedffd29f7921df7c0eec29cac742fc356951,2,0
String sid = KubernetesHelper.getId(s);,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
import io.fabric8.kubernetes.api.model.ReplicationControllerList;,bc5eedffd29f7921df7c0eec29cac742fc356951,2,0
import io.fabric8.kubernetes.api.model.ServiceList;,bc5eedffd29f7921df7c0eec29cac742fc356951,2,0
kubernetes = getFactory().createKubernetes();,bc5eedffd29f7921df7c0eec29cac742fc356951,2,0
"return getKubernetes().deletePod(podId, namespace);",bc5eedffd29f7921df7c0eec29cac742fc356951,2,0
"return getKubernetes().deleteReplicationController(controllerId, namespace);",bc5eedffd29f7921df7c0eec29cac742fc356951,2,0
"return getKubernetes().deleteService(serviceId, namespace);",bc5eedffd29f7921df7c0eec29cac742fc356951,2,0
"return getKubernetes().createPod(entity, namespace);",bc5eedffd29f7921df7c0eec29cac742fc356951,2,0
"return getKubernetes().createService(entity, namespace);",bc5eedffd29f7921df7c0eec29cac742fc356951,2,0
"return getKubernetes().createReplicationController(entity, namespace);",bc5eedffd29f7921df7c0eec29cac742fc356951,2,0
String openShiftToken = getFactory().findOpenShiftToken();,bc5eedffd29f7921df7c0eec29cac742fc356951,2,0
kubernetes = getFactory(false).createKubernetes();,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
"return getWriteableKubernetes().deletePod(podId, getNamespace());",bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
"return getWriteableKubernetes().deleteReplicationController(controllerId, namespace);",bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
"return getWriteableKubernetes().deleteService(serviceId, namespace);",bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
"return getWriteableKubernetes().createPod(entity, namespace);",bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
"return getWriteableKubernetes().createService(entity, namespace);",bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
"return getWriteableKubernetes().createReplicationController(entity, namespace);",bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
String openShiftToken = getFactory(false).findOpenShiftToken();,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
ServiceList services = kube.getServices(Kubernetes.NAMESPACE_DEFAULT);,bc5eedffd29f7921df7c0eec29cac742fc356951,2,0
ReplicationControllerList replicationControllers = kube.getReplicationControllers(Kubernetes.NAMESPACE_DEFAULT);,bc5eedffd29f7921df7c0eec29cac742fc356951,2,0
ServiceList services = kube.getServices(Kubernetes.NAMESPACE_ALL);,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
ReplicationControllerList replicationControllers = kube.getReplicationControllers(Kubernetes.NAMESPACE_ALL);,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
Service old = serviceMap.get(id);,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
ReplicationController old = replicationControllerMap.get(id);,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
Pod old = podMap.get(id);,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
import io.fabric8.utils.Filter;,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
* Command to list pods in kubernetes,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
".description(""Lists the pods in a kubernetes cloud"");",bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
Filter<Pod> filter = KubernetesHelper.createPodFilter(filterText.getValue());,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
"String status = """";",bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
"String host = """";",bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
"Map<String, String> labelMap = item.getMetadata().getLabels();",bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
String labels = KubernetesHelper.toLabelsString(labelMap);,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
String image = container.getImage();,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
"id = """";",bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
import io.fabric8.kubernetes.api.model.ReplicationControllerList;,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
".name(CATEGORY + "": Replication Controller Delete"")",bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
ReplicationControllerList replicationControllers = getKubernetes().replicationControllers().inNamespace(getNamespace()).list();,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
String idText = replicationControllerId.getValue();,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
import io.fabric8.kubernetes.api.model.ReplicationControllerList;,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
import io.fabric8.utils.Filter;,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
import static io.fabric8.kubernetes.api.KubernetesHelper.toPositiveNonZeroText;,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
* Command to list replication controllers in kubernetes,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
".name(CATEGORY + "": Replication Controller List"")",bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
".description(""Lists the replication controllers in a kubernetes cloud"");",bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
ReplicationControllerList replicationControllers = getKubernetes().replicationControllers().inNamespace(getNamespace()).list();,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
Filter<ReplicationController> filter = KubernetesHelper.createReplicationControllerFilter(filterText.getValue());,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
String labels = KubernetesHelper.toLabelsString(item.getMetadata().getLabels());,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
selector = KubernetesHelper.toLabelsString(desiredState.getSelector());,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
import io.fabric8.kubernetes.api.model.ServiceList;,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
import static io.fabric8.kubernetes.api.KubernetesHelper.getName;,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
* Deletes a service from kubernetes,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
".description(""Deletes the given service from the kubernetes cloud"");",bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
ServiceList services = getKubernetes().services().inNamespace(getNamespace()).list();,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
String idText = serviceId.getValue();,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
import io.fabric8.kubernetes.api.model.ServiceList;,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
import io.fabric8.utils.Filter;,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
import static io.fabric8.kubernetes.api.KubernetesHelper.getPorts;,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
import static io.fabric8.kubernetes.api.KubernetesHelper.getSelector;,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
* Command to list services in kubernetes,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
".description(""Lists the services in a kubernetes cloud"");",bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
ServiceList services = getKubernetes().services().list();,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
Filter<Service> filter = KubernetesHelper.createServiceFilter(filterText.getValue());,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
String labels = KubernetesHelper.toLabelsString(service.getMetadata().getLabels());,bc5eedffd29f7921df7c0eec29cac742fc356951,2,1
return namespace;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
return Kubernetes.NAMESPACE_ALL;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
import io.fabric8.kubernetes.api.model.Container;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
import io.fabric8.kubernetes.api.model.ContainerManifest;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
import io.fabric8.kubernetes.api.model.Pod;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
import io.fabric8.kubernetes.api.model.PodList;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
import io.fabric8.kubernetes.api.model.PodState;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
import io.fabric8.kubernetes.api.model.*;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
"url = URLUtils.pathJoin(""/kubernetes/osapi"", defaultOsApiVersion, ""buildConfigHooks"", name, secret, type);",bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
"url = URLUtils.pathJoin(""/osapi"", defaultOsApiVersion, ""buildConfigHooks"", name, secret, type);",bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
"return getPodMap(this, namespace).values();",bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
"url = URLUtils.pathJoin(""/kubernetes/osapi"", KubernetesHelper.defaultOsApiVersion, ""buildConfigHooks"", name, secret, type);",bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
"url = URLUtils.pathJoin(""/osapi"", KubernetesHelper.defaultOsApiVersion, ""buildConfigHooks"", name, secret, type);",bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
"return KubernetesHelper.getPodMap(this, namespace).values();",bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import io.fabric8.kubernetes.api.model.Endpoints;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
import io.fabric8.kubernetes.api.model.EndpointsList;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
import io.fabric8.kubernetes.api.model.Node;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
import io.fabric8.kubernetes.api.model.NodeList;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
import io.fabric8.kubernetes.api.model.Pod;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
import io.fabric8.kubernetes.api.model.PodList;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
import io.fabric8.kubernetes.api.model.ReplicationController;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
import io.fabric8.kubernetes.api.model.Service;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
import javax.ws.rs.Consumes;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
import javax.ws.rs.DELETE;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
import javax.ws.rs.GET;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
import javax.ws.rs.POST;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
import javax.ws.rs.PUT;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
import javax.ws.rs.Path;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
import javax.ws.rs.PathParam;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
import javax.ws.rs.Produces;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
"@Consumes(""application/json"")",bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
String createNamespace(Namespace entity) throws Exception;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
* Get a specific Namespace,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
* Update a namespace,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
* @param entity,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
* @param namespace,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
@PUT,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
import io.fabric8.kubernetes.api.model.*;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import javax.ws.rs.*;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
this.factory = factory;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
return kubernetes;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
kubernetesExtensions = getFactory().createKubernetesExtensions();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
kubernetesGlobalExtensions = getFactory().createKubernetesGlobalExtensions();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
factory = new KubernetesFactory();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
return factory;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
return getFactory().getAddress();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
"return getKubernetes().deletePod(podId, getNamespace());",bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
"return getKubernetes().deleteReplicationController(controllerId, getNamespace());",bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
WebClient webClient = getFactory().createWebClient();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
WebSocketClient client = getFactory().createWebSocketClient();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
KubernetesFactory factory = getFactory();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,0
private Kubernetes kubernetesWriteable;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
this.factoryReadOnly = factory;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
this.factoryReadOnly = factoryReadOnly;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
this.factoryWriteable = factoryWriteable;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
return getKubernetes(false);,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
public Kubernetes getKubernetes(boolean writeable) {,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
kubernetesWriteable = getFactory(true).createKubernetes();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
return kubernetesWriteable;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
return kubernetes;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
kubernetesExtensions = getFactory(true).createKubernetesExtensions();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
kubernetesGlobalExtensions = getFactory(true).createKubernetesGlobalExtensions();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
factoryWriteable = new KubernetesFactory(true);,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
return factoryWriteable;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
factoryReadOnly = new KubernetesFactory();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
return factoryReadOnly;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
this.factoryWriteable = factory;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
return getFactory(false).getAddress();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
return getFactory(true).getAddress();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
"return getWriteableKubernetes().deleteReplicationController(controllerId, getNamespace());",bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
WebClient webClient = getFactory(true).createWebClient();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
WebSocketClient client = getFactory(false).createWebSocketClient();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
KubernetesFactory factory = getFactory(true);,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
protected Kubernetes getWriteableKubernetes() {,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
return getKubernetes(true);,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import io.fabric8.kubernetes.api.KubernetesHelper;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import io.fabric8.kubernetes.api.model.Container;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import io.fabric8.kubernetes.api.model.Pod;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import io.fabric8.kubernetes.api.model.PodList;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import io.fabric8.kubernetes.api.model.PodSpec;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import io.fabric8.kubernetes.api.model.PodStatus;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import io.fabric8.utils.TablePrinter;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.context.UIContext;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.input.UIInput;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.result.Result;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.util.Categories;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.util.Metadata;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import javax.inject.Inject;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import java.util.Collections;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import java.util.List;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import java.util.Map;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
"return Metadata.from(super.getMetadata(context), getClass())",bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
".name(CATEGORY + "": Pod List"")",bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
TablePrinter table = podsAsTable(pods);,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
return tableResults(table);,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
TablePrinter table = new TablePrinter();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
List<Pod> items = pods.getItems();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
items = Collections.EMPTY_LIST;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
PodStatus podStatus = item.getStatus();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
status = KubernetesHelper.getStatusText(podStatus);,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
host = podStatus.getHostIP();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
PodSpec spec = item.getSpec();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
List<Container> containerList = spec.getContainers();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
"host = """";",bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
"status = """";",bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
"labels = """";",bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
return table;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import io.fabric8.kubernetes.api.KubernetesHelper;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import io.fabric8.kubernetes.api.model.ReplicationController;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.context.UIContext;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.input.UICompleter;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.input.UIInput;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.result.Result;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.util.Categories;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.util.Metadata;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import javax.inject.Inject;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import java.util.ArrayList;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import java.util.Collections;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import java.util.List;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
"return Metadata.from(super.getMetadata(context), getClass())",bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
"public Iterable<String> getCompletionProposals(UIContext context, InputComponent<?, String> input, String value) {",bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
List<String> list = new ArrayList<String>();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
List<ReplicationController> items = replicationControllers.getItems();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
return list;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
"System.out.println(""No replicationController for id: "" + idText);",bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
return null;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import io.fabric8.kubernetes.api.KubernetesHelper;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import io.fabric8.kubernetes.api.model.ReplicationController;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import io.fabric8.kubernetes.api.model.ReplicationControllerSpec;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import io.fabric8.kubernetes.api.model.ReplicationControllerStatus;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import io.fabric8.utils.TablePrinter;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.context.UIContext;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.input.UIInput;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.result.Result;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.util.Categories;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.util.Metadata;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import javax.inject.Inject;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import java.io.PrintStream;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import java.util.Collections;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import java.util.List;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
"return Metadata.from(super.getMetadata(context), getClass())",bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
return null;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
TablePrinter table = new TablePrinter();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
List<ReplicationController> items = replicationControllers.getItems();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
items = Collections.EMPTY_LIST;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
Integer replicas = null;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
ReplicationControllerSpec desiredState = item.getSpec();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
ReplicationControllerStatus currentState = item.getStatus();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
replicas = currentState.getReplicas();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
"table.row(id, labels, toPositiveNonZeroText(replicas), selector);",bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import io.fabric8.kubernetes.api.KubernetesHelper;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import io.fabric8.kubernetes.api.model.Service;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.context.UIContext;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.input.UICompleter;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.input.UIInput;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.result.Result;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.util.Categories;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.util.Metadata;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import javax.inject.Inject;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import java.util.ArrayList;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import java.util.Collections;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import java.util.List;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
"return Metadata.from(super.getMetadata(context), getClass())",bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
".name(CATEGORY + "": Service Delete"")",bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
"public Iterable<String> getCompletionProposals(UIContext context, InputComponent<?, String> input, String value) {",bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
List<String> list = new ArrayList<String>();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
List<Service> items = services.getItems();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
return list;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
"System.out.println(""No service for id: "" + idText);",bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
return null;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import io.fabric8.kubernetes.api.KubernetesHelper;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import io.fabric8.kubernetes.api.model.Service;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import io.fabric8.utils.Strings;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import io.fabric8.utils.TablePrinter;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.context.UIContext;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.input.UIInput;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.result.Result;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.util.Categories;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import org.jboss.forge.addon.ui.util.Metadata;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import javax.inject.Inject;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import java.io.PrintStream;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import java.util.ArrayList;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import java.util.Collections;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import java.util.List;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
import java.util.Set;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
"return Metadata.from(super.getMetadata(context), getClass())",bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
".name(CATEGORY + "": Service List"")",bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
return null;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
TablePrinter table = new TablePrinter();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
List<Service> items = services.getItems();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
items = Collections.EMPTY_LIST;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
for (Service service : items) {,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
Set<Integer> ports = getPorts(service);,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
List<Integer> portList = new ArrayList<>(ports);,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
String portText;,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
portText = portList.get(0).toString();,bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
"portText = Strings.join(portList, "", "");",bc5eedffd29f7921df7c0eec29cac742fc356951,1,1
if (Strings.isNotBlank(namespace)) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,0
},bc5eedffd29f7921df7c0eec29cac742fc356951,0,0
if (Strings.isNotBlank(namespace)) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,0
entity.setNamespace(namespace);,bc5eedffd29f7921df7c0eec29cac742fc356951,0,0
},bc5eedffd29f7921df7c0eec29cac742fc356951,0,0
deletePod(entity);,bc5eedffd29f7921df7c0eec29cac742fc356951,0,0
deleteService(entity);,bc5eedffd29f7921df7c0eec29cac742fc356951,0,0
replicationController.setNamespace(namespace);,bc5eedffd29f7921df7c0eec29cac742fc356951,0,0
deleteReplicationControllerAndPods(replicationController);,bc5eedffd29f7921df7c0eec29cac742fc356951,0,0
deleteReplicationController(replicationController);,bc5eedffd29f7921df7c0eec29cac742fc356951,0,0
@POST,bc5eedffd29f7921df7c0eec29cac742fc356951,0,0
"@Path(""namespaces"")",bc5eedffd29f7921df7c0eec29cac742fc356951,0,0
/**,bc5eedffd29f7921df7c0eec29cac742fc356951,0,0
*/,bc5eedffd29f7921df7c0eec29cac742fc356951,0,0
@GET,bc5eedffd29f7921df7c0eec29cac742fc356951,0,0
"@Path(""namespaces/{name}"")",bc5eedffd29f7921df7c0eec29cac742fc356951,0,0
* @param namespaceId,bc5eedffd29f7921df7c0eec29cac742fc356951,0,0
@DELETE,bc5eedffd29f7921df7c0eec29cac742fc356951,0,0
"@Consumes(""text/plain"")",bc5eedffd29f7921df7c0eec29cac742fc356951,0,0
private KubernetesFactory factory;,bc5eedffd29f7921df7c0eec29cac742fc356951,0,0
if (kubernetes == null) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,0
public KubernetesFactory getFactory() {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,0
if (factory == null) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,0
private KubernetesFactory factoryReadOnly;,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
private KubernetesFactory factoryWriteable;,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
},bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"public KubernetesClient(KubernetesFactory factoryReadOnly, KubernetesFactory factoryWriteable) {",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (writeable) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (kubernetesWriteable == null) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
} else {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (kubernetes == null) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
public KubernetesFactory getFactory(boolean writeable) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (factoryWriteable == null) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (factoryReadOnly == null) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
public void setWriteableFactory(KubernetesFactory factory) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"KubernetesHelper.setName(pod, name);",bc5eedffd29f7921df7c0eec29cac742fc356951,0,0
pod.getMetadata().setName(name);,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (serviceMap == null) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
},bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (replicationControllerMap == null) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (podMap == null) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
/**,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  Red Hat licenses this file to you under the Apache License, version",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*  with the License.  You may obtain a copy of the License at,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  Unless required by applicable law or agreed to in writing, software",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*  implied.  See the License for the specific language governing,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*  permissions and limitations under the License.,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*/,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
package io.fabric8.forge.kubernetes;,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
public class PodsList extends AbstractKubernetesCommand {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
@Inject,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
UIInput<String> filterText;,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
@Override,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
public UICommandMetadata getMetadata(UIContext context) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
.category(Categories.create(CATEGORY)),bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
},bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
public void initializeUI(UIBuilder builder) throws Exception {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
super.initializeUI(builder);,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
builder.add(filterText);,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
public Result execute(UIExecutionContext uiExecutionContext) throws Exception {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
KubernetesHelper.removeEmptyPods(pods);,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
protected TablePrinter podsAsTable(PodList pods) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"table.columns(""id"", ""image(s)"", ""host"", ""labels"", ""status"");",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (items == null) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
for (Pod item : items) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (filter.matches(item)) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (podStatus != null) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (spec != null) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
for (Container container : containerList) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"table.row(id, image, host, labels, status);",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
/**,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  Red Hat licenses this file to you under the Apache License, version",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*  with the License.  You may obtain a copy of the License at,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  Unless required by applicable law or agreed to in writing, software",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*  implied.  See the License for the specific language governing,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*  permissions and limitations under the License.,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*/,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
package io.fabric8.forge.kubernetes;,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
public class ReplicationControllerDelete extends AbstractKubernetesCommand {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
@Inject,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
UIInput<String> replicationControllerId;,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
@Override,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
public UICommandMetadata getMetadata(UIContext context) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
.category(Categories.create(CATEGORY)),bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
},bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
public void initializeUI(UIBuilder builder) throws Exception {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
super.initializeUI(builder);,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
// populate autocompletion options,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
replicationControllerId.setCompleter(new UICompleter<String>() {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (replicationControllers != null) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (items != null) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
for (ReplicationController item : items) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
list.add(id);,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
Collections.sort(list);,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
});,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
builder.add(replicationControllerId);,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
public Result execute(UIExecutionContext context) throws Exception {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (replicationController == null) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
} else {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
executeReplicationController(replicationController);,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
protected void executeReplicationController(ReplicationController replicationController) throws Exception {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
getKubernetes().replicationControllers().inNamespace(getNamespace()).withName(KubernetesHelper.getName(replicationController)).delete();,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
/**,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  Red Hat licenses this file to you under the Apache License, version",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*  with the License.  You may obtain a copy of the License at,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  Unless required by applicable law or agreed to in writing, software",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*  implied.  See the License for the specific language governing,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*  permissions and limitations under the License.,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*/,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
package io.fabric8.forge.kubernetes;,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
public class ReplicationControllersList extends AbstractKubernetesCommand {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
@Inject,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
UIInput<String> filterText;,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
@Override,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
public UICommandMetadata getMetadata(UIContext context) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
.category(Categories.create(CATEGORY)),bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
},bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
public void initializeUI(UIBuilder builder) throws Exception {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
super.initializeUI(builder);,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
builder.add(filterText);,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
public Result execute(UIExecutionContext uiExecutionContext) throws Exception {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"printReplicationControllers(replicationControllers, System.out);",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"private void printReplicationControllers(ReplicationControllerList replicationControllers, PrintStream out) {",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"table.columns(""id"", ""labels"", ""replicas"", ""replica selector"");",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (items == null) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
for (ReplicationController item : items) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (filter.matches(item)) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (desiredState != null) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (currentState != null) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
table.print();,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
/**,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  Red Hat licenses this file to you under the Apache License, version",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*  with the License.  You may obtain a copy of the License at,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  Unless required by applicable law or agreed to in writing, software",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*  implied.  See the License for the specific language governing,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*  permissions and limitations under the License.,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*/,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
package io.fabric8.forge.kubernetes;,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
public class ServiceDelete extends AbstractKubernetesCommand {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
@Inject,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
UIInput<String> serviceId;,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
@Override,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
public UICommandMetadata getMetadata(UIContext context) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
.category(Categories.create(CATEGORY)),bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
},bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
public void initializeUI(UIBuilder builder) throws Exception {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
super.initializeUI(builder);,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
// populate autocompletion options,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
serviceId.setCompleter(new UICompleter<String>() {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (services != null) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (items != null) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
for (Service item : items) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
list.add(id);,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
Collections.sort(list);,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
});,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
builder.add(serviceId);,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
public Result execute(UIExecutionContext context) throws Exception {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (service == null) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
} else {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
executeService(service);,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
protected void executeService(Service service) throws Exception {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
getKubernetes().services().inNamespace(getNamespace()).withName(KubernetesHelper.getName(service)).delete();,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
/**,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  Red Hat licenses this file to you under the Apache License, version",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*  with the License.  You may obtain a copy of the License at,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  Unless required by applicable law or agreed to in writing, software",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*  implied.  See the License for the specific language governing,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*  permissions and limitations under the License.,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
*/,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
package io.fabric8.forge.kubernetes;,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
public class ServicesList extends AbstractKubernetesCommand {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
@Inject,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
UIInput<String> filterText;,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
@Override,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
public UICommandMetadata getMetadata(UIContext context) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
.category(Categories.create(CATEGORY)),bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
},bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
public void initializeUI(UIBuilder builder) throws Exception {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
super.initializeUI(builder);,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
builder.add(filterText);,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
public Result execute(UIExecutionContext uiExecutionContext) throws Exception {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"printServices(services, System.out);",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"private void printServices(ServiceList services, PrintStream out) {",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"table.columns(""id"", ""labels"", ""selector"", ""port"");",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (items == null) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (filter.matches(service)) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
if (portList.size() == 1) {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
} else {,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"table.row(KubernetesHelper.getName(service), labels, selector, portText);",bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
table.print();,bc5eedffd29f7921df7c0eec29cac742fc356951,0,1
"public static boolean isDefaultValue(CamelCatalog camelCatalog, String scheme, String key, String value) {",465387641dcd86fe992fa1252d519b9b613fab73,6,1
"public static String CATEGORY = ""Camel"";",465387641dcd86fe992fa1252d519b9b613fab73,5,1
"public static DataFormatDto createDataFormatDto(CamelCatalog camelCatalog, String name) {",465387641dcd86fe992fa1252d519b9b613fab73,4,0
if (json == null) {,465387641dcd86fe992fa1252d519b9b613fab73,4,0
public static String findDataFormatArchetype(String name) {,465387641dcd86fe992fa1252d519b9b613fab73,4,1
"if (name == null || name.startsWith(""camel-"")) {",465387641dcd86fe992fa1252d519b9b613fab73,4,1
if (json == null) {,465387641dcd86fe992fa1252d519b9b613fab73,4,1
public static String findLanguageArchetype(String name) {,465387641dcd86fe992fa1252d519b9b613fab73,4,1
"if (name == null || name.startsWith(""camel-"")) {",465387641dcd86fe992fa1252d519b9b613fab73,4,1
if (json == null) {,465387641dcd86fe992fa1252d519b9b613fab73,4,1
public static String getDataFormatDescription(String dataFormat) {,465387641dcd86fe992fa1252d519b9b613fab73,4,1
public static String getLanguageDescription(String language) {,465387641dcd86fe992fa1252d519b9b613fab73,4,1
"public static String CATEGORY_CATALOG = ""CamelCatalog"";",465387641dcd86fe992fa1252d519b9b613fab73,4,1
"@WithAttributes(label = ""verbose"", required = false, defaultValue = ""false"", description = ""Verbose output"")",465387641dcd86fe992fa1252d519b9b613fab73,4,1
if (url == null) {,465387641dcd86fe992fa1252d519b9b613fab73,4,1
"@WithAttributes(label = ""verbose"", required = false, defaultValue = ""false"", description = ""Verbose output"")",465387641dcd86fe992fa1252d519b9b613fab73,4,1
if (url == null) {,465387641dcd86fe992fa1252d519b9b613fab73,4,1
"@WithAttributes(label = ""verbose"", required = false, defaultValue = ""false"", description = ""Verbose output"")",465387641dcd86fe992fa1252d519b9b613fab73,4,1
if (url == null) {,465387641dcd86fe992fa1252d519b9b613fab73,4,1
"@WithAttributes(label = ""verbose"", required = false, defaultValue = ""false"", description = ""Verbose output"")",465387641dcd86fe992fa1252d519b9b613fab73,4,1
if (url == null) {,465387641dcd86fe992fa1252d519b9b613fab73,4,1
if (cachedArchetypes == null) {,465387641dcd86fe992fa1252d519b9b613fab73,4,1
String xml = new DefaultCamelCatalog().archetypeCatalogAsXml();,465387641dcd86fe992fa1252d519b9b613fab73,4,1
if (core == null) {,465387641dcd86fe992fa1252d519b9b613fab73,4,1
if (value == null || name.startsWith(value)) {,465387641dcd86fe992fa1252d519b9b613fab73,4,1
if (core == null) {,465387641dcd86fe992fa1252d519b9b613fab73,4,1
if (value == null || name.startsWith(value)) {,465387641dcd86fe992fa1252d519b9b613fab73,4,1
if (core == null) {,465387641dcd86fe992fa1252d519b9b613fab73,4,1
if (value == null || name.startsWith(value)) {,465387641dcd86fe992fa1252d519b9b613fab73,4,1
public static String asTitleCase(String text) {,465387641dcd86fe992fa1252d519b9b613fab73,4,1
public static String endpointComponentName(String uri) {,465387641dcd86fe992fa1252d519b9b613fab73,4,1
"public static Set<String> componentsFromArtifact(CamelCatalog camelCatalog, String artifactId) {",465387641dcd86fe992fa1252d519b9b613fab73,4,1
"public static Set<String> dataFormatsFromArtifact(CamelCatalog camelCatalog, String artifactId) {",465387641dcd86fe992fa1252d519b9b613fab73,4,1
"public static Set<String> languagesFromArtifact(CamelCatalog camelCatalog, String artifactId) {",465387641dcd86fe992fa1252d519b9b613fab73,4,1
if (json == null) {,465387641dcd86fe992fa1252d519b9b613fab73,4,1
"public static boolean isComponentConsumerOnly(CamelCatalog camelCatalog, String scheme) {",465387641dcd86fe992fa1252d519b9b613fab73,4,1
"public static boolean isComponentProducerOnly(CamelCatalog camelCatalog, String scheme) {",465387641dcd86fe992fa1252d519b9b613fab73,4,1
"public static ComponentDto createComponentDto(CamelCatalog camelCatalog, String scheme) {",465387641dcd86fe992fa1252d519b9b613fab73,4,1
"public static DataFormatDto createDataFormatDto(CamelCatalog camelCatalog, String name) {",465387641dcd86fe992fa1252d519b9b613fab73,4,1
"public static LanguageDto createLanguageDto(CamelCatalog camelCatalog, String name) {",465387641dcd86fe992fa1252d519b9b613fab73,4,1
"if (row.get(""name"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,0
"} else if (row.get(""modelName"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,0
"} else if (row.get(""title"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,0
"} else if (row.get(""description"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,0
"} else if (row.get(""label"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,0
"} else if (row.get(""javaType"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,0
"} else if (row.get(""modelJavaType"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,0
"} else if (row.get(""groupId"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,0
"} else if (row.get(""artifactId"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,0
"} else if (row.get(""version"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,0
"* @return the archetype name, or <tt>null</tt> if not possible to find a valid archetype name",465387641dcd86fe992fa1252d519b9b613fab73,3,1
// use the camel catalog to lookup the dataformat name -> artifact id,465387641dcd86fe992fa1252d519b9b613fab73,3,1
CamelCatalog catalog = new DefaultCamelCatalog();,465387641dcd86fe992fa1252d519b9b613fab73,3,1
"if (row.get(""artifactId"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,1
* Attempts to find the maven archetype name for the given Camel language name.,465387641dcd86fe992fa1252d519b9b613fab73,3,1
"* @return the archetype name, or <tt>null</tt> if not possible to find a valid archetype name",465387641dcd86fe992fa1252d519b9b613fab73,3,1
// use the camel catalog to lookup the language name -> artifact id,465387641dcd86fe992fa1252d519b9b613fab73,3,1
CamelCatalog catalog = new DefaultCamelCatalog();,465387641dcd86fe992fa1252d519b9b613fab73,3,1
"if (row.get(""artifactId"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,1
if (data != null) {,465387641dcd86fe992fa1252d519b9b613fab73,3,1
if (description != null) {,465387641dcd86fe992fa1252d519b9b613fab73,3,1
"@WithAttributes(label = ""label"", required = false, description = ""To filter components by their label(s), such as database"")",465387641dcd86fe992fa1252d519b9b613fab73,3,1
"@WithAttributes(label = ""label"", required = false, description = ""To filter dataformats by their label(s), such as xml"")",465387641dcd86fe992fa1252d519b9b613fab73,3,1
"@WithAttributes(label = ""label"", required = false, description = ""To filter EIPs by their label(s), such as transformation"")",465387641dcd86fe992fa1252d519b9b613fab73,3,1
"@WithAttributes(label = ""label"", required = false, description = ""To filter languages by their label(s), such as xml"")",465387641dcd86fe992fa1252d519b9b613fab73,3,1
"private static final String NAME = ""camel"";",465387641dcd86fe992fa1252d519b9b613fab73,3,1
public String toString() {,465387641dcd86fe992fa1252d519b9b613fab73,3,1
public String getName() {,465387641dcd86fe992fa1252d519b9b613fab73,3,1
if (xml != null) {,465387641dcd86fe992fa1252d519b9b613fab73,3,1
if (o == null || getClass() != o.getClass()) return false;,465387641dcd86fe992fa1252d519b9b613fab73,3,1
"public Iterable<String> getCompletionProposals(UIContext context, InputComponent input, String value) {",465387641dcd86fe992fa1252d519b9b613fab73,3,1
"public Iterable<DataFormatDto> getCompletionProposals(UIContext context, InputComponent input, String value) {",465387641dcd86fe992fa1252d519b9b613fab73,3,1
if (artifactId != null) {,465387641dcd86fe992fa1252d519b9b613fab73,3,1
private static String findArtifactId(String json) {,465387641dcd86fe992fa1252d519b9b613fab73,3,1
"if (row.get(""artifactId"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,1
"public Iterable<LanguageDto> getCompletionProposals(UIContext context, InputComponent input, String value) {",465387641dcd86fe992fa1252d519b9b613fab73,3,1
if (artifactId != null) {,465387641dcd86fe992fa1252d519b9b613fab73,3,1
private static String findArtifactId(String json) {,465387641dcd86fe992fa1252d519b9b613fab73,3,1
"if (row.get(""artifactId"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,1
if (uri != null) {,465387641dcd86fe992fa1252d519b9b613fab73,3,1
if (json != null) {,465387641dcd86fe992fa1252d519b9b613fab73,3,1
"if (row.get(""artifactId"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,1
"if (row.get(""scheme"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,1
if (artifactId.equals(artifact) && scheme != null) {,465387641dcd86fe992fa1252d519b9b613fab73,3,1
"if (row.get(""name"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,1
if (artifactId.equals(artifact) && df != null) {,465387641dcd86fe992fa1252d519b9b613fab73,3,1
if (artifactId.equals(artifact) && lan != null) {,465387641dcd86fe992fa1252d519b9b613fab73,3,1
"throw new IllegalArgumentException(""Could not find catalog entry for component name: "" + scheme);",465387641dcd86fe992fa1252d519b9b613fab73,3,1
if (data != null) {,465387641dcd86fe992fa1252d519b9b613fab73,3,1
if (consumerOnly != null) {,465387641dcd86fe992fa1252d519b9b613fab73,3,1
"} else if (row.get(""syntax"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,1
"} else if (row.get(""title"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,1
"} else if (row.get(""description"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,1
"} else if (row.get(""label"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,1
"} else if (row.get(""javaType"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,1
"} else if (row.get(""groupId"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,1
"} else if (row.get(""artifactId"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,1
"} else if (row.get(""version"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,1
"} else if (row.get(""modelName"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,1
"} else if (row.get(""modelJavaType"") != null) {",465387641dcd86fe992fa1252d519b9b613fab73,3,1
// use the camel catalog,465387641dcd86fe992fa1252d519b9b613fab73,2,0
String json = camelCatalog.dataFormatJSonSchema(name);,465387641dcd86fe992fa1252d519b9b613fab73,2,0
DataFormatDto dto = new DataFormatDto();,465387641dcd86fe992fa1252d519b9b613fab73,2,0
* Attempts to find the maven archetype name for the given Camel data format name.,465387641dcd86fe992fa1252d519b9b613fab73,2,1
// return the name as-is if its already an archetype syntax,465387641dcd86fe992fa1252d519b9b613fab73,2,1
String json = catalog.dataFormatJSonSchema(name);,465387641dcd86fe992fa1252d519b9b613fab73,2,1
"* @param name the language name, such as <tt>spel</tt> which has the archetype name <tt>camel-spring</tt>",465387641dcd86fe992fa1252d519b9b613fab73,2,1
// return the name as-is if its already an archetype syntax,465387641dcd86fe992fa1252d519b9b613fab73,2,1
String json = catalog.languageJSonSchema(name);,465387641dcd86fe992fa1252d519b9b613fab73,2,1
// use the camel catalog,465387641dcd86fe992fa1252d519b9b613fab73,2,1
String json = catalog.dataFormatJSonSchema(dataFormat);,465387641dcd86fe992fa1252d519b9b613fab73,2,1
"String description = propertyMap.get(""description"");",465387641dcd86fe992fa1252d519b9b613fab73,2,1
* @param language the language name,465387641dcd86fe992fa1252d519b9b613fab73,2,1
String json = catalog.languageJSonSchema(language);,465387641dcd86fe992fa1252d519b9b613fab73,2,1
public abstract class AbstractJolokiaCommand extends AbstractProjectCommand {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
public boolean isEnabled(UIContext context) {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
public void initializeUI(UIBuilder builder) throws Exception {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
protected String getJolokiaUrl() {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
JolokiaCamelController controller = new DefaultJolokiaCamelController();,465387641dcd86fe992fa1252d519b9b613fab73,2,1
"String username = configuration.getString(""CamelJolokiaUsername"");",465387641dcd86fe992fa1252d519b9b613fab73,2,1
"String password = configuration.getString(""CamelJolokiaPassword"");",465387641dcd86fe992fa1252d519b9b613fab73,2,1
public class CatalogComponentListCommand extends AbstractJolokiaCommand {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
public UICommandMetadata getMetadata(UIContext context) {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
".description(""Lists all Camel components from the Camel catalog"");",465387641dcd86fe992fa1252d519b9b613fab73,2,1
public void initializeUI(UIBuilder builder) throws Exception {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
public Result execute(UIExecutionContext context) throws Exception {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
String url = getJolokiaUrl();,465387641dcd86fe992fa1252d519b9b613fab73,2,1
"org.apache.camel.commands.CatalogComponentListCommand command = new org.apache.camel.commands.CatalogComponentListCommand(val, label.getValue());",465387641dcd86fe992fa1252d519b9b613fab73,2,1
public class CatalogDataFormatListCommand extends AbstractJolokiaCommand {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
public UICommandMetadata getMetadata(UIContext context) {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
".description(""Lists all Camel dataformats from the Camel catalog"");",465387641dcd86fe992fa1252d519b9b613fab73,2,1
public void initializeUI(UIBuilder builder) throws Exception {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
public Result execute(UIExecutionContext context) throws Exception {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
String url = getJolokiaUrl();,465387641dcd86fe992fa1252d519b9b613fab73,2,1
"org.apache.camel.commands.CatalogDataFormatListCommand command = new org.apache.camel.commands.CatalogDataFormatListCommand(val, label.getValue());",465387641dcd86fe992fa1252d519b9b613fab73,2,1
public class CatalogEipListCommand extends AbstractJolokiaCommand {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
public UICommandMetadata getMetadata(UIContext context) {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
".description(""Lists all Camel EIPs from the Camel catalog"");",465387641dcd86fe992fa1252d519b9b613fab73,2,1
public void initializeUI(UIBuilder builder) throws Exception {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
public Result execute(UIExecutionContext context) throws Exception {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
String url = getJolokiaUrl();,465387641dcd86fe992fa1252d519b9b613fab73,2,1
"org.apache.camel.commands.CatalogEipListCommand command = new org.apache.camel.commands.CatalogEipListCommand(val, label.getValue());",465387641dcd86fe992fa1252d519b9b613fab73,2,1
public class CatalogLanguageListCommand extends AbstractJolokiaCommand {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
public UICommandMetadata getMetadata(UIContext context) {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
".description(""Lists all Camel languages from the Camel catalog"");",465387641dcd86fe992fa1252d519b9b613fab73,2,1
public void initializeUI(UIBuilder builder) throws Exception {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
public Result execute(UIExecutionContext context) throws Exception {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
String url = getJolokiaUrl();,465387641dcd86fe992fa1252d519b9b613fab73,2,1
"org.apache.camel.commands.CatalogLanguageListCommand command = new org.apache.camel.commands.CatalogLanguageListCommand(val, label.getValue());",465387641dcd86fe992fa1252d519b9b613fab73,2,1
public class CamelArchetypeCatalogFactory implements ArchetypeCatalogFactory {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
public ArchetypeCatalog getArchetypeCatalog() {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
// use the camel catalog to load the archetypes,465387641dcd86fe992fa1252d519b9b613fab73,2,1
cachedArchetypes = new ArchetypeCatalogXpp3Reader().read(new StringReader(xml));,465387641dcd86fe992fa1252d519b9b613fab73,2,1
public boolean equals(Object o) {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
if (this == o) return true;,465387641dcd86fe992fa1252d519b9b613fab73,2,1
public int hashCode() {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
public class CamelComponentsLabelCompleter implements UICompleter<String> {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
"public CamelComponentsLabelCompleter(Project project, CamelCatalog camelCatalog) {",465387641dcd86fe992fa1252d519b9b613fab73,2,1
List<String> filtered = new ArrayList<String>();,465387641dcd86fe992fa1252d519b9b613fab73,2,1
public Iterable<String> getValueChoices() {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
import static io.fabric8.forge.addon.utils.CamelProjectHelper.findCamelArtifacts;,465387641dcd86fe992fa1252d519b9b613fab73,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createDataFormatDto;,465387641dcd86fe992fa1252d519b9b613fab73,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.dataFormatsFromArtifact;,465387641dcd86fe992fa1252d519b9b613fab73,2,1
public class CamelDataFormatsCompleter implements UICompleter<DataFormatDto> {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
"public CamelDataFormatsCompleter(Project project, CamelCatalog camelCatalog) {",465387641dcd86fe992fa1252d519b9b613fab73,2,1
List<DataFormatDto> answer = new ArrayList<>();,465387641dcd86fe992fa1252d519b9b613fab73,2,1
List<String> filtered = new ArrayList<String>();,465387641dcd86fe992fa1252d519b9b613fab73,2,1
String json = camelCatalog.dataFormatJSonSchema(name);,465387641dcd86fe992fa1252d519b9b613fab73,2,1
String artifactId = findArtifactId(json);,465387641dcd86fe992fa1252d519b9b613fab73,2,1
if (!already) {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
public Iterable<DataFormatDto> getValueChoices() {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
import static io.fabric8.forge.addon.utils.CamelProjectHelper.findCamelArtifacts;,465387641dcd86fe992fa1252d519b9b613fab73,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createLanguageDto;,465387641dcd86fe992fa1252d519b9b613fab73,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.languagesFromArtifact;,465387641dcd86fe992fa1252d519b9b613fab73,2,1
public class CamelLanguagesCompleter implements UICompleter<LanguageDto> {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
"public CamelLanguagesCompleter(Project project, CamelCatalog camelCatalog) {",465387641dcd86fe992fa1252d519b9b613fab73,2,1
List<LanguageDto> answer = new ArrayList<>();,465387641dcd86fe992fa1252d519b9b613fab73,2,1
List<String> filtered = new ArrayList<String>();,465387641dcd86fe992fa1252d519b9b613fab73,2,1
String json = camelCatalog.languageJSonSchema(name);,465387641dcd86fe992fa1252d519b9b613fab73,2,1
String artifactId = findArtifactId(json);,465387641dcd86fe992fa1252d519b9b613fab73,2,1
if (!already) {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
public Iterable<LanguageDto> getValueChoices() {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
public final class CamelCatalogHelper {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
StringBuilder sb = new StringBuilder();,465387641dcd86fe992fa1252d519b9b613fab73,2,1
if (Character.isSpaceChar(c)) {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
} else if (next) {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
if (idx > 0) {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
Set<String> answer = new TreeSet<String>();,465387641dcd86fe992fa1252d519b9b613fab73,2,1
// use the camel catalog to find what components the artifact has,465387641dcd86fe992fa1252d519b9b613fab73,2,1
String json = camelCatalog.componentJSonSchema(name);,465387641dcd86fe992fa1252d519b9b613fab73,2,1
String scheme = null;,465387641dcd86fe992fa1252d519b9b613fab73,2,1
String artifact = null;,465387641dcd86fe992fa1252d519b9b613fab73,2,1
String json = camelCatalog.dataFormatJSonSchema(name);,465387641dcd86fe992fa1252d519b9b613fab73,2,1
String df = null;,465387641dcd86fe992fa1252d519b9b613fab73,2,1
String json = camelCatalog.languageJSonSchema(name);,465387641dcd86fe992fa1252d519b9b613fab73,2,1
String lan = null;,465387641dcd86fe992fa1252d519b9b613fab73,2,1
// use the camel catalog,465387641dcd86fe992fa1252d519b9b613fab73,2,1
String json = camelCatalog.componentJSonSchema(scheme);,465387641dcd86fe992fa1252d519b9b613fab73,2,1
"String name = propertyMap.get(""name"");",465387641dcd86fe992fa1252d519b9b613fab73,2,1
"String defaultValue = propertyMap.get(""defaultValue"");",465387641dcd86fe992fa1252d519b9b613fab73,2,1
if (key.equals(name)) {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
"String consumerOnly = propertyMap.get(""consumerOnly"");",465387641dcd86fe992fa1252d519b9b613fab73,2,1
"String consumerOnly = propertyMap.get(""producerOnly"");",465387641dcd86fe992fa1252d519b9b613fab73,2,1
ComponentDto dto = new ComponentDto();,465387641dcd86fe992fa1252d519b9b613fab73,2,1
"String labelText = row.get(""label"");",465387641dcd86fe992fa1252d519b9b613fab73,2,1
if (Strings.isNotBlank(labelText)) {,465387641dcd86fe992fa1252d519b9b613fab73,2,1
DataFormatDto dto = new DataFormatDto();,465387641dcd86fe992fa1252d519b9b613fab73,2,1
LanguageDto dto = new LanguageDto();,465387641dcd86fe992fa1252d519b9b613fab73,2,1
import io.fabric8.forge.camel.commands.project.dto.DataFormatDto;,465387641dcd86fe992fa1252d519b9b613fab73,1,0
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""dataformat"", json, false);",465387641dcd86fe992fa1252d519b9b613fab73,1,0
"for (Map<String, String> row : data) {",465387641dcd86fe992fa1252d519b9b613fab73,1,0
"* @param name the data format name, such as <tt>json-jackson</tt> which has the archetype name <tt>camel-jackson</tt>",465387641dcd86fe992fa1252d519b9b613fab73,1,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""dataformat"", json, false);",465387641dcd86fe992fa1252d519b9b613fab73,1,1
"for (Map<String, String> row : data) {",465387641dcd86fe992fa1252d519b9b613fab73,1,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""language"", json, false);",465387641dcd86fe992fa1252d519b9b613fab73,1,1
"for (Map<String, String> row : data) {",465387641dcd86fe992fa1252d519b9b613fab73,1,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""dataformat"", json, false);",465387641dcd86fe992fa1252d519b9b613fab73,1,1
"for (Map<String, String> propertyMap : data) {",465387641dcd86fe992fa1252d519b9b613fab73,1,1
*  implied.  See the License for the specific language governing,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import java.io.PrintStream;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import javax.inject.Inject;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.apache.camel.commands.jolokia.DefaultJolokiaCamelController;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.apache.camel.commands.jolokia.JolokiaCamelController;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.configuration.Configuration;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.projects.ProjectFactory;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.projects.ui.AbstractProjectCommand;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.context.UIContext;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
* Base class for all Jolokia Camel commands.,465387641dcd86fe992fa1252d519b9b613fab73,1,1
protected boolean isProjectRequired() {,465387641dcd86fe992fa1252d519b9b613fab73,1,1
protected ProjectFactory getProjectFactory() {,465387641dcd86fe992fa1252d519b9b613fab73,1,1
protected JolokiaCamelController getController() throws Exception {,465387641dcd86fe992fa1252d519b9b613fab73,1,1
protected PrintStream getOutput(UIExecutionContext context) {,465387641dcd86fe992fa1252d519b9b613fab73,1,1
protected PrintStream getError(UIExecutionContext context) {,465387641dcd86fe992fa1252d519b9b613fab73,1,1
*  implied.  See the License for the specific language governing,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import javax.inject.Inject;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.context.UIContext;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.input.UIInput;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.result.Result;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.result.Results;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.util.Categories;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.util.Metadata;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
"boolean val = ""true"".equals(verbose.getValue());",465387641dcd86fe992fa1252d519b9b613fab73,1,1
*  implied.  See the License for the specific language governing,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import javax.inject.Inject;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.context.UIContext;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.input.UIInput;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.result.Result;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.result.Results;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.util.Categories;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.util.Metadata;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
"boolean val = ""true"".equals(verbose.getValue());",465387641dcd86fe992fa1252d519b9b613fab73,1,1
*  implied.  See the License for the specific language governing,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import javax.inject.Inject;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.context.UIContext;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.input.UIInput;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.result.Result;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.result.Results;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.util.Categories;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.util.Metadata;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
"boolean val = ""true"".equals(verbose.getValue());",465387641dcd86fe992fa1252d519b9b613fab73,1,1
*  implied.  See the License for the specific language governing,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import javax.inject.Inject;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.context.UIContext;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.input.UIInput;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.result.Result;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.result.Results;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.util.Categories;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.util.Metadata;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
"boolean val = ""true"".equals(verbose.getValue());",465387641dcd86fe992fa1252d519b9b613fab73,1,1
*  implied.  See the License for the specific language governing,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import java.io.StringReader;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import java.util.logging.Level;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import java.util.logging.Logger;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.apache.camel.catalog.DefaultCamelCatalog;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.apache.maven.archetype.catalog.ArchetypeCatalog;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.apache.maven.archetype.catalog.io.xpp3.ArchetypeCatalogXpp3Reader;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.maven.archetype.ArchetypeCatalogFactory;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
* The Apache Camel archetypes,465387641dcd86fe992fa1252d519b9b613fab73,1,1
private final Logger logger = Logger.getLogger(getClass().getName());,465387641dcd86fe992fa1252d519b9b613fab73,1,1
try {,465387641dcd86fe992fa1252d519b9b613fab73,1,1
} catch (Exception e) {,465387641dcd86fe992fa1252d519b9b613fab73,1,1
CamelArchetypeCatalogFactory that = (CamelArchetypeCatalogFactory) o;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
if (!NAME.equals(that.NAME)) return false;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
*  implied.  See the License for the specific language governing,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import java.util.ArrayList;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import java.util.List;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import java.util.Set;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import io.fabric8.forge.addon.utils.CamelProjectHelper;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.apache.camel.catalog.CamelCatalog;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.dependencies.Dependency;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.projects.Project;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.context.UIContext;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.input.UICompleter;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
this.project = project;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
this.camelCatalog = camelCatalog;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
// need to find camel-core so we known the camel version,465387641dcd86fe992fa1252d519b9b613fab73,1,1
this.core = CamelProjectHelper.findCamelCoreDependency(project);,465387641dcd86fe992fa1252d519b9b613fab73,1,1
// find all available component labels,465387641dcd86fe992fa1252d519b9b613fab73,1,1
Iterable<String> names = getValueChoices();,465387641dcd86fe992fa1252d519b9b613fab73,1,1
for (String name : names) {,465387641dcd86fe992fa1252d519b9b613fab73,1,1
Set<String> names = camelCatalog.findComponentLabels();,465387641dcd86fe992fa1252d519b9b613fab73,1,1
*  implied.  See the License for the specific language governing,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import java.util.ArrayList;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import java.util.List;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import java.util.Map;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import java.util.Set;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import io.fabric8.forge.addon.utils.CamelProjectHelper;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import io.fabric8.forge.camel.commands.project.dto.DataFormatDto;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.apache.camel.catalog.CamelCatalog;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.apache.camel.catalog.JSonSchemaHelper;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.dependencies.Dependency;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.projects.Project;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.context.UIContext;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.input.UICompleter;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
this.project = project;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
this.camelCatalog = camelCatalog;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
// need to find camel-core so we known the camel version,465387641dcd86fe992fa1252d519b9b613fab73,1,1
core = CamelProjectHelper.findCamelCoreDependency(project);,465387641dcd86fe992fa1252d519b9b613fab73,1,1
// find all available dataformat names,465387641dcd86fe992fa1252d519b9b613fab73,1,1
List<String> names = camelCatalog.findDataFormatNames();,465387641dcd86fe992fa1252d519b9b613fab73,1,1
for (String name : names) {,465387641dcd86fe992fa1252d519b9b613fab73,1,1
for (String name : filtered) {,465387641dcd86fe992fa1252d519b9b613fab73,1,1
// skip if we already have the dependency,465387641dcd86fe992fa1252d519b9b613fab73,1,1
boolean already = false;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
"already = CamelProjectHelper.hasDependency(project, ""org.apache.camel"", artifactId);",465387641dcd86fe992fa1252d519b9b613fab73,1,1
"DataFormatDto dto = createDataFormatDto(camelCatalog, json);",465387641dcd86fe992fa1252d519b9b613fab73,1,1
Set<Dependency> artifacts = findCamelArtifacts(project);,465387641dcd86fe992fa1252d519b9b613fab73,1,1
for (Dependency dep : artifacts) {,465387641dcd86fe992fa1252d519b9b613fab73,1,1
"Set<String> languages = dataFormatsFromArtifact(camelCatalog, dep.getCoordinate().getArtifactId());",465387641dcd86fe992fa1252d519b9b613fab73,1,1
"DataFormatDto dto = createDataFormatDto(camelCatalog, name);",465387641dcd86fe992fa1252d519b9b613fab73,1,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""dataformat"", json, false);",465387641dcd86fe992fa1252d519b9b613fab73,1,1
"for (Map<String, String> row : data) {",465387641dcd86fe992fa1252d519b9b613fab73,1,1
*  implied.  See the License for the specific language governing,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import java.util.ArrayList;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import java.util.List;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import java.util.Map;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import java.util.Set;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import io.fabric8.forge.addon.utils.CamelProjectHelper;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import io.fabric8.forge.camel.commands.project.dto.LanguageDto;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.apache.camel.catalog.CamelCatalog;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.apache.camel.catalog.JSonSchemaHelper;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.dependencies.Dependency;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.projects.Project;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.context.UIContext;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.jboss.forge.addon.ui.input.UICompleter;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
this.project = project;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
this.camelCatalog = camelCatalog;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
// need to find camel-core so we known the camel version,465387641dcd86fe992fa1252d519b9b613fab73,1,1
core = CamelProjectHelper.findCamelCoreDependency(project);,465387641dcd86fe992fa1252d519b9b613fab73,1,1
// find all available language names,465387641dcd86fe992fa1252d519b9b613fab73,1,1
List<String> names = camelCatalog.findLanguageNames();,465387641dcd86fe992fa1252d519b9b613fab73,1,1
for (String name : names) {,465387641dcd86fe992fa1252d519b9b613fab73,1,1
for (String name : filtered) {,465387641dcd86fe992fa1252d519b9b613fab73,1,1
// skip if we already have the dependency,465387641dcd86fe992fa1252d519b9b613fab73,1,1
boolean already = false;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
"already = CamelProjectHelper.hasDependency(project, ""org.apache.camel"", artifactId);",465387641dcd86fe992fa1252d519b9b613fab73,1,1
"LanguageDto dto = createLanguageDto(camelCatalog, json);",465387641dcd86fe992fa1252d519b9b613fab73,1,1
Set<Dependency> artifacts = findCamelArtifacts(project);,465387641dcd86fe992fa1252d519b9b613fab73,1,1
for (Dependency dep : artifacts) {,465387641dcd86fe992fa1252d519b9b613fab73,1,1
"Set<String> languages = languagesFromArtifact(camelCatalog, dep.getCoordinate().getArtifactId());",465387641dcd86fe992fa1252d519b9b613fab73,1,1
"LanguageDto dto = createLanguageDto(camelCatalog, name);",465387641dcd86fe992fa1252d519b9b613fab73,1,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""language"", json, false);",465387641dcd86fe992fa1252d519b9b613fab73,1,1
"for (Map<String, String> row : data) {",465387641dcd86fe992fa1252d519b9b613fab73,1,1
*  implied.  See the License for the specific language governing,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import java.util.List;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import java.util.Map;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import java.util.Set;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import java.util.TreeSet;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import io.fabric8.forge.camel.commands.project.dto.DataFormatDto;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import io.fabric8.forge.camel.commands.project.dto.LanguageDto;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import io.fabric8.utils.Strings;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.apache.camel.catalog.CamelCatalog;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
import org.apache.camel.catalog.JSonSchemaHelper;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
boolean next = true;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
for (char c : text.toCharArray()) {,465387641dcd86fe992fa1252d519b9b613fab73,1,1
next = true;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
c = Character.toTitleCase(c);,465387641dcd86fe992fa1252d519b9b613fab73,1,1
next = false;,465387641dcd86fe992fa1252d519b9b613fab73,1,1
"int idx = uri.indexOf("":"");",465387641dcd86fe992fa1252d519b9b613fab73,1,1
for (String name : camelCatalog.findComponentNames()) {,465387641dcd86fe992fa1252d519b9b613fab73,1,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""component"", json, false);",465387641dcd86fe992fa1252d519b9b613fab73,1,1
"for (Map<String, String> row : data) {",465387641dcd86fe992fa1252d519b9b613fab73,1,1
"artifact = row.get(""artifactId"");",465387641dcd86fe992fa1252d519b9b613fab73,1,1
"scheme = row.get(""scheme"");",465387641dcd86fe992fa1252d519b9b613fab73,1,1
for (String name : camelCatalog.findDataFormatNames()) {,465387641dcd86fe992fa1252d519b9b613fab73,1,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""dataformat"", json, false);",465387641dcd86fe992fa1252d519b9b613fab73,1,1
"df = row.get(""name"");",465387641dcd86fe992fa1252d519b9b613fab73,1,1
for (String name : camelCatalog.findLanguageNames()) {,465387641dcd86fe992fa1252d519b9b613fab73,1,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""language"", json, false);",465387641dcd86fe992fa1252d519b9b613fab73,1,1
"lan = row.get(""name"");",465387641dcd86fe992fa1252d519b9b613fab73,1,1
* @param scheme the component name,465387641dcd86fe992fa1252d519b9b613fab73,1,1
"* @return <tt>true</tt> if matching the default value, <tt>false</tt> otherwise",465387641dcd86fe992fa1252d519b9b613fab73,1,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""properties"", json, true);",465387641dcd86fe992fa1252d519b9b613fab73,1,1
"for (Map<String, String> propertyMap : data) {",465387641dcd86fe992fa1252d519b9b613fab73,1,1
* Whether the component is consumer only,465387641dcd86fe992fa1252d519b9b613fab73,1,1
return null;,465387641dcd86fe992fa1252d519b9b613fab73,0,0
},465387641dcd86fe992fa1252d519b9b613fab73,0,0
"dto.setName(row.get(""name""));",465387641dcd86fe992fa1252d519b9b613fab73,0,0
"dto.setModelName(row.get(""modelName""));",465387641dcd86fe992fa1252d519b9b613fab73,0,0
"dto.setTitle(row.get(""title""));",465387641dcd86fe992fa1252d519b9b613fab73,0,0
"dto.setDescription(row.get(""description""));",465387641dcd86fe992fa1252d519b9b613fab73,0,0
"dto.setLabel(row.get(""label""));",465387641dcd86fe992fa1252d519b9b613fab73,0,0
"dto.setJavaType(row.get(""javaType""));",465387641dcd86fe992fa1252d519b9b613fab73,0,0
"dto.setModelJavaType(row.get(""modelJavaType""));",465387641dcd86fe992fa1252d519b9b613fab73,0,0
"dto.setGroupId(row.get(""groupId""));",465387641dcd86fe992fa1252d519b9b613fab73,0,0
"dto.setArtifactId(row.get(""artifactId""));",465387641dcd86fe992fa1252d519b9b613fab73,0,0
"dto.setVersion(row.get(""version""));",465387641dcd86fe992fa1252d519b9b613fab73,0,0
return dto;,465387641dcd86fe992fa1252d519b9b613fab73,0,0
/**,465387641dcd86fe992fa1252d519b9b613fab73,0,1
*,465387641dcd86fe992fa1252d519b9b613fab73,0,1
*/,465387641dcd86fe992fa1252d519b9b613fab73,0,1
@Deprecated,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return name;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
},465387641dcd86fe992fa1252d519b9b613fab73,0,1
return null;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"return row.get(""artifactId"");",465387641dcd86fe992fa1252d519b9b613fab73,0,1
/**,465387641dcd86fe992fa1252d519b9b613fab73,0,1
*,465387641dcd86fe992fa1252d519b9b613fab73,0,1
*/,465387641dcd86fe992fa1252d519b9b613fab73,0,1
@Deprecated,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return name;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
},465387641dcd86fe992fa1252d519b9b613fab73,0,1
return null;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"return row.get(""artifactId"");",465387641dcd86fe992fa1252d519b9b613fab73,0,1
* Gets the description for this data format.,465387641dcd86fe992fa1252d519b9b613fab73,0,1
* @param dataFormat the data format name,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return description;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
* Gets the description for this language.,465387641dcd86fe992fa1252d519b9b613fab73,0,1
/**,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Red Hat licenses this file to you under the Apache License, version",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*  with the License.  You may obtain a copy of the License at,465387641dcd86fe992fa1252d519b9b613fab73,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Unless required by applicable law or agreed to in writing, software",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*  permissions and limitations under the License.,465387641dcd86fe992fa1252d519b9b613fab73,0,1
*/,465387641dcd86fe992fa1252d519b9b613fab73,0,1
package io.fabric8.forge.camel.commands.jolokia;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
@Inject,465387641dcd86fe992fa1252d519b9b613fab73,0,1
protected ProjectFactory projectFactory; // helper to integrate with the filesystem,465387641dcd86fe992fa1252d519b9b613fab73,0,1
protected Configuration configuration;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
@Override,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return false;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
},465387641dcd86fe992fa1252d519b9b613fab73,0,1
// all the jolokia commands is for CLI,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return super.isEnabled(context) && !context.getProvider().isGUI() && getJolokiaUrl() != null;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return projectFactory;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"return configuration.getString(""CamelJolokiaUrl"");",465387641dcd86fe992fa1252d519b9b613fab73,0,1
// optional,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"controller.connect(getJolokiaUrl(), username, password);",465387641dcd86fe992fa1252d519b9b613fab73,0,1
return controller;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return context.getUIContext().getProvider().getOutput().out();,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return context.getUIContext().getProvider().getOutput().err();,465387641dcd86fe992fa1252d519b9b613fab73,0,1
/**,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Red Hat licenses this file to you under the Apache License, version",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*  with the License.  You may obtain a copy of the License at,465387641dcd86fe992fa1252d519b9b613fab73,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Unless required by applicable law or agreed to in writing, software",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*  permissions and limitations under the License.,465387641dcd86fe992fa1252d519b9b613fab73,0,1
*/,465387641dcd86fe992fa1252d519b9b613fab73,0,1
package io.fabric8.forge.camel.commands.jolokia;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
@Inject,465387641dcd86fe992fa1252d519b9b613fab73,0,1
private UIInput<String> label;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
private UIInput<String> verbose;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
@Override,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return Metadata.forCommand(ConnectCommand.class).name(,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"""camel-catalog-component-list"").category(Categories.create(CATEGORY_CATALOG))",465387641dcd86fe992fa1252d519b9b613fab73,0,1
},465387641dcd86fe992fa1252d519b9b613fab73,0,1
builder.add(label).add(verbose);,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"return Results.fail(""Not connected to remote jolokia agent. Use camel-connect command first"");",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"command.execute(getController(), getOutput(context), getError(context));",465387641dcd86fe992fa1252d519b9b613fab73,0,1
return Results.success();,465387641dcd86fe992fa1252d519b9b613fab73,0,1
/**,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Red Hat licenses this file to you under the Apache License, version",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*  with the License.  You may obtain a copy of the License at,465387641dcd86fe992fa1252d519b9b613fab73,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Unless required by applicable law or agreed to in writing, software",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*  permissions and limitations under the License.,465387641dcd86fe992fa1252d519b9b613fab73,0,1
*/,465387641dcd86fe992fa1252d519b9b613fab73,0,1
package io.fabric8.forge.camel.commands.jolokia;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
@Inject,465387641dcd86fe992fa1252d519b9b613fab73,0,1
private UIInput<String> label;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
private UIInput<String> verbose;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
@Override,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return Metadata.forCommand(ConnectCommand.class).name(,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"""camel-catalog-dataformat-list"").category(Categories.create(CATEGORY_CATALOG))",465387641dcd86fe992fa1252d519b9b613fab73,0,1
},465387641dcd86fe992fa1252d519b9b613fab73,0,1
builder.add(label).add(verbose);,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"return Results.fail(""Not connected to remote jolokia agent. Use camel-connect command first"");",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"command.execute(getController(), getOutput(context), getError(context));",465387641dcd86fe992fa1252d519b9b613fab73,0,1
return Results.success();,465387641dcd86fe992fa1252d519b9b613fab73,0,1
/**,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Red Hat licenses this file to you under the Apache License, version",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*  with the License.  You may obtain a copy of the License at,465387641dcd86fe992fa1252d519b9b613fab73,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Unless required by applicable law or agreed to in writing, software",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*  permissions and limitations under the License.,465387641dcd86fe992fa1252d519b9b613fab73,0,1
*/,465387641dcd86fe992fa1252d519b9b613fab73,0,1
package io.fabric8.forge.camel.commands.jolokia;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
@Inject,465387641dcd86fe992fa1252d519b9b613fab73,0,1
private UIInput<String> label;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
private UIInput<String> verbose;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
@Override,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return Metadata.forCommand(ConnectCommand.class).name(,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"""camel-catalog-eip-list"").category(Categories.create(CATEGORY_CATALOG))",465387641dcd86fe992fa1252d519b9b613fab73,0,1
},465387641dcd86fe992fa1252d519b9b613fab73,0,1
builder.add(label).add(verbose);,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"return Results.fail(""Not connected to remote jolokia agent. Use camel-connect command first"");",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"command.execute(getController(), getOutput(context), getError(context));",465387641dcd86fe992fa1252d519b9b613fab73,0,1
return Results.success();,465387641dcd86fe992fa1252d519b9b613fab73,0,1
/**,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Red Hat licenses this file to you under the Apache License, version",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*  with the License.  You may obtain a copy of the License at,465387641dcd86fe992fa1252d519b9b613fab73,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Unless required by applicable law or agreed to in writing, software",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*  permissions and limitations under the License.,465387641dcd86fe992fa1252d519b9b613fab73,0,1
*/,465387641dcd86fe992fa1252d519b9b613fab73,0,1
package io.fabric8.forge.camel.commands.jolokia;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
@Inject,465387641dcd86fe992fa1252d519b9b613fab73,0,1
private UIInput<String> label;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
private UIInput<String> verbose;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
@Override,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return Metadata.forCommand(ConnectCommand.class).name(,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"""camel-catalog-language-list"").category(Categories.create(CATEGORY_CATALOG))",465387641dcd86fe992fa1252d519b9b613fab73,0,1
},465387641dcd86fe992fa1252d519b9b613fab73,0,1
builder.add(label).add(verbose);,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"return Results.fail(""Not connected to remote jolokia agent. Use camel-connect command first"");",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"command.execute(getController(), getOutput(context), getError(context));",465387641dcd86fe992fa1252d519b9b613fab73,0,1
return Results.success();,465387641dcd86fe992fa1252d519b9b613fab73,0,1
/**,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Red Hat licenses this file to you under the Apache License, version",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*  with the License.  You may obtain a copy of the License at,465387641dcd86fe992fa1252d519b9b613fab73,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Unless required by applicable law or agreed to in writing, software",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*  permissions and limitations under the License.,465387641dcd86fe992fa1252d519b9b613fab73,0,1
*/,465387641dcd86fe992fa1252d519b9b613fab73,0,1
package io.fabric8.forge.camel.commands.project.archetype;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
private ArchetypeCatalog cachedArchetypes;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return NAME;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
},465387641dcd86fe992fa1252d519b9b613fab73,0,1
@Override,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"logger.log(Level.SEVERE, ""Error while retrieving archetypes"", e);",465387641dcd86fe992fa1252d519b9b613fab73,0,1
return cachedArchetypes;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return true;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return NAME.hashCode();,465387641dcd86fe992fa1252d519b9b613fab73,0,1
/**,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Red Hat licenses this file to you under the Apache License, version",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*  with the License.  You may obtain a copy of the License at,465387641dcd86fe992fa1252d519b9b613fab73,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Unless required by applicable law or agreed to in writing, software",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*  permissions and limitations under the License.,465387641dcd86fe992fa1252d519b9b613fab73,0,1
*/,465387641dcd86fe992fa1252d519b9b613fab73,0,1
package io.fabric8.forge.camel.commands.project.completer;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
private final Project project;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
private final CamelCatalog camelCatalog;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
private final Dependency core;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
},465387641dcd86fe992fa1252d519b9b613fab73,0,1
@Override,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return null;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
filtered.add(name);,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return filtered;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"names.add(""<all>"");",465387641dcd86fe992fa1252d519b9b613fab73,0,1
return names;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
/**,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Red Hat licenses this file to you under the Apache License, version",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*  with the License.  You may obtain a copy of the License at,465387641dcd86fe992fa1252d519b9b613fab73,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Unless required by applicable law or agreed to in writing, software",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*  permissions and limitations under the License.,465387641dcd86fe992fa1252d519b9b613fab73,0,1
*/,465387641dcd86fe992fa1252d519b9b613fab73,0,1
package io.fabric8.forge.camel.commands.project.completer;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
private final Project project;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
private final CamelCatalog camelCatalog;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
private final Dependency core;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
},465387641dcd86fe992fa1252d519b9b613fab73,0,1
@Override,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return null;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
// filter non matching names first,465387641dcd86fe992fa1252d519b9b613fab73,0,1
filtered.add(name);,465387641dcd86fe992fa1252d519b9b613fab73,0,1
// filter names which are already on the classpath,465387641dcd86fe992fa1252d519b9b613fab73,0,1
answer.add(dto);,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return answer;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
// filter out existing dataformats we already have,465387641dcd86fe992fa1252d519b9b613fab73,0,1
names.removeAll(languages);,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"return row.get(""artifactId"");",465387641dcd86fe992fa1252d519b9b613fab73,0,1
/**,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Red Hat licenses this file to you under the Apache License, version",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*  with the License.  You may obtain a copy of the License at,465387641dcd86fe992fa1252d519b9b613fab73,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Unless required by applicable law or agreed to in writing, software",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*  permissions and limitations under the License.,465387641dcd86fe992fa1252d519b9b613fab73,0,1
*/,465387641dcd86fe992fa1252d519b9b613fab73,0,1
package io.fabric8.forge.camel.commands.project.completer;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
private final Project project;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
private final CamelCatalog camelCatalog;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
private final Dependency core;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
},465387641dcd86fe992fa1252d519b9b613fab73,0,1
@Override,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return null;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
// filter non matching names first,465387641dcd86fe992fa1252d519b9b613fab73,0,1
filtered.add(name);,465387641dcd86fe992fa1252d519b9b613fab73,0,1
// filter names which are already on the classpath,465387641dcd86fe992fa1252d519b9b613fab73,0,1
answer.add(dto);,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return answer;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
// filter out existing languages we already have,465387641dcd86fe992fa1252d519b9b613fab73,0,1
names.removeAll(languages);,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"return row.get(""artifactId"");",465387641dcd86fe992fa1252d519b9b613fab73,0,1
/**,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Red Hat licenses this file to you under the Apache License, version",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*  with the License.  You may obtain a copy of the License at,465387641dcd86fe992fa1252d519b9b613fab73,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  Unless required by applicable law or agreed to in writing, software",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",465387641dcd86fe992fa1252d519b9b613fab73,0,1
*  permissions and limitations under the License.,465387641dcd86fe992fa1252d519b9b613fab73,0,1
*/,465387641dcd86fe992fa1252d519b9b613fab73,0,1
package io.fabric8.forge.camel.commands.project.helper;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
* Returns the text in title case,465387641dcd86fe992fa1252d519b9b613fab73,0,1
},465387641dcd86fe992fa1252d519b9b613fab73,0,1
sb.append(c);,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return sb.toString();,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"return uri.substring(0, idx);",465387641dcd86fe992fa1252d519b9b613fab73,0,1
return null;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
answer.add(scheme);,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return answer;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
answer.add(df);,465387641dcd86fe992fa1252d519b9b613fab73,0,1
answer.add(lan);,465387641dcd86fe992fa1252d519b9b613fab73,0,1
* Checks whether the given value is matching the default value from the given component.,465387641dcd86fe992fa1252d519b9b613fab73,0,1
* @param key    the option key,465387641dcd86fe992fa1252d519b9b613fab73,0,1
* @param value  the option value,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return value.equalsIgnoreCase(defaultValue);,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return false;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
return true;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"dto.setScheme(row.get(""scheme""));",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"dto.setSyntax(row.get(""syntax""));",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"dto.setTitle(row.get(""title""));",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"dto.setDescription(row.get(""description""));",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"dto.setTags(labelText.split("",""));",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"dto.setJavaType(row.get(""javaType""));",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"dto.setGroupId(row.get(""groupId""));",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"dto.setArtifactId(row.get(""artifactId""));",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"dto.setVersion(row.get(""version""));",465387641dcd86fe992fa1252d519b9b613fab73,0,1
return dto;,465387641dcd86fe992fa1252d519b9b613fab73,0,1
"dto.setName(row.get(""name""));",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"dto.setModelName(row.get(""modelName""));",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"dto.setLabel(row.get(""label""));",465387641dcd86fe992fa1252d519b9b613fab73,0,1
"dto.setModelJavaType(row.get(""modelJavaType""));",465387641dcd86fe992fa1252d519b9b613fab73,0,1
import org.jboss.forge.addon.ui.context.UIContext;,a8621e3bf71c29e77ea36123942676bad8016057,2,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",a8621e3bf71c29e77ea36123942676bad8016057,1,1
import java.io.PrintStream;,a8621e3bf71c29e77ea36123942676bad8016057,1,1
import java.util.Set;,a8621e3bf71c29e77ea36123942676bad8016057,1,1
import javax.inject.Inject;,a8621e3bf71c29e77ea36123942676bad8016057,1,1
import io.fabric8.forge.addon.utils.CamelProjectHelper;,a8621e3bf71c29e77ea36123942676bad8016057,1,1
import org.apache.camel.catalog.CamelCatalog;,a8621e3bf71c29e77ea36123942676bad8016057,1,1
import org.jboss.forge.addon.convert.ConverterFactory;,a8621e3bf71c29e77ea36123942676bad8016057,1,1
import org.jboss.forge.addon.dependencies.Coordinate;,a8621e3bf71c29e77ea36123942676bad8016057,1,1
import org.jboss.forge.addon.dependencies.Dependency;,a8621e3bf71c29e77ea36123942676bad8016057,1,1
import org.jboss.forge.addon.dependencies.builder.CoordinateBuilder;,a8621e3bf71c29e77ea36123942676bad8016057,1,1
import org.jboss.forge.addon.projects.Project;,a8621e3bf71c29e77ea36123942676bad8016057,1,1
import org.jboss.forge.addon.projects.ProjectFactory;,a8621e3bf71c29e77ea36123942676bad8016057,1,1
import org.jboss.forge.addon.projects.Projects;,a8621e3bf71c29e77ea36123942676bad8016057,1,1
import org.jboss.forge.addon.projects.ui.AbstractProjectCommand;,a8621e3bf71c29e77ea36123942676bad8016057,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,a8621e3bf71c29e77ea36123942676bad8016057,1,1
return true;,a8621e3bf71c29e77ea36123942676bad8016057,1,1
return false;,a8621e3bf71c29e77ea36123942676bad8016057,1,1
// requires camel is already setup,a8621e3bf71c29e77ea36123942676bad8016057,1,1
return findCamelCoreDependency(project) != null;,a8621e3bf71c29e77ea36123942676bad8016057,1,1
"return Projects.getSelectedProject(this.getProjectFactory(), context);",a8621e3bf71c29e77ea36123942676bad8016057,1,1
return projectFactory;,a8621e3bf71c29e77ea36123942676bad8016057,1,1
return converterFactory;,a8621e3bf71c29e77ea36123942676bad8016057,1,1
return camelCatalog;,a8621e3bf71c29e77ea36123942676bad8016057,1,1
return context.getUIContext().getProvider().getOutput().out();,a8621e3bf71c29e77ea36123942676bad8016057,1,1
return CamelProjectHelper.findCamelCoreDependency(project);,a8621e3bf71c29e77ea36123942676bad8016057,1,1
return CamelProjectHelper.findCamelArtifacts(project);,a8621e3bf71c29e77ea36123942676bad8016057,1,1
return builder;,a8621e3bf71c29e77ea36123942676bad8016057,1,1
"return createCoordinate(""org.apache.camel"", artifactId, version);",a8621e3bf71c29e77ea36123942676bad8016057,1,1
/**,a8621e3bf71c29e77ea36123942676bad8016057,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",a8621e3bf71c29e77ea36123942676bad8016057,0,1
*,a8621e3bf71c29e77ea36123942676bad8016057,0,1
"*  Red Hat licenses this file to you under the Apache License, version",a8621e3bf71c29e77ea36123942676bad8016057,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",a8621e3bf71c29e77ea36123942676bad8016057,0,1
*  with the License.  You may obtain a copy of the License at,a8621e3bf71c29e77ea36123942676bad8016057,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,a8621e3bf71c29e77ea36123942676bad8016057,0,1
"*  Unless required by applicable law or agreed to in writing, software",a8621e3bf71c29e77ea36123942676bad8016057,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",a8621e3bf71c29e77ea36123942676bad8016057,0,1
*  implied.  See the License for the specific language governing,a8621e3bf71c29e77ea36123942676bad8016057,0,1
*  permissions and limitations under the License.,a8621e3bf71c29e77ea36123942676bad8016057,0,1
*/,a8621e3bf71c29e77ea36123942676bad8016057,0,1
package io.fabric8.forge.camel.commands.project;,a8621e3bf71c29e77ea36123942676bad8016057,0,1
public abstract class AbstractCamelProjectCommand extends AbstractProjectCommand {,a8621e3bf71c29e77ea36123942676bad8016057,0,1
"public static String CATEGORY = ""Camel"";",a8621e3bf71c29e77ea36123942676bad8016057,0,1
@Inject,a8621e3bf71c29e77ea36123942676bad8016057,0,1
protected ProjectFactory projectFactory;,a8621e3bf71c29e77ea36123942676bad8016057,0,1
protected ConverterFactory converterFactory;,a8621e3bf71c29e77ea36123942676bad8016057,0,1
private CamelCatalog camelCatalog;,a8621e3bf71c29e77ea36123942676bad8016057,0,1
@Override,a8621e3bf71c29e77ea36123942676bad8016057,0,1
protected boolean isProjectRequired() {,a8621e3bf71c29e77ea36123942676bad8016057,0,1
},a8621e3bf71c29e77ea36123942676bad8016057,0,1
public boolean isEnabled(UIContext context) {,a8621e3bf71c29e77ea36123942676bad8016057,0,1
boolean enabled = super.isEnabled(context);,a8621e3bf71c29e77ea36123942676bad8016057,0,1
if (!enabled) {,a8621e3bf71c29e77ea36123942676bad8016057,0,1
if (requiresCamelSetup()) {,a8621e3bf71c29e77ea36123942676bad8016057,0,1
Project project = getSelectedProjectOrNull(context);,a8621e3bf71c29e77ea36123942676bad8016057,0,1
if (project != null) {,a8621e3bf71c29e77ea36123942676bad8016057,0,1
protected Project getSelectedProjectOrNull(UIContext context) {,a8621e3bf71c29e77ea36123942676bad8016057,0,1
protected boolean requiresCamelSetup() {,a8621e3bf71c29e77ea36123942676bad8016057,0,1
protected ProjectFactory getProjectFactory() {,a8621e3bf71c29e77ea36123942676bad8016057,0,1
protected ConverterFactory getConverterFactory() {,a8621e3bf71c29e77ea36123942676bad8016057,0,1
protected CamelCatalog getCamelCatalog() {,a8621e3bf71c29e77ea36123942676bad8016057,0,1
protected PrintStream getOutput(UIExecutionContext context) {,a8621e3bf71c29e77ea36123942676bad8016057,0,1
protected Dependency findCamelCoreDependency(Project project) {,a8621e3bf71c29e77ea36123942676bad8016057,0,1
protected Set<Dependency> findCamelArtifacts(Project project) {,a8621e3bf71c29e77ea36123942676bad8016057,0,1
"protected Coordinate createCoordinate(String groupId, String artifactId, String version) {",a8621e3bf71c29e77ea36123942676bad8016057,0,1
CoordinateBuilder builder = CoordinateBuilder.create(),a8621e3bf71c29e77ea36123942676bad8016057,0,1
.setGroupId(groupId),a8621e3bf71c29e77ea36123942676bad8016057,0,1
.setArtifactId(artifactId);,a8621e3bf71c29e77ea36123942676bad8016057,0,1
if (version != null) {,a8621e3bf71c29e77ea36123942676bad8016057,0,1
builder = builder.setVersion(version);,a8621e3bf71c29e77ea36123942676bad8016057,0,1
"protected Coordinate createCamelCoordinate(String artifactId, String version) {",a8621e3bf71c29e77ea36123942676bad8016057,0,1
"String fullName = ""src"" + File.separator + ""main"" + File.separator + ""resources"" + File.separator + fileName;",5b1547eef0d46617d7f163c8df844063f51f5ed7,10,1
"@WithAttributes(label = ""XML File Name"", required = true, description = ""Name of XML file"")",5b1547eef0d46617d7f163c8df844063f51f5ed7,4,1
String fileName = directory.getValue() != null ? directory.getValue() + File.separator + name.getValue() : name.getValue();,5b1547eef0d46617d7f163c8df844063f51f5ed7,4,1
"@WithAttributes(label = ""Directory"", required = false, defaultValue = ""META-INF/spring"",",5b1547eef0d46617d7f163c8df844063f51f5ed7,3,1
// this will get a file in the src/main/resources directory where we want to store the spring xml file,5b1547eef0d46617d7f163c8df844063f51f5ed7,3,1
"return Results.fail(""Spring XML file "" + fullName + "" already exists"");",5b1547eef0d46617d7f163c8df844063f51f5ed7,3,1
Project project = getSelectedProject(context);,5b1547eef0d46617d7f163c8df844063f51f5ed7,2,1
"Template template = factory.create(xml, FreemarkerTemplate.class);",5b1547eef0d46617d7f163c8df844063f51f5ed7,2,1
"return Results.success(""Created new Spring XML file "" + fullName);",5b1547eef0d46617d7f163c8df844063f51f5ed7,2,1
".description(""Adds a new Spring XML file with CamelContext to your project"");",5b1547eef0d46617d7f163c8df844063f51f5ed7,1,0
".description(""Adds a Spring XML file with CamelContext included to your project"");",5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
"*  Red Hat licenses this file to you under the Apache License, version",5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import java.io.File;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import java.net.URL;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import java.util.HashMap;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import java.util.Map;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import javax.inject.Inject;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import io.fabric8.forge.addon.utils.validator.ResourceNameValidator;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.dependencies.Dependency;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.facets.constraints.FacetConstraint;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.projects.Project;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.resource.FileResource;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.resource.Resource;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.resource.ResourceFactory;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.resource.URLResource;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.templates.Template;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.templates.TemplateFactory;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.templates.freemarker.FreemarkerTemplate;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.ui.context.UIContext;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.ui.facets.HintsFacet;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.ui.hints.InputType;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.ui.input.UIInput;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.ui.result.Result;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.ui.result.Results;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.ui.util.Categories;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
import org.jboss.forge.addon.ui.util.Metadata;,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
@Inject,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
"description = ""The directory name where this type will be created"")",5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
boolean enabled = super.isEnabled(context);,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
boolean cdi = CamelCommandsHelper.isCdiProject(project);,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
boolean blueprint = CamelCommandsHelper.isBlueprintProject(project);,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
".description(""Creates a new Spring XML file with CamelContext to your project"");",5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
String projectName = project.getRoot().getName();,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
ResourcesFacet facet = project.getFacet(ResourcesFacet.class);,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
FileResource<?> fileResource = facet.getResource(fileName);,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
// does the project already have camel?,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
Dependency core = findCamelCoreDependency(project);,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
"return Results.fail(""The project does not include camel-core"");",5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
"DependencyBuilder spring = DependencyBuilder.create().setGroupId(""org.apache.camel"")",5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
"Resource<URL> xml = resourceFactory.create(getClass().getResource(""/templates/camel-spring.ftl"")).reify(URLResource.class);",5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
"Map<String, Object> params = new HashMap<String, Object>();",5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
String output = template.process(params);,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
// create the new file and set the content,5b1547eef0d46617d7f163c8df844063f51f5ed7,1,1
"""Camel: New XML spring"").category(Categories.create(CATEGORY))",5b1547eef0d46617d7f163c8df844063f51f5ed7,0,0
"""project-camel-add-spring-xml"").category(Categories.create(CATEGORY))",5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
/**,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
*,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
*  with the License.  You may obtain a copy of the License at,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
"*  Unless required by applicable law or agreed to in writing, software",5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
*  implied.  See the License for the specific language governing,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
*  permissions and limitations under the License.,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
*/,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
package io.fabric8.forge.camel.commands.project;,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
@FacetConstraint({ResourcesFacet.class}),5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
public class CamelNewSpringXmlCommand extends AbstractCamelProjectCommand {,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
private UIInput<String> directory;,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
private UIInput<String> name;,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
private DependencyInstaller dependencyInstaller;,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
private TemplateFactory factory;,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
ResourceFactory resourceFactory;,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
@Override,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
public boolean isEnabled(UIContext context) {,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
if (enabled) {,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
// not enable for cdi or blueprint projects,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
return !cdi && !blueprint;,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
},5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
return false;,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
public UICommandMetadata getMetadata(UIContext context) {,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
return Metadata.forCommand(CamelNewRouteBuilderCommand.class).name(,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
"""Camel: New XML spring"").category(Categories.create(CATEGORY))",5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
public void initializeUI(UIBuilder builder) throws Exception {,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
"name.addValidator(new ResourceNameValidator(""xml""));",5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
name.getFacet(HintsFacet.class).setInputType(InputType.FILE_PICKER);,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
directory.getFacet(HintsFacet.class).setInputType(InputType.DIRECTORY_PICKER);,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
builder.add(directory).add(name);,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
public Result execute(UIExecutionContext context) throws Exception {,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
if (fileResource.exists()) {,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
if (core == null) {,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
".setArtifactId(""camel-spring"").setVersion(core.getCoordinate().getVersion());",5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
// install camel-spring if missing,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
"if (!dependencyInstaller.isManaged(project, spring)) {",5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
"dependencyInstaller.install(project, spring);",5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
// any dynamic options goes into the params map,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
"params.put(""projectName"", projectName);",5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
fileResource.createNewFile();,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
fileResource.setContents(output);,5b1547eef0d46617d7f163c8df844063f51f5ed7,0,1
"return new ValidationResult(ResultType.ERROR, ""The file name ["" + s + ""] must be a "" + extension + "" file"");",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,8,1
"return new ValidationResult(ResultType.ERROR, ""The file name ["" + s + ""] must be at least "" + min + "" characters"");",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,8,1
"String fullName = ""src"" + File.separator + ""main"" + File.separator + ""resources"" + File.separator + fileName;",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,6,1
*  with the License.  You may obtain a copy of the License at,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,4,1
*  implied.  See the License for the specific language governing,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,4,1
"return Results.fail(""Spring XML file "" + fullName + "" already exists"");",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,4,1
*  with the License.  You may obtain a copy of the License at,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,4,1
*  implied.  See the License for the specific language governing,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,4,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,3,1
// this will get a file in the src/main/resources directory where we want to store the spring xml file,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,3,1
// create the new file and set the content,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,3,1
"return Results.success(""Created new Spring XML file "" + fullName);",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,3,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,3,1
"*  Red Hat licenses this file to you under the Apache License, version",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,2,1
*  permissions and limitations under the License.,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,2,1
public Result execute(UIExecutionContext context) throws Exception {,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,2,1
String fileName = directory.getValue() != null ? directory.getValue() + File.separator + name.getValue() : name.getValue();,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,2,1
"*  Red Hat licenses this file to you under the Apache License, version",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,2,1
*  permissions and limitations under the License.,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,2,1
"if (extension != null && !s.endsWith(""."" + extension)) {",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,2,1
"*  Copyright 2005-2015 Red Hat, Inc.",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
*,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
*     http://www.apache.org/licenses/LICENSE-2.0,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
"*  Unless required by applicable law or agreed to in writing, software",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
public class CamelNewSpringXmlCommand extends AbstractCamelProjectCommand {,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
"description = ""The directory name where this type will be created"")",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
public boolean isEnabled(UIContext context) {,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
if (enabled) {,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
},9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
public UICommandMetadata getMetadata(UIContext context) {,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
".description(""Creates a new Spring XML file with CamelContext to your project"");",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
public void initializeUI(UIBuilder builder) throws Exception {,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
if (fileResource.exists()) {,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
// does the project already have camel?,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
if (core == null) {,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
"if (!dependencyInstaller.isManaged(project, spring)) {",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
"Resource<URL> xml = resourceFactory.create(getClass().getResource(""/templates/camel-spring.ftl"")).reify(URLResource.class);",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
// any dynamic options goes into the params map,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
"Map<String, Object> params = new HashMap<String, Object>();",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
"*  Copyright 2005-2015 Red Hat, Inc.",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
*,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
*     http://www.apache.org/licenses/LICENSE-2.0,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
"*  Unless required by applicable law or agreed to in writing, software",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
public class ResourceNameValidator extends AbstractJLSUIValidator {,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
public ResourceNameValidator(String extension) {,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
},9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
protected ValidationResult validate(String s) {,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
if (s == null) {,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
return new ValidationResult(ResultType.INFO);,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
int min = extension != null ? extension.length() + 2 : 1;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
if (s.length() < min) {,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,1,1
/**,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
*/,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
package io.fabric8.forge.camel.commands.project;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import java.io.File;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import java.net.URL;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import java.util.HashMap;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import java.util.Map;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import javax.inject.Inject;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import io.fabric8.forge.addon.utils.validator.ResourceNameValidator;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.dependencies.Dependency;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.facets.constraints.FacetConstraint;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.projects.Project;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.resource.FileResource;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.resource.Resource;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.resource.ResourceFactory;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.resource.URLResource;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.templates.Template;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.templates.TemplateFactory;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.templates.freemarker.FreemarkerTemplate;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.ui.context.UIContext;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.ui.facets.HintsFacet;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.ui.hints.InputType;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.ui.input.UIInput;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.ui.result.Result;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.ui.result.Results;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.ui.util.Categories;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.ui.util.Metadata;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
@FacetConstraint({ResourcesFacet.class}),9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
@Inject,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
"@WithAttributes(label = ""Directory"", required = false, defaultValue = ""META-INF/spring"",",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
private UIInput<String> directory;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
"@WithAttributes(label = ""XML File Name"", required = true, description = ""Name of XML file"")",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
private UIInput<String> name;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
private DependencyInstaller dependencyInstaller;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
private TemplateFactory factory;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
ResourceFactory resourceFactory;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
@Override,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
boolean enabled = super.isEnabled(context);,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
Project project = getSelectedProject(context);,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
// not enable for cdi or blueprint projects,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
boolean cdi = CamelCommandsHelper.isCdiProject(project);,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
boolean blueprint = CamelCommandsHelper.isBlueprintProject(project);,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
return !cdi && !blueprint;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
return false;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
return Metadata.forCommand(CamelNewRouteBuilderCommand.class).name(,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
"""Camel: New XML spring"").category(Categories.create(CATEGORY))",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
"name.addValidator(new ResourceNameValidator(""xml""));",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
name.getFacet(HintsFacet.class).setInputType(InputType.FILE_PICKER);,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
directory.getFacet(HintsFacet.class).setInputType(InputType.DIRECTORY_PICKER);,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
builder.add(directory).add(name);,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
String projectName = project.getRoot().getName();,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
ResourcesFacet facet = project.getFacet(ResourcesFacet.class);,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
FileResource<?> fileResource = facet.getResource(fileName);,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
Dependency core = findCamelCoreDependency(project);,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
"return Results.fail(""The project does not include camel-core"");",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
"DependencyBuilder spring = DependencyBuilder.create().setGroupId(""org.apache.camel"")",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
".setArtifactId(""camel-spring"").setVersion(core.getCoordinate().getVersion());",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
// install camel-spring if missing,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
"dependencyInstaller.install(project, spring);",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
"Template template = factory.create(xml, FreemarkerTemplate.class);",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
"params.put(""projectName"", projectName);",9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
String output = template.process(params);,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
fileResource.createNewFile();,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
fileResource.setContents(output);,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
/**,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
*/,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
package io.fabric8.forge.addon.utils.validator;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.parser.java.ui.validators.AbstractJLSUIValidator;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.parser.java.utils.ResultType;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
import org.jboss.forge.addon.parser.java.utils.ValidationResult;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
private String extension;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
this.extension = extension;,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
@Override,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
// min length,9a1f248b7bdfbfd3a2ad9376266a4e20c6f652ab,0,1
"String fullName = ""src"" + File.separator + ""main"" + File.separator + ""resources"" + File.separator + fileName;",307bd55696a80098185962749cc689f93bdf34ad,7,1
"@WithAttributes(label = ""Directory"", required = false, defaultValue = ""OSGI-INF/blueprint"",",307bd55696a80098185962749cc689f93bdf34ad,3,1
"@WithAttributes(label = ""File Name"", required = true, description = ""Name of XML file"")",307bd55696a80098185962749cc689f93bdf34ad,3,1
String fileName = directory.getValue() != null ? directory.getValue() + File.separator + name.getValue() : name.getValue();,307bd55696a80098185962749cc689f93bdf34ad,3,1
// this will get a file in the src/main/resources directory where we want to store the spring xml file,307bd55696a80098185962749cc689f93bdf34ad,3,1
"return Results.fail(""Blueprint XML file "" + fullName + "" already exists"");",307bd55696a80098185962749cc689f93bdf34ad,3,1
"return Results.success(""Created new Blueprint XML file "" + fullName);",307bd55696a80098185962749cc689f93bdf34ad,3,1
".description(""Adds a new Blueprint XML file with CamelContext to your project"");",307bd55696a80098185962749cc689f93bdf34ad,2,0
".description(""Adds a Blueprint XML file with CamelContext included to your project"");",307bd55696a80098185962749cc689f93bdf34ad,2,1
Project project = getSelectedProject(context);,307bd55696a80098185962749cc689f93bdf34ad,2,1
".description(""Creates a new Blueprint XML file with CamelContext"");",307bd55696a80098185962749cc689f93bdf34ad,2,1
"Template template = factory.create(xml, FreemarkerTemplate.class);",307bd55696a80098185962749cc689f93bdf34ad,2,1
"*  Red Hat licenses this file to you under the Apache License, version",307bd55696a80098185962749cc689f93bdf34ad,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",307bd55696a80098185962749cc689f93bdf34ad,1,1
import java.io.File;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import java.net.URL;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import java.util.HashMap;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import java.util.Map;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import javax.inject.Inject;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import io.fabric8.forge.addon.utils.validator.ResourceNameValidator;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.dependencies.Dependency;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.facets.constraints.FacetConstraint;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.projects.Project;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.resource.FileResource;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.resource.Resource;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.resource.ResourceFactory;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.resource.URLResource;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.templates.Template;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.templates.TemplateFactory;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.templates.freemarker.FreemarkerTemplate;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.ui.context.UIContext;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.ui.facets.HintsFacet;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.ui.hints.InputType;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.ui.input.UIInput;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.ui.result.Result;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.ui.result.Results;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.ui.util.Categories;,307bd55696a80098185962749cc689f93bdf34ad,1,1
import org.jboss.forge.addon.ui.util.Metadata;,307bd55696a80098185962749cc689f93bdf34ad,1,1
@Inject,307bd55696a80098185962749cc689f93bdf34ad,1,1
"description = ""The directory name where this type will be created"")",307bd55696a80098185962749cc689f93bdf34ad,1,1
boolean enabled = super.isEnabled(context);,307bd55696a80098185962749cc689f93bdf34ad,1,1
boolean cdi = CamelCommandsHelper.isCdiProject(project);,307bd55696a80098185962749cc689f93bdf34ad,1,1
boolean spring = CamelCommandsHelper.isSpringProject(project);,307bd55696a80098185962749cc689f93bdf34ad,1,1
String projectName = project.getRoot().getName();,307bd55696a80098185962749cc689f93bdf34ad,1,1
ResourcesFacet facet = project.getFacet(ResourcesFacet.class);,307bd55696a80098185962749cc689f93bdf34ad,1,1
FileResource<?> fileResource = facet.getResource(fileName);,307bd55696a80098185962749cc689f93bdf34ad,1,1
// does the project already have camel?,307bd55696a80098185962749cc689f93bdf34ad,1,1
Dependency core = findCamelCoreDependency(project);,307bd55696a80098185962749cc689f93bdf34ad,1,1
"return Results.fail(""The project does not include camel-core"");",307bd55696a80098185962749cc689f93bdf34ad,1,1
"DependencyBuilder spring = DependencyBuilder.create().setGroupId(""org.apache.camel"")",307bd55696a80098185962749cc689f93bdf34ad,1,1
"Resource<URL> xml = resourceFactory.create(getClass().getResource(""/templates/camel-blueprint.ftl"")).reify(URLResource.class);",307bd55696a80098185962749cc689f93bdf34ad,1,1
"Map<String, Object> params = new HashMap<String, Object>();",307bd55696a80098185962749cc689f93bdf34ad,1,1
String output = template.process(params);,307bd55696a80098185962749cc689f93bdf34ad,1,1
// create the new file and set the content,307bd55696a80098185962749cc689f93bdf34ad,1,1
"""Camel: New XML blueprint"").category(Categories.create(CATEGORY))",307bd55696a80098185962749cc689f93bdf34ad,0,0
"""project-camel-add-blueprint-xml"").category(Categories.create(CATEGORY))",307bd55696a80098185962749cc689f93bdf34ad,0,1
/**,307bd55696a80098185962749cc689f93bdf34ad,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",307bd55696a80098185962749cc689f93bdf34ad,0,1
*,307bd55696a80098185962749cc689f93bdf34ad,0,1
*  with the License.  You may obtain a copy of the License at,307bd55696a80098185962749cc689f93bdf34ad,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,307bd55696a80098185962749cc689f93bdf34ad,0,1
"*  Unless required by applicable law or agreed to in writing, software",307bd55696a80098185962749cc689f93bdf34ad,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",307bd55696a80098185962749cc689f93bdf34ad,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",307bd55696a80098185962749cc689f93bdf34ad,0,1
*  implied.  See the License for the specific language governing,307bd55696a80098185962749cc689f93bdf34ad,0,1
*  permissions and limitations under the License.,307bd55696a80098185962749cc689f93bdf34ad,0,1
*/,307bd55696a80098185962749cc689f93bdf34ad,0,1
package io.fabric8.forge.camel.commands.project;,307bd55696a80098185962749cc689f93bdf34ad,0,1
@FacetConstraint({ResourcesFacet.class}),307bd55696a80098185962749cc689f93bdf34ad,0,1
public class CamelNewBlueprintXmlCommand extends AbstractCamelProjectCommand {,307bd55696a80098185962749cc689f93bdf34ad,0,1
private UIInput<String> directory;,307bd55696a80098185962749cc689f93bdf34ad,0,1
private UIInput<String> name;,307bd55696a80098185962749cc689f93bdf34ad,0,1
private DependencyInstaller dependencyInstaller;,307bd55696a80098185962749cc689f93bdf34ad,0,1
private TemplateFactory factory;,307bd55696a80098185962749cc689f93bdf34ad,0,1
ResourceFactory resourceFactory;,307bd55696a80098185962749cc689f93bdf34ad,0,1
@Override,307bd55696a80098185962749cc689f93bdf34ad,0,1
public boolean isEnabled(UIContext context) {,307bd55696a80098185962749cc689f93bdf34ad,0,1
if (enabled) {,307bd55696a80098185962749cc689f93bdf34ad,0,1
// not enable for cdi or spring projects,307bd55696a80098185962749cc689f93bdf34ad,0,1
return !cdi && !spring;,307bd55696a80098185962749cc689f93bdf34ad,0,1
},307bd55696a80098185962749cc689f93bdf34ad,0,1
return false;,307bd55696a80098185962749cc689f93bdf34ad,0,1
public UICommandMetadata getMetadata(UIContext context) {,307bd55696a80098185962749cc689f93bdf34ad,0,1
return Metadata.forCommand(CamelNewRouteBuilderCommand.class).name(,307bd55696a80098185962749cc689f93bdf34ad,0,1
"""Camel: New XML blueprint"").category(Categories.create(CATEGORY))",307bd55696a80098185962749cc689f93bdf34ad,0,1
public void initializeUI(UIBuilder builder) throws Exception {,307bd55696a80098185962749cc689f93bdf34ad,0,1
directory.getFacet(HintsFacet.class).setInputType(InputType.DIRECTORY_PICKER);,307bd55696a80098185962749cc689f93bdf34ad,0,1
"name.addValidator(new ResourceNameValidator(""xml""));",307bd55696a80098185962749cc689f93bdf34ad,0,1
name.getFacet(HintsFacet.class).setInputType(InputType.FILE_PICKER);,307bd55696a80098185962749cc689f93bdf34ad,0,1
builder.add(directory).add(name);,307bd55696a80098185962749cc689f93bdf34ad,0,1
public Result execute(UIExecutionContext context) throws Exception {,307bd55696a80098185962749cc689f93bdf34ad,0,1
if (fileResource.exists()) {,307bd55696a80098185962749cc689f93bdf34ad,0,1
if (core == null) {,307bd55696a80098185962749cc689f93bdf34ad,0,1
".setArtifactId(""camel-blueprint"").setVersion(core.getCoordinate().getVersion());",307bd55696a80098185962749cc689f93bdf34ad,0,1
// install camel-blueprint if missing,307bd55696a80098185962749cc689f93bdf34ad,0,1
"if (!dependencyInstaller.isManaged(project, spring)) {",307bd55696a80098185962749cc689f93bdf34ad,0,1
"dependencyInstaller.install(project, spring);",307bd55696a80098185962749cc689f93bdf34ad,0,1
// any dynamic options goes into the params map,307bd55696a80098185962749cc689f93bdf34ad,0,1
"params.put(""projectName"", projectName);",307bd55696a80098185962749cc689f93bdf34ad,0,1
fileResource.createNewFile();,307bd55696a80098185962749cc689f93bdf34ad,0,1
fileResource.setContents(output);,307bd55696a80098185962749cc689f93bdf34ad,0,1
"// TODO: check we have camel-blueprint, and packaging = bundle",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,7,1
// does the project already have camel?,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,5,0
// does the project already have camel?,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,5,1
// requires camel is already setup,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,4,1
// and add the karaf bundle plugin,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,4,1
// requires camel is already setup,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,4,1
Project project = getSelectedProject(context);,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,3,1
Project project = getSelectedProject(context);,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,3,1
Project project = getSelectedProject(context);,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,3,1
Dependency core = findCamelCoreDependency(project);,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,2,0
"return Results.fail(""The project does not include camel-core"");",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,2,0
// name -> artifactId,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,2,1
// not enable for cdi or blueprint projects,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,2,1
// this will get a file in the src/main/resources directory where we want to store the spring xml file,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,2,1
Dependency core = findCamelCoreDependency(project);,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,2,1
"return Results.fail(""The project does not include camel-core"");",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,2,1
// create the new file and set the content,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,2,1
"DependencyBuilder spring = DependencyBuilder.create().setGroupId(""org.apache.camel"")",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,1,0
// install camel-blueprint if missing,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,1,0
public boolean isEnabled(UIContext context) {,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,1,1
"DependencyBuilder spring = DependencyBuilder.create().setGroupId(""org.apache.camel"")",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,1,0
public boolean isEnabled(UIContext context) {,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,1,1
"String artifactId = findComponentArchetype(""spring"");",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,1,1
"DependencyBuilder component = DependencyBuilder.create().setGroupId(""org.apache.camel"")",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,1,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,1,1
*  permissions and limitations under the License.,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,1,1
public boolean isEnabled(UIContext context) {,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,1,1
boolean blueprint = CamelCommandsHelper.isBlueprintProject(project);,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,1,1
public UICommandMetadata getMetadata(UIContext context) {,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,1,1
public Result execute(UIExecutionContext context) throws Exception {,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,1,1
"return Results.fail(""Spring XML file "" + fullName + "" already exists"");",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,1,1
"DependencyBuilder spring = DependencyBuilder.create().setGroupId(""org.apache.camel"")",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,1,1
// install camel-spring if missing,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,1,1
// any dynamic options goes into the params map,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,1,1
import org.jboss.forge.addon.dependencies.Dependency;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,0
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,0
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,0
@Inject,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,0
private DependencyInstaller dependencyInstaller;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,0
if (core == null) {,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,0
},4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,0
".setArtifactId(""camel-blueprint"").setVersion(core.getCoordinate().getVersion());",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,0
"if (!dependencyInstaller.isManaged(project, spring)) {",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,0
"dependencyInstaller.install(project, spring);",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,0
@Override,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
return super.isEnabled(context) && findCamelCoreDependency(project) != null;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
},4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
".setArtifactId(""camel-spring"").setVersion(core.getCoordinate().getVersion());",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,0
"if (!dependencyInstaller.isManaged(project, spring)) {",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,0
"dependencyInstaller.install(project, spring);",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,0
@Override,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
return super.isEnabled(context) && findCamelCoreDependency(project) != null;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
},4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
.setArtifactId(artifactId).setVersion(core.getCoordinate().getVersion());,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
"if (!dependencyInstaller.isManaged(project, component)) {",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
"dependencyInstaller.install(project, component);",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
/**,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
*,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
"*  Red Hat licenses this file to you under the Apache License, version",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
*  with the License.  You may obtain a copy of the License at,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
"*  Unless required by applicable law or agreed to in writing, software",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
*  implied.  See the License for the specific language governing,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
*/,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
package io.fabric8.forge.camel.commands.project;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import java.io.File;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import java.net.URL;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import java.util.HashMap;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import java.util.Map;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import javax.inject.Inject;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import io.fabric8.forge.addon.utils.validator.ResourceNameValidator;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.dependencies.Dependency;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.facets.constraints.FacetConstraint;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.projects.Project;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.resource.FileResource;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.resource.Resource;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.resource.ResourceFactory;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.resource.URLResource;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.templates.Template;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.templates.TemplateFactory;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.templates.freemarker.FreemarkerTemplate;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.ui.context.UIContext;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.ui.facets.HintsFacet;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.ui.hints.InputType;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.ui.input.UIInput;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.ui.result.Result;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.ui.result.Results;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.ui.util.Categories;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
import org.jboss.forge.addon.ui.util.Metadata;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
@FacetConstraint({ResourcesFacet.class}),4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
public class CamelNewSpringXmlCommand extends AbstractCamelProjectCommand {,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
@Inject,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
"@WithAttributes(label = ""Directory"", required = false, defaultValue = ""META-INF/spring"",",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
"description = ""The directory name where this type will be created"")",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
private UIInput<String> directory;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
"@WithAttributes(label = ""XML File Name"", required = true, description = ""Name of XML file"")",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
private UIInput<String> name;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
private DependencyInstaller dependencyInstaller;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
private TemplateFactory factory;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
ResourceFactory resourceFactory;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
@Override,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
boolean enabled = super.isEnabled(context);,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
if (enabled) {,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
boolean cdi = CamelCommandsHelper.isCdiProject(project);,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
return !cdi && !blueprint;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
},4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
return false;,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
return Metadata.forCommand(CamelNewRouteBuilderCommand.class).name(,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
"""Camel: New XML spring"").category(Categories.create(CATEGORY))",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
".description(""Creates a new Spring XML file with CamelContext to your project"");",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
public void initializeUI(UIBuilder builder) throws Exception {,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
"name.addValidator(new ResourceNameValidator(""xml""));",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
name.getFacet(HintsFacet.class).setInputType(InputType.FILE_PICKER);,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
directory.getFacet(HintsFacet.class).setInputType(InputType.DIRECTORY_PICKER);,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
builder.add(directory).add(name);,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
String projectName = project.getRoot().getName();,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
String fileName = directory.getValue() != null ? directory.getValue() + File.separator + name.getValue() : name.getValue();,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
"String fullName = ""src"" + File.separator + ""main"" + File.separator + ""resources"" + File.separator + fileName;",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
ResourcesFacet facet = project.getFacet(ResourcesFacet.class);,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
FileResource<?> fileResource = facet.getResource(fileName);,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
if (fileResource.exists()) {,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
if (core == null) {,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
".setArtifactId(""camel-spring"").setVersion(core.getCoordinate().getVersion());",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
"if (!dependencyInstaller.isManaged(project, spring)) {",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
"dependencyInstaller.install(project, spring);",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
"Resource<URL> xml = resourceFactory.create(getClass().getResource(""/templates/camel-spring.ftl"")).reify(URLResource.class);",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
"Template template = factory.create(xml, FreemarkerTemplate.class);",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
"Map<String, Object> params = new HashMap<String, Object>();",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
"params.put(""projectName"", projectName);",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
String output = template.process(params);,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
fileResource.createNewFile();,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
fileResource.setContents(output);,4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
"return Results.success(""Created new Spring XML file "" + fullName);",4178fa83f9ee3c65c91f3c1a62c3194129c5447c,0,1
* Loads a class of the given name from the project class loader or returns null if its not found,b2def7948589cf55adb28e0169043b04a81d0dd5,8,1
* Converts a java type as a string to a valid input type and returns the class or null if its not supported,b2def7948589cf55adb28e0169043b04a81d0dd5,7,0
* Converts a java type as a string to a valid input type and returns the class or null if its not supported,b2def7948589cf55adb28e0169043b04a81d0dd5,7,1
* Removes the package from the type name from the given type,b2def7948589cf55adb28e0169043b04a81d0dd5,7,1
"@WithAttributes(label = ""componentName"", required = true, description = ""Name of component type to add"")",b2def7948589cf55adb28e0169043b04a81d0dd5,6,0
"@WithAttributes(label = ""componentName"", required = true, description = ""Name of component type to add."")",b2def7948589cf55adb28e0169043b04a81d0dd5,6,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",b2def7948589cf55adb28e0169043b04a81d0dd5,6,0
"* The ASF licenses this file to You under the Apache License, Version 2.0",b2def7948589cf55adb28e0169043b04a81d0dd5,6,1
"* distributed under the License is distributed on an ""AS IS"" BASIS,",b2def7948589cf55adb28e0169043b04a81d0dd5,6,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",b2def7948589cf55adb28e0169043b04a81d0dd5,6,0
"* The ASF licenses this file to You under the Apache License, Version 2.0",b2def7948589cf55adb28e0169043b04a81d0dd5,6,1
"* distributed under the License is distributed on an ""AS IS"" BASIS,",b2def7948589cf55adb28e0169043b04a81d0dd5,6,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",b2def7948589cf55adb28e0169043b04a81d0dd5,6,1
"@WithAttributes(label = ""Component Name"", required = true, description = ""Name of component type to add"")",b2def7948589cf55adb28e0169043b04a81d0dd5,6,1
"@WithAttributes(label = ""Package Name"", required = false, description = ""The package name where this type will be created"")",b2def7948589cf55adb28e0169043b04a81d0dd5,6,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",b2def7948589cf55adb28e0169043b04a81d0dd5,6,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",b2def7948589cf55adb28e0169043b04a81d0dd5,6,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",b2def7948589cf55adb28e0169043b04a81d0dd5,6,1
// lets find the camel component class,b2def7948589cf55adb28e0169043b04a81d0dd5,5,1
"String body = componentClassName + "" component = new "" + componentClassName + ""();\n/* TODO configure component here */\nreturn component;"";",b2def7948589cf55adb28e0169043b04a81d0dd5,5,1
"@WithAttributes(label = ""instanceName"", required = true, description = ""Name of component instance to add"")",b2def7948589cf55adb28e0169043b04a81d0dd5,5,0
"@WithAttributes(label = ""instanceName"", required = true, description = ""Name of component instance to add."")",b2def7948589cf55adb28e0169043b04a81d0dd5,5,1
"*  Red Hat licenses this file to you under the Apache License, version",b2def7948589cf55adb28e0169043b04a81d0dd5,5,0
* Licensed to the Apache Software Foundation (ASF) under one or more,b2def7948589cf55adb28e0169043b04a81d0dd5,5,1
"*  Red Hat licenses this file to you under the Apache License, version",b2def7948589cf55adb28e0169043b04a81d0dd5,5,0
* Licensed to the Apache Software Foundation (ASF) under one or more,b2def7948589cf55adb28e0169043b04a81d0dd5,5,1
"*  Red Hat licenses this file to you under the Apache License, version",b2def7948589cf55adb28e0169043b04a81d0dd5,5,1
"@WithAttributes(label = ""Instance Name"", required = true, description = ""Name of component instance to add"")",b2def7948589cf55adb28e0169043b04a81d0dd5,5,1
"*  Red Hat licenses this file to you under the Apache License, version",b2def7948589cf55adb28e0169043b04a81d0dd5,5,1
"return Results.fail(""Could not find fully qualified class name in catalog for component name: "" + camelComponentName);",b2def7948589cf55adb28e0169043b04a81d0dd5,5,1
"public static void createCdiComponentProducerClass(JavaClassSource javaClass, CamelComponentDetails details, String camelComponentName, String componentInstanceName, String configurationCode) {",b2def7948589cf55adb28e0169043b04a81d0dd5,5,1
"public static void createSpringComponentFactoryClass(JavaClassSource javaClass, CamelComponentDetails details, String camelComponentName, String componentInstanceName, String configurationCode) {",b2def7948589cf55adb28e0169043b04a81d0dd5,5,1
* @param name the json type,b2def7948589cf55adb28e0169043b04a81d0dd5,5,1
* @return the primitive Java Class type,b2def7948589cf55adb28e0169043b04a81d0dd5,5,1
"*  Red Hat licenses this file to you under the Apache License, version",b2def7948589cf55adb28e0169043b04a81d0dd5,5,1
"*  Red Hat licenses this file to you under the Apache License, version",b2def7948589cf55adb28e0169043b04a81d0dd5,5,1
"public static boolean projectHasClassOnClassPath(Project project, String className) {",b2def7948589cf55adb28e0169043b04a81d0dd5,5,1
"public static Class<?> loadProjectClass(Project project, String className) {",b2def7948589cf55adb28e0169043b04a81d0dd5,5,1
// need to parse to be able to extends another class,b2def7948589cf55adb28e0169043b04a81d0dd5,4,1
"return Results.success(""Added Component instance @Producer class "" + generateClassName + "" to the project"");",b2def7948589cf55adb28e0169043b04a81d0dd5,4,1
"protected static void createCdiComponentProducerClass(JavaClassSource javaClass, CamelComponentDetails details, String camelComponentName, String componentInstanceName, String configurationCode) {",b2def7948589cf55adb28e0169043b04a81d0dd5,4,0
"String body = componentClassName + "" component = new "" + componentClassName + ""();"" + configurationCode + ""\nreturn component;"";",b2def7948589cf55adb28e0169043b04a81d0dd5,4,0
"protected static void createSpringComponentFactoryClass(JavaClassSource javaClass, CamelComponentDetails details, String camelComponentName, String componentInstanceName, String configurationCode) {",b2def7948589cf55adb28e0169043b04a81d0dd5,4,0
*  with the License.  You may obtain a copy of the License at,b2def7948589cf55adb28e0169043b04a81d0dd5,4,0
*  implied.  See the License for the specific language governing,b2def7948589cf55adb28e0169043b04a81d0dd5,4,0
* the License.  You may obtain a copy of the License at,b2def7948589cf55adb28e0169043b04a81d0dd5,4,1
* See the License for the specific language governing permissions and,b2def7948589cf55adb28e0169043b04a81d0dd5,4,1
*  with the License.  You may obtain a copy of the License at,b2def7948589cf55adb28e0169043b04a81d0dd5,4,0
*  implied.  See the License for the specific language governing,b2def7948589cf55adb28e0169043b04a81d0dd5,4,0
* the License.  You may obtain a copy of the License at,b2def7948589cf55adb28e0169043b04a81d0dd5,4,1
* See the License for the specific language governing permissions and,b2def7948589cf55adb28e0169043b04a81d0dd5,4,1
*  with the License.  You may obtain a copy of the License at,b2def7948589cf55adb28e0169043b04a81d0dd5,4,1
*  implied.  See the License for the specific language governing,b2def7948589cf55adb28e0169043b04a81d0dd5,4,1
"@WithAttributes(label = ""Filter"", required = false, description = ""To filter components"")",b2def7948589cf55adb28e0169043b04a81d0dd5,4,1
*  with the License.  You may obtain a copy of the License at,b2def7948589cf55adb28e0169043b04a81d0dd5,4,1
*  implied.  See the License for the specific language governing,b2def7948589cf55adb28e0169043b04a81d0dd5,4,1
"String body = componentClassName + "" component = new "" + componentClassName + ""();"" + configurationCode + ""\nreturn component;"";",b2def7948589cf55adb28e0169043b04a81d0dd5,4,1
"// its a custom java type so use String as the input type, so you can refer to it using # lookup",b2def7948589cf55adb28e0169043b04a81d0dd5,4,1
"// is the component consumer or producer only, if so we do not need any kind of filter",b2def7948589cf55adb28e0169043b04a81d0dd5,4,1
*  with the License.  You may obtain a copy of the License at,b2def7948589cf55adb28e0169043b04a81d0dd5,4,1
*  implied.  See the License for the specific language governing,b2def7948589cf55adb28e0169043b04a81d0dd5,4,1
public String getArtifactId() {,b2def7948589cf55adb28e0169043b04a81d0dd5,4,1
*  with the License.  You may obtain a copy of the License at,b2def7948589cf55adb28e0169043b04a81d0dd5,4,1
*  implied.  See the License for the specific language governing,b2def7948589cf55adb28e0169043b04a81d0dd5,4,1
public static String removeJavaPackageName(String className) {,b2def7948589cf55adb28e0169043b04a81d0dd5,4,1
public class CamelAddComponentInstanceCDICommand extends AbstractCamelProjectCommand implements UIWizard {,b2def7948589cf55adb28e0169043b04a81d0dd5,3,0
String name = instanceName.getValue();,b2def7948589cf55adb28e0169043b04a81d0dd5,3,0
public class CamelAddComponentInstanceCDICommand extends AbstractCamelProjectCommand {,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
String name = instanceName.getValue();,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
Project project = getSelectedProject(context);,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
// do we already have a class with the name,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
"*  Unless required by applicable law or agreed to in writing, software",b2def7948589cf55adb28e0169043b04a81d0dd5,3,0
*  permissions and limitations under the License.,b2def7948589cf55adb28e0169043b04a81d0dd5,3,0
public final class CamelCommands {,b2def7948589cf55adb28e0169043b04a81d0dd5,3,0
* contributor license agreements.  See the NOTICE file distributed with,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
"* Unless required by applicable law or agreed to in writing, software",b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
* limitations under the License.,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
public class CamelCommands {,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
"*  Unless required by applicable law or agreed to in writing, software",b2def7948589cf55adb28e0169043b04a81d0dd5,3,0
*  permissions and limitations under the License.,b2def7948589cf55adb28e0169043b04a81d0dd5,3,0
public final class JavaHelper {,b2def7948589cf55adb28e0169043b04a81d0dd5,3,0
* contributor license agreements.  See the NOTICE file distributed with,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
"* Unless required by applicable law or agreed to in writing, software",b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
* limitations under the License.,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
public class JavaHelper {,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
"public static Callable<Iterable<ComponentDto>> createComponentDtoValues(final Project project,",b2def7948589cf55adb28e0169043b04a81d0dd5,3,0
// we want to use same version as camel-core if its a camel component,b2def7948589cf55adb28e0169043b04a81d0dd5,3,0
"*  Unless required by applicable law or agreed to in writing, software",b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
*  permissions and limitations under the License.,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
public class CamelNewComponentInstanceCDICommand extends AbstractCamelProjectCommand implements UIWizard {,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
"@WithAttributes(label = ""Class Name"", required = true, description = ""Name of @Producer class"")",b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
Project project = getSelectedProject(builder.getUIContext());,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
public String call() throws Exception {,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
String name = instanceName.getValue();,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
"*  Unless required by applicable law or agreed to in writing, software",b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
*  permissions and limitations under the License.,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
public final class CamelCommandsHelper {,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
"public static Iterable<String> createComponentLabelValues(Project project, CamelCatalog camelCatalog) {",b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
"public static Callable<Iterable<ComponentDto>> createComponentDtoValues(final Project project, final CamelCatalog camelCatalog,",b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
"* Populates the details for the given component, returning a Result if it fails.",b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
"public static Result loadCamelComponentDetails(CamelCatalog camelCatalog, String camelComponentName, CamelComponentDetails details) {",b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
String json = camelCatalog.componentJSonSchema(camelComponentName);,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
"return Results.fail(""Could not find catalog entry for component name: "" + camelComponentName);",b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
"public static Result ensureCamelArtifactIdAdded(Project project, CamelComponentDetails details, DependencyInstaller dependencyInstaller) {",b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
// we want to use same version as camel-core if its a camel component,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
"public static Class<Object> loadValidInputTypes(String javaType, String type) {",b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
* Gets the JSon schema primitive type.,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
public static Class getPrimitiveWrapperClassType(String name) {,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
"throw new IllegalArgumentException(""Could not find catalog entry for component name: "" + camelComponentName);",b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
"// reset the filters as the component can only be one of them anyway, so we should show all options",b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
"String name = propertyMap.get(""name"");",b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
"String type = propertyMap.get(""type"");",b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
// this group is now done so add to answer,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
"*  Unless required by applicable law or agreed to in writing, software",b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
*  permissions and limitations under the License.,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
public class CamelComponentDetails {,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
public String getComponentClassQName() {,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
public String getComponentClassName() {,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
public void setArtifactId(String artifactId) {,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
this.artifactId = artifactId;,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
public String getGroupId() {,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
public String getVersion() {,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
"*  Unless required by applicable law or agreed to in writing, software",b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
*  permissions and limitations under the License.,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
public final class JavaHelper {,b2def7948589cf55adb28e0169043b04a81d0dd5,3,1
public NavigationResult next(UINavigationContext context) throws Exception {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
protected String getDefaultProducerClassName() {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
protected String getDefaultProducerClassName() {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
JavaSourceFacet facet = project.getFacet(JavaSourceFacet.class);,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
// does the project already have camel?,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
Dependency core = findCamelCoreDependency(project);,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
String camelComponentName = componentName.getValue();,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
String generatePackageName = targetPackage.getValue();,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
String generateClassName = className.getValue();,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"String fqn = generatePackageName != null ? generatePackageName + ""."" + generateClassName : generateClassName;",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"return Results.fail(""A class with name "" + fqn + "" already exists"");",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
String componentClassName = details.getComponentClassName();,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"String methodName = ""create"" + Strings.capitalize(instanceName.getValue()) + ""Component"";",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
String componentClassName = details.getComponentClassName();,b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"String methodName = ""create"" + Strings.capitalize(componentInstanceName) + ""Component"";",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"protected static  Class<?> loadValidInputTypes(String javaType, String type) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
} catch (ClassNotFoundException e) {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"*  2.0 (the ""License""); you may not use this file except in compliance",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
* this work for additional information regarding copyright ownership.,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"* (the ""License""); you may not use this file except in compliance with",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"*  2.0 (the ""License""); you may not use this file except in compliance",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
* this work for additional information regarding copyright ownership.,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"* (the ""License""); you may not use this file except in compliance with",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"protected static Class<Object> loadValidInputTypes(String javaType, String type) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
private static Class loadPrimitiveType(String name) {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
// special for byte[] or Object[] as its common to use,b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"} else if (""java.lang.Byte[]"".equals(name) || ""Byte[]"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"} else if (""java.lang.Object[]"".equals(name) || ""Object[]"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"} else if (""java.lang.String[]"".equals(name) || ""String[]"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"} else if (""java.lang.String"".equals(name) || ""String"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"} else if (""java.lang.Boolean"".equals(name) || ""Boolean"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"} else if (""boolean"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"} else if (""java.lang.Integer"".equals(name) || ""Integer"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"} else if (""int"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"} else if (""java.lang.Long"".equals(name) || ""Long"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"} else if (""long"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"} else if (""java.lang.Short"".equals(name) || ""Short"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"} else if (""short"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"} else if (""java.lang.Byte"".equals(name) || ""Byte"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"} else if (""byte"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"} else if (""java.lang.Float"".equals(name) || ""Float"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"} else if (""float"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"} else if (""java.lang.Double"".equals(name) || ""Double"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"} else if (""double"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"} else if (""java.lang.Character"".equals(name) || ""Character"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"} else if (""char"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"protected static  Class<?> loadValidInputTypes(String javaType, String type) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
final JavaSourceFacet facet = project.getFacet(JavaSourceFacet.class);,b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
JavaSourceFacet facet = project.getFacet(JavaSourceFacet.class);,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
// TODO if we already have a instance of the same name then lets return null,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
public static Iterable<String> createComponentLabelValues(Project project) {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
// use callable so we can live update the filter,b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
public Iterable<ComponentDto> call() throws Exception {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
String label = componentCategoryFilter.getValue();,b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
public static Iterable<String> createComponentNameValues(Project project) {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
public ComponentDto convert(String name) {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"String groupId = row.get(""groupId"");",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"String version = row.get(""version"");",b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
String groupId = details.getGroupId();,b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
// otherwise use the version from the dto,b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
} else {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
DependencyBuilder component = DependencyBuilder.create().setGroupId(groupId),b2def7948589cf55adb28e0169043b04a81d0dd5,2,0
"DependencyBuilder component = DependencyBuilder.create().setGroupId(""org.apache.camel"")",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"*  2.0 (the ""License""); you may not use this file except in compliance",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
public UICommandMetadata getMetadata(UIContext context) {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
".description(""Creates a new Camel component instance configuration using CDI"");",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
public boolean isEnabled(UIContext context) {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
public void initializeUI(UIBuilder builder) throws Exception {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
final JavaSourceFacet facet = project.getFacet(JavaSourceFacet.class);,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
public ComponentDto convert(String text) {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
// show note about the chosen component,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
public void valueChanged(ValueChangeEvent event) {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
ComponentDto component = (ComponentDto) event.getNewValue();,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
String description = component.getDescription();,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
} else {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
public NavigationResult next(UINavigationContext context) throws Exception {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
public Result execute(UIExecutionContext context) throws Exception {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
protected String getDefaultProducerClassName() {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"*  2.0 (the ""License""); you may not use this file except in compliance",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
// use callable so we can live update the filter,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
public Iterable<ComponentDto> call() throws Exception {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
String label = componentCategoryFilter.getValue();,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"for (Map<String, String> row : data) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"String javaType = row.get(""javaType"");",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"String groupId = row.get(""groupId"");",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"String artifactId = row.get(""artifactId"");",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"String version = row.get(""version"");",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
String groupId = details.getGroupId();,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
String artifactId = details.getArtifactId();,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
Dependency core = CamelProjectHelper.findCamelCoreDependency(project);,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
// otherwise use the version from the dto,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
} else {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
DependencyBuilder component = DependencyBuilder.create().setGroupId(groupId),b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
// install the component,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
public static boolean isCdiProject(Project project) {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
public static boolean isSpringProject(Project project) {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
public static boolean isBlueprintProject(Project project) {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
String componentClassName = details.getComponentClassName();,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"String methodName = ""create"" + Strings.capitalize(componentInstanceName) + ""Component"";",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
int idx = javaType.indexOf('<');,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
if (idx > 0) {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
} catch (Throwable e) {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
private static Class loadStringSupportedType(String javaType) {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"} else if (""java.net.URL"".equals(javaType)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"} else if (""java.net.URI"".equals(javaType)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"} else if (""boolean"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"} else if (""integer"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"} else if (""number"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
private static Class loadPrimitiveWrapperType(String name) {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
// special for byte[] or Object[] as its common to use,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"} else if (""java.lang.Byte[]"".equals(name) || ""Byte[]"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"} else if (""java.lang.Object[]"".equals(name) || ""Object[]"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"} else if (""java.lang.String[]"".equals(name) || ""String[]"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"} else if (""java.lang.String"".equals(name) || ""String"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"} else if (""java.lang.Boolean"".equals(name) || ""Boolean"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"} else if (""java.lang.Integer"".equals(name) || ""Integer"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"} else if (""int"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"} else if (""java.lang.Long"".equals(name) || ""Long"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"} else if (""long"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"} else if (""java.lang.Short"".equals(name) || ""Short"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"} else if (""short"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"} else if (""java.lang.Byte"".equals(name) || ""Byte"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"} else if (""byte"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"} else if (""java.lang.Float"".equals(name) || ""Float"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"} else if (""float"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"} else if (""java.lang.Double"".equals(name) || ""Double"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"} else if (""double"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"} else if (""java.lang.Character"".equals(name) || ""Character"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"} else if (""char"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"public static List<EndpointOptionByGroup> createUIInputsForCamelComponent(String camelComponentName, String uri, int maxOptionsPerPage, boolean consumerOnly, boolean producerOnly,",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"String kind = propertyMap.get(""kind"");",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"String group = propertyMap.get(""group"");",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"String label = propertyMap.get(""label"");",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"String javaType = propertyMap.get(""javaType"");",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"String deprecated = propertyMap.get(""deprecated"");",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"String required = propertyMap.get(""required"");",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
String currentValue = currentValues.get(name);,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"String defaultValue = propertyMap.get(""defaultValue"");",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"String description = propertyMap.get(""description"");",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"String enums = propertyMap.get(""enum"");",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
// filter out options in case we should only include consumers or producers only,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
// if no default value exists then add none as the 1st choice default value,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
// otherwise the GUI makes us force to select an option which is not what we want,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"*  2.0 (the ""License""); you may not use this file except in compliance",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
private String artifactId;,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
public void setComponentClassQName(String componentClassQName) {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
public void setGroupId(String groupId) {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
public void setVersion(String version) {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"*  2.0 (the ""License""); you may not use this file except in compliance",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
int idx = className.lastIndexOf('.');,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
if (idx >= 0) {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
} else {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
public static URLClassLoader getProjectClassLoader(Project project) {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
} catch (ClassNotFoundException e) {,b2def7948589cf55adb28e0169043b04a81d0dd5,2,1
import org.jboss.forge.addon.ui.context.UINavigationContext;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
import org.jboss.forge.addon.ui.result.NavigationResult;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
import org.jboss.forge.addon.ui.wizard.UIWizard;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
import java.util.Map;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
"Map<Object, Object> attributeMap = context.getUIContext().getAttributeMap();",b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
},b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
if (!Strings.isBlank(name)) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
import org.jboss.forge.addon.dependencies.Dependency;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.parser.java.resources.JavaResource;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.roaster.Roaster;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.roaster.model.source.JavaClassSource;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.roaster.model.source.MethodSource;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import static io.fabric8.forge.camel.commands.project.CamelCommands.ensureCamelArtifactIdAdded;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import static io.fabric8.forge.camel.commands.project.CamelCommands.loadCamelComponentDetails;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (!Strings.isBlank(name)) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
},b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (core == null) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"return Results.fail(""The project does not include camel-core"");",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
CamelComponentDetails details = new CamelComponentDetails();,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"Result result = loadCamelComponentDetails(camelComponentName, details);",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (result != null) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"result = ensureCamelArtifactIdAdded(project, details, dependencyInstaller);",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
JavaResource existing = facet.getJavaResource(fqn);,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (existing != null && existing.exists()) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
final JavaClassSource javaClass = Roaster.create(JavaClassSource.class);,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (generatePackageName != null) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
MethodSource<JavaClassSource> method = javaClass.addMethod(),b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.roaster.model.source.JavaClassSource;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
import org.jboss.forge.roaster.model.source.MethodSource;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
import java.util.Date;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
MethodSource<JavaClassSource> method = javaClass.addMethod(),b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
},b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
/**,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
*/,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
try {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
Class<?> clazz = Class.forName(javaType);,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
|| clazz.isPrimitive() || Number.class.isAssignableFrom(clazz)) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
"*  Copyright 2005-2014 Red Hat, Inc.",b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
*     http://www.apache.org/licenses/LICENSE-2.0,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
* http://www.apache.org/licenses/LICENSE-2.0,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
/**,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
*/,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"*  Copyright 2005-2014 Red Hat, Inc.",b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
*     http://www.apache.org/licenses/LICENSE-2.0,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
* http://www.apache.org/licenses/LICENSE-2.0,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
/**,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
*/,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import java.util.Date;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
import java.util.List;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
import java.util.Map;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
import java.util.concurrent.Callable;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
Class<Object> clazz = loadPrimitiveType(javaType);,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
if (clazz == null) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
clazz = (Class<Object>) Class.forName(javaType);,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
},b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
"if (""java.lang.byte[]"".equals(name) || ""byte[]"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
import java.util.Date;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import java.util.List;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import java.util.Map;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import java.util.concurrent.Callable;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import static io.fabric8.forge.camel.commands.project.CamelCatalogHelper.findComponentArchetype;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
Class<?> clazz = Class.forName(javaType);,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import io.fabric8.forge.camel.commands.project.completer.XmlResourcesCamelEndpointsVisitor;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
import org.jboss.forge.addon.resource.visit.ResourceVisitor;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
import java.util.ArrayList;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
import java.util.Iterator;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
import java.util.List;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
List<CamelEndpointDetails> endpoints = new ArrayList<>();,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
"ResourceVisitor visitor = new XmlResourcesCamelEndpointsVisitor((ResourcesFacet) facet, endpoints);",b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
Iterator<CamelEndpointDetails> it = endpoints.iterator();,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
while (it.hasNext()) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
CamelEndpointDetails det = it.next();,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
if (det.getEndpointInstance() != null) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
if (det.getEndpointInstance().equals(instanceName)) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
},b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
import io.fabric8.forge.camel.commands.project.completer.CamelComponentsDtoCompleter;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
final boolean excludeComponentsOnClasspath) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
return new Callable<Iterable<ComponentDto>>() {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
},b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
import org.jboss.forge.addon.convert.Converter;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createComponentDto;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
"componentName.setValueConverter(new Converter<String, ComponentDto>() {",b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
},b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
import io.fabric8.forge.camel.commands.project.completer.CamelComponentsCompleter;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
import io.fabric8.forge.camel.commands.project.completer.CamelComponentsDtoCompleter;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.apache.camel.catalog.DefaultCamelCatalog;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (!Strings.isNullOrEmpty(groupId)) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
},b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
if (!Strings.isNullOrEmpty(version)) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
String version;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
"if (""org.apache.camel"".equals(groupId)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
version = core.getCoordinate().getVersion();,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
version = details.getVersion();,b2def7948589cf55adb28e0169043b04a81d0dd5,1,0
/**,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"*  Copyright 2005-2015 Red Hat, Inc.",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
*,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
*     http://www.apache.org/licenses/LICENSE-2.0,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
*/,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
package io.fabric8.forge.camel.commands.project;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import java.util.Map;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import java.util.concurrent.Callable;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import javax.inject.Inject;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import io.fabric8.forge.addon.utils.completer.PackageNameCompleter;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import io.fabric8.forge.addon.utils.validator.ClassNameValidator;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import io.fabric8.forge.addon.utils.validator.PackageNameValidator;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.convert.Converter;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.dependencies.DependencyResolver;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.facets.constraints.FacetConstraint;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.parser.java.facets.JavaSourceFacet;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.projects.Project;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.projects.facets.ClassLoaderFacet;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.ui.context.UIContext;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.ui.context.UINavigationContext;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.ui.facets.HintsFacet;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.ui.hints.InputType;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.ui.input.UIInput;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.ui.input.UISelectOne;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.ui.result.NavigationResult;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.ui.result.Result;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.ui.result.Results;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.ui.util.Categories;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.ui.util.Metadata;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.ui.wizard.UIWizard;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.roaster.model.util.Strings;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createComponentDto;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
private UIInput<String> className;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"""Camel: New Component CDI"").category(Categories.create(CATEGORY))",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
},b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
boolean enabled = super.isEnabled(context);,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (enabled) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"componentName.setValueConverter(new Converter<String, ComponentDto>() {",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
componentName.addValueChangeListener(new ValueChangeListener() {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (component != null) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
className.setDefaultValue(new Callable<String>() {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"Map<Object, Object> attributeMap = context.getUIContext().getAttributeMap();",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (!Strings.isBlank(name)) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
/**,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"*  Copyright 2005-2015 Red Hat, Inc.",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
*,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
*     http://www.apache.org/licenses/LICENSE-2.0,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
*/,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import java.util.ArrayList;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import java.util.Collections;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import java.util.Date;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import java.util.HashSet;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import java.util.List;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import java.util.Map;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import java.util.Set;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import java.util.concurrent.Callable;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import io.fabric8.forge.addon.utils.CamelProjectHelper;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import io.fabric8.forge.camel.commands.project.completer.CamelComponentsCompleter;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import io.fabric8.forge.camel.commands.project.completer.CamelComponentsLabelCompleter;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import io.fabric8.forge.camel.commands.project.model.CamelComponentDetails;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import io.fabric8.forge.camel.commands.project.model.EndpointOptionByGroup;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.apache.camel.catalog.CamelCatalog;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.apache.camel.catalog.JSonSchemaHelper;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.convert.ConverterFactory;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.dependencies.Dependency;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.projects.Project;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.ui.context.UIContext;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.ui.input.InputComponentFactory;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.ui.input.UISelectOne;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.ui.result.Result;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.ui.result.Results;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.roaster.model.source.JavaClassSource;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.roaster.model.source.MethodSource;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.roaster.model.util.Strings;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import static io.fabric8.forge.addon.utils.UIHelper.createUIInput;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.endpointComponentName;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
},b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
final boolean excludeComponentsOnClasspath) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
return new Callable<Iterable<ComponentDto>>() {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (json == null) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""component"", json, false);",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (!Strings.isNullOrEmpty(javaType)) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (!Strings.isNullOrEmpty(groupId)) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (!Strings.isNullOrEmpty(artifactId)) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (!Strings.isNullOrEmpty(version)) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (Strings.isNullOrEmpty(details.getComponentClassQName())) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (core == null) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"return Results.fail(""The project does not include camel-core"");",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
String version;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"if (""org.apache.camel"".equals(groupId)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
version = core.getCoordinate().getVersion();,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
version = details.getVersion();,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
MethodSource<JavaClassSource> method = javaClass.addMethod(),b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"// we have generics in the javatype, if so remove it so its loadable from a classloader",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"javaType = javaType.substring(0, idx);",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
try {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
Class<Object> clazz = getPrimitiveWrapperClassType(type);,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (clazz == null) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
clazz = loadPrimitiveWrapperType(javaType);,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
clazz = loadStringSupportedType(javaType);,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
clazz = (Class<Object>) Class.forName(javaType);,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"if (""object"".equals(type)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"clazz = loadPrimitiveWrapperType(""java.lang.String"");",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
|| clazz.isPrimitive() || Number.class.isAssignableFrom(clazz))) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"if (""java.io.File"".equals(javaType)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"if (""string"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"if (""java.lang.byte[]"".equals(name) || ""byte[]"".equals(name)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"CamelCatalog camelCatalog, InputComponentFactory componentFactory, ConverterFactory converterFactory, UIContext ui) throws Exception {",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
List<EndpointOptionByGroup> answer = new ArrayList<>();,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (camelComponentName == null && uri != null) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
camelComponentName = endpointComponentName(uri);,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"boolean componentConsumerOnly = CamelCatalogHelper.isComponentConsumerOnly(camelCatalog, camelComponentName);",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"boolean componentProducerOnly = CamelCatalogHelper.isComponentProducerOnly(camelCatalog, camelComponentName);",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (componentConsumerOnly || componentProducerOnly) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
consumerOnly = false;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
producerOnly = false;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""properties"", json, true);",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"Map<String, String> currentValues = uri != null ? camelCatalog.endpointProperties(uri) : Collections.EMPTY_MAP;",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (data != null) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
List<InputComponent> inputs = new ArrayList<>();,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
EndpointOptionByGroup current = new EndpointOptionByGroup();,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
Set<String> namesAdded = new HashSet<>();,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"for (Map<String, String> propertyMap : data) {",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (current.getGroup() == null) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (group != null && !group.equals(current.getGroup())) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (!current.getInputs().isEmpty()) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
inputs = new ArrayList<>();,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
current = new EndpointOptionByGroup();,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (consumerOnly && label != null) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"if (!label.contains(""consumer"")) {",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (producerOnly && label != null) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"if (!label.contains(""producer"")) {",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (!Strings.isNullOrEmpty(name)) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"Class<Object> inputClazz = CamelCommandsHelper.loadValidInputTypes(javaType, type);",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (inputClazz != null) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (namesAdded.add(name)) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
// we do not want descriptions in CLI mode as it makes the UI clutter,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
boolean gui = ui.getProvider().isGUI();,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (!gui) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"description = """";",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"if (enums != null && required == null || ""false"".equals(required)) {",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (defaultValue == null || defaultValue.isEmpty()) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"defaultValue = ""none"";",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"if (!enums.startsWith(""none,"")) {",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"enums = ""none,"" + enums;",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"InputComponent input = createUIInput(componentFactory, converterFactory, name, inputClazz, required, currentValue, defaultValue, enums, description);",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (input != null) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
// if we hit max options then create a new group,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (inputs.size() == maxOptionsPerPage) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
// add last group if there was some new inputs,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (!inputs.isEmpty()) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
/**,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"*  Copyright 2005-2015 Red Hat, Inc.",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
*,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
*     http://www.apache.org/licenses/LICENSE-2.0,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
*/,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import io.fabric8.forge.addon.utils.JavaHelper;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
private String componentClassQName;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
private String componentClassName;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
private String groupId;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
private String version;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
this.componentClassQName = componentClassQName;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
this.componentClassName = JavaHelper.removeJavaPackageName(componentClassQName);,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
},b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
return artifactId;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
this.groupId = groupId;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
this.version = version;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
/**,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
"*  Copyright 2005-2015 Red Hat, Inc.",b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
*,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
*     http://www.apache.org/licenses/LICENSE-2.0,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
*/,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import java.net.URLClassLoader;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.projects.Project;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
import org.jboss.forge.addon.projects.facets.ClassLoaderFacet;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
return className;,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
},b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (project != null) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
ClassLoaderFacet classLoaderFacet = project.getFacet(ClassLoaderFacet.class);,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
if (classLoaderFacet != null) {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
URLClassLoader classLoader = getProjectClassLoader(project);,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
try {,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
Class<?> clazz = classLoader.loadClass(className);,b2def7948589cf55adb28e0169043b04a81d0dd5,1,1
@Override,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"attributeMap.put(""componentName"", componentName.getValue());",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"attributeMap.put(""instanceName"", instanceName.getValue());",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"attributeMap.put(""targetPackage"", targetPackage.getValue());",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"attributeMap.put(""className"", className.getValue());",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"attributeMap.put(""kind"", ""cdi"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return Results.navigateTo(ConfigureComponentPropertiesStep.class);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return Results.success();,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"return Strings.capitalize(name) + ""ComponentProducer"";",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return null;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"return Strings.capitalize(name) + ""ComponentProducer"";",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return null;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return result;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
javaClass.setName(generateClassName);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
javaClass.setPackage(generatePackageName);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"javaClass.addImport(""javax.enterprise.inject.Produces"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"javaClass.addImport(""javax.inject.Singleton"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"javaClass.addImport(""javax.inject.Named"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
javaClass.addImport(details.getComponentClassQName());,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
.setPublic(),b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
.setReturnType(componentClassName),b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
.setName(methodName),b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
.setBody(body),b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
.addThrows(Exception.class);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"method.addAnnotation(""Named"").setStringValue(camelComponentName);",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"method.addAnnotation(""Produces"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"method.addAnnotation(""Singleton"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
facet.saveJavaSource(javaClass);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"javaClass.addImport(""javax.enterprise.inject.Produces"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"javaClass.addImport(""javax.inject.Singleton"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"javaClass.addImport(""javax.inject.Named"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
javaClass.addImport(details.getComponentClassQName());,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
.setPublic(),b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
.setReturnType(componentClassName),b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
.setName(methodName),b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
.setBody(body),b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
.addThrows(Exception.class);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"method.addAnnotation(""Named"").setStringValue(camelComponentName);",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"method.addAnnotation(""Produces"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"method.addAnnotation(""Singleton"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"javaClass.addAnnotation(""Component"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"javaClass.addImport(""org.springframework.beans.factory.config.BeanDefinition"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"javaClass.addImport(""org.springframework.beans.factory.annotation.Qualifier"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"javaClass.addImport(""org.springframework.context.annotation.Bean"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"javaClass.addImport(""org.springframework.context.annotation.Scope"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"javaClass.addImport(""org.springframework.stereotype.Component"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"method.addAnnotation(""Qualifier"").setStringValue(camelComponentName);",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"method.addAnnotation(""Bean"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"method.addAnnotation(""Scope"").setLiteralValue(""BeanDefinition.SCOPE_SINGLETON"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
if (clazz.equals(String.class) || clazz.equals(Date.class),b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return clazz;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
// ignore errors,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return null;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"System.out.println(""Row: "" + row);",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
className.addValidator(new ClassNameValidator(false));,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
className.addValidator(new ClassNameValidator());,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
CamelProjectHelper.findCamelSpringDependency(project) != null;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return byte[].class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return Byte[].class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return Object[].class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return String[].class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
// and these is common as well,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return String.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return Boolean.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return boolean.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return Integer.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return int.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return Long.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return long.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return Short.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return short.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return Byte.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return byte.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return Float.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return float.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return Double.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return double.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return Character.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return char.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return null;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
CamelProjectHelper.findCamelSpringDependency(project) != null;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
((ResourcesFacet) facet).visitResources(visitor);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return null;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"final UISelectOne<String> componentCategoryFilter,",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
@Override,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"return new CamelComponentsDtoCompleter(project, null, excludeComponentsOnClasspath).getValueChoices(label);",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
};,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
private UISelectOne<ComponentDto> componentName;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"componentName.setValueChoices(CamelCommandsHelper.createComponentDtoValues(project, componentNameFilter, false));",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
@Override,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
return createComponentDto(name);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
});,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"attributeMap.put(""componentName"", componentName.getValue().getScheme());",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
private UISelectOne<String> componentName;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"componentName.setValueChoices(CamelCommandsHelper.createComponentNameValues(project, componentNameFilter, false));",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"attributeMap.put(""componentName"", componentName.getValue());",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"return new CamelComponentsCompleter(project, camelCatalog, null, excludeComponentsOnClasspath).getValueChoices(label);",b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
"return new CamelComponentsDtoCompleter(project, camelCatalog, null, excludeComponentsOnClasspath).getValueChoices(label);",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
details.setGroupId(groupId);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
details.setVersion(version);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
.setArtifactId(artifactId).setVersion(version);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,0
.setArtifactId(artifactId).setVersion(core.getCoordinate().getVersion());,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"@FacetConstraint({JavaSourceFacet.class, ResourcesFacet.class, ClassLoaderFacet.class})",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
@Inject,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
private UISelectOne<String> componentNameFilter;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
private UISelectOne<ComponentDto> componentName;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
private UIInput<String> instanceName;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
private UIInput<String> targetPackage;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
private DependencyInstaller dependencyInstaller;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
private DependencyResolver dependencyResolver;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
@Override,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return Metadata.forCommand(CamelNewComponentInstanceCDICommand.class).name(,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return CamelCommandsHelper.isCdiProject(getSelectedProject(context));,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return false;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"componentNameFilter.setValueChoices(CamelCommandsHelper.createComponentLabelValues(project, getCamelCatalog()));",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"componentNameFilter.setDefaultValue(""<all>"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"componentName.setValueChoices(CamelCommandsHelper.createComponentDtoValues(project, getCamelCatalog(), componentNameFilter, false));",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
// include converter from string->dto,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"return createComponentDto(getCamelCatalog(), text);",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
});,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"componentName.setNote(description != null ? description : """");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"componentName.setNote("""");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
targetPackage.setCompleter(new PackageNameCompleter(facet));,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
targetPackage.addValidator(new PackageNameValidator());,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
targetPackage.getFacet(HintsFacet.class).setInputType(InputType.JAVA_PACKAGE_PICKER);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
className.addValidator(new ClassNameValidator(false));,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return getDefaultProducerClassName();,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
className.getFacet(HintsFacet.class).setInputType(InputType.JAVA_CLASS_PICKER);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
builder.add(componentNameFilter).add(componentName).add(instanceName).add(targetPackage).add(className);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"attributeMap.put(""componentName"", componentName.getValue().getScheme());",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"attributeMap.put(""instanceName"", instanceName.getValue());",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"attributeMap.put(""targetPackage"", targetPackage.getValue());",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"attributeMap.put(""className"", className.getValue());",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"attributeMap.put(""kind"", ""cdi"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return Results.navigateTo(ConfigureComponentPropertiesStep.class);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return Results.success();,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"return Strings.capitalize(name) + ""ComponentProducer"";",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return null;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
package io.fabric8.forge.camel.commands.project.helper;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"return new CamelComponentsLabelCompleter(project, camelCatalog).getValueChoices();",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"final UISelectOne<String> componentCategoryFilter,",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
@Override,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"return new CamelComponentsCompleter(project, camelCatalog, null, excludeComponentsOnClasspath).getValueChoices(label);",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
};,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
details.setComponentClassQName(javaType);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
details.setGroupId(groupId);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
details.setArtifactId(artifactId);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
details.setVersion(version);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return null;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
.setArtifactId(artifactId).setVersion(version);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"dependencyInstaller.install(project, component);",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return CamelProjectHelper.findCamelCDIDependency(project) != null;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return CamelProjectHelper.findCamelSpringDependency(project) != null;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return CamelProjectHelper.findCamelBlueprintDependency(project) != null;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"javaClass.addImport(""javax.enterprise.inject.Produces"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"javaClass.addImport(""javax.inject.Singleton"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"javaClass.addImport(""javax.inject.Named"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
javaClass.addImport(details.getComponentClassQName());,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
.setPublic(),b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
.setReturnType(componentClassName),b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
.setName(methodName),b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
.setBody(body),b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
.addThrows(Exception.class);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"method.addAnnotation(""Named"").setStringValue(camelComponentName);",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"method.addAnnotation(""Produces"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"method.addAnnotation(""Singleton"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"javaClass.addAnnotation(""Component"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"javaClass.addImport(""org.springframework.beans.factory.config.BeanDefinition"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"javaClass.addImport(""org.springframework.beans.factory.annotation.Qualifier"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"javaClass.addImport(""org.springframework.context.annotation.Bean"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"javaClass.addImport(""org.springframework.context.annotation.Scope"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"javaClass.addImport(""org.springframework.stereotype.Component"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"method.addAnnotation(""Qualifier"").setStringValue(camelComponentName);",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"method.addAnnotation(""Bean"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
"method.addAnnotation(""Scope"").setLiteralValue(""BeanDefinition.SCOPE_SINGLETON"");",b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
// favor specialized UI for these types,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
if (clazz != null && (clazz.equals(String.class) || clazz.equals(Date.class) || clazz.equals(Boolean.class),b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return clazz;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
// ignore errors,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return String.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return Boolean.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return Integer.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return Float.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return Byte[].class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return Object[].class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return String[].class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
// and these is common as well,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return Long.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return Short.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return Byte.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return Double.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return Character.class;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
current.setGroup(null);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
current.setInputs(inputs);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
current.setGroup(group);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
// its a new group,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
answer.add(current);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
// get ready for a new group,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
continue;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
// if its an enum and its optional then make sure there is a default value,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
inputs.add(input);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return answer;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
package io.fabric8.forge.camel.commands.project.model;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return componentClassQName;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return componentClassName;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return groupId;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return version;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
package io.fabric8.forge.addon.utils;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return className.substring(idx + 1);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return classLoaderFacet.getClassLoader();,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return null;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
if (classLoader != null ){,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return true;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
// ignore,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return false;,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
return classLoader.loadClass(className);,b2def7948589cf55adb28e0169043b04a81d0dd5,0,1
public static boolean isCdiProject(Project project) {,a2499de2625bf07349d563e4e3fab32070d2559c,5,1
public static boolean isSpringProject(Project project) {,a2499de2625bf07349d563e4e3fab32070d2559c,5,1
public static boolean isBlueprintProject(Project project) {,a2499de2625bf07349d563e4e3fab32070d2559c,5,1
public static URLClassLoader getProjectClassLoader(Project project) {,a2499de2625bf07349d563e4e3fab32070d2559c,5,1
* Loads a class of the given name from the project class loader or returns null if its not found,a2499de2625bf07349d563e4e3fab32070d2559c,5,1
public static Class getPrimitiveWrapperClassType(String name) {,a2499de2625bf07349d563e4e3fab32070d2559c,4,1
"public static List<EndpointOptionByGroup> createUIInputsForCamelComponent(String camelComponentName, String uri, int maxOptionsPerPage, boolean consumerOnly, boolean producerOnly,",a2499de2625bf07349d563e4e3fab32070d2559c,4,1
"// is the component consumer or producer only, if so we do not need any kind of filter",a2499de2625bf07349d563e4e3fab32070d2559c,4,1
"if (enums != null && required == null || ""false"".equals(required)) {",a2499de2625bf07349d563e4e3fab32070d2559c,4,1
"public static boolean projectHasClassOnClassPath(Project project, String className) {",a2499de2625bf07349d563e4e3fab32070d2559c,4,1
public class CamelNewComponentInstanceCDICommand extends AbstractCamelProjectCommand implements UIWizard {,a2499de2625bf07349d563e4e3fab32070d2559c,3,1
public boolean isEnabled(UIContext context) {,a2499de2625bf07349d563e4e3fab32070d2559c,3,1
public final class CamelCommandsHelper {,a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"public static Iterable<String> createComponentLabelValues(Project project, CamelCatalog camelCatalog) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"public static Callable<Iterable<ComponentDto>> createComponentDtoValues(final Project project, final CamelCatalog camelCatalog,",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"public static Result loadCamelComponentDetails(CamelCatalog camelCatalog, String camelComponentName, CamelComponentDetails details) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"return Results.fail(""Could not find fully qualified class name in catalog for component name: "" + camelComponentName);",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"public static Result ensureCamelArtifactIdAdded(Project project, CamelComponentDetails details, DependencyInstaller dependencyInstaller) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
// we want to use same version as camel-core if its a camel component,a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"public static void createCdiComponentProducerClass(JavaClassSource javaClass, CamelComponentDetails details, String camelComponentName, String componentInstanceName, String configurationCode) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"public static void createSpringComponentFactoryClass(JavaClassSource javaClass, CamelComponentDetails details, String camelComponentName, String componentInstanceName, String configurationCode) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
* Converts a java type as a string to a valid input type and returns the class or null if its not supported,a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"public static Class<Object> loadValidInputTypes(String javaType, String type) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"// we have generics in the javatype, if so remove it so its loadable from a classloader",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
private static Class loadStringSupportedType(String javaType) {,a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"} else if (""java.net.URL"".equals(javaType)) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"} else if (""java.net.URI"".equals(javaType)) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"} else if (""boolean"".equals(name)) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"} else if (""integer"".equals(name)) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"} else if (""number"".equals(name)) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
private static Class loadPrimitiveWrapperType(String name) {,a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"} else if (""java.lang.Byte[]"".equals(name) || ""Byte[]"".equals(name)) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"} else if (""java.lang.Object[]"".equals(name) || ""Object[]"".equals(name)) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"} else if (""java.lang.String[]"".equals(name) || ""String[]"".equals(name)) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"} else if (""java.lang.String"".equals(name) || ""String"".equals(name)) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"} else if (""java.lang.Boolean"".equals(name) || ""Boolean"".equals(name)) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"} else if (""java.lang.Integer"".equals(name) || ""Integer"".equals(name)) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"} else if (""int"".equals(name)) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"} else if (""java.lang.Long"".equals(name) || ""Long"".equals(name)) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"} else if (""long"".equals(name)) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"} else if (""java.lang.Short"".equals(name) || ""Short"".equals(name)) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"} else if (""short"".equals(name)) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"} else if (""java.lang.Byte"".equals(name) || ""Byte"".equals(name)) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"} else if (""byte"".equals(name)) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"} else if (""java.lang.Float"".equals(name) || ""Float"".equals(name)) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"} else if (""float"".equals(name)) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"} else if (""java.lang.Double"".equals(name) || ""Double"".equals(name)) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"} else if (""double"".equals(name)) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"} else if (""java.lang.Character"".equals(name) || ""Character"".equals(name)) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"} else if (""char"".equals(name)) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
if (camelComponentName == null && uri != null) {,a2499de2625bf07349d563e4e3fab32070d2559c,3,1
if (group != null && !group.equals(current.getGroup())) {,a2499de2625bf07349d563e4e3fab32070d2559c,3,1
// if its an enum and its optional then make sure there is a default value,a2499de2625bf07349d563e4e3fab32070d2559c,3,1
if (defaultValue == null || defaultValue.isEmpty()) {,a2499de2625bf07349d563e4e3fab32070d2559c,3,1
public final class JavaHelper {,a2499de2625bf07349d563e4e3fab32070d2559c,3,1
public static String removeJavaPackageName(String className) {,a2499de2625bf07349d563e4e3fab32070d2559c,3,1
"public static Class<?> loadProjectClass(Project project, String className) {",a2499de2625bf07349d563e4e3fab32070d2559c,3,1
public UICommandMetadata getMetadata(UIContext context) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
".description(""Creates a new Camel component instance configuration using CDI"");",a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (enabled) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
public void initializeUI(UIBuilder builder) throws Exception {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
Project project = getSelectedProject(builder.getUIContext());,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
public ComponentDto convert(String text) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
// show note about the chosen component,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
public void valueChanged(ValueChangeEvent event) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (component != null) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
} else {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
public String call() throws Exception {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
public NavigationResult next(UINavigationContext context) throws Exception {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
public Result execute(UIExecutionContext context) throws Exception {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (!Strings.isBlank(name)) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
final boolean excludeComponentsOnClasspath) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
return new Callable<Iterable<ComponentDto>>() {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
public Iterable<ComponentDto> call() throws Exception {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (json == null) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
"return Results.fail(""Could not find catalog entry for component name: "" + camelComponentName);",a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (!Strings.isNullOrEmpty(javaType)) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (!Strings.isNullOrEmpty(groupId)) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (!Strings.isNullOrEmpty(artifactId)) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (!Strings.isNullOrEmpty(version)) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (Strings.isNullOrEmpty(details.getComponentClassQName())) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (core == null) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
"return Results.fail(""The project does not include camel-core"");",a2499de2625bf07349d563e4e3fab32070d2559c,2,1
"if (""org.apache.camel"".equals(groupId)) {",a2499de2625bf07349d563e4e3fab32070d2559c,2,1
} else {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
// install the component,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (idx > 0) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (clazz == null) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
} catch (Throwable e) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
"if (""object"".equals(type)) {",a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (clazz != null && (clazz.equals(String.class) || clazz.equals(Date.class) || clazz.equals(Boolean.class),a2499de2625bf07349d563e4e3fab32070d2559c,2,1
"if (""java.io.File"".equals(javaType)) {",a2499de2625bf07349d563e4e3fab32070d2559c,2,1
* @return the primitive Java Class type,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
"if (""string"".equals(name)) {",a2499de2625bf07349d563e4e3fab32070d2559c,2,1
"if (""java.lang.byte[]"".equals(name) || ""byte[]"".equals(name)) {",a2499de2625bf07349d563e4e3fab32070d2559c,2,1
// and these is common as well,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (componentConsumerOnly || componentProducerOnly) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
"// reset the filters as the component can only be one of them anyway, so we should show all options",a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (data != null) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (current.getGroup() == null) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (!current.getInputs().isEmpty()) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
// this group is now done so add to answer,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (consumerOnly && label != null) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
"if (!label.contains(""consumer"")) {",a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (producerOnly && label != null) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
"if (!label.contains(""producer"")) {",a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (!Strings.isNullOrEmpty(name)) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (inputClazz != null) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (namesAdded.add(name)) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (!gui) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
// if no default value exists then add none as the 1st choice default value,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
// otherwise the GUI makes us force to select an option which is not what we want,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
"if (!enums.startsWith(""none,"")) {",a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (input != null) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
// if we hit max options then create a new group,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (inputs.size() == maxOptionsPerPage) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
// add last group if there was some new inputs,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (!inputs.isEmpty()) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (idx >= 0) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
} else {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (project != null) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (classLoaderFacet != null) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
URLClassLoader classLoader = getProjectClassLoader(project);,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
if (classLoader != null ){,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
} catch (ClassNotFoundException e) {,a2499de2625bf07349d563e4e3fab32070d2559c,2,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",a2499de2625bf07349d563e4e3fab32070d2559c,1,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createComponentDto;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
@Inject,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
"@WithAttributes(label = ""Component Name"", required = true, description = ""Name of component type to add"")",a2499de2625bf07349d563e4e3fab32070d2559c,1,1
"@WithAttributes(label = ""Instance Name"", required = true, description = ""Name of component instance to add"")",a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return Metadata.forCommand(CamelNewComponentInstanceCDICommand.class).name(,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
},a2499de2625bf07349d563e4e3fab32070d2559c,1,1
boolean enabled = super.isEnabled(context);,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return CamelCommandsHelper.isCdiProject(getSelectedProject(context));,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return false;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
// include converter from string->dto,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
"componentName.setValueConverter(new Converter<String, ComponentDto>() {",a2499de2625bf07349d563e4e3fab32070d2559c,1,1
"return createComponentDto(getCamelCatalog(), text);",a2499de2625bf07349d563e4e3fab32070d2559c,1,1
componentName.addValueChangeListener(new ValueChangeListener() {,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
ComponentDto component = (ComponentDto) event.getNewValue();,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
"componentName.setNote(description != null ? description : """");",a2499de2625bf07349d563e4e3fab32070d2559c,1,1
className.setDefaultValue(new Callable<String>() {,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return getDefaultProducerClassName();,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return Results.navigateTo(ConfigureComponentPropertiesStep.class);,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return Results.success();,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
protected String getDefaultProducerClassName() {,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
"return Strings.capitalize(name) + ""ComponentProducer"";",a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return null;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",a2499de2625bf07349d563e4e3fab32070d2559c,1,1
import static io.fabric8.forge.addon.utils.UIHelper.createUIInput;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.endpointComponentName;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
"return new CamelComponentsLabelCompleter(project, camelCatalog).getValueChoices();",a2499de2625bf07349d563e4e3fab32070d2559c,1,1
},a2499de2625bf07349d563e4e3fab32070d2559c,1,1
// use callable so we can live update the filter,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
"return new CamelComponentsCompleter(project, camelCatalog, null, excludeComponentsOnClasspath).getValueChoices(label);",a2499de2625bf07349d563e4e3fab32070d2559c,1,1
"* Populates the details for the given component, returning a Result if it fails.",a2499de2625bf07349d563e4e3fab32070d2559c,1,1
"for (Map<String, String> row : data) {",a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return null;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
Dependency core = CamelProjectHelper.findCamelCoreDependency(project);,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
// otherwise use the version from the dto,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
DependencyBuilder component = DependencyBuilder.create().setGroupId(groupId),a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return CamelProjectHelper.findCamelCDIDependency(project) != null;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return CamelProjectHelper.findCamelSpringDependency(project) != null;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return CamelProjectHelper.findCamelBlueprintDependency(project) != null;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
"String body = componentClassName + "" component = new "" + componentClassName + ""();"" + configurationCode + ""\nreturn component;"";",a2499de2625bf07349d563e4e3fab32070d2559c,1,1
try {,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
"// its a custom java type so use String as the input type, so you can refer to it using # lookup",a2499de2625bf07349d563e4e3fab32070d2559c,1,1
// favor specialized UI for these types,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
|| clazz.isPrimitive() || Number.class.isAssignableFrom(clazz))) {,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return clazz;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
// ignore errors,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return String.class;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return Boolean.class;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return Integer.class;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return Float.class;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
// special for byte[] or Object[] as its common to use,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return Byte[].class;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return Object[].class;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return String[].class;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return Long.class;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return Short.class;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return Byte.class;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return Double.class;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return Character.class;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
"CamelCatalog camelCatalog, InputComponentFactory componentFactory, ConverterFactory converterFactory, UIContext ui) throws Exception {",a2499de2625bf07349d563e4e3fab32070d2559c,1,1
"throw new IllegalArgumentException(""Could not find catalog entry for component name: "" + camelComponentName);",a2499de2625bf07349d563e4e3fab32070d2559c,1,1
"boolean componentConsumerOnly = CamelCatalogHelper.isComponentConsumerOnly(camelCatalog, camelComponentName);",a2499de2625bf07349d563e4e3fab32070d2559c,1,1
"boolean componentProducerOnly = CamelCatalogHelper.isComponentProducerOnly(camelCatalog, camelComponentName);",a2499de2625bf07349d563e4e3fab32070d2559c,1,1
"Map<String, String> currentValues = uri != null ? camelCatalog.endpointProperties(uri) : Collections.EMPTY_MAP;",a2499de2625bf07349d563e4e3fab32070d2559c,1,1
"for (Map<String, String> propertyMap : data) {",a2499de2625bf07349d563e4e3fab32070d2559c,1,1
// its a new group,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
// get ready for a new group,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
// filter out options in case we should only include consumers or producers only,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
// we do not want descriptions in CLI mode as it makes the UI clutter,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
boolean gui = ui.getProvider().isGUI();,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return answer;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return className.substring(idx + 1);,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return className;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
},a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return classLoaderFacet.getClassLoader();,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return null;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
try {,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return true;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
// ignore,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return false;,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
return classLoader.loadClass(className);,a2499de2625bf07349d563e4e3fab32070d2559c,1,1
/**,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
*,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"*  Red Hat licenses this file to you under the Apache License, version",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
*  with the License.  You may obtain a copy of the License at,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"*  Unless required by applicable law or agreed to in writing, software",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
*  implied.  See the License for the specific language governing,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
*  permissions and limitations under the License.,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
*/,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
package io.fabric8.forge.camel.commands.project;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import java.util.Map;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import java.util.concurrent.Callable;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import javax.inject.Inject;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import io.fabric8.forge.addon.utils.completer.PackageNameCompleter;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import io.fabric8.forge.addon.utils.validator.ClassNameValidator;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import io.fabric8.forge.addon.utils.validator.PackageNameValidator;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.convert.Converter;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.dependencies.DependencyResolver;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.facets.constraints.FacetConstraint;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.parser.java.facets.JavaSourceFacet;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.projects.Project;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.projects.facets.ClassLoaderFacet;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.ui.context.UIContext;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.ui.context.UINavigationContext;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.ui.facets.HintsFacet;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.ui.hints.InputType;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.ui.input.UIInput;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.ui.input.UISelectOne;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.ui.result.NavigationResult;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.ui.result.Result;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.ui.result.Results;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.ui.util.Categories;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.ui.util.Metadata;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.ui.wizard.UIWizard;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.roaster.model.util.Strings;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"@FacetConstraint({JavaSourceFacet.class, ResourcesFacet.class, ClassLoaderFacet.class})",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"@WithAttributes(label = ""Filter"", required = false, description = ""To filter components"")",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
private UISelectOne<String> componentNameFilter;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
private UISelectOne<ComponentDto> componentName;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
private UIInput<String> instanceName;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"@WithAttributes(label = ""Package Name"", required = false, description = ""The package name where this type will be created"")",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
private UIInput<String> targetPackage;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"@WithAttributes(label = ""Class Name"", required = true, description = ""Name of @Producer class"")",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
private UIInput<String> className;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
private DependencyInstaller dependencyInstaller;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
private DependencyResolver dependencyResolver;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
@Override,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"""Camel: New Component CDI"").category(Categories.create(CATEGORY))",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
final JavaSourceFacet facet = project.getFacet(JavaSourceFacet.class);,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"componentNameFilter.setValueChoices(CamelCommandsHelper.createComponentLabelValues(project, getCamelCatalog()));",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"componentNameFilter.setDefaultValue(""<all>"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"componentName.setValueChoices(CamelCommandsHelper.createComponentDtoValues(project, getCamelCatalog(), componentNameFilter, false));",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
});,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
String description = component.getDescription();,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"componentName.setNote("""");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
targetPackage.setCompleter(new PackageNameCompleter(facet));,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
targetPackage.addValidator(new PackageNameValidator());,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
targetPackage.getFacet(HintsFacet.class).setInputType(InputType.JAVA_PACKAGE_PICKER);,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
className.addValidator(new ClassNameValidator(false));,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
className.getFacet(HintsFacet.class).setInputType(InputType.JAVA_CLASS_PICKER);,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
builder.add(componentNameFilter).add(componentName).add(instanceName).add(targetPackage).add(className);,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"Map<Object, Object> attributeMap = context.getUIContext().getAttributeMap();",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"attributeMap.put(""componentName"", componentName.getValue().getScheme());",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"attributeMap.put(""instanceName"", instanceName.getValue());",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"attributeMap.put(""targetPackage"", targetPackage.getValue());",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"attributeMap.put(""className"", className.getValue());",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"attributeMap.put(""kind"", ""cdi"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
String name = instanceName.getValue();,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
/**,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
*,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"*  Red Hat licenses this file to you under the Apache License, version",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
*  with the License.  You may obtain a copy of the License at,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"*  Unless required by applicable law or agreed to in writing, software",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
*  implied.  See the License for the specific language governing,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
*  permissions and limitations under the License.,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
*/,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
package io.fabric8.forge.camel.commands.project.helper;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import java.util.ArrayList;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import java.util.Collections;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import java.util.Date;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import java.util.HashSet;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import java.util.List;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import java.util.Map;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import java.util.Set;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import java.util.concurrent.Callable;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import io.fabric8.forge.addon.utils.CamelProjectHelper;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import io.fabric8.forge.camel.commands.project.completer.CamelComponentsCompleter;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import io.fabric8.forge.camel.commands.project.completer.CamelComponentsLabelCompleter;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import io.fabric8.forge.camel.commands.project.model.CamelComponentDetails;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import io.fabric8.forge.camel.commands.project.model.EndpointOptionByGroup;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.apache.camel.catalog.CamelCatalog;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.apache.camel.catalog.JSonSchemaHelper;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.convert.ConverterFactory;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.dependencies.Dependency;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.projects.Project;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.ui.context.UIContext;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.ui.input.InputComponent;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.ui.input.InputComponentFactory;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.ui.input.UISelectOne;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.ui.result.Result;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.ui.result.Results;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.roaster.model.source.JavaClassSource;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.roaster.model.source.MethodSource;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.roaster.model.util.Strings;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"final UISelectOne<String> componentCategoryFilter,",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
@Override,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
String label = componentCategoryFilter.getValue();,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
};,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
String json = camelCatalog.componentJSonSchema(camelComponentName);,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""component"", json, false);",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"String javaType = row.get(""javaType"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
details.setComponentClassQName(javaType);,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"String groupId = row.get(""groupId"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
details.setGroupId(groupId);,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"String artifactId = row.get(""artifactId"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
details.setArtifactId(artifactId);,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"String version = row.get(""version"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
details.setVersion(version);,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
String groupId = details.getGroupId();,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
String artifactId = details.getArtifactId();,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
String version;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
version = core.getCoordinate().getVersion();,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
version = details.getVersion();,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
.setArtifactId(artifactId).setVersion(version);,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"dependencyInstaller.install(project, component);",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"javaClass.addImport(""javax.enterprise.inject.Produces"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"javaClass.addImport(""javax.inject.Singleton"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"javaClass.addImport(""javax.inject.Named"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
javaClass.addImport(details.getComponentClassQName());,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
String componentClassName = details.getComponentClassName();,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"String methodName = ""create"" + Strings.capitalize(componentInstanceName) + ""Component"";",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
MethodSource<JavaClassSource> method = javaClass.addMethod(),a2499de2625bf07349d563e4e3fab32070d2559c,0,1
.setPublic(),a2499de2625bf07349d563e4e3fab32070d2559c,0,1
.setReturnType(componentClassName),a2499de2625bf07349d563e4e3fab32070d2559c,0,1
.setName(methodName),a2499de2625bf07349d563e4e3fab32070d2559c,0,1
.setBody(body),a2499de2625bf07349d563e4e3fab32070d2559c,0,1
.addThrows(Exception.class);,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"method.addAnnotation(""Named"").setStringValue(camelComponentName);",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"method.addAnnotation(""Produces"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"method.addAnnotation(""Singleton"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"javaClass.addAnnotation(""Component"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"javaClass.addImport(""org.springframework.beans.factory.config.BeanDefinition"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"javaClass.addImport(""org.springframework.beans.factory.annotation.Qualifier"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"javaClass.addImport(""org.springframework.context.annotation.Bean"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"javaClass.addImport(""org.springframework.context.annotation.Scope"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"javaClass.addImport(""org.springframework.stereotype.Component"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"method.addAnnotation(""Qualifier"").setStringValue(camelComponentName);",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"method.addAnnotation(""Bean"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"method.addAnnotation(""Scope"").setLiteralValue(""BeanDefinition.SCOPE_SINGLETON"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
int idx = javaType.indexOf('<');,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"javaType = javaType.substring(0, idx);",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
Class<Object> clazz = getPrimitiveWrapperClassType(type);,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
clazz = loadPrimitiveWrapperType(javaType);,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
clazz = loadStringSupportedType(javaType);,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
clazz = (Class<Object>) Class.forName(javaType);,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"clazz = loadPrimitiveWrapperType(""java.lang.String"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
* Gets the JSon schema primitive type.,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
* @param name the json type,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
List<EndpointOptionByGroup> answer = new ArrayList<>();,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
camelComponentName = endpointComponentName(uri);,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
consumerOnly = false;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
producerOnly = false;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""properties"", json, true);",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
List<InputComponent> inputs = new ArrayList<>();,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
EndpointOptionByGroup current = new EndpointOptionByGroup();,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
current.setGroup(null);,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
current.setInputs(inputs);,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
Set<String> namesAdded = new HashSet<>();,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"String name = propertyMap.get(""name"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"String kind = propertyMap.get(""kind"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"String group = propertyMap.get(""group"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"String label = propertyMap.get(""label"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"String type = propertyMap.get(""type"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"String javaType = propertyMap.get(""javaType"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"String deprecated = propertyMap.get(""deprecated"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"String required = propertyMap.get(""required"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
String currentValue = currentValues.get(name);,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"String defaultValue = propertyMap.get(""defaultValue"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"String description = propertyMap.get(""description"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"String enums = propertyMap.get(""enum"");",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
current.setGroup(group);,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
answer.add(current);,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
inputs = new ArrayList<>();,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
current = new EndpointOptionByGroup();,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
continue;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"Class<Object> inputClazz = CamelCommandsHelper.loadValidInputTypes(javaType, type);",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"description = """";",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"defaultValue = ""none"";",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"enums = ""none,"" + enums;",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"InputComponent input = createUIInput(componentFactory, converterFactory, name, inputClazz, required, currentValue, defaultValue, enums, description);",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
inputs.add(input);,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
/**,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
*,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"*  Red Hat licenses this file to you under the Apache License, version",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
*  with the License.  You may obtain a copy of the License at,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"*  Unless required by applicable law or agreed to in writing, software",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",a2499de2625bf07349d563e4e3fab32070d2559c,0,1
*  implied.  See the License for the specific language governing,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
*  permissions and limitations under the License.,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
*/,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
package io.fabric8.forge.addon.utils;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import java.net.URLClassLoader;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.projects.Project;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
import org.jboss.forge.addon.projects.facets.ClassLoaderFacet;,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
* Removes the package from the type name from the given type,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
int idx = className.lastIndexOf('.');,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
ClassLoaderFacet classLoaderFacet = project.getFacet(ClassLoaderFacet.class);,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
Class<?> clazz = classLoader.loadClass(className);,a2499de2625bf07349d563e4e3fab32070d2559c,0,1
"String body = componentClassName + "" component = new "" + componentClassName + ""();"" + configurationCode + ""\nreturn component;"";",0d68bcb6bdb4d1717053e72669585bea45ea97e3,10,1
"@WithAttributes(label = ""Class Name"", required = true, description = ""Name of the Spring Component class to generate"")",0d68bcb6bdb4d1717053e72669585bea45ea97e3,5,1
// only use value if there was a value set,0d68bcb6bdb4d1717053e72669585bea45ea97e3,4,0
"@WithAttributes(label = ""Component Name"", required = true, description = ""Name of component type to add"")",0d68bcb6bdb4d1717053e72669585bea45ea97e3,4,1
"@WithAttributes(label = ""Instance Name"", required = true, description = ""Name of component instance to add"")",0d68bcb6bdb4d1717053e72669585bea45ea97e3,4,1
"@WithAttributes(label = ""Component Name"", required = true, description = ""Name of component type to add"")",0d68bcb6bdb4d1717053e72669585bea45ea97e3,4,1
"@WithAttributes(label = ""Instance Name"", required = true, description = ""Name of component instance to add"")",0d68bcb6bdb4d1717053e72669585bea45ea97e3,4,1
"String fqn = generatePackageName != null ? generatePackageName + ""."" + generateClassName : generateClassName;",0d68bcb6bdb4d1717053e72669585bea45ea97e3,4,1
"return Results.fail(""A class with name "" + fqn + "" already exists"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,4,1
// only use value if there was a value set,0d68bcb6bdb4d1717053e72669585bea45ea97e3,4,1
"throw new IllegalArgumentException(""The attribute value '"" + name + ""' did not get passed on from the previous wizard page"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,4,1
"return Results.fail(""Could not find fully qualified class name in catalog for component name: "" + camelComponentName);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,4,1
"public static void createCdiComponentProducerClass(JavaClassSource javaClass, CamelComponentDetails details, String camelComponentName, String componentInstanceName, String configurationCode) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,4,1
"String methodName = ""create"" + Strings.capitalize(componentInstanceName) + ""Component"";",0d68bcb6bdb4d1717053e72669585bea45ea97e3,4,1
"public static void createSpringComponentFactoryClass(JavaClassSource javaClass, CamelComponentDetails details, String camelComponentName, String componentInstanceName, String configurationCode) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,4,1
* Converts a java type as a string to a valid input type and returns the class or null if its not supported,0d68bcb6bdb4d1717053e72669585bea45ea97e3,4,1
// if no default value exists then add none as the 1st choice default value,0d68bcb6bdb4d1717053e72669585bea45ea97e3,4,1
}    protected String getDefaultProducerClassName() {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""java.lang.Byte[]"".equals(name) || ""Byte[]"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,0
"} else if (""java.lang.Object[]"".equals(name) || ""Object[]"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,0
"} else if (""java.lang.String[]"".equals(name) || ""String[]"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,0
"} else if (""java.lang.String"".equals(name) || ""String"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,0
"} else if (""java.lang.Boolean"".equals(name) || ""Boolean"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,0
"} else if (""boolean"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,0
"} else if (""java.lang.Integer"".equals(name) || ""Integer"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,0
"} else if (""int"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,0
"} else if (""java.lang.Long"".equals(name) || ""Long"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,0
"} else if (""long"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,0
"} else if (""java.lang.Short"".equals(name) || ""Short"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,0
"} else if (""short"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,0
"} else if (""java.lang.Byte"".equals(name) || ""Byte"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,0
"} else if (""byte"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,0
"} else if (""java.lang.Float"".equals(name) || ""Float"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,0
"} else if (""float"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,0
"} else if (""java.lang.Double"".equals(name) || ""Double"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,0
"} else if (""double"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,0
"} else if (""java.lang.Character"".equals(name) || ""Character"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,0
"} else if (""char"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,0
"valueExpression = ""\"""" + text + ""\"""";",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,0
"valueExpression = ""\"""" + text + ""\"""";",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"// its a custom java type so use String as the input type, so you can refer to it using # lookup",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,0
"@WithAttributes(label = ""Filter"", required = false, description = ""To filter components"")",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"@WithAttributes(label = ""Package Name"", required = false, description = ""The package name where this type will be created"")",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"@WithAttributes(label = ""Class Name"", required = true, description = ""Name of @Producer class"")",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
public Result execute(UIExecutionContext context) throws Exception {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"@WithAttributes(label = ""Filter"", required = false, description = ""To filter components"")",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"@WithAttributes(label = ""Target Package"", required = false, description = ""The package name where this type will be created"")",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
public Result execute(UIExecutionContext context) throws Exception {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
public Result execute(UIExecutionContext context) throws Exception {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
// lets find the camel component class,0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"valueExpression = ""\"""" + text + ""\"""";",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"return Results.success(""Created new class "" + generateClassName);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"public static String mandatoryAttributeValue(Map<Object, Object> attributeMap, String name) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"public static Result loadCamelComponentDetails(CamelCatalog camelCatalog, String camelComponentName, CamelComponentDetails details) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"return Results.fail(""Could not find catalog entry for component name: "" + camelComponentName);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
// we want to use same version as camel-core if its a camel component,0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"// its a custom java type so use String as the input type, so you can refer to it using # lookup",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""java.net.URL"".equals(javaType)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""java.net.URI"".equals(javaType)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""boolean"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""integer"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""number"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""java.lang.Byte[]"".equals(name) || ""Byte[]"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""java.lang.Object[]"".equals(name) || ""Object[]"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""java.lang.String[]"".equals(name) || ""String[]"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""java.lang.String"".equals(name) || ""String"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""java.lang.Boolean"".equals(name) || ""Boolean"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""java.lang.Integer"".equals(name) || ""Integer"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""int"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""java.lang.Long"".equals(name) || ""Long"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""long"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""java.lang.Short"".equals(name) || ""Short"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""short"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""java.lang.Byte"".equals(name) || ""Byte"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""byte"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""java.lang.Float"".equals(name) || ""Float"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""float"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""java.lang.Double"".equals(name) || ""Double"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""double"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""java.lang.Character"".equals(name) || ""Character"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
"} else if (""char"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,3,1
protected String getDefaultProducerClassName() {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
"String defaultValue = propertyMap.get(""default"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
"String description = propertyMap.get(""description"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
"System.out.println(""Adding input for name: "" + name);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"protected static Class<Object> loadValidInputTypes(String javaType, String type) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
Class<Object> clazz = loadPrimitiveType(javaType);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
if (clazz == null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
clazz = (Class<Object>) Class.forName(javaType);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
private static Class loadPrimitiveType(String name) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
"if (""java.lang.byte[]"".equals(name) || ""byte[]"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
"protected static  Class<?> loadValidInputTypes(String javaType, String type) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
Class<?> clazz = Class.forName(javaType);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String defaultValue = propertyMap.get(""defaultValue"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
"UIInput<Object> input = componentFactory.createInput(name, inputClazz);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
if (defaultValue != null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
if (input.hasValue()) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
String valueExpression = null;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
Object value = input.getValue();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
if (value != null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
if (value instanceof String) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
String text = value.toString();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
if (!Strings.isBlank(text)) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
if (value instanceof Number) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
if (valueExpression != null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
"String defaultValue = propertyMap.get(""default"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"UIInput<?> input = componentFactory.createInput(name, inputClazz);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
String valueExpression = null;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
Object value = input.getValue();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (value != null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (value instanceof String) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
String text = value.toString();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (!Strings.isBlank(text)) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (value instanceof Number) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (valueExpression != null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String enums = propertyMap.get(""enum"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
"InputComponent input = createUIInput(componentFactory, name, inputClazz, required, defaultValue, enums, description);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
for (InputComponent input : inputs) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
"UIInput<Object> input = componentFactory.createInput(name, inputClazz);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"if (Objects.equals(""true"", required)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (defaultValue != null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
for (UIInput input : inputs) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
clazz = (Class<Object>) Class.forName(javaType);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
} catch (Throwable e) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
"if (""object"".equals(type)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
"clazz = loadPrimitiveWrapperType(""java.lang.String"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,0
clazz = (Class<Object>) Class.forName(javaType);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
} catch (ClassNotFoundException e) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
public class CamelNewComponentInstanceCDICommand extends AbstractCamelProjectCommand implements UIWizard {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
public UICommandMetadata getMetadata(UIContext context) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
".description(""Creates a new Camel component instance configuration using CDI"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
public boolean isEnabled(UIContext context) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (enabled) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
Project project = getSelectedProject(builder.getUIContext());,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
ComponentDto component = (ComponentDto) event.getNewValue();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (component != null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
String description = component.getDescription();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
} else {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
public String call() throws Exception {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
public NavigationResult next(UINavigationContext context) throws Exception {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
protected String getDefaultProducerClassName() {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
String name = instanceName.getValue();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (!Strings.isBlank(name)) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"return Strings.capitalize(name) + ""ComponentProducer"";",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
public class CamelNewComponentInstanceSpringCommand extends AbstractCamelProjectCommand implements UIWizard {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
public UICommandMetadata getMetadata(UIContext context) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
".description(""Creates a new Camel component instance configuration using Spring"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
public boolean isEnabled(UIContext context) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (enabled) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
Project project = getSelectedProject(builder.getUIContext());,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
ComponentDto component = (ComponentDto) event.getNewValue();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (component != null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
String description = component.getDescription();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
} else {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
public String call() throws Exception {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
public NavigationResult next(UINavigationContext context) throws Exception {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
protected String getDefaultProducerClassName() {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
String name = instanceName.getValue();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (!Strings.isBlank(name)) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"return Strings.capitalize(name) + ""ComponentFactory"";",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
public class ConfigureComponentPropertiesStep extends AbstractCamelProjectCommand implements UIWizardStep {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
public UICommandMetadata getMetadata(UIContext context) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String camelComponentName = mandatoryAttributeValue(attributeMap, ""componentName"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
String json = camelCatalog.componentJSonSchema(camelComponentName);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (json == null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"throw new IllegalArgumentException(""Could not find catalog entry for component name: "" + camelComponentName);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (data != null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String name = propertyMap.get(""name"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String kind = propertyMap.get(""kind"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String type = propertyMap.get(""type"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String javaType = propertyMap.get(""javaType"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String deprecated = propertyMap.get(""deprecated"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String required = propertyMap.get(""required"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
String currentValue = null;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String defaultValue = propertyMap.get(""defaultValue"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String description = propertyMap.get(""description"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String enums = propertyMap.get(""enum"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (!Strings.isNullOrEmpty(name)) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (inputClazz != null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (namesAdded.add(name)) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"InputComponent input = createUIInput(componentFactory, getConverterFactory(), name, inputClazz, required, currentValue, defaultValue, enums, description);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (input != null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
public NavigationResult next(UINavigationContext context) throws Exception {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String componentInstanceName = mandatoryAttributeValue(attributeMap, ""instanceName"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String generatePackageName = mandatoryAttributeValue(attributeMap, ""targetPackage"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String generateClassName = mandatoryAttributeValue(attributeMap, ""className"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String kind = mandatoryAttributeValue(attributeMap, ""kind"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
Project project = getSelectedProject(context);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (core == null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"return Results.fail(""The project does not include camel-core"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"Result result = loadCamelComponentDetails(camelCatalog, camelComponentName, details);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (result != null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (existing != null && existing.exists()) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (generatePackageName != null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
for (InputComponent input : inputs) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (input.hasValue()) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
String valueExpression = null;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
Object value = input.getValue();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (value != null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (value instanceof String) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
String text = value.toString();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (!Strings.isBlank(text)) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (value instanceof Number) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (valueExpression != null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
String configurationCode = buffer.toString();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"if (kind.equals(""cdi"")) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
} else {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
} catch (IllegalArgumentException e) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
* Returns the mandatory String value of the given name,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
* @throws IllegalArgumentException if the value is not available in the given attribute map,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
Object value = attributeMap.get(name);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
public final class CamelCommandsHelper {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
return new Callable<Iterable<ComponentDto>>() {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
String label = componentCategoryFilter.getValue();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"* Populates the details for the given component, returning a Result if it fails.",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
String json = camelCatalog.componentJSonSchema(camelComponentName);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (json == null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String javaType = row.get(""javaType"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (!Strings.isNullOrEmpty(javaType)) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String groupId = row.get(""groupId"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (!Strings.isNullOrEmpty(groupId)) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String artifactId = row.get(""artifactId"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (!Strings.isNullOrEmpty(artifactId)) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String version = row.get(""version"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (!Strings.isNullOrEmpty(version)) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (Strings.isNullOrEmpty(details.getComponentClassQName())) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"public static Result ensureCamelArtifactIdAdded(Project project, CamelComponentDetails details, DependencyInstaller dependencyInstaller) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
String groupId = details.getGroupId();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
String artifactId = details.getArtifactId();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (core == null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"return Results.fail(""The project does not include camel-core"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"if (""org.apache.camel"".equals(groupId)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
} else {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
DependencyBuilder component = DependencyBuilder.create().setGroupId(groupId),0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
String componentClassName = details.getComponentClassName();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
MethodSource<JavaClassSource> method = javaClass.addMethod(),0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"public static Class<Object> loadValidInputTypes(String javaType, String type) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (idx > 0) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
Class<Object> clazz = getPrimitiveWrapperClassType(type);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (clazz == null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
clazz = loadPrimitiveWrapperType(javaType);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
clazz = loadStringSupportedType(javaType);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
clazz = (Class<Object>) Class.forName(javaType);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
} catch (Throwable e) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"if (""object"".equals(type)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"clazz = loadPrimitiveWrapperType(""java.lang.String"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
private static Class loadStringSupportedType(String javaType) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"if (""java.io.File"".equals(javaType)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
* @return the primitive Java Class type,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
public static Class getPrimitiveWrapperClassType(String name) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"if (""string"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
private static Class loadPrimitiveWrapperType(String name) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"if (""java.lang.byte[]"".equals(name) || ""byte[]"".equals(name)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (camelComponentName == null && uri != null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"throw new IllegalArgumentException(""Could not find catalog entry for component name: "" + camelComponentName);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"// is the component consumer or producer only, if so we do not need any kind of filter",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (componentConsumerOnly || componentProducerOnly) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (data != null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String name = propertyMap.get(""name"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String kind = propertyMap.get(""kind"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String group = propertyMap.get(""group"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String label = propertyMap.get(""label"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String type = propertyMap.get(""type"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String javaType = propertyMap.get(""javaType"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String deprecated = propertyMap.get(""deprecated"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String required = propertyMap.get(""required"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
String currentValue = currentValues.get(name);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String defaultValue = propertyMap.get(""defaultValue"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String description = propertyMap.get(""description"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"String enums = propertyMap.get(""enum"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (current.getGroup() == null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (group != null && !group.equals(current.getGroup())) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (!current.getInputs().isEmpty()) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (consumerOnly && label != null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"if (!label.contains(""consumer"")) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (producerOnly && label != null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"if (!label.contains(""producer"")) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (!Strings.isNullOrEmpty(name)) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (inputClazz != null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (namesAdded.add(name)) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (!gui) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
// if its an enum and its optional then make sure there is a default value,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"if (enums != null && required == null || ""false"".equals(required)) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (defaultValue == null || defaultValue.isEmpty()) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"if (!enums.startsWith(""none,"")) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"enums = ""none,"" + enums;",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
"InputComponent input = createUIInput(componentFactory, converterFactory, name, inputClazz, required, currentValue, defaultValue, enums, description);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (input != null) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (inputs.size() == maxOptionsPerPage) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
// add last group if there was some new inputs,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
if (!inputs.isEmpty()) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,2,1
import java.util.ArrayList;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
import java.util.HashSet;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
import java.util.List;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
import java.util.Map;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
import java.util.Objects;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
import java.util.Set;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
import javax.inject.Inject;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
import javax.inject.Inject;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.ArrayList;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.HashSet;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.List;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.Map;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.Objects;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.Set;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
},0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
// TODO: requires Camel 2.16 for default values,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
import java.util.Date;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
import java.util.List;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
import java.util.Map;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
import java.util.concurrent.Callable;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
},0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
return byte[].class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
return Byte[].class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
return Object[].class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
return String[].class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
return String.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
return Boolean.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
return boolean.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
return Integer.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
return int.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
return Long.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
return long.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
return Short.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
return short.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
return Byte.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
return byte.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
return Float.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
return float.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
return Double.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
return double.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
return Character.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
return char.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
return null;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
import java.util.Date;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.List;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.Map;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.concurrent.Callable;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import static io.fabric8.forge.camel.commands.project.CamelCatalogHelper.findComponentArchetype;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"Class<Object> inputClazz = CamelCommands.loadValidInputTypes(javaType, type);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
},0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
valueExpression = value.toString();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
// TODO: requires Camel 2.16 for default values,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"Class<?> inputClazz = CamelCommands.loadValidInputTypes(javaType, type);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
valueExpression = value.toString();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
},0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
import static io.fabric8.forge.camel.commands.project.UIHelper.createUIInput;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
private List<InputComponent> inputs = new ArrayList<>();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
import java.util.Objects;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.input.UIInput;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
private List<UIInput> inputs = new ArrayList<>();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
},0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
try {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
},0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
if (clazz != null && (clazz.equals(String.class) || clazz.equals(Date.class) || clazz.equals(Boolean.class),0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
|| clazz.isPrimitive() || Number.class.isAssignableFrom(clazz))) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
if (clazz.equals(String.class) || clazz.equals(Date.class) || clazz.equals(Boolean.class),0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
|| clazz.isPrimitive() || Number.class.isAssignableFrom(clazz)) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
import org.jboss.forge.addon.convert.Converter;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createComponentDto;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
"componentName.setValueConverter(new Converter<String, ComponentDto>() {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
public ComponentDto convert(String name) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
return createComponentDto(name);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
},0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
import org.jboss.forge.addon.convert.Converter;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createComponentDto;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
"componentName.setValueConverter(new Converter<String, ComponentDto>() {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
public ComponentDto convert(String name) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
return createComponentDto(name);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
},0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,0
import java.util.Map;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.concurrent.Callable;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import javax.inject.Inject;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import io.fabric8.forge.addon.utils.completer.PackageNameCompleter;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import io.fabric8.forge.addon.utils.validator.ClassNameValidator;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import io.fabric8.forge.addon.utils.validator.PackageNameValidator;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.convert.Converter;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.dependencies.DependencyResolver;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.facets.constraints.FacetConstraint;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.parser.java.facets.JavaSourceFacet;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.projects.Project;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.projects.facets.ClassLoaderFacet;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.context.UIContext;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.context.UINavigationContext;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.facets.HintsFacet;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.hints.InputType;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.input.UIInput;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.input.UISelectOne;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.result.NavigationResult;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.result.Result;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.result.Results;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.util.Categories;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.util.Metadata;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.wizard.UIWizard;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.roaster.model.util.Strings;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createComponentDto;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return Metadata.forCommand(CamelNewComponentInstanceCDICommand.class).name(,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"""Camel: New Component CDI"").category(Categories.create(CATEGORY))",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
},0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
boolean enabled = super.isEnabled(context);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return CamelCommandsHelper.isCdiProject(getSelectedProject(context));,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return false;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
public void initializeUI(UIBuilder builder) throws Exception {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
final JavaSourceFacet facet = project.getFacet(JavaSourceFacet.class);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"componentName.setValueConverter(new Converter<String, ComponentDto>() {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
public ComponentDto convert(String text) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"return createComponentDto(getCamelCatalog(), text);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
// show note about the chosen component,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
componentName.addValueChangeListener(new ValueChangeListener() {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
public void valueChanged(ValueChangeEvent event) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
className.setDefaultValue(new Callable<String>() {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return getDefaultProducerClassName();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"Map<Object, Object> attributeMap = context.getUIContext().getAttributeMap();",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return Results.navigateTo(ConfigureComponentPropertiesStep.class);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return Results.success();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return null;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.Map;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.concurrent.Callable;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import javax.inject.Inject;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import io.fabric8.forge.addon.utils.completer.PackageNameCompleter;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import io.fabric8.forge.addon.utils.validator.ClassNameValidator;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import io.fabric8.forge.addon.utils.validator.PackageNameValidator;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.convert.Converter;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.dependencies.DependencyResolver;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.facets.constraints.FacetConstraint;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.parser.java.facets.JavaSourceFacet;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.projects.Project;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.projects.facets.ClassLoaderFacet;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.context.UIContext;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.context.UINavigationContext;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.facets.HintsFacet;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.hints.InputType;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.input.UIInput;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.input.UISelectOne;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.result.NavigationResult;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.result.Result;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.result.Results;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.util.Categories;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.util.Metadata;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.wizard.UIWizard;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.roaster.model.util.Strings;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createComponentDto;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return Metadata.forCommand(CamelNewComponentInstanceSpringCommand.class).name(,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"""Camel: New Component Spring"").category(Categories.create(CATEGORY))",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
},0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
boolean enabled = super.isEnabled(context);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return CamelCommandsHelper.isSpringProject(getSelectedProject(context));,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return false;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
public void initializeUI(UIBuilder builder) throws Exception {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
final JavaSourceFacet facet = project.getFacet(JavaSourceFacet.class);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"componentName.setValueConverter(new Converter<String, ComponentDto>() {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
public ComponentDto convert(String text) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"return createComponentDto(getCamelCatalog(), text);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
// show note about the chosen component,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
componentName.addValueChangeListener(new ValueChangeListener() {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
public void valueChanged(ValueChangeEvent event) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
className.setDefaultValue(new Callable<String>() {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return getDefaultProducerClassName();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"Map<Object, Object> attributeMap = context.getUIContext().getAttributeMap();",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return Results.navigateTo(ConfigureComponentPropertiesStep.class);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return Results.success();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return null;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.ArrayList;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.HashSet;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.List;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.Map;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.Set;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import javax.inject.Inject;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import io.fabric8.forge.addon.utils.CamelProjectHelper;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import io.fabric8.forge.camel.commands.project.model.CamelComponentDetails;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.apache.camel.catalog.CamelCatalog;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.apache.camel.catalog.JSonSchemaHelper;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.dependencies.Dependency;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.dependencies.DependencyResolver;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.parser.java.facets.JavaSourceFacet;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.parser.java.resources.JavaResource;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.projects.Project;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.context.UIContext;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.context.UINavigationContext;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.input.InputComponentFactory;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.result.NavigationResult;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.result.Result;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.result.Results;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.util.Categories;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.util.Metadata;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.wizard.UIWizardStep;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.roaster.Roaster;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.roaster.model.source.JavaClassSource;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.roaster.model.util.Strings;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import static io.fabric8.forge.addon.utils.UIHelper.createUIInput;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper.ensureCamelArtifactIdAdded;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper.loadCamelComponentDetails;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper.loadValidInputTypes;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
private List<InputComponent> inputs = new ArrayList<>();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return Metadata.forCommand(ConfigureComponentPropertiesStep.class).name(,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
".description(""Configure the component options to use"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
},0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
public void initializeUI(UIBuilder builder) throws Exception {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
// lets create a field for each property on the component,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"Map<Object, Object> attributeMap = builder.getUIContext().getAttributeMap();",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""componentProperties"", json, true);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
Set<String> namesAdded = new HashSet<>();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"for (Map<String, String> propertyMap : data) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"Class<Object> inputClazz = loadValidInputTypes(javaType, type);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return null;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"Map<Object, Object> attributeMap = context.getUIContext().getAttributeMap();",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
try {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
JavaSourceFacet facet = project.getFacet(JavaSourceFacet.class);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
// does the project already have camel?,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
Dependency core = CamelProjectHelper.findCamelCoreDependency(project);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
CamelComponentDetails details = new CamelComponentDetails();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return result;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"result = ensureCamelArtifactIdAdded(project, details, dependencyInstaller);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
// do we already have a class with the name,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
JavaResource existing = facet.getJavaResource(fqn);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
// need to parse to be able to extends another class,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
final JavaClassSource javaClass = Roaster.create(JavaClassSource.class);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
// generate the correct class payload based on the style...,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
StringBuilder buffer = new StringBuilder();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
valueExpression = value.toString();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return Results.fail(e.getMessage());,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return text;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.ArrayList;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.Collections;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.Date;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.HashSet;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.List;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.Map;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.Set;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import java.util.concurrent.Callable;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import io.fabric8.forge.addon.utils.CamelProjectHelper;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import io.fabric8.forge.camel.commands.project.completer.CamelComponentsCompleter;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import io.fabric8.forge.camel.commands.project.completer.CamelComponentsLabelCompleter;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import io.fabric8.forge.camel.commands.project.model.CamelComponentDetails;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import io.fabric8.forge.camel.commands.project.model.EndpointOptionByGroup;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.apache.camel.catalog.CamelCatalog;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.apache.camel.catalog.JSonSchemaHelper;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.convert.ConverterFactory;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.dependencies.Dependency;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.projects.Project;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.context.UIContext;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.input.InputComponentFactory;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.input.UISelectOne;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.result.Result;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.addon.ui.result.Results;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.roaster.model.source.JavaClassSource;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.roaster.model.source.MethodSource;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import org.jboss.forge.roaster.model.util.Strings;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import static io.fabric8.forge.addon.utils.UIHelper.createUIInput;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.endpointComponentName;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"public static Iterable<String> createComponentLabelValues(Project project, CamelCatalog camelCatalog) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"return new CamelComponentsLabelCompleter(project, camelCatalog).getValueChoices();",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
},0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
final boolean excludeComponentsOnClasspath) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
public Iterable<ComponentDto> call() throws Exception {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"return new CamelComponentsCompleter(project, camelCatalog, null, excludeComponentsOnClasspath).getValueChoices(label);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""component"", json, false);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"for (Map<String, String> row : data) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return null;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
Dependency core = CamelProjectHelper.findCamelCoreDependency(project);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
String version;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
version = core.getCoordinate().getVersion();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
version = details.getVersion();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
// install the component,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
public static boolean isCdiProject(Project project) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return CamelProjectHelper.findCamelCDIDependency(project) != null;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
public static boolean isSpringProject(Project project) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return CamelProjectHelper.findCamelSpringDependency(project) != null;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
public static boolean isBlueprintProject(Project project) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return CamelProjectHelper.findCamelBlueprintDependency(project) != null;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"// we have generics in the javatype, if so remove it so its loadable from a classloader",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
int idx = javaType.indexOf('<');,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"javaType = javaType.substring(0, idx);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
try {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
if (clazz != null && (clazz.equals(String.class) || clazz.equals(Date.class) || clazz.equals(Boolean.class),0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
|| clazz.isPrimitive() || Number.class.isAssignableFrom(clazz))) {,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return clazz;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return String.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return Boolean.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return Integer.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return Float.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return Byte[].class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return Object[].class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return String[].class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return Long.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return Short.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return Byte.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return Double.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return Character.class;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"public static List<EndpointOptionByGroup> createUIInputsForCamelComponent(String camelComponentName, String uri, int maxOptionsPerPage, boolean consumerOnly, boolean producerOnly,",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"CamelCatalog camelCatalog, InputComponentFactory componentFactory, ConverterFactory converterFactory, UIContext ui) throws Exception {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
List<EndpointOptionByGroup> answer = new ArrayList<>();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
camelComponentName = endpointComponentName(uri);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"boolean componentConsumerOnly = CamelCatalogHelper.isComponentConsumerOnly(camelCatalog, camelComponentName);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"boolean componentProducerOnly = CamelCatalogHelper.isComponentProducerOnly(camelCatalog, camelComponentName);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"// reset the filters as the component can only be one of them anyway, so we should show all options",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
consumerOnly = false;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
producerOnly = false;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""properties"", json, true);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"Map<String, String> currentValues = uri != null ? camelCatalog.endpointProperties(uri) : Collections.EMPTY_MAP;",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
List<InputComponent> inputs = new ArrayList<>();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
EndpointOptionByGroup current = new EndpointOptionByGroup();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
Set<String> namesAdded = new HashSet<>();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"for (Map<String, String> propertyMap : data) {",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
// this group is now done so add to answer,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
// get ready for a new group,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
inputs = new ArrayList<>();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
current = new EndpointOptionByGroup();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"Class<Object> inputClazz = CamelCommandsHelper.loadValidInputTypes(javaType, type);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
boolean gui = ui.getProvider().isGUI();,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"description = """";",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"defaultValue = ""none"";",0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
// if we hit max options then create a new group,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
return answer;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,1,1
"*  Copyright 2005-2014 Red Hat, Inc.",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
"*  Red Hat licenses this file to you under the Apache License, version",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
"*  2.0 (the ""License""); you may not use this file except in compliance",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
*  with the License.  You may obtain a copy of the License at,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
*     http://www.apache.org/licenses/LICENSE-2.0,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
"*  Unless required by applicable law or agreed to in writing, software",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
*  implied.  See the License for the specific language governing,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
*  permissions and limitations under the License.,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
* Licensed to the Apache Software Foundation (ASF) under one or more,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
* contributor license agreements.  See the NOTICE file distributed with,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
* this work for additional information regarding copyright ownership.,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"* The ASF licenses this file to You under the Apache License, Version 2.0",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"* (the ""License""); you may not use this file except in compliance with",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
* the License.  You may obtain a copy of the License at,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
* http://www.apache.org/licenses/LICENSE-2.0,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"* Unless required by applicable law or agreed to in writing, software",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"* distributed under the License is distributed on an ""AS IS"" BASIS,",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
* See the License for the specific language governing permissions and,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
* limitations under the License.,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
/**,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*/,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
input.setLabel(name);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
// must use an empty description otherwise the UI prints null,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
"input.setDescription(description != null ? description : """");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
CamelProjectHelper.findCamelSpringDependency(project) != null;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
// special for byte[] or Object[] as its common to use,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
// and these is common as well,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
CamelProjectHelper.findCamelSpringDependency(project) != null;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
input.setDefaultValue(defaultValue);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
"buffer.append(""\n"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
"buffer.append(""component.set"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
buffer.append(Strings.capitalize(input.getName()));,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
"buffer.append(""("");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
buffer.append(valueExpression);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
"buffer.append("");"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
"buffer.append(""\n"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"buffer.append(""component.set"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
buffer.append(Strings.capitalize(input.getName()));,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"buffer.append(""("");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
buffer.append(valueExpression);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"buffer.append("");"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
input.setRequired(true);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
input.setLabel(name);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
// must use an empty description otherwise the UI prints null,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"input.setDescription(description != null ? description : """");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
input.setDefaultValue(defaultValue);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
private UISelectOne<ComponentDto> componentName;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
"componentName.setValueChoices(CamelCommandsHelper.createComponentDtoValues(project, componentNameFilter, false));",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
@Override,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
});,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
"attributeMap.put(""componentName"", componentName.getValue().getScheme());",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
private UISelectOne<String> componentName;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"componentName.setValueChoices(CamelCommandsHelper.createComponentNameValues(project, componentNameFilter, false));",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"attributeMap.put(""componentName"", componentName.getValue());",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
private UISelectOne<ComponentDto> componentName;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
"componentName.setValueChoices(CamelCommandsHelper.createComponentDtoValues(project, componentNameFilter, false));",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
@Override,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
});,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
"attributeMap.put(""componentName"", componentName.getValue().getScheme());",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,0
private UISelectOne<String> componentName;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"componentName.setValueChoices(CamelCommandsHelper.createComponentNameValues(project, componentNameFilter, false));",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"attributeMap.put(""componentName"", componentName.getValue());",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
/**,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"*  Red Hat licenses this file to you under the Apache License, version",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*  with the License.  You may obtain a copy of the License at,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"*  Unless required by applicable law or agreed to in writing, software",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*  implied.  See the License for the specific language governing,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*  permissions and limitations under the License.,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*/,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
package io.fabric8.forge.camel.commands.project;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"@FacetConstraint({JavaSourceFacet.class, ResourcesFacet.class, ClassLoaderFacet.class})",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
@Inject,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
private UISelectOne<String> componentNameFilter;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
private UISelectOne<ComponentDto> componentName;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
private UIInput<String> instanceName;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
private UIInput<String> targetPackage;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
private UIInput<String> className;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
private DependencyInstaller dependencyInstaller;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
private DependencyResolver dependencyResolver;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
@Override,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"componentNameFilter.setValueChoices(CamelCommandsHelper.createComponentLabelValues(project, getCamelCatalog()));",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"componentNameFilter.setDefaultValue(""<all>"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"componentName.setValueChoices(CamelCommandsHelper.createComponentDtoValues(project, getCamelCatalog(), componentNameFilter, false));",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
// include converter from string->dto,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
});,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"componentName.setNote(description != null ? description : """");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"componentName.setNote("""");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
targetPackage.setCompleter(new PackageNameCompleter(facet));,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
targetPackage.addValidator(new PackageNameValidator());,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
targetPackage.getFacet(HintsFacet.class).setInputType(InputType.JAVA_PACKAGE_PICKER);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
className.addValidator(new ClassNameValidator(false));,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
className.getFacet(HintsFacet.class).setInputType(InputType.JAVA_CLASS_PICKER);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
builder.add(componentNameFilter).add(componentName).add(instanceName).add(targetPackage).add(className);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"attributeMap.put(""componentName"", componentName.getValue().getScheme());",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"attributeMap.put(""instanceName"", instanceName.getValue());",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"attributeMap.put(""targetPackage"", targetPackage.getValue());",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"attributeMap.put(""className"", className.getValue());",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"attributeMap.put(""kind"", ""cdi"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
/**,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"*  Red Hat licenses this file to you under the Apache License, version",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*  with the License.  You may obtain a copy of the License at,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"*  Unless required by applicable law or agreed to in writing, software",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*  implied.  See the License for the specific language governing,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*  permissions and limitations under the License.,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*/,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
package io.fabric8.forge.camel.commands.project;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"@FacetConstraint({JavaSourceFacet.class, ResourcesFacet.class, ClassLoaderFacet.class})",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
@Inject,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
private UISelectOne<String> componentNameFilter;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
private UISelectOne<ComponentDto> componentName;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
private UIInput<String> instanceName;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
private UIInput<String> targetPackage;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
private UIInput<String> className;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
private DependencyInstaller dependencyInstaller;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
private DependencyResolver dependencyResolver;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
@Override,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"componentNameFilter.setValueChoices(CamelCommandsHelper.createComponentLabelValues(project, getCamelCatalog()));",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"componentNameFilter.setDefaultValue(""<all>"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"componentName.setValueChoices(CamelCommandsHelper.createComponentDtoValues(project, getCamelCatalog(), componentNameFilter, false));",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
// include converter from string->dto,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
});,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"componentName.setNote(description != null ? description : """");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"componentName.setNote("""");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
targetPackage.setCompleter(new PackageNameCompleter(facet));,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
targetPackage.addValidator(new PackageNameValidator());,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
targetPackage.getFacet(HintsFacet.class).setInputType(InputType.JAVA_PACKAGE_PICKER);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
className.addValidator(new ClassNameValidator(false));,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
className.getFacet(HintsFacet.class).setInputType(InputType.JAVA_CLASS_PICKER);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
builder.add(componentNameFilter).add(componentName).add(instanceName).add(targetPackage).add(className);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"attributeMap.put(""componentName"", componentName.getValue().getScheme());",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"attributeMap.put(""instanceName"", instanceName.getValue());",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"attributeMap.put(""targetPackage"", targetPackage.getValue());",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"attributeMap.put(""className"", className.getValue());",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"attributeMap.put(""kind"", ""spring"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
/**,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"*  Red Hat licenses this file to you under the Apache License, version",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*  with the License.  You may obtain a copy of the License at,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"*  Unless required by applicable law or agreed to in writing, software",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*  implied.  See the License for the specific language governing,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*  permissions and limitations under the License.,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*/,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
package io.fabric8.forge.camel.commands.project;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
@Inject,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
private InputComponentFactory componentFactory;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
private DependencyInstaller dependencyInstaller;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
private DependencyResolver dependencyResolver;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
private CamelCatalog camelCatalog;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
@Override,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"""Camel: New Component"").category(Categories.create(CATEGORY))",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
builder.add(input);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
inputs.add(input);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
javaClass.setName(generateClassName);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
javaClass.setPackage(generatePackageName);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"buffer.append(""\n"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"buffer.append(""component.set"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
buffer.append(Strings.capitalize(input.getName()));,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"buffer.append(""("");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
buffer.append(valueExpression);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"buffer.append("");"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"CamelCommandsHelper.createCdiComponentProducerClass(javaClass, details, camelComponentName, componentInstanceName, configurationCode);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"CamelCommandsHelper.createSpringComponentFactoryClass(javaClass, details, camelComponentName, componentInstanceName, configurationCode);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
facet.saveJavaSource(javaClass);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
/**,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"*  Red Hat licenses this file to you under the Apache License, version",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*  with the License.  You may obtain a copy of the License at,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"*  Unless required by applicable law or agreed to in writing, software",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*  implied.  See the License for the specific language governing,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*  permissions and limitations under the License.,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
*/,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
package io.fabric8.forge.camel.commands.project.helper;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"public static Callable<Iterable<ComponentDto>> createComponentDtoValues(final Project project, final CamelCatalog camelCatalog,",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"final UISelectOne<String> componentCategoryFilter,",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
// use callable so we can live update the filter,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
@Override,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
};,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
details.setComponentClassQName(javaType);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
details.setGroupId(groupId);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
details.setArtifactId(artifactId);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
details.setVersion(version);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
// otherwise use the version from the dto,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
.setArtifactId(artifactId).setVersion(version);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"dependencyInstaller.install(project, component);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"javaClass.addImport(""javax.enterprise.inject.Produces"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"javaClass.addImport(""javax.inject.Singleton"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"javaClass.addImport(""javax.inject.Named"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
javaClass.addImport(details.getComponentClassQName());,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
.setPublic(),0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
.setReturnType(componentClassName),0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
.setName(methodName),0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
.setBody(body),0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
.addThrows(Exception.class);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"method.addAnnotation(""Named"").setStringValue(camelComponentName);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"method.addAnnotation(""Produces"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"method.addAnnotation(""Singleton"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"javaClass.addAnnotation(""Component"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"javaClass.addImport(""org.springframework.beans.factory.config.BeanDefinition"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"javaClass.addImport(""org.springframework.beans.factory.annotation.Qualifier"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"javaClass.addImport(""org.springframework.context.annotation.Bean"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"javaClass.addImport(""org.springframework.context.annotation.Scope"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"javaClass.addImport(""org.springframework.stereotype.Component"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"method.addAnnotation(""Qualifier"").setStringValue(camelComponentName);",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"method.addAnnotation(""Bean"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
"method.addAnnotation(""Scope"").setLiteralValue(""BeanDefinition.SCOPE_SINGLETON"");",0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
// favor specialized UI for these types,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
// ignore errors,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
* Gets the JSon schema primitive type.,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
* @param name the json type,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
// special for byte[] or Object[] as its common to use,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
// and these is common as well,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
current.setGroup(null);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
current.setInputs(inputs);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
current.setGroup(group);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
// its a new group,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
answer.add(current);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
// filter out options in case we should only include consumers or producers only,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
continue;,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
// we do not want descriptions in CLI mode as it makes the UI clutter,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
// otherwise the GUI makes us force to select an option which is not what we want,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
inputs.add(input);,0d68bcb6bdb4d1717053e72669585bea45ea97e3,0,1
Project project = projectFactory.createTempProject();,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,3,1
"CommandController command = testHarness.createCommandController(CamelSetupCommand.class, project.getRoot());",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,3,1
import org.jboss.forge.addon.ui.result.Failed;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,2,1
Result result = command.execute();,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,2,1
"Assert.assertFalse(""Should setup Camel in the project"", result instanceof Failed);",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,2,1
"command = testHarness.createCommandController(CamelListComponentCommand.class, project.getRoot());",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,2,1
result = command.execute();,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,2,1
import java.io.File;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
import javax.inject.Inject;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
import io.fabric8.forge.camel.commands.project.CamelListComponentCommand;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
import io.fabric8.forge.camel.commands.project.CamelSetupCommand;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
import org.jboss.arquillian.container.test.api.Deployment;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
import org.jboss.arquillian.junit.Arquillian;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
import org.jboss.forge.addon.projects.Project;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
import org.jboss.forge.addon.projects.ProjectFactory;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
import org.jboss.forge.addon.ui.controller.CommandController;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
import org.jboss.forge.addon.ui.result.Result;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
import org.jboss.forge.addon.ui.test.UITestHarness;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
import org.jboss.forge.arquillian.AddonDependencies;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
import org.jboss.forge.arquillian.AddonDependency;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
import org.jboss.forge.arquillian.archive.AddonArchive;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
import org.jboss.forge.furnace.repositories.AddonDependencyEntry;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
import org.jboss.forge.furnace.util.OperatingSystemUtils;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
import org.jboss.shrinkwrap.api.ShrinkWrap;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
import org.junit.Assert;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
import org.junit.Test;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
import org.junit.runner.RunWith;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
private ProjectFactory projectFactory;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
"@AddonDependency(name = ""org.jboss.forge.addon:maven""),",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
"@AddonDependency(name = ""org.jboss.forge.addon:projects""),",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
"@AddonDependency(name = ""org.jboss.forge.addon:ui""),",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
"@AddonDependency(name = ""org.jboss.forge.addon:ui-test-harness""),",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
"@AddonDependency(name = ""org.jboss.forge.addon:shell-test-harness""),",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
"@AddonDependency(name = ""io.fabric8.forge:camel"")",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
AddonArchive archive = ShrinkWrap,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
File tempDir = OperatingSystemUtils.createTempDir();,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
"Assert.assertFalse(""Should not fail"", result instanceof Failed);",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,1,1
/**,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
*,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
"*  Red Hat licenses this file to you under the Apache License, version",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
*  with the License.  You may obtain a copy of the License at,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
"*  Unless required by applicable law or agreed to in writing, software",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
*  implied.  See the License for the specific language governing,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
*  permissions and limitations under the License.,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
*/,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
package io.fabric8.forge.camel.commands;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
@RunWith(Arquillian.class),f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
public class NewComponentInstanceTest {,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
@Inject,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
private UITestHarness testHarness;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
@Deployment,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
@AddonDependencies({,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
}),f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
public static AddonArchive getDeployment() {,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
.create(AddonArchive.class),f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
.addBeansXML(),f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
.addAsAddonDependencies(,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
"AddonDependencyEntry.create(""org.jboss.forge.furnace.container:cdi""),",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
"AddonDependencyEntry.create(""org.jboss.forge.addon:ui""),",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
"AddonDependencyEntry.create(""org.jboss.forge.addon:ui-test-harness""),",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
"AddonDependencyEntry.create(""org.jboss.forge.addon:shell-test-harness""),",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
"AddonDependencyEntry.create(""org.jboss.forge.addon:projects""),",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
"AddonDependencyEntry.create(""org.jboss.forge.addon:maven""),",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
"AddonDependencyEntry.create(""io.fabric8.forge:camel"")",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
);,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
return archive;,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
},f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
@Test,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
public void testSomething() throws Exception {,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
try {,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
"Assert.assertNotNull(""Should have created a project"", project);",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
command.initialize();,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
"command.setValueFor(""kind"", ""camel-spring"");",f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
} finally {,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
tempDir.delete();,f1d1d4de563daff59cd1c6198b7359b22b2e6c99,0,1
"*  Red Hat licenses this file to you under the Apache License, version",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,3,1
*  with the License.  You may obtain a copy of the License at,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,3,1
*  implied.  See the License for the specific language governing,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,3,1
protected ProjectFactory projectFactory;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,3,1
protected Project getSelectedProjectOrNull(UIContext context) {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,3,1
protected ProjectFactory getProjectFactory() {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,3,1
"protected Coordinate createCoordinate(String groupId, String artifactId, String version) {",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,3,1
"protected Coordinate createCoordinate(String groupId, String artifactId, String version, String packaging) {",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,3,1
"*  Red Hat licenses this file to you under the Apache License, version",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,3,1
*  with the License.  You may obtain a copy of the License at,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,3,1
*  implied.  See the License for the specific language governing,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,3,1
} else {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,2,0
"return Results.success(""Added Fabric8 wtih Docker and Jube to the project"");",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,2,0
} else if (docker) {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,2,0
"return Results.success(""Added Fabric8 wtih Docker to the project"");",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,2,0
"return Results.success(""Added Fabric8 wtih Jube to the project"");",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,2,0
"return Results.success(""Added Fabric8 to the project"");",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,2,1
"} else if (""Docker"".equals(platform.getValue())) {",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,2,0
} else {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,2,0
Project project = getSelectedProjectOrNull(builder.getUIContext());,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,2,1
Project project = getSelectedProject(context);,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,2,1
"} else if (""bundle"".equals(packaging)) {",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,2,1
"} else if (""war"".equals(packaging)) {",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,2,1
"return Results.success(""Added Fabric8 with Docker and Jube to the project"");",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,2,1
} else if (docker) {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,2,1
"return Results.success(""Added Fabric8 with Docker to the project"");",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,2,1
} else {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,2,1
"return Results.success(""Added Fabric8 with Jube to the project"");",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,2,1
protected String getProjectPackaging(Project project) {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,2,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,2,1
*  permissions and limitations under the License.,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,2,1
protected boolean isProjectRequired() {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,2,1
protected PrintStream getOutput(UIExecutionContext context) {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,2,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,2,1
*  permissions and limitations under the License.,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,2,1
import org.jboss.forge.addon.maven.plugins.ExecutionBuilder;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
import org.jboss.forge.addon.maven.plugins.MavenPlugin;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
import org.jboss.forge.addon.maven.plugins.MavenPluginBuilder;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
// add fabric8 plugin,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
// TODO: add some fabric8 properties,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
// TODO: add fabric8 plugin,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import java.util.Arrays;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
import java.util.Locale;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
import java.util.concurrent.Callable;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
import org.jboss.forge.addon.ui.input.UISelectOne;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
platform.setDefaultValue(new Callable<String>() {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
public String call() throws Exception {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
"if (isPlatform(""windows"")) {",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
},2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
"if (""Docker"".equals(platform.getValue()) || ""Both"".equals(platform.getValue())) {",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
if (fromImage == null) {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
if (docker && jube) {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
public static boolean isPlatform(String platform) {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
import org.jboss.forge.addon.ui.context.UINavigationContext;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
import org.jboss.forge.addon.ui.result.NavigationResult;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
import org.jboss.forge.addon.ui.wizard.UIWizard;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
public class FabricSetupCommand extends AbstractFabricProjectCommand implements UIWizard {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
public NavigationResult next(UINavigationContext context) throws Exception {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
"if (""Both"".equals(platform.getValue())) {",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
},2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
import java.util.Properties;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.apache.maven.model.Model;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.dependencies.Dependency;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.maven.plugins.ExecutionBuilder;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.maven.plugins.MavenPlugin;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.maven.plugins.MavenPluginBuilder;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
public class FabricSetupCommand extends AbstractFabricProjectCommand {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
main.setRequired(new Callable<Boolean>() {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
public Boolean call() throws Exception {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
"if (""Docker"".equals(platform.getValue()) || ""Both"".equals(platform.getValue())) {",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
if (project != null) {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
},2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
if (fromImage == null) {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
// install fabric8 bom,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
Dependency bom = DependencyBuilder.create(),2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
// add fabric8 plugin,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
"if (""jar"".equals(packaging)) {",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
if (container != null) {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
if (icon != null) {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
if (group.getValue() != null) {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
if (main.getValue() != null) {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
// to save then set the model,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
if (updated) {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
if (docker && jube) {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.projects.Project;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.ui.input.UIInput;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
"@WithAttributes(label = ""label"", required = false, description = ""Label to use for the app"")",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
if (project != null) {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
},2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,0
import java.util.Arrays;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import java.util.Locale;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import javax.inject.Inject;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.ui.input.UISelectOne;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
"//if (isPlatform(""windows"")) {",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
//} else {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
public static boolean isPlatform(String platform) {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
},2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
"*  Copyright 2005-2015 Red Hat, Inc.",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
*,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
*     http://www.apache.org/licenses/LICENSE-2.0,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
"*  Unless required by applicable law or agreed to in writing, software",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import java.io.PrintStream;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import javax.inject.Inject;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.dependencies.Coordinate;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.dependencies.builder.CoordinateBuilder;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.projects.Project;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.projects.ProjectFactory;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.projects.Projects;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.projects.ui.AbstractProjectCommand;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.ui.context.UIContext;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
public abstract class AbstractFabricProjectCommand extends AbstractProjectCommand {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
},2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
return projectFactory;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
CoordinateBuilder builder = CoordinateBuilder.create(),2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
if (version != null) {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
builder = builder.setVersion(version);,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
if (packaging != null) {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
builder = builder.setPackaging(packaging);,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
"*  Copyright 2005-2015 Red Hat, Inc.",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
*,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
*     http://www.apache.org/licenses/LICENSE-2.0,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
"*  Unless required by applicable law or agreed to in writing, software",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.facets.constraints.FacetConstraint;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.maven.projects.MavenFacet;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.maven.projects.MavenPluginFacet;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.ui.context.UIContext;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.ui.context.UINavigationContext;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.ui.result.NavigationResult;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.ui.result.Result;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.ui.result.Results;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.ui.util.Categories;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.ui.util.Metadata;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
import org.jboss.forge.addon.ui.wizard.UIWizard;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
public class Fabric8SetupCommand extends AbstractFabricProjectCommand implements UIWizard {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
public UICommandMetadata getMetadata(UIContext context) {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
".description(""Setup Fabric8 and Docker in your project"");",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
},2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
public NavigationResult next(UINavigationContext context) throws Exception {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
public void initializeUI(final UIBuilder builder) throws Exception {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
public Result execute(UIExecutionContext context) throws Exception {,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,1,1
".setCoordinate(createCoordinate(""io.fabric8"", ""fabric8-project"", VersionHelper.fabric8Version(), ""pom""))",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
MavenPluginFacet pluginFacet = project.getFacet(MavenPluginFacet.class);,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
MavenPlugin plugin = MavenPluginBuilder.create(),2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
".setCoordinate(createCoordinate(""io.fabric8"", ""fabric8-maven-plugin"", VersionHelper.fabric8Version()))",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
".addExecution(ExecutionBuilder.create().setId(""json"").addGoal(""json""));",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
pluginFacet.addPlugin(plugin);,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
//  <fabric8.version>2.0.30</fabric8.version>,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
// <fabric8.label.container>java</fabric8.label.container>,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
// <fabric8.label.group>quickstarts</fabric8.label.group>,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
// <fabric8.iconRef>icons/camel.svg</fabric8.iconRef>,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
".setCoordinate(createCoordinate(""io.fabric8"", ""fabric8-project"", VersionHelper.fabric8Version(), ""bom""))",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"private String[] platforms = new String[]{""Docker"", ""Jube"", ""Both""};",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
@Inject,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
"@WithAttributes(label = ""platform"", required = true, description = ""The runtime platform"")",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
private UISelectOne<String> platform;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
builder.add(platform);,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
platform.setValueChoices(Arrays.asList(platforms));,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
@Override,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
"// if windows use jube, otherwise docker",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
"return ""Jube"";",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
"return ""Docker"";",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
});,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
boolean docker = false;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
boolean jube = false;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
// install docker first,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
String fromImage = DockerSetupHelper.defaultDockerImage(project);,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
"fromImage = ""fabric8/java"";",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
docker = true;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
"DockerSetupHelper.setupDocker(project, fromImage);",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
"String osName = System.getProperty(""os.name"").toLowerCase(Locale.US);",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
return osName.contains(platform.toLowerCase(Locale.US));,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
@Override,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
"return Results.navigateTo(DockerStepCommand.class, JubeStepCommand.class);",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
return Results.navigateTo(DockerStepCommand.class);,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
return Results.navigateTo(JubeStepCommand.class);,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
return Results.success();,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
@Inject,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"@WithAttributes(label = ""main"", required = false, description = ""Main class for standalone Java projects"")",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
private UIInput<String> main;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
builder.add(main);,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
main.addValidator(new ClassNameValidator(true));,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
@Override,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
// when using docker and java standalone we need a main class,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
String packaging = getProjectPackaging(project);,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"return ""jar"".equals(packaging);",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
return false;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
});,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
boolean docker = false;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
boolean jube = false;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
// install docker first,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
String fromImage = DockerSetupHelper.defaultDockerImage(project);,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"fromImage = ""fabric8/java"";",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
docker = true;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
String mainClass = main.getValue() != null ? main.getValue() : null;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"DockerSetupHelper.setupDocker(project, fromImage, mainClass);",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
".setCoordinate(createCoordinate(""io.fabric8"", ""fabric8-project"", VersionHelper.fabric8Version(), ""pom""))",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
".setScopeType(""import"");",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"dependencyInstaller.installManaged(project, bom);",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
MavenPluginFacet pluginFacet = project.getFacet(MavenPluginFacet.class);,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
MavenPlugin plugin = MavenPluginBuilder.create(),2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
".setCoordinate(createCoordinate(""io.fabric8"", ""fabric8-maven-plugin"", VersionHelper.fabric8Version()))",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
".addExecution(ExecutionBuilder.create().setId(""json"").addGoal(""json""));",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
pluginFacet.addPlugin(plugin);,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
String container = null;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
String icon = null;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"container = ""java"";",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"icon = ""icons/java.svg"";",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"container = ""karaf"";",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"icon = ""icons/karaf.svg"";",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"container = ""tomcat"";",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"icon = ""icons/tomcat.svg"";",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
// update properties section in pom.xml,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
MavenFacet maven = project.getFacet(MavenFacet.class);,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
Model pom = maven.getModel();,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
Properties properties = pom.getProperties();,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
boolean updated = false;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"properties.put(""fabric8.label.container"", container);",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
updated = true;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"properties.put(""fabric8.iconRef"", icon);",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"properties.put(""fabric8.label.group"", group.getValue());",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"properties.put(""docker.env.MAIN"", main.getValue());",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
maven.setModel(pom);,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"return Results.navigateTo(DockerStepCommand.class, JubeStepCommand.class, FabricStepCommand.class);",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
"return Results.navigateTo(DockerStepCommand.class, FabricStepCommand.class);",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
"return Results.navigateTo(JubeStepCommand.class, FabricSetupCommand.class);",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
@Inject,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
private UIInput<String> group;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
private DependencyInstaller dependencyInstaller;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"return Results.navigateTo(DockerStepCommand.class, JubeStepCommand.class);",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
return Results.navigateTo(DockerStepCommand.class);,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
return Results.navigateTo(JubeStepCommand.class);,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
builder.add(group);,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
MavenFacet maven = project.getFacet(MavenFacet.class);,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
return maven.getModel().getPackaging();,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
return null;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"@FacetConstraint({MavenFacet.class, MavenPluginFacet.class, ResourcesFacet.class})",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
"@FacetConstraint({MavenFacet.class, MavenPluginFacet.class})",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
// noop,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,0
// TODO: Jube does not currently work so disable jube until working again,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"// private String[] platforms = new String[]{""Docker"", ""Jube"", ""Docker-and-Jube""};",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"private String[] platforms = new String[]{""Docker""};",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
@Inject,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"@WithAttributes(label = ""platform"", required = true, description = ""The runtime platform"")",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
private UISelectOne<String> platform;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"context.getUIContext().getAttributeMap().put(""platform"", platform.getValue());",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
builder.add(platform);,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
platform.setValueChoices(Arrays.asList(platforms));,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"platform.setDefaultValue(""Docker"");",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"// if windows use jube, otherwise docker",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"//    platform.setDefaultValue(""Jube"");",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"//    platform.setDefaultValue(""Docker"");",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
//},2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"String osName = System.getProperty(""os.name"").toLowerCase(Locale.US);",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
return osName.contains(platform.toLowerCase(Locale.US));,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
/**,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
*/,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
package io.fabric8.forge.devops.setup;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"public static String CATEGORY = ""Fabric"";",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
@Inject,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
@Override,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
return true;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"return Projects.getSelectedProject(this.getProjectFactory(), context);",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
return context.getUIContext().getProvider().getOutput().out();,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"return createCoordinate(groupId, artifactId, version, null);",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
.setGroupId(groupId),2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
.setArtifactId(artifactId);,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
return builder;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
/**,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
*/,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
package io.fabric8.forge.devops.setup;,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"@FacetConstraint({MavenFacet.class, MavenPluginFacet.class, ResourcesFacet.class})",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
@Override,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
return Metadata.forCommand(Fabric8SetupCommand.class).name(,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"""Fabric8: Setup"").category(Categories.create(CATEGORY))",2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
return Results.navigateTo(Fabric8SetupStep.class);,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
// noop,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
return Results.success();,2f7bc201ac07e16f202b42bc8d7d30fbc444d41e,0,1
"public void applyList(JsonNode entity, String sourceName) throws IOException {",ec7bca6138b5657072800db97ec07f1d5d463615,7,1
"public void applyList(JsonNode entity, String sourceName) throws Exception {",ec7bca6138b5657072800db97ec07f1d5d463615,6,0
"protected void doCreateService(Service service, String namespace, String sourceName) {",ec7bca6138b5657072800db97ec07f1d5d463615,6,0
"protected void doCreateReplicationController(ReplicationController replicationController, String namespace, String sourceName) {",ec7bca6138b5657072800db97ec07f1d5d463615,6,0
"protected void doCreatePod(Pod pod, String namespace, String sourceName) {",ec7bca6138b5657072800db97ec07f1d5d463615,6,0
"public void apply(Object dto, String sourceName) throws IOException {",ec7bca6138b5657072800db97ec07f1d5d463615,6,1
"public void applyConfig(Config config, String sourceName) throws IOException {",ec7bca6138b5657072800db97ec07f1d5d463615,6,1
"} else if (Objects.equal(""Config"", kind) || Objects.equal(""List"", kind)) {",ec7bca6138b5657072800db97ec07f1d5d463615,6,0
"} else if (Objects.equal(""Config"", kind) || Objects.equal(""List"", kind)) {",ec7bca6138b5657072800db97ec07f1d5d463615,6,1
"public void applyList(JsonNode entity, String sourceName) throws Exception {",ec7bca6138b5657072800db97ec07f1d5d463615,6,1
"} else if (Objects.equal(""Config"", kind) || Objects.equal(""List"", kind)) {",ec7bca6138b5657072800db97ec07f1d5d463615,6,1
"public void apply(Object dto, String sourceName) throws Exception {",ec7bca6138b5657072800db97ec07f1d5d463615,5,0
"public void applyEntity(Object dto, String sourceName) throws Exception {",ec7bca6138b5657072800db97ec07f1d5d463615,5,0
"public void applyConfig(Config config, String sourceName) throws Exception {",ec7bca6138b5657072800db97ec07f1d5d463615,5,0
"public void applyService(Service service, String sourceName) throws Exception {",ec7bca6138b5657072800db97ec07f1d5d463615,5,0
"public void applyReplicationController(ReplicationController replicationController, String sourceName) throws Exception {",ec7bca6138b5657072800db97ec07f1d5d463615,5,0
"public void applyPod(Pod pod, String sourceName) throws Exception {",ec7bca6138b5657072800db97ec07f1d5d463615,5,0
"public void applyList(KubernetesList list, String sourceName) throws Exception {",ec7bca6138b5657072800db97ec07f1d5d463615,5,0
"if (Objects.equal(""Config"", kind) || Objects.equal(""List"", kind)) {",ec7bca6138b5657072800db97ec07f1d5d463615,5,1
"protected static void addObjectsToItemArray(List destinationList, Object object) throws IOException {",ec7bca6138b5657072800db97ec07f1d5d463615,5,0
"protected static Object loadEntity(byte[] json, String kind, Object defaultValue) throws IOException {",ec7bca6138b5657072800db97ec07f1d5d463615,5,1
protected static Config loadList(byte[] data) throws IOException {,ec7bca6138b5657072800db97ec07f1d5d463615,5,1
"protected static void addObjectsToItemArray(ArrayNode itemArray, Object object) throws IOException {",ec7bca6138b5657072800db97ec07f1d5d463615,5,1
public String apply(File file) throws IOException {,ec7bca6138b5657072800db97ec07f1d5d463615,4,1
public String applyJson(byte[] json) throws IOException {,ec7bca6138b5657072800db97ec07f1d5d463615,4,1
public String applyJson(String json) throws IOException {,ec7bca6138b5657072800db97ec07f1d5d463615,4,1
public String applyJson(File json) throws IOException {,ec7bca6138b5657072800db97ec07f1d5d463615,4,1
public String applyYaml(String yaml) throws IOException {,ec7bca6138b5657072800db97ec07f1d5d463615,4,1
public String applyYaml(File yaml) throws IOException {,ec7bca6138b5657072800db97ec07f1d5d463615,4,1
public String applyJson(InputStream json) throws IOException {,ec7bca6138b5657072800db97ec07f1d5d463615,4,1
"public void applyEntity(Object dto, String sourceName) {",ec7bca6138b5657072800db97ec07f1d5d463615,4,1
"public void applyService(Service service, String sourceName) {",ec7bca6138b5657072800db97ec07f1d5d463615,4,1
"public void applyReplicationController(ReplicationController replicationController, String sourceName) {",ec7bca6138b5657072800db97ec07f1d5d463615,4,1
"public void applyPod(Pod pod, String sourceName) {",ec7bca6138b5657072800db97ec07f1d5d463615,4,1
"} else if (Objects.equal(""Template"", kind)) {",ec7bca6138b5657072800db97ec07f1d5d463615,4,1
"} else if (Objects.equal(""ReplicationController"", kind)) {",ec7bca6138b5657072800db97ec07f1d5d463615,4,1
"} else if (Objects.equal(""Service"", kind)) {",ec7bca6138b5657072800db97ec07f1d5d463615,4,1
"} else if (Objects.equal(""BuildConfig"", kind)) {",ec7bca6138b5657072800db97ec07f1d5d463615,4,1
"} else if (Objects.equal(""DeploymentConfig"", kind)) {",ec7bca6138b5657072800db97ec07f1d5d463615,4,1
"} else if (Objects.equal(""ImageRepository"", kind)) {",ec7bca6138b5657072800db97ec07f1d5d463615,4,1
"} else if (Objects.equal(""Template"", kind)) {",ec7bca6138b5657072800db97ec07f1d5d463615,4,1
public String apply(File file) throws Exception {,ec7bca6138b5657072800db97ec07f1d5d463615,3,0
public String applyJson(byte[] json) throws Exception {,ec7bca6138b5657072800db97ec07f1d5d463615,3,0
public String applyJson(String json) throws Exception {,ec7bca6138b5657072800db97ec07f1d5d463615,3,0
public String applyJson(File json) throws Exception {,ec7bca6138b5657072800db97ec07f1d5d463615,3,0
public String applyYaml(String yaml) throws Exception {,ec7bca6138b5657072800db97ec07f1d5d463615,3,0
public String applyYaml(File yaml) throws Exception {,ec7bca6138b5657072800db97ec07f1d5d463615,3,0
public String applyJson(InputStream json) throws Exception {,ec7bca6138b5657072800db97ec07f1d5d463615,3,0
} else if (entity instanceof Template) {,ec7bca6138b5657072800db97ec07f1d5d463615,3,0
} else if (dto instanceof KubernetesList) {,ec7bca6138b5657072800db97ec07f1d5d463615,3,0
} else if (dto instanceof JsonNode) {,ec7bca6138b5657072800db97ec07f1d5d463615,3,1
} else if (entity instanceof KubernetesList) {,ec7bca6138b5657072800db97ec07f1d5d463615,3,0
public static Object combineJson(Object... objects) throws IOException {,ec7bca6138b5657072800db97ec07f1d5d463615,3,0
protected static void moveServicesToFrontOfArray(List<Object> list) {,ec7bca6138b5657072800db97ec07f1d5d463615,3,0
protected static void removeDuplicates(List<Object> itemArray) {,ec7bca6138b5657072800db97ec07f1d5d463615,3,0
} else if (object instanceof Collection) {,ec7bca6138b5657072800db97ec07f1d5d463615,3,0
"protected static String getJsonTextProperty(JsonNode node, String... names) {",ec7bca6138b5657072800db97ec07f1d5d463615,3,1
"if (Objects.equal(""Pod"", kind)) {",ec7bca6138b5657072800db97ec07f1d5d463615,3,1
public static Object getEntity(JsonNode item) throws IOException {,ec7bca6138b5657072800db97ec07f1d5d463615,3,1
public static JsonNode combineJson(Object... objects) throws IOException {,ec7bca6138b5657072800db97ec07f1d5d463615,3,1
protected static void moveServicesToFrontOfArray(ArrayNode itemArray) {,ec7bca6138b5657072800db97ec07f1d5d463615,3,1
protected static void removeDuplicates(ArrayNode itemArray) {,ec7bca6138b5657072800db97ec07f1d5d463615,3,1
public static JsonNode toJsonNode(Object object) throws IOException {,ec7bca6138b5657072800db97ec07f1d5d463615,3,1
} else if (object == null) {,ec7bca6138b5657072800db97ec07f1d5d463615,3,1
if (isUpdateViaDeleteAndCreate()) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,0
} else {,ec7bca6138b5657072800db97ec07f1d5d463615,2,0
if (Strings.isNotBlank(namespace)) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,0
public void setUpdateViaDeleteAndCreate(boolean updateViaDeleteAndCreate) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,0
if (Strings.isNotBlank(namespace)) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
} else {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (entities != null) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,0
for (Object entity : entities) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,0
if (kindNode != null) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
String kind = kindNode.asText();,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
} else {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (items != null) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
String json = item.toString();,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (dto != null) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (entity instanceof List) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,0
if (items == null) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,0
if (object != list) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,0
if (item instanceof Service) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,0
if (item == null) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,0
} else {,ec7bca6138b5657072800db97ec07f1d5d463615,2,0
String kind = item.getClass().getSimpleName();,ec7bca6138b5657072800db97ec07f1d5d463615,2,0
if (Strings.isNotBlank(id)) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,0
"String key = kind + "":"" + id;",ec7bca6138b5657072800db97ec07f1d5d463615,2,0
if (!keys.add(key)) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,0
if (object instanceof KubernetesList) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,0
if (items != null) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,0
protected static KubernetesList findOrCreateList(Object[] objects) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,0
if (list == null) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,0
public static String getId(JsonNode entity) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (entity != null) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
} else {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
public static String getKind(JsonNode entity) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (current == null) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (tree != null) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (kindNode != null) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
String kind = kindNode.asText();,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (entity instanceof JsonNode) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
} if (entity instanceof List) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
Config config = new Config();,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (item != null) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (kindObject != null && kindObject.isTextual()) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
String kind = kindObject.asText();,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
String json = toJson(item);,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (kind != null) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (items instanceof ArrayNode) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (config instanceof ObjectNode) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
"throw new IllegalArgumentException(""config "" + config + "" is not a ObjectNode"");",ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (object != config) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
"protected static JsonNode combineTemplates(JsonNode config, ArrayNode itemArray) {",ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (isTemplate(jsonNode)) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (template == null) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (template != null) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (template instanceof ObjectNode) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (!isTemplate(jsonNode)) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (isService(jsonNode)) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
"String kind = Strings.defaultIfEmpty(getKind(jsonNode), """");",ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (Strings.isNotBlank(id)) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
"String key = kind + "":"" + id;",ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (!keys.add(key)) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
protected static boolean isService(JsonNode jsonNode) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (jsonNode != null) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
protected static boolean isTemplate(JsonNode jsonNode) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (items != null && items.isArray()) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
protected static JsonNodeFactory createNodeFactory() {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
protected static JsonNode findOrCreateConfig(Object[] objects) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
if (object instanceof JsonNode) {,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
// lets create a new list,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
String json = toJson(object);,ec7bca6138b5657072800db97ec07f1d5d463615,2,1
"doCreateService(service, namespace, sourceName);",ec7bca6138b5657072800db97ec07f1d5d463615,1,0
"LOG.info(""Updating a service from "" + sourceName);",ec7bca6138b5657072800db97ec07f1d5d463615,1,0
try {,ec7bca6138b5657072800db97ec07f1d5d463615,1,0
} catch (Exception e) {,ec7bca6138b5657072800db97ec07f1d5d463615,1,0
"doCreateReplicationController(replicationController, namespace, sourceName);",ec7bca6138b5657072800db97ec07f1d5d463615,1,0
"doCreatePod(pod, namespace, sourceName);",ec7bca6138b5657072800db97ec07f1d5d463615,1,0
public boolean isUpdateViaDeleteAndCreate() {,ec7bca6138b5657072800db97ec07f1d5d463615,1,0
"LOG.info(""Updating a service from "" + sourceName);",ec7bca6138b5657072800db97ec07f1d5d463615,1,1
try {,ec7bca6138b5657072800db97ec07f1d5d463615,1,1
} catch (Exception e) {,ec7bca6138b5657072800db97ec07f1d5d463615,1,1
"applyList((KubernetesList) dto, sourceName);",ec7bca6138b5657072800db97ec07f1d5d463615,1,0
"applyEntity(entity, sourceName);",ec7bca6138b5657072800db97ec07f1d5d463615,1,0
JsonNode tree = (JsonNode) dto;,ec7bca6138b5657072800db97ec07f1d5d463615,1,1
"applyList(tree, sourceName);",ec7bca6138b5657072800db97ec07f1d5d463615,1,1
"applyTemplate(template, sourceName);",ec7bca6138b5657072800db97ec07f1d5d463615,1,1
"LOG.warn(""No JSON kind for: "" + tree);",ec7bca6138b5657072800db97ec07f1d5d463615,1,1
for (JsonNode item : items) {,ec7bca6138b5657072800db97ec07f1d5d463615,1,1
// lets parse into a new object,ec7bca6138b5657072800db97ec07f1d5d463615,1,1
// TODO the apply method should deal with the item direct?,ec7bca6138b5657072800db97ec07f1d5d463615,1,1
try {,ec7bca6138b5657072800db97ec07f1d5d463615,1,1
} catch (IOException e) {,ec7bca6138b5657072800db97ec07f1d5d463615,1,1
"onApplyError(""Failed to process "" + json + "". "" + e, e);",ec7bca6138b5657072800db97ec07f1d5d463615,1,1
"apply(dto, sourceName);",ec7bca6138b5657072800db97ec07f1d5d463615,1,1
} catch (Exception e) {,ec7bca6138b5657072800db97ec07f1d5d463615,1,1
"onApplyError(""Failed to create config from "" + sourceName + "". "" + e, e);",ec7bca6138b5657072800db97ec07f1d5d463615,1,1
KubernetesList config = (KubernetesList) entity;,ec7bca6138b5657072800db97ec07f1d5d463615,1,0
KubernetesList list = findOrCreateList(objects);,ec7bca6138b5657072800db97ec07f1d5d463615,1,0
String id = getObjectId(item);,ec7bca6138b5657072800db97ec07f1d5d463615,1,0
// lets remove this one,ec7bca6138b5657072800db97ec07f1d5d463615,1,0
KubernetesList list = null;,ec7bca6138b5657072800db97ec07f1d5d463615,1,0
list = (KubernetesList) object;,ec7bca6138b5657072800db97ec07f1d5d463615,1,0
list = new KubernetesList();,ec7bca6138b5657072800db97ec07f1d5d463615,1,0
TODO Config,ec7bca6138b5657072800db97ec07f1d5d463615,1,1
for (String name : names) {,ec7bca6138b5657072800db97ec07f1d5d463615,1,1
* {@link JsonNode} if it cannot be recognised.,ec7bca6138b5657072800db97ec07f1d5d463615,1,1
JsonNode tree = reader.readTree(new ByteArrayInputStream(json));,ec7bca6138b5657072800db97ec07f1d5d463615,1,1
for (JsonNode item : items) {,ec7bca6138b5657072800db97ec07f1d5d463615,1,1
"Object entity = loadEntity(bytes, kind, null);",ec7bca6138b5657072800db97ec07f1d5d463615,1,1
* Loads the entity for the given item,ec7bca6138b5657072800db97ec07f1d5d463615,1,1
JsonNode config = findOrCreateConfig(objects);,ec7bca6138b5657072800db97ec07f1d5d463615,1,1
* If we have any templates inside the itemArray then lets unpack them and combine any parameters,ec7bca6138b5657072800db97ec07f1d5d463615,1,1
for (JsonNode jsonNode : config) {,ec7bca6138b5657072800db97ec07f1d5d463615,1,1
// lets move all the content into the template,ec7bca6138b5657072800db97ec07f1d5d463615,1,1
"throw new IllegalArgumentException(""config "" + template + "" is not a ObjectNode"");",ec7bca6138b5657072800db97ec07f1d5d463615,1,1
String id = getId(jsonNode);,ec7bca6138b5657072800db97ec07f1d5d463615,1,1
// lets remove this one,ec7bca6138b5657072800db97ec07f1d5d463615,1,1
"JsonNode kind = jsonNode.get(""kind"");",ec7bca6138b5657072800db97ec07f1d5d463615,1,1
"return kind != null && Objects.equal(""Service"", kind.textValue());",ec7bca6138b5657072800db97ec07f1d5d463615,1,1
"return kind != null && Objects.equal(""Template"", kind.textValue());",ec7bca6138b5657072800db97ec07f1d5d463615,1,1
JsonNodeFactory factory = createNodeFactory();,ec7bca6138b5657072800db97ec07f1d5d463615,1,1
ObjectNode config = factory.objectNode();,ec7bca6138b5657072800db97ec07f1d5d463615,1,1
"config.set(""kind"", factory.textNode(""List""));",ec7bca6138b5657072800db97ec07f1d5d463615,1,1
* Converts the DTO to a JsonNode,ec7bca6138b5657072800db97ec07f1d5d463615,1,1
private boolean updateViaDeleteAndCreate;,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
kubernetes.deleteService(service);,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"Object answer = kubernetes.updateService(id, service, namespace);",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"LOG.info(""Updated service: "" + answer);",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"onApplyError(""Failed to update controller from "" + sourceName + "". "" + e + "". "" + service, e);",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
},ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"LOG.info(""Creating a service from "" + sourceName + "" namespace "" + namespace + "" name "" + getId(service));",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
Object answer;,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"answer = kubernetes.createService(service, namespace);",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
answer = kubernetes.createService(service);,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"LOG.info(""Created service: "" + answer);",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"onApplyError(""Failed to create service from "" + sourceName + "". "" + e + "". "" + service, e);",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
kubernetes.deleteReplicationControllerAndPods(replicationController);,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"LOG.info(""Updating replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getId(replicationController));",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"Object answer = kubernetes.updateReplicationController(id, replicationController);",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"LOG.info(""Updated replicationController: "" + answer);",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"onApplyError(""Failed to update replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"LOG.info(""Creating a replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getId(replicationController));",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"answer = kubernetes.createReplicationController(replicationController, namespace);",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
answer = kubernetes.createReplicationController(replicationController);,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"LOG.info(""Created replicationController: "" + answer);",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"onApplyError(""Failed to create replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
kubernetes.deletePod(pod);,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"LOG.info(""Updating a pod from "" + sourceName + "" namespace "" + namespace + "" name "" + getId(pod));",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"Object answer = kubernetes.updatePod(id, pod);",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"LOG.info(""Updated pod result: "" + answer);",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"onApplyError(""Failed to update pod from "" + sourceName + "". "" + e + "". "" + pod, e);",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"LOG.info(""Creating a pod from "" + sourceName + "" namespace "" + namespace + "" name "" + getId(pod));",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"answer = kubernetes.createPod(pod, namespace);",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
answer = kubernetes.createPod(pod);,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"LOG.info(""Created pod result: "" + answer);",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"onApplyError(""Failed to create pod from "" + sourceName + "". "" + e + "". "" + pod, e);",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
return updateViaDeleteAndCreate;,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
this.updateViaDeleteAndCreate = updateViaDeleteAndCreate;,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"Object answer = kubernetes.updateService(id, service, namespace);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"LOG.info(""Updated service: "" + answer);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"onApplyError(""Failed to update controller from "" + sourceName + "". "" + e + "". "" + service, e);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"LOG.info(""Creating a service from "" + sourceName + "" namespace "" + namespace + "" name "" + getId(service));",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
Object answer;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"answer = kubernetes.createService(service, namespace);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
answer = kubernetes.createService(service);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
},ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"LOG.info(""Created service: "" + answer);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"onApplyError(""Failed to create service from "" + sourceName + "". "" + e + "". "" + service, e);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"LOG.info(""Updating replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getId(replicationController));",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"Object answer = kubernetes.updateReplicationController(id, replicationController);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"LOG.info(""Updated replicationController: "" + answer);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"onApplyError(""Failed to update replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"LOG.info(""Creating a replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getId(replicationController));",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"answer = kubernetes.createReplicationController(replicationController, namespace);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
answer = kubernetes.createReplicationController(replicationController);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"LOG.info(""Created replicationController: "" + answer);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"onApplyError(""Failed to create replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"LOG.info(""Updating a pod from "" + sourceName + "" namespace "" + namespace + "" name "" + getId(pod));",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"Object answer = kubernetes.updatePod(id, pod);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"LOG.info(""Updated pod result: "" + answer);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"onApplyError(""Failed to update pod from "" + sourceName + "". "" + e + "". "" + pod, e);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"LOG.info(""Creating a pod from "" + sourceName + "" namespace "" + namespace + "" name "" + getId(pod));",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"answer = kubernetes.createPod(pod, namespace);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
answer = kubernetes.createPod(pod);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"LOG.info(""Created pod result: "" + answer);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"onApplyError(""Failed to create pod from "" + sourceName + "". "" + e + "". "" + pod, e);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
import io.fabric8.openshift.api.model.template.Template;,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
Template objects = (Template) entity;,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
return objects.getObjects();,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
return loadList(json);,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
return loadList(json);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
/*,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
*/,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
import io.fabric8.kubernetes.api.model.KubernetesList;,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
List<Object> entities = list.getItems();,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
},ec7bca6138b5657072800db97ec07f1d5d463615,0,0
import com.fasterxml.jackson.databind.JsonNode;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
import io.fabric8.utils.Objects;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
import java.io.IOException;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
import static io.fabric8.kubernetes.api.KubernetesFactory.createObjectMapper;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"JsonNode kindNode = tree.get(""kind"");",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"Template template = createObjectMapper().treeToValue(tree, Template.class);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"LOG.warn(""Unknown JSON type "" + kindNode + "". JSON: "" + tree);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
},ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"JsonNode items = entity.get(""items"");",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"LOG.debug(""Got item: {}"", json);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
Object dto = null;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
dto = loadJson(json);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
/*,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
kubernetes.createConfig(entity);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
*/,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
import io.fabric8.kubernetes.api.extensions.Templates;,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
import java.util.Collection;,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
* from the Kubernetes REST API,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
return objectMapper.reader(Object.class).readValue(json);,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
return config.getItems();,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
List<Object> items = list.getItems();,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
items = new ArrayList<>();,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
list.setItems(items);,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"addObjectsToItemArray(items, object);",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
moveServicesToFrontOfArray(items);,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
removeDuplicates(items);,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"return Templates.combineTemplates(list, items);",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
int size = list.size();,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
Object item = list.get(i);,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
Object nonService = list.get(lastNonService);,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"list.set(i, nonService);",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
"list.set(lastNonService, item);",ec7bca6138b5657072800db97ec07f1d5d463615,0,0
* @param itemArray,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
Object item = itemArray.get(i);,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
itemArray.remove(i);,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
i--;,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
size--;,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
},ec7bca6138b5657072800db97ec07f1d5d463615,0,0
KubernetesList kubernetesList = (KubernetesList) object;,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
List<Object> items = kubernetesList.getItems();,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
destinationList.addAll(items);,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
Collection collection = (Collection) object;,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
destinationList.addAll(collection);,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
destinationList.add(object);,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
break;,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
return list;,ec7bca6138b5657072800db97ec07f1d5d463615,0,0
import com.fasterxml.jackson.databind.JsonNode;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
import com.fasterxml.jackson.databind.ObjectReader;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
import com.fasterxml.jackson.databind.node.ArrayNode;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
import com.fasterxml.jackson.databind.node.JsonNodeFactory;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
import com.fasterxml.jackson.databind.node.ObjectNode;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
import io.fabric8.openshift.api.model.BuildConfig;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
import io.fabric8.openshift.api.model.DeploymentConfig;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
import io.fabric8.openshift.api.model.ImageRepository;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
import java.io.ByteArrayInputStream;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
import java.util.Iterator;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
/*,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
import io.fabric8.kubernetes.api.model.Item;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
import io.fabric8.kubernetes.api.model.Template;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
*/,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
return Strings.firstNonBlank(,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"getJsonTextProperty(entity, ""metadata"", ""name""),",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"getJsonTextProperty(entity, ""metadata"", ""id""),",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"getJsonTextProperty(entity, ""name""),",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"getJsonTextProperty(entity, ""id""));",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
return null;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
},ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"return getJsonTextProperty(entity, ""kind"");",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
JsonNode current = node;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
current = current.get(name);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
return current != null ? current.textValue() : null;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
* from the Kubernetes REST API or,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
ObjectReader reader = objectMapper.reader();,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"JsonNode kindNode = tree.get(""kind"");",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"return loadEntity(json, kind, tree);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"LOG.warn(""No JSON type for: "" + tree);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
return tree;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
JsonNode jsonNode = (JsonNode) entity;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
return toItemList(getEntity(jsonNode));,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
return objectMapper.reader(Pod.class).readValue(json);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
return objectMapper.reader(ReplicationController.class).readValue(json);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
return objectMapper.reader(Service.class).readValue(json);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
return objectMapper.reader(BuildConfig.class).readValue(json);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
return objectMapper.reader(DeploymentConfig.class).readValue(json);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
return objectMapper.reader(ImageRepository.class).readValue(json);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
return objectMapper.reader(Template.class).readValue(json);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
return loadList(json);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
return defaultValue;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
List<Object> itemList = new ArrayList<>();,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
config.setItems(itemList);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
JsonNode jsonNode = objectMapper.readTree(data);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"JsonNode items = jsonNode.get(""items"");",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"JsonNode kindObject = item.get(""kind"");",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
byte[] bytes = json.getBytes();,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
itemList.add(entity);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
return config;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
/**,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
return entity;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"JsonNode items = config.get(""items"");",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
ArrayNode itemArray;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
itemArray = (ArrayNode) items;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
itemArray = new ArrayNode(createNodeFactory());,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
ObjectNode objectNode = (ObjectNode) config;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"objectNode.set(""items"", itemArray);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"addObjectsToItemArray(itemArray, object);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
moveServicesToFrontOfArray(itemArray);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
removeDuplicates(itemArray);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"return combineTemplates(config, itemArray);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
JsonNode template = null;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
template = jsonNode;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
// TODO combine templates...,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"JsonNode items = config.get(""objects"");",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
ArrayNode objects;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
objects = (ArrayNode) items;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
objects = new ArrayNode(createNodeFactory());,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
ObjectNode objectNode = (ObjectNode) template;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"objectNode.set(""objects"", itemArray);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
objects.add(jsonNode);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
return template;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
int size = itemArray.size();,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
JsonNode jsonNode = itemArray.get(i);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
JsonNode nonService = itemArray.get(lastNonService);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"itemArray.set(i, nonService);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"itemArray.set(lastNonService, jsonNode);",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
itemArray.remove(i);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
i--;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
size--;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
return false;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
JsonNode node = toJsonNode(object);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"JsonNode items = node.get(""items"");",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
Iterator<JsonNode> iter = items.iterator();,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
itemArray.add(item);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
itemArray.add(node);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
return new JsonNodeFactory(false);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
JsonNode jsonNode = (JsonNode) object;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
return jsonNode;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"config.set(""apiVersion"", factory.textNode(defaultApiVersion));",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"config.set(""items"", factory.arrayNode());",ec7bca6138b5657072800db97ec07f1d5d463615,0,1
return (JsonNode) object;,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
return objectMapper.reader().readTree(json);,ec7bca6138b5657072800db97ec07f1d5d463615,0,1
"LOG.error(""Failed to trigger job "" + jenkinsSeedJob + "" on "" + jobUrl + "". Status: "" + status + "" message: "" + message);",b077563265697866b9ea39306d56e5f302739d07,14,0
"+ "" on "" + clazz.getName() + "" "" + config + "". "" + e, e);",b077563265697866b9ea39306d56e5f302739d07,11,1
"""                  \""uri\"":\"""" + gitAddress + ""/"" + user + ""/"" + buildName + "".git\""\n"" +",b077563265697866b9ea39306d56e5f302739d07,9,1
"LOG.warn(""Could not find service "" + gitServiceName + "" for namespace "" + namespace);",b077563265697866b9ea39306d56e5f302739d07,8,1
"onApplyError(""Failed to create BuildConfig from "" + sourceName + "". "" + e, e);",b077563265697866b9ea39306d56e5f302739d07,7,0
"LOG.info(""Looking up service "" + serviceName + "" for namespace: "" + namespace);",b077563265697866b9ea39306d56e5f302739d07,7,0
"LOG.info(""Commiting and pushing to: "" + remoteUrl + "" and remote name "" + origin);",b077563265697866b9ea39306d56e5f302739d07,7,0
"String remoteUrl = internalAddress + user + ""/"" + named + "".git"";",b077563265697866b9ea39306d56e5f302739d07,7,1
"//results.appendOut(""Created git repository "" + fullName + "" at: "" + htmlUrl);",b077563265697866b9ea39306d56e5f302739d07,7,1
"LOG.info(""Using remoteUrl: "" + remoteUrl + "" and remote name "" + origin);",b077563265697866b9ea39306d56e5f302739d07,7,1
"LOG.info(""Commiting and pushing to: "" + remoteUrl + "" and remote name "" + origin);",b077563265697866b9ea39306d56e5f302739d07,7,1
"LOG.info(""Creating a BuildConfig for namespace: "" + namespace + "" project: "" + projectName);",b077563265697866b9ea39306d56e5f302739d07,7,1
} else if (dto instanceof Config) {,b077563265697866b9ea39306d56e5f302739d07,6,0
} else if (dto instanceof Route) {,b077563265697866b9ea39306d56e5f302739d07,6,0
} else if (dto instanceof Entity) {,b077563265697866b9ea39306d56e5f302739d07,6,1
"LOG.error(""Failed to trigger jenkins on "" + jobUrl + "". "" + e, e);",b077563265697866b9ea39306d56e5f302739d07,6,0
"LOG.info(""Got response code from Jenkins: "" + status + "" message: "" + message);",b077563265697866b9ea39306d56e5f302739d07,6,0
"String htmlUrl = address + user + ""/"" + named;",b077563265697866b9ea39306d56e5f302739d07,6,1
} else if (dto != null) {,b077563265697866b9ea39306d56e5f302739d07,5,0
"public void applyRoute(Route entity, String sourceName) {",b077563265697866b9ea39306d56e5f302739d07,5,0
"LOG.info(""Creating route "" + namespace + "":"" + id);",b077563265697866b9ea39306d56e5f302739d07,5,0
} else if (entity instanceof KubernetesList) {,b077563265697866b9ea39306d56e5f302739d07,5,0
"String key = kind + "":"" + id;",b077563265697866b9ea39306d56e5f302739d07,5,0
} else if (object instanceof Collection) {,b077563265697866b9ea39306d56e5f302739d07,5,0
"} else if (Objects.equal(""ReplicationController"", kind)) {",b077563265697866b9ea39306d56e5f302739d07,5,1
"} else if (Objects.equal(""Service"", kind)) {",b077563265697866b9ea39306d56e5f302739d07,5,1
"} else if (Objects.equal(""BuildConfig"", kind)) {",b077563265697866b9ea39306d56e5f302739d07,5,1
"} else if (Objects.equal(""DeploymentConfig"", kind)) {",b077563265697866b9ea39306d56e5f302739d07,5,1
"} else if (Objects.equal(""ImageRepository"", kind)) {",b077563265697866b9ea39306d56e5f302739d07,5,1
"} else if (Objects.equal(""Template"", kind)) {",b077563265697866b9ea39306d56e5f302739d07,5,1
"} else if (Objects.equal(""Config"", kind) || Objects.equal(""List"", kind)) {",b077563265697866b9ea39306d56e5f302739d07,5,1
"String key = kind + "":"" + id;",b077563265697866b9ea39306d56e5f302739d07,5,1
"LOG.warn(""Could not introspect "" + clazz.getName() + "". "" + e, e);",b077563265697866b9ea39306d56e5f302739d07,5,1
"protected void createKubernetesResources(String user, String buildName, String remote, String branch, GitRepoClient repoClient, String address) throws Exception {",b077563265697866b9ea39306d56e5f302739d07,5,1
"""               \""user\"":\"""" + user + ""\""\n"" +",b077563265697866b9ea39306d56e5f302739d07,5,1
"""                     \""user\"":\"""" + user + ""\""\n"" +",b077563265697866b9ea39306d56e5f302739d07,5,1
"""                  \""user\"":\"""" + user + ""\""\n"" +",b077563265697866b9ea39306d56e5f302739d07,5,1
"LOG.warn(""Failed to write file "" + dummyFile + "". "" + e, e);",b077563265697866b9ea39306d56e5f302739d07,5,1
if (dto instanceof List) {,b077563265697866b9ea39306d56e5f302739d07,4,0
if (dto instanceof Config) {,b077563265697866b9ea39306d56e5f302739d07,4,1
} if (entity instanceof List) {,b077563265697866b9ea39306d56e5f302739d07,4,1
"throw new IllegalArgumentException(""config "" + config + "" is not a ObjectNode"");",b077563265697866b9ea39306d56e5f302739d07,4,1
"throw new IllegalArgumentException(""config "" + template + "" is not a ObjectNode"");",b077563265697866b9ea39306d56e5f302739d07,4,1
} else if (object == null) {,b077563265697866b9ea39306d56e5f302739d07,4,1
"LOG.warn(""Failed to create web hook in git repo: "" + e, e);",b077563265697866b9ea39306d56e5f302739d07,4,0
"LOG.warn(""Failed to create web hook in git repo: "" + e, e);",b077563265697866b9ea39306d56e5f302739d07,4,1
"LOG.warn(""Failed to set property "" + name",b077563265697866b9ea39306d56e5f302739d07,4,1
"+ "" with value "" + value",b077563265697866b9ea39306d56e5f302739d07,4,1
"String json = ""\n"" +",b077563265697866b9ea39306d56e5f302739d07,4,1
"""   \""apiVersion\"":\"""" + osapiVersion + ""\"",\n"" +",b077563265697866b9ea39306d56e5f302739d07,4,1
"""         \""apiVersion\"":\"""" + osapiVersion + ""\"",\n"" +",b077563265697866b9ea39306d56e5f302739d07,4,1
"""               \""name\"":\"""" + buildName + ""\"",\n"" +",b077563265697866b9ea39306d56e5f302739d07,4,1
"""            \""name\"":\"""" + buildName + ""\""\n"" +",b077563265697866b9ea39306d56e5f302739d07,4,1
"""                  \""name\"":\"""" + buildName + ""\""\n"" +",b077563265697866b9ea39306d56e5f302739d07,4,1
"""                  \""builderImage\"":\"""" + builderImage + ""\"",\n"" +",b077563265697866b9ea39306d56e5f302739d07,4,1
"""                  \""image\"":\"""" + builderImage + ""\""\n"" +",b077563265697866b9ea39306d56e5f302739d07,4,1
"""                  \""secret\"":\"""" + secret + ""\""\n"" +",b077563265697866b9ea39306d56e5f302739d07,4,1
"""            \""name\"":\"""" + buildName + ""-deploy\""\n"" +",b077563265697866b9ea39306d56e5f302739d07,4,1
"""                              \""image\"":\"""" + buildName + ""\"",\n"" +",b077563265697866b9ea39306d56e5f302739d07,4,1
"""                              \""name\"":\"""" + buildName + ""\"",\n"" +",b077563265697866b9ea39306d56e5f302739d07,4,1
"""                        \""version\"":\"""" + imageTag + ""\""\n"" +",b077563265697866b9ea39306d56e5f302739d07,4,1
"""                     \""name\"":\"""" + buildName + ""\"",\n"" +",b077563265697866b9ea39306d56e5f302739d07,4,1
"""                  \""name\"":\"""" + buildName + ""\"",\n"" +",b077563265697866b9ea39306d56e5f302739d07,4,1
"""                     \"""" + buildName + ""\""\n"" +",b077563265697866b9ea39306d56e5f302739d07,4,1
"""                     \""name\"":\"""" + buildName + ""\""\n"" +",b077563265697866b9ea39306d56e5f302739d07,4,1
"""                  \""tag\"":\"""" + imageTag + ""\""\n"" +",b077563265697866b9ea39306d56e5f302739d07,4,1
"LOG.warn(""Failed to create web hook in git repo: "" + e, e);",b077563265697866b9ea39306d56e5f302739d07,4,1
"* For new projects; lets git add, git commit, git push otherwise lets git add/commit/push any new/udpated changes",b077563265697866b9ea39306d56e5f302739d07,4,1
} else if (Strings.isNullOrEmpty(named)) {,b077563265697866b9ea39306d56e5f302739d07,4,1
"fullName = user + ""/"" + named;",b077563265697866b9ea39306d56e5f302739d07,4,1
"protected void createBuildConfig(RestUIContext context, String namespace, String projectName, String cloneUrl) throws Exception {",b077563265697866b9ea39306d56e5f302739d07,4,1
String namespace = KubernetesHelper.getNamespace(entity);,b077563265697866b9ea39306d56e5f302739d07,3,0
if (entity instanceof List) {,b077563265697866b9ea39306d56e5f302739d07,3,0
if (item instanceof Service) {,b077563265697866b9ea39306d56e5f302739d07,3,0
} else {,b077563265697866b9ea39306d56e5f302739d07,3,0
String kind = item.getClass().getSimpleName();,b077563265697866b9ea39306d56e5f302739d07,3,0
if (object instanceof KubernetesList) {,b077563265697866b9ea39306d56e5f302739d07,3,0
public static String getId(JsonNode entity) {,b077563265697866b9ea39306d56e5f302739d07,3,1
} else {,b077563265697866b9ea39306d56e5f302739d07,3,1
public static String getKind(JsonNode entity) {,b077563265697866b9ea39306d56e5f302739d07,3,1
String kind = kindNode.asText();,b077563265697866b9ea39306d56e5f302739d07,3,1
if (entity instanceof JsonNode) {,b077563265697866b9ea39306d56e5f302739d07,3,1
"if (Objects.equal(""Pod"", kind)) {",b077563265697866b9ea39306d56e5f302739d07,3,1
String kind = kindObject.asText();,b077563265697866b9ea39306d56e5f302739d07,3,1
String json = toJson(item);,b077563265697866b9ea39306d56e5f302739d07,3,1
if (items instanceof ArrayNode) {,b077563265697866b9ea39306d56e5f302739d07,3,1
if (config instanceof ObjectNode) {,b077563265697866b9ea39306d56e5f302739d07,3,1
if (template instanceof ObjectNode) {,b077563265697866b9ea39306d56e5f302739d07,3,1
"String kind = Strings.defaultIfEmpty(getKind(jsonNode), """");",b077563265697866b9ea39306d56e5f302739d07,3,1
if (object instanceof JsonNode) {,b077563265697866b9ea39306d56e5f302739d07,3,1
String json = toJson(object);,b077563265697866b9ea39306d56e5f302739d07,3,1
"public static final String DEFAULT_JENKINS_SEED_JOB = ""seed"";",b077563265697866b9ea39306d56e5f302739d07,3,0
"@ConfigProperty(name = ""JENKINS_SEED_JOB"", defaultValue = DEFAULT_JENKINS_SEED_JOB) String jenkinsSeedJob,",b077563265697866b9ea39306d56e5f302739d07,3,0
"@ConfigProperty(name = ""OPENSHIFT_CREATE_BUILD_ON_PROJECT_CREATE"", defaultValue = ""false"") boolean createOpenShiftBuildResources) {",b077563265697866b9ea39306d56e5f302739d07,3,0
"LOG.info(""Attempting to trigger the jenkins seed build on: "" + jobUrl);",b077563265697866b9ea39306d56e5f302739d07,3,0
"String json = ""{}"";",b077563265697866b9ea39306d56e5f302739d07,3,0
String namespace = kubernetes.getNamespace();,b077563265697866b9ea39306d56e5f302739d07,3,0
"String namespace = ""default"";",b077563265697866b9ea39306d56e5f302739d07,3,1
String name = descriptor.getName();,b077563265697866b9ea39306d56e5f302739d07,3,1
String namespace = KubernetesHelper.defaultNamespace();,b077563265697866b9ea39306d56e5f302739d07,3,1
"String gitAddress = getServiceAddress(gitServiceName, namespace);",b077563265697866b9ea39306d56e5f302739d07,3,1
"LOG.warn(""failed to find fabric8 console service URL: "" + e, e);",b077563265697866b9ea39306d56e5f302739d07,3,1
// TODO should be to: { labels },b077563265697866b9ea39306d56e5f302739d07,3,1
public class GitCommandCompletePostProcessor implements CommandCompletePostProcessor {,b077563265697866b9ea39306d56e5f302739d07,3,1
"public static final String PROJECT_NEW_COMMAND = ""project-new"";",b077563265697866b9ea39306d56e5f302739d07,3,1
"public static final String TARGET_LOCATION_PROPERTY = ""targetLocation"";",b077563265697866b9ea39306d56e5f302739d07,3,1
"public static final String DEFAULT_JENKINS_SEED_JOB = ""seed"";",b077563265697866b9ea39306d56e5f302739d07,3,1
"@ConfigProperty(name = ""JENKINS_SEED_JOB"", defaultValue = DEFAULT_JENKINS_SEED_JOB) String jenkinsSeedJob,",b077563265697866b9ea39306d56e5f302739d07,3,1
"@ConfigProperty(name = ""OPENSHIFT_CREATE_BUILD_ON_PROJECT_CREATE"", defaultValue = ""false"") boolean createOpenShiftBuildResources) {",b077563265697866b9ea39306d56e5f302739d07,3,1
"public UserDetails preprocessRequest(String name, ExecutionRequest executionRequest, HttpServletRequest request) {",b077563265697866b9ea39306d56e5f302739d07,3,1
"public void firePostCompleteActions(String name, ExecutionRequest executionRequest, RestUIContext context, CommandController controller, ExecutionResult results, HttpServletRequest request) {",b077563265697866b9ea39306d56e5f302739d07,3,1
String user = userDetails.getUser();,b077563265697866b9ea39306d56e5f302739d07,3,1
} else {,b077563265697866b9ea39306d56e5f302739d07,3,1
Git git = initCommand.call();,b077563265697866b9ea39306d56e5f302739d07,3,1
"String cloneUrl =  htmlUrl + "".git"";",b077563265697866b9ea39306d56e5f302739d07,3,1
"String namespace = firstNotBlank(context.getProjectName(), executionRequest.getNamespace());",b077563265697866b9ea39306d56e5f302739d07,3,1
public static String firstNotBlank(String... texts) {,b077563265697866b9ea39306d56e5f302739d07,3,1
protected String getJenkinsServiceUrl(String namespace) {,b077563265697866b9ea39306d56e5f302739d07,3,1
if (registerWebHooksValue instanceof Runnable) {,b077563265697866b9ea39306d56e5f302739d07,3,1
"applyRoute((Route) dto, sourceName);",b077563265697866b9ea39306d56e5f302739d07,2,0
String id = KubernetesHelper.getId(entity);,b077563265697866b9ea39306d56e5f302739d07,2,0
"Route route = kubernetes.findRoute(id, namespace);",b077563265697866b9ea39306d56e5f302739d07,2,0
if (route == null) {,b077563265697866b9ea39306d56e5f302739d07,2,0
} catch (Exception e) {,b077563265697866b9ea39306d56e5f302739d07,2,0
public static Object combineJson(Object... objects) throws IOException {,b077563265697866b9ea39306d56e5f302739d07,2,0
if (items == null) {,b077563265697866b9ea39306d56e5f302739d07,2,0
if (object != list) {,b077563265697866b9ea39306d56e5f302739d07,2,0
if (item == null) {,b077563265697866b9ea39306d56e5f302739d07,2,0
String id = getObjectId(item);,b077563265697866b9ea39306d56e5f302739d07,2,0
if (Strings.isNotBlank(id)) {,b077563265697866b9ea39306d56e5f302739d07,2,0
if (!keys.add(key)) {,b077563265697866b9ea39306d56e5f302739d07,2,0
if (items != null) {,b077563265697866b9ea39306d56e5f302739d07,2,0
if (list == null) {,b077563265697866b9ea39306d56e5f302739d07,2,0
if (entity != null) {,b077563265697866b9ea39306d56e5f302739d07,2,1
"protected static String getJsonTextProperty(JsonNode node, String... names) {",b077563265697866b9ea39306d56e5f302739d07,2,1
for (String name : names) {,b077563265697866b9ea39306d56e5f302739d07,2,1
if (current == null) {,b077563265697866b9ea39306d56e5f302739d07,2,1
ObjectReader reader = objectMapper.reader();,b077563265697866b9ea39306d56e5f302739d07,2,1
if (tree != null) {,b077563265697866b9ea39306d56e5f302739d07,2,1
if (kindNode != null) {,b077563265697866b9ea39306d56e5f302739d07,2,1
"LOG.warn(""No JSON type for: "" + tree);",b077563265697866b9ea39306d56e5f302739d07,2,1
"protected static Object loadEntity(byte[] json, String kind, Object defaultValue) throws IOException {",b077563265697866b9ea39306d56e5f302739d07,2,1
protected static Config loadList(byte[] data) throws IOException {,b077563265697866b9ea39306d56e5f302739d07,2,1
Config config = new Config();,b077563265697866b9ea39306d56e5f302739d07,2,1
if (item != null) {,b077563265697866b9ea39306d56e5f302739d07,2,1
if (kindObject != null && kindObject.isTextual()) {,b077563265697866b9ea39306d56e5f302739d07,2,1
"Object entity = loadEntity(bytes, kind, null);",b077563265697866b9ea39306d56e5f302739d07,2,1
public static Object getEntity(JsonNode item) throws IOException {,b077563265697866b9ea39306d56e5f302739d07,2,1
if (kind != null) {,b077563265697866b9ea39306d56e5f302739d07,2,1
public static JsonNode combineJson(Object... objects) throws IOException {,b077563265697866b9ea39306d56e5f302739d07,2,1
if (object != config) {,b077563265697866b9ea39306d56e5f302739d07,2,1
if (isTemplate(jsonNode)) {,b077563265697866b9ea39306d56e5f302739d07,2,1
if (template == null) {,b077563265697866b9ea39306d56e5f302739d07,2,1
if (template != null) {,b077563265697866b9ea39306d56e5f302739d07,2,1
if (!isTemplate(jsonNode)) {,b077563265697866b9ea39306d56e5f302739d07,2,1
if (isService(jsonNode)) {,b077563265697866b9ea39306d56e5f302739d07,2,1
String id = getId(jsonNode);,b077563265697866b9ea39306d56e5f302739d07,2,1
if (Strings.isNotBlank(id)) {,b077563265697866b9ea39306d56e5f302739d07,2,1
if (!keys.add(key)) {,b077563265697866b9ea39306d56e5f302739d07,2,1
if (jsonNode != null) {,b077563265697866b9ea39306d56e5f302739d07,2,1
"JsonNode kind = jsonNode.get(""kind"");",b077563265697866b9ea39306d56e5f302739d07,2,1
"return kind != null && Objects.equal(""Service"", kind.textValue());",b077563265697866b9ea39306d56e5f302739d07,2,1
"return kind != null && Objects.equal(""Template"", kind.textValue());",b077563265697866b9ea39306d56e5f302739d07,2,1
if (items != null && items.isArray()) {,b077563265697866b9ea39306d56e5f302739d07,2,1
public static JsonNode toJsonNode(Object object) throws IOException {,b077563265697866b9ea39306d56e5f302739d07,2,1
"@ConfigProperty(name = ""OPENSHIFT_CREATE_BUILD_ON_PROJECT_CREATE"") boolean createOpenShiftBuildResources) {",b077563265697866b9ea39306d56e5f302739d07,2,0
if (createOpenShiftBuildResources) {,b077563265697866b9ea39306d56e5f302739d07,2,0
"String type = ""generic"";",b077563265697866b9ea39306d56e5f302739d07,2,0
String webhookUrl = null;,b077563265697866b9ea39306d56e5f302739d07,2,0
String kubeAddress = null;,b077563265697866b9ea39306d56e5f302739d07,2,0
if (kubeAddress == null) {,b077563265697866b9ea39306d56e5f302739d07,2,0
} catch (Exception e) {,b077563265697866b9ea39306d56e5f302739d07,2,0
"LOG.warn(""failed to find cdelivery service URL: "" + e, e);",b077563265697866b9ea39306d56e5f302739d07,2,0
"String namespacePath = """";",b077563265697866b9ea39306d56e5f302739d07,2,0
if (appendNamespaceQuery && !Strings.isNullOrEmpty(namespace)) {,b077563265697866b9ea39306d56e5f302739d07,2,0
"namespacePath = ""/namespace="" + namespace;",b077563265697866b9ea39306d56e5f302739d07,2,0
if (webhookUrl == null) {,b077563265697866b9ea39306d56e5f302739d07,2,0
"webhookUrl = URLUtils.pathJoin(kubeAddress, ""osapi"", KubernetesHelper.defaultOsApiVersion + namespacePath, ""buildConfigHooks"", buildName, secret, type);",b077563265697866b9ea39306d56e5f302739d07,2,0
"LOG.info(""creating a web hook at: "" + webhookUrl);",b077563265697866b9ea39306d56e5f302739d07,2,0
if (LOG.isDebugEnabled()) {,b077563265697866b9ea39306d56e5f302739d07,2,0
"LOG.debug(""Got web hook: "" + toJson(webhook));",b077563265697866b9ea39306d56e5f302739d07,2,0
"String type = ""generic"";",b077563265697866b9ea39306d56e5f302739d07,2,1
String webhookUrl = null;,b077563265697866b9ea39306d56e5f302739d07,2,1
String kubeAddress = null;,b077563265697866b9ea39306d56e5f302739d07,2,1
if (kubeAddress == null) {,b077563265697866b9ea39306d56e5f302739d07,2,1
} catch (Exception e) {,b077563265697866b9ea39306d56e5f302739d07,2,1
"LOG.warn(""failed to find cdelivery service URL: "" + e, e);",b077563265697866b9ea39306d56e5f302739d07,2,1
if (webhookUrl == null) {,b077563265697866b9ea39306d56e5f302739d07,2,1
if (appendNamespaceQuery && !Strings.isNullOrEmpty(namespace)) {,b077563265697866b9ea39306d56e5f302739d07,2,1
"LOG.info(""creating a web hook at: "" + webhookUrl);",b077563265697866b9ea39306d56e5f302739d07,2,1
if (LOG.isDebugEnabled()) {,b077563265697866b9ea39306d56e5f302739d07,2,1
"LOG.debug(""Got web hook: "" + toJson(webhook));",b077563265697866b9ea39306d56e5f302739d07,2,1
if (!Strings.isNullOrEmpty(jenkinsSeedJob)) {,b077563265697866b9ea39306d56e5f302739d07,2,0
"String address = kubernetes.getServiceURL(""cdelivery"", kubernetes.getNamespace(), ""http"", false);",b077563265697866b9ea39306d56e5f302739d07,2,0
if (!Strings.isNullOrEmpty(address)) {,b077563265697866b9ea39306d56e5f302739d07,2,0
"String jobUrl = URLUtils.pathJoin(address, ""/job/"", jenkinsSeedJob);",b077563265697866b9ea39306d56e5f302739d07,2,0
} catch (Exception e) {,b077563265697866b9ea39306d56e5f302739d07,2,0
} finally {,b077563265697866b9ea39306d56e5f302739d07,2,0
if (connection != null) {,b077563265697866b9ea39306d56e5f302739d07,2,0
"@ConfigProperty(name = ""OPENSHIFT_CREATE_BUILD_ON_PROJECT_CREATE"") boolean createOpenShiftBuildResources) {",b077563265697866b9ea39306d56e5f302739d07,2,1
"String address = kubernetes.getServiceURL(ServiceNames.JENKINS, kubernetes.getNamespace(), ""http"", false);",b077563265697866b9ea39306d56e5f302739d07,2,0
"String jobUrl = URLUtils.pathJoin(address, ""/job/"", jenkinsSeedJob, ""/build"");",b077563265697866b9ea39306d56e5f302739d07,2,0
String message = connection.getResponseMessage();,b077563265697866b9ea39306d56e5f302739d07,2,0
if (status != 200) {,b077563265697866b9ea39306d56e5f302739d07,2,0
if (Strings.isNullOrEmpty(namespace)) {,b077563265697866b9ea39306d56e5f302739d07,2,0
namespace = KubernetesClient.defaultNamespace();,b077563265697866b9ea39306d56e5f302739d07,2,0
"String gitServiceName = ""gogs"";",b077563265697866b9ea39306d56e5f302739d07,2,0
"String address = kubernetes.getServiceURL(""cdelivery"", kubernetes.getNamespace(), ""http"", false);",b077563265697866b9ea39306d56e5f302739d07,2,1
"String jobUrl = URLUtils.pathJoin(address, ""/job/"", jenkinsSeedJob);",b077563265697866b9ea39306d56e5f302739d07,2,1
"String gitServiceName = ""gogs-http-service"";",b077563265697866b9ea39306d56e5f302739d07,2,1
} catch (IntrospectionException e) {,b077563265697866b9ea39306d56e5f302739d07,2,1
if (beanInfo != null) {,b077563265697866b9ea39306d56e5f302739d07,2,1
if (writeMethod != null) {,b077563265697866b9ea39306d56e5f302739d07,2,1
String value = map.get(name);,b077563265697866b9ea39306d56e5f302739d07,2,1
if (value != null) {,b077563265697866b9ea39306d56e5f302739d07,2,1
} catch (Exception e) {,b077563265697866b9ea39306d56e5f302739d07,2,1
"String flow = map.get(""flow"");",b077563265697866b9ea39306d56e5f302739d07,2,1
if (!Strings.isNullOrEmpty(flow)) {,b077563265697866b9ea39306d56e5f302739d07,2,1
"String imageTag = ""test"";",b077563265697866b9ea39306d56e5f302739d07,2,1
"String secret = ""secret101"";",b077563265697866b9ea39306d56e5f302739d07,2,1
"String builderImage = ""fabric8/java-main"";",b077563265697866b9ea39306d56e5f302739d07,2,1
"String osapiVersion = ""v1"";",b077563265697866b9ea39306d56e5f302739d07,2,1
"String gitServiceName = ""gogs"";",b077563265697866b9ea39306d56e5f302739d07,2,1
if (gitAddress == null) {,b077563265697866b9ea39306d56e5f302739d07,2,1
"""   \""annotations\"":{\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""      \""description\"":\""This is an end to end example of a Continuous Delivery pipeline running on OpenShift v3\""\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""   },\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""   \""kind\"":\""List\"",\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""   \""items\"":[\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""      {\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""         \""kind\"":\""ImageStream\"",\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""         \""metadata\"":{\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""            \""labels\"":{\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""            },\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""         }\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""      },\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""         \""kind\"":\""BuildConfig\"",\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""         },\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""         \""parameters\"":{\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""            \""output\"":{\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""               \""to\"":{\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""               },\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""               \""tag\"":\""test\""\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""            \""source\"":{\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""               \""git\"":{\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""               \""type\"":\""Git\""\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""            \""strategy\"":{\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""               \""stiStrategy\"":{\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""               \""type\"":\""STI\""\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""            }\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""         \""triggers\"":[\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""            {\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""               \""github\"":{\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""               \""type\"":\""github\""\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""               \""generic\"":{\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""               \""type\"":\""generic\""\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""         ]\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""         \""kind\"":\""DeploymentConfig\"",\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""         \""template\"":{\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""            \""controllerTemplate\"":{\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""               \""podTemplate\"":{\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""                  \""desiredState\"":{\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""                     \""manifest\"":{\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""                        \""containers\"":[\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""                           {\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""                              \""ports\"":[\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""                                 {\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""                                    \""containerPort\"":8778\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""                                 }\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""                              ]\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""                           }\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""                        ],\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""                     }\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""                  },\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""                  \""labels\"":{\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""                  }\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""               \""replicaSelector\"":{\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""               \""replicas\"":1\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""               \""type\"":\""Recreate\""\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""               \""type\"":\""ImageChange\"",\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""               \""imageChangeParams\"":{\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""                  \""automatic\"":true,\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""                  \""containerNames\"":[\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""                  ],\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""                  \""from\"":{\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""               }\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""      }"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
"""   ]\n"" +",b077563265697866b9ea39306d56e5f302739d07,2,1
if (createOpenShiftBuildResources) {,b077563265697866b9ea39306d56e5f302739d07,2,1
"String type = ""generic"";",b077563265697866b9ea39306d56e5f302739d07,2,1
String webhookUrl = null;,b077563265697866b9ea39306d56e5f302739d07,2,1
String kubeAddress = null;,b077563265697866b9ea39306d56e5f302739d07,2,1
if (kubeAddress == null) {,b077563265697866b9ea39306d56e5f302739d07,2,1
} catch (Exception e) {,b077563265697866b9ea39306d56e5f302739d07,2,1
"LOG.warn(""failed to find cdelivery service URL: "" + e, e);",b077563265697866b9ea39306d56e5f302739d07,2,1
"String namespacePath = """";",b077563265697866b9ea39306d56e5f302739d07,2,1
if (appendNamespaceQuery && !Strings.isNullOrEmpty(namespace)) {,b077563265697866b9ea39306d56e5f302739d07,2,1
"namespacePath = ""/namespace="" + namespace;",b077563265697866b9ea39306d56e5f302739d07,2,1
if (webhookUrl == null) {,b077563265697866b9ea39306d56e5f302739d07,2,1
"webhookUrl = URLUtils.pathJoin(kubeAddress, ""oapi"", KubernetesHelper.defaultOsApiVersion + namespacePath, ""buildConfigHooks"", buildName, secret, type);",b077563265697866b9ea39306d56e5f302739d07,2,1
"LOG.info(""creating a web hook at: "" + webhookUrl);",b077563265697866b9ea39306d56e5f302739d07,2,1
if (LOG.isDebugEnabled()) {,b077563265697866b9ea39306d56e5f302739d07,2,1
"LOG.debug(""Got web hook: "" + toJson(webhook));",b077563265697866b9ea39306d56e5f302739d07,2,1
"/*        Map<String,String> labels = new LinkedHashMap<>();",b077563265697866b9ea39306d56e5f302739d07,2,1
BuildSource source = new BuildSource();,b077563265697866b9ea39306d56e5f302739d07,2,1
GitBuildSource git = new GitBuildSource();,b077563265697866b9ea39306d56e5f302739d07,2,1
// TODO this isn't really required if there's a secret associated with the BuildConfig source,b077563265697866b9ea39306d56e5f302739d07,2,1
if (Strings.isNullOrEmpty(userDetails.getUser()) || Strings.isNullOrEmpty(userDetails.getUser())) {,b077563265697866b9ea39306d56e5f302739d07,2,1
"if (Objects.equals(name, PROJECT_NEW_COMMAND)) {",b077563265697866b9ea39306d56e5f302739d07,2,1
if (inputList != null) {,b077563265697866b9ea39306d56e5f302739d07,2,1
if (page1 != null) {,b077563265697866b9ea39306d56e5f302739d07,2,1
if (page1.containsKey(TARGET_LOCATION_PROPERTY)) {,b077563265697866b9ea39306d56e5f302739d07,2,1
String address = userDetails.getAddress();,b077563265697866b9ea39306d56e5f302739d07,2,1
String internalAddress = userDetails.getInternalAddress();,b077563265697866b9ea39306d56e5f302739d07,2,1
String branch = userDetails.getBranch();,b077563265697866b9ea39306d56e5f302739d07,2,1
String origin = projectFileSystem.getRemote();,b077563265697866b9ea39306d56e5f302739d07,2,1
if (name.equals(PROJECT_NEW_COMMAND)) {,b077563265697866b9ea39306d56e5f302739d07,2,1
String targetLocation = null;,b077563265697866b9ea39306d56e5f302739d07,2,1
String named = null;,b077563265697866b9ea39306d56e5f302739d07,2,1
if (Strings.isNullOrEmpty(targetLocation)) {,b077563265697866b9ea39306d56e5f302739d07,2,1
if (Strings.isNullOrEmpty(named)) {,b077563265697866b9ea39306d56e5f302739d07,2,1
"File basedir = new File(targetLocation, named);",b077563265697866b9ea39306d56e5f302739d07,2,1
if (!basedir.isDirectory() || !basedir.exists()) {,b077563265697866b9ea39306d56e5f302739d07,2,1
"LOG.warn(""Generated project folder does not exist: "" + basedir.getAbsolutePath());",b077563265697866b9ea39306d56e5f302739d07,2,1
String fullName = null;,b077563265697866b9ea39306d56e5f302739d07,2,1
if (repository != null) {,b077563265697866b9ea39306d56e5f302739d07,2,1
if (LOG.isDebugEnabled()) {,b077563265697866b9ea39306d56e5f302739d07,2,1
"LOG.debug(""Got repository: "" + toJson(repository));",b077563265697866b9ea39306d56e5f302739d07,2,1
if (Strings.isNullOrEmpty(fullName)) {,b077563265697866b9ea39306d56e5f302739d07,2,1
"String message = ExecutionRequest.createCommitMessage(name, executionRequest);",b077563265697866b9ea39306d56e5f302739d07,2,1
"String projectName = firstNotBlank(named, context.getProjectName(), executionRequest.getProjectName());",b077563265697866b9ea39306d56e5f302739d07,2,1
} catch (Exception e) {,b077563265697866b9ea39306d56e5f302739d07,2,1
if (!Strings.isNullOrEmpty(text)) {,b077563265697866b9ea39306d56e5f302739d07,2,1
String jenkinsUrl = getJenkinsServiceUrl(namespace);,b077563265697866b9ea39306d56e5f302739d07,2,1
"controller.applyBuildConfig(buildConfig, ""from project "" + projectName);",b077563265697866b9ea39306d56e5f302739d07,2,1
* Git tends to ignore empty directories so lets add a dummy file to empty folders to keep them in git,b077563265697866b9ea39306d56e5f302739d07,2,1
if (dir != null && dir.isDirectory()) {,b077563265697866b9ea39306d56e5f302739d07,2,1
if (children == null || children.length == 0) {,b077563265697866b9ea39306d56e5f302739d07,2,1
} catch (IOException e) {,b077563265697866b9ea39306d56e5f302739d07,2,1
if (child.isDirectory()) {,b077563265697866b9ea39306d56e5f302739d07,2,1
"LOG.warn(""Caught: "" + e, e);",b077563265697866b9ea39306d56e5f302739d07,2,1
List list = (List) dto;,b077563265697866b9ea39306d56e5f302739d07,1,0
for (Object element : list) {,b077563265697866b9ea39306d56e5f302739d07,1,0
"apply(element, sourceName);",b077563265697866b9ea39306d56e5f302739d07,1,0
},b077563265697866b9ea39306d56e5f302739d07,1,0
try {,b077563265697866b9ea39306d56e5f302739d07,1,0
"kubernetes.createRoute(entity, namespace);",b077563265697866b9ea39306d56e5f302739d07,1,0
* from the Kubernetes REST API,b077563265697866b9ea39306d56e5f302739d07,1,0
return objectMapper.reader(Object.class).readValue(json);,b077563265697866b9ea39306d56e5f302739d07,1,0
KubernetesList config = (KubernetesList) entity;,b077563265697866b9ea39306d56e5f302739d07,1,0
return config.getItems();,b077563265697866b9ea39306d56e5f302739d07,1,0
KubernetesList list = findOrCreateList(objects);,b077563265697866b9ea39306d56e5f302739d07,1,0
List<Object> items = list.getItems();,b077563265697866b9ea39306d56e5f302739d07,1,0
items = new ArrayList<>();,b077563265697866b9ea39306d56e5f302739d07,1,0
"return Templates.combineTemplates(list, items);",b077563265697866b9ea39306d56e5f302739d07,1,0
protected static void moveServicesToFrontOfArray(List<Object> list) {,b077563265697866b9ea39306d56e5f302739d07,1,0
int size = list.size();,b077563265697866b9ea39306d56e5f302739d07,1,0
Object item = list.get(i);,b077563265697866b9ea39306d56e5f302739d07,1,0
Object nonService = list.get(lastNonService);,b077563265697866b9ea39306d56e5f302739d07,1,0
protected static void removeDuplicates(List<Object> itemArray) {,b077563265697866b9ea39306d56e5f302739d07,1,0
Object item = itemArray.get(i);,b077563265697866b9ea39306d56e5f302739d07,1,0
},b077563265697866b9ea39306d56e5f302739d07,1,0
"protected static void addObjectsToItemArray(List destinationList, Object object) throws IOException {",b077563265697866b9ea39306d56e5f302739d07,1,0
KubernetesList kubernetesList = (KubernetesList) object;,b077563265697866b9ea39306d56e5f302739d07,1,0
List<Object> items = kubernetesList.getItems();,b077563265697866b9ea39306d56e5f302739d07,1,0
Collection collection = (Collection) object;,b077563265697866b9ea39306d56e5f302739d07,1,0
protected static KubernetesList findOrCreateList(Object[] objects) {,b077563265697866b9ea39306d56e5f302739d07,1,0
KubernetesList list = null;,b077563265697866b9ea39306d56e5f302739d07,1,0
list = (KubernetesList) object;,b077563265697866b9ea39306d56e5f302739d07,1,0
list = new KubernetesList();,b077563265697866b9ea39306d56e5f302739d07,1,0
return list;,b077563265697866b9ea39306d56e5f302739d07,1,0
TODO Config,b077563265697866b9ea39306d56e5f302739d07,1,1
return Strings.firstNonBlank(,b077563265697866b9ea39306d56e5f302739d07,1,1
return null;,b077563265697866b9ea39306d56e5f302739d07,1,1
},b077563265697866b9ea39306d56e5f302739d07,1,1
"return getJsonTextProperty(entity, ""kind"");",b077563265697866b9ea39306d56e5f302739d07,1,1
JsonNode current = node;,b077563265697866b9ea39306d56e5f302739d07,1,1
current = current.get(name);,b077563265697866b9ea39306d56e5f302739d07,1,1
return current != null ? current.textValue() : null;,b077563265697866b9ea39306d56e5f302739d07,1,1
* from the Kubernetes REST API or,b077563265697866b9ea39306d56e5f302739d07,1,1
* {@link JsonNode} if it cannot be recognised.,b077563265697866b9ea39306d56e5f302739d07,1,1
JsonNode tree = reader.readTree(new ByteArrayInputStream(json));,b077563265697866b9ea39306d56e5f302739d07,1,1
"JsonNode kindNode = tree.get(""kind"");",b077563265697866b9ea39306d56e5f302739d07,1,1
"return loadEntity(json, kind, tree);",b077563265697866b9ea39306d56e5f302739d07,1,1
return tree;,b077563265697866b9ea39306d56e5f302739d07,1,1
JsonNode jsonNode = (JsonNode) entity;,b077563265697866b9ea39306d56e5f302739d07,1,1
return toItemList(getEntity(jsonNode));,b077563265697866b9ea39306d56e5f302739d07,1,1
return objectMapper.reader(Pod.class).readValue(json);,b077563265697866b9ea39306d56e5f302739d07,1,1
return objectMapper.reader(ReplicationController.class).readValue(json);,b077563265697866b9ea39306d56e5f302739d07,1,1
return objectMapper.reader(Service.class).readValue(json);,b077563265697866b9ea39306d56e5f302739d07,1,1
return objectMapper.reader(BuildConfig.class).readValue(json);,b077563265697866b9ea39306d56e5f302739d07,1,1
return objectMapper.reader(DeploymentConfig.class).readValue(json);,b077563265697866b9ea39306d56e5f302739d07,1,1
return objectMapper.reader(ImageRepository.class).readValue(json);,b077563265697866b9ea39306d56e5f302739d07,1,1
return objectMapper.reader(Template.class).readValue(json);,b077563265697866b9ea39306d56e5f302739d07,1,1
return loadList(json);,b077563265697866b9ea39306d56e5f302739d07,1,1
return defaultValue;,b077563265697866b9ea39306d56e5f302739d07,1,1
List<Object> itemList = new ArrayList<>();,b077563265697866b9ea39306d56e5f302739d07,1,1
JsonNode jsonNode = objectMapper.readTree(data);,b077563265697866b9ea39306d56e5f302739d07,1,1
"JsonNode items = jsonNode.get(""items"");",b077563265697866b9ea39306d56e5f302739d07,1,1
for (JsonNode item : items) {,b077563265697866b9ea39306d56e5f302739d07,1,1
"JsonNode kindObject = item.get(""kind"");",b077563265697866b9ea39306d56e5f302739d07,1,1
byte[] bytes = json.getBytes();,b077563265697866b9ea39306d56e5f302739d07,1,1
return config;,b077563265697866b9ea39306d56e5f302739d07,1,1
* Loads the entity for the given item,b077563265697866b9ea39306d56e5f302739d07,1,1
return entity;,b077563265697866b9ea39306d56e5f302739d07,1,1
JsonNode config = findOrCreateConfig(objects);,b077563265697866b9ea39306d56e5f302739d07,1,1
"JsonNode items = config.get(""items"");",b077563265697866b9ea39306d56e5f302739d07,1,1
itemArray = (ArrayNode) items;,b077563265697866b9ea39306d56e5f302739d07,1,1
itemArray = new ArrayNode(createNodeFactory());,b077563265697866b9ea39306d56e5f302739d07,1,1
ObjectNode objectNode = (ObjectNode) config;,b077563265697866b9ea39306d56e5f302739d07,1,1
"return combineTemplates(config, itemArray);",b077563265697866b9ea39306d56e5f302739d07,1,1
"protected static JsonNode combineTemplates(JsonNode config, ArrayNode itemArray) {",b077563265697866b9ea39306d56e5f302739d07,1,1
JsonNode template = null;,b077563265697866b9ea39306d56e5f302739d07,1,1
for (JsonNode jsonNode : config) {,b077563265697866b9ea39306d56e5f302739d07,1,1
template = jsonNode;,b077563265697866b9ea39306d56e5f302739d07,1,1
"JsonNode items = config.get(""objects"");",b077563265697866b9ea39306d56e5f302739d07,1,1
objects = (ArrayNode) items;,b077563265697866b9ea39306d56e5f302739d07,1,1
objects = new ArrayNode(createNodeFactory());,b077563265697866b9ea39306d56e5f302739d07,1,1
ObjectNode objectNode = (ObjectNode) template;,b077563265697866b9ea39306d56e5f302739d07,1,1
return template;,b077563265697866b9ea39306d56e5f302739d07,1,1
protected static void moveServicesToFrontOfArray(ArrayNode itemArray) {,b077563265697866b9ea39306d56e5f302739d07,1,1
int size = itemArray.size();,b077563265697866b9ea39306d56e5f302739d07,1,1
JsonNode jsonNode = itemArray.get(i);,b077563265697866b9ea39306d56e5f302739d07,1,1
JsonNode nonService = itemArray.get(lastNonService);,b077563265697866b9ea39306d56e5f302739d07,1,1
protected static void removeDuplicates(ArrayNode itemArray) {,b077563265697866b9ea39306d56e5f302739d07,1,1
protected static boolean isService(JsonNode jsonNode) {,b077563265697866b9ea39306d56e5f302739d07,1,1
return false;,b077563265697866b9ea39306d56e5f302739d07,1,1
protected static boolean isTemplate(JsonNode jsonNode) {,b077563265697866b9ea39306d56e5f302739d07,1,1
"protected static void addObjectsToItemArray(ArrayNode itemArray, Object object) throws IOException {",b077563265697866b9ea39306d56e5f302739d07,1,1
JsonNode node = toJsonNode(object);,b077563265697866b9ea39306d56e5f302739d07,1,1
"JsonNode items = node.get(""items"");",b077563265697866b9ea39306d56e5f302739d07,1,1
Iterator<JsonNode> iter = items.iterator();,b077563265697866b9ea39306d56e5f302739d07,1,1
protected static JsonNodeFactory createNodeFactory() {,b077563265697866b9ea39306d56e5f302739d07,1,1
return new JsonNodeFactory(false);,b077563265697866b9ea39306d56e5f302739d07,1,1
protected static JsonNode findOrCreateConfig(Object[] objects) {,b077563265697866b9ea39306d56e5f302739d07,1,1
JsonNode jsonNode = (JsonNode) object;,b077563265697866b9ea39306d56e5f302739d07,1,1
return jsonNode;,b077563265697866b9ea39306d56e5f302739d07,1,1
// lets create a new list,b077563265697866b9ea39306d56e5f302739d07,1,1
JsonNodeFactory factory = createNodeFactory();,b077563265697866b9ea39306d56e5f302739d07,1,1
ObjectNode config = factory.objectNode();,b077563265697866b9ea39306d56e5f302739d07,1,1
return (JsonNode) object;,b077563265697866b9ea39306d56e5f302739d07,1,1
return objectMapper.reader().readTree(json);,b077563265697866b9ea39306d56e5f302739d07,1,1
this.createOpenShiftBuildResources = createOpenShiftBuildResources;,b077563265697866b9ea39306d56e5f302739d07,1,0
Controller controller = new Controller(kubernetes);,b077563265697866b9ea39306d56e5f302739d07,1,0
// so we need to use a workaround using the fabric8 console service's proxy which hides the payload for us,b077563265697866b9ea39306d56e5f302739d07,1,0
boolean appendNamespaceQuery = true;,b077563265697866b9ea39306d56e5f302739d07,1,0
try {,b077563265697866b9ea39306d56e5f302739d07,1,0
"kubeAddress = kubernetes.getServiceURL(""cdelivery"", namespace, ""http"", false);",b077563265697866b9ea39306d56e5f302739d07,1,0
"webhookUrl = URLUtils.pathJoin(kubeAddress, ""buildConfigHooks"", namespace, buildName);",b077563265697866b9ea39306d56e5f302739d07,1,0
appendNamespaceQuery = false;,b077563265697866b9ea39306d56e5f302739d07,1,0
},b077563265697866b9ea39306d56e5f302739d07,1,0
"webhookUrl = URLUtils.pathJoin(kubeAddress, ""osapi"", KubernetesHelper.defaultOsApiVersion, ""buildConfigHooks"", buildName, secret, type);",b077563265697866b9ea39306d56e5f302739d07,1,0
kubeAddress = kubernetes.getAddress();,b077563265697866b9ea39306d56e5f302739d07,1,0
CreateWebhookDTO createWebhook = new CreateWebhookDTO();,b077563265697866b9ea39306d56e5f302739d07,1,0
WebhookConfig config = createWebhook.getConfig();,b077563265697866b9ea39306d56e5f302739d07,1,0
"WebHookDTO webhook = repoClient.createWebhook(user, buildName, createWebhook);",b077563265697866b9ea39306d56e5f302739d07,1,0
ProjectFileSystem projectFileSystem) {,b077563265697866b9ea39306d56e5f302739d07,1,1
Controller controller = new Controller(kubernetes);,b077563265697866b9ea39306d56e5f302739d07,1,1
// so we need to use a workaround using the fabric8 console service's proxy which hides the payload for us,b077563265697866b9ea39306d56e5f302739d07,1,1
boolean appendNamespaceQuery = true;,b077563265697866b9ea39306d56e5f302739d07,1,1
try {,b077563265697866b9ea39306d56e5f302739d07,1,1
"kubeAddress = kubernetes.getServiceURL(""cdelivery"", namespace, ""http"", false);",b077563265697866b9ea39306d56e5f302739d07,1,1
"webhookUrl = URLUtils.pathJoin(kubeAddress, ""buildConfigHooks"", namespace, buildName);",b077563265697866b9ea39306d56e5f302739d07,1,1
appendNamespaceQuery = false;,b077563265697866b9ea39306d56e5f302739d07,1,1
},b077563265697866b9ea39306d56e5f302739d07,1,1
"webhookUrl = URLUtils.pathJoin(kubeAddress, ""kubernetes"", ""osapi"", KubernetesHelper.defaultOsApiVersion, ""buildConfigHooks"", buildName, secret, type);",b077563265697866b9ea39306d56e5f302739d07,1,1
kubeAddress = kubernetes.getAddress();,b077563265697866b9ea39306d56e5f302739d07,1,1
"webhookUrl = URLUtils.pathJoin(kubeAddress, ""osapi"", KubernetesHelper.defaultOsApiVersion, ""buildConfigHooks"", buildName, secret, type);",b077563265697866b9ea39306d56e5f302739d07,1,1
"webhookUrl += ""?namespace="" + namespace;",b077563265697866b9ea39306d56e5f302739d07,1,1
CreateWebhookDTO createWebhook = new CreateWebhookDTO();,b077563265697866b9ea39306d56e5f302739d07,1,1
WebhookConfig config = createWebhook.getConfig();,b077563265697866b9ea39306d56e5f302739d07,1,1
"WebHookDTO webhook = repoClient.createWebhook(user, buildName, createWebhook);",b077563265697866b9ea39306d56e5f302739d07,1,1
private final String jenkinsSeedJob;,b077563265697866b9ea39306d56e5f302739d07,1,0
this.jenkinsSeedJob = jenkinsSeedJob;,b077563265697866b9ea39306d56e5f302739d07,1,0
* We've created a project so lets try trigger a jenkins seed build,b077563265697866b9ea39306d56e5f302739d07,1,0
protected void triggerJenkinsSeedBuild() {,b077563265697866b9ea39306d56e5f302739d07,1,0
HttpURLConnection connection = null;,b077563265697866b9ea39306d56e5f302739d07,1,0
try {,b077563265697866b9ea39306d56e5f302739d07,1,0
URL url = new URL(jobUrl);,b077563265697866b9ea39306d56e5f302739d07,1,0
connection = (HttpURLConnection) url.openConnection();,b077563265697866b9ea39306d56e5f302739d07,1,0
OutputStreamWriter out = new OutputStreamWriter(,b077563265697866b9ea39306d56e5f302739d07,1,0
},b077563265697866b9ea39306d56e5f302739d07,1,0
int status = connection.getResponseCode();,b077563265697866b9ea39306d56e5f302739d07,1,0
},b077563265697866b9ea39306d56e5f302739d07,1,0
"kubeAddress = kubernetes.getServiceURL(ServiceNames.CDELIVERY_API, namespace, ""http"", false);",b077563265697866b9ea39306d56e5f302739d07,1,0
"kubeAddress = kubernetes.getServiceURL(""cdelivery"", namespace, ""http"", false);",b077563265697866b9ea39306d56e5f302739d07,1,1
"protected void configureProperties(ProjectConfig config, Map<String, String> map) {",b077563265697866b9ea39306d56e5f302739d07,1,1
Class<? extends ProjectConfig> clazz = config.getClass();,b077563265697866b9ea39306d56e5f302739d07,1,1
BeanInfo beanInfo = null;,b077563265697866b9ea39306d56e5f302739d07,1,1
try {,b077563265697866b9ea39306d56e5f302739d07,1,1
beanInfo = Introspector.getBeanInfo(clazz);,b077563265697866b9ea39306d56e5f302739d07,1,1
},b077563265697866b9ea39306d56e5f302739d07,1,1
PropertyDescriptor[] propertyDescriptors = beanInfo.getPropertyDescriptors();,b077563265697866b9ea39306d56e5f302739d07,1,1
for (PropertyDescriptor descriptor : propertyDescriptors) {,b077563265697866b9ea39306d56e5f302739d07,1,1
Method writeMethod = descriptor.getWriteMethod();,b077563265697866b9ea39306d56e5f302739d07,1,1
"* Lets create an ImageRegistry, BuildConfig and DeploymentConfig for the new project",b077563265697866b9ea39306d56e5f302739d07,1,1
gitAddress = address;,b077563265697866b9ea39306d56e5f302739d07,1,1
},b077563265697866b9ea39306d56e5f302739d07,1,1
"""{\n"" +",b077563265697866b9ea39306d56e5f302739d07,1,1
Controller controller = new Controller(kubernetes);,b077563265697866b9ea39306d56e5f302739d07,1,1
// so we need to use a workaround using the fabric8 console service's proxy which hides the payload for us,b077563265697866b9ea39306d56e5f302739d07,1,1
boolean appendNamespaceQuery = true;,b077563265697866b9ea39306d56e5f302739d07,1,1
try {,b077563265697866b9ea39306d56e5f302739d07,1,1
"kubeAddress = KubernetesHelper.getServiceURL(kubernetes,ServiceNames.CDELIVERY_API, namespace, ""http"", false);",b077563265697866b9ea39306d56e5f302739d07,1,1
"webhookUrl = URLUtils.pathJoin(kubeAddress, ""buildConfigHooks"", namespace, buildName);",b077563265697866b9ea39306d56e5f302739d07,1,1
appendNamespaceQuery = false;,b077563265697866b9ea39306d56e5f302739d07,1,1
"kubeAddress = kubernetes.getServiceURL(""fabric8"", namespace, ""http"", false);",b077563265697866b9ea39306d56e5f302739d07,1,1
"webhookUrl = URLUtils.pathJoin(kubeAddress, ""oapi"", KubernetesHelper.defaultOsApiVersion, ""buildConfigHooks"", buildName, secret, type);",b077563265697866b9ea39306d56e5f302739d07,1,1
kubeAddress = kubernetes.getMasterUrl().toString();,b077563265697866b9ea39306d56e5f302739d07,1,1
CreateWebhookDTO createWebhook = new CreateWebhookDTO();,b077563265697866b9ea39306d56e5f302739d07,1,1
WebhookConfig config = createWebhook.getConfig();,b077563265697866b9ea39306d56e5f302739d07,1,1
"WebHookDTO webhook = repoClient.createWebhook(user, buildName, createWebhook);",b077563265697866b9ea39306d56e5f302739d07,1,1
"Map<String,String> to = new LinkedHashMap<>();",b077563265697866b9ea39306d56e5f302739d07,1,1
ImageStream imageRepository = new ImageStream();,b077563265697866b9ea39306d56e5f302739d07,1,1
BuildConfig buildConfig = new BuildConfig();,b077563265697866b9ea39306d56e5f302739d07,1,1
BuildOutput output = new BuildOutput();,b077563265697866b9ea39306d56e5f302739d07,1,1
BuildStrategy strategy = new BuildStrategy();,b077563265697866b9ea39306d56e5f302739d07,1,1
STIBuildStrategy stiStrategy = new STIBuildStrategy();,b077563265697866b9ea39306d56e5f302739d07,1,1
BuildParameters parameters = new BuildParameters();,b077563265697866b9ea39306d56e5f302739d07,1,1
BuildTriggerPolicy github = new BuildTriggerPolicy();,b077563265697866b9ea39306d56e5f302739d07,1,1
WebHookTrigger githubTrigger = new WebHookTrigger();,b077563265697866b9ea39306d56e5f302739d07,1,1
BuildTriggerPolicy generic = new BuildTriggerPolicy();,b077563265697866b9ea39306d56e5f302739d07,1,1
WebHookTrigger genericTrigger = new WebHookTrigger();,b077563265697866b9ea39306d56e5f302739d07,1,1
List<BuildTriggerPolicy> triggers = new ArrayList<>();,b077563265697866b9ea39306d56e5f302739d07,1,1
private static final transient Logger LOG = LoggerFactory.getLogger(GitCommandCompletePostProcessor.class);,b077563265697866b9ea39306d56e5f302739d07,1,1
private final String jenkinsSeedJob;,b077563265697866b9ea39306d56e5f302739d07,1,1
"public GitCommandCompletePostProcessor(KubernetesClient kubernetes,",b077563265697866b9ea39306d56e5f302739d07,1,1
this.kubernetes = kubernetes;,b077563265697866b9ea39306d56e5f302739d07,1,1
this.gitUserHelper = gitUserHelper;,b077563265697866b9ea39306d56e5f302739d07,1,1
this.projectFileSystem = projectFileSystem;,b077563265697866b9ea39306d56e5f302739d07,1,1
this.jenkinsSeedJob = jenkinsSeedJob;,b077563265697866b9ea39306d56e5f302739d07,1,1
this.createOpenShiftBuildResources = createOpenShiftBuildResources;,b077563265697866b9ea39306d56e5f302739d07,1,1
},b077563265697866b9ea39306d56e5f302739d07,1,1
@Override,b077563265697866b9ea39306d56e5f302739d07,1,1
UserDetails userDetails = gitUserHelper.createUserDetails(request);,b077563265697866b9ea39306d56e5f302739d07,1,1
"List<Map<String, String>> inputList = executionRequest.getInputList();",b077563265697866b9ea39306d56e5f302739d07,1,1
"Map<String, String> page1 = inputList.get(0);",b077563265697866b9ea39306d56e5f302739d07,1,1
return userDetails;,b077563265697866b9ea39306d56e5f302739d07,1,1
try {,b077563265697866b9ea39306d56e5f302739d07,1,1
PersonIdent personIdent = userDetails.createPersonIdent();,b077563265697866b9ea39306d56e5f302739d07,1,1
"for (Map<String, String> map : inputList) {",b077563265697866b9ea39306d56e5f302739d07,1,1
"targetLocation = map.get(""targetLocation"");",b077563265697866b9ea39306d56e5f302739d07,1,1
"named = map.get(""named"");",b077563265697866b9ea39306d56e5f302739d07,1,1
InitCommand initCommand = Git.init();,b077563265697866b9ea39306d56e5f302739d07,1,1
"LOG.info(""Initialised an empty git configuration repo at {}"", basedir.getAbsolutePath());",b077563265697866b9ea39306d56e5f302739d07,1,1
// lets create the repository,b077563265697866b9ea39306d56e5f302739d07,1,1
GitRepoClient repoClient = userDetails.createRepoClient();,b077563265697866b9ea39306d56e5f302739d07,1,1
CreateRepositoryDTO createRepository = new CreateRepositoryDTO();,b077563265697866b9ea39306d56e5f302739d07,1,1
RepositoryDTO repository = repoClient.createRepository(createRepository);,b077563265697866b9ea39306d56e5f302739d07,1,1
fullName = repository.getFullName();,b077563265697866b9ea39306d56e5f302739d07,1,1
for (String text : texts) {,b077563265697866b9ea39306d56e5f302739d07,1,1
return text;,b077563265697866b9ea39306d56e5f302739d07,1,1
return null;,b077563265697866b9ea39306d56e5f302739d07,1,1
"BuildConfig buildConfig = Builds.createDefaultBuildConfig(projectName, cloneUrl, jenkinsUrl);",b077563265697866b9ea39306d56e5f302739d07,1,1
Controller controller = new Controller(kubernetes);,b077563265697866b9ea39306d56e5f302739d07,1,1
"return KubernetesHelper.getServiceURL(kubernetes, ServiceNames.JENKINS, namespace, ""http"", true);",b077563265697866b9ea39306d56e5f302739d07,1,1
protected void addDummyFileToEmptyFolders(File dir) {,b077563265697866b9ea39306d56e5f302739d07,1,1
File[] children = dir.listFiles();,b077563265697866b9ea39306d56e5f302739d07,1,1
"File dummyFile = new File(dir, "".gitkeep"");",b077563265697866b9ea39306d56e5f302739d07,1,1
"IOHelpers.writeFully(dummyFile, ""This file is only here to avoid git removing empty folders\nOnce there are files in this folder feel free to delete this file!"");",b077563265697866b9ea39306d56e5f302739d07,1,1
for (File child : children) {,b077563265697866b9ea39306d56e5f302739d07,1,1
protected void registerWebHooks(RestUIContext context) {,b077563265697866b9ea39306d56e5f302739d07,1,1
"Map<Object, Object> attributeMap = context.getAttributeMap();",b077563265697866b9ea39306d56e5f302739d07,1,1
"Object registerWebHooksValue = attributeMap.get(""registerWebHooks"");",b077563265697866b9ea39306d56e5f302739d07,1,1
Runnable runnable = (Runnable) registerWebHooksValue;,b077563265697866b9ea39306d56e5f302739d07,1,1
protected boolean isPushOnCommit() {,b077563265697866b9ea39306d56e5f302739d07,1,1
return true;,b077563265697866b9ea39306d56e5f302739d07,1,1
protected void handleException(Throwable e) {,b077563265697866b9ea39306d56e5f302739d07,1,1
import io.fabric8.openshift.api.model.Route;,b077563265697866b9ea39306d56e5f302739d07,0,0
import javax.ws.rs.WebApplicationException;,b077563265697866b9ea39306d56e5f302739d07,0,0
import io.fabric8.kubernetes.api.extensions.Templates;,b077563265697866b9ea39306d56e5f302739d07,0,0
import java.util.Collection;,b077563265697866b9ea39306d56e5f302739d07,0,0
list.setItems(items);,b077563265697866b9ea39306d56e5f302739d07,0,0
"addObjectsToItemArray(items, object);",b077563265697866b9ea39306d56e5f302739d07,0,0
moveServicesToFrontOfArray(items);,b077563265697866b9ea39306d56e5f302739d07,0,0
removeDuplicates(items);,b077563265697866b9ea39306d56e5f302739d07,0,0
"list.set(i, nonService);",b077563265697866b9ea39306d56e5f302739d07,0,0
"list.set(lastNonService, item);",b077563265697866b9ea39306d56e5f302739d07,0,0
* @param itemArray,b077563265697866b9ea39306d56e5f302739d07,0,0
itemArray.remove(i);,b077563265697866b9ea39306d56e5f302739d07,0,0
i--;,b077563265697866b9ea39306d56e5f302739d07,0,0
size--;,b077563265697866b9ea39306d56e5f302739d07,0,0
// lets remove this one,b077563265697866b9ea39306d56e5f302739d07,0,0
destinationList.addAll(items);,b077563265697866b9ea39306d56e5f302739d07,0,0
destinationList.addAll(collection);,b077563265697866b9ea39306d56e5f302739d07,0,0
destinationList.add(object);,b077563265697866b9ea39306d56e5f302739d07,0,0
break;,b077563265697866b9ea39306d56e5f302739d07,0,0
import com.fasterxml.jackson.databind.JsonNode;,b077563265697866b9ea39306d56e5f302739d07,0,1
import com.fasterxml.jackson.databind.ObjectReader;,b077563265697866b9ea39306d56e5f302739d07,0,1
import com.fasterxml.jackson.databind.node.ArrayNode;,b077563265697866b9ea39306d56e5f302739d07,0,1
import com.fasterxml.jackson.databind.node.JsonNodeFactory;,b077563265697866b9ea39306d56e5f302739d07,0,1
import com.fasterxml.jackson.databind.node.ObjectNode;,b077563265697866b9ea39306d56e5f302739d07,0,1
import io.fabric8.openshift.api.model.BuildConfig;,b077563265697866b9ea39306d56e5f302739d07,0,1
import io.fabric8.openshift.api.model.DeploymentConfig;,b077563265697866b9ea39306d56e5f302739d07,0,1
import io.fabric8.openshift.api.model.ImageRepository;,b077563265697866b9ea39306d56e5f302739d07,0,1
import java.io.ByteArrayInputStream;,b077563265697866b9ea39306d56e5f302739d07,0,1
import java.util.Iterator;,b077563265697866b9ea39306d56e5f302739d07,0,1
/*,b077563265697866b9ea39306d56e5f302739d07,0,1
import io.fabric8.kubernetes.api.model.Item;,b077563265697866b9ea39306d56e5f302739d07,0,1
import io.fabric8.kubernetes.api.model.Template;,b077563265697866b9ea39306d56e5f302739d07,0,1
*/,b077563265697866b9ea39306d56e5f302739d07,0,1
"getJsonTextProperty(entity, ""metadata"", ""name""),",b077563265697866b9ea39306d56e5f302739d07,0,1
"getJsonTextProperty(entity, ""metadata"", ""id""),",b077563265697866b9ea39306d56e5f302739d07,0,1
"getJsonTextProperty(entity, ""name""),",b077563265697866b9ea39306d56e5f302739d07,0,1
"getJsonTextProperty(entity, ""id""));",b077563265697866b9ea39306d56e5f302739d07,0,1
config.setItems(itemList);,b077563265697866b9ea39306d56e5f302739d07,0,1
itemList.add(entity);,b077563265697866b9ea39306d56e5f302739d07,0,1
/**,b077563265697866b9ea39306d56e5f302739d07,0,1
ArrayNode itemArray;,b077563265697866b9ea39306d56e5f302739d07,0,1
"objectNode.set(""items"", itemArray);",b077563265697866b9ea39306d56e5f302739d07,0,1
"addObjectsToItemArray(itemArray, object);",b077563265697866b9ea39306d56e5f302739d07,0,1
moveServicesToFrontOfArray(itemArray);,b077563265697866b9ea39306d56e5f302739d07,0,1
removeDuplicates(itemArray);,b077563265697866b9ea39306d56e5f302739d07,0,1
* If we have any templates inside the itemArray then lets unpack them and combine any parameters,b077563265697866b9ea39306d56e5f302739d07,0,1
// TODO combine templates...,b077563265697866b9ea39306d56e5f302739d07,0,1
// lets move all the content into the template,b077563265697866b9ea39306d56e5f302739d07,0,1
ArrayNode objects;,b077563265697866b9ea39306d56e5f302739d07,0,1
"objectNode.set(""objects"", itemArray);",b077563265697866b9ea39306d56e5f302739d07,0,1
objects.add(jsonNode);,b077563265697866b9ea39306d56e5f302739d07,0,1
"itemArray.set(i, nonService);",b077563265697866b9ea39306d56e5f302739d07,0,1
"itemArray.set(lastNonService, jsonNode);",b077563265697866b9ea39306d56e5f302739d07,0,1
// lets remove this one,b077563265697866b9ea39306d56e5f302739d07,0,1
itemArray.remove(i);,b077563265697866b9ea39306d56e5f302739d07,0,1
i--;,b077563265697866b9ea39306d56e5f302739d07,0,1
size--;,b077563265697866b9ea39306d56e5f302739d07,0,1
itemArray.add(item);,b077563265697866b9ea39306d56e5f302739d07,0,1
itemArray.add(node);,b077563265697866b9ea39306d56e5f302739d07,0,1
"config.set(""apiVersion"", factory.textNode(defaultApiVersion));",b077563265697866b9ea39306d56e5f302739d07,0,1
"config.set(""kind"", factory.textNode(""List""));",b077563265697866b9ea39306d56e5f302739d07,0,1
"config.set(""items"", factory.arrayNode());",b077563265697866b9ea39306d56e5f302739d07,0,1
* Converts the DTO to a JsonNode,b077563265697866b9ea39306d56e5f302739d07,0,1
import org.apache.deltaspike.core.api.config.ConfigProperty;,b077563265697866b9ea39306d56e5f302739d07,0,0
private final boolean createOpenShiftBuildResources;,b077563265697866b9ea39306d56e5f302739d07,0,0
"ProjectFileSystem projectFileSystem,",b077563265697866b9ea39306d56e5f302739d07,0,0
controller.applyJson(json);,b077563265697866b9ea39306d56e5f302739d07,0,0
// TODO due to https://github.com/openshift/origin/issues/1317 we can't use the direct kube REST API,b077563265697866b9ea39306d56e5f302739d07,0,0
// lets try the cdelivery first,b077563265697866b9ea39306d56e5f302739d07,0,0
/*,b077563265697866b9ea39306d56e5f302739d07,0,0
*/,b077563265697866b9ea39306d56e5f302739d07,0,0
"createWebhook.setType(""gogs"");",b077563265697866b9ea39306d56e5f302739d07,0,0
config.setUrl(webhookUrl);,b077563265697866b9ea39306d56e5f302739d07,0,0
config.setSecret(secret);,b077563265697866b9ea39306d56e5f302739d07,0,0
controller.applyJson(json);,b077563265697866b9ea39306d56e5f302739d07,0,1
// TODO due to https://github.com/openshift/origin/issues/1317 we can't use the direct kube REST API,b077563265697866b9ea39306d56e5f302739d07,0,1
// lets try the cdelivery first,b077563265697866b9ea39306d56e5f302739d07,0,1
"createWebhook.setType(""gogs"");",b077563265697866b9ea39306d56e5f302739d07,0,1
config.setUrl(webhookUrl);,b077563265697866b9ea39306d56e5f302739d07,0,1
config.setSecret(secret);,b077563265697866b9ea39306d56e5f302739d07,0,1
import java.io.OutputStreamWriter;,b077563265697866b9ea39306d56e5f302739d07,0,0
import java.net.HttpURLConnection;,b077563265697866b9ea39306d56e5f302739d07,0,0
import java.net.URL;,b077563265697866b9ea39306d56e5f302739d07,0,0
triggerJenkinsSeedBuild();,b077563265697866b9ea39306d56e5f302739d07,0,0
/**,b077563265697866b9ea39306d56e5f302739d07,0,0
*/,b077563265697866b9ea39306d56e5f302739d07,0,0
"connection.setRequestMethod(""POST"");",b077563265697866b9ea39306d56e5f302739d07,0,0
"connection.setRequestProperty(""Content-Type"", ""application/json"");",b077563265697866b9ea39306d56e5f302739d07,0,0
connection.setDoOutput(true);,b077563265697866b9ea39306d56e5f302739d07,0,0
connection.getOutputStream());,b077563265697866b9ea39306d56e5f302739d07,0,0
out.write(json);,b077563265697866b9ea39306d56e5f302739d07,0,0
out.close();,b077563265697866b9ea39306d56e5f302739d07,0,0
connection.disconnect();,b077563265697866b9ea39306d56e5f302739d07,0,0
import io.fabric8.kubernetes.api.ServiceNames;,b077563265697866b9ea39306d56e5f302739d07,0,0
import javax.ws.rs.WebApplicationException;,b077563265697866b9ea39306d56e5f302739d07,0,0
kubernetes.setNamespace(namespace);,b077563265697866b9ea39306d56e5f302739d07,0,0
"ProjectConfigs.configureProperties(config, map);",b077563265697866b9ea39306d56e5f302739d07,0,0
import java.beans.BeanInfo;,b077563265697866b9ea39306d56e5f302739d07,0,1
import java.beans.IntrospectionException;,b077563265697866b9ea39306d56e5f302739d07,0,1
import java.beans.Introspector;,b077563265697866b9ea39306d56e5f302739d07,0,1
import java.beans.PropertyDescriptor;,b077563265697866b9ea39306d56e5f302739d07,0,1
import java.lang.reflect.Method;,b077563265697866b9ea39306d56e5f302739d07,0,1
"configureProperties(config, map);",b077563265697866b9ea39306d56e5f302739d07,0,1
"writeMethod.invoke(config, value);",b077563265697866b9ea39306d56e5f302739d07,0,1
config.addFlow(flow);,b077563265697866b9ea39306d56e5f302739d07,0,1
"LOG.info(""Creating any pending webhooks"");",b077563265697866b9ea39306d56e5f302739d07,0,0
"LOG.info(""Done creating webhooks!"");",b077563265697866b9ea39306d56e5f302739d07,0,0
import io.fabric8.kubernetes.api.Controller;,b077563265697866b9ea39306d56e5f302739d07,0,1
import io.fabric8.repo.git.CreateWebhookDTO;,b077563265697866b9ea39306d56e5f302739d07,0,1
import io.fabric8.repo.git.WebHookDTO;,b077563265697866b9ea39306d56e5f302739d07,0,1
import io.fabric8.repo.git.WebhookConfig;,b077563265697866b9ea39306d56e5f302739d07,0,1
"createKubernetesResources(user, named, remoteUrl, branch, repoClient, address);",b077563265697866b9ea39306d56e5f302739d07,0,1
/**,b077563265697866b9ea39306d56e5f302739d07,0,1
*/,b077563265697866b9ea39306d56e5f302739d07,0,1
// TODO we should replace the remote with the actual service IP address???,b077563265697866b9ea39306d56e5f302739d07,0,1
"""}"";",b077563265697866b9ea39306d56e5f302739d07,0,1
controller.applyJson(json);,b077563265697866b9ea39306d56e5f302739d07,0,1
// TODO due to https://github.com/openshift/origin/issues/1317 we can't use the direct kube REST API,b077563265697866b9ea39306d56e5f302739d07,0,1
// lets try the cdelivery first,b077563265697866b9ea39306d56e5f302739d07,0,1
/*,b077563265697866b9ea39306d56e5f302739d07,0,1
"createWebhook.setType(""gogs"");",b077563265697866b9ea39306d56e5f302739d07,0,1
config.setUrl(webhookUrl);,b077563265697866b9ea39306d56e5f302739d07,0,1
config.setSecret(secret);,b077563265697866b9ea39306d56e5f302739d07,0,1
"labels.put(""name"", buildName);",b077563265697866b9ea39306d56e5f302739d07,0,1
"labels.put(""user"", user);",b077563265697866b9ea39306d56e5f302739d07,0,1
"to.put(""name"", buildName);",b077563265697866b9ea39306d56e5f302739d07,0,1
"imageRepository.setKind(""ImageStream"");",b077563265697866b9ea39306d56e5f302739d07,0,1
imageRepository.setApiVersion(osapiVersion);,b077563265697866b9ea39306d56e5f302739d07,0,1
imageRepository.setName(buildName);,b077563265697866b9ea39306d56e5f302739d07,0,1
imageRepository.setLabels(labels);,b077563265697866b9ea39306d56e5f302739d07,0,1
"handleKubernetesResourceCreation(imageRepository.getKind(), imageRepository, kubernetes.createImageStream(imageRepository));",b077563265697866b9ea39306d56e5f302739d07,0,1
"buildConfig.setKind(""BuildConfig"");",b077563265697866b9ea39306d56e5f302739d07,0,1
buildConfig.setApiVersion(osapiVersion);,b077563265697866b9ea39306d56e5f302739d07,0,1
buildConfig.setName(buildName);,b077563265697866b9ea39306d56e5f302739d07,0,1
buildConfig.setLabels(labels);,b077563265697866b9ea39306d56e5f302739d07,0,1
//output.setRegistry(buildName);,b077563265697866b9ea39306d56e5f302739d07,0,1
"output.getAdditionalProperties().put(""to"", to);",b077563265697866b9ea39306d56e5f302739d07,0,1
output.setImageTag(imageTag);,b077563265697866b9ea39306d56e5f302739d07,0,1
"source.setType(""Git"");",b077563265697866b9ea39306d56e5f302739d07,0,1
git.setUri(remote);,b077563265697866b9ea39306d56e5f302739d07,0,1
source.setGit(git);,b077563265697866b9ea39306d56e5f302739d07,0,1
"strategy.setType(""STI"");",b077563265697866b9ea39306d56e5f302739d07,0,1
stiStrategy.setImage(builderImage);,b077563265697866b9ea39306d56e5f302739d07,0,1
// TODO,b077563265697866b9ea39306d56e5f302739d07,0,1
//stiStrategy.setBuilderImage(builderImage);,b077563265697866b9ea39306d56e5f302739d07,0,1
"stiStrategy.getAdditionalProperties().put(""builderImage"", builderImage);",b077563265697866b9ea39306d56e5f302739d07,0,1
strategy.setStiStrategy(stiStrategy);,b077563265697866b9ea39306d56e5f302739d07,0,1
parameters.setOutput(output);,b077563265697866b9ea39306d56e5f302739d07,0,1
parameters.setSource(source);,b077563265697866b9ea39306d56e5f302739d07,0,1
parameters.setStrategy(strategy);,b077563265697866b9ea39306d56e5f302739d07,0,1
buildConfig.setParameters(parameters);,b077563265697866b9ea39306d56e5f302739d07,0,1
"github.setType(""github"");",b077563265697866b9ea39306d56e5f302739d07,0,1
githubTrigger.setSecret(secret);,b077563265697866b9ea39306d56e5f302739d07,0,1
github.setGithub(githubTrigger);,b077563265697866b9ea39306d56e5f302739d07,0,1
"generic.setType(""generic"");",b077563265697866b9ea39306d56e5f302739d07,0,1
genericTrigger.setSecret(secret);,b077563265697866b9ea39306d56e5f302739d07,0,1
generic.setGeneric(genericTrigger);,b077563265697866b9ea39306d56e5f302739d07,0,1
triggers.add(github);,b077563265697866b9ea39306d56e5f302739d07,0,1
triggers.add(generic);,b077563265697866b9ea39306d56e5f302739d07,0,1
buildConfig.setTriggers(triggers);,b077563265697866b9ea39306d56e5f302739d07,0,1
"handleKubernetesResourceCreation(buildConfig.getKind(), buildConfig, kubernetes.createBuildConfig(buildConfig));*/",b077563265697866b9ea39306d56e5f302739d07,0,1
/**,b077563265697866b9ea39306d56e5f302739d07,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",b077563265697866b9ea39306d56e5f302739d07,0,1
*,b077563265697866b9ea39306d56e5f302739d07,0,1
"*  Red Hat licenses this file to you under the Apache License, version",b077563265697866b9ea39306d56e5f302739d07,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",b077563265697866b9ea39306d56e5f302739d07,0,1
*  with the License.  You may obtain a copy of the License at,b077563265697866b9ea39306d56e5f302739d07,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,b077563265697866b9ea39306d56e5f302739d07,0,1
"*  Unless required by applicable law or agreed to in writing, software",b077563265697866b9ea39306d56e5f302739d07,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",b077563265697866b9ea39306d56e5f302739d07,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",b077563265697866b9ea39306d56e5f302739d07,0,1
*  implied.  See the License for the specific language governing,b077563265697866b9ea39306d56e5f302739d07,0,1
*  permissions and limitations under the License.,b077563265697866b9ea39306d56e5f302739d07,0,1
*/,b077563265697866b9ea39306d56e5f302739d07,0,1
package io.fabric8.forge.rest.main;,b077563265697866b9ea39306d56e5f302739d07,0,1
import io.fabric8.forge.rest.dto.ExecutionRequest;,b077563265697866b9ea39306d56e5f302739d07,0,1
import io.fabric8.forge.rest.dto.ExecutionResult;,b077563265697866b9ea39306d56e5f302739d07,0,1
import io.fabric8.forge.rest.hooks.CommandCompletePostProcessor;,b077563265697866b9ea39306d56e5f302739d07,0,1
import io.fabric8.forge.rest.ui.RestUIContext;,b077563265697866b9ea39306d56e5f302739d07,0,1
import io.fabric8.kubernetes.api.Controller;,b077563265697866b9ea39306d56e5f302739d07,0,1
import io.fabric8.kubernetes.api.KubernetesHelper;,b077563265697866b9ea39306d56e5f302739d07,0,1
import io.fabric8.kubernetes.api.ServiceNames;,b077563265697866b9ea39306d56e5f302739d07,0,1
import io.fabric8.kubernetes.api.builds.Builds;,b077563265697866b9ea39306d56e5f302739d07,0,1
import io.fabric8.kubernetes.client.KubernetesClient;,b077563265697866b9ea39306d56e5f302739d07,0,1
import io.fabric8.openshift.api.model.BuildConfig;,b077563265697866b9ea39306d56e5f302739d07,0,1
import io.fabric8.repo.git.CreateRepositoryDTO;,b077563265697866b9ea39306d56e5f302739d07,0,1
import io.fabric8.repo.git.GitRepoClient;,b077563265697866b9ea39306d56e5f302739d07,0,1
import io.fabric8.repo.git.RepositoryDTO;,b077563265697866b9ea39306d56e5f302739d07,0,1
import io.fabric8.utils.IOHelpers;,b077563265697866b9ea39306d56e5f302739d07,0,1
import org.apache.deltaspike.core.api.config.ConfigProperty;,b077563265697866b9ea39306d56e5f302739d07,0,1
import org.eclipse.jgit.api.Git;,b077563265697866b9ea39306d56e5f302739d07,0,1
import org.eclipse.jgit.api.InitCommand;,b077563265697866b9ea39306d56e5f302739d07,0,1
import org.eclipse.jgit.lib.PersonIdent;,b077563265697866b9ea39306d56e5f302739d07,0,1
import org.jboss.forge.addon.ui.controller.CommandController;,b077563265697866b9ea39306d56e5f302739d07,0,1
import org.jboss.forge.furnace.util.Strings;,b077563265697866b9ea39306d56e5f302739d07,0,1
import org.slf4j.Logger;,b077563265697866b9ea39306d56e5f302739d07,0,1
import org.slf4j.LoggerFactory;,b077563265697866b9ea39306d56e5f302739d07,0,1
import javax.inject.Inject;,b077563265697866b9ea39306d56e5f302739d07,0,1
import javax.servlet.http.HttpServletRequest;,b077563265697866b9ea39306d56e5f302739d07,0,1
import javax.ws.rs.NotAuthorizedException;,b077563265697866b9ea39306d56e5f302739d07,0,1
import java.io.File;,b077563265697866b9ea39306d56e5f302739d07,0,1
import java.io.IOException;,b077563265697866b9ea39306d56e5f302739d07,0,1
import java.util.List;,b077563265697866b9ea39306d56e5f302739d07,0,1
import java.util.Map;,b077563265697866b9ea39306d56e5f302739d07,0,1
import java.util.Objects;,b077563265697866b9ea39306d56e5f302739d07,0,1
import static io.fabric8.utils.cxf.JsonHelper.toJson;,b077563265697866b9ea39306d56e5f302739d07,0,1
// TODO we should try add this into the ConfigureDevOpsStep.execute() block instead!,b077563265697866b9ea39306d56e5f302739d07,0,1
private final KubernetesClient kubernetes;,b077563265697866b9ea39306d56e5f302739d07,0,1
private final GitUserHelper gitUserHelper;,b077563265697866b9ea39306d56e5f302739d07,0,1
private final ProjectFileSystem projectFileSystem;,b077563265697866b9ea39306d56e5f302739d07,0,1
private final boolean createOpenShiftBuildResources;,b077563265697866b9ea39306d56e5f302739d07,0,1
@Inject,b077563265697866b9ea39306d56e5f302739d07,0,1
"GitUserHelper gitUserHelper,",b077563265697866b9ea39306d56e5f302739d07,0,1
"ProjectFileSystem projectFileSystem,",b077563265697866b9ea39306d56e5f302739d07,0,1
"throw new NotAuthorizedException(""You must authenticate to be able to perform this command"");",b077563265697866b9ea39306d56e5f302739d07,0,1
"page1.put(TARGET_LOCATION_PROPERTY, projectFileSystem.getUserProjectFolderLocation(userDetails));",b077563265697866b9ea39306d56e5f302739d07,0,1
/*,b077563265697866b9ea39306d56e5f302739d07,0,1
GitHelpers.disableSslCertificateChecks();,b077563265697866b9ea39306d56e5f302739d07,0,1
"LOG.warn(""No targetLocation could be found!"");",b077563265697866b9ea39306d56e5f302739d07,0,1
"LOG.warn(""No named could be found!"");",b077563265697866b9ea39306d56e5f302739d07,0,1
initCommand.setDirectory(basedir);,b077563265697866b9ea39306d56e5f302739d07,0,1
createRepository.setName(named);,b077563265697866b9ea39306d56e5f302739d07,0,1
"results.setOutputProperty(""fullName"", fullName);",b077563265697866b9ea39306d56e5f302739d07,0,1
"results.setOutputProperty(""cloneUrl"", remoteUrl);",b077563265697866b9ea39306d56e5f302739d07,0,1
"results.setOutputProperty(""htmlUrl"", htmlUrl);",b077563265697866b9ea39306d56e5f302739d07,0,1
// now lets import the code and publish,b077563265697866b9ea39306d56e5f302739d07,0,1
"GitHelpers.configureBranch(git, branch, origin, remoteUrl);",b077563265697866b9ea39306d56e5f302739d07,0,1
addDummyFileToEmptyFolders(basedir);,b077563265697866b9ea39306d56e5f302739d07,0,1
"GitHelpers.doAddCommitAndPushFiles(git, userDetails, personIdent, branch, origin, message, isPushOnCommit());",b077563265697866b9ea39306d56e5f302739d07,0,1
results.setProjectName(projectName);,b077563265697866b9ea39306d56e5f302739d07,0,1
"createBuildConfig(context, namespace, projectName, cloneUrl);",b077563265697866b9ea39306d56e5f302739d07,0,1
"LOG.info(""Creating any pending webhooks"");",b077563265697866b9ea39306d56e5f302739d07,0,1
registerWebHooks(context);,b077563265697866b9ea39306d56e5f302739d07,0,1
"LOG.info(""Done creating webhooks!"");",b077563265697866b9ea39306d56e5f302739d07,0,1
handleException(e);,b077563265697866b9ea39306d56e5f302739d07,0,1
controller.setNamespace(namespace);,b077563265697866b9ea39306d56e5f302739d07,0,1
addDummyFileToEmptyFolders(child);,b077563265697866b9ea39306d56e5f302739d07,0,1
"projectFileSystem.invokeLater(runnable, 1000L);",b077563265697866b9ea39306d56e5f302739d07,0,1
throw new RuntimeException(e);,b077563265697866b9ea39306d56e5f302739d07,0,1
"boolean jar = packaging == null || packaging.equals(""jar""); // jar is default packaging",80229095d4fd7de40ba315f74acead63c513eff7,6,1
} else if (jar && main != null) {,80229095d4fd7de40ba315f74acead63c513eff7,6,1
"boolean springBoot, boolean war, boolean bundle, boolean jar) {",80229095d4fd7de40ba315f74acead63c513eff7,5,1
} else if (CamelProjectHelper.findCamelSpringDependency(project) != null) {,80229095d4fd7de40ba315f74acead63c513eff7,5,1
} else if (CamelProjectHelper.findCamelBlueprintDependency(project) != null) {,80229095d4fd7de40ba315f74acead63c513eff7,5,1
"@WithAttributes(label = ""Project Kind"", required = true, description = ""Camel project kind."")",80229095d4fd7de40ba315f74acead63c513eff7,4,1
"@WithAttributes(label = ""Camel Version"", required = false, description = ""Camel version to use. If none provided then the latest version will be used."")",80229095d4fd7de40ba315f74acead63c513eff7,4,1
if (core != null) {,80229095d4fd7de40ba315f74acead63c513eff7,4,1
// install test dependency,80229095d4fd7de40ba315f74acead63c513eff7,4,1
"boolean war = packaging != null && packaging.equals(""war"");",80229095d4fd7de40ba315f74acead63c513eff7,4,1
"boolean bundle = packaging != null && packaging.equals(""bundle"");",80229095d4fd7de40ba315f74acead63c513eff7,4,1
if (plugin != null) {,80229095d4fd7de40ba315f74acead63c513eff7,4,1
if (pluginBuilder != null) {,80229095d4fd7de40ba315f74acead63c513eff7,4,1
"boolean jar = packaging != null && packaging.equals(""jar"");",80229095d4fd7de40ba315f74acead63c513eff7,4,1
if (project != null) {,80229095d4fd7de40ba315f74acead63c513eff7,4,1
if (maven != null) {,80229095d4fd7de40ba315f74acead63c513eff7,4,1
if (pom != null) {,80229095d4fd7de40ba315f74acead63c513eff7,4,1
if (version != null) {,80229095d4fd7de40ba315f74acead63c513eff7,4,1
* Tries to guess a good default main class to use based on the project.,80229095d4fd7de40ba315f74acead63c513eff7,4,1
// try to guess a default main class,80229095d4fd7de40ba315f74acead63c513eff7,4,1
if (element != null) {,80229095d4fd7de40ba315f74acead63c513eff7,4,1
if (CamelProjectHelper.findCamelCDIDependency(project) != null) {,80229095d4fd7de40ba315f74acead63c513eff7,4,1
Project project = getSelectedProjectOrNull(context);,80229095d4fd7de40ba315f74acead63c513eff7,3,1
// only enable if we do not have Camel yet,80229095d4fd7de40ba315f74acead63c513eff7,3,1
if (project == null) {,80229095d4fd7de40ba315f74acead63c513eff7,3,1
Project project = getSelectedProject(context);,80229095d4fd7de40ba315f74acead63c513eff7,3,1
Dependency core = findCamelCoreDependency(project);,80229095d4fd7de40ba315f74acead63c513eff7,3,1
"return Results.success(""Apache Camel is already setup"");",80229095d4fd7de40ba315f74acead63c513eff7,3,1
"DependencyBuilder component = DependencyBuilder.create().setGroupId(""org.apache.camel"")",80229095d4fd7de40ba315f74acead63c513eff7,3,1
"DependencyBuilder testComponent = DependencyBuilder.create().setGroupId(""org.apache.camel"")",80229095d4fd7de40ba315f74acead63c513eff7,3,1
"} else if (""camel-spring"".equals(kind.getValue()) || ""camel-spring-boot"".equals(kind.getValue())) {",80229095d4fd7de40ba315f74acead63c513eff7,3,1
"} else if (""camel-blueprint"".equals(kind.getValue())) {",80229095d4fd7de40ba315f74acead63c513eff7,3,1
"return Results.success(""Added Apache Camel to the project"");",80229095d4fd7de40ba315f74acead63c513eff7,3,1
private static String[] jarImages = new String[]{DEFAULT_JAVA_IMAGE}; // s2i is not yet supported,80229095d4fd7de40ba315f74acead63c513eff7,3,1
} else if (war) {,80229095d4fd7de40ba315f74acead63c513eff7,3,1
// only include main for JAR deployment as WAR/bundle is container based,80229095d4fd7de40ba315f74acead63c513eff7,3,1
// if there is an existing then leave it as-is,80229095d4fd7de40ba315f74acead63c513eff7,3,1
// if we are adding then we need to include some configurations as well,80229095d4fd7de40ba315f74acead63c513eff7,3,1
} else if (bundle) {,80229095d4fd7de40ba315f74acead63c513eff7,3,1
// to save then set the model,80229095d4fd7de40ba315f74acead63c513eff7,3,1
"} else if (""bundle"".equals(packaging)) {",80229095d4fd7de40ba315f74acead63c513eff7,3,1
"} else if (""war"".equals(packaging)) {",80229095d4fd7de40ba315f74acead63c513eff7,3,1
"* @return the suggested main class, or <tt>null</tt> if not possible to guess/find a good candidate",80229095d4fd7de40ba315f74acead63c513eff7,3,1
// if camel-spring is on classpath,80229095d4fd7de40ba315f74acead63c513eff7,3,1
public boolean isEnabled(UIContext context) {,80229095d4fd7de40ba315f74acead63c513eff7,2,1
// must have a project,80229095d4fd7de40ba315f74acead63c513eff7,2,1
} else {,80229095d4fd7de40ba315f74acead63c513eff7,2,1
// does the project already have camel?,80229095d4fd7de40ba315f74acead63c513eff7,2,1
"core = DependencyBuilder.create().setCoordinate(createCamelCoordinate(""camel-core"", version.getValue()));",80229095d4fd7de40ba315f74acead63c513eff7,2,1
core = findCamelCoreDependency(project);,80229095d4fd7de40ba315f74acead63c513eff7,2,1
boolean found = false;,80229095d4fd7de40ba315f74acead63c513eff7,2,1
for (Dependency dependency : existing) {,80229095d4fd7de40ba315f74acead63c513eff7,2,1
if (dependency.getCoordinate().getArtifactId().equals(kind.getValue())) {,80229095d4fd7de40ba315f74acead63c513eff7,2,1
if (!found) {,80229095d4fd7de40ba315f74acead63c513eff7,2,1
"if (""camel-core"".equals(kind.getValue())) {",80229095d4fd7de40ba315f74acead63c513eff7,2,1
boolean springBoot = hasSpringBootMavenPlugin(project);,80229095d4fd7de40ba315f74acead63c513eff7,2,1
if (springBoot) {,80229095d4fd7de40ba315f74acead63c513eff7,2,1
} else {,80229095d4fd7de40ba315f74acead63c513eff7,2,1
if (bundle) {,80229095d4fd7de40ba315f74acead63c513eff7,2,1
if (Strings.isNotBlank(commandShell)) {,80229095d4fd7de40ba315f74acead63c513eff7,2,1
if (Strings.isNullOrBlank(shell.getText())) {,80229095d4fd7de40ba315f74acead63c513eff7,2,1
if (Strings.isNullOrBlank(from.getText())) {,80229095d4fd7de40ba315f74acead63c513eff7,2,1
if (Strings.isNullOrBlank(name.getText())) {,80229095d4fd7de40ba315f74acead63c513eff7,2,1
if (springBoot || jar) {,80229095d4fd7de40ba315f74acead63c513eff7,2,1
"if (!assembly.hasChildByName(""basedir"")) {",80229095d4fd7de40ba315f74acead63c513eff7,2,1
"if (!assembly.hasChildByName(""descriptor"")) {",80229095d4fd7de40ba315f74acead63c513eff7,2,1
if (Strings.isNullOrBlank(descriptorRef.getText())) {,80229095d4fd7de40ba315f74acead63c513eff7,2,1
boolean updated = false;,80229095d4fd7de40ba315f74acead63c513eff7,2,1
if (Strings.isNotBlank(fromImage)) {,80229095d4fd7de40ba315f74acead63c513eff7,2,1
"if (!fromImage.startsWith(dockerFromImagePrefix) || fromImage.split(""/"").length <= 2) {",80229095d4fd7de40ba315f74acead63c513eff7,2,1
// jolokia is exposed on our docker images on port 8778,80229095d4fd7de40ba315f74acead63c513eff7,2,1
// spring-boot is packaged as war but runs as fat WARs,80229095d4fd7de40ba315f74acead63c513eff7,2,1
if (updated) {,80229095d4fd7de40ba315f74acead63c513eff7,2,1
public static boolean hasSpringBootMavenPlugin(Project project) {,80229095d4fd7de40ba315f74acead63c513eff7,2,1
"Coordinate coor = CoordinateBuilder.create(""org.springframework.boot:spring-boot-maven-plugin"");",80229095d4fd7de40ba315f74acead63c513eff7,2,1
"if (""jar"".equals(packaging)) {",80229095d4fd7de40ba315f74acead63c513eff7,2,1
public static boolean isJarImage(String fromImage) {,80229095d4fd7de40ba315f74acead63c513eff7,2,1
// is required for jar images,80229095d4fd7de40ba315f74acead63c513eff7,2,1
if (jar.equals(fromImage)) {,80229095d4fd7de40ba315f74acead63c513eff7,2,1
"private static Coordinate createCoordinate(String groupId, String artifactId, String version) {",80229095d4fd7de40ba315f74acead63c513eff7,2,1
CoordinateBuilder builder = CoordinateBuilder.create(),80229095d4fd7de40ba315f74acead63c513eff7,2,1
builder = builder.setVersion(version);,80229095d4fd7de40ba315f74acead63c513eff7,2,1
if (Strings.isNullOrBlank(answer)) {,80229095d4fd7de40ba315f74acead63c513eff7,2,1
if (Strings.isNotBlank(answer)) {,80229095d4fd7de40ba315f74acead63c513eff7,2,1
"*  Red Hat licenses this file to you under the Apache License, version",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"*  Unless required by applicable law or agreed to in writing, software",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",80229095d4fd7de40ba315f74acead63c513eff7,1,1
public class CamelSetupCommand extends AbstractCamelProjectCommand {,80229095d4fd7de40ba315f74acead63c513eff7,1,1
"private String[] choices = new String[]{""camel-core"", ""camel-blueprint"", ""camel-cdi"", ""camel-spring"", ""camel-spring-boot""};",80229095d4fd7de40ba315f74acead63c513eff7,1,1
@Override,80229095d4fd7de40ba315f74acead63c513eff7,1,1
return false;,80229095d4fd7de40ba315f74acead63c513eff7,1,1
return true;,80229095d4fd7de40ba315f74acead63c513eff7,1,1
},80229095d4fd7de40ba315f74acead63c513eff7,1,1
public UICommandMetadata getMetadata(UIContext context) {,80229095d4fd7de40ba315f74acead63c513eff7,1,1
return Metadata.forCommand(CamelSetupCommand.class).name(,80229095d4fd7de40ba315f74acead63c513eff7,1,1
".description(""Setup Apache Camel in your project"");",80229095d4fd7de40ba315f74acead63c513eff7,1,1
public void initializeUI(UIBuilder builder) throws Exception {,80229095d4fd7de40ba315f74acead63c513eff7,1,1
public Result execute(UIExecutionContext context) throws Exception {,80229095d4fd7de40ba315f74acead63c513eff7,1,1
// add camel-core,80229095d4fd7de40ba315f74acead63c513eff7,1,1
"dependencyInstaller.install(project, core);",80229095d4fd7de40ba315f74acead63c513eff7,1,1
String camelVersion = core.getCoordinate().getVersion();,80229095d4fd7de40ba315f74acead63c513eff7,1,1
// add additional dependencies based on kind,80229095d4fd7de40ba315f74acead63c513eff7,1,1
Set<Dependency> existing = findCamelArtifacts(project);,80229095d4fd7de40ba315f74acead63c513eff7,1,1
found = true;,80229095d4fd7de40ba315f74acead63c513eff7,1,1
"dependencyInstaller.install(project, component);",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"dependencyInstaller.install(project, testComponent);",80229095d4fd7de40ba315f74acead63c513eff7,1,1
// add camel-maven-plugin,80229095d4fd7de40ba315f74acead63c513eff7,1,1
MavenPluginFacet pluginFacet = project.getFacet(MavenPluginFacet.class);,80229095d4fd7de40ba315f74acead63c513eff7,1,1
MavenPluginBuilder plugin = MavenPluginBuilder.create(),80229095d4fd7de40ba315f74acead63c513eff7,1,1
// add hawtio-maven-plugin using latest version,80229095d4fd7de40ba315f74acead63c513eff7,1,1
plugin = MavenPluginBuilder.create(),80229095d4fd7de40ba315f74acead63c513eff7,1,1
"*  Red Hat licenses this file to you under the Apache License, version",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"*  Unless required by applicable law or agreed to in writing, software",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",80229095d4fd7de40ba315f74acead63c513eff7,1,1
public class DockerSetupHelper {,80229095d4fd7de40ba315f74acead63c513eff7,1,1
private static final transient Logger LOG = LoggerFactory.getLogger(DockerSetupHelper.class);,80229095d4fd7de40ba315f74acead63c513eff7,1,1
"public static final String DEFAULT_KARAF_IMAGE = ""fabric8/karaf-2.4"";",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"public static final String DEFAULT_TOMCAT_IMAGE = ""fabric8/tomcat-8.0"";",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"public static final String DEFAULT_WILDFLY_IMAGE = ""jboss/wildfly:9.0.2.Final"";",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"public static final String DEFAULT_JAVA_IMAGE = ""fabric8/java-jboss-openjdk8-jdk:1.0.10"";",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"public static final String S2I_JAVA_IMAGE = ""fabric8/s2i-java:1.1.6"";",80229095d4fd7de40ba315f74acead63c513eff7,1,1
// see https://github.com/fabric8io/fabric8/issues/4160,80229095d4fd7de40ba315f74acead63c513eff7,1,1
"private static String dockerFromImagePrefix = ""docker.io/"";",80229095d4fd7de40ba315f74acead63c513eff7,1,1
private static String[] bundleImages = new String[]{DEFAULT_KARAF_IMAGE};,80229095d4fd7de40ba315f74acead63c513eff7,1,1
"private static String[] warImages = new String[]{DEFAULT_TOMCAT_IMAGE, DEFAULT_WILDFLY_IMAGE};",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"public static void setupDocker(Project project, String organization, String fromImage, String main) {",80229095d4fd7de40ba315f74acead63c513eff7,1,1
MavenFacet maven = project.getFacet(MavenFacet.class);,80229095d4fd7de40ba315f74acead63c513eff7,1,1
Model pom = maven.getModel();,80229095d4fd7de40ba315f74acead63c513eff7,1,1
String packaging = getProjectPackaging(project);,80229095d4fd7de40ba315f74acead63c513eff7,1,1
"Map<String, String> envs = new LinkedHashMap<>();",80229095d4fd7de40ba315f74acead63c513eff7,1,1
},80229095d4fd7de40ba315f74acead63c513eff7,1,1
"MavenPlugin plugin = MavenHelpers.findPlugin(project, ""org.jolokia"", ""docker-maven-plugin"");",80229095d4fd7de40ba315f74acead63c513eff7,1,1
pluginBuilder = null;,80229095d4fd7de40ba315f74acead63c513eff7,1,1
configurationBuilder = null;,80229095d4fd7de40ba315f74acead63c513eff7,1,1
pluginBuilder = MavenPluginBuilder.create(),80229095d4fd7de40ba315f74acead63c513eff7,1,1
configurationBuilder = ConfigurationBuilder.create(pluginBuilder);,80229095d4fd7de40ba315f74acead63c513eff7,1,1
String commandShell = null;,80229095d4fd7de40ba315f74acead63c513eff7,1,1
"commandShell = ""/usr/bin/deploy-and-start"";",80229095d4fd7de40ba315f74acead63c513eff7,1,1
MavenPluginFacet pluginFacet = project.getFacet(MavenPluginFacet.class);,80229095d4fd7de40ba315f74acead63c513eff7,1,1
"protected static void setupDockerConfiguration(ConfigurationBuilder config, Map<String, String> envs, String commandShell,",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"ConfigurationElement images = MavenHelpers.getOrCreateElement(config, ""images"");",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"ConfigurationElement image = MavenHelpers.getOrCreateElement(images, ""image"");",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"ConfigurationElement build = MavenHelpers.getOrCreateElement(image, ""build"");",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"ConfigurationElement env = MavenHelpers.getOrCreateElement(build, ""env"");",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"for (Map.Entry<String, String> entry : envs.entrySet()) {",80229095d4fd7de40ba315f74acead63c513eff7,1,1
ConfigurationElement cfg = ConfigurationElementBuilder.create().setName(entry.getKey()).setText(entry.getValue());,80229095d4fd7de40ba315f74acead63c513eff7,1,1
"ConfigurationElementBuilder shell = MavenHelpers.getOrCreateElementBuilder(build, ""cmd"", ""shell"");",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"ConfigurationElementBuilder from = MavenHelpers.getOrCreateElementBuilder(build, ""from"");",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"ConfigurationElementBuilder name = MavenHelpers.getOrCreateElementBuilder(image, ""name"");",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"ConfigurationElementBuilder assembly = MavenHelpers.getOrCreateElementBuilder(build, ""assembly"");",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"ConfigurationElementBuilder baseDir = MavenHelpers.getOrCreateElementBuilder(assembly, ""basedir"");",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"ConfigurationElementBuilder descriptorRef = MavenHelpers.getOrCreateElementBuilder(assembly, ""descriptorRef"");",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"public static void setupDockerProperties(Project project, String organization, String fromImage) {",80229095d4fd7de40ba315f74acead63c513eff7,1,1
// update properties section in pom.xml,80229095d4fd7de40ba315f74acead63c513eff7,1,1
Properties properties = pom.getProperties();,80229095d4fd7de40ba315f74acead63c513eff7,1,1
String fullDockerFromName = fromImage;,80229095d4fd7de40ba315f74acead63c513eff7,1,1
fullDockerFromName = dockerFromImagePrefix + fromImage;,80229095d4fd7de40ba315f74acead63c513eff7,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""docker.from"", fullDockerFromName, updated);",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""docker.image"", organization + ""/${project.artifactId}:${project.version}"", updated);",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""docker.port.container.jolokia"", ""8778"", updated);",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""docker.assemblyDescriptorRef"", ""artifact"", updated);",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""docker.port.container.http"", ""8080"", updated);",80229095d4fd7de40ba315f74acead63c513eff7,1,1
// tomcat/jetty on port 8080,80229095d4fd7de40ba315f74acead63c513eff7,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""docker.assemblyDescriptorRef"", ""rootWar"", updated);",80229095d4fd7de40ba315f74acead63c513eff7,1,1
// karaf,80229095d4fd7de40ba315f74acead63c513eff7,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""docker.assemblyDescriptorRef"", ""artifact-with-dependencies"", updated);",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""docker.port.container.http"", ""8181"", updated);",80229095d4fd7de40ba315f74acead63c513eff7,1,1
public static String getDockerFromImage(Project project) {,80229095d4fd7de40ba315f74acead63c513eff7,1,1
"return properties.getProperty(""docker.from"");",80229095d4fd7de40ba315f74acead63c513eff7,1,1
return null;,80229095d4fd7de40ba315f74acead63c513eff7,1,1
return pluginFacet.hasPlugin(coor);,80229095d4fd7de40ba315f74acead63c513eff7,1,1
return false;,80229095d4fd7de40ba315f74acead63c513eff7,1,1
public static String defaultDockerImage(Project project) {,80229095d4fd7de40ba315f74acead63c513eff7,1,1
return jarImages[0];,80229095d4fd7de40ba315f74acead63c513eff7,1,1
return bundleImages[0];,80229095d4fd7de40ba315f74acead63c513eff7,1,1
// we have both tomcat or jboss,80229095d4fd7de40ba315f74acead63c513eff7,1,1
private static String getProjectPackaging(Project project) {,80229095d4fd7de40ba315f74acead63c513eff7,1,1
return maven.getModel().getPackaging();,80229095d4fd7de40ba315f74acead63c513eff7,1,1
for (String jar : jarImages) {,80229095d4fd7de40ba315f74acead63c513eff7,1,1
return true;,80229095d4fd7de40ba315f74acead63c513eff7,1,1
return builder;,80229095d4fd7de40ba315f74acead63c513eff7,1,1
public static String defaultMainClass(Project project) {,80229095d4fd7de40ba315f74acead63c513eff7,1,1
String answer = null;,80229095d4fd7de40ba315f74acead63c513eff7,1,1
Configuration config = plugin.getConfig();,80229095d4fd7de40ba315f74acead63c513eff7,1,1
"ConfigurationElement element = MavenHelpers.getConfigurationElement(config, ""images"", ""image"", ""build"", ""env"", ""JAVA_MAIN_CLASS"");",80229095d4fd7de40ba315f74acead63c513eff7,1,1
answer = element.getText();,80229095d4fd7de40ba315f74acead63c513eff7,1,1
"answer = properties.getProperty(""docker.env.MAIN"");",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"answer = properties.getProperty(""fabric8.env.MAIN"");",80229095d4fd7de40ba315f74acead63c513eff7,1,1
return answer;,80229095d4fd7de40ba315f74acead63c513eff7,1,1
"return ""org.apache.camel.cdi.Main"";",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"return ""org.apache.camel.spring.Main"";",80229095d4fd7de40ba315f74acead63c513eff7,1,1
"return ""org.apache.camel.test.blueprint.Main"";",80229095d4fd7de40ba315f74acead63c513eff7,1,1
// TODO: what about spring-boot / docker-swarm??,80229095d4fd7de40ba315f74acead63c513eff7,1,1
/**,80229095d4fd7de40ba315f74acead63c513eff7,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",80229095d4fd7de40ba315f74acead63c513eff7,0,1
*,80229095d4fd7de40ba315f74acead63c513eff7,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",80229095d4fd7de40ba315f74acead63c513eff7,0,1
*  with the License.  You may obtain a copy of the License at,80229095d4fd7de40ba315f74acead63c513eff7,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,80229095d4fd7de40ba315f74acead63c513eff7,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",80229095d4fd7de40ba315f74acead63c513eff7,0,1
*  implied.  See the License for the specific language governing,80229095d4fd7de40ba315f74acead63c513eff7,0,1
*  permissions and limitations under the License.,80229095d4fd7de40ba315f74acead63c513eff7,0,1
*/,80229095d4fd7de40ba315f74acead63c513eff7,0,1
package io.fabric8.forge.camel.commands.project;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import java.util.Arrays;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import java.util.Set;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import javax.inject.Inject;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import io.fabric8.forge.addon.utils.VersionHelper;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.dependencies.Dependency;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.maven.plugins.MavenPluginBuilder;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.maven.projects.MavenPluginFacet;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.projects.Project;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.ui.context.UIContext;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.ui.input.UIInput;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.ui.input.UISelectOne;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.ui.result.Result;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.ui.result.Results;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.ui.util.Categories;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.ui.util.Metadata;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
@Inject,80229095d4fd7de40ba315f74acead63c513eff7,0,1
private UISelectOne<String> kind;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
private UIInput<String> version;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
private DependencyInstaller dependencyInstaller;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
"""Camel: Setup"").category(Categories.create(CATEGORY))",80229095d4fd7de40ba315f74acead63c513eff7,0,1
kind.setValueChoices(Arrays.asList(choices));,80229095d4fd7de40ba315f74acead63c513eff7,0,1
builder.add(kind).add(version);,80229095d4fd7de40ba315f74acead63c513eff7,0,1
break;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
.setArtifactId(kind.getValue()).setVersion(core.getCoordinate().getVersion());,80229095d4fd7de40ba315f74acead63c513eff7,0,1
".setArtifactId(""camel-test"").setVersion(core.getCoordinate().getVersion())",80229095d4fd7de40ba315f74acead63c513eff7,0,1
".setScopeType(""test"");",80229095d4fd7de40ba315f74acead63c513eff7,0,1
".setArtifactId(""camel-test-spring"").setVersion(core.getCoordinate().getVersion())",80229095d4fd7de40ba315f74acead63c513eff7,0,1
".setArtifactId(""camel-test-blueprint"").setVersion(core.getCoordinate().getVersion())",80229095d4fd7de40ba315f74acead63c513eff7,0,1
".setCoordinate(createCamelCoordinate(""camel-maven-plugin"", camelVersion));",80229095d4fd7de40ba315f74acead63c513eff7,0,1
pluginFacet.addPlugin(plugin);,80229095d4fd7de40ba315f74acead63c513eff7,0,1
".setCoordinate(createCoordinate(""io.hawt"", ""hawtio-maven-plugin"", VersionHelper.hawtioVersion()));",80229095d4fd7de40ba315f74acead63c513eff7,0,1
/**,80229095d4fd7de40ba315f74acead63c513eff7,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",80229095d4fd7de40ba315f74acead63c513eff7,0,1
*,80229095d4fd7de40ba315f74acead63c513eff7,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",80229095d4fd7de40ba315f74acead63c513eff7,0,1
*  with the License.  You may obtain a copy of the License at,80229095d4fd7de40ba315f74acead63c513eff7,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,80229095d4fd7de40ba315f74acead63c513eff7,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",80229095d4fd7de40ba315f74acead63c513eff7,0,1
*  implied.  See the License for the specific language governing,80229095d4fd7de40ba315f74acead63c513eff7,0,1
*  permissions and limitations under the License.,80229095d4fd7de40ba315f74acead63c513eff7,0,1
*/,80229095d4fd7de40ba315f74acead63c513eff7,0,1
package io.fabric8.forge.devops.setup;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import io.fabric8.forge.addon.utils.CamelProjectHelper;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import io.fabric8.forge.addon.utils.MavenHelpers;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import io.fabric8.forge.addon.utils.VersionHelper;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import io.fabric8.utils.Strings;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.apache.maven.model.Model;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.dependencies.Coordinate;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.dependencies.builder.CoordinateBuilder;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.maven.plugins.Configuration;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.maven.plugins.ConfigurationBuilder;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.maven.plugins.ConfigurationElement;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.maven.plugins.ConfigurationElementBuilder;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.maven.plugins.MavenPlugin;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.maven.plugins.MavenPluginBuilder;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.maven.projects.MavenFacet;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.maven.projects.MavenPluginFacet;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.jboss.forge.addon.projects.Project;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.slf4j.Logger;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import org.slf4j.LoggerFactory;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import java.util.LinkedHashMap;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import java.util.Map;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
import java.util.Properties;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
"envs.put(""JAR"", ""${project.artifactId}-${project.version}.war"");",80229095d4fd7de40ba315f74acead63c513eff7,0,1
"envs.put(""JAVA_OPTIONS"", ""-Djava.security.egd=/dev/./urandom"");",80229095d4fd7de40ba315f74acead63c513eff7,0,1
"envs.put(""CATALINA_OPTS"", ""-javaagent:/opt/tomcat/jolokia-agent.jar=host=0.0.0.0,port=8778"");",80229095d4fd7de40ba315f74acead63c513eff7,0,1
"envs.put(""JAVA_MAIN_CLASS"", main);",80229095d4fd7de40ba315f74acead63c513eff7,0,1
MavenPluginBuilder pluginBuilder;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
ConfigurationBuilder configurationBuilder;,80229095d4fd7de40ba315f74acead63c513eff7,0,1
"LOG.info(""Found existing docker-maven-plugin"");",80229095d4fd7de40ba315f74acead63c513eff7,0,1
"LOG.info(""Adding docker-maven-plugin"");",80229095d4fd7de40ba315f74acead63c513eff7,0,1
".setCoordinate(MavenHelpers.createCoordinate(""org.jolokia"", ""docker-maven-plugin"", VersionHelper.dockerVersion()));",80229095d4fd7de40ba315f74acead63c513eff7,0,1
pluginBuilder.setConfiguration(configurationBuilder);,80229095d4fd7de40ba315f74acead63c513eff7,0,1
"setupDockerConfiguration(configurationBuilder, envs, commandShell, springBoot, war, bundle, jar);",80229095d4fd7de40ba315f74acead63c513eff7,0,1
pluginFacet.addPlugin(pluginBuilder);,80229095d4fd7de40ba315f74acead63c513eff7,0,1
"setupDockerProperties(project, organization, fromImage);",80229095d4fd7de40ba315f74acead63c513eff7,0,1
env.getChildren().add(cfg);,80229095d4fd7de40ba315f74acead63c513eff7,0,1
MavenHelpers.asConfigurationElementBuilder(shell).setText(commandShell);,80229095d4fd7de40ba315f74acead63c513eff7,0,1
"from.setText(""${docker.from}"");",80229095d4fd7de40ba315f74acead63c513eff7,0,1
"name.setText(""${docker.image}"");",80229095d4fd7de40ba315f74acead63c513eff7,0,1
"baseDir.setText(""/app"");",80229095d4fd7de40ba315f74acead63c513eff7,0,1
"descriptorRef.setText(""${docker.assemblyDescriptorRef}"");",80229095d4fd7de40ba315f74acead63c513eff7,0,1
maven.setModel(pom);,80229095d4fd7de40ba315f74acead63c513eff7,0,1
.setGroupId(groupId),80229095d4fd7de40ba315f74acead63c513eff7,0,1
.setArtifactId(artifactId);,80229095d4fd7de40ba315f74acead63c513eff7,0,1
"@WithAttributes(label = ""Test classes"", required = false, defaultValue = ""true"", description = ""Include test dependencies"")",86d0aab4b809822bc63895ca7236fae716bb8a6c,5,1
"@WithAttributes(label = ""Maven Fabric8 Profiles"", required = false, defaultValue = ""true"", description = ""Include Maven fabric8 profiles for easily building and deploying"")",86d0aab4b809822bc63895ca7236fae716bb8a6c,4,1
"@WithAttributes(label = ""container"", required = false, description = ""Container name to use for the app"")",86d0aab4b809822bc63895ca7236fae716bb8a6c,3,0
// I guess we only need to add this import if we add a test case?,86d0aab4b809822bc63895ca7236fae716bb8a6c,3,0
"@WithAttributes(label = ""container"", required = false, description = ""Container label to use for the app"")",86d0aab4b809822bc63895ca7236fae716bb8a6c,3,1
// I guess we only need to add this import if we add a test case?,86d0aab4b809822bc63895ca7236fae716bb8a6c,3,1
Dependency dependency = DependencyBuilder.create(),86d0aab4b809822bc63895ca7236fae716bb8a6c,3,1
"@WithAttributes(label = ""Docker Organization"", required = true, description = ""The Docker organization/company"")",86d0aab4b809822bc63895ca7236fae716bb8a6c,3,1
"@WithAttributes(label = ""Docker Image From"", required = true, description = ""The Docker image to use as base line"")",86d0aab4b809822bc63895ca7236fae716bb8a6c,3,1
"@WithAttributes(label = ""Container label"", required = false, description = ""Container label to use for the app"")",86d0aab4b809822bc63895ca7236fae716bb8a6c,3,1
"@WithAttributes(label = ""Group label"", required = false, description = ""Group label to use for the app"")",86d0aab4b809822bc63895ca7236fae716bb8a6c,3,1
"@WithAttributes(label = ""Icon"", required = false, description = ""Icon to use for the app"")",86d0aab4b809822bc63895ca7236fae716bb8a6c,3,1
"@WithAttributes(label = ""Main class"", required = false, description = ""Main class to use for Java standalone"")",86d0aab4b809822bc63895ca7236fae716bb8a6c,3,1
Dependency bom = DependencyBuilder.create(),86d0aab4b809822bc63895ca7236fae716bb8a6c,2,0
Dependency bom = DependencyBuilder.create(),86d0aab4b809822bc63895ca7236fae716bb8a6c,2,1
dependency = DependencyBuilder.create(),86d0aab4b809822bc63895ca7236fae716bb8a6c,2,1
final Project project = getSelectedProject(builder.getUIContext());,86d0aab4b809822bc63895ca7236fae716bb8a6c,2,1
Project project = getSelectedProject(context.getUIContext());,86d0aab4b809822bc63895ca7236fae716bb8a6c,2,1
Dependency bom = DependencyBuilder.create(),86d0aab4b809822bc63895ca7236fae716bb8a6c,2,1
MavenFacet maven = project.getFacet(MavenFacet.class);,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,0
Model pom = maven.getModel();,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,0
"boolean hasFabric8Arquillian = !MavenHelpers.hasDependency(pom, ""io.fabric8"", ""fabric8-arquillian"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,0
"boolean hasArquillianJunitContainer = !MavenHelpers.hasDependency(pom, ""org.jboss.arquillian.junit"", ""arquillian-junit-container"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,0
// add fabric8 plugin,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,0
MavenPluginFacet pluginFacet = project.getFacet(MavenPluginFacet.class);,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,0
MavenPlugin plugin = MavenPluginBuilder.create(),86d0aab4b809822bc63895ca7236fae716bb8a6c,1,0
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.label.container"", container.getValue(), updated);",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,0
String iconValue = icon.getValue();,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,0
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.iconRef"", ""icons/"" + iconValue, updated);",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,0
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.label.group"", group.getValue(), updated);",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,0
// add fabric8 plugin,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
MavenPluginFacet pluginFacet = project.getFacet(MavenPluginFacet.class);,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
MavenPlugin plugin = MavenPluginBuilder.create(),86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
MavenFacet maven = project.getFacet(MavenFacet.class);,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
Model pom = maven.getModel();,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
updated = true;,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
private static final transient Logger LOG = LoggerFactory.getLogger(Fabric8SetupStep.class);,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
"private String[] jarImages = new String[]{DockerSetupHelper.DEFAULT_JAVA_IMAGE, DockerSetupHelper.S2I_JAVA_IMAGE};",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
private String[] bundleImages = new String[]{DockerSetupHelper.DEFAULT_KARAF_IMAGE};,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
"private String[] warImages = new String[]{DockerSetupHelper.DEFAULT_TOMCAT_IMAGE, DockerSetupHelper.DEFAULT_WILDFLY_IMAGE};",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
String packaging = getProjectPackaging(project);,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
boolean springBoot = hasSpringBootMavenPlugin(project);,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
// limit the choices depending on the project packaging,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
final List<String> choices = new ArrayList<String>();,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
String currentImage = getDockerFromImage(project);,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
String defaultChoice = choices.get(0);,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
boolean jarImage = DockerSetupHelper.isJarImage(from.getValue());,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
"String from = (String) builder.getUIContext().getAttributeMap().get(""docker.from"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
Set<String> choices = new LinkedHashSet<String>();,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
// favor Camel if there is a Camel dependency,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
// use the project name as default value,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
MavenFacet maven = project.getFacet(MavenFacet.class);,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
Model pom = maven.getModel();,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
"LOG.info(""setting up arquillian test"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
"boolean f8profiles = setupFabricMavenProfiles(project, maven, pom);",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
"String msg = ""Added Fabric8 Maven support with base Docker image: "" + from.getValue();",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
"msg += "". Added the following Maven profiles [f8-build, f8-deploy, f8-local-deploy] to make building the project easier, e.g. mvn -Pf8-local-deploy"";",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
"MavenPlugin plugin = MavenHelpers.findPlugin(project, ""io.fabric8"", ""fabric8-maven-plugin"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
pluginBuilder = null;,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
// add fabric8 plugin,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
pluginBuilder = MavenPluginBuilder.create(),86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
MavenPluginFacet pluginFacet = project.getFacet(MavenPluginFacet.class);,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
boolean updated = false;,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
Properties properties = pom.getProperties();,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.label.container"", container.getValue(), updated);",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
String iconValue = icon.getValue();,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.iconRef"", ""icons/"" + iconValue, updated);",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.label.group"", group.getValue(), updated);",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
String servicePort = getDefaultServicePort(project);,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
String name = pom.getArtifactId();,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
"String msg = ""The fabric8.service.name: "" + name + "" is being limited to max 24 chars as that is required by Kubernetes/Openshift.""",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
"name = name.substring(0, 24);",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.service.containerPort"", servicePort, updated);",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.service.port"", ""80"", updated);",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.service.name"", name, updated);",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
// to save then set the model,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
"Profile profile = MavenHelpers.findProfile(pom, ""f8-build"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
profile = new Profile();,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
Build build = new Build();,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
"build.setDefaultGoal(""clean install docker:build fabric8:json"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
updated = true;,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
"profile = MavenHelpers.findProfile(pom, ""f8-deploy"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
Properties prop = new Properties();,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
"build.setDefaultGoal(""clean install docker:build docker:push fabric8:json fabric8:apply"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
"profile = MavenHelpers.findProfile(pom, ""f8-local-deploy"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
"build.setDefaultGoal(""clean install docker:build fabric8:json fabric8:apply"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
int idx = fromImage.indexOf('/');,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
fromImage = fromImage.substring(idx + 1);,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
idx = fromImage.indexOf('-');,86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
"fromImage = fromImage.substring(0, idx);",86d0aab4b809822bc63895ca7236fae716bb8a6c,1,1
import io.fabric8.forge.addon.utils.MavenHelpers;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
".setCoordinate(MavenHelpers.createCoordinate(""io.fabric8"", ""fabric8-project"", VersionHelper.fabric8Version(), ""pom""))",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
".setCoordinate(MavenHelpers.createCoordinate(""io.fabric8"", ""arquillian-fabric8"", null))",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
".setCoordinate(MavenHelpers.createCoordinate(""org.jboss.arquillian.junit"", ""arquillian-junit-container"", null))",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
".setCoordinate(MavenHelpers.createCoordinate(""io.fabric8"", ""fabric8-maven-plugin"", VersionHelper.fabric8Version()))",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
".setCoordinate(createCoordinate(""io.fabric8"", ""fabric8-project"", VersionHelper.fabric8Version(), ""pom""))",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
".setCoordinate(createCoordinate(""io.fabric8"", ""arquillian-fabric8"", null))",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
".setCoordinate(createCoordinate(""org.jboss.arquillian.junit"", ""arquillian-junit-container"", null))",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
".setCoordinate(createCoordinate(""io.fabric8"", ""fabric8-maven-plugin"", VersionHelper.fabric8Version()))",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import io.fabric8.utils.Strings;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
import javax.inject.Inject;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
import java.util.ArrayList;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
import java.util.Iterator;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
import java.util.LinkedHashSet;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
import java.util.List;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
import java.util.Map;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
import java.util.Properties;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
import java.util.Set;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
import java.util.concurrent.Callable;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
import static io.fabric8.forge.addon.utils.MavenHelpers.ensureMavenDependencyAdded;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
builder.add(test).add(icon).add(group).add(container);,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
// unless the app is using fabric8-cdi or something?,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
if (!hasFabric8Arquillian || !hasArquillianJunitContainer) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
"if (!MavenHelpers.hasManagedDependency(pom, ""io.fabric8"", ""fabric8-project"")) {",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
".setCoordinate(MavenHelpers.createCoordinate(""io.fabric8"", ""fabric8-project"", VersionHelper.fabric8Version(), ""pom""))",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
".setScopeType(""import"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
"dependencyInstaller.installManaged(project, bom);",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
},86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
"ensureMavenDependencyAdded(project, dependencyInstaller, ""io.fabric8"", ""fabric8-arquillian"", ""test"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
"ensureMavenDependencyAdded(project, dependencyInstaller, ""org.jboss.arquillian.junit"", ""arquillian-junit-container"", ""test"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
"if (!MavenHelpers.hasMavenPlugin(pom, ""io.fabric8"", ""fabric8-maven-plugin"")) {",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
".setCoordinate(MavenHelpers.createCoordinate(""io.fabric8"", ""fabric8-maven-plugin"", VersionHelper.fabric8Version()))",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
".addExecution(ExecutionBuilder.create().setId(""json"").addGoal(""json""))",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
".addExecution(ExecutionBuilder.create().setId(""zip"").addGoal(""zip""));",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
pluginFacet.addPlugin(plugin);,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
if (Strings.isNotBlank(iconValue)) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,0
import java.util.ArrayList;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import java.util.Iterator;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import java.util.LinkedHashSet;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import java.util.List;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import java.util.Map;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import java.util.Properties;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import java.util.Set;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import java.util.concurrent.Callable;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import javax.inject.Inject;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
builder.add(container).add(group).add(icon).add(test);,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"System.out.println(""====== execute() and we have a project: "" + project);",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
// unless the app is using fabric8-cdi or something?,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
".setCoordinate(MavenHelpers.createCoordinate(""io.fabric8"", ""fabric8-project"", VersionHelper.fabric8Version(), ""pom""))",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
".setScopeType(""import"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"dependencyInstaller.installManaged(project, bom);",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
".setCoordinate(MavenHelpers.createCoordinate(""io.fabric8"", ""arquillian-fabric8"", null))",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
".setScopeType(""test"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"dependencyInstaller.installManaged(project, dependency);",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
".setCoordinate(MavenHelpers.createCoordinate(""org.jboss.arquillian.junit"", ""arquillian-junit-container"", null))",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
".setCoordinate(MavenHelpers.createCoordinate(""io.fabric8"", ""fabric8-maven-plugin"", VersionHelper.fabric8Version()))",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
".addExecution(ExecutionBuilder.create().setId(""json"").addGoal(""json""))",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
".addExecution(ExecutionBuilder.create().setId(""zip"").addGoal(""zip""));",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
pluginFacet.addPlugin(plugin);,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
if (container.getValue() != null) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"properties.put(""fabric8.label.container"", container.getValue());",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
},86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
if (icon.getValue() != null) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"properties.put(""fabric8.iconRef"", ""icons/"" + icon.getValue());",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
if (group.getValue() != null) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"properties.put(""fabric8.label.group"", group.getValue());",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
/**,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
*,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"*  Red Hat licenses this file to you under the Apache License, version",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
*  with the License.  You may obtain a copy of the License at,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"*  Unless required by applicable law or agreed to in writing, software",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
*  implied.  See the License for the specific language governing,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
*  permissions and limitations under the License.,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
*/,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
package io.fabric8.forge.devops.setup;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import java.util.ArrayList;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import java.util.Arrays;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import java.util.Iterator;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import java.util.LinkedHashSet;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import java.util.List;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import java.util.Properties;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import java.util.Set;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import java.util.concurrent.Callable;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import javax.inject.Inject;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import io.fabric8.forge.addon.utils.MavenHelpers;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import io.fabric8.forge.addon.utils.VersionHelper;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import io.fabric8.forge.addon.utils.validator.ClassNameOrMavenPropertyValidator;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import io.fabric8.utils.Objects;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import io.fabric8.utils.Strings;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.apache.maven.model.Build;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.apache.maven.model.Model;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.apache.maven.model.Profile;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.dependencies.Dependency;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.facets.FacetFactory;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.facets.constraints.FacetConstraint;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.maven.plugins.ExecutionBuilder;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.maven.plugins.MavenPlugin;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.maven.plugins.MavenPluginBuilder;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.maven.projects.MavenFacet;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.maven.projects.MavenPluginFacet;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.projects.Project;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.resource.ResourceFactory;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.templates.TemplateFactory;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.ui.context.UIContext;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.ui.context.UINavigationContext;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.ui.input.InputComponent;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.ui.input.UICompleter;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.ui.input.UIInput;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.ui.input.UISelectOne;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.ui.result.NavigationResult;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.ui.result.Result;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.ui.result.Results;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.ui.util.Categories;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.ui.util.Metadata;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.jboss.forge.addon.ui.wizard.UIWizardStep;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.slf4j.Logger;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import org.slf4j.LoggerFactory;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import static io.fabric8.forge.addon.utils.MavenHelpers.ensureMavenDependencyAdded;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import static io.fabric8.forge.devops.setup.DockerSetupHelper.getDockerFromImage;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import static io.fabric8.forge.devops.setup.DockerSetupHelper.hasSpringBootMavenPlugin;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import static io.fabric8.forge.devops.setup.DockerSetupHelper.setupDocker;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
import static io.fabric8.forge.devops.setup.SetupProjectHelper.findCamelArtifacts;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"@FacetConstraint({MavenFacet.class, MavenPluginFacet.class, ResourcesFacet.class})",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
public class Fabric8SetupStep extends AbstractFabricProjectCommand implements UIWizardStep {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
@Inject,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
private UIInput<String> organization;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
private UIInput<String> from;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
private UIInput<String> container;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
private UIInput<String> group;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
private UISelectOne<String> icon;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
private UIInput<String> main;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
private UIInput<Boolean> test;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
private UIInput<Boolean> profiles;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
private DependencyInstaller dependencyInstaller;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
private TemplateFactory factory;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
ResourceFactory resourceFactory;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
FacetFactory facetFactory;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
@Override,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
public UICommandMetadata getMetadata(UIContext context) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
return Metadata.forCommand(Fabric8SetupStep.class).name(,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"""Fabric8: Setup"").category(Categories.create(CATEGORY))",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
".description(""Configure the Fabric8 and Docker options for the project"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
},86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
public boolean isEnabled(UIContext context) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"// this is a step in a wizard, you cannot run this standalone",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
return false;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
public NavigationResult next(UINavigationContext context) throws Exception {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
return null;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
public void initializeUI(final UIBuilder builder) throws Exception {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"organization.setDefaultValue(""fabric8"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
builder.add(organization);,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"LOG.info(""Getting the current project"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"LOG.info(""Got the current project"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"if (packaging == null || springBoot || ""jar"".equals(packaging)) {",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
if (currentImage != null) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
choices.add(currentImage);,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
} else {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
choices.addAll(Arrays.asList(jarImages));,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"if (packaging == null || ""bundle"".equals(packaging)) {",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
choices.add(bundleImages[0]);,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"if (!springBoot && (packaging == null || ""war"".equals(packaging))) {",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
choices.addAll(Arrays.asList(warImages));,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
from.setCompleter(new UICompleter<String>() {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"public Iterable<String> getCompletionProposals(UIContext context, InputComponent<?, String> input, String value) {",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
return choices;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
});,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
// is it possible to pre select a choice?,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
if (choices.size() > 0) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
if (defaultChoice != null) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
from.setDefaultValue(defaultChoice);,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
from.addValueChangeListener(new ValueChangeListener() {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
public void valueChanged(ValueChangeEvent event) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
// use a listener so the docker step knows what we selected as it want to reuse,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"builder.getUIContext().getAttributeMap().put(""docker.from"", event.getNewValue());",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
builder.add(from);,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"if (packaging == null || (!packaging.equals(""war"") && !packaging.equals(""ear""))) {",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
// TODO until we can detect reliably executable JARS versus mains lets not make this mandatory,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
/*,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
main.setRequired(new Callable<Boolean>() {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
public Boolean call() throws Exception {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
return jarImage;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
// only enable main if its required,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
// TODO we could disable if we knew this was an executable jar,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
main.setEnabled(jarImage);,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
if (project != null) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
main.setDefaultValue(DockerSetupHelper.defaultMainClass(project));,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
main.addValidator(new ClassNameOrMavenPropertyValidator(true));,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
main.addValueChangeListener(new ValueChangeListener() {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"builder.getUIContext().getAttributeMap().put(""docker.main"", event.getNewValue());",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
builder.add(main);,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
container.setDefaultValue(new Callable<String>() {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
public String call() throws Exception {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
if (from != null) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
return asContainer(from);,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
// the from image values,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
icon.setValueChoices(new Iterable<String>() {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
public Iterator<String> iterator() {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"choices.add(""activemq"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"choices.add(""camel"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"choices.add(""java"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"choices.add(""jetty"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"choices.add(""karaf"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"choices.add(""mule"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"choices.add(""tomcat"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"choices.add(""tomee"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"choices.add(""weld"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"choices.add(""wildfly"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
return choices.iterator();,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
icon.setDefaultValue(new Callable<String>() {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
if (!findCamelArtifacts(project).isEmpty()) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"return ""camel"";",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
if (container.getValue() != null) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
for (String choice : icon.getValueChoices()) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
if (choice.equals(container.getValue())) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
return choice;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
// use java by default,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"return ""java"";",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
group.setDefaultValue(new Callable<String>() {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
builder.add(profiles).add(test).add(icon).add(group).add(container);,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
public Result execute(UIExecutionContext context) throws Exception {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"LOG.info(""starting to setup fabric8 project"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
if (project == null) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"return Results.fail(""No pom.xml available so cannot edit the project!"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
// setup docker-maven-plugin and fabric8-maven-plugin,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"setupDocker(project, organization.getValue(), from.getValue(), main.getValue());",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"LOG.info(""docker-maven-plugin now setup"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
setupFabricMavenPlugin(project);,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"LOG.info(""fabric8-maven-plugin now setup"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
// import fabric8 bom,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"LOG.info(""importing fabric8 bom"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"importFabricBom(project, pom);",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
// make sure we have resources as we need it later,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"facetFactory.install(project, ResourcesFacet.class);",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"setupArguillianTest(project, pom);",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"LOG.info(""setting up fabric8 properties"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"setupFabricProperties(project, maven, pom);",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"LOG.info(""setting up fabric8 maven profiles"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
if (f8profiles) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
return Results.success(msg);,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"private void importFabricBom(Project project, Model pom) {",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"if (!MavenHelpers.hasManagedDependency(pom, ""io.fabric8"", ""fabric8-project"")) {",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
".setCoordinate(MavenHelpers.createCoordinate(""io.fabric8"", ""fabric8-project"", VersionHelper.fabric8Version(), ""pom""))",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
".setScopeType(""import"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"dependencyInstaller.installManaged(project, bom);",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
private void setupFabricMavenPlugin(Project project) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
MavenPluginBuilder pluginBuilder;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
if (plugin != null) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
// if there is an existing then leave it as-is,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"LOG.info(""Found existing fabric8-maven-plugin"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"LOG.info(""Adding fabric8-maven-plugin"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
".setCoordinate(MavenHelpers.createCoordinate(""io.fabric8"", ""fabric8-maven-plugin"", VersionHelper.fabric8Version()))",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
".addExecution(ExecutionBuilder.create().setId(""json"").setPhase(""generate-resources"").addGoal(""json""))",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
".addExecution(ExecutionBuilder.create().setId(""attach"").setPhase(""package"").addGoal(""attach""));",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
if (pluginBuilder != null) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
pluginFacet.addPlugin(pluginBuilder);,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"private void setupArguillianTest(Project project, Model pom) {",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
if (test.getValue() != null && test.getValue()) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"ensureMavenDependencyAdded(project, dependencyInstaller, ""io.fabric8"", ""fabric8-arquillian"", ""test"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"ensureMavenDependencyAdded(project, dependencyInstaller, ""org.jboss.arquillian.junit"", ""arquillian-junit-container"", ""test"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"private void setupFabricProperties(Project project, MavenFacet maven, Model pom) {",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
// update properties section in pom.xml,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
if (Strings.isNotBlank(iconValue)) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
if (servicePort != null) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
// there is a max 24 chars limit in OpenShift/Kubernetes,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
if (name.length() > 24) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
// print a warning,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"+ "" You can change the name of the service in the <properties> section of the Maven pom file."";",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
// log and print to system out as the latter is what is seen in the CLI,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
LOG.warn(msg);,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
System.out.println(msg);,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
// clip the name at max 24 chars,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
if (updated) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
maven.setModel(pom);,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"LOG.info(""updated pom.xml"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"private boolean setupFabricMavenProfiles(Project project, MavenFacet maven, Model pom) {",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
if (profiles.getValue() == null || !profiles.getValue()) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
if (profile == null) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"LOG.info(""Adding f8-build profile"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"profile.setId(""f8-build"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
profile.setBuild(build);,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
pom.addProfile(profile);,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"LOG.info(""Adding f8-deploy profile"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"profile.setId(""f8-deploy"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"prop.setProperty(""fabric8.imagePullPolicySnapshot"", ""Always"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"prop.setProperty(""fabric8.recreate"", ""true"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
profile.setProperties(prop);,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"LOG.info(""Adding f8-local-deploy profile"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"profile.setId(""f8-local-deploy"");",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
return true;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
* Try to determine the default service port.,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
* If this is a WAR or EAR then lets assume 8080.,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
* For karaf we can't know its definitely got http inside; so lets punt for now.,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
protected String getDefaultServicePort(Project project) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
if (Strings.isNotBlank(packaging)) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"if (Objects.equal(""war"", packaging) || Objects.equal(""ear"", packaging)) {",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"return ""8080"";",86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
private static String asContainer(String fromImage) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
if (idx > 0) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
return fromImage;,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
private static String getProjectPackaging(Project project) {,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
return maven.getModel().getPackaging();,86d0aab4b809822bc63895ca7236fae716bb8a6c,0,1
"public Response getCommandInput(@PathParam(""name"") final String name, @PathParam(""namespace"") String namespace, @PathParam(""projectName"") String projectName) throws Exception {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,5,1
"protected void createBuildConfig(RestUIContext context, String namespace, String projectName, String cloneUrl) throws Exception {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,5,1
"public List<CommandInfoDTO> getCommands(@PathParam(""namespace"") String namespace, @PathParam(""projectName"") String projectName, @PathParam(""path"") String resourcePath) throws Exception {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,4,1
if (dto != null && dto.isEnabled()) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,4,1
"public Response getCommandInfo(@PathParam(""name"") final String name, @PathParam(""namespace"") final String namespace, @PathParam(""projectName"") final String projectName,",732e365c4af8e06e5e78cf28815a0dabf4231c1b,4,1
if (answer != null) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,4,1
if (command != null) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,4,1
if (postProcessor != null) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,4,1
if (nextController != null) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,4,1
if (answer.isCommandCompleted() && postProcessor != null) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,4,1
if (userDetails != null) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,4,1
if (commandCompletePostProcessor != null) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,4,1
"protected <T> T withUIContext(final String namespace, final String projectName, String resourcePath, boolean write, final RestUIFunction<T> function, final GitContext gitContext) throws Exception {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,4,1
if (Strings.isNotBlank(namespace) && Strings.isNotBlank(projectName) && resourceFactory != null) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,4,1
"* For new projects; lets git add, git commit, git push otherwise lets git add/commit/push any new/udpated changes",732e365c4af8e06e5e78cf28815a0dabf4231c1b,4,1
if (inputList != null) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,4,1
if (page1 != null) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,4,1
if (repository != null) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,4,1
if (dir != null && dir.isDirectory()) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,4,1
"public List<CommandInfoDTO> getCommands(@PathParam(""namespace"") String namespace, @PathParam(""projectName"") String projectName) throws Exception {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,3,1
"public Response executeCommand(@PathParam(""name"") final String name, final ExecutionRequest executionRequest) throws Exception {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,3,1
"public Response doExecute(@PathParam(""name"") String name, ExecutionRequest executionRequest, CommandCompletePostProcessor postProcessor, UserDetails userDetails, RestUIContext uiContext) throws Exception {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,3,1
if (command == null) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,3,1
} else if (!valid) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,3,1
"public Response validateCommand(@PathParam(""name"") final String name, final ExecutionRequest executionRequest) throws Exception {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,3,1
"public Response doValidate(@PathParam(""name"") String name, ExecutionRequest executionRequest, UserDetails userDetails, RestUIContext uiContext) throws Exception {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,3,1
"protected <T> T withUIContext(String namespace, String projectName, String resourcePath, boolean write, RestUIFunction<T> function) throws Exception {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,3,1
if (projectResource == null) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,3,1
if (resourceFactory == null) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,3,1
if (converterFactory == null) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,3,1
"@ConfigProperty(name = ""JENKINS_SEED_JOB"", defaultValue = DEFAULT_JENKINS_SEED_JOB) String jenkinsSeedJob,",732e365c4af8e06e5e78cf28815a0dabf4231c1b,3,1
"@ConfigProperty(name = ""OPENSHIFT_CREATE_BUILD_ON_PROJECT_CREATE"", defaultValue = ""false"") boolean createOpenShiftBuildResources) {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,3,1
"public void firePostCompleteActions(String name, ExecutionRequest executionRequest, RestUIContext context, CommandController controller, ExecutionResult results, HttpServletRequest request) {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,3,1
} else if (Strings.isNullOrEmpty(named)) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,3,1
if (children == null || children.length == 0) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,3,1
public String getInfo() {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
try (RestUIContext context = new RestUIContext()) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
for (String name : commandFactory.getCommandNames(context)) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
} catch (Exception e) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"LOG.warn(""Ignored exception on command "" + name + "" probably due to missing project?: "" + e, e);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"public Response getCommandInfo(@PathParam(""name"") String name) throws Exception {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"@PathParam(""path"") final String resourcePath) throws Exception {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
} else {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"public Response getCommandInput(@PathParam(""name"") String name) throws Exception {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"public Response getCommandInput(@PathParam(""name"") final String name,",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"@PathParam(""namespace"") String namespace, @PathParam(""projectName"") String projectName,",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"@PathParam(""path"") String resourcePath) throws Exception {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"UICommand command = getCommandByName(context, name);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
String namespace = executionRequest.getNamespace();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
String projectName = executionRequest.getProjectName();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
String resourcePath = executionRequest.getResource();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
} catch (Throwable e) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"LOG.warn(""Failed to invoke command "" + name + "" on "" + executionRequest + "". "" + e, e);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
try (RestUIContext context = uiContext) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
if (controller instanceof WizardCommandController) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
if (!stepValidation.isValid()) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
if (!canMoveToNextStep) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"LOG.debug(""Invoked command "" + name + "" with "" + executionRequest + "" result: "" + lastResult);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
if (nextController == lastController) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"LOG.debug(""Invoked command "" + name + "" with "" + executionRequest + "" result: "" + result);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"protected void configureAttributeMaps(UserDetails userDetails, CommandController controller, ExecutionRequest executionRequest) {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
final String namespace = executionRequest.getNamespace();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
final String projectName = executionRequest.getProjectName();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
final String resourcePath = executionRequest.getResource();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"protected CommandInfoDTO createCommandInfoDTO(RestUIContext context, String name) {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
if (isValidCommandName(name)) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
* Returns true if the name is valid. Lets filter out commands which are not suitable to run inside fabric8-forge,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
if (Strings.isNullOrBlank(name) || ignoreCommands.contains(name)) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
if (name.startsWith(prefix)) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"protected UICommand getCommandByName(RestUIContext context, String name) {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"throw new NotFoundException(""Could not find git project for namespace: "" + namespace + "" and projectName: "" + projectName);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
GitOperation<T> operation = new GitOperation<T>() {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
File gitDir = repository.getDirectory();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
File directory = gitDir.getParentFile();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
String cloneUrl = projectResource.getCloneUrl();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"try (RestUIContext context = new RestUIContext(selection, namespace, projectName, cloneUrl)) {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
String commitMessage = context.getCommitMessage();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
if (Strings.isNotBlank(commitMessage)) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
if (write) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
try (RestUIContext context = new RestUIContext(null)) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
public void setConverterFactory(ConverterFactory converterFactory) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"public static final String PROJECT_NEW_COMMAND = ""project-new"";",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"public static final String TARGET_LOCATION_PROPERTY = ""targetLocation"";",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"public static final String DEFAULT_JENKINS_SEED_JOB = ""seed"";",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"public UserDetails preprocessRequest(String name, ExecutionRequest executionRequest, HttpServletRequest request) {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
if (Strings.isNullOrEmpty(userDetails.getUser()) || Strings.isNullOrEmpty(userDetails.getUser())) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"if (Objects.equals(name, PROJECT_NEW_COMMAND)) {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
if (page1.containsKey(TARGET_LOCATION_PROPERTY)) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
String user = userDetails.getUser();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
String address = userDetails.getAddress();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
String internalAddress = userDetails.getInternalAddress();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
String branch = userDetails.getBranch();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
String origin = projectFileSystem.getRemote();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
if (name.equals(PROJECT_NEW_COMMAND)) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
String targetLocation = null;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
String named = null;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
if (Strings.isNullOrEmpty(targetLocation)) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
if (Strings.isNullOrEmpty(named)) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
} else {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"File basedir = new File(targetLocation, named);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
if (!basedir.isDirectory() || !basedir.exists()) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
Git git = initCommand.call();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
String fullName = null;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
if (LOG.isDebugEnabled()) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
if (Strings.isNullOrEmpty(fullName)) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"String htmlUrl = address + user + ""/"" + named;",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"String remoteUrl = internalAddress + user + ""/"" + named + "".git"";",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"String cloneUrl =  htmlUrl + "".git"";",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"String message = ExecutionRequest.createCommitMessage(name, executionRequest);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"String namespace = firstNotBlank(context.getProjectName(), executionRequest.getNamespace());",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"String projectName = firstNotBlank(named, context.getProjectName(), executionRequest.getProjectName());",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
} catch (Exception e) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
public static String firstNotBlank(String... texts) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
if (!Strings.isNullOrEmpty(text)) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
String jenkinsUrl = getJenkinsServiceUrl(namespace);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
protected String getJenkinsServiceUrl(String namespace) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
protected void addDummyFileToEmptyFolders(File dir) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
"File dummyFile = new File(dir, "".gitkeep"");",732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
} catch (IOException e) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
if (child.isDirectory()) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
protected void registerWebHooks(RestUIContext context) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
if (registerWebHooksValue instanceof Runnable) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
protected void handleException(Throwable e) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,2,1
public class CommandsResource {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
private static final transient Logger LOG = LoggerFactory.getLogger(CommandsResource.class);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
protected static final Set<String> ignoreCommands = new HashSet<>(Arrays.asList(,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
// project commands,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"protected static final List<String> ignoreCommandPrefixes = Arrays.asList(""addon-"", ""archetype-"", ""fabric8-"", ""git-"", ""camel-get-"");",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
},732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
public List<String> getCommandNames() {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
List<String> answer = new ArrayList<>();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
for (String commandName : commandFactory.getCommandNames(context)) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
public List<CommandInfoDTO> getCommands() throws Exception {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"return withUIContext(namespace, projectName, resourcePath, false, new RestUIFunction<List<CommandInfoDTO>>() {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
public List<CommandInfoDTO> apply(RestUIContext context) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
List<CommandInfoDTO> answer = new ArrayList<>();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
try {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"CommandInfoDTO dto = createCommandInfoDTO(context, name);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"return withUIContext(namespace, projectName, resourcePath, false, new RestUIFunction<Response>() {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
public Response apply(RestUIContext context) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"CommandInfoDTO answer = createCommandInfoDTO(context, name);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
public Response apply(RestUIContext context) throws Exception {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
CommandInputDTO answer = null;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"CommandController controller = createController(context, command);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"answer = UICommands.createCommandInputDTO(context, command, controller);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
final CommandCompletePostProcessor postProcessor = this.commandCompletePostProcessor;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"userDetails = postProcessor.preprocessRequest(name, executionRequest, request);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
userDetails = null;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"return withUIContext(namespace, projectName, resourcePath, true, new RestUIFunction<Response>() {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
public Response apply(RestUIContext uiContext) throws Exception {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
* This method is only used to warm up JBoss Forge so we can create a sample project on startup in a temporary directory,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"List<Map<String, String>> inputList = executionRequest.getInputList();",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
ExecutionResult answer = null;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
WizardCommandController wizardCommandController = (WizardCommandController) controller;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
List<WizardCommandController> controllers = new ArrayList<>();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
List<CommandInputDTO> stepPropertiesList = new ArrayList<>();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
List<ExecutionResult> stepResultList = new ArrayList<>();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
List<ValidationResult> stepValidationList = new ArrayList<>();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
WizardCommandController lastController = wizardCommandController;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
Result lastResult = null;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
int page = executionRequest.wizardStep();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
int nextPage = page + 1;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
boolean canMoveToNextStep = false;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"for (Map<String, String> inputs : inputList) {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
List<UIMessage> messages = lastController.validate();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"ValidationResult stepValidation = UICommands.createValidationResult(context, lastController, messages);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
canMoveToNextStep = lastController.canMoveToNextStep();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
boolean valid = lastController.isValid();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
lastResult = lastController.execute();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"ExecutionResult stepResults = UICommands.createExecutionResult(context, lastResult, false);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
WizardCommandController nextController = lastController.next();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
lastController = nextController;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"CommandInputDTO stepDto = UICommands.createCommandInputDTO(context, command, lastController);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
int i = 0;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
for (WizardCommandController stepController : controllers) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"Map<String, String> stepControllerInputs = inputList.get(i++);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
lastResult = stepController.execute();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"answer = UICommands.createExecutionResult(context, lastResult, canMoveToNextStep);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"WizardResultsDTO wizardResultsDTO = new WizardResultsDTO(stepPropertiesList, stepValidationList, stepResultList);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"Map<String, String> inputs = inputList.get(0);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
Result result = controller.execute();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"answer = UICommands.createExecutionResult(context, result, false);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"Map<Object, Object> attributeMap = controller.getContext().getAttributeMap();",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"userDetails = commandCompletePostProcessor.preprocessRequest(name, executionRequest, request);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
GitContext gitContext = new GitContext();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
ValidationResult answer = null;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
List<ValidationResult> stepResultList = new ArrayList<>();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
List<UIMessage> lastResult = null;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
lastResult = lastController.validate();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"ValidationResult stepResults = UICommands.createValidationResult(context, controller, lastResult);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
lastResult = stepController.validate();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"answer = UICommands.createValidationResult(context, controller, lastResult);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"//WizardResultsDTO wizardResultsDTO = new WizardResultsDTO(stepPropertiesList, stepValidationList, stepResultList);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"WizardResultsDTO wizardResultsDTO = new WizardResultsDTO(stepPropertiesList, stepResultList, new ArrayList<ExecutionResult>());",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
List<UIMessage> result = controller.validate();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"answer = UICommands.createValidationResult(context, controller, result);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
CommandInfoDTO answer = null;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"answer = UICommands.createCommandInfoDTO(context, command);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
protected boolean isValidCommandName(String name) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
for (String prefix : ignoreCommandPrefixes) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"protected CommandController createController(RestUIContext context, UICommand command) throws Exception {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
RestUIRuntime runtime = new RestUIRuntime();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"CommandController controller = commandControllerFactory.createController(context, runtime,",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
final ResourceFactory resourceFactory = getResourceFactory();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"RepositoriesResource repositoriesResource = new RepositoriesResource(gitUserHelper, repositoryCache, projectFileSystem, lockManager, kubernetes);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"final RepositoryResource projectResource = repositoriesResource.projectRepositoryResource(namespace, projectName);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"public T call(Git git, GitContext gitContext) throws Exception {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
Repository repository = git.getRepository();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
Resource<?> selection = resourceFactory.create(directory);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
T answer = function.apply(context);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
public RestUIContext createUIContext(File file) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
ResourceFactory resourceFactory = getResourceFactory();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
Resource<File> selection = resourceFactory.create(file);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
protected ResourceFactory getResourceFactory() {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
AddonRegistry addonRegistry = furnace.getAddonRegistry();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
Imported<ResourceFactory> resourceFactoryImport = addonRegistry.getServices(ResourceFactory.class);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
ResourceFactory resourceFactory = null;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
resourceFactory = resourceFactoryImport.get();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
public ConverterFactory getConverterFactory() {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
Imported<ConverterFactory> converterFactoryImport = addonRegistry.getServices(ConverterFactory.class);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
converterFactory = converterFactoryImport.get();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
this.converterFactory = converterFactory;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
public class GitCommandCompletePostProcessor implements CommandCompletePostProcessor {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
private static final transient Logger LOG = LoggerFactory.getLogger(GitCommandCompletePostProcessor.class);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
private final String jenkinsSeedJob;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
this.kubernetes = kubernetes;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
this.gitUserHelper = gitUserHelper;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
this.projectFileSystem = projectFileSystem;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
this.jenkinsSeedJob = jenkinsSeedJob;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
this.createOpenShiftBuildResources = createOpenShiftBuildResources;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
},732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
UserDetails userDetails = gitUserHelper.createUserDetails(request);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
// TODO this isn't really required if there's a secret associated with the BuildConfig source,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"List<Map<String, String>> inputList = executionRequest.getInputList();",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"Map<String, String> page1 = inputList.get(0);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
try {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
PersonIdent personIdent = userDetails.createPersonIdent();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"for (Map<String, String> map : inputList) {",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"targetLocation = map.get(""targetLocation"");",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"named = map.get(""named"");",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"LOG.warn(""Generated project folder does not exist: "" + basedir.getAbsolutePath());",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
InitCommand initCommand = Git.init();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"LOG.info(""Initialised an empty git configuration repo at {}"", basedir.getAbsolutePath());",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
GitRepoClient repoClient = userDetails.createRepoClient();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
CreateRepositoryDTO createRepository = new CreateRepositoryDTO();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
RepositoryDTO repository = repoClient.createRepository(createRepository);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
fullName = repository.getFullName();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"fullName = user + ""/"" + named;",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"//results.appendOut(""Created git repository "" + fullName + "" at: "" + htmlUrl);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"LOG.info(""Using remoteUrl: "" + remoteUrl + "" and remote name "" + origin);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"LOG.info(""Commiting and pushing to: "" + remoteUrl + "" and remote name "" + origin);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
for (String text : texts) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"BuildConfig buildConfig = Builds.createDefaultBuildConfig(projectName, cloneUrl, jenkinsUrl);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
Controller controller = new Controller(kubernetes);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"controller.applyBuildConfig(buildConfig, ""from project "" + projectName);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
* Git tends to ignore empty directories so lets add a dummy file to empty folders to keep them in git,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
File[] children = dir.listFiles();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"IOHelpers.writeFully(dummyFile, ""This file is only here to avoid git removing empty folders\nOnce there are files in this folder feel free to delete this file!"");",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
for (File child : children) {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"Map<Object, Object> attributeMap = context.getAttributeMap();",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
"Object registerWebHooksValue = attributeMap.get(""registerWebHooks"");",732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
Runnable runnable = (Runnable) registerWebHooksValue;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
protected boolean isPushOnCommit() {,732e365c4af8e06e5e78cf28815a0dabf4231c1b,1,1
/**,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
*,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"*  Red Hat licenses this file to you under the Apache License, version",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
*  with the License.  You may obtain a copy of the License at,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"*  Unless required by applicable law or agreed to in writing, software",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
*  implied.  See the License for the specific language governing,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
*  permissions and limitations under the License.,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
*/,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
package io.fabric8.forge.rest;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.forge.rest.dto.CommandInfoDTO;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.forge.rest.dto.CommandInputDTO;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.forge.rest.dto.ExecutionRequest;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.forge.rest.dto.ExecutionResult;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.forge.rest.dto.UICommands;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.forge.rest.dto.ValidationResult;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.forge.rest.dto.WizardResultsDTO;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.forge.rest.git.GitContext;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.forge.rest.git.GitLockManager;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.forge.rest.git.GitOperation;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.forge.rest.git.RepositoriesResource;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.forge.rest.git.RepositoryResource;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.forge.rest.hooks.CommandCompletePostProcessor;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.forge.rest.main.GitUserHelper;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.forge.rest.main.ProjectFileSystem;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.forge.rest.main.RepositoryCache;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.forge.rest.main.UserDetails;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.forge.rest.ui.RestUIContext;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.forge.rest.ui.RestUIFunction;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.forge.rest.ui.RestUIRuntime;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.kubernetes.client.KubernetesClient;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.utils.Strings;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.eclipse.jgit.api.Git;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.eclipse.jgit.lib.Repository;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.jboss.forge.addon.convert.ConverterFactory;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.jboss.forge.addon.resource.Resource;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.jboss.forge.addon.resource.ResourceFactory;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.jboss.forge.addon.ui.command.CommandFactory;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.jboss.forge.addon.ui.command.UICommand;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.jboss.forge.addon.ui.controller.CommandController;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.jboss.forge.addon.ui.controller.CommandControllerFactory;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.jboss.forge.addon.ui.controller.WizardCommandController;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.jboss.forge.addon.ui.output.UIMessage;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.jboss.forge.addon.ui.result.Result;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.jboss.forge.furnace.Furnace;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.jboss.forge.furnace.addons.AddonRegistry;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.jboss.forge.furnace.services.Imported;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.slf4j.Logger;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.slf4j.LoggerFactory;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import javax.ejb.Stateless;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import javax.inject.Inject;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import javax.servlet.http.HttpServletRequest;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import javax.ws.rs.Consumes;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import javax.ws.rs.GET;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import javax.ws.rs.NotFoundException;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import javax.ws.rs.POST;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import javax.ws.rs.Path;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import javax.ws.rs.PathParam;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import javax.ws.rs.Produces;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import javax.ws.rs.core.Context;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import javax.ws.rs.core.MediaType;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import javax.ws.rs.core.Response;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import javax.ws.rs.core.Response.Status;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import java.io.File;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import java.util.ArrayList;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import java.util.Arrays;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import java.util.HashSet;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import java.util.List;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import java.util.Map;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import java.util.Set;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"@Path(""/api/forge"")",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
@Stateless,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"""devops-edit"",",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"""devops-new-build"",",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
// forge commands,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"""build-and-install-an-addon"",",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"""install-an-addon"",",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"""install-an-addon-from-git"",",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"""remove-an-addon"",",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"""update-an-addon"",",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"""build"",",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"""project-new""",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
));,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
@Inject,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
private Furnace furnace;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
private CommandControllerFactory commandControllerFactory;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
private CommandFactory commandFactory;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
private CommandCompletePostProcessor commandCompletePostProcessor;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
private ProjectFileSystem projectFileSystem;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
private GitUserHelper gitUserHelper;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
private RepositoryCache repositoryCache;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
private KubernetesClient kubernetes;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
private GitLockManager lockManager;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
@Context,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
private HttpServletRequest request;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
private ConverterFactory converterFactory;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
@GET,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
return furnace.getVersion().toString();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"@Path(""/commandNames"")",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
@Produces(MediaType.APPLICATION_JSON),732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
answer.add(commandName);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
return answer;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"@Path(""/commands"")",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"return getCommands(null, null, null);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"@Path(""/commands/{namespace}/{projectName}"")",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"return getCommands(namespace, projectName, null);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"@Path(""/commands/{namespace}/{projectName}/{path: .*}"")",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
@Override,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
answer.add(dto);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
});,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"@Path(""/command/{name}"")",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"return getCommandInfo(name, null, null, null);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"@Path(""/command/{name}/{namespace}/{projectName}/{path: .*}"")",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
return Response.ok(answer).build();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
return Response.status(Status.NOT_FOUND).build();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"@Path(""/commandInput/{name}"")",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"return getCommandInput(name, null, null, null);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"@Path(""/commandInput/{name}/{namespace}/{projectName}"")",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"return getCommandInput(name, namespace, projectName, null);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"@Path(""/commandInput/{name}/{namespace}/{projectName}/{path: .*}"")",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
@POST,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"@Path(""/command/execute/{name}"")",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
@Consumes(MediaType.APPLICATION_JSON),732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
final UserDetails userDetails;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
userDetails.setAddress(uiContext.getCloneUrl());,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"return doExecute(name, executionRequest, postProcessor, userDetails, uiContext);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
throw e;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"configureAttributeMaps(userDetails, controller, executionRequest);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
controllers.add(wizardCommandController);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"UICommands.populateController(inputs, lastController, getConverterFactory());",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
stepValidationList.add(stepValidation);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
break;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
// lets assume we can execute now,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
stepResultList.add(stepResults);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"LOG.warn(""Cannot move to next step as invalid despite the validation saying otherwise"");",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"LOG.warn(""No idea whats going on ;)"");",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
lastController.initialize();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
controllers.add(lastController);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
stepPropertiesList.add(stepDto);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"UICommands.populateController(stepControllerInputs, stepController, getConverterFactory());",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
answer.setWizardResults(wizardResultsDTO);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"UICommands.populateController(inputs, controller, getConverterFactory());",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"postProcessor.firePostCompleteActions(name, executionRequest, context, controller, answer, request);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"context.setCommitMessage(ExecutionRequest.createCommitMessage(name, executionRequest));",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"attributeMap.put(""gitUser"", userDetails.getUser());",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"attributeMap.put(""gitPassword"", userDetails.getPassword());",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"attributeMap.put(""gitAuthorEmail"", userDetails.getEmail());",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"attributeMap.put(""gitAddress"", userDetails.getAddress());",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"attributeMap.put(""gitUrl"", userDetails.getAddress());",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"attributeMap.put(""gitBranch"", userDetails.getBranch());",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"attributeMap.put(""projectName"", executionRequest.getProjectName());",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"attributeMap.put(""buildName"", executionRequest.getProjectName());",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"attributeMap.put(""namespace"", executionRequest.getNamespace());",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"attributeMap.put(""jenkinsWorkflowFolder"", projectFileSystem.getJenkinsWorkflowFolder());",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
projectFileSystem.asyncCloneOrPullJenkinsWorkflows(userDetails);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"@Path(""/command/validate/{name}"")",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
gitContext.setRequirePull(false);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"return doValidate(name, executionRequest, userDetails, uiContext);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"}, gitContext);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
* Helper method used purely to pre-load and warm up JBoss Forge,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
// TODO do we need stepValidationList?,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
return false;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
return true;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"return commandFactory.getCommandByName(context, name);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
command);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
controller.initialize();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
return controller;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"return withUIContext(namespace, projectName, resourcePath, write, function, new GitContext());",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
repositoriesResource.setRequest(request);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"LOG.debug(""using repository directory: "" + directory.getAbsolutePath());",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
projectResource.setMessage(commitMessage);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
};,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
return projectResource.gitWriteOperation(operation);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
return projectResource.gitReadOperation(operation);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
return function.apply(context);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
return new RestUIContext(selection);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"LOG.warn(""Failed to get ResourceFactory injected: "" + e, e);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
// lets try one more time - might work this time?,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
return resourceFactory;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
return converterFactory;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
/**,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
*,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"*  Red Hat licenses this file to you under the Apache License, version",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
*  with the License.  You may obtain a copy of the License at,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"*  Unless required by applicable law or agreed to in writing, software",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
*  implied.  See the License for the specific language governing,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
*  permissions and limitations under the License.,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
*/,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
package io.fabric8.forge.rest.main;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.forge.rest.dto.ExecutionRequest;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.forge.rest.dto.ExecutionResult;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.forge.rest.hooks.CommandCompletePostProcessor;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.forge.rest.ui.RestUIContext;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.kubernetes.api.Controller;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.kubernetes.api.KubernetesHelper;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.kubernetes.api.ServiceNames;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.kubernetes.api.builds.Builds;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.kubernetes.client.KubernetesClient;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.openshift.api.model.BuildConfig;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.repo.git.CreateRepositoryDTO;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.repo.git.GitRepoClient;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.repo.git.RepositoryDTO;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import io.fabric8.utils.IOHelpers;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.apache.deltaspike.core.api.config.ConfigProperty;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.eclipse.jgit.api.Git;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.eclipse.jgit.api.InitCommand;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.eclipse.jgit.lib.PersonIdent;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.jboss.forge.addon.ui.controller.CommandController;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.jboss.forge.furnace.util.Strings;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.slf4j.Logger;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import org.slf4j.LoggerFactory;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import javax.inject.Inject;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import javax.servlet.http.HttpServletRequest;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import javax.ws.rs.NotAuthorizedException;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import java.io.File;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import java.io.IOException;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import java.util.List;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import java.util.Map;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import java.util.Objects;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
import static io.fabric8.utils.cxf.JsonHelper.toJson;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
// TODO we should try add this into the ConfigureDevOpsStep.execute() block instead!,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
private final KubernetesClient kubernetes;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
private final GitUserHelper gitUserHelper;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
private final ProjectFileSystem projectFileSystem;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
private final boolean createOpenShiftBuildResources;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
@Inject,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"public GitCommandCompletePostProcessor(KubernetesClient kubernetes,",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"GitUserHelper gitUserHelper,",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"ProjectFileSystem projectFileSystem,",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
@Override,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"throw new NotAuthorizedException(""You must authenticate to be able to perform this command"");",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"page1.put(TARGET_LOCATION_PROPERTY, projectFileSystem.getUserProjectFolderLocation(userDetails));",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
/*,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
return userDetails;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
GitHelpers.disableSslCertificateChecks();,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"LOG.warn(""No targetLocation could be found!"");",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"LOG.warn(""No named could be found!"");",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
initCommand.setDirectory(basedir);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
// lets create the repository,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
createRepository.setName(named);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"LOG.debug(""Got repository: "" + toJson(repository));",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"results.setOutputProperty(""fullName"", fullName);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"results.setOutputProperty(""cloneUrl"", remoteUrl);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"results.setOutputProperty(""htmlUrl"", htmlUrl);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
// now lets import the code and publish,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"GitHelpers.configureBranch(git, branch, origin, remoteUrl);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
addDummyFileToEmptyFolders(basedir);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"GitHelpers.doAddCommitAndPushFiles(git, userDetails, personIdent, branch, origin, message, isPushOnCommit());",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
results.setProjectName(projectName);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"createBuildConfig(context, namespace, projectName, cloneUrl);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"LOG.info(""Creating any pending webhooks"");",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
registerWebHooks(context);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"LOG.info(""Done creating webhooks!"");",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
handleException(e);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
return text;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
return null;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"LOG.info(""Creating a BuildConfig for namespace: "" + namespace + "" project: "" + projectName);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
controller.setNamespace(namespace);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"return KubernetesHelper.getServiceURL(kubernetes, ServiceNames.JENKINS, namespace, ""http"", true);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"LOG.warn(""Failed to write file "" + dummyFile + "". "" + e, e);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
addDummyFileToEmptyFolders(child);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"projectFileSystem.invokeLater(runnable, 1000L);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
return true;,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
"LOG.warn(""Caught: "" + e, e);",732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
throw new RuntimeException(e);,732e365c4af8e06e5e78cf28815a0dabf4231c1b,0,1
// only use the value if a value was set (and the value is not the same as the default value),edd48a4b1558b504f84eaf604300381b5f371672,11,0
// only use the value if a value was set (and the value is not the same as the default value),edd48a4b1558b504f84eaf604300381b5f371672,11,1
// if we have a line number then use that to edit the existing value,edd48a4b1558b504f84eaf604300381b5f371672,8,1
// do not add the value if it match the default value,edd48a4b1558b504f84eaf604300381b5f371672,7,0
// do not add the value if it match the default value,edd48a4b1558b504f84eaf604300381b5f371672,7,1
"// if we created a new endpoint, then insert a new line with the endpoint details",edd48a4b1558b504f84eaf604300381b5f371672,7,1
// only use the value if a value was set,edd48a4b1558b504f84eaf604300381b5f371672,6,0
// only use the value if a value was set,edd48a4b1558b504f84eaf604300381b5f371672,6,1
// if its required then we need to grab the value,edd48a4b1558b504f84eaf604300381b5f371672,6,0
// only use the value if a value was set,edd48a4b1558b504f84eaf604300381b5f371672,6,1
// find if we have the endpoint already,edd48a4b1558b504f84eaf604300381b5f371672,6,1
// if its required then we need to grab the value,edd48a4b1558b504f84eaf604300381b5f371672,6,1
"* To find the closet node that we need to insert the endpoints before, so the Camel schema is valid.",edd48a4b1558b504f84eaf604300381b5f371672,6,1
// does the project already have camel?,edd48a4b1558b504f84eaf604300381b5f371672,5,0
// does the project already have camel?,edd48a4b1558b504f84eaf604300381b5f371672,5,1
// skip values which are the same as the default value,edd48a4b1558b504f84eaf604300381b5f371672,5,0
// does the project already have camel?,edd48a4b1558b504f84eaf604300381b5f371672,5,1
// we do not want to change the current code formatting so we need to search,edd48a4b1558b504f84eaf604300381b5f371672,5,1
"// wonder if we should have better way, than a replaceFirst?",edd48a4b1558b504f84eaf604300381b5f371672,5,1
// if there is endpoints then the cut-off is after the last,edd48a4b1558b504f84eaf604300381b5f371672,5,1
* Returns the mandatory String value of the given name,edd48a4b1558b504f84eaf604300381b5f371672,5,1
* Returns the optional String value of the given name,edd48a4b1558b504f84eaf604300381b5f371672,5,1
// lets find the camel component class,edd48a4b1558b504f84eaf604300381b5f371672,4,0
if (value != null) {,edd48a4b1558b504f84eaf604300381b5f371672,4,0
// lets find the camel component class,edd48a4b1558b504f84eaf604300381b5f371672,4,1
if (value != null) {,edd48a4b1558b504f84eaf604300381b5f371672,4,1
if (value != null) {,edd48a4b1558b504f84eaf604300381b5f371672,4,0
// to be safe that & is not already &amp; we need to revert it first,edd48a4b1558b504f84eaf604300381b5f371672,4,1
// lets find the camel component class,edd48a4b1558b504f84eaf604300381b5f371672,4,1
if (value != null) {,edd48a4b1558b504f84eaf604300381b5f371672,4,1
FileResource file = facet != null ? facet.getResource(xml) : null;,edd48a4b1558b504f84eaf604300381b5f371672,4,1
"// we are in add mode, so parse dom to find <camelContext> and insert the endpoint where its needed",edd48a4b1558b504f84eaf604300381b5f371672,4,1
"private Result editEndpointXml(List<String> lines, String lineNumber, String endpointUrl, String uri, FileResource file, String xml) {",edd48a4b1558b504f84eaf604300381b5f371672,4,1
// okay its an endpoint so if we can match by id attribute,edd48a4b1558b504f84eaf604300381b5f371672,4,1
// if no endpoints then try to find cut-off according the XSD rules,edd48a4b1558b504f84eaf604300381b5f371672,4,1
* @throws IllegalArgumentException if the value is not available in the given attribute map,edd48a4b1558b504f84eaf604300381b5f371672,4,1
if (result != null) {,edd48a4b1558b504f84eaf604300381b5f371672,3,0
String value = input.getValue().toString();,edd48a4b1558b504f84eaf604300381b5f371672,3,0
"String uri = ""We need Camel 2.15.1"";",edd48a4b1558b504f84eaf604300381b5f371672,3,0
// make sure to import the Camel endpoint,edd48a4b1558b504f84eaf604300381b5f371672,3,0
"String line = String.format(""Endpoint %s = endpoint(\""%s\"");\n\n"", endpointInstanceName, uri);",edd48a4b1558b504f84eaf604300381b5f371672,3,0
if (result != null) {,edd48a4b1558b504f84eaf604300381b5f371672,3,1
String value = input.getValue().toString();,edd48a4b1558b504f84eaf604300381b5f371672,3,1
"String uri = ""We need Camel 2.15.1"";",edd48a4b1558b504f84eaf604300381b5f371672,3,1
// make sure to import the Camel endpoint,edd48a4b1558b504f84eaf604300381b5f371672,3,1
"String line = String.format(""Endpoint %s = endpoint(\""%s\"");\n\n"", endpointInstanceName, uri);",edd48a4b1558b504f84eaf604300381b5f371672,3,1
String value = input.getValue().toString();,edd48a4b1558b504f84eaf604300381b5f371672,3,0
// add the endpoint as a field,edd48a4b1558b504f84eaf604300381b5f371672,3,0
// make sure to import the Camel endpoint,edd48a4b1558b504f84eaf604300381b5f371672,3,1
"String line = String.format(""Endpoint %s = endpoint(\""%s\"");\n\n"", endpointInstanceName, uri);",edd48a4b1558b504f84eaf604300381b5f371672,3,1
*  with the License.  You may obtain a copy of the License at,edd48a4b1558b504f84eaf604300381b5f371672,3,1
if (inputs != null) {,edd48a4b1558b504f84eaf604300381b5f371672,3,1
// only execute if we are last,edd48a4b1558b504f84eaf604300381b5f371672,3,1
if (result != null) {,edd48a4b1558b504f84eaf604300381b5f371672,3,1
String value = input.getValue().toString();,edd48a4b1558b504f84eaf604300381b5f371672,3,1
file = webResourcesFacet != null ? webResourcesFacet.getWebResource(xml) : null;,edd48a4b1558b504f84eaf604300381b5f371672,3,1
if (lineNumber != null) {,edd48a4b1558b504f84eaf604300381b5f371672,3,1
// replace uri with new value,edd48a4b1558b504f84eaf604300381b5f371672,3,1
"private Result addEndpointXml(Document root, String endpointInstanceName, String uri, FileResource file, String xml) throws Exception {",edd48a4b1558b504f84eaf604300381b5f371672,3,1
if (root != null) {,edd48a4b1558b504f84eaf604300381b5f371672,3,1
if (camels != null && camels.getLength() == 1) {,edd48a4b1558b504f84eaf604300381b5f371672,3,1
int idx = lineNumber != null ? Integer.valueOf(lineNumber) - 1 : 0;,edd48a4b1558b504f84eaf604300381b5f371672,3,1
if (endpointInstanceName != null) {,edd48a4b1558b504f84eaf604300381b5f371672,3,1
// add the endpoint as a field,edd48a4b1558b504f84eaf604300381b5f371672,3,1
if (method != null) {,edd48a4b1558b504f84eaf604300381b5f371672,3,1
// replace the unformatted class soure code,edd48a4b1558b504f84eaf604300381b5f371672,3,1
String name = found.getNodeName();,edd48a4b1558b504f84eaf604300381b5f371672,3,1
if (endpoint != null) {,edd48a4b1558b504f84eaf604300381b5f371672,3,1
"throw new IllegalArgumentException(""The attribute value '"" + name + ""' did not get passed on from the previous wizard page"");",edd48a4b1558b504f84eaf604300381b5f371672,3,1
"String kind = mandatoryAttributeValue(attributeMap, ""kind"");",edd48a4b1558b504f84eaf604300381b5f371672,2,0
"String camelComponentName = mandatoryAttributeValue(attributeMap, ""componentName"");",edd48a4b1558b504f84eaf604300381b5f371672,2,0
"String endpointInstanceName = mandatoryAttributeValue(attributeMap, ""instanceName"");",edd48a4b1558b504f84eaf604300381b5f371672,2,0
"String routeBuilder = mandatoryAttributeValue(attributeMap, ""routeBuilder"");",edd48a4b1558b504f84eaf604300381b5f371672,2,0
Project project = getSelectedProject(context);,edd48a4b1558b504f84eaf604300381b5f371672,2,0
JavaSourceFacet facet = project.getFacet(JavaSourceFacet.class);,edd48a4b1558b504f84eaf604300381b5f371672,2,0
if (core == null) {,edd48a4b1558b504f84eaf604300381b5f371672,2,0
"Result result = loadCamelComponentDetails(camelComponentName, details);",edd48a4b1558b504f84eaf604300381b5f371672,2,0
"result = ensureCamelArtifactIdAdded(project, details, dependencyInstaller);",edd48a4b1558b504f84eaf604300381b5f371672,2,0
// collect all the options that was set,edd48a4b1558b504f84eaf604300381b5f371672,2,0
String key = input.getName();,edd48a4b1558b504f84eaf604300381b5f371672,2,0
// TODO: require Camel 2.15.1,edd48a4b1558b504f84eaf604300381b5f371672,2,0
if (existing == null || !existing.exists()) {,edd48a4b1558b504f84eaf604300381b5f371672,2,0
String body = configure.getBody();,edd48a4b1558b504f84eaf604300381b5f371672,2,0
// insert the endpoint code,edd48a4b1558b504f84eaf604300381b5f371672,2,0
// set the updated body,edd48a4b1558b504f84eaf604300381b5f371672,2,0
"String xml = mandatoryAttributeValue(attributeMap, ""xml"");",edd48a4b1558b504f84eaf604300381b5f371672,2,0
"String camelComponentName = mandatoryAttributeValue(attributeMap, ""componentName"");",edd48a4b1558b504f84eaf604300381b5f371672,2,1
"String endpointInstanceName = mandatoryAttributeValue(attributeMap, ""instanceName"");",edd48a4b1558b504f84eaf604300381b5f371672,2,1
"String routeBuilder = mandatoryAttributeValue(attributeMap, ""routeBuilder"");",edd48a4b1558b504f84eaf604300381b5f371672,2,1
"String kind = mandatoryAttributeValue(attributeMap, ""kind"");",edd48a4b1558b504f84eaf604300381b5f371672,2,1
Project project = getSelectedProject(context);,edd48a4b1558b504f84eaf604300381b5f371672,2,1
JavaSourceFacet facet = project.getFacet(JavaSourceFacet.class);,edd48a4b1558b504f84eaf604300381b5f371672,2,1
if (core == null) {,edd48a4b1558b504f84eaf604300381b5f371672,2,1
"Result result = loadCamelComponentDetails(camelComponentName, details);",edd48a4b1558b504f84eaf604300381b5f371672,2,1
"result = ensureCamelArtifactIdAdded(project, details, dependencyInstaller);",edd48a4b1558b504f84eaf604300381b5f371672,2,1
// collect all the options that was set,edd48a4b1558b504f84eaf604300381b5f371672,2,1
String key = input.getName();,edd48a4b1558b504f84eaf604300381b5f371672,2,1
// TODO: require Camel 2.15.1,edd48a4b1558b504f84eaf604300381b5f371672,2,1
if (existing == null || !existing.exists()) {,edd48a4b1558b504f84eaf604300381b5f371672,2,1
String body = configure.getBody();,edd48a4b1558b504f84eaf604300381b5f371672,2,1
// insert the endpoint code,edd48a4b1558b504f84eaf604300381b5f371672,2,1
// set the updated body,edd48a4b1558b504f84eaf604300381b5f371672,2,1
// special for CDI as we use different set of annotations,edd48a4b1558b504f84eaf604300381b5f371672,2,0
"boolean cdi = findCamelArtifactDependency(project, ""camel-cdi"") != null;",edd48a4b1558b504f84eaf604300381b5f371672,2,0
if (field == null) {,edd48a4b1558b504f84eaf604300381b5f371672,2,0
if (annotation == null) {,edd48a4b1558b504f84eaf604300381b5f371672,2,0
// make sure to import what we use,edd48a4b1558b504f84eaf604300381b5f371672,2,0
String body = configure.getBody();,edd48a4b1558b504f84eaf604300381b5f371672,2,1
// insert the endpoint code,edd48a4b1558b504f84eaf604300381b5f371672,2,1
if (body == null) {,edd48a4b1558b504f84eaf604300381b5f371672,2,1
"String match = String.format(""Endpoint %s="", endpointInstanceName);",edd48a4b1558b504f84eaf604300381b5f371672,2,1
String line = lines.get(i);,edd48a4b1558b504f84eaf604300381b5f371672,2,1
// the line to add/update,edd48a4b1558b504f84eaf604300381b5f371672,2,1
String content = LineNumberHelper.linesToString(lines);,edd48a4b1558b504f84eaf604300381b5f371672,2,1
*  implied.  See the License for the specific language governing,edd48a4b1558b504f84eaf604300381b5f371672,2,1
"String componentName, String group,",edd48a4b1558b504f84eaf604300381b5f371672,2,1
// we want to 1-based,edd48a4b1558b504f84eaf604300381b5f371672,2,1
"String kind = mandatoryAttributeValue(attributeMap, ""kind"");",edd48a4b1558b504f84eaf604300381b5f371672,2,1
"String camelComponentName = optionalAttributeValue(attributeMap, ""componentName"");",edd48a4b1558b504f84eaf604300381b5f371672,2,1
"String endpointInstanceName = optionalAttributeValue(attributeMap, ""instanceName"");",edd48a4b1558b504f84eaf604300381b5f371672,2,1
"String mode = mandatoryAttributeValue(attributeMap, ""mode"");",edd48a4b1558b504f84eaf604300381b5f371672,2,1
"String xml = mandatoryAttributeValue(attributeMap, ""xml"");",edd48a4b1558b504f84eaf604300381b5f371672,2,1
// edit mode includes the existing uri and line number,edd48a4b1558b504f84eaf604300381b5f371672,2,1
String lineNumber = null;,edd48a4b1558b504f84eaf604300381b5f371672,2,1
String endpointUrl = null;,edd48a4b1558b504f84eaf604300381b5f371672,2,1
// since this is XML we need to escape & as &amp;,edd48a4b1558b504f84eaf604300381b5f371672,2,1
Project project = getSelectedProject(context);,edd48a4b1558b504f84eaf604300381b5f371672,2,1
ResourcesFacet facet = project.getFacet(ResourcesFacet.class);,edd48a4b1558b504f84eaf604300381b5f371672,2,1
if (core == null) {,edd48a4b1558b504f84eaf604300381b5f371672,2,1
"Result result = loadCamelComponentDetails(camelCatalog, camelComponentName, details);",edd48a4b1558b504f84eaf604300381b5f371672,2,1
"result = ensureCamelArtifactIdAdded(project, details, dependencyInstaller);",edd48a4b1558b504f84eaf604300381b5f371672,2,1
// collect all the options that was set,edd48a4b1558b504f84eaf604300381b5f371672,2,1
String key = input.getName();,edd48a4b1558b504f84eaf604300381b5f371672,2,1
"String uri = camelCatalog.asEndpointUriXml(camelComponentName, options, false);",edd48a4b1558b504f84eaf604300381b5f371672,2,1
if (uri == null) {,edd48a4b1558b504f84eaf604300381b5f371672,2,1
if (file == null || !file.exists()) {,edd48a4b1558b504f84eaf604300381b5f371672,2,1
"// the list is 0-based, and line number is 1-based",edd48a4b1558b504f84eaf604300381b5f371672,2,1
String line = lines.get(idx);,edd48a4b1558b504f84eaf604300381b5f371672,2,1
// and save the file back,edd48a4b1558b504f84eaf604300381b5f371672,2,1
String content = LineNumberHelper.linesToString(lines);,edd48a4b1558b504f84eaf604300381b5f371672,2,1
// The DOM api is so fucking terrible!,edd48a4b1558b504f84eaf604300381b5f371672,2,1
Node camel = camels.item(0);,edd48a4b1558b504f84eaf604300381b5f371672,2,1
"String id = child.getAttributes().getNamedItem(""id"").getNodeValue();",edd48a4b1558b504f84eaf604300381b5f371672,2,1
if (found == null) {,edd48a4b1558b504f84eaf604300381b5f371672,2,1
// empty so use <camelContext> node,edd48a4b1558b504f84eaf604300381b5f371672,2,1
"String line = String.format(""<endpoint id=\""%s\"" uri=\""%s\""/>"", endpointInstanceName, uri);",edd48a4b1558b504f84eaf604300381b5f371672,2,1
"String camelComponentName = mandatoryAttributeValue(attributeMap, ""componentName"");",edd48a4b1558b504f84eaf604300381b5f371672,2,1
"String routeBuilder = mandatoryAttributeValue(attributeMap, ""routeBuilder"");",edd48a4b1558b504f84eaf604300381b5f371672,2,1
JavaSourceFacet facet = project.getFacet(JavaSourceFacet.class);,edd48a4b1558b504f84eaf604300381b5f371672,2,1
"String uri = camelCatalog.asEndpointUri(camelComponentName, options, false);",edd48a4b1558b504f84eaf604300381b5f371672,2,1
if (existing == null || !existing.exists()) {,edd48a4b1558b504f84eaf604300381b5f371672,2,1
// special for CDI as we use different set of annotations,edd48a4b1558b504f84eaf604300381b5f371672,2,1
if (field == null) {,edd48a4b1558b504f84eaf604300381b5f371672,2,1
"boolean cdi = findCamelArtifactDependency(project, ""camel-cdi"") != null;",edd48a4b1558b504f84eaf604300381b5f371672,2,1
// make sure to import what we use,edd48a4b1558b504f84eaf604300381b5f371672,2,1
String code = clazz.toUnformattedString();,edd48a4b1558b504f84eaf604300381b5f371672,2,1
"String endpointUrl = mandatoryAttributeValue(attributeMap, ""endpointUri"");",edd48a4b1558b504f84eaf604300381b5f371672,2,1
String find = Pattern.quote(endpointUrl);,edd48a4b1558b504f84eaf604300381b5f371672,2,1
"public static String mandatoryAttributeValue(Map<Object, Object> attributeMap, String name) {",edd48a4b1558b504f84eaf604300381b5f371672,2,1
Object value = attributeMap.get(name);,edd48a4b1558b504f84eaf604300381b5f371672,2,1
String text = value.toString();,edd48a4b1558b504f84eaf604300381b5f371672,2,1
"public static String optionalAttributeValue(Map<Object, Object> attributeMap, String name) {",edd48a4b1558b504f84eaf604300381b5f371672,2,1
"if (""xml"".equals(kind)) {",edd48a4b1558b504f84eaf604300381b5f371672,1,0
Dependency core = CamelProjectHelper.findCamelCoreDependency(project);,edd48a4b1558b504f84eaf604300381b5f371672,1,0
"return Results.fail(""The project does not include camel-core"");",edd48a4b1558b504f84eaf604300381b5f371672,1,0
CamelComponentDetails details = new CamelComponentDetails();,edd48a4b1558b504f84eaf604300381b5f371672,1,0
// and make sure its dependency is added,edd48a4b1558b504f84eaf604300381b5f371672,1,0
"Map<String, String> options = new HashMap<String, String>();",edd48a4b1558b504f84eaf604300381b5f371672,1,0
if (input.hasValue()) {,edd48a4b1558b504f84eaf604300381b5f371672,1,0
JavaResource existing = facet.getJavaResource(routeBuilder);,edd48a4b1558b504f84eaf604300381b5f371672,1,0
JavaClassSource clazz = existing.getJavaType();,edd48a4b1558b504f84eaf604300381b5f371672,1,0
"MethodSource configure = clazz.getMethod(""configure"");",edd48a4b1558b504f84eaf604300381b5f371672,1,0
StringBuilder sb = new StringBuilder(body);,edd48a4b1558b504f84eaf604300381b5f371672,1,0
body = sb.toString();,edd48a4b1558b504f84eaf604300381b5f371672,1,0
// update source code,edd48a4b1558b504f84eaf604300381b5f371672,1,0
// TODO: implement me,edd48a4b1558b504f84eaf604300381b5f371672,1,0
Dependency core = CamelProjectHelper.findCamelCoreDependency(project);,edd48a4b1558b504f84eaf604300381b5f371672,1,1
"return Results.fail(""The project does not include camel-core"");",edd48a4b1558b504f84eaf604300381b5f371672,1,1
CamelComponentDetails details = new CamelComponentDetails();,edd48a4b1558b504f84eaf604300381b5f371672,1,1
// and make sure its dependency is added,edd48a4b1558b504f84eaf604300381b5f371672,1,1
"Map<String, String> options = new HashMap<String, String>();",edd48a4b1558b504f84eaf604300381b5f371672,1,1
if (input.hasValue()) {,edd48a4b1558b504f84eaf604300381b5f371672,1,1
JavaResource existing = facet.getJavaResource(routeBuilder);,edd48a4b1558b504f84eaf604300381b5f371672,1,1
JavaClassSource clazz = existing.getJavaType();,edd48a4b1558b504f84eaf604300381b5f371672,1,1
"MethodSource configure = clazz.getMethod(""configure"");",edd48a4b1558b504f84eaf604300381b5f371672,1,1
StringBuilder sb = new StringBuilder(body);,edd48a4b1558b504f84eaf604300381b5f371672,1,1
body = sb.toString();,edd48a4b1558b504f84eaf604300381b5f371672,1,1
// update source code,edd48a4b1558b504f84eaf604300381b5f371672,1,1
"boolean matchDefault = isDefaultValue(camelComponentName, key, value);",edd48a4b1558b504f84eaf604300381b5f371672,1,0
if (!matchDefault) {,edd48a4b1558b504f84eaf604300381b5f371672,1,0
} else if (input.isRequired() && input.hasDefaultValue()) {,edd48a4b1558b504f84eaf604300381b5f371672,1,0
boolean updated = true;,edd48a4b1558b504f84eaf604300381b5f371672,1,0
FieldSource field = clazz.getField(endpointInstanceName);,edd48a4b1558b504f84eaf604300381b5f371672,1,0
field = clazz.addField();,edd48a4b1558b504f84eaf604300381b5f371672,1,0
updated = false;,edd48a4b1558b504f84eaf604300381b5f371672,1,0
if (cdi) {,edd48a4b1558b504f84eaf604300381b5f371672,1,0
"annotation = field.getAnnotation(""org.apache.camel.cdi.Uri"");",edd48a4b1558b504f84eaf604300381b5f371672,1,0
"if (!field.hasAnnotation(""javax.inject.Inject"")) {",edd48a4b1558b504f84eaf604300381b5f371672,1,0
"annotation = field.addAnnotation(""org.apache.camel.cdi.Uri"");",edd48a4b1558b504f84eaf604300381b5f371672,1,0
"annotation = field.getAnnotation(""org.apache.camel.EndpointInject"");",edd48a4b1558b504f84eaf604300381b5f371672,1,0
if (updated) {,edd48a4b1558b504f84eaf604300381b5f371672,1,0
"MethodSource configure = clazz.getMethod(""configure"");",edd48a4b1558b504f84eaf604300381b5f371672,1,1
"body = """";",edd48a4b1558b504f84eaf604300381b5f371672,1,1
List<String> lines = LineNumberHelper.readLines(new StringReader(body));,edd48a4b1558b504f84eaf604300381b5f371672,1,1
int index = -1;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
for (int i = 0; i < lines.size(); i++) {,edd48a4b1558b504f84eaf604300381b5f371672,1,1
if (line.trim().startsWith(match)) {,edd48a4b1558b504f84eaf604300381b5f371672,1,1
index = i;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
if (index == -1) {,edd48a4b1558b504f84eaf604300381b5f371672,1,1
// add new line in top,edd48a4b1558b504f84eaf604300381b5f371672,1,1
// update existing,edd48a4b1558b504f84eaf604300381b5f371672,1,1
// update source code,edd48a4b1558b504f84eaf604300381b5f371672,1,1
"*  Red Hat licenses this file to you under the Apache License, version",edd48a4b1558b504f84eaf604300381b5f371672,1,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",edd48a4b1558b504f84eaf604300381b5f371672,1,1
*  permissions and limitations under the License.,edd48a4b1558b504f84eaf604300381b5f371672,1,1
private final String componentName;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
private final String group;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
this.projectFactory = projectFactory;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
this.dependencyInstaller = dependencyInstaller;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
this.camelCatalog = camelCatalog;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
this.componentName = componentName;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
this.group = group;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
this.allInputs = allInputs;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
this.inputs = inputs;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
this.last = last;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
this.index = index + 1;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
this.total = total;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
"Map<Object, Object> attributeMap = context.getUIContext().getAttributeMap();",edd48a4b1558b504f84eaf604300381b5f371672,1,1
if (last) {,edd48a4b1558b504f84eaf604300381b5f371672,1,1
"if (""xml"".equals(kind)) {",edd48a4b1558b504f84eaf604300381b5f371672,1,1
"if (""edit"".equals(mode)) {",edd48a4b1558b504f84eaf604300381b5f371672,1,1
"lineNumber = mandatoryAttributeValue(attributeMap, ""lineNumber"");",edd48a4b1558b504f84eaf604300381b5f371672,1,1
"endpointUrl = mandatoryAttributeValue(attributeMap, ""endpointUri"");",edd48a4b1558b504f84eaf604300381b5f371672,1,1
"endpointUrl = StringHelper.replaceAll(endpointUrl, ""&amp;"", ""&"");",edd48a4b1558b504f84eaf604300381b5f371672,1,1
"endpointUrl = StringHelper.replaceAll(endpointUrl, ""&"", ""&amp;"");",edd48a4b1558b504f84eaf604300381b5f371672,1,1
"endpointUrl = StringHelper.replaceAll(endpointUrl, ""<"", ""&lt;"");",edd48a4b1558b504f84eaf604300381b5f371672,1,1
"endpointUrl = StringHelper.replaceAll(endpointUrl, "">"", ""&gt;"");",edd48a4b1558b504f84eaf604300381b5f371672,1,1
WebResourcesFacet webResourcesFacet = null;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
if (project.hasFacet(WebResourcesFacet.class)) {,edd48a4b1558b504f84eaf604300381b5f371672,1,1
webResourcesFacet = project.getFacet(WebResourcesFacet.class);,edd48a4b1558b504f84eaf604300381b5f371672,1,1
Dependency core = CamelProjectHelper.findCamelCoreDependency(project);,edd48a4b1558b504f84eaf604300381b5f371672,1,1
"return Results.fail(""The project does not include camel-core"");",edd48a4b1558b504f84eaf604300381b5f371672,1,1
CamelComponentDetails details = new CamelComponentDetails();,edd48a4b1558b504f84eaf604300381b5f371672,1,1
// and make sure its dependency is added,edd48a4b1558b504f84eaf604300381b5f371672,1,1
"Map<String, String> options = new HashMap<String, String>();",edd48a4b1558b504f84eaf604300381b5f371672,1,1
if (input.hasValue()) {,edd48a4b1558b504f84eaf604300381b5f371672,1,1
"boolean matchDefault = isDefaultValue(camelCatalog, camelComponentName, key, value);",edd48a4b1558b504f84eaf604300381b5f371672,1,1
if (!matchDefault) {,edd48a4b1558b504f84eaf604300381b5f371672,1,1
} else if (input.isRequired() && input.hasDefaultValue()) {,edd48a4b1558b504f84eaf604300381b5f371672,1,1
List<String> lines = LineNumberHelper.readLines(file.getResourceInputStream());,edd48a4b1558b504f84eaf604300381b5f371672,1,1
Document root = XmlLineNumberParser.parseXml(file.getResourceInputStream());,edd48a4b1558b504f84eaf604300381b5f371672,1,1
int idx = Integer.valueOf(lineNumber) - 1;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
"line = StringHelper.replaceAll(line, endpointUrl, uri);",edd48a4b1558b504f84eaf604300381b5f371672,1,1
String lineNumber;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
"NodeList camels = root.getElementsByTagName(""camelContext"");",edd48a4b1558b504f84eaf604300381b5f371672,1,1
// TODO: what about 2+ camel's ?,edd48a4b1558b504f84eaf604300381b5f371672,1,1
Node camelContext = null;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
boolean created = false;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
// find existing by id,edd48a4b1558b504f84eaf604300381b5f371672,1,1
Node found = null;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
for (int i = 0; i < camel.getChildNodes().getLength(); i++) {,edd48a4b1558b504f84eaf604300381b5f371672,1,1
"if (""camelContext"".equals(camel.getNodeName())) {",edd48a4b1558b504f84eaf604300381b5f371672,1,1
camelContext = camel;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
Node child = camel.getChildNodes().item(i);,edd48a4b1558b504f84eaf604300381b5f371672,1,1
"if (""camelContext"".equals(child.getNodeName())) {",edd48a4b1558b504f84eaf604300381b5f371672,1,1
camelContext = child;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
"if (""endpoint"".equals(child.getNodeName())) {",edd48a4b1558b504f84eaf604300381b5f371672,1,1
if (endpointInstanceName.equals(id)) {,edd48a4b1558b504f84eaf604300381b5f371672,1,1
found = child;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
int extraSpaces = 0;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
int extraLines = 0;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
created = true;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
found = insertEndpointBefore(camel);,edd48a4b1558b504f84eaf604300381b5f371672,1,1
found = camelContext;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
extraSpaces = 2;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
extraLines = 1;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
lineNumber = (String) found.getUserData(XmlLineNumberParser.LINE_NUMBER);,edd48a4b1558b504f84eaf604300381b5f371672,1,1
"int spaces = LineNumberHelper.leadingSpaces(lines, idx) + extraSpaces;",edd48a4b1558b504f84eaf604300381b5f371672,1,1
"line = LineNumberHelper.padString(line, spaces);",edd48a4b1558b504f84eaf604300381b5f371672,1,1
if (created) {,edd48a4b1558b504f84eaf604300381b5f371672,1,1
JavaResource existing = facet.getJavaResource(routeBuilder);,edd48a4b1558b504f84eaf604300381b5f371672,1,1
JavaClassSource clazz = existing.getJavaType();,edd48a4b1558b504f84eaf604300381b5f371672,1,1
boolean updated = true;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
FieldSource field = clazz.getField(endpointInstanceName);,edd48a4b1558b504f84eaf604300381b5f371672,1,1
field = clazz.addField();,edd48a4b1558b504f84eaf604300381b5f371672,1,1
updated = false;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
if (cdi) {,edd48a4b1558b504f84eaf604300381b5f371672,1,1
// cdi uses @Inject @Uri,edd48a4b1558b504f84eaf604300381b5f371672,1,1
"if (!field.hasAnnotation(""javax.inject.Inject"")) {",edd48a4b1558b504f84eaf604300381b5f371672,1,1
"if (!field.hasAnnotation(""org.apache.camel.cdi.Uri"")) {",edd48a4b1558b504f84eaf604300381b5f371672,1,1
"annotation = field.getAnnotation(""org.apache.camel.cdi.Uri"");",edd48a4b1558b504f84eaf604300381b5f371672,1,1
"if (!field.hasAnnotation(""org.apache.camel.EndpointInject"")) {",edd48a4b1558b504f84eaf604300381b5f371672,1,1
"annotation = field.getAnnotation(""org.apache.camel.EndpointInject"");",edd48a4b1558b504f84eaf604300381b5f371672,1,1
if (updated) {,edd48a4b1558b504f84eaf604300381b5f371672,1,1
MethodSource<JavaClassSource> method = CamelJavaParserHelper.findConfigureMethod(clazz);,edd48a4b1558b504f84eaf604300381b5f371672,1,1
"code = code.replaceFirst(find, uri);",edd48a4b1558b504f84eaf604300381b5f371672,1,1
// use this code currently to save content unformatted,edd48a4b1558b504f84eaf604300381b5f371672,1,1
Node endpoint = null;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
Node found = camel.getChildNodes().item(i);,edd48a4b1558b504f84eaf604300381b5f371672,1,1
"if (""endpoint"".equals(name)) {",edd48a4b1558b504f84eaf604300381b5f371672,1,1
endpoint = found;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
Node last = null;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
"if (""dataFormats"".equals(name) || ""redeliveryPolicyProfile"".equals(name)",edd48a4b1558b504f84eaf604300381b5f371672,1,1
if (found.getNodeType() == Node.ELEMENT_NODE) {,edd48a4b1558b504f84eaf604300381b5f371672,1,1
last = found;,edd48a4b1558b504f84eaf604300381b5f371672,1,1
if (!Strings.isBlank(text)) {,edd48a4b1558b504f84eaf604300381b5f371672,1,1
"return executeXml(context, attributeMap);",edd48a4b1558b504f84eaf604300381b5f371672,0,0
} else {,edd48a4b1558b504f84eaf604300381b5f371672,0,0
"return executeJava(context, attributeMap);",edd48a4b1558b504f84eaf604300381b5f371672,0,0
},edd48a4b1558b504f84eaf604300381b5f371672,0,0
"protected Result executeJava(UIExecutionContext context, Map<Object, Object> attributeMap) throws Exception {",edd48a4b1558b504f84eaf604300381b5f371672,0,0
return result;,edd48a4b1558b504f84eaf604300381b5f371672,0,0
for (InputComponent input : inputs) {,edd48a4b1558b504f84eaf604300381b5f371672,0,0
"options.put(key, value);",edd48a4b1558b504f84eaf604300381b5f371672,0,0
"return Results.fail(""RouteBuilder "" + routeBuilder + "" does not exist"");",edd48a4b1558b504f84eaf604300381b5f371672,0,0
"clazz.addImport(""org.apache.camel.Endpoint"");",edd48a4b1558b504f84eaf604300381b5f371672,0,0
"sb.insert(0, line);",edd48a4b1558b504f84eaf604300381b5f371672,0,0
configure.setBody(body);,edd48a4b1558b504f84eaf604300381b5f371672,0,0
facet.saveJavaSource(clazz);,edd48a4b1558b504f84eaf604300381b5f371672,0,0
"return Results.success(""Added endpoint "" + endpointInstanceName + "" to "" + routeBuilder);",edd48a4b1558b504f84eaf604300381b5f371672,0,0
"protected Result executeXml(UIExecutionContext context, Map<Object, Object> attributeMap) throws Exception {",edd48a4b1558b504f84eaf604300381b5f371672,0,0
"return Results.success(""Added endpoint "" + endpointInstanceName + "" to "" + xml);",edd48a4b1558b504f84eaf604300381b5f371672,0,0
try {,edd48a4b1558b504f84eaf604300381b5f371672,0,1
},edd48a4b1558b504f84eaf604300381b5f371672,0,1
return result;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
for (InputComponent input : inputs) {,edd48a4b1558b504f84eaf604300381b5f371672,0,1
"options.put(key, value);",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"return Results.fail(""RouteBuilder "" + routeBuilder + "" does not exist"");",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"clazz.addImport(""org.apache.camel.Endpoint"");",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"sb.insert(0, line);",edd48a4b1558b504f84eaf604300381b5f371672,0,1
configure.setBody(body);,edd48a4b1558b504f84eaf604300381b5f371672,0,1
facet.saveJavaSource(clazz);,edd48a4b1558b504f84eaf604300381b5f371672,0,1
"return Results.success(""Added endpoint "" + endpointInstanceName + "" to "" + routeBuilder);",edd48a4b1558b504f84eaf604300381b5f371672,0,1
} catch (IllegalArgumentException e) {,edd48a4b1558b504f84eaf604300381b5f371672,0,1
return Results.fail(e.getMessage());,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.roaster.model.source.AnnotationSource;,edd48a4b1558b504f84eaf604300381b5f371672,0,0
import org.jboss.forge.roaster.model.source.FieldSource;,edd48a4b1558b504f84eaf604300381b5f371672,0,0
import static io.fabric8.forge.addon.utils.CamelProjectHelper.findCamelArtifactDependency;,edd48a4b1558b504f84eaf604300381b5f371672,0,0
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.isDefaultValue;,edd48a4b1558b504f84eaf604300381b5f371672,0,0
"""Camel: Add Endpoint"").category(Categories.create(CATEGORY))",edd48a4b1558b504f84eaf604300381b5f371672,0,0
"options.put(key, value);",edd48a4b1558b504f84eaf604300381b5f371672,0,0
},edd48a4b1558b504f84eaf604300381b5f371672,0,0
AnnotationSource annotation;,edd48a4b1558b504f84eaf604300381b5f371672,0,0
field.setName(endpointInstanceName);,edd48a4b1558b504f84eaf604300381b5f371672,0,0
"field.setType(""org.apache.camel.Endpoint"");",edd48a4b1558b504f84eaf604300381b5f371672,0,0
field.setPrivate();,edd48a4b1558b504f84eaf604300381b5f371672,0,0
"field.addAnnotation(""javax.inject.Inject"");",edd48a4b1558b504f84eaf604300381b5f371672,0,0
} else {,edd48a4b1558b504f84eaf604300381b5f371672,0,0
annotation.removeAllValues();,edd48a4b1558b504f84eaf604300381b5f371672,0,0
annotation.setStringValue(uri);,edd48a4b1558b504f84eaf604300381b5f371672,0,0
"clazz.addImport(""org.apache.camel.Endpoint"");",edd48a4b1558b504f84eaf604300381b5f371672,0,0
"clazz.addImport(""javax.inject.Inject"");",edd48a4b1558b504f84eaf604300381b5f371672,0,0
"clazz.addImport(""org.apache.camel.cdi.Uri"");",edd48a4b1558b504f84eaf604300381b5f371672,0,0
"clazz.addImport(""org.apache.camel.EndpointInject"");",edd48a4b1558b504f84eaf604300381b5f371672,0,0
"""Camel: Add Endpoint XML"").category(Categories.create(CATEGORY))",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"clazz.addImport(""org.apache.camel.Endpoint"");",edd48a4b1558b504f84eaf604300381b5f371672,0,1
break;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
"lines.add(0, line);",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"lines.set(index, line);",edd48a4b1558b504f84eaf604300381b5f371672,0,1
configure.setBody(content);,edd48a4b1558b504f84eaf604300381b5f371672,0,1
/**,edd48a4b1558b504f84eaf604300381b5f371672,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",edd48a4b1558b504f84eaf604300381b5f371672,0,1
*,edd48a4b1558b504f84eaf604300381b5f371672,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",edd48a4b1558b504f84eaf604300381b5f371672,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,edd48a4b1558b504f84eaf604300381b5f371672,0,1
"*  Unless required by applicable law or agreed to in writing, software",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",edd48a4b1558b504f84eaf604300381b5f371672,0,1
*/,edd48a4b1558b504f84eaf604300381b5f371672,0,1
package io.fabric8.forge.camel.commands.project;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import java.io.ByteArrayInputStream;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import java.util.HashMap;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import java.util.List;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import java.util.Map;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import java.util.regex.Pattern;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import javax.inject.Inject;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import io.fabric8.forge.addon.utils.CamelProjectHelper;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import io.fabric8.forge.addon.utils.LineNumberHelper;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import io.fabric8.forge.addon.utils.XmlLineNumberParser;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import io.fabric8.forge.camel.commands.project.helper.CamelJavaParserHelper;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import io.fabric8.forge.camel.commands.project.helper.StringHelper;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import io.fabric8.forge.camel.commands.project.model.CamelComponentDetails;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.apache.camel.catalog.CamelCatalog;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.addon.dependencies.Dependency;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.addon.parser.java.facets.JavaSourceFacet;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.addon.parser.java.resources.JavaResource;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.addon.projects.Project;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.addon.projects.ProjectFactory;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.addon.projects.facets.WebResourcesFacet;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.addon.resource.FileResource;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.addon.ui.context.UIContext;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.addon.ui.context.UINavigationContext;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.addon.ui.input.InputComponent;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.addon.ui.result.NavigationResult;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.addon.ui.result.Result;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.addon.ui.result.Results;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.addon.ui.util.Categories;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.addon.ui.util.Metadata;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.addon.ui.wizard.UIWizardStep;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.roaster.model.source.AnnotationSource;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.roaster.model.source.FieldSource;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.roaster.model.source.JavaClassSource;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.roaster.model.source.MethodSource;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.jboss.forge.roaster.model.util.Strings;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.w3c.dom.Document;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.w3c.dom.Node;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import org.w3c.dom.NodeList;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import static io.fabric8.forge.addon.utils.CamelProjectHelper.findCamelArtifactDependency;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.isDefaultValue;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper.ensureCamelArtifactIdAdded;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper.loadCamelComponentDetails;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
public class ConfigureEndpointPropertiesStep extends AbstractCamelProjectCommand implements UIWizardStep {,edd48a4b1558b504f84eaf604300381b5f371672,0,1
private final DependencyInstaller dependencyInstaller;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
private final CamelCatalog camelCatalog;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
private final List<InputComponent> allInputs;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
private final List<InputComponent> inputs;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
private final boolean last;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
private final int index;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
private final int total;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
"public ConfigureEndpointPropertiesStep(ProjectFactory projectFactory,",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"DependencyInstaller dependencyInstaller,",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"CamelCatalog camelCatalog,",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"List<InputComponent> allInputs,",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"List<InputComponent> inputs,",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"boolean last, int index, int total) {",edd48a4b1558b504f84eaf604300381b5f371672,0,1
},edd48a4b1558b504f84eaf604300381b5f371672,0,1
@Override,edd48a4b1558b504f84eaf604300381b5f371672,0,1
public UICommandMetadata getMetadata(UIContext context) {,edd48a4b1558b504f84eaf604300381b5f371672,0,1
return Metadata.forCommand(ConfigureEndpointPropertiesStep.class).name(,edd48a4b1558b504f84eaf604300381b5f371672,0,1
"""Camel: Endpoint options"").category(Categories.create(CATEGORY))",edd48a4b1558b504f84eaf604300381b5f371672,0,1
".description(String.format(""Configure %s options (%s of %s)"", group, index, total));",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"@SuppressWarnings(""unchecked"")",edd48a4b1558b504f84eaf604300381b5f371672,0,1
public void initializeUI(UIBuilder builder) throws Exception {,edd48a4b1558b504f84eaf604300381b5f371672,0,1
for (InputComponent input : inputs) {,edd48a4b1558b504f84eaf604300381b5f371672,0,1
builder.add(input);,edd48a4b1558b504f84eaf604300381b5f371672,0,1
public NavigationResult next(UINavigationContext context) throws Exception {,edd48a4b1558b504f84eaf604300381b5f371672,0,1
return null;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
public Result execute(UIExecutionContext context) throws Exception {,edd48a4b1558b504f84eaf604300381b5f371672,0,1
"return executeXml(context, attributeMap);",edd48a4b1558b504f84eaf604300381b5f371672,0,1
} else {,edd48a4b1558b504f84eaf604300381b5f371672,0,1
"return executeJava(context, attributeMap);",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"protected Result executeXml(UIExecutionContext context, Map<Object, Object> attributeMap) throws Exception {",edd48a4b1558b504f84eaf604300381b5f371672,0,1
return result;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
for (InputComponent input : allInputs) {,edd48a4b1558b504f84eaf604300381b5f371672,0,1
"options.put(key, value);",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"return Results.fail(""Cannot create endpoint uri"");",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"return Results.fail(""Cannot find XML file "" + xml);",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"return editEndpointXml(lines, lineNumber, endpointUrl, uri, file, xml);",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"return addEndpointXml(root, endpointInstanceName, uri, file, xml);",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"lines.set(idx, line);",edd48a4b1558b504f84eaf604300381b5f371672,0,1
file.setContents(content);,edd48a4b1558b504f84eaf604300381b5f371672,0,1
"return Results.success(""Update endpoint uri: "" + uri + "" in file "" + xml);",edd48a4b1558b504f84eaf604300381b5f371672,0,1
break;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
"return Results.fail(""Cannot find <camelContext> in XML file "" + xml);",edd48a4b1558b504f84eaf604300381b5f371672,0,1
idx += extraLines;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
"lines.add(idx, line);",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"return Results.success(""Added endpoint uri: "" + uri + "" in XML file "" + xml);",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"protected Result executeJava(UIExecutionContext context, Map<Object, Object> attributeMap) throws Exception {",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"return Results.fail(""RouteBuilder "" + routeBuilder + "" does not exist"");",edd48a4b1558b504f84eaf604300381b5f371672,0,1
AnnotationSource annotation;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
field.setName(endpointInstanceName);,edd48a4b1558b504f84eaf604300381b5f371672,0,1
"field.setType(""org.apache.camel.Endpoint"");",edd48a4b1558b504f84eaf604300381b5f371672,0,1
field.setPrivate();,edd48a4b1558b504f84eaf604300381b5f371672,0,1
"field.addAnnotation(""javax.inject.Inject"");",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"field.addAnnotation(""org.apache.camel.cdi.Uri"");",edd48a4b1558b504f84eaf604300381b5f371672,0,1
annotation.setStringValue(uri);,edd48a4b1558b504f84eaf604300381b5f371672,0,1
"field.addAnnotation(""org.apache.camel.EndpointInject"");",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"annotation.setStringValue(""uri"", uri);",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"clazz.addImport(""org.apache.camel.Endpoint"");",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"clazz.addImport(""javax.inject.Inject"");",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"clazz.addImport(""org.apache.camel.cdi.Uri"");",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"clazz.addImport(""org.apache.camel.EndpointInject"");",edd48a4b1558b504f84eaf604300381b5f371672,0,1
facet.saveJavaSource(clazz);,edd48a4b1558b504f84eaf604300381b5f371672,0,1
"return Results.success(""Updated endpoint "" + endpointInstanceName + "" in "" + routeBuilder);",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"return Results.success(""Added endpoint "" + endpointInstanceName + "" in "" + routeBuilder);",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"existing.setContents(new ByteArrayInputStream(code.getBytes()), null);",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"return Results.success(""Updated endpoint "" + endpointUrl + "" -> "" + uri + "" in "" + routeBuilder);",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"return Results.fail(""Cannot update endpoint"");",edd48a4b1558b504f84eaf604300381b5f371672,0,1
private Node insertEndpointBefore(Node camel) {,edd48a4b1558b504f84eaf604300381b5f371672,0,1
return endpoint;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
"|| ""onException"".equals(name) || ""onCompletion"".equals(name)",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"|| ""intercept"".equals(name) || ""interceptFrom"".equals(name)",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"|| ""interceptSendToEndpoint"".equals(name) || ""restConfiguration"".equals(name)",edd48a4b1558b504f84eaf604300381b5f371672,0,1
"|| ""rest"".equals(name) || ""route"".equals(name)) {",edd48a4b1558b504f84eaf604300381b5f371672,0,1
return found;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
return last;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
return text;,edd48a4b1558b504f84eaf604300381b5f371672,0,1
"public static boolean isDefaultValue(CamelCatalog camelCatalog, String scheme, String key, String value) {",18a095c429860840b16cfbe760cb38a8b0947070,5,1
// lets find the camel component class,18a095c429860840b16cfbe760cb38a8b0947070,4,1
// lets find the camel component class,18a095c429860840b16cfbe760cb38a8b0947070,4,1
"private Result editEndpointXml(List<String> lines, String lineNumber, String endpointUrl, String uri, FileResource file, String xml) {",18a095c429860840b16cfbe760cb38a8b0947070,4,1
"public static void createCdiComponentProducerClass(JavaClassSource javaClass, CamelComponentDetails details, String camelComponentName, String componentInstanceName, String configurationCode) {",18a095c429860840b16cfbe760cb38a8b0947070,4,1
"public static void createSpringComponentFactoryClass(JavaClassSource javaClass, CamelComponentDetails details, String camelComponentName, String componentInstanceName, String configurationCode) {",18a095c429860840b16cfbe760cb38a8b0947070,4,1
"public static List<EndpointOptionByGroup> createUIInputsForCamelComponent(String camelComponentName, String uri, int maxOptionsPerPage, boolean consumerOnly, boolean producerOnly,",18a095c429860840b16cfbe760cb38a8b0947070,4,1
public class CamelAddComponentCommand extends AbstractCamelProjectCommand {,18a095c429860840b16cfbe760cb38a8b0947070,3,1
".description(""Adds a Camel component to your project dependencies"");",18a095c429860840b16cfbe760cb38a8b0947070,3,1
public class CamelAddDataFormatCommand extends AbstractCamelProjectCommand {,18a095c429860840b16cfbe760cb38a8b0947070,3,1
public class CamelAddEndpointCommand extends AbstractCamelProjectCommand implements UIWizard {,18a095c429860840b16cfbe760cb38a8b0947070,3,1
if (previous != null && previous.equals(camelComponentName) && previous2 != null && previous2.equals(endpointType.getValue())) {,18a095c429860840b16cfbe760cb38a8b0947070,3,1
public class CamelAddLanguageCommand extends AbstractCamelProjectCommand {,18a095c429860840b16cfbe760cb38a8b0947070,3,1
public class CamelNewBlueprintXmlCommand extends AbstractCamelProjectCommand {,18a095c429860840b16cfbe760cb38a8b0947070,3,1
public class CamelNewComponentInstanceCDICommand extends AbstractCamelProjectCommand implements UIWizard {,18a095c429860840b16cfbe760cb38a8b0947070,3,1
public class CamelNewComponentInstanceSpringCommand extends AbstractCamelProjectCommand implements UIWizard {,18a095c429860840b16cfbe760cb38a8b0947070,3,1
"@WithAttributes(label = ""Class Name"", required = true, description = ""Name of the Spring Component class to generate"")",18a095c429860840b16cfbe760cb38a8b0947070,3,1
public class CamelNewSpringXmlCommand extends AbstractCamelProjectCommand {,18a095c429860840b16cfbe760cb38a8b0947070,3,1
public class ConfigureComponentPropertiesStep extends AbstractCamelProjectCommand implements UIWizardStep {,18a095c429860840b16cfbe760cb38a8b0947070,3,1
"public static String mandatoryAttributeValue(Map<Object, Object> attributeMap, String name) {",18a095c429860840b16cfbe760cb38a8b0947070,3,1
public class ConfigureEndpointPropertiesStep extends AbstractCamelProjectCommand implements UIWizardStep {,18a095c429860840b16cfbe760cb38a8b0947070,3,1
"private Result addEndpointXml(Document root, String endpointInstanceName, String uri, FileResource file, String xml) throws Exception {",18a095c429860840b16cfbe760cb38a8b0947070,3,1
"public static String mandatoryAttributeValue(Map<Object, Object> attributeMap, String name) {",18a095c429860840b16cfbe760cb38a8b0947070,3,1
"public static String optionalAttributeValue(Map<Object, Object> attributeMap, String name) {",18a095c429860840b16cfbe760cb38a8b0947070,3,1
// use the camel catalog to find what components the artifact has,18a095c429860840b16cfbe760cb38a8b0947070,3,1
"public static boolean isComponentConsumerOnly(CamelCatalog camelCatalog, String scheme) {",18a095c429860840b16cfbe760cb38a8b0947070,3,1
"public static boolean isComponentProducerOnly(CamelCatalog camelCatalog, String scheme) {",18a095c429860840b16cfbe760cb38a8b0947070,3,1
"return Results.fail(""Could not find fully qualified class name in catalog for component name: "" + camelComponentName);",18a095c429860840b16cfbe760cb38a8b0947070,3,1
private static Class loadStringSupportedType(String javaType) {,18a095c429860840b16cfbe760cb38a8b0947070,2,0
import static io.fabric8.forge.addon.utils.UIHelper.createUIInput;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.endpointComponentName;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
// lets create a field for each property on the component,18a095c429860840b16cfbe760cb38a8b0947070,2,1
"// either we have an uri from an existing endpoint to edit, or we only have the component name to create a new endpoint",18a095c429860840b16cfbe760cb38a8b0947070,2,1
"throw new IllegalArgumentException(""Could not find catalog entry for component name: "" + camelComponentName);",18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createComponentDto;,18a095c429860840b16cfbe760cb38a8b0947070,2,0
"return Results.success(""Added Camel component "" + dto.getScheme() + "" ("" + dto.getArtifactId() + "") to the project"");",18a095c429860840b16cfbe760cb38a8b0947070,2,0
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.findComponentArchetype;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
"return Results.success(""Added Camel component "" + name.getValue() + "" ("" + artifactId + "") to the project"");",18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createComponentDto;,18a095c429860840b16cfbe760cb38a8b0947070,2,0
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createComponentDto;,18a095c429860840b16cfbe760cb38a8b0947070,2,0
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createComponentDto;,18a095c429860840b16cfbe760cb38a8b0947070,2,0
"throw new IllegalArgumentException(""Could not find catalog entry for component name: "" + camelComponentName);",18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.findDataFormatArchetype;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.findLanguageArchetype;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createComponentDto;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
final Project project = getSelectedProject(builder);,18a095c429860840b16cfbe760cb38a8b0947070,2,1
Project project = getSelectedProject(context);,18a095c429860840b16cfbe760cb38a8b0947070,2,1
// we want to use same version as camel-core if its a camel component,18a095c429860840b16cfbe760cb38a8b0947070,2,1
"return Results.success(""Added Camel component "" + dto.getScheme() + "" ("" + dto.getArtifactId() + "") to the project"");",18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createDataFormatDto;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
".description(""Adds a Camel dataformat to your project dependencies"");",18a095c429860840b16cfbe760cb38a8b0947070,2,1
Project project = getSelectedProject(builder);,18a095c429860840b16cfbe760cb38a8b0947070,2,1
Project project = getSelectedProject(context);,18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createComponentDto;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper.createUIInputsForCamelComponent;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
Project project = getSelectedProject(builder.getUIContext());,18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createLanguageDto;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
".description(""Adds a Camel language to your project dependencies"");",18a095c429860840b16cfbe760cb38a8b0947070,2,1
Project project = getSelectedProject(builder);,18a095c429860840b16cfbe760cb38a8b0947070,2,1
Project project = getSelectedProject(context);,18a095c429860840b16cfbe760cb38a8b0947070,2,1
Project project = getSelectedProject(context);,18a095c429860840b16cfbe760cb38a8b0947070,2,1
// not enable for cdi or spring projects,18a095c429860840b16cfbe760cb38a8b0947070,2,1
boolean cdi = CamelCommandsHelper.isCdiProject(project);,18a095c429860840b16cfbe760cb38a8b0947070,2,1
boolean spring = CamelCommandsHelper.isSpringProject(project);,18a095c429860840b16cfbe760cb38a8b0947070,2,1
// create the new file and set the content,18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createComponentDto;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
".description(""Creates a new Camel component instance configuration using CDI"");",18a095c429860840b16cfbe760cb38a8b0947070,2,1
Project project = getSelectedProject(builder.getUIContext());,18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createComponentDto;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
".description(""Creates a new Camel component instance configuration using Spring"");",18a095c429860840b16cfbe760cb38a8b0947070,2,1
Project project = getSelectedProject(builder.getUIContext());,18a095c429860840b16cfbe760cb38a8b0947070,2,1
Project project = getSelectedProject(context);,18a095c429860840b16cfbe760cb38a8b0947070,2,1
// not enable for cdi or blueprint projects,18a095c429860840b16cfbe760cb38a8b0947070,2,1
boolean cdi = CamelCommandsHelper.isCdiProject(project);,18a095c429860840b16cfbe760cb38a8b0947070,2,1
boolean blueprint = CamelCommandsHelper.isBlueprintProject(project);,18a095c429860840b16cfbe760cb38a8b0947070,2,1
// create the new file and set the content,18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.addon.utils.UIHelper.createUIInput;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper.ensureCamelArtifactIdAdded;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper.loadCamelComponentDetails;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper.loadValidInputTypes;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
// lets create a field for each property on the component,18a095c429860840b16cfbe760cb38a8b0947070,2,1
"throw new IllegalArgumentException(""Could not find catalog entry for component name: "" + camelComponentName);",18a095c429860840b16cfbe760cb38a8b0947070,2,1
Project project = getSelectedProject(context);,18a095c429860840b16cfbe760cb38a8b0947070,2,1
// need to parse to be able to extends another class,18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.addon.utils.CamelProjectHelper.findCamelArtifactDependency;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.isDefaultValue;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper.ensureCamelArtifactIdAdded;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper.loadCamelComponentDetails;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
"String componentName, String group,",18a095c429860840b16cfbe760cb38a8b0947070,2,1
Project project = getSelectedProject(context);,18a095c429860840b16cfbe760cb38a8b0947070,2,1
"boolean cdi = findCamelArtifactDependency(project, ""camel-cdi"") != null;",18a095c429860840b16cfbe760cb38a8b0947070,2,1
String find = Pattern.quote(endpointUrl);,18a095c429860840b16cfbe760cb38a8b0947070,2,1
"* To find the closet node that we need to insert the endpoints before, so the Camel schema is valid.",18a095c429860840b16cfbe760cb38a8b0947070,2,1
"private static final String NAME = ""camel"";",18a095c429860840b16cfbe760cb38a8b0947070,2,1
// need to find camel-core so we known the camel version,18a095c429860840b16cfbe760cb38a8b0947070,2,1
// find all available component labels,18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.addon.utils.CamelProjectHelper.findCamelArtifacts;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createDataFormatDto;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.dataFormatsFromArtifact;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
// need to find camel-core so we known the camel version,18a095c429860840b16cfbe760cb38a8b0947070,2,1
private static String findArtifactId(String json) {,18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.addon.utils.CamelProjectHelper.findCamelArtifacts;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createLanguageDto;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.languagesFromArtifact;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
// need to find camel-core so we known the camel version,18a095c429860840b16cfbe760cb38a8b0947070,2,1
private static String findArtifactId(String json) {,18a095c429860840b16cfbe760cb38a8b0947070,2,1
// find package names in the source code,18a095c429860840b16cfbe760cb38a8b0947070,2,1
public static String asTitleCase(String text) {,18a095c429860840b16cfbe760cb38a8b0947070,2,1
public static String endpointComponentName(String uri) {,18a095c429860840b16cfbe760cb38a8b0947070,2,1
"public static Set<String> componentsFromArtifact(CamelCatalog camelCatalog, String artifactId) {",18a095c429860840b16cfbe760cb38a8b0947070,2,1
"public static Set<String> dataFormatsFromArtifact(CamelCatalog camelCatalog, String artifactId) {",18a095c429860840b16cfbe760cb38a8b0947070,2,1
"public static Set<String> languagesFromArtifact(CamelCatalog camelCatalog, String artifactId) {",18a095c429860840b16cfbe760cb38a8b0947070,2,1
"throw new IllegalArgumentException(""Could not find catalog entry for component name: "" + scheme);",18a095c429860840b16cfbe760cb38a8b0947070,2,1
"public static ComponentDto createComponentDto(CamelCatalog camelCatalog, String scheme) {",18a095c429860840b16cfbe760cb38a8b0947070,2,1
"public static DataFormatDto createDataFormatDto(CamelCatalog camelCatalog, String name) {",18a095c429860840b16cfbe760cb38a8b0947070,2,1
"public static LanguageDto createLanguageDto(CamelCatalog camelCatalog, String name) {",18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.addon.utils.UIHelper.createUIInput;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.endpointComponentName;,18a095c429860840b16cfbe760cb38a8b0947070,2,1
"public static Callable<Iterable<ComponentDto>> createComponentDtoValues(final Project project, final CamelCatalog camelCatalog,",18a095c429860840b16cfbe760cb38a8b0947070,2,1
"public static Result loadCamelComponentDetails(CamelCatalog camelCatalog, String camelComponentName, CamelComponentDetails details) {",18a095c429860840b16cfbe760cb38a8b0947070,2,1
"return Results.fail(""Could not find catalog entry for component name: "" + camelComponentName);",18a095c429860840b16cfbe760cb38a8b0947070,2,1
// we want to use same version as camel-core if its a camel component,18a095c429860840b16cfbe760cb38a8b0947070,2,1
public static boolean isCdiProject(Project project) {,18a095c429860840b16cfbe760cb38a8b0947070,2,1
public static boolean isSpringProject(Project project) {,18a095c429860840b16cfbe760cb38a8b0947070,2,1
public static boolean isBlueprintProject(Project project) {,18a095c429860840b16cfbe760cb38a8b0947070,2,1
"String body = componentClassName + "" component = new "" + componentClassName + ""();"" + configurationCode + ""\nreturn component;"";",18a095c429860840b16cfbe760cb38a8b0947070,2,1
* Converts a java type as a string to a valid input type and returns the class or null if its not supported,18a095c429860840b16cfbe760cb38a8b0947070,2,1
"public static Class<Object> loadValidInputTypes(String javaType, String type) {",18a095c429860840b16cfbe760cb38a8b0947070,2,1
"// its a custom java type so use String as the input type, so you can refer to it using # lookup",18a095c429860840b16cfbe760cb38a8b0947070,2,1
private static Class loadStringSupportedType(String javaType) {,18a095c429860840b16cfbe760cb38a8b0947070,2,1
* @return the primitive Java Class type,18a095c429860840b16cfbe760cb38a8b0947070,2,1
public static Class getPrimitiveWrapperClassType(String name) {,18a095c429860840b16cfbe760cb38a8b0947070,2,1
private static Class loadPrimitiveWrapperType(String name) {,18a095c429860840b16cfbe760cb38a8b0947070,2,1
"throw new IllegalArgumentException(""Could not find catalog entry for component name: "" + camelComponentName);",18a095c429860840b16cfbe760cb38a8b0947070,2,1
import io.fabric8.forge.camel.commands.project.helper.CamelProjectHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.helper.JavaHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.ProjectFactory;,18a095c429860840b16cfbe760cb38a8b0947070,1,0
private final boolean last;,18a095c429860840b16cfbe760cb38a8b0947070,1,0
boolean last) {,18a095c429860840b16cfbe760cb38a8b0947070,1,0
for (InputComponent input : inputs) {,18a095c429860840b16cfbe760cb38a8b0947070,1,0
"String kind = mandatoryAttributeValue(attributeMap, ""kind"");",18a095c429860840b16cfbe760cb38a8b0947070,1,0
for (InputComponent input : allInputs) {,18a095c429860840b16cfbe760cb38a8b0947070,1,0
import java.util.ArrayList;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.Collections;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.HashSet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.Set;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.apache.camel.catalog.JSonSchemaHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.dependencies.DependencyResolver;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.InputComponentFactory;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String camelComponentName = optionalAttributeValue(attributeMap, ""componentName"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String uri = optionalAttributeValue(attributeMap, ""endpointUri"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
if (camelComponentName == null && uri != null) {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String json = catalog.componentJSonSchema(camelComponentName);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""properties"", json, true);",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String name = propertyMap.get(""name"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String kind = propertyMap.get(""kind"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String type = propertyMap.get(""type"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String javaType = propertyMap.get(""javaType"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String deprecated = propertyMap.get(""deprecated"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String required = propertyMap.get(""required"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
String currentValue = currentValues.get(name);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String defaultValue = propertyMap.get(""defaultValue"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String description = propertyMap.get(""description"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String enums = propertyMap.get(""enum"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"InputComponent input = createUIInput(componentFactory, getConverterFactory(), name, inputClazz, required, currentValue, defaultValue, enums, description);",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String kind = mandatoryAttributeValue(attributeMap, ""kind"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
for (InputComponent input : inputs) {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,18a095c429860840b16cfbe760cb38a8b0947070,1,0
import org.jboss.forge.addon.convert.Converter;,18a095c429860840b16cfbe760cb38a8b0947070,1,0
DependencyBuilder component = DependencyBuilder.create().setGroupId(dto.getGroupId()),18a095c429860840b16cfbe760cb38a8b0947070,1,0
// install the component,18a095c429860840b16cfbe760cb38a8b0947070,1,0
"return Results.fail(""Unknown Camel component"");",18a095c429860840b16cfbe760cb38a8b0947070,1,0
String artifactId = findComponentArchetype(name.getValue());,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"return Results.fail(""Camel component "" + name.getValue() + "" is unknown."");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"DependencyBuilder component = DependencyBuilder.create().setGroupId(""org.apache.camel"")",18a095c429860840b16cfbe760cb38a8b0947070,1,1
// install the component,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,18a095c429860840b16cfbe760cb38a8b0947070,1,0
import org.jboss.forge.addon.convert.Converter;,18a095c429860840b16cfbe760cb38a8b0947070,1,0
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,18a095c429860840b16cfbe760cb38a8b0947070,1,0
import org.jboss.forge.addon.convert.Converter;,18a095c429860840b16cfbe760cb38a8b0947070,1,0
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,18a095c429860840b16cfbe760cb38a8b0947070,1,0
import org.jboss.forge.addon.convert.Converter;,18a095c429860840b16cfbe760cb38a8b0947070,1,0
String camelComponentName = componentName.getValue().getScheme();,18a095c429860840b16cfbe760cb38a8b0947070,1,0
import org.apache.camel.catalog.CamelCatalog;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.apache.camel.catalog.DefaultCamelCatalog;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String camelComponentName = componentName.getValue();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String json = catalog.componentJSonSchema(camelComponentName);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.dto.DataFormatDto;,18a095c429860840b16cfbe760cb38a8b0947070,1,0
String description = dataFormat.getDescription();,18a095c429860840b16cfbe760cb38a8b0947070,1,0
DependencyBuilder component = DependencyBuilder.create().setGroupId(dto.getGroupId()),18a095c429860840b16cfbe760cb38a8b0947070,1,0
// install the component,18a095c429860840b16cfbe760cb38a8b0947070,1,0
"return Results.success(""Added Camel dataformat "" + name.getValue().getName() + "" ("" + dto.getArtifactId() + "") to the project"");",18a095c429860840b16cfbe760cb38a8b0947070,1,0
"return Results.fail(""Unknown Camel dataformat"");",18a095c429860840b16cfbe760cb38a8b0947070,1,0
import io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String dataFormat = event.getNewValue() != null ? event.getNewValue().toString() : null;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String description = CamelCatalogHelper.getDataFormatDescription(dataFormat);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String artifactId = findDataFormatArchetype(name.getValue());,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"DependencyBuilder component = DependencyBuilder.create().setGroupId(""org.apache.camel"")",18a095c429860840b16cfbe760cb38a8b0947070,1,1
// install the component,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"return Results.success(""Added Camel dataformat "" + name.getValue() + "" ("" + artifactId + "") to the project"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.dto.LanguageDto;,18a095c429860840b16cfbe760cb38a8b0947070,1,0
String description = language.getDescription();,18a095c429860840b16cfbe760cb38a8b0947070,1,0
DependencyBuilder component = DependencyBuilder.create().setGroupId(dto.getGroupId()),18a095c429860840b16cfbe760cb38a8b0947070,1,0
// install the component,18a095c429860840b16cfbe760cb38a8b0947070,1,0
"return Results.success(""Added Camel language "" + dto.getName() + "" ("" + dto.getArtifactId() + "") to the project"");",18a095c429860840b16cfbe760cb38a8b0947070,1,0
"return Results.fail(""Unknown Camel language"");",18a095c429860840b16cfbe760cb38a8b0947070,1,0
import io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String language = event.getNewValue() != null ? event.getNewValue().toString() : null;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String description = CamelCatalogHelper.getLanguageDescription(language);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String artifactId = findLanguageArchetype(name.getValue());,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"DependencyBuilder component = DependencyBuilder.create().setGroupId(""org.apache.camel"")",18a095c429860840b16cfbe760cb38a8b0947070,1,1
// install the component,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"return Results.success(""Added Camel language "" + name.getValue() + "" ("" + artifactId + "") to the project"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
package io.fabric8.forge.camel.commands.project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import javax.inject.Inject;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.convert.Converter;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.dependencies.Dependency;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.Project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.UISelectOne;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.Result;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.Results;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.util.Categories;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.util.Metadata;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"@WithAttributes(label = ""Name"", required = true, description = ""Name of component type to add"")",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"""Camel: Add Component"").category(Categories.create(CATEGORY))",18a095c429860840b16cfbe760cb38a8b0947070,1,1
// show note about the chosen component,18a095c429860840b16cfbe760cb38a8b0947070,1,1
ComponentDto component = (ComponentDto) event.getNewValue();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String description = component.getDescription();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
// does the project already have camel?,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"return Results.fail(""The project does not include camel-core"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
String version;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
DependencyBuilder component = DependencyBuilder.create().setGroupId(dto.getGroupId()),18a095c429860840b16cfbe760cb38a8b0947070,1,1
// install the component,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"return Results.fail(""Unknown Camel component"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
package io.fabric8.forge.camel.commands.project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import javax.inject.Inject;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.completer.CamelDataFormatsCompleter;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.dto.DataFormatDto;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.convert.Converter;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.dependencies.Dependency;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.Project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.UISelectOne;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.Result;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.Results;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.util.Categories;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.util.Metadata;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"""Camel: Add DataFormat"").category(Categories.create(CATEGORY))",18a095c429860840b16cfbe760cb38a8b0947070,1,1
// use value choices instead of completer as that works better in web console,18a095c429860840b16cfbe760cb38a8b0947070,1,1
// show note about the chosen data format,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String description = dataFormat.getDescription();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
// does the project already have camel?,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"return Results.fail(""The project does not include camel-core"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
DependencyBuilder component = DependencyBuilder.create().setGroupId(dto.getGroupId()),18a095c429860840b16cfbe760cb38a8b0947070,1,1
// install the component,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"return Results.success(""Added Camel dataformat "" + dto.getName() + "" ("" + dto.getArtifactId() + "") to the project"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"return Results.fail(""Unknown Camel dataformat"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
package io.fabric8.forge.camel.commands.project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.ArrayList;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.Arrays;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.List;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.Map;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import javax.inject.Inject;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.completer.RouteBuilderCompleter;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.model.EndpointOptionByGroup;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.convert.Converter;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.facets.constraints.FacetConstraint;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.parser.java.facets.JavaSourceFacet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.Project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.facets.ClassLoaderFacet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UINavigationContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.InputComponentFactory;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.UIInput;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.UISelectOne;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.NavigationResult;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.Result;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.Results;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.navigation.NavigationResultBuilder;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.util.Categories;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.util.Metadata;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.wizard.UIWizard;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
private static final int MAX_OPTIONS = 20;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"@WithAttributes(label = ""Name"", required = true, description = ""Name of component to use for the endpoint"")",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"@WithAttributes(label = ""RouteBuilder Class"", required = true, description = ""The RouteBuilder class to use"")",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"""Camel: Add Endpoint"").category(Categories.create(CATEGORY))",18a095c429860840b16cfbe760cb38a8b0947070,1,1
".description(""Adds a Camel endpoint to an existing RouteBuilder class"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
// show note about the chosen component,18a095c429860840b16cfbe760cb38a8b0947070,1,1
ComponentDto component = (ComponentDto) event.getNewValue();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String description = component.getDescription();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
// limit the endpoint types what is possible with this chosen component,18a095c429860840b16cfbe760cb38a8b0947070,1,1
boolean consumerOnly = component.isConsumerOnly();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
boolean producerOnly = component.isProducerOnly();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
// use value choices instead of completer as that works better in web console,18a095c429860840b16cfbe760cb38a8b0947070,1,1
ComponentDto component = componentName.getValue();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String camelComponentName = component.getScheme();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
// must be same component name and endpoint type to allow reusing existing navigation result,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String previous = (String) attributeMap.get(""componentName"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String previous2 = (String) attributeMap.get(""endpointType"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
String type = endpointType.getValue();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
boolean last = i == pages - 1;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
package io.fabric8.forge.camel.commands.project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import javax.inject.Inject;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.completer.CamelLanguagesCompleter;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.dto.LanguageDto;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.convert.Converter;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.dependencies.Dependency;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.Project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.UISelectOne;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.Result;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.Results;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.util.Categories;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.util.Metadata;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"""Camel: Add Language"").category(Categories.create(CATEGORY))",18a095c429860840b16cfbe760cb38a8b0947070,1,1
// use value choices instead of completer as that works better in web console,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String description = language.getDescription();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
// does the project already have camel?,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"return Results.fail(""The project does not include camel-core"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
DependencyBuilder component = DependencyBuilder.create().setGroupId(dto.getGroupId()),18a095c429860840b16cfbe760cb38a8b0947070,1,1
// install the component,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"return Results.success(""Added Camel language "" + dto.getName() + "" ("" + dto.getArtifactId() + "") to the project"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"return Results.fail(""Unknown Camel language"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
package io.fabric8.forge.camel.commands.project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.io.File;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.net.URL;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.HashMap;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.Map;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import javax.inject.Inject;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.addon.utils.validator.ResourceNameValidator;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.dependencies.Dependency;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.facets.constraints.FacetConstraint;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.Project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.resource.FileResource;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.resource.Resource;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.resource.ResourceFactory;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.resource.URLResource;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.templates.Template;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.templates.TemplateFactory;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.templates.freemarker.FreemarkerTemplate;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.facets.HintsFacet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.hints.InputType;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.UIInput;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.Result;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.Results;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.util.Categories;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.util.Metadata;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
public boolean isEnabled(UIContext context) {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
boolean enabled = super.isEnabled(context);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
return !cdi && !spring;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
".description(""Creates a new Blueprint XML file with CamelContext"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
String projectName = project.getRoot().getName();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String fileName = directory.getValue() != null ? directory.getValue() + File.separator + name.getValue() : name.getValue();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String fullName = ""src"" + File.separator + ""main"" + File.separator + ""resources"" + File.separator + fileName;",18a095c429860840b16cfbe760cb38a8b0947070,1,1
// this will get a file in the src/main/resources directory where we want to store the spring xml file,18a095c429860840b16cfbe760cb38a8b0947070,1,1
// does the project already have camel?,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"return Results.fail(""The project does not include camel-core"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"DependencyBuilder spring = DependencyBuilder.create().setGroupId(""org.apache.camel"")",18a095c429860840b16cfbe760cb38a8b0947070,1,1
String output = template.process(params);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"return Results.success(""Created new Blueprint XML file "" + fullName);",18a095c429860840b16cfbe760cb38a8b0947070,1,1
package io.fabric8.forge.camel.commands.project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.Map;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.concurrent.Callable;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import javax.inject.Inject;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.addon.utils.completer.PackageNameCompleter;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.addon.utils.validator.ClassNameValidator;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.addon.utils.validator.PackageNameValidator;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.convert.Converter;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.dependencies.DependencyResolver;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.facets.constraints.FacetConstraint;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.parser.java.facets.JavaSourceFacet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.Project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.facets.ClassLoaderFacet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UINavigationContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.facets.HintsFacet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.hints.InputType;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.UIInput;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.UISelectOne;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.NavigationResult;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.Result;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.Results;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.util.Categories;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.util.Metadata;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.wizard.UIWizard;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.roaster.model.util.Strings;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"@WithAttributes(label = ""Component Name"", required = true, description = ""Name of component type to add"")",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"@WithAttributes(label = ""Instance Name"", required = true, description = ""Name of component instance to add"")",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"@WithAttributes(label = ""Package Name"", required = false, description = ""The package name where this type will be created"")",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"""Camel: New Component CDI"").category(Categories.create(CATEGORY))",18a095c429860840b16cfbe760cb38a8b0947070,1,1
public boolean isEnabled(UIContext context) {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
boolean enabled = super.isEnabled(context);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
// show note about the chosen component,18a095c429860840b16cfbe760cb38a8b0947070,1,1
ComponentDto component = (ComponentDto) event.getNewValue();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String description = component.getDescription();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
public String call() throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
protected String getDefaultProducerClassName() {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String name = instanceName.getValue();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
package io.fabric8.forge.camel.commands.project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.Map;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.concurrent.Callable;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import javax.inject.Inject;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.addon.utils.completer.PackageNameCompleter;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.addon.utils.validator.ClassNameValidator;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.addon.utils.validator.PackageNameValidator;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.convert.Converter;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.dependencies.DependencyResolver;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.facets.constraints.FacetConstraint;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.parser.java.facets.JavaSourceFacet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.Project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.facets.ClassLoaderFacet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UINavigationContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.facets.HintsFacet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.hints.InputType;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.UIInput;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.UISelectOne;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.NavigationResult;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.Result;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.Results;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.util.Categories;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.util.Metadata;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.wizard.UIWizard;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.roaster.model.util.Strings;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"@WithAttributes(label = ""Component Name"", required = true, description = ""Name of component type to add"")",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"@WithAttributes(label = ""Instance Name"", required = true, description = ""Name of component instance to add"")",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"@WithAttributes(label = ""Target Package"", required = false, description = ""The package name where this type will be created"")",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"""Camel: New Component Spring"").category(Categories.create(CATEGORY))",18a095c429860840b16cfbe760cb38a8b0947070,1,1
public boolean isEnabled(UIContext context) {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
boolean enabled = super.isEnabled(context);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
// show note about the chosen component,18a095c429860840b16cfbe760cb38a8b0947070,1,1
ComponentDto component = (ComponentDto) event.getNewValue();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String description = component.getDescription();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
public String call() throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
protected String getDefaultProducerClassName() {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String name = instanceName.getValue();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
package io.fabric8.forge.camel.commands.project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.io.File;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.net.URL;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.HashMap;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.Map;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import javax.inject.Inject;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.addon.utils.validator.ResourceNameValidator;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.dependencies.Dependency;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.facets.constraints.FacetConstraint;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.Project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.resource.FileResource;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.resource.Resource;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.resource.ResourceFactory;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.resource.URLResource;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.templates.Template;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.templates.TemplateFactory;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.templates.freemarker.FreemarkerTemplate;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.facets.HintsFacet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.hints.InputType;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.UIInput;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.Result;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.Results;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.util.Categories;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.util.Metadata;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
public boolean isEnabled(UIContext context) {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
boolean enabled = super.isEnabled(context);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
return !cdi && !blueprint;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
".description(""Creates a new Spring XML file with CamelContext to your project"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
String projectName = project.getRoot().getName();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String fileName = directory.getValue() != null ? directory.getValue() + File.separator + name.getValue() : name.getValue();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String fullName = ""src"" + File.separator + ""main"" + File.separator + ""resources"" + File.separator + fileName;",18a095c429860840b16cfbe760cb38a8b0947070,1,1
// this will get a file in the src/main/resources directory where we want to store the spring xml file,18a095c429860840b16cfbe760cb38a8b0947070,1,1
// does the project already have camel?,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"return Results.fail(""The project does not include camel-core"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"DependencyBuilder spring = DependencyBuilder.create().setGroupId(""org.apache.camel"")",18a095c429860840b16cfbe760cb38a8b0947070,1,1
String output = template.process(params);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"return Results.success(""Created new Spring XML file "" + fullName);",18a095c429860840b16cfbe760cb38a8b0947070,1,1
package io.fabric8.forge.camel.commands.project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.ArrayList;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.HashSet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.List;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.Map;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.Set;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import javax.inject.Inject;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.addon.utils.CamelProjectHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.model.CamelComponentDetails;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.apache.camel.catalog.CamelCatalog;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.apache.camel.catalog.JSonSchemaHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.dependencies.Dependency;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.dependencies.DependencyResolver;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.parser.java.facets.JavaSourceFacet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.parser.java.resources.JavaResource;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.Project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UINavigationContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.InputComponentFactory;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.NavigationResult;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.Result;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.Results;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.util.Categories;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.util.Metadata;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.wizard.UIWizardStep;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.roaster.Roaster;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.roaster.model.source.JavaClassSource;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.roaster.model.util.Strings;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
".description(""Configure the component options to use"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String camelComponentName = mandatoryAttributeValue(attributeMap, ""componentName"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
String json = camelCatalog.componentJSonSchema(camelComponentName);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""componentProperties"", json, true);",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String name = propertyMap.get(""name"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String kind = propertyMap.get(""kind"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String type = propertyMap.get(""type"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String javaType = propertyMap.get(""javaType"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String deprecated = propertyMap.get(""deprecated"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String required = propertyMap.get(""required"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
String currentValue = null;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String defaultValue = propertyMap.get(""defaultValue"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String description = propertyMap.get(""description"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String enums = propertyMap.get(""enum"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"InputComponent input = createUIInput(componentFactory, getConverterFactory(), name, inputClazz, required, currentValue, defaultValue, enums, description);",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String componentInstanceName = mandatoryAttributeValue(attributeMap, ""instanceName"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String generatePackageName = mandatoryAttributeValue(attributeMap, ""targetPackage"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String generateClassName = mandatoryAttributeValue(attributeMap, ""className"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String kind = mandatoryAttributeValue(attributeMap, ""kind"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
// does the project already have camel?,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"return Results.fail(""The project does not include camel-core"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
// do we already have a class with the name,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String fqn = generatePackageName != null ? generatePackageName + ""."" + generateClassName : generateClassName;",18a095c429860840b16cfbe760cb38a8b0947070,1,1
if (existing != null && existing.exists()) {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"return Results.fail(""A class with name "" + fqn + "" already exists"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
// generate the correct class payload based on the style...,18a095c429860840b16cfbe760cb38a8b0947070,1,1
for (InputComponent input : inputs) {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
// only use value if there was a value set,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String valueExpression = null;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String text = value.toString();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String configurationCode = buffer.toString();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"return Results.success(""Created new class "" + generateClassName);",18a095c429860840b16cfbe760cb38a8b0947070,1,1
* Returns the mandatory String value of the given name,18a095c429860840b16cfbe760cb38a8b0947070,1,1
package io.fabric8.forge.camel.commands.project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.io.ByteArrayInputStream;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.HashMap;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.List;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.Map;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.regex.Pattern;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import javax.inject.Inject;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.addon.utils.CamelProjectHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.addon.utils.LineNumberHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.addon.utils.XmlLineNumberParser;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.helper.CamelJavaParserHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.helper.StringHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.model.CamelComponentDetails;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.apache.camel.catalog.CamelCatalog;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.dependencies.Dependency;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.parser.java.facets.JavaSourceFacet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.parser.java.resources.JavaResource;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.Project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.ProjectFactory;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.facets.WebResourcesFacet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.resource.FileResource;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UINavigationContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.NavigationResult;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.Result;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.Results;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.util.Categories;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.util.Metadata;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.wizard.UIWizardStep;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.roaster.model.source.AnnotationSource;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.roaster.model.source.FieldSource;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.roaster.model.source.JavaClassSource;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.roaster.model.source.MethodSource;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.roaster.model.util.Strings;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.w3c.dom.Document;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.w3c.dom.Node;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.w3c.dom.NodeList;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
private final String componentName;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
private final String group;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
private final boolean last;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"boolean last, int index, int total) {",18a095c429860840b16cfbe760cb38a8b0947070,1,1
for (InputComponent input : inputs) {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String kind = mandatoryAttributeValue(attributeMap, ""kind"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String camelComponentName = optionalAttributeValue(attributeMap, ""componentName"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String endpointInstanceName = optionalAttributeValue(attributeMap, ""instanceName"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String mode = mandatoryAttributeValue(attributeMap, ""mode"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String xml = mandatoryAttributeValue(attributeMap, ""xml"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
String lineNumber = null;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String endpointUrl = null;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
// does the project already have camel?,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"return Results.fail(""The project does not include camel-core"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
// collect all the options that was set,18a095c429860840b16cfbe760cb38a8b0947070,1,1
for (InputComponent input : allInputs) {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String key = input.getName();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
// only use the value if a value was set (and the value is not the same as the default value),18a095c429860840b16cfbe760cb38a8b0947070,1,1
String value = input.getValue().toString();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"boolean matchDefault = isDefaultValue(camelCatalog, camelComponentName, key, value);",18a095c429860840b16cfbe760cb38a8b0947070,1,1
} else if (input.isRequired() && input.hasDefaultValue()) {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String uri = camelCatalog.asEndpointUriXml(camelComponentName, options, false);",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"return Results.fail(""Cannot create endpoint uri"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"return Results.fail(""Cannot find XML file "" + xml);",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"// we are in add mode, so parse dom to find <camelContext> and insert the endpoint where its needed",18a095c429860840b16cfbe760cb38a8b0947070,1,1
String line = lines.get(idx);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String content = LineNumberHelper.linesToString(lines);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String lineNumber;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
if (camels != null && camels.getLength() == 1) {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
Node camel = camels.item(0);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
boolean created = false;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
// find existing by id,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String id = child.getAttributes().getNamedItem(""id"").getNodeValue();",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"return Results.fail(""Cannot find <camelContext> in XML file "" + xml);",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String line = String.format(""<endpoint id=\""%s\"" uri=\""%s\""/>"", endpointInstanceName, uri);",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String camelComponentName = mandatoryAttributeValue(attributeMap, ""componentName"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String routeBuilder = mandatoryAttributeValue(attributeMap, ""routeBuilder"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String uri = camelCatalog.asEndpointUri(camelComponentName, options, false);",18a095c429860840b16cfbe760cb38a8b0947070,1,1
boolean updated = true;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
// special for CDI as we use different set of annotations,18a095c429860840b16cfbe760cb38a8b0947070,1,1
// cdi uses @Inject @Uri,18a095c429860840b16cfbe760cb38a8b0947070,1,1
// make sure to import what we use,18a095c429860840b16cfbe760cb38a8b0947070,1,1
// replace the unformatted class soure code,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String code = clazz.toUnformattedString();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String endpointUrl = mandatoryAttributeValue(attributeMap, ""endpointUri"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
String name = found.getNodeName();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
// if no endpoints then try to find cut-off according the XSD rules,18a095c429860840b16cfbe760cb38a8b0947070,1,1
* Returns the mandatory String value of the given name,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String text = value.toString();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
* Returns the optional String value of the given name,18a095c429860840b16cfbe760cb38a8b0947070,1,1
package io.fabric8.forge.camel.commands.project.archetype;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.io.StringReader;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.logging.Level;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.logging.Logger;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.apache.camel.catalog.DefaultCamelCatalog;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.apache.maven.archetype.catalog.ArchetypeCatalog;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.apache.maven.archetype.catalog.io.xpp3.ArchetypeCatalogXpp3Reader;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.maven.archetype.ArchetypeCatalogFactory;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
* The Apache Camel archetypes,18a095c429860840b16cfbe760cb38a8b0947070,1,1
public class CamelArchetypeCatalogFactory implements ArchetypeCatalogFactory {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
public String toString() {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
public String getName() {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
// use the camel catalog to load the archetypes,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String xml = new DefaultCamelCatalog().archetypeCatalogAsXml();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
public boolean equals(Object o) {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
package io.fabric8.forge.camel.commands.project.completer;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.ArrayList;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.List;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.Set;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.addon.utils.CamelProjectHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.apache.camel.catalog.CamelCatalog;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.dependencies.Dependency;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.Project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.UICompleter;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
public class CamelComponentsLabelCompleter implements UICompleter<String> {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
private final Project project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"public Iterable<String> getCompletionProposals(UIContext context, InputComponent input, String value) {",18a095c429860840b16cfbe760cb38a8b0947070,1,1
package io.fabric8.forge.camel.commands.project.completer;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.ArrayList;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.List;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.Map;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.Set;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.addon.utils.CamelProjectHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.dto.DataFormatDto;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.apache.camel.catalog.CamelCatalog;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.apache.camel.catalog.JSonSchemaHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.dependencies.Dependency;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.Project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.UICompleter;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
public class CamelDataFormatsCompleter implements UICompleter<DataFormatDto> {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
private final Project project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"public Iterable<DataFormatDto> getCompletionProposals(UIContext context, InputComponent input, String value) {",18a095c429860840b16cfbe760cb38a8b0947070,1,1
// find all available dataformat names,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String json = camelCatalog.dataFormatJSonSchema(name);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String artifactId = findArtifactId(json);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
boolean already = false;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"Set<String> languages = dataFormatsFromArtifact(camelCatalog, dep.getCoordinate().getArtifactId());",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""dataformat"", json, false);",18a095c429860840b16cfbe760cb38a8b0947070,1,1
package io.fabric8.forge.camel.commands.project.completer;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.ArrayList;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.List;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.Map;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.Set;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.addon.utils.CamelProjectHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.dto.LanguageDto;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.apache.camel.catalog.CamelCatalog;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.apache.camel.catalog.JSonSchemaHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.dependencies.Dependency;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.Project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.UICompleter;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
public class CamelLanguagesCompleter implements UICompleter<LanguageDto> {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
private final Project project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"public Iterable<LanguageDto> getCompletionProposals(UIContext context, InputComponent input, String value) {",18a095c429860840b16cfbe760cb38a8b0947070,1,1
// find all available language names,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String json = camelCatalog.languageJSonSchema(name);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String artifactId = findArtifactId(json);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
boolean already = false;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
// filter out existing languages we already have,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"Set<String> languages = languagesFromArtifact(camelCatalog, dep.getCoordinate().getArtifactId());",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""language"", json, false);",18a095c429860840b16cfbe760cb38a8b0947070,1,1
package io.fabric8.forge.camel.commands.project.completer;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.io.FileNotFoundException;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.ArrayList;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.List;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.Set;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.TreeSet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.apache.camel.builder.RouteBuilder;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.parser.java.facets.JavaSourceFacet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.parser.java.resources.JavaResource;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.parser.java.resources.JavaResourceVisitor;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.resource.visit.VisitContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.UICompleter;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.roaster.model.JavaClass;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
public class RouteBuilderCompleter implements UICompleter<String> {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String superType = clazz.getSuperType();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
if (superType != null && RouteBuilder.class.getName().equals(superType)) {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"public Iterable<String> getCompletionProposals(UIContext context, InputComponent input, String value) {",18a095c429860840b16cfbe760cb38a8b0947070,1,1
package io.fabric8.forge.camel.commands.project.helper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.List;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.Map;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.Set;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.TreeSet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.dto.DataFormatDto;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.dto.LanguageDto;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.utils.Strings;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.apache.camel.catalog.CamelCatalog;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.apache.camel.catalog.JSonSchemaHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
public final class CamelCatalogHelper {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
boolean next = true;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String json = camelCatalog.componentJSonSchema(name);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""component"", json, false);",18a095c429860840b16cfbe760cb38a8b0947070,1,1
String scheme = null;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String artifact = null;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
if (artifactId.equals(artifact) && scheme != null) {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String json = camelCatalog.dataFormatJSonSchema(name);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""dataformat"", json, false);",18a095c429860840b16cfbe760cb38a8b0947070,1,1
String df = null;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
if (artifactId.equals(artifact) && df != null) {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String json = camelCatalog.languageJSonSchema(name);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""language"", json, false);",18a095c429860840b16cfbe760cb38a8b0947070,1,1
String lan = null;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
if (artifactId.equals(artifact) && lan != null) {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
* @param scheme the component name,18a095c429860840b16cfbe760cb38a8b0947070,1,1
// use the camel catalog,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String json = camelCatalog.componentJSonSchema(scheme);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""properties"", json, true);",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String name = propertyMap.get(""name"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String defaultValue = propertyMap.get(""defaultValue"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
* Whether the component is consumer only,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String consumerOnly = propertyMap.get(""consumerOnly"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String consumerOnly = propertyMap.get(""producerOnly"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String labelText = row.get(""label"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
package io.fabric8.forge.camel.commands.project.helper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.ArrayList;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.Collections;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.Date;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.HashSet;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.List;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.Map;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.Set;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import java.util.concurrent.Callable;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.addon.utils.CamelProjectHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.completer.CamelComponentsCompleter;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.completer.CamelComponentsLabelCompleter;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.model.CamelComponentDetails;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import io.fabric8.forge.camel.commands.project.model.EndpointOptionByGroup;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.apache.camel.catalog.CamelCatalog;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.apache.camel.catalog.JSonSchemaHelper;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.convert.ConverterFactory;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.dependencies.Dependency;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.Project;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.context.UIContext;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.InputComponentFactory;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.input.UISelectOne;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.Result;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.addon.ui.result.Results;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.roaster.model.source.JavaClassSource;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.roaster.model.source.MethodSource;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
import org.jboss.forge.roaster.model.util.Strings;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
public final class CamelCommandsHelper {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"public static Iterable<String> createComponentLabelValues(Project project, CamelCatalog camelCatalog) {",18a095c429860840b16cfbe760cb38a8b0947070,1,1
final boolean excludeComponentsOnClasspath) {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String label = componentCategoryFilter.getValue();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String json = camelCatalog.componentJSonSchema(camelComponentName);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""component"", json, false);",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String javaType = row.get(""javaType"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String groupId = row.get(""groupId"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String artifactId = row.get(""artifactId"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String version = row.get(""version"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"public static Result ensureCamelArtifactIdAdded(Project project, CamelComponentDetails details, DependencyInstaller dependencyInstaller) {",18a095c429860840b16cfbe760cb38a8b0947070,1,1
String groupId = details.getGroupId();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String artifactId = details.getArtifactId();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"return Results.fail(""The project does not include camel-core"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
String version;,18a095c429860840b16cfbe760cb38a8b0947070,1,1
DependencyBuilder component = DependencyBuilder.create().setGroupId(groupId),18a095c429860840b16cfbe760cb38a8b0947070,1,1
// install the component,18a095c429860840b16cfbe760cb38a8b0947070,1,1
String componentClassName = details.getComponentClassName();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String methodName = ""create"" + Strings.capitalize(componentInstanceName) + ""Component"";",18a095c429860840b16cfbe760cb38a8b0947070,1,1
if (clazz != null && (clazz.equals(String.class) || clazz.equals(Date.class) || clazz.equals(Boolean.class),18a095c429860840b16cfbe760cb38a8b0947070,1,1
if (camelComponentName == null && uri != null) {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"// is the component consumer or producer only, if so we do not need any kind of filter",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"boolean componentConsumerOnly = CamelCatalogHelper.isComponentConsumerOnly(camelCatalog, camelComponentName);",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"boolean componentProducerOnly = CamelCatalogHelper.isComponentProducerOnly(camelCatalog, camelComponentName);",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"// reset the filters as the component can only be one of them anyway, so we should show all options",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""properties"", json, true);",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String name = propertyMap.get(""name"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String kind = propertyMap.get(""kind"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String group = propertyMap.get(""group"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String label = propertyMap.get(""label"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String type = propertyMap.get(""type"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String javaType = propertyMap.get(""javaType"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String deprecated = propertyMap.get(""deprecated"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String required = propertyMap.get(""required"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
String currentValue = currentValues.get(name);,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String defaultValue = propertyMap.get(""defaultValue"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String description = propertyMap.get(""description"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"String enums = propertyMap.get(""enum"");",18a095c429860840b16cfbe760cb38a8b0947070,1,1
if (group != null && !group.equals(current.getGroup())) {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
if (consumerOnly && label != null) {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
if (producerOnly && label != null) {,18a095c429860840b16cfbe760cb38a8b0947070,1,1
boolean gui = ui.getProvider().isGUI();,18a095c429860840b16cfbe760cb38a8b0947070,1,1
"if (enums != null && required == null || ""false"".equals(required)) {",18a095c429860840b16cfbe760cb38a8b0947070,1,1
"InputComponent input = createUIInput(componentFactory, converterFactory, name, inputClazz, required, currentValue, defaultValue, enums, description);",18a095c429860840b16cfbe760cb38a8b0947070,1,1
// if we hit max options then create a new group,18a095c429860840b16cfbe760cb38a8b0947070,1,1
if (clazz == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,0
clazz = loadStringSupportedType(javaType);,18a095c429860840b16cfbe760cb38a8b0947070,0,0
},18a095c429860840b16cfbe760cb38a8b0947070,0,0
"if (""java.io.File"".equals(javaType)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,0
return String.class;,18a095c429860840b16cfbe760cb38a8b0947070,0,0
"} else if (""java.net.URL"".equals(javaType)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,0
"} else if (""java.net.URI"".equals(javaType)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,0
return null;,18a095c429860840b16cfbe760cb38a8b0947070,0,0
private final List<InputComponent> allInputs;,18a095c429860840b16cfbe760cb38a8b0947070,0,0
private final List<InputComponent> inputs;,18a095c429860840b16cfbe760cb38a8b0947070,0,0
@Deprecated,18a095c429860840b16cfbe760cb38a8b0947070,0,0
public ConfigureEndpointPropertiesStep() {,18a095c429860840b16cfbe760cb38a8b0947070,0,0
"this(null, null, null, null, false);",18a095c429860840b16cfbe760cb38a8b0947070,0,0
},18a095c429860840b16cfbe760cb38a8b0947070,0,0
"public ConfigureEndpointPropertiesStep(ProjectFactory projectFactory,",18a095c429860840b16cfbe760cb38a8b0947070,0,0
"DependencyInstaller dependencyInstaller,",18a095c429860840b16cfbe760cb38a8b0947070,0,0
"List<InputComponent> allInputs,",18a095c429860840b16cfbe760cb38a8b0947070,0,0
"List<InputComponent> inputs,",18a095c429860840b16cfbe760cb38a8b0947070,0,0
this.projectFactory = projectFactory;,18a095c429860840b16cfbe760cb38a8b0947070,0,0
this.dependencyInstaller = dependencyInstaller;,18a095c429860840b16cfbe760cb38a8b0947070,0,0
this.allInputs = allInputs;,18a095c429860840b16cfbe760cb38a8b0947070,0,0
this.inputs = inputs;,18a095c429860840b16cfbe760cb38a8b0947070,0,0
this.last = last;,18a095c429860840b16cfbe760cb38a8b0947070,0,0
if (inputs != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,0
builder.add(input);,18a095c429860840b16cfbe760cb38a8b0947070,0,0
if (!last) {,18a095c429860840b16cfbe760cb38a8b0947070,0,0
// TODO: carry over options to the next page (yikes we need to store this state ourselves),18a095c429860840b16cfbe760cb38a8b0947070,0,0
// only if last,18a095c429860840b16cfbe760cb38a8b0947070,0,0
if (last) {,18a095c429860840b16cfbe760cb38a8b0947070,0,0
"if (""xml"".equals(kind)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,0
"return executeXml(context, attributeMap);",18a095c429860840b16cfbe760cb38a8b0947070,0,0
} else {,18a095c429860840b16cfbe760cb38a8b0947070,0,0
"return executeJava(context, attributeMap);",18a095c429860840b16cfbe760cb38a8b0947070,0,0
return null;,18a095c429860840b16cfbe760cb38a8b0947070,0,0
@Inject,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private InputComponentFactory componentFactory;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private DependencyResolver dependencyResolver;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private List<InputComponent> inputs = new ArrayList<>();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
CamelCatalog catalog = new DefaultCamelCatalog();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"Map<Object, Object> attributeMap = builder.getUIContext().getAttributeMap();",18a095c429860840b16cfbe760cb38a8b0947070,0,1
camelComponentName = endpointComponentName(uri);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
},18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (json == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"Map<String, String> currentValues = uri != null ? catalog.endpointProperties(uri) : Collections.EMPTY_MAP;",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (data != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
Set<String> namesAdded = new HashSet<>();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"for (Map<String, String> propertyMap : data) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (!Strings.isNullOrEmpty(name)) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"Class<Object> inputClazz = CamelCommandsHelper.loadValidInputTypes(javaType, type);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (inputClazz != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (namesAdded.add(name)) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (input != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
builder.add(input);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
inputs.add(input);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (""xml"".equals(kind)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return executeXml(context, attributeMap);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return executeJava(context, attributeMap);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UISelectOne<ComponentDto> name;,18a095c429860840b16cfbe760cb38a8b0947070,0,0
filter.setValueChoices(CamelCommandsHelper.createComponentLabelValues(project));,18a095c429860840b16cfbe760cb38a8b0947070,0,0
"name.setValueChoices(CamelCommandsHelper.createComponentDtoValues(project, filter, false));",18a095c429860840b16cfbe760cb38a8b0947070,0,0
"name.setValueConverter(new Converter<String, ComponentDto>() {",18a095c429860840b16cfbe760cb38a8b0947070,0,0
@Override,18a095c429860840b16cfbe760cb38a8b0947070,0,0
public ComponentDto convert(String name) {,18a095c429860840b16cfbe760cb38a8b0947070,0,0
return createComponentDto(name);,18a095c429860840b16cfbe760cb38a8b0947070,0,0
},18a095c429860840b16cfbe760cb38a8b0947070,0,0
});,18a095c429860840b16cfbe760cb38a8b0947070,0,0
ComponentDto dto = name.getValue();,18a095c429860840b16cfbe760cb38a8b0947070,0,0
if (dto != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,0
.setArtifactId(dto.getArtifactId()).setVersion(core.getCoordinate().getVersion());,18a095c429860840b16cfbe760cb38a8b0947070,0,0
"dependencyInstaller.install(project, component);",18a095c429860840b16cfbe760cb38a8b0947070,0,0
} else {,18a095c429860840b16cfbe760cb38a8b0947070,0,0
private UISelectOne<String> name;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
filter.setValueChoices(CamelCommandsHelper.createComponentNameValues(project));,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"name.setValueChoices(CamelCommandsHelper.createComponentNameValues(project, filter, false));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (artifactId == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
},18a095c429860840b16cfbe760cb38a8b0947070,0,1
.setArtifactId(artifactId).setVersion(core.getCoordinate().getVersion());,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"dependencyInstaller.install(project, component);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
componentNameFilter.setValueChoices(CamelCommandsHelper.createComponentLabelValues(project));,18a095c429860840b16cfbe760cb38a8b0947070,0,0
componentNameFilter.setValueChoices(CamelCommandsHelper.createComponentNameValues(project));,18a095c429860840b16cfbe760cb38a8b0947070,0,1
componentNameFilter.setValueChoices(CamelCommandsHelper.createComponentLabelValues(project));,18a095c429860840b16cfbe760cb38a8b0947070,0,0
componentNameFilter.setValueChoices(CamelCommandsHelper.createComponentNameValues(project));,18a095c429860840b16cfbe760cb38a8b0947070,0,1
componentNameFilter.setValueChoices(CamelCommandsHelper.createComponentLabelValues(project));,18a095c429860840b16cfbe760cb38a8b0947070,0,0
componentNameFilter.setValueChoices(CamelCommandsHelper.createComponentNameValues(project));,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UISelectOne<ComponentDto> componentName;,18a095c429860840b16cfbe760cb38a8b0947070,0,0
"componentName.setValueChoices(CamelCommandsHelper.createComponentDtoValues(project, componentNameFilter, false));",18a095c429860840b16cfbe760cb38a8b0947070,0,0
"componentName.setValueConverter(new Converter<String, ComponentDto>() {",18a095c429860840b16cfbe760cb38a8b0947070,0,0
@Override,18a095c429860840b16cfbe760cb38a8b0947070,0,0
public ComponentDto convert(String name) {,18a095c429860840b16cfbe760cb38a8b0947070,0,0
return createComponentDto(name);,18a095c429860840b16cfbe760cb38a8b0947070,0,0
},18a095c429860840b16cfbe760cb38a8b0947070,0,0
});,18a095c429860840b16cfbe760cb38a8b0947070,0,0
"attributeMap.put(""componentName"", componentName.getValue().getScheme());",18a095c429860840b16cfbe760cb38a8b0947070,0,0
private UISelectOne<String> componentName;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"componentName.setValueChoices(CamelCommandsHelper.createComponentNameValues(project, componentNameFilter, false));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"attributeMap.put(""componentName"", componentName.getValue());",18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UISelectOne<ComponentDto> componentName;,18a095c429860840b16cfbe760cb38a8b0947070,0,0
"componentName.setValueChoices(CamelCommandsHelper.createComponentDtoValues(project, componentNameFilter, false));",18a095c429860840b16cfbe760cb38a8b0947070,0,0
"componentName.setValueConverter(new Converter<String, ComponentDto>() {",18a095c429860840b16cfbe760cb38a8b0947070,0,0
@Override,18a095c429860840b16cfbe760cb38a8b0947070,0,0
public ComponentDto convert(String name) {,18a095c429860840b16cfbe760cb38a8b0947070,0,0
return createComponentDto(name);,18a095c429860840b16cfbe760cb38a8b0947070,0,0
},18a095c429860840b16cfbe760cb38a8b0947070,0,0
});,18a095c429860840b16cfbe760cb38a8b0947070,0,0
"attributeMap.put(""componentName"", componentName.getValue().getScheme());",18a095c429860840b16cfbe760cb38a8b0947070,0,0
private UISelectOne<String> componentName;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"componentName.setValueChoices(CamelCommandsHelper.createComponentNameValues(project, componentNameFilter, false));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"attributeMap.put(""componentName"", componentName.getValue());",18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UISelectOne<ComponentDto> componentName;,18a095c429860840b16cfbe760cb38a8b0947070,0,0
"componentName.setValueChoices(CamelCommandsHelper.createComponentDtoValues(project, componentNameFilter, false));",18a095c429860840b16cfbe760cb38a8b0947070,0,0
"componentName.setValueConverter(new Converter<String, ComponentDto>() {",18a095c429860840b16cfbe760cb38a8b0947070,0,0
@Override,18a095c429860840b16cfbe760cb38a8b0947070,0,0
public ComponentDto convert(String name) {,18a095c429860840b16cfbe760cb38a8b0947070,0,0
return createComponentDto(name);,18a095c429860840b16cfbe760cb38a8b0947070,0,0
},18a095c429860840b16cfbe760cb38a8b0947070,0,0
});,18a095c429860840b16cfbe760cb38a8b0947070,0,0
"attributeMap.put(""componentName"", componentName.getValue().getScheme());",18a095c429860840b16cfbe760cb38a8b0947070,0,0
private UISelectOne<String> componentName;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"componentName.setValueChoices(CamelCommandsHelper.createComponentNameValues(project, componentNameFilter, false));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"attributeMap.put(""componentName"", componentName.getValue());",18a095c429860840b16cfbe760cb38a8b0947070,0,1
CamelCatalog catalog = new DefaultCamelCatalog();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (json == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
},18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UISelectOne<DataFormatDto> name;,18a095c429860840b16cfbe760cb38a8b0947070,0,0
DataFormatDto dataFormat = (DataFormatDto) event.getNewValue();,18a095c429860840b16cfbe760cb38a8b0947070,0,0
// name -> artifactId,18a095c429860840b16cfbe760cb38a8b0947070,0,0
DataFormatDto dto = name.getValue();,18a095c429860840b16cfbe760cb38a8b0947070,0,0
if (dto != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,0
.setArtifactId(dto.getArtifactId()).setVersion(core.getCoordinate().getVersion());,18a095c429860840b16cfbe760cb38a8b0947070,0,0
"dependencyInstaller.install(project, component);",18a095c429860840b16cfbe760cb38a8b0947070,0,0
} else {,18a095c429860840b16cfbe760cb38a8b0947070,0,0
},18a095c429860840b16cfbe760cb38a8b0947070,0,0
private UISelectOne<String> name;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (artifactId == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return Results.fail(""Camel dataformat "" + name.getValue() + "" is unknown."");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
},18a095c429860840b16cfbe760cb38a8b0947070,0,1
.setArtifactId(artifactId).setVersion(core.getCoordinate().getVersion());,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"dependencyInstaller.install(project, component);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UISelectOne<LanguageDto> name;,18a095c429860840b16cfbe760cb38a8b0947070,0,0
LanguageDto language = (LanguageDto) event.getNewValue();,18a095c429860840b16cfbe760cb38a8b0947070,0,0
LanguageDto dto = name.getValue();,18a095c429860840b16cfbe760cb38a8b0947070,0,0
if (dto != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,0
// we want to use same version as camel-core,18a095c429860840b16cfbe760cb38a8b0947070,0,0
.setArtifactId(dto.getArtifactId()).setVersion(core.getCoordinate().getVersion());,18a095c429860840b16cfbe760cb38a8b0947070,0,0
"dependencyInstaller.install(project, component);",18a095c429860840b16cfbe760cb38a8b0947070,0,0
} else {,18a095c429860840b16cfbe760cb38a8b0947070,0,0
},18a095c429860840b16cfbe760cb38a8b0947070,0,0
private UISelectOne<String> name;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// name -> artifactId,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (artifactId == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return Results.fail(""Camel language "" + name.getValue() + "" is unknown."");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
},18a095c429860840b16cfbe760cb38a8b0947070,0,1
.setArtifactId(artifactId).setVersion(core.getCoordinate().getVersion());,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"dependencyInstaller.install(project, component);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
/**,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Red Hat licenses this file to you under the Apache License, version",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  with the License.  You may obtain a copy of the License at,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Unless required by applicable law or agreed to in writing, software",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  implied.  See the License for the specific language governing,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  permissions and limitations under the License.,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*/,18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Inject,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"@WithAttributes(label = ""Filter"", required = false, description = ""To filter components"")",18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UISelectOne<String> filter;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UISelectOne<ComponentDto> name;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private DependencyInstaller dependencyInstaller;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Override,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public UICommandMetadata getMetadata(UIContext context) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Metadata.forCommand(CamelAddComponentCommand.class).name(,18a095c429860840b16cfbe760cb38a8b0947070,0,1
},18a095c429860840b16cfbe760cb38a8b0947070,0,1
public void initializeUI(UIBuilder builder) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"filter.setValueChoices(CamelCommandsHelper.createComponentLabelValues(project, getCamelCatalog()));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"filter.setDefaultValue(""<all>"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"name.setValueChoices(CamelCommandsHelper.createComponentDtoValues(project, getCamelCatalog(), filter, false));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// include converter from string->dto,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"name.setValueConverter(new Converter<String, ComponentDto>() {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
public ComponentDto convert(String text) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return createComponentDto(getCamelCatalog(), text);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
});,18a095c429860840b16cfbe760cb38a8b0947070,0,1
name.addValueChangeListener(new ValueChangeListener() {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public void valueChanged(ValueChangeEvent event) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (component != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"name.setNote(description != null ? description : """");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
} else {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"name.setNote("""");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
builder.add(filter).add(name);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public Result execute(UIExecutionContext context) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
Dependency core = findCamelCoreDependency(project);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (core == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
ComponentDto dto = name.getValue();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (dto != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// otherwise use the version from the dto,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (""org.apache.camel"".equals(dto.getGroupId())) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
version = core.getCoordinate().getVersion();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
version = dto.getVersion();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
.setArtifactId(dto.getArtifactId()).setVersion(version);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"dependencyInstaller.install(project, component);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
/**,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Red Hat licenses this file to you under the Apache License, version",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  with the License.  You may obtain a copy of the License at,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Unless required by applicable law or agreed to in writing, software",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  implied.  See the License for the specific language governing,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  permissions and limitations under the License.,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*/,18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Inject,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"@WithAttributes(label = ""Name"", required = true, description = ""Name of dataformat to add"")",18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UISelectOne<DataFormatDto> name;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private DependencyInstaller dependencyInstaller;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Override,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public UICommandMetadata getMetadata(UIContext context) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Metadata.forCommand(CamelAddDataFormatCommand.class).name(,18a095c429860840b16cfbe760cb38a8b0947070,0,1
},18a095c429860840b16cfbe760cb38a8b0947070,0,1
public void initializeUI(UIBuilder builder) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"name.setValueChoices(new CamelDataFormatsCompleter(project, getCamelCatalog()).getValueChoices());",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// include converter from string->dto,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"name.setValueConverter(new Converter<String, DataFormatDto>() {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
public DataFormatDto convert(String text) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return createDataFormatDto(getCamelCatalog(), text);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
});,18a095c429860840b16cfbe760cb38a8b0947070,0,1
name.addValueChangeListener(new ValueChangeListener() {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public void valueChanged(ValueChangeEvent event) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
DataFormatDto dataFormat = (DataFormatDto) event.getNewValue();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (dataFormat != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"name.setNote(description != null ? description : """");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
} else {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"name.setNote("""");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
builder.add(name);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public Result execute(UIExecutionContext context) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
Dependency core = findCamelCoreDependency(project);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (core == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
DataFormatDto dto = name.getValue();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (dto != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// we want to use same version as camel-core,18a095c429860840b16cfbe760cb38a8b0947070,0,1
.setArtifactId(dto.getArtifactId()).setVersion(core.getCoordinate().getVersion());,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"dependencyInstaller.install(project, component);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
/**,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Red Hat licenses this file to you under the Apache License, version",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  with the License.  You may obtain a copy of the License at,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Unless required by applicable law or agreed to in writing, software",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  implied.  See the License for the specific language governing,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  permissions and limitations under the License.,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*/,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"@FacetConstraint({JavaSourceFacet.class, ResourcesFacet.class, ClassLoaderFacet.class})",18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Inject,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"@WithAttributes(label = ""Filter"", required = false, description = ""To filter components"")",18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UISelectOne<String> componentNameFilter;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UISelectOne<ComponentDto> componentName;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"@WithAttributes(label = ""Endpoint type"", required = true, description = ""Type of endpoint"")",18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UISelectOne<String> endpointType;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"@WithAttributes(label = ""Instance Name"", required = true, description = ""Name of endpoint instance to add"")",18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UIInput<String> instanceName;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UISelectOne<String> routeBuilder;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private InputComponentFactory componentFactory;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private DependencyInstaller dependencyInstaller;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Override,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public UICommandMetadata getMetadata(UIContext context) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Metadata.forCommand(CamelAddEndpointCommand.class).name(,18a095c429860840b16cfbe760cb38a8b0947070,0,1
},18a095c429860840b16cfbe760cb38a8b0947070,0,1
public void initializeUI(UIBuilder builder) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"Map<Object, Object> attributeMap = builder.getUIContext().getAttributeMap();",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"attributeMap.remove(""navigationResult"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
JavaSourceFacet facet = project.getFacet(JavaSourceFacet.class);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"componentNameFilter.setValueChoices(CamelCommandsHelper.createComponentLabelValues(project, getCamelCatalog()));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"componentNameFilter.setDefaultValue(""<all>"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"componentName.setValueChoices(CamelCommandsHelper.createComponentDtoValues(project, getCamelCatalog(), componentNameFilter, false));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// include converter from string->dto,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"componentName.setValueConverter(new Converter<String, ComponentDto>() {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
public ComponentDto convert(String text) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return createComponentDto(getCamelCatalog(), text);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
});,18a095c429860840b16cfbe760cb38a8b0947070,0,1
componentName.addValueChangeListener(new ValueChangeListener() {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public void valueChanged(ValueChangeEvent event) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (component != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"componentName.setNote(description != null ? description : """");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
} else {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"componentName.setNote("""");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (consumerOnly) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"String[] types = new String[]{""Consumer""};",18a095c429860840b16cfbe760cb38a8b0947070,0,1
endpointType.setValueChoices(Arrays.asList(types));,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"endpointType.setValue(""Consumer"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"endpointType.setDefaultValue(""Consumer"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
} else if (producerOnly) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"String[] types = new String[]{""Producer""};",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"endpointType.setValue(""Producer"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"endpointType.setDefaultValue(""Producer"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"String[] types = new String[]{""<any>"", ""Consumer"", ""Producer""};",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"endpointType.setValue(""<any>"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"endpointType.setDefaultValue(""<any>"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
routeBuilder.setValueChoices(new RouteBuilderCompleter(facet).getRouteBuilders());,18a095c429860840b16cfbe760cb38a8b0947070,0,1
builder.add(componentNameFilter).add(componentName).add(endpointType).add(instanceName).add(routeBuilder);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public NavigationResult next(UINavigationContext context) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"Map<Object, Object> attributeMap = context.getUIContext().getAttributeMap();",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// always refresh these as the end user may have edited the instance name,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"attributeMap.put(""instanceName"", instanceName.getValue());",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"attributeMap.put(""routeBuilder"", routeBuilder.getValue());",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"attributeMap.put(""mode"", ""add"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"attributeMap.put(""kind"", ""java"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"NavigationResult navigationResult = (NavigationResult) attributeMap.get(""navigationResult"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (navigationResult != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return navigationResult;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"attributeMap.put(""componentName"", camelComponentName);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"attributeMap.put(""endpointType"", endpointType.getValue());",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// we need to figure out how many options there is so we can as many steps we need,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// producer vs consumer only if selected,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (""Consumer"".equals(type)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
consumerOnly = true;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""Producer"".equals(type)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
producerOnly = true;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
UIContext ui = context.getUIContext();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"List<EndpointOptionByGroup> groups = createUIInputsForCamelComponent(camelComponentName, null, MAX_OPTIONS, consumerOnly, producerOnly,",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"getCamelCatalog(), componentFactory, converterFactory, ui);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// need all inputs in a list as well,18a095c429860840b16cfbe760cb38a8b0947070,0,1
List<InputComponent> allInputs = new ArrayList<>();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
for (EndpointOptionByGroup group : groups) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
allInputs.addAll(group.getInputs());,18a095c429860840b16cfbe760cb38a8b0947070,0,1
NavigationResultBuilder builder = Results.navigationBuilder();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
int pages = groups.size();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
for (int i = 0; i < pages; i++) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
EndpointOptionByGroup current = groups.get(i);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"ConfigureEndpointPropertiesStep step = new ConfigureEndpointPropertiesStep(projectFactory, dependencyInstaller, getCamelCatalog(),",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"camelComponentName, current.getGroup(), allInputs, current.getInputs(), last, i, pages);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
builder.add(step);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
NavigationResult navigationResult = builder.build();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"attributeMap.put(""navigationResult"", navigationResult);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
public Result execute(UIExecutionContext context) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Results.success();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
/**,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Red Hat licenses this file to you under the Apache License, version",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  with the License.  You may obtain a copy of the License at,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Unless required by applicable law or agreed to in writing, software",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  implied.  See the License for the specific language governing,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  permissions and limitations under the License.,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*/,18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Inject,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"@WithAttributes(label = ""Name"", required = true, description = ""Name of language to add"")",18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UISelectOne<LanguageDto> name;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private DependencyInstaller dependencyInstaller;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Override,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public UICommandMetadata getMetadata(UIContext context) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Metadata.forCommand(CamelAddLanguageCommand.class).name(,18a095c429860840b16cfbe760cb38a8b0947070,0,1
},18a095c429860840b16cfbe760cb38a8b0947070,0,1
public void initializeUI(UIBuilder builder) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"name.setValueChoices(new CamelLanguagesCompleter(project, getCamelCatalog()).getValueChoices());",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// include converter from string->dto,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"name.setValueConverter(new Converter<String, LanguageDto>() {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
public LanguageDto convert(String text) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return createLanguageDto(getCamelCatalog(), text);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
});,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// show note about the chosen language,18a095c429860840b16cfbe760cb38a8b0947070,0,1
name.addValueChangeListener(new ValueChangeListener() {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public void valueChanged(ValueChangeEvent event) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
LanguageDto language = (LanguageDto) event.getNewValue();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (language != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"name.setNote(description != null ? description : """");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
} else {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"name.setNote("""");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
builder.add(name);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public Result execute(UIExecutionContext context) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
Dependency core = findCamelCoreDependency(project);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (core == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
LanguageDto dto = name.getValue();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (dto != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// we want to use same version as camel-core,18a095c429860840b16cfbe760cb38a8b0947070,0,1
.setArtifactId(dto.getArtifactId()).setVersion(core.getCoordinate().getVersion());,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"dependencyInstaller.install(project, component);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
/**,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Red Hat licenses this file to you under the Apache License, version",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  with the License.  You may obtain a copy of the License at,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Unless required by applicable law or agreed to in writing, software",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  implied.  See the License for the specific language governing,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  permissions and limitations under the License.,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*/,18a095c429860840b16cfbe760cb38a8b0947070,0,1
@FacetConstraint({ResourcesFacet.class}),18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Inject,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"@WithAttributes(label = ""Directory"", required = false, defaultValue = ""OSGI-INF/blueprint"",",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"description = ""The directory name where this type will be created"")",18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UIInput<String> directory;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"@WithAttributes(label = ""File Name"", required = true, description = ""Name of XML file"")",18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UIInput<String> name;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private DependencyInstaller dependencyInstaller;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private TemplateFactory factory;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
ResourceFactory resourceFactory;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Override,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (enabled) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
},18a095c429860840b16cfbe760cb38a8b0947070,0,1
return false;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public UICommandMetadata getMetadata(UIContext context) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Metadata.forCommand(CamelNewRouteBuilderCommand.class).name(,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"""Camel: New XML blueprint"").category(Categories.create(CATEGORY))",18a095c429860840b16cfbe760cb38a8b0947070,0,1
public void initializeUI(UIBuilder builder) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
directory.getFacet(HintsFacet.class).setInputType(InputType.DIRECTORY_PICKER);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"name.addValidator(new ResourceNameValidator(""xml""));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
name.getFacet(HintsFacet.class).setInputType(InputType.FILE_PICKER);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
builder.add(directory).add(name);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public Result execute(UIExecutionContext context) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
ResourcesFacet facet = project.getFacet(ResourcesFacet.class);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
FileResource<?> fileResource = facet.getResource(fileName);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (fileResource.exists()) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return Results.fail(""Blueprint XML file "" + fullName + "" already exists"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
Dependency core = findCamelCoreDependency(project);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (core == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
".setArtifactId(""camel-blueprint"").setVersion(core.getCoordinate().getVersion());",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// install camel-blueprint if missing,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (!dependencyInstaller.isManaged(project, spring)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"dependencyInstaller.install(project, spring);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"Resource<URL> xml = resourceFactory.create(getClass().getResource(""/templates/camel-blueprint.ftl"")).reify(URLResource.class);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"Template template = factory.create(xml, FreemarkerTemplate.class);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// any dynamic options goes into the params map,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"Map<String, Object> params = new HashMap<String, Object>();",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"params.put(""projectName"", projectName);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
fileResource.createNewFile();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
fileResource.setContents(output);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
/**,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Red Hat licenses this file to you under the Apache License, version",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  with the License.  You may obtain a copy of the License at,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Unless required by applicable law or agreed to in writing, software",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  implied.  See the License for the specific language governing,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  permissions and limitations under the License.,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*/,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"@FacetConstraint({JavaSourceFacet.class, ResourcesFacet.class, ClassLoaderFacet.class})",18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Inject,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"@WithAttributes(label = ""Filter"", required = false, description = ""To filter components"")",18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UISelectOne<String> componentNameFilter;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UISelectOne<ComponentDto> componentName;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UIInput<String> instanceName;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UIInput<String> targetPackage;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"@WithAttributes(label = ""Class Name"", required = true, description = ""Name of @Producer class"")",18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UIInput<String> className;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private DependencyInstaller dependencyInstaller;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private DependencyResolver dependencyResolver;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Override,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public UICommandMetadata getMetadata(UIContext context) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Metadata.forCommand(CamelNewComponentInstanceCDICommand.class).name(,18a095c429860840b16cfbe760cb38a8b0947070,0,1
},18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (enabled) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return CamelCommandsHelper.isCdiProject(getSelectedProject(context));,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return false;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public void initializeUI(UIBuilder builder) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
final JavaSourceFacet facet = project.getFacet(JavaSourceFacet.class);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"componentNameFilter.setValueChoices(CamelCommandsHelper.createComponentLabelValues(project, getCamelCatalog()));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"componentNameFilter.setDefaultValue(""<all>"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"componentName.setValueChoices(CamelCommandsHelper.createComponentDtoValues(project, getCamelCatalog(), componentNameFilter, false));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// include converter from string->dto,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"componentName.setValueConverter(new Converter<String, ComponentDto>() {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
public ComponentDto convert(String text) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return createComponentDto(getCamelCatalog(), text);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
});,18a095c429860840b16cfbe760cb38a8b0947070,0,1
componentName.addValueChangeListener(new ValueChangeListener() {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public void valueChanged(ValueChangeEvent event) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (component != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"componentName.setNote(description != null ? description : """");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
} else {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"componentName.setNote("""");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
targetPackage.setCompleter(new PackageNameCompleter(facet));,18a095c429860840b16cfbe760cb38a8b0947070,0,1
targetPackage.addValidator(new PackageNameValidator());,18a095c429860840b16cfbe760cb38a8b0947070,0,1
targetPackage.getFacet(HintsFacet.class).setInputType(InputType.JAVA_PACKAGE_PICKER);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
className.addValidator(new ClassNameValidator(false));,18a095c429860840b16cfbe760cb38a8b0947070,0,1
className.setDefaultValue(new Callable<String>() {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return getDefaultProducerClassName();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
className.getFacet(HintsFacet.class).setInputType(InputType.JAVA_CLASS_PICKER);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
builder.add(componentNameFilter).add(componentName).add(instanceName).add(targetPackage).add(className);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public NavigationResult next(UINavigationContext context) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"Map<Object, Object> attributeMap = context.getUIContext().getAttributeMap();",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"attributeMap.put(""componentName"", componentName.getValue().getScheme());",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"attributeMap.put(""instanceName"", instanceName.getValue());",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"attributeMap.put(""targetPackage"", targetPackage.getValue());",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"attributeMap.put(""className"", className.getValue());",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"attributeMap.put(""kind"", ""cdi"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Results.navigateTo(ConfigureComponentPropertiesStep.class);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public Result execute(UIExecutionContext context) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Results.success();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (!Strings.isBlank(name)) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return Strings.capitalize(name) + ""ComponentProducer"";",18a095c429860840b16cfbe760cb38a8b0947070,0,1
return null;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
/**,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Red Hat licenses this file to you under the Apache License, version",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  with the License.  You may obtain a copy of the License at,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Unless required by applicable law or agreed to in writing, software",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  implied.  See the License for the specific language governing,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  permissions and limitations under the License.,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*/,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"@FacetConstraint({JavaSourceFacet.class, ResourcesFacet.class, ClassLoaderFacet.class})",18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Inject,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"@WithAttributes(label = ""Filter"", required = false, description = ""To filter components"")",18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UISelectOne<String> componentNameFilter;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UISelectOne<ComponentDto> componentName;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UIInput<String> instanceName;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UIInput<String> targetPackage;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UIInput<String> className;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private DependencyInstaller dependencyInstaller;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private DependencyResolver dependencyResolver;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Override,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public UICommandMetadata getMetadata(UIContext context) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Metadata.forCommand(CamelNewComponentInstanceSpringCommand.class).name(,18a095c429860840b16cfbe760cb38a8b0947070,0,1
},18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (enabled) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return CamelCommandsHelper.isSpringProject(getSelectedProject(context));,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return false;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public void initializeUI(UIBuilder builder) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
final JavaSourceFacet facet = project.getFacet(JavaSourceFacet.class);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"componentNameFilter.setValueChoices(CamelCommandsHelper.createComponentLabelValues(project, getCamelCatalog()));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"componentNameFilter.setDefaultValue(""<all>"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"componentName.setValueChoices(CamelCommandsHelper.createComponentDtoValues(project, getCamelCatalog(), componentNameFilter, false));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// include converter from string->dto,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"componentName.setValueConverter(new Converter<String, ComponentDto>() {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
public ComponentDto convert(String text) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return createComponentDto(getCamelCatalog(), text);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
});,18a095c429860840b16cfbe760cb38a8b0947070,0,1
componentName.addValueChangeListener(new ValueChangeListener() {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public void valueChanged(ValueChangeEvent event) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (component != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"componentName.setNote(description != null ? description : """");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
} else {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"componentName.setNote("""");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
targetPackage.setCompleter(new PackageNameCompleter(facet));,18a095c429860840b16cfbe760cb38a8b0947070,0,1
targetPackage.addValidator(new PackageNameValidator());,18a095c429860840b16cfbe760cb38a8b0947070,0,1
targetPackage.getFacet(HintsFacet.class).setInputType(InputType.JAVA_PACKAGE_PICKER);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
className.addValidator(new ClassNameValidator(false));,18a095c429860840b16cfbe760cb38a8b0947070,0,1
className.setDefaultValue(new Callable<String>() {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return getDefaultProducerClassName();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
className.getFacet(HintsFacet.class).setInputType(InputType.JAVA_CLASS_PICKER);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
builder.add(componentNameFilter).add(componentName).add(instanceName).add(targetPackage).add(className);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public NavigationResult next(UINavigationContext context) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"Map<Object, Object> attributeMap = context.getUIContext().getAttributeMap();",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"attributeMap.put(""componentName"", componentName.getValue().getScheme());",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"attributeMap.put(""instanceName"", instanceName.getValue());",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"attributeMap.put(""targetPackage"", targetPackage.getValue());",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"attributeMap.put(""className"", className.getValue());",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"attributeMap.put(""kind"", ""spring"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Results.navigateTo(ConfigureComponentPropertiesStep.class);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public Result execute(UIExecutionContext context) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Results.success();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (!Strings.isBlank(name)) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return Strings.capitalize(name) + ""ComponentFactory"";",18a095c429860840b16cfbe760cb38a8b0947070,0,1
return null;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
/**,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Red Hat licenses this file to you under the Apache License, version",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  with the License.  You may obtain a copy of the License at,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Unless required by applicable law or agreed to in writing, software",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  implied.  See the License for the specific language governing,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  permissions and limitations under the License.,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*/,18a095c429860840b16cfbe760cb38a8b0947070,0,1
@FacetConstraint({ResourcesFacet.class}),18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Inject,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"@WithAttributes(label = ""Directory"", required = false, defaultValue = ""META-INF/spring"",",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"description = ""The directory name where this type will be created"")",18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UIInput<String> directory;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"@WithAttributes(label = ""XML File Name"", required = true, description = ""Name of XML file"")",18a095c429860840b16cfbe760cb38a8b0947070,0,1
private UIInput<String> name;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private DependencyInstaller dependencyInstaller;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private TemplateFactory factory;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
ResourceFactory resourceFactory;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Override,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (enabled) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
},18a095c429860840b16cfbe760cb38a8b0947070,0,1
return false;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public UICommandMetadata getMetadata(UIContext context) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Metadata.forCommand(CamelNewRouteBuilderCommand.class).name(,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"""Camel: New XML spring"").category(Categories.create(CATEGORY))",18a095c429860840b16cfbe760cb38a8b0947070,0,1
public void initializeUI(UIBuilder builder) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"name.addValidator(new ResourceNameValidator(""xml""));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
name.getFacet(HintsFacet.class).setInputType(InputType.FILE_PICKER);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
directory.getFacet(HintsFacet.class).setInputType(InputType.DIRECTORY_PICKER);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
builder.add(directory).add(name);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public Result execute(UIExecutionContext context) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
ResourcesFacet facet = project.getFacet(ResourcesFacet.class);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
FileResource<?> fileResource = facet.getResource(fileName);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (fileResource.exists()) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return Results.fail(""Spring XML file "" + fullName + "" already exists"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
Dependency core = findCamelCoreDependency(project);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (core == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
".setArtifactId(""camel-spring"").setVersion(core.getCoordinate().getVersion());",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// install camel-spring if missing,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (!dependencyInstaller.isManaged(project, spring)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"dependencyInstaller.install(project, spring);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"Resource<URL> xml = resourceFactory.create(getClass().getResource(""/templates/camel-spring.ftl"")).reify(URLResource.class);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"Template template = factory.create(xml, FreemarkerTemplate.class);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// any dynamic options goes into the params map,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"Map<String, Object> params = new HashMap<String, Object>();",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"params.put(""projectName"", projectName);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
fileResource.createNewFile();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
fileResource.setContents(output);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
/**,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Red Hat licenses this file to you under the Apache License, version",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  with the License.  You may obtain a copy of the License at,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Unless required by applicable law or agreed to in writing, software",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  implied.  See the License for the specific language governing,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  permissions and limitations under the License.,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*/,18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Inject,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private InputComponentFactory componentFactory;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private DependencyInstaller dependencyInstaller;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private DependencyResolver dependencyResolver;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private CamelCatalog camelCatalog;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private List<InputComponent> inputs = new ArrayList<>();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Override,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public UICommandMetadata getMetadata(UIContext context) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Metadata.forCommand(ConfigureComponentPropertiesStep.class).name(,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"""Camel: New Component"").category(Categories.create(CATEGORY))",18a095c429860840b16cfbe760cb38a8b0947070,0,1
},18a095c429860840b16cfbe760cb38a8b0947070,0,1
public void initializeUI(UIBuilder builder) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"Map<Object, Object> attributeMap = builder.getUIContext().getAttributeMap();",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (json == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (data != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
Set<String> namesAdded = new HashSet<>();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"for (Map<String, String> propertyMap : data) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (!Strings.isNullOrEmpty(name)) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"Class<Object> inputClazz = loadValidInputTypes(javaType, type);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (inputClazz != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (namesAdded.add(name)) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (input != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
builder.add(input);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
inputs.add(input);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public NavigationResult next(UINavigationContext context) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return null;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public Result execute(UIExecutionContext context) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"Map<Object, Object> attributeMap = context.getUIContext().getAttributeMap();",18a095c429860840b16cfbe760cb38a8b0947070,0,1
try {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
JavaSourceFacet facet = project.getFacet(JavaSourceFacet.class);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
Dependency core = CamelProjectHelper.findCamelCoreDependency(project);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (core == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
CamelComponentDetails details = new CamelComponentDetails();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"Result result = loadCamelComponentDetails(camelCatalog, camelComponentName, details);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (result != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return result;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"result = ensureCamelArtifactIdAdded(project, details, dependencyInstaller);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
JavaResource existing = facet.getJavaResource(fqn);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
final JavaClassSource javaClass = Roaster.create(JavaClassSource.class);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
javaClass.setName(generateClassName);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (generatePackageName != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
javaClass.setPackage(generatePackageName);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
StringBuilder buffer = new StringBuilder();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (input.hasValue()) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
Object value = input.getValue();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (value != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (value instanceof String) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (!Strings.isBlank(text)) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"valueExpression = ""\"""" + text + ""\"""";",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (value instanceof Number) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
valueExpression = value.toString();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (valueExpression != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"buffer.append(""\n"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"buffer.append(""component.set"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
buffer.append(Strings.capitalize(input.getName()));,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"buffer.append(""("");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
buffer.append(valueExpression);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"buffer.append("");"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (kind.equals(""cdi"")) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"CamelCommandsHelper.createCdiComponentProducerClass(javaClass, details, camelComponentName, componentInstanceName, configurationCode);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
} else {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"CamelCommandsHelper.createSpringComponentFactoryClass(javaClass, details, camelComponentName, componentInstanceName, configurationCode);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
facet.saveJavaSource(javaClass);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
} catch (IllegalArgumentException e) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Results.fail(e.getMessage());,18a095c429860840b16cfbe760cb38a8b0947070,0,1
* @throws IllegalArgumentException if the value is not available in the given attribute map,18a095c429860840b16cfbe760cb38a8b0947070,0,1
Object value = attributeMap.get(name);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return text;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"throw new IllegalArgumentException(""The attribute value '"" + name + ""' did not get passed on from the previous wizard page"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
/**,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Red Hat licenses this file to you under the Apache License, version",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  with the License.  You may obtain a copy of the License at,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Unless required by applicable law or agreed to in writing, software",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  implied.  See the License for the specific language governing,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  permissions and limitations under the License.,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*/,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private final DependencyInstaller dependencyInstaller;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private final CamelCatalog camelCatalog;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private final List<InputComponent> allInputs;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private final List<InputComponent> inputs;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private final int index;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private final int total;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"public ConfigureEndpointPropertiesStep(ProjectFactory projectFactory,",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"DependencyInstaller dependencyInstaller,",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"CamelCatalog camelCatalog,",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"List<InputComponent> allInputs,",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"List<InputComponent> inputs,",18a095c429860840b16cfbe760cb38a8b0947070,0,1
this.projectFactory = projectFactory;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
this.dependencyInstaller = dependencyInstaller;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
this.camelCatalog = camelCatalog;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
this.componentName = componentName;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
this.group = group;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
this.allInputs = allInputs;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
this.inputs = inputs;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
this.last = last;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// we want to 1-based,18a095c429860840b16cfbe760cb38a8b0947070,0,1
this.index = index + 1;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
this.total = total;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
},18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Override,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public UICommandMetadata getMetadata(UIContext context) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Metadata.forCommand(ConfigureEndpointPropertiesStep.class).name(,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"""Camel: Endpoint options"").category(Categories.create(CATEGORY))",18a095c429860840b16cfbe760cb38a8b0947070,0,1
".description(String.format(""Configure %s options (%s of %s)"", group, index, total));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"@SuppressWarnings(""unchecked"")",18a095c429860840b16cfbe760cb38a8b0947070,0,1
public void initializeUI(UIBuilder builder) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (inputs != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
builder.add(input);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public NavigationResult next(UINavigationContext context) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return null;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public Result execute(UIExecutionContext context) throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"Map<Object, Object> attributeMap = context.getUIContext().getAttributeMap();",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// only execute if we are last,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (last) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (""xml"".equals(kind)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return executeXml(context, attributeMap);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
} else {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return executeJava(context, attributeMap);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"protected Result executeXml(UIExecutionContext context, Map<Object, Object> attributeMap) throws Exception {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// edit mode includes the existing uri and line number,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (""edit"".equals(mode)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"lineNumber = mandatoryAttributeValue(attributeMap, ""lineNumber"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"endpointUrl = mandatoryAttributeValue(attributeMap, ""endpointUri"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// since this is XML we need to escape & as &amp;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// to be safe that & is not already &amp; we need to revert it first,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"endpointUrl = StringHelper.replaceAll(endpointUrl, ""&amp;"", ""&"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"endpointUrl = StringHelper.replaceAll(endpointUrl, ""&"", ""&amp;"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"endpointUrl = StringHelper.replaceAll(endpointUrl, ""<"", ""&lt;"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"endpointUrl = StringHelper.replaceAll(endpointUrl, "">"", ""&gt;"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
ResourcesFacet facet = project.getFacet(ResourcesFacet.class);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
WebResourcesFacet webResourcesFacet = null;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (project.hasFacet(WebResourcesFacet.class)) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
webResourcesFacet = project.getFacet(WebResourcesFacet.class);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
Dependency core = CamelProjectHelper.findCamelCoreDependency(project);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (core == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
CamelComponentDetails details = new CamelComponentDetails();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"Result result = loadCamelComponentDetails(camelCatalog, camelComponentName, details);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (result != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return result;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// and make sure its dependency is added,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"result = ensureCamelArtifactIdAdded(project, details, dependencyInstaller);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"Map<String, String> options = new HashMap<String, String>();",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (input.hasValue()) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (value != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// do not add the value if it match the default value,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (!matchDefault) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"options.put(key, value);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// if its required then we need to grab the value,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (uri == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
FileResource file = facet != null ? facet.getResource(xml) : null;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (file == null || !file.exists()) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
file = webResourcesFacet != null ? webResourcesFacet.getWebResource(xml) : null;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// if we have a line number then use that to edit the existing value,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (lineNumber != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
List<String> lines = LineNumberHelper.readLines(file.getResourceInputStream());,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return editEndpointXml(lines, lineNumber, endpointUrl, uri, file, xml);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
Document root = XmlLineNumberParser.parseXml(file.getResourceInputStream());,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return addEndpointXml(root, endpointInstanceName, uri, file, xml);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"// the list is 0-based, and line number is 1-based",18a095c429860840b16cfbe760cb38a8b0947070,0,1
int idx = Integer.valueOf(lineNumber) - 1;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// replace uri with new value,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"line = StringHelper.replaceAll(line, endpointUrl, uri);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"lines.set(idx, line);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// and save the file back,18a095c429860840b16cfbe760cb38a8b0947070,0,1
file.setContents(content);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return Results.success(""Update endpoint uri: "" + uri + "" in file "" + xml);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// The DOM api is so fucking terrible!,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (root != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"NodeList camels = root.getElementsByTagName(""camelContext"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// TODO: what about 2+ camel's ?,18a095c429860840b16cfbe760cb38a8b0947070,0,1
Node camelContext = null;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
Node found = null;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
for (int i = 0; i < camel.getChildNodes().getLength(); i++) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (""camelContext"".equals(camel.getNodeName())) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
camelContext = camel;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
Node child = camel.getChildNodes().item(i);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (""camelContext"".equals(child.getNodeName())) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
camelContext = child;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (""endpoint"".equals(child.getNodeName())) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// okay its an endpoint so if we can match by id attribute,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (endpointInstanceName.equals(id)) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
found = child;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
break;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
int extraSpaces = 0;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
int extraLines = 0;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (found == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
created = true;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
found = insertEndpointBefore(camel);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// empty so use <camelContext> node,18a095c429860840b16cfbe760cb38a8b0947070,0,1
found = camelContext;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
extraSpaces = 2;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
extraLines = 1;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
lineNumber = (String) found.getUserData(XmlLineNumberParser.LINE_NUMBER);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"// if we created a new endpoint, then insert a new line with the endpoint details",18a095c429860840b16cfbe760cb38a8b0947070,0,1
int idx = lineNumber != null ? Integer.valueOf(lineNumber) - 1 : 0;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
idx += extraLines;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"int spaces = LineNumberHelper.leadingSpaces(lines, idx) + extraSpaces;",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"line = LineNumberHelper.padString(line, spaces);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (created) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"lines.add(idx, line);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return Results.success(""Added endpoint uri: "" + uri + "" in XML file "" + xml);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"protected Result executeJava(UIExecutionContext context, Map<Object, Object> attributeMap) throws Exception {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
JavaSourceFacet facet = project.getFacet(JavaSourceFacet.class);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
JavaResource existing = facet.getJavaResource(routeBuilder);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (existing == null || !existing.exists()) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return Results.fail(""RouteBuilder "" + routeBuilder + "" does not exist"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
JavaClassSource clazz = existing.getJavaType();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (endpointInstanceName != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// add the endpoint as a field,18a095c429860840b16cfbe760cb38a8b0947070,0,1
FieldSource field = clazz.getField(endpointInstanceName);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
AnnotationSource annotation;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (field == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
field = clazz.addField();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
field.setName(endpointInstanceName);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"field.setType(""org.apache.camel.Endpoint"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
field.setPrivate();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
updated = false;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (cdi) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (!field.hasAnnotation(""javax.inject.Inject"")) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"field.addAnnotation(""javax.inject.Inject"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (!field.hasAnnotation(""org.apache.camel.cdi.Uri"")) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"field.addAnnotation(""org.apache.camel.cdi.Uri"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"annotation = field.getAnnotation(""org.apache.camel.cdi.Uri"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
annotation.setStringValue(uri);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (!field.hasAnnotation(""org.apache.camel.EndpointInject"")) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"field.addAnnotation(""org.apache.camel.EndpointInject"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"annotation = field.getAnnotation(""org.apache.camel.EndpointInject"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"annotation.setStringValue(""uri"", uri);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"clazz.addImport(""org.apache.camel.Endpoint"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"clazz.addImport(""javax.inject.Inject"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"clazz.addImport(""org.apache.camel.cdi.Uri"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"clazz.addImport(""org.apache.camel.EndpointInject"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
facet.saveJavaSource(clazz);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (updated) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return Results.success(""Updated endpoint "" + endpointInstanceName + "" in "" + routeBuilder);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return Results.success(""Added endpoint "" + endpointInstanceName + "" in "" + routeBuilder);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
MethodSource<JavaClassSource> method = CamelJavaParserHelper.findConfigureMethod(clazz);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (method != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// we do not want to change the current code formatting so we need to search,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"// wonder if we should have better way, than a replaceFirst?",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"code = code.replaceFirst(find, uri);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// use this code currently to save content unformatted,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"existing.setContents(new ByteArrayInputStream(code.getBytes()), null);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return Results.success(""Updated endpoint "" + endpointUrl + "" -> "" + uri + "" in "" + routeBuilder);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return Results.fail(""Cannot update endpoint"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
private Node insertEndpointBefore(Node camel) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// if there is endpoints then the cut-off is after the last,18a095c429860840b16cfbe760cb38a8b0947070,0,1
Node endpoint = null;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
Node found = camel.getChildNodes().item(i);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (""endpoint"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
endpoint = found;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (endpoint != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return endpoint;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
Node last = null;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (""dataFormats"".equals(name) || ""redeliveryPolicyProfile"".equals(name)",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"|| ""onException"".equals(name) || ""onCompletion"".equals(name)",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"|| ""intercept"".equals(name) || ""interceptFrom"".equals(name)",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"|| ""interceptSendToEndpoint"".equals(name) || ""restConfiguration"".equals(name)",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"|| ""rest"".equals(name) || ""route"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
return found;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (found.getNodeType() == Node.ELEMENT_NODE) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
last = found;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return last;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
* @throws IllegalArgumentException if the value is not available in the given attribute map,18a095c429860840b16cfbe760cb38a8b0947070,0,1
Object value = attributeMap.get(name);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (!Strings.isBlank(text)) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return text;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"throw new IllegalArgumentException(""The attribute value '"" + name + ""' did not get passed on from the previous wizard page"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
/**,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Red Hat licenses this file to you under the Apache License, version",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  with the License.  You may obtain a copy of the License at,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Unless required by applicable law or agreed to in writing, software",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  implied.  See the License for the specific language governing,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  permissions and limitations under the License.,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*/,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private final Logger logger = Logger.getLogger(getClass().getName());,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private ArchetypeCatalog cachedArchetypes;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return NAME;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
},18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Override,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public ArchetypeCatalog getArchetypeCatalog() {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (cachedArchetypes == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (xml != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
try {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
cachedArchetypes = new ArchetypeCatalogXpp3Reader().read(new StringReader(xml));,18a095c429860840b16cfbe760cb38a8b0947070,0,1
} catch (Exception e) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"logger.log(Level.SEVERE, ""Error while retrieving archetypes"", e);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
return cachedArchetypes;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (this == o) return true;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (o == null || getClass() != o.getClass()) return false;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
CamelArchetypeCatalogFactory that = (CamelArchetypeCatalogFactory) o;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (!NAME.equals(that.NAME)) return false;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return true;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public int hashCode() {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return NAME.hashCode();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
/**,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Red Hat licenses this file to you under the Apache License, version",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  with the License.  You may obtain a copy of the License at,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Unless required by applicable law or agreed to in writing, software",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  implied.  See the License for the specific language governing,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  permissions and limitations under the License.,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*/,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private final CamelCatalog camelCatalog;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private final Dependency core;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"public CamelComponentsLabelCompleter(Project project, CamelCatalog camelCatalog) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
this.project = project;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
this.camelCatalog = camelCatalog;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
this.core = CamelProjectHelper.findCamelCoreDependency(project);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
},18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Override,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (core == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return null;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
Iterable<String> names = getValueChoices();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
List<String> filtered = new ArrayList<String>();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
for (String name : names) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (value == null || name.startsWith(value)) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
filtered.add(name);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return filtered;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public Iterable<String> getValueChoices() {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
Set<String> names = camelCatalog.findComponentLabels();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"names.add(""<all>"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
return names;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
/**,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Red Hat licenses this file to you under the Apache License, version",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  with the License.  You may obtain a copy of the License at,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Unless required by applicable law or agreed to in writing, software",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  implied.  See the License for the specific language governing,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  permissions and limitations under the License.,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*/,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private final CamelCatalog camelCatalog;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private final Dependency core;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"public CamelDataFormatsCompleter(Project project, CamelCatalog camelCatalog) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
this.project = project;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
this.camelCatalog = camelCatalog;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
core = CamelProjectHelper.findCamelCoreDependency(project);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
},18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Override,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (core == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return null;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
List<DataFormatDto> answer = new ArrayList<>();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
List<String> names = camelCatalog.findDataFormatNames();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// filter non matching names first,18a095c429860840b16cfbe760cb38a8b0947070,0,1
List<String> filtered = new ArrayList<String>();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
for (String name : names) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (value == null || name.startsWith(value)) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
filtered.add(name);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// filter names which are already on the classpath,18a095c429860840b16cfbe760cb38a8b0947070,0,1
for (String name : filtered) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// skip if we already have the dependency,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (artifactId != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"already = CamelProjectHelper.hasDependency(project, ""org.apache.camel"", artifactId);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (!already) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"DataFormatDto dto = createDataFormatDto(camelCatalog, json);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
answer.add(dto);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return answer;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public Iterable<DataFormatDto> getValueChoices() {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// filter out existing dataformats we already have,18a095c429860840b16cfbe760cb38a8b0947070,0,1
Set<Dependency> artifacts = findCamelArtifacts(project);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
for (Dependency dep : artifacts) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
names.removeAll(languages);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"DataFormatDto dto = createDataFormatDto(camelCatalog, name);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"for (Map<String, String> row : data) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (row.get(""artifactId"") != null) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return row.get(""artifactId"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
/**,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Red Hat licenses this file to you under the Apache License, version",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  with the License.  You may obtain a copy of the License at,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Unless required by applicable law or agreed to in writing, software",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  implied.  See the License for the specific language governing,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  permissions and limitations under the License.,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*/,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private final CamelCatalog camelCatalog;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private final Dependency core;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"public CamelLanguagesCompleter(Project project, CamelCatalog camelCatalog) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
this.project = project;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
this.camelCatalog = camelCatalog;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
core = CamelProjectHelper.findCamelCoreDependency(project);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
},18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Override,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (core == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return null;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
List<LanguageDto> answer = new ArrayList<>();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
List<String> names = camelCatalog.findLanguageNames();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// filter non matching names first,18a095c429860840b16cfbe760cb38a8b0947070,0,1
List<String> filtered = new ArrayList<String>();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
for (String name : names) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (value == null || name.startsWith(value)) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
filtered.add(name);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// filter names which are already on the classpath,18a095c429860840b16cfbe760cb38a8b0947070,0,1
for (String name : filtered) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// skip if we already have the dependency,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (artifactId != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"already = CamelProjectHelper.hasDependency(project, ""org.apache.camel"", artifactId);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (!already) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"LanguageDto dto = createLanguageDto(camelCatalog, json);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
answer.add(dto);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return answer;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public Iterable<LanguageDto> getValueChoices() {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
Set<Dependency> artifacts = findCamelArtifacts(project);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
for (Dependency dep : artifacts) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
names.removeAll(languages);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"LanguageDto dto = createLanguageDto(camelCatalog, name);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"for (Map<String, String> row : data) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (row.get(""artifactId"") != null) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return row.get(""artifactId"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
/**,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Red Hat licenses this file to you under the Apache License, version",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  with the License.  You may obtain a copy of the License at,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Unless required by applicable law or agreed to in writing, software",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  implied.  See the License for the specific language governing,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  permissions and limitations under the License.,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*/,18a095c429860840b16cfbe760cb38a8b0947070,0,1
private final Set<String> routeBuilders = new TreeSet<String>();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public RouteBuilderCompleter(JavaSourceFacet facet) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
facet.visitJavaSources(new JavaResourceVisitor() {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Override,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"public void visit(VisitContext context, JavaResource javaResource) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
try {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
JavaClass clazz = javaResource.getJavaType();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
routeBuilders.add(clazz.getQualifiedName());,18a095c429860840b16cfbe760cb38a8b0947070,0,1
},18a095c429860840b16cfbe760cb38a8b0947070,0,1
} catch (FileNotFoundException e) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// ignore,18a095c429860840b16cfbe760cb38a8b0947070,0,1
});,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public Set<String> getRouteBuilders() {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return routeBuilders;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
List<String> answer = new ArrayList<String>();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
for (String name : routeBuilders) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (value == null || name.startsWith(value)) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
answer.add(name);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return answer;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
/**,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Red Hat licenses this file to you under the Apache License, version",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  with the License.  You may obtain a copy of the License at,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Unless required by applicable law or agreed to in writing, software",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  implied.  See the License for the specific language governing,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  permissions and limitations under the License.,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*/,18a095c429860840b16cfbe760cb38a8b0947070,0,1
* Returns the text in title case,18a095c429860840b16cfbe760cb38a8b0947070,0,1
StringBuilder sb = new StringBuilder();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
for (char c : text.toCharArray()) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (Character.isSpaceChar(c)) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
next = true;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
} else if (next) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
c = Character.toTitleCase(c);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
next = false;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
},18a095c429860840b16cfbe760cb38a8b0947070,0,1
sb.append(c);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return sb.toString();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (uri != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"int idx = uri.indexOf("":"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (idx > 0) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return uri.substring(0, idx);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
return null;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
Set<String> answer = new TreeSet<String>();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
for (String name : camelCatalog.findComponentNames()) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (json != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"for (Map<String, String> row : data) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (row.get(""artifactId"") != null) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"artifact = row.get(""artifactId"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (row.get(""scheme"") != null) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"scheme = row.get(""scheme"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
answer.add(scheme);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return answer;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
for (String name : camelCatalog.findDataFormatNames()) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (row.get(""name"") != null) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"df = row.get(""name"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
answer.add(df);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
for (String name : camelCatalog.findLanguageNames()) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"lan = row.get(""name"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
answer.add(lan);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
* Checks whether the given value is matching the default value from the given component.,18a095c429860840b16cfbe760cb38a8b0947070,0,1
* @param key    the option key,18a095c429860840b16cfbe760cb38a8b0947070,0,1
* @param value  the option value,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"* @return <tt>true</tt> if matching the default value, <tt>false</tt> otherwise",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (json == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (data != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"for (Map<String, String> propertyMap : data) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (key.equals(name)) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return value.equalsIgnoreCase(defaultValue);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return false;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (consumerOnly != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return true;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
ComponentDto dto = new ComponentDto();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"dto.setScheme(row.get(""scheme""));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (row.get(""syntax"") != null) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"dto.setSyntax(row.get(""syntax""));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (row.get(""title"") != null) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"dto.setTitle(row.get(""title""));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (row.get(""description"") != null) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"dto.setDescription(row.get(""description""));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (row.get(""label"") != null) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (Strings.isNotBlank(labelText)) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"dto.setTags(labelText.split("",""));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (row.get(""javaType"") != null) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"dto.setJavaType(row.get(""javaType""));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (row.get(""groupId"") != null) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"dto.setGroupId(row.get(""groupId""));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (row.get(""artifactId"") != null) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"dto.setArtifactId(row.get(""artifactId""));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (row.get(""version"") != null) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"dto.setVersion(row.get(""version""));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
return dto;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
DataFormatDto dto = new DataFormatDto();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"dto.setName(row.get(""name""));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (row.get(""modelName"") != null) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"dto.setModelName(row.get(""modelName""));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"dto.setLabel(row.get(""label""));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (row.get(""modelJavaType"") != null) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"dto.setModelJavaType(row.get(""modelJavaType""));",18a095c429860840b16cfbe760cb38a8b0947070,0,1
LanguageDto dto = new LanguageDto();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
/**,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Red Hat licenses this file to you under the Apache License, version",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  with the License.  You may obtain a copy of the License at,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  Unless required by applicable law or agreed to in writing, software",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  implied.  See the License for the specific language governing,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*  permissions and limitations under the License.,18a095c429860840b16cfbe760cb38a8b0947070,0,1
*/,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return new CamelComponentsLabelCompleter(project, camelCatalog).getValueChoices();",18a095c429860840b16cfbe760cb38a8b0947070,0,1
},18a095c429860840b16cfbe760cb38a8b0947070,0,1
"final UISelectOne<String> componentCategoryFilter,",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// use callable so we can live update the filter,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return new Callable<Iterable<ComponentDto>>() {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
@Override,18a095c429860840b16cfbe760cb38a8b0947070,0,1
public Iterable<ComponentDto> call() throws Exception {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return new CamelComponentsCompleter(project, camelCatalog, null, excludeComponentsOnClasspath).getValueChoices(label);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
};,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"* Populates the details for the given component, returning a Result if it fails.",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (json == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"for (Map<String, String> row : data) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (!Strings.isNullOrEmpty(javaType)) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
details.setComponentClassQName(javaType);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (!Strings.isNullOrEmpty(groupId)) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
details.setGroupId(groupId);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (!Strings.isNullOrEmpty(artifactId)) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
details.setArtifactId(artifactId);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (!Strings.isNullOrEmpty(version)) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
details.setVersion(version);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (Strings.isNullOrEmpty(details.getComponentClassQName())) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return null;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
Dependency core = CamelProjectHelper.findCamelCoreDependency(project);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (core == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// otherwise use the version from the dto,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (""org.apache.camel"".equals(groupId)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
version = core.getCoordinate().getVersion();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
} else {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
version = details.getVersion();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
.setArtifactId(artifactId).setVersion(version);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"dependencyInstaller.install(project, component);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
return CamelProjectHelper.findCamelCDIDependency(project) != null;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return CamelProjectHelper.findCamelSpringDependency(project) != null;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return CamelProjectHelper.findCamelBlueprintDependency(project) != null;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"javaClass.addImport(""javax.enterprise.inject.Produces"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"javaClass.addImport(""javax.inject.Singleton"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"javaClass.addImport(""javax.inject.Named"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
javaClass.addImport(details.getComponentClassQName());,18a095c429860840b16cfbe760cb38a8b0947070,0,1
MethodSource<JavaClassSource> method = javaClass.addMethod(),18a095c429860840b16cfbe760cb38a8b0947070,0,1
.setPublic(),18a095c429860840b16cfbe760cb38a8b0947070,0,1
.setReturnType(componentClassName),18a095c429860840b16cfbe760cb38a8b0947070,0,1
.setName(methodName),18a095c429860840b16cfbe760cb38a8b0947070,0,1
.setBody(body),18a095c429860840b16cfbe760cb38a8b0947070,0,1
.addThrows(Exception.class);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"method.addAnnotation(""Named"").setStringValue(camelComponentName);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"method.addAnnotation(""Produces"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"method.addAnnotation(""Singleton"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"javaClass.addAnnotation(""Component"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"javaClass.addImport(""org.springframework.beans.factory.config.BeanDefinition"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"javaClass.addImport(""org.springframework.beans.factory.annotation.Qualifier"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"javaClass.addImport(""org.springframework.context.annotation.Bean"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"javaClass.addImport(""org.springframework.context.annotation.Scope"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"javaClass.addImport(""org.springframework.stereotype.Component"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"method.addAnnotation(""Qualifier"").setStringValue(camelComponentName);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"method.addAnnotation(""Bean"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"method.addAnnotation(""Scope"").setLiteralValue(""BeanDefinition.SCOPE_SINGLETON"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"// we have generics in the javatype, if so remove it so its loadable from a classloader",18a095c429860840b16cfbe760cb38a8b0947070,0,1
int idx = javaType.indexOf('<');,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (idx > 0) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"javaType = javaType.substring(0, idx);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
try {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
Class<Object> clazz = getPrimitiveWrapperClassType(type);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (clazz == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
clazz = loadPrimitiveWrapperType(javaType);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
clazz = loadStringSupportedType(javaType);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
clazz = (Class<Object>) Class.forName(javaType);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
} catch (Throwable e) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (""object"".equals(type)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"clazz = loadPrimitiveWrapperType(""java.lang.String"");",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// favor specialized UI for these types,18a095c429860840b16cfbe760cb38a8b0947070,0,1
|| clazz.isPrimitive() || Number.class.isAssignableFrom(clazz))) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return clazz;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// ignore errors,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (""java.io.File"".equals(javaType)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
return String.class;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""java.net.URL"".equals(javaType)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""java.net.URI"".equals(javaType)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
* Gets the JSon schema primitive type.,18a095c429860840b16cfbe760cb38a8b0947070,0,1
* @param name the json type,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (""string"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""boolean"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Boolean.class;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""integer"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Integer.class;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""number"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Float.class;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// special for byte[] or Object[] as its common to use,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (""java.lang.byte[]"".equals(name) || ""byte[]"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Byte[].class;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""java.lang.Byte[]"".equals(name) || ""Byte[]"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""java.lang.Object[]"".equals(name) || ""Object[]"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Object[].class;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""java.lang.String[]"".equals(name) || ""String[]"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
return String[].class;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// and these is common as well,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""java.lang.String"".equals(name) || ""String"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""java.lang.Boolean"".equals(name) || ""Boolean"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""java.lang.Integer"".equals(name) || ""Integer"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""int"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""java.lang.Long"".equals(name) || ""Long"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Long.class;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""long"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""java.lang.Short"".equals(name) || ""Short"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Short.class;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""short"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""java.lang.Byte"".equals(name) || ""Byte"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Byte.class;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""byte"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""java.lang.Float"".equals(name) || ""Float"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""float"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""java.lang.Double"".equals(name) || ""Double"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Double.class;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""double"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""java.lang.Character"".equals(name) || ""Character"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
return Character.class;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"} else if (""char"".equals(name)) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"CamelCatalog camelCatalog, InputComponentFactory componentFactory, ConverterFactory converterFactory, UIContext ui) throws Exception {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
List<EndpointOptionByGroup> answer = new ArrayList<>();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
camelComponentName = endpointComponentName(uri);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (componentConsumerOnly || componentProducerOnly) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
consumerOnly = false;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
producerOnly = false;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"Map<String, String> currentValues = uri != null ? camelCatalog.endpointProperties(uri) : Collections.EMPTY_MAP;",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (data != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
List<InputComponent> inputs = new ArrayList<>();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
EndpointOptionByGroup current = new EndpointOptionByGroup();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
current.setGroup(null);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
current.setInputs(inputs);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
Set<String> namesAdded = new HashSet<>();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"for (Map<String, String> propertyMap : data) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (current.getGroup() == null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
current.setGroup(group);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// its a new group,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (!current.getInputs().isEmpty()) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// this group is now done so add to answer,18a095c429860840b16cfbe760cb38a8b0947070,0,1
answer.add(current);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// get ready for a new group,18a095c429860840b16cfbe760cb38a8b0947070,0,1
inputs = new ArrayList<>();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
current = new EndpointOptionByGroup();,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// filter out options in case we should only include consumers or producers only,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (!label.contains(""consumer"")) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
continue;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (!label.contains(""producer"")) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (!Strings.isNullOrEmpty(name)) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"Class<Object> inputClazz = CamelCommandsHelper.loadValidInputTypes(javaType, type);",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (inputClazz != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (namesAdded.add(name)) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// we do not want descriptions in CLI mode as it makes the UI clutter,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (!gui) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"description = """";",18a095c429860840b16cfbe760cb38a8b0947070,0,1
// if its an enum and its optional then make sure there is a default value,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// if no default value exists then add none as the 1st choice default value,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// otherwise the GUI makes us force to select an option which is not what we want,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (defaultValue == null || defaultValue.isEmpty()) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"defaultValue = ""none"";",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"if (!enums.startsWith(""none,"")) {",18a095c429860840b16cfbe760cb38a8b0947070,0,1
"enums = ""none,"" + enums;",18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (input != null) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
inputs.add(input);,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (inputs.size() == maxOptionsPerPage) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
// add last group if there was some new inputs,18a095c429860840b16cfbe760cb38a8b0947070,0,1
if (!inputs.isEmpty()) {,18a095c429860840b16cfbe760cb38a8b0947070,0,1
return answer;,18a095c429860840b16cfbe760cb38a8b0947070,0,1
"return Results.success(""Added Camel component "" + dto.getScheme() + "" ("" + dto.getArtifactId() + "") to the project"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,11,1
"return Results.success(""Added Camel language "" + dto.getName() + "" ("" + dto.getArtifactId() + "") to the project"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,11,1
"return Results.success(""Added Camel dataformat "" + dto.getName() + "" ("" + dto.getArtifactId() + "") to the project"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,10,1
".description(""Creates a new Spring XML file with CamelContext to your project"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,9,1
".description(""Adds a Camel component to your project dependencies"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,7,1
".description(""Adds a Camel language to your project dependencies"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,7,1
"return Results.fail(""Blueprint XML file "" + fullName + "" already exists"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,7,1
"return Results.fail(""A class with name "" + fqn + "" already exists"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,7,1
"return Results.fail(""Spring XML file "" + fullName + "" already exists"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,7,1
"return Results.success(""Created new Spring XML file "" + fullName);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,7,1
"return Results.fail(""A class with name "" + fqn + "" already exists"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,7,1
".description(""Adds a Camel dataformat to your project dependencies"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,6,1
"String fullName = ""src"" + File.separator + ""main"" + File.separator + ""resources"" + File.separator + fileName;",28f4ca17e3b02b68edfb79d951babe0a5c98b300,6,1
"return Results.success(""Created new Blueprint XML file "" + fullName);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,6,1
".description(""Creates a new Camel component instance configuration using CDI"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,6,1
".description(""Creates a new Camel component instance configuration using Spring"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,6,1
"return Results.success(""Created new RouteBuilder class "" + name.getValue());",28f4ca17e3b02b68edfb79d951babe0a5c98b300,6,1
"String fullName = ""src"" + File.separator + ""main"" + File.separator + ""resources"" + File.separator + fileName;",28f4ca17e3b02b68edfb79d951babe0a5c98b300,6,1
".description(""Creates a new Blueprint XML file with CamelContext"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,5,1
public class CamelNewComponentInstanceCDICommand extends AbstractCamelProjectCommand implements UIWizard {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,5,1
public class CamelNewComponentInstanceSpringCommand extends AbstractCamelProjectCommand implements UIWizard {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,5,1
"@WithAttributes(label = ""Class Name"", required = true, description = ""Name of the Spring Component class to generate"")",28f4ca17e3b02b68edfb79d951babe0a5c98b300,5,1
// need to parse to be able to extends another class,28f4ca17e3b02b68edfb79d951babe0a5c98b300,5,1
public class ConfigureComponentPropertiesStep extends AbstractCamelProjectCommand implements UIWizardStep {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,5,1
"throw new IllegalArgumentException(""Could not find catalog entry for component name: "" + camelComponentName);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,5,1
// need to parse to be able to extends another class,28f4ca17e3b02b68edfb79d951babe0a5c98b300,5,1
"return Results.success(""Created new class "" + generateClassName);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,5,1
public class CamelAddComponentCommand extends AbstractCamelProjectCommand {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,4,1
public class CamelAddDataFormatCommand extends AbstractCamelProjectCommand {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,4,1
public class CamelAddLanguageCommand extends AbstractCamelProjectCommand {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,4,1
public class CamelNewBlueprintXmlCommand extends AbstractCamelProjectCommand {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,4,1
// this will get a file in the src/main/resources directory where we want to store the spring xml file,28f4ca17e3b02b68edfb79d951babe0a5c98b300,4,1
"@WithAttributes(label = ""Instance Name"", required = true, description = ""Name of component instance to add"")",28f4ca17e3b02b68edfb79d951babe0a5c98b300,4,1
"@WithAttributes(label = ""Instance Name"", required = true, description = ""Name of component instance to add"")",28f4ca17e3b02b68edfb79d951babe0a5c98b300,4,1
public class CamelNewRouteBuilderCommand extends AbstractCamelProjectCommand {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,4,1
public class CamelNewSpringXmlCommand extends AbstractCamelProjectCommand {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,4,1
// this will get a file in the src/main/resources directory where we want to store the spring xml file,28f4ca17e3b02b68edfb79d951babe0a5c98b300,4,1
// lets create a field for each property on the component,28f4ca17e3b02b68edfb79d951babe0a5c98b300,4,1
"throw new IllegalArgumentException(""The attribute value '"" + name + ""' did not get passed on from the previous wizard page"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,4,1
"@WithAttributes(label = ""Name"", required = true, description = ""Name of component type to add"")",28f4ca17e3b02b68edfb79d951babe0a5c98b300,3,1
"""Camel: Add Component"").category(Categories.create(CATEGORY))",28f4ca17e3b02b68edfb79d951babe0a5c98b300,3,1
// we want to use same version as camel-core if its a camel component,28f4ca17e3b02b68edfb79d951babe0a5c98b300,3,1
"""Camel: Add DataFormat"").category(Categories.create(CATEGORY))",28f4ca17e3b02b68edfb79d951babe0a5c98b300,3,1
"@WithAttributes(label = ""Name"", required = true, description = ""Name of language to add"")",28f4ca17e3b02b68edfb79d951babe0a5c98b300,3,1
"""Camel: Add Language"").category(Categories.create(CATEGORY))",28f4ca17e3b02b68edfb79d951babe0a5c98b300,3,1
"""Camel: New XML blueprint"").category(Categories.create(CATEGORY))",28f4ca17e3b02b68edfb79d951babe0a5c98b300,3,1
// create the new file and set the content,28f4ca17e3b02b68edfb79d951babe0a5c98b300,3,1
"@WithAttributes(label = ""Component Name"", required = true, description = ""Name of component type to add"")",28f4ca17e3b02b68edfb79d951babe0a5c98b300,3,1
"""Camel: New Component CDI"").category(Categories.create(CATEGORY))",28f4ca17e3b02b68edfb79d951babe0a5c98b300,3,1
"@WithAttributes(label = ""Component Name"", required = true, description = ""Name of component type to add"")",28f4ca17e3b02b68edfb79d951babe0a5c98b300,3,1
"""Camel: New Component Spring"").category(Categories.create(CATEGORY))",28f4ca17e3b02b68edfb79d951babe0a5c98b300,3,1
"""Camel: New RouteBuilder"").category(Categories.create(CATEGORY))",28f4ca17e3b02b68edfb79d951babe0a5c98b300,3,1
".description(""Creates a new Camel RouteBuilder class"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,3,1
// do we already have a class with the name,28f4ca17e3b02b68edfb79d951babe0a5c98b300,3,1
"""Camel: New XML spring"").category(Categories.create(CATEGORY))",28f4ca17e3b02b68edfb79d951babe0a5c98b300,3,1
// create the new file and set the content,28f4ca17e3b02b68edfb79d951babe0a5c98b300,3,1
"""Camel: New Component"").category(Categories.create(CATEGORY))",28f4ca17e3b02b68edfb79d951babe0a5c98b300,3,1
// do we already have a class with the name,28f4ca17e3b02b68edfb79d951babe0a5c98b300,3,1
"*  Red Hat licenses this file to you under the Apache License, version",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
*  implied.  See the License for the specific language governing,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
final Project project = getSelectedProject(builder);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
Project project = getSelectedProject(context);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"return Results.fail(""The project does not include camel-core"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"return Results.fail(""Unknown Camel component"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"*  Red Hat licenses this file to you under the Apache License, version",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
*  implied.  See the License for the specific language governing,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"@WithAttributes(label = ""Name"", required = true, description = ""Name of dataformat to add"")",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
Project project = getSelectedProject(builder);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
Project project = getSelectedProject(context);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"return Results.fail(""The project does not include camel-core"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"return Results.fail(""Unknown Camel dataformat"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"*  Red Hat licenses this file to you under the Apache License, version",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
*  implied.  See the License for the specific language governing,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
Project project = getSelectedProject(builder);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
Project project = getSelectedProject(context);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"return Results.fail(""The project does not include camel-core"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"return Results.fail(""Unknown Camel language"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"*  Red Hat licenses this file to you under the Apache License, version",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
*  implied.  See the License for the specific language governing,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"description = ""The directory name where this type will be created"")",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"@WithAttributes(label = ""File Name"", required = true, description = ""Name of XML file"")",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
Project project = getSelectedProject(context);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
String fileName = directory.getValue() != null ? directory.getValue() + File.separator + name.getValue() : name.getValue();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"return Results.fail(""The project does not include camel-core"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"*  Red Hat licenses this file to you under the Apache License, version",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
*  implied.  See the License for the specific language governing,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"@WithAttributes(label = ""Package Name"", required = false, description = ""The package name where this type will be created"")",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
Project project = getSelectedProject(builder.getUIContext());,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"return Strings.capitalize(name) + ""ComponentProducer"";",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"*  Red Hat licenses this file to you under the Apache License, version",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
*  implied.  See the License for the specific language governing,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"@WithAttributes(label = ""Target Package"", required = false, description = ""The package name where this type will be created"")",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
Project project = getSelectedProject(builder.getUIContext());,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"return Strings.capitalize(name) + ""ComponentFactory"";",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"*  Red Hat licenses this file to you under the Apache License, version",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
*  implied.  See the License for the specific language governing,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"@WithAttributes(label = ""Target Package"", required = false, description = ""The package name where this type will be created"")",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
Project project = getSelectedProject(builder.getUIContext());,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
Project project = getSelectedProject(context);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"return Results.fail(""The project does not include camel-core"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"String fqn = targetPackage.getValue() != null ? targetPackage.getValue() + ""."" + name.getValue() : name.getValue();",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"*  Red Hat licenses this file to you under the Apache License, version",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
*  implied.  See the License for the specific language governing,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"description = ""The directory name where this type will be created"")",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"@WithAttributes(label = ""XML File Name"", required = true, description = ""Name of XML file"")",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
Project project = getSelectedProject(context);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
String fileName = directory.getValue() != null ? directory.getValue() + File.separator + name.getValue() : name.getValue();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"return Results.fail(""The project does not include camel-core"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"*  Red Hat licenses this file to you under the Apache License, version",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
*  implied.  See the License for the specific language governing,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
".description(""Configure the component options to use"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
Project project = getSelectedProject(context);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"return Results.fail(""The project does not include camel-core"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
// lets find the camel component class,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"String fqn = generatePackageName != null ? generatePackageName + ""."" + generateClassName : generateClassName;",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
// generate the correct class payload based on the style...,28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"valueExpression = ""\"""" + text + ""\"""";",28f4ca17e3b02b68edfb79d951babe0a5c98b300,2,1
"*  2.0 (the ""License""); you may not use this file except in compliance",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
*  with the License.  You may obtain a copy of the License at,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"*  Unless required by applicable law or agreed to in writing, software",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"@WithAttributes(label = ""Filter"", required = false, description = ""To filter components"")",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public UICommandMetadata getMetadata(UIContext context) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return Metadata.forCommand(CamelAddComponentCommand.class).name(,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public void initializeUI(UIBuilder builder) throws Exception {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public ComponentDto convert(String text) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"return createComponentDto(getCamelCatalog(), text);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
// show note about the chosen component,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public void valueChanged(ValueChangeEvent event) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
ComponentDto component = (ComponentDto) event.getNewValue();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
String description = component.getDescription();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"name.setNote(description != null ? description : """");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public Result execute(UIExecutionContext context) throws Exception {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
// does the project already have camel?,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
DependencyBuilder component = DependencyBuilder.create().setGroupId(dto.getGroupId()),28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
// install the component,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
*  with the License.  You may obtain a copy of the License at,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"*  Unless required by applicable law or agreed to in writing, software",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public UICommandMetadata getMetadata(UIContext context) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return Metadata.forCommand(CamelAddDataFormatCommand.class).name(,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public void initializeUI(UIBuilder builder) throws Exception {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public DataFormatDto convert(String text) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"return createDataFormatDto(getCamelCatalog(), text);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public void valueChanged(ValueChangeEvent event) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
String description = dataFormat.getDescription();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"name.setNote(description != null ? description : """");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public Result execute(UIExecutionContext context) throws Exception {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
// does the project already have camel?,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
// we want to use same version as camel-core,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
DependencyBuilder component = DependencyBuilder.create().setGroupId(dto.getGroupId()),28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
// install the component,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
*  with the License.  You may obtain a copy of the License at,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"*  Unless required by applicable law or agreed to in writing, software",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public UICommandMetadata getMetadata(UIContext context) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return Metadata.forCommand(CamelAddLanguageCommand.class).name(,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public void initializeUI(UIBuilder builder) throws Exception {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public LanguageDto convert(String text) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"return createLanguageDto(getCamelCatalog(), text);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
// show note about the chosen language,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public void valueChanged(ValueChangeEvent event) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
LanguageDto language = (LanguageDto) event.getNewValue();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
String description = language.getDescription();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"name.setNote(description != null ? description : """");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public Result execute(UIExecutionContext context) throws Exception {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
// does the project already have camel?,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
// we want to use same version as camel-core,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
DependencyBuilder component = DependencyBuilder.create().setGroupId(dto.getGroupId()),28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
// install the component,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
*  with the License.  You may obtain a copy of the License at,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"*  Unless required by applicable law or agreed to in writing, software",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public boolean isEnabled(UIContext context) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
// not enable for cdi or spring projects,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return !cdi && !spring;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return false;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public UICommandMetadata getMetadata(UIContext context) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return Metadata.forCommand(CamelNewRouteBuilderCommand.class).name(,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public void initializeUI(UIBuilder builder) throws Exception {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public Result execute(UIExecutionContext context) throws Exception {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
// does the project already have camel?,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"Map<String, Object> params = new HashMap<String, Object>();",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
*  with the License.  You may obtain a copy of the License at,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"*  Unless required by applicable law or agreed to in writing, software",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"@WithAttributes(label = ""Filter"", required = false, description = ""To filter components"")",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"@WithAttributes(label = ""Class Name"", required = true, description = ""Name of @Producer class"")",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public UICommandMetadata getMetadata(UIContext context) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return Metadata.forCommand(CamelNewComponentInstanceCDICommand.class).name(,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public boolean isEnabled(UIContext context) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return CamelCommandsHelper.isCdiProject(getSelectedProject(context));,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return false;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public void initializeUI(UIBuilder builder) throws Exception {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public ComponentDto convert(String text) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"return createComponentDto(getCamelCatalog(), text);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
// show note about the chosen component,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public void valueChanged(ValueChangeEvent event) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
ComponentDto component = (ComponentDto) event.getNewValue();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
String description = component.getDescription();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"componentName.setNote(description != null ? description : """");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public String call() throws Exception {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return getDefaultProducerClassName();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public NavigationResult next(UINavigationContext context) throws Exception {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return Results.navigateTo(ConfigureComponentPropertiesStep.class);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public Result execute(UIExecutionContext context) throws Exception {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return Results.success();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
String name = instanceName.getValue();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return null;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
*  with the License.  You may obtain a copy of the License at,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"*  Unless required by applicable law or agreed to in writing, software",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"@WithAttributes(label = ""Filter"", required = false, description = ""To filter components"")",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public UICommandMetadata getMetadata(UIContext context) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return Metadata.forCommand(CamelNewComponentInstanceSpringCommand.class).name(,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public boolean isEnabled(UIContext context) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return CamelCommandsHelper.isSpringProject(getSelectedProject(context));,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return false;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public void initializeUI(UIBuilder builder) throws Exception {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public ComponentDto convert(String text) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"return createComponentDto(getCamelCatalog(), text);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
// show note about the chosen component,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public void valueChanged(ValueChangeEvent event) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
ComponentDto component = (ComponentDto) event.getNewValue();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
String description = component.getDescription();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"componentName.setNote(description != null ? description : """");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public String call() throws Exception {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return getDefaultProducerClassName();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public NavigationResult next(UINavigationContext context) throws Exception {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return Results.navigateTo(ConfigureComponentPropertiesStep.class);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public Result execute(UIExecutionContext context) throws Exception {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return Results.success();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
String name = instanceName.getValue();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return null;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
*  with the License.  You may obtain a copy of the License at,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"*  Unless required by applicable law or agreed to in writing, software",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"@WithAttributes(label = ""Class Name"", required = true, description = ""Name of RouteBuilder class"")",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public UICommandMetadata getMetadata(UIContext context) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return Metadata.forCommand(CamelNewRouteBuilderCommand.class).name(,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public void initializeUI(UIBuilder builder) throws Exception {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public Result execute(UIExecutionContext context) throws Exception {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
// does the project already have camel?,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
*  with the License.  You may obtain a copy of the License at,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"*  Unless required by applicable law or agreed to in writing, software",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public boolean isEnabled(UIContext context) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
// not enable for cdi or blueprint projects,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return !cdi && !blueprint;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return false;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public UICommandMetadata getMetadata(UIContext context) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return Metadata.forCommand(CamelNewRouteBuilderCommand.class).name(,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public void initializeUI(UIBuilder builder) throws Exception {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public Result execute(UIExecutionContext context) throws Exception {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
// does the project already have camel?,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"Map<String, Object> params = new HashMap<String, Object>();",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
*  with the License.  You may obtain a copy of the License at,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"*  Unless required by applicable law or agreed to in writing, software",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
private List<InputComponent> inputs = new ArrayList<>();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public UICommandMetadata getMetadata(UIContext context) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return Metadata.forCommand(ConfigureComponentPropertiesStep.class).name(,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public void initializeUI(UIBuilder builder) throws Exception {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
Set<String> namesAdded = new HashSet<>();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"for (Map<String, String> propertyMap : data) {",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"String name = propertyMap.get(""name"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"String description = propertyMap.get(""description"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public NavigationResult next(UINavigationContext context) throws Exception {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return null;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
public Result execute(UIExecutionContext context) throws Exception {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
// does the project already have camel?,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
CamelComponentDetails details = new CamelComponentDetails();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return result;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
StringBuilder buffer = new StringBuilder();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
for (InputComponent input : inputs) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
// only use value if there was a value set,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return Results.fail(e.getMessage());,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
* Returns the mandatory String value of the given name,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
"public static String mandatoryAttributeValue(Map<Object, Object> attributeMap, String name) {",28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
return text;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,1,1
/**,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*  permissions and limitations under the License.,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*/,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
package io.fabric8.forge.camel.commands.project;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import javax.inject.Inject;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.convert.Converter;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.dependencies.Dependency;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.projects.Project;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIContext;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.input.UISelectOne;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.result.Result;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.result.Results;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.util.Categories;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.util.Metadata;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createComponentDto;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
@Inject,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private UISelectOne<String> filter;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private UISelectOne<ComponentDto> name;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private DependencyInstaller dependencyInstaller;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
@Override,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
},28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"filter.setValueChoices(CamelCommandsHelper.createComponentLabelValues(project, getCamelCatalog()));",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"filter.setDefaultValue(""<all>"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"name.setValueChoices(CamelCommandsHelper.createComponentDtoValues(project, getCamelCatalog(), filter, false));",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
// include converter from string->dto,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"name.setValueConverter(new Converter<String, ComponentDto>() {",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
});,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
name.addValueChangeListener(new ValueChangeListener() {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (component != null) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
} else {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"name.setNote("""");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
builder.add(filter).add(name);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
Dependency core = findCamelCoreDependency(project);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (core == null) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
ComponentDto dto = name.getValue();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (dto != null) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
// otherwise use the version from the dto,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
String version;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"if (""org.apache.camel"".equals(dto.getGroupId())) {",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
version = core.getCoordinate().getVersion();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
version = dto.getVersion();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
.setArtifactId(dto.getArtifactId()).setVersion(version);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"dependencyInstaller.install(project, component);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
/**,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*  permissions and limitations under the License.,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*/,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
package io.fabric8.forge.camel.commands.project;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import javax.inject.Inject;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.camel.commands.project.completer.CamelDataFormatsCompleter;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.camel.commands.project.dto.DataFormatDto;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.convert.Converter;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.dependencies.Dependency;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.projects.Project;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIContext;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.input.UISelectOne;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.result.Result;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.result.Results;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.util.Categories;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.util.Metadata;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createDataFormatDto;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
@Inject,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private UISelectOne<DataFormatDto> name;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private DependencyInstaller dependencyInstaller;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
@Override,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
},28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
// use value choices instead of completer as that works better in web console,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"name.setValueChoices(new CamelDataFormatsCompleter(project, getCamelCatalog()).getValueChoices());",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
// include converter from string->dto,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"name.setValueConverter(new Converter<String, DataFormatDto>() {",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
});,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
// show note about the chosen data format,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
name.addValueChangeListener(new ValueChangeListener() {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
DataFormatDto dataFormat = (DataFormatDto) event.getNewValue();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (dataFormat != null) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
} else {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"name.setNote("""");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
builder.add(name);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
Dependency core = findCamelCoreDependency(project);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (core == null) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
DataFormatDto dto = name.getValue();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (dto != null) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
.setArtifactId(dto.getArtifactId()).setVersion(core.getCoordinate().getVersion());,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"dependencyInstaller.install(project, component);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
/**,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*  permissions and limitations under the License.,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*/,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
package io.fabric8.forge.camel.commands.project;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import javax.inject.Inject;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.camel.commands.project.completer.CamelLanguagesCompleter;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.camel.commands.project.dto.LanguageDto;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.convert.Converter;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.dependencies.Dependency;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.projects.Project;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIContext;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.input.UISelectOne;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.result.Result;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.result.Results;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.util.Categories;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.util.Metadata;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createLanguageDto;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
@Inject,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private UISelectOne<LanguageDto> name;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private DependencyInstaller dependencyInstaller;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
@Override,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
},28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
// use value choices instead of completer as that works better in web console,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"name.setValueChoices(new CamelLanguagesCompleter(project, getCamelCatalog()).getValueChoices());",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
// include converter from string->dto,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"name.setValueConverter(new Converter<String, LanguageDto>() {",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
});,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
name.addValueChangeListener(new ValueChangeListener() {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (language != null) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
} else {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"name.setNote("""");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
builder.add(name);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
Dependency core = findCamelCoreDependency(project);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (core == null) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
LanguageDto dto = name.getValue();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (dto != null) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
.setArtifactId(dto.getArtifactId()).setVersion(core.getCoordinate().getVersion());,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"dependencyInstaller.install(project, component);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
/**,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*  permissions and limitations under the License.,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*/,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
package io.fabric8.forge.camel.commands.project;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import java.io.File;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import java.net.URL;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import java.util.HashMap;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import java.util.Map;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import javax.inject.Inject;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.addon.utils.validator.ResourceNameValidator;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.dependencies.Dependency;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.facets.constraints.FacetConstraint;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.projects.Project;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.resource.FileResource;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.resource.Resource;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.resource.ResourceFactory;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.resource.URLResource;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.templates.Template;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.templates.TemplateFactory;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.templates.freemarker.FreemarkerTemplate;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIContext;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.facets.HintsFacet;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.hints.InputType;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.input.UIInput;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.result.Result;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.result.Results;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.util.Categories;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.util.Metadata;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
@FacetConstraint({ResourcesFacet.class}),28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
@Inject,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"@WithAttributes(label = ""Directory"", required = false, defaultValue = ""OSGI-INF/blueprint"",",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private UIInput<String> directory;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private UIInput<String> name;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private DependencyInstaller dependencyInstaller;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private TemplateFactory factory;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
ResourceFactory resourceFactory;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
@Override,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
boolean enabled = super.isEnabled(context);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (enabled) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
boolean cdi = CamelCommandsHelper.isCdiProject(project);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
boolean spring = CamelCommandsHelper.isSpringProject(project);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
},28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
directory.getFacet(HintsFacet.class).setInputType(InputType.DIRECTORY_PICKER);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"name.addValidator(new ResourceNameValidator(""xml""));",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
name.getFacet(HintsFacet.class).setInputType(InputType.FILE_PICKER);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
builder.add(directory).add(name);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
String projectName = project.getRoot().getName();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
ResourcesFacet facet = project.getFacet(ResourcesFacet.class);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
FileResource<?> fileResource = facet.getResource(fileName);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (fileResource.exists()) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
Dependency core = findCamelCoreDependency(project);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (core == null) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"DependencyBuilder spring = DependencyBuilder.create().setGroupId(""org.apache.camel"")",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
".setArtifactId(""camel-blueprint"").setVersion(core.getCoordinate().getVersion());",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
// install camel-blueprint if missing,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"if (!dependencyInstaller.isManaged(project, spring)) {",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"dependencyInstaller.install(project, spring);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"Resource<URL> xml = resourceFactory.create(getClass().getResource(""/templates/camel-blueprint.ftl"")).reify(URLResource.class);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"Template template = factory.create(xml, FreemarkerTemplate.class);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
// any dynamic options goes into the params map,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"params.put(""projectName"", projectName);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
String output = template.process(params);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
fileResource.createNewFile();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
fileResource.setContents(output);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
/**,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*  permissions and limitations under the License.,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*/,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
package io.fabric8.forge.camel.commands.project;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import java.util.Map;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import java.util.concurrent.Callable;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import javax.inject.Inject;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.addon.utils.completer.PackageNameCompleter;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.addon.utils.validator.ClassNameValidator;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.addon.utils.validator.PackageNameValidator;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.convert.Converter;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.dependencies.DependencyResolver;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.facets.constraints.FacetConstraint;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.parser.java.facets.JavaSourceFacet;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.projects.Project;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.projects.facets.ClassLoaderFacet;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIContext;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UINavigationContext;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.facets.HintsFacet;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.hints.InputType;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.input.UIInput;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.input.UISelectOne;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.result.NavigationResult;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.result.Result;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.result.Results;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.util.Categories;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.util.Metadata;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.wizard.UIWizard;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.roaster.model.util.Strings;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createComponentDto;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"@FacetConstraint({JavaSourceFacet.class, ResourcesFacet.class, ClassLoaderFacet.class})",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
@Inject,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private UISelectOne<String> componentNameFilter;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private UISelectOne<ComponentDto> componentName;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private UIInput<String> instanceName;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private UIInput<String> targetPackage;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private UIInput<String> className;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private DependencyInstaller dependencyInstaller;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private DependencyResolver dependencyResolver;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
@Override,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
},28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
boolean enabled = super.isEnabled(context);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (enabled) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
final JavaSourceFacet facet = project.getFacet(JavaSourceFacet.class);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"componentNameFilter.setValueChoices(CamelCommandsHelper.createComponentLabelValues(project, getCamelCatalog()));",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"componentNameFilter.setDefaultValue(""<all>"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"componentName.setValueChoices(CamelCommandsHelper.createComponentDtoValues(project, getCamelCatalog(), componentNameFilter, false));",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
// include converter from string->dto,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"componentName.setValueConverter(new Converter<String, ComponentDto>() {",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
});,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
componentName.addValueChangeListener(new ValueChangeListener() {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (component != null) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
} else {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"componentName.setNote("""");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
targetPackage.setCompleter(new PackageNameCompleter(facet));,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
targetPackage.addValidator(new PackageNameValidator());,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
targetPackage.getFacet(HintsFacet.class).setInputType(InputType.JAVA_PACKAGE_PICKER);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
className.addValidator(new ClassNameValidator(false));,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
className.setDefaultValue(new Callable<String>() {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
className.getFacet(HintsFacet.class).setInputType(InputType.JAVA_CLASS_PICKER);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
builder.add(componentNameFilter).add(componentName).add(instanceName).add(targetPackage).add(className);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"Map<Object, Object> attributeMap = context.getUIContext().getAttributeMap();",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"attributeMap.put(""componentName"", componentName.getValue().getScheme());",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"attributeMap.put(""instanceName"", instanceName.getValue());",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"attributeMap.put(""targetPackage"", targetPackage.getValue());",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"attributeMap.put(""className"", className.getValue());",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"attributeMap.put(""kind"", ""cdi"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
protected String getDefaultProducerClassName() {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (!Strings.isBlank(name)) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
/**,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*  permissions and limitations under the License.,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*/,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
package io.fabric8.forge.camel.commands.project;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import java.util.Map;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import java.util.concurrent.Callable;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import javax.inject.Inject;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.addon.utils.completer.PackageNameCompleter;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.addon.utils.validator.ClassNameValidator;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.addon.utils.validator.PackageNameValidator;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.convert.Converter;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.dependencies.DependencyResolver;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.facets.constraints.FacetConstraint;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.parser.java.facets.JavaSourceFacet;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.projects.Project;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.projects.facets.ClassLoaderFacet;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIContext;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UINavigationContext;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.facets.HintsFacet;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.hints.InputType;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.input.UIInput;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.input.UISelectOne;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.result.NavigationResult;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.result.Result;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.result.Results;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.util.Categories;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.util.Metadata;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.wizard.UIWizard;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.roaster.model.util.Strings;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createComponentDto;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"@FacetConstraint({JavaSourceFacet.class, ResourcesFacet.class, ClassLoaderFacet.class})",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
@Inject,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private UISelectOne<String> componentNameFilter;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private UISelectOne<ComponentDto> componentName;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private UIInput<String> instanceName;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private UIInput<String> targetPackage;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private UIInput<String> className;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private DependencyInstaller dependencyInstaller;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private DependencyResolver dependencyResolver;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
@Override,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
},28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
boolean enabled = super.isEnabled(context);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (enabled) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
final JavaSourceFacet facet = project.getFacet(JavaSourceFacet.class);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"componentNameFilter.setValueChoices(CamelCommandsHelper.createComponentLabelValues(project, getCamelCatalog()));",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"componentNameFilter.setDefaultValue(""<all>"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"componentName.setValueChoices(CamelCommandsHelper.createComponentDtoValues(project, getCamelCatalog(), componentNameFilter, false));",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
// include converter from string->dto,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"componentName.setValueConverter(new Converter<String, ComponentDto>() {",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
});,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
componentName.addValueChangeListener(new ValueChangeListener() {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (component != null) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
} else {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"componentName.setNote("""");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
targetPackage.setCompleter(new PackageNameCompleter(facet));,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
targetPackage.addValidator(new PackageNameValidator());,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
targetPackage.getFacet(HintsFacet.class).setInputType(InputType.JAVA_PACKAGE_PICKER);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
className.addValidator(new ClassNameValidator(false));,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
className.setDefaultValue(new Callable<String>() {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
className.getFacet(HintsFacet.class).setInputType(InputType.JAVA_CLASS_PICKER);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
builder.add(componentNameFilter).add(componentName).add(instanceName).add(targetPackage).add(className);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"Map<Object, Object> attributeMap = context.getUIContext().getAttributeMap();",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"attributeMap.put(""componentName"", componentName.getValue().getScheme());",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"attributeMap.put(""instanceName"", instanceName.getValue());",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"attributeMap.put(""targetPackage"", targetPackage.getValue());",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"attributeMap.put(""className"", className.getValue());",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"attributeMap.put(""kind"", ""spring"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
protected String getDefaultProducerClassName() {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (!Strings.isBlank(name)) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
/**,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*  permissions and limitations under the License.,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*/,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
package io.fabric8.forge.camel.commands.project;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import javax.inject.Inject;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.addon.utils.completer.PackageNameCompleter;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.addon.utils.validator.ClassNameValidator;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.addon.utils.validator.PackageNameValidator;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.dependencies.Dependency;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.facets.constraints.FacetConstraint;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.parser.java.facets.JavaSourceFacet;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.parser.java.resources.JavaResource;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.projects.Project;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIContext;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.facets.HintsFacet;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.hints.InputType;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.input.UIInput;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.result.Result;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.result.Results;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.util.Categories;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.util.Metadata;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.roaster.Roaster;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.roaster.model.source.JavaClassSource;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"@FacetConstraint({JavaSourceFacet.class, ResourcesFacet.class})",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
@Inject,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private UIInput<String> targetPackage;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private UIInput<String> name;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
@Override,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
},28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
JavaSourceFacet facet = project.getFacet(JavaSourceFacet.class);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
targetPackage.setCompleter(new PackageNameCompleter(facet));,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
targetPackage.addValidator(new PackageNameValidator());,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
targetPackage.getFacet(HintsFacet.class).setInputType(InputType.JAVA_PACKAGE_PICKER);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
name.addValidator(new ClassNameValidator(false));,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
name.getFacet(HintsFacet.class).setInputType(InputType.JAVA_CLASS_PICKER);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
builder.add(targetPackage).add(name);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
Dependency core = findCamelCoreDependency(project);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (core == null) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
JavaResource existing = facet.getJavaResource(fqn);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (existing != null && existing.exists()) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
final JavaClassSource javaClass = Roaster.create(JavaClassSource.class);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
javaClass.setName(name.getValue());,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (targetPackage.getValue() != null) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
javaClass.setPackage(targetPackage.getValue());,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"javaClass.setSuperType(""RouteBuilder"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"javaClass.addImport(""org.apache.camel.builder.RouteBuilder"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
javaClass.addMethod(),28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
.setPublic(),28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
.setReturnTypeVoid(),28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
".setName(""configure"")",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
".addThrows(Exception.class).setBody("""");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
facet.saveJavaSource(javaClass);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
/**,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*  permissions and limitations under the License.,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*/,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
package io.fabric8.forge.camel.commands.project;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import java.io.File;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import java.net.URL;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import java.util.HashMap;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import java.util.Map;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import javax.inject.Inject;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.addon.utils.validator.ResourceNameValidator;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.dependencies.Dependency;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.facets.constraints.FacetConstraint;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.projects.Project;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.resource.FileResource;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.resource.Resource;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.resource.ResourceFactory;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.resource.URLResource;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.templates.Template;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.templates.TemplateFactory;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.templates.freemarker.FreemarkerTemplate;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIContext;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.facets.HintsFacet;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.hints.InputType;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.input.UIInput;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.result.Result;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.result.Results;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.util.Categories;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.util.Metadata;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
@FacetConstraint({ResourcesFacet.class}),28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
@Inject,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"@WithAttributes(label = ""Directory"", required = false, defaultValue = ""META-INF/spring"",",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private UIInput<String> directory;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private UIInput<String> name;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private DependencyInstaller dependencyInstaller;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private TemplateFactory factory;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
ResourceFactory resourceFactory;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
@Override,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
boolean enabled = super.isEnabled(context);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (enabled) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
boolean cdi = CamelCommandsHelper.isCdiProject(project);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
boolean blueprint = CamelCommandsHelper.isBlueprintProject(project);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
},28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"name.addValidator(new ResourceNameValidator(""xml""));",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
name.getFacet(HintsFacet.class).setInputType(InputType.FILE_PICKER);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
directory.getFacet(HintsFacet.class).setInputType(InputType.DIRECTORY_PICKER);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
builder.add(directory).add(name);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
String projectName = project.getRoot().getName();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
ResourcesFacet facet = project.getFacet(ResourcesFacet.class);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
FileResource<?> fileResource = facet.getResource(fileName);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (fileResource.exists()) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
Dependency core = findCamelCoreDependency(project);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (core == null) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"DependencyBuilder spring = DependencyBuilder.create().setGroupId(""org.apache.camel"")",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
".setArtifactId(""camel-spring"").setVersion(core.getCoordinate().getVersion());",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
// install camel-spring if missing,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"if (!dependencyInstaller.isManaged(project, spring)) {",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"dependencyInstaller.install(project, spring);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"Resource<URL> xml = resourceFactory.create(getClass().getResource(""/templates/camel-spring.ftl"")).reify(URLResource.class);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"Template template = factory.create(xml, FreemarkerTemplate.class);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
// any dynamic options goes into the params map,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"params.put(""projectName"", projectName);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
String output = template.process(params);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
fileResource.createNewFile();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
fileResource.setContents(output);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
/**,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*  permissions and limitations under the License.,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
*/,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
package io.fabric8.forge.camel.commands.project;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import java.util.ArrayList;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import java.util.HashSet;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import java.util.List;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import java.util.Map;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import java.util.Set;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import javax.inject.Inject;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.addon.utils.CamelProjectHelper;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import io.fabric8.forge.camel.commands.project.model.CamelComponentDetails;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.apache.camel.catalog.CamelCatalog;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.apache.camel.catalog.JSonSchemaHelper;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.dependencies.Dependency;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.dependencies.DependencyResolver;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.parser.java.facets.JavaSourceFacet;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.parser.java.resources.JavaResource;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.projects.Project;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIContext;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.context.UINavigationContext;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.input.InputComponent;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.input.InputComponentFactory;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.result.NavigationResult;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.result.Result;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.result.Results;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.util.Categories;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.util.Metadata;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.addon.ui.wizard.UIWizardStep;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.roaster.Roaster;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.roaster.model.source.JavaClassSource;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import org.jboss.forge.roaster.model.util.Strings;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import static io.fabric8.forge.addon.utils.UIHelper.createUIInput;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper.ensureCamelArtifactIdAdded;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper.loadCamelComponentDetails;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper.loadValidInputTypes;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
@Inject,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private InputComponentFactory componentFactory;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private DependencyInstaller dependencyInstaller;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private DependencyResolver dependencyResolver;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
private CamelCatalog camelCatalog;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
@Override,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
},28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"Map<Object, Object> attributeMap = builder.getUIContext().getAttributeMap();",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"String camelComponentName = mandatoryAttributeValue(attributeMap, ""componentName"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
String json = camelCatalog.componentJSonSchema(camelComponentName);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (json == null) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"List<Map<String, String>> data = JSonSchemaHelper.parseJsonSchema(""componentProperties"", json, true);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (data != null) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"String kind = propertyMap.get(""kind"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"String type = propertyMap.get(""type"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"String javaType = propertyMap.get(""javaType"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"String deprecated = propertyMap.get(""deprecated"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"String required = propertyMap.get(""required"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
String currentValue = null;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"String defaultValue = propertyMap.get(""defaultValue"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"String enums = propertyMap.get(""enum"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (!Strings.isNullOrEmpty(name)) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"Class<Object> inputClazz = loadValidInputTypes(javaType, type);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (inputClazz != null) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (namesAdded.add(name)) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"InputComponent input = createUIInput(componentFactory, getConverterFactory(), name, inputClazz, required, currentValue, defaultValue, enums, description);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (input != null) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
builder.add(input);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
inputs.add(input);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"Map<Object, Object> attributeMap = context.getUIContext().getAttributeMap();",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
try {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"String componentInstanceName = mandatoryAttributeValue(attributeMap, ""instanceName"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"String generatePackageName = mandatoryAttributeValue(attributeMap, ""targetPackage"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"String generateClassName = mandatoryAttributeValue(attributeMap, ""className"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"String kind = mandatoryAttributeValue(attributeMap, ""kind"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
JavaSourceFacet facet = project.getFacet(JavaSourceFacet.class);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
Dependency core = CamelProjectHelper.findCamelCoreDependency(project);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (core == null) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"Result result = loadCamelComponentDetails(camelCatalog, camelComponentName, details);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (result != null) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"result = ensureCamelArtifactIdAdded(project, details, dependencyInstaller);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
JavaResource existing = facet.getJavaResource(fqn);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (existing != null && existing.exists()) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
final JavaClassSource javaClass = Roaster.create(JavaClassSource.class);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
javaClass.setName(generateClassName);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (generatePackageName != null) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
javaClass.setPackage(generatePackageName);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (input.hasValue()) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
String valueExpression = null;,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
Object value = input.getValue();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (value != null) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (value instanceof String) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
String text = value.toString();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (!Strings.isBlank(text)) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (value instanceof Number) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
valueExpression = value.toString();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
if (valueExpression != null) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"buffer.append(""\n"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"buffer.append(""component.set"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
buffer.append(Strings.capitalize(input.getName()));,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"buffer.append(""("");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
buffer.append(valueExpression);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"buffer.append("");"");",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
String configurationCode = buffer.toString();,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"if (kind.equals(""cdi"")) {",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"CamelCommandsHelper.createCdiComponentProducerClass(javaClass, details, camelComponentName, componentInstanceName, configurationCode);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
} else {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
"CamelCommandsHelper.createSpringComponentFactoryClass(javaClass, details, camelComponentName, componentInstanceName, configurationCode);",28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
facet.saveJavaSource(javaClass);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
} catch (IllegalArgumentException e) {,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
* @throws IllegalArgumentException if the value is not available in the given attribute map,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
Object value = attributeMap.get(name);,28f4ca17e3b02b68edfb79d951babe0a5c98b300,0,1
".description(""Adds a Camel component to your project dependencies"");",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,7,1
".description(""Adds a Camel dataformat to your project dependencies"");",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,7,1
".description(""Adds a Camel language to your project dependencies"");",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,7,1
"@WithAttributes(label = ""Name"", required = true, description = ""Name of component type to add"")",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,3,1
// we want to use same version as camel-core if its a camel component,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,3,1
"return Results.success(""Added Camel component "" + dto.getScheme() + "" ("" + dto.getArtifactId() + "") to the project"");",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,3,1
"@WithAttributes(label = ""Name"", required = true, description = ""Name of dataformat to add"")",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,3,1
"return Results.success(""Added Camel dataformat "" + dto.getName() + "" ("" + dto.getArtifactId() + "") to the project"");",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,3,1
"@WithAttributes(label = ""Name"", required = true, description = ""Name of language to add"")",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,3,1
"return Results.success(""Added Camel language "" + dto.getName() + "" ("" + dto.getArtifactId() + "") to the project"");",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,3,1
"*  Red Hat licenses this file to you under the Apache License, version",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
*  with the License.  You may obtain a copy of the License at,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
"*  Unless required by applicable law or agreed to in writing, software",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
*  implied.  See the License for the specific language governing,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
"@WithAttributes(label = ""Filter"", required = false, description = ""To filter components"")",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
final Project project = getSelectedProject(builder);,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
// show note about the chosen component,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
ComponentDto component = (ComponentDto) event.getNewValue();,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
String description = component.getDescription();,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
"name.setNote(description != null ? description : """");",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
Project project = getSelectedProject(context);,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
// does the project already have camel?,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
"return Results.fail(""The project does not include camel-core"");",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
DependencyBuilder component = DependencyBuilder.create().setGroupId(dto.getGroupId()),bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
// install the component,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
"return Results.fail(""Unknown Camel component"");",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
"*  Red Hat licenses this file to you under the Apache License, version",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
*  with the License.  You may obtain a copy of the License at,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
"*  Unless required by applicable law or agreed to in writing, software",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
*  implied.  See the License for the specific language governing,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
Project project = getSelectedProject(builder);,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
String description = dataFormat.getDescription();,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
"name.setNote(description != null ? description : """");",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
Project project = getSelectedProject(context);,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
// does the project already have camel?,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
"return Results.fail(""The project does not include camel-core"");",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
// we want to use same version as camel-core,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
DependencyBuilder component = DependencyBuilder.create().setGroupId(dto.getGroupId()),bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
// install the component,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
"return Results.fail(""Unknown Camel dataformat"");",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
"*  Red Hat licenses this file to you under the Apache License, version",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
*  with the License.  You may obtain a copy of the License at,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
"*  Unless required by applicable law or agreed to in writing, software",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
*  implied.  See the License for the specific language governing,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
Project project = getSelectedProject(builder);,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
// show note about the chosen language,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
LanguageDto language = (LanguageDto) event.getNewValue();,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
String description = language.getDescription();,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
"name.setNote(description != null ? description : """");",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
Project project = getSelectedProject(context);,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
// does the project already have camel?,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
"return Results.fail(""The project does not include camel-core"");",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
// we want to use same version as camel-core,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
DependencyBuilder component = DependencyBuilder.create().setGroupId(dto.getGroupId()),bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
// install the component,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
"return Results.fail(""Unknown Camel language"");",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,1,1
/**,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
*,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
*  permissions and limitations under the License.,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
*/,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
package io.fabric8.forge.camel.commands.project;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import javax.inject.Inject;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import io.fabric8.forge.camel.commands.project.dto.ComponentDto;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import io.fabric8.forge.camel.commands.project.helper.CamelCommandsHelper;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.convert.Converter;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.dependencies.Dependency;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.projects.Project;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.context.UIContext;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.input.UISelectOne;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.result.Result;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.result.Results;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.util.Categories;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.util.Metadata;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createComponentDto;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
public class CamelAddComponentCommand extends AbstractCamelProjectCommand {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
@Inject,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
private UISelectOne<String> filter;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
private UISelectOne<ComponentDto> name;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
private DependencyInstaller dependencyInstaller;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
@Override,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
public UICommandMetadata getMetadata(UIContext context) {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
return Metadata.forCommand(CamelAddComponentCommand.class).name(,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"""Camel: Add Component"").category(Categories.create(CATEGORY))",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
},bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
public void initializeUI(UIBuilder builder) throws Exception {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"filter.setValueChoices(CamelCommandsHelper.createComponentLabelValues(project, getCamelCatalog()));",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"filter.setDefaultValue(""<all>"");",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"name.setValueChoices(CamelCommandsHelper.createComponentDtoValues(project, getCamelCatalog(), filter, false));",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
// include converter from string->dto,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"name.setValueConverter(new Converter<String, ComponentDto>() {",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
public ComponentDto convert(String text) {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"return createComponentDto(getCamelCatalog(), text);",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
});,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
name.addValueChangeListener(new ValueChangeListener() {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
public void valueChanged(ValueChangeEvent event) {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
if (component != null) {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
} else {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"name.setNote("""");",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
builder.add(filter).add(name);,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
public Result execute(UIExecutionContext context) throws Exception {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
Dependency core = findCamelCoreDependency(project);,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
if (core == null) {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
ComponentDto dto = name.getValue();,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
if (dto != null) {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
// otherwise use the version from the dto,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
String version;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"if (""org.apache.camel"".equals(dto.getGroupId())) {",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
version = core.getCoordinate().getVersion();,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
version = dto.getVersion();,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
.setArtifactId(dto.getArtifactId()).setVersion(version);,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"dependencyInstaller.install(project, component);",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
/**,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
*,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
*  permissions and limitations under the License.,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
*/,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
package io.fabric8.forge.camel.commands.project;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import javax.inject.Inject;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import io.fabric8.forge.camel.commands.project.completer.CamelDataFormatsCompleter;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import io.fabric8.forge.camel.commands.project.dto.DataFormatDto;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.convert.Converter;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.dependencies.Dependency;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.projects.Project;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.context.UIContext;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.input.UISelectOne;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.result.Result;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.result.Results;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.util.Categories;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.util.Metadata;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createDataFormatDto;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
public class CamelAddDataFormatCommand extends AbstractCamelProjectCommand {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
@Inject,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
private UISelectOne<DataFormatDto> name;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
private DependencyInstaller dependencyInstaller;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
@Override,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
public UICommandMetadata getMetadata(UIContext context) {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
return Metadata.forCommand(CamelAddDataFormatCommand.class).name(,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"""Camel: Add DataFormat"").category(Categories.create(CATEGORY))",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
},bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
public void initializeUI(UIBuilder builder) throws Exception {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
// use value choices instead of completer as that works better in web console,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"name.setValueChoices(new CamelDataFormatsCompleter(project, getCamelCatalog()).getValueChoices());",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
// include converter from string->dto,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"name.setValueConverter(new Converter<String, DataFormatDto>() {",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
public DataFormatDto convert(String text) {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"return createDataFormatDto(getCamelCatalog(), text);",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
});,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
// show note about the chosen data format,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
name.addValueChangeListener(new ValueChangeListener() {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
public void valueChanged(ValueChangeEvent event) {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
DataFormatDto dataFormat = (DataFormatDto) event.getNewValue();,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
if (dataFormat != null) {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
} else {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"name.setNote("""");",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
builder.add(name);,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
public Result execute(UIExecutionContext context) throws Exception {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
Dependency core = findCamelCoreDependency(project);,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
if (core == null) {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
DataFormatDto dto = name.getValue();,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
if (dto != null) {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
.setArtifactId(dto.getArtifactId()).setVersion(core.getCoordinate().getVersion());,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"dependencyInstaller.install(project, component);",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
/**,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
*,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
*  permissions and limitations under the License.,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
*/,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
package io.fabric8.forge.camel.commands.project;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import javax.inject.Inject;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import io.fabric8.forge.camel.commands.project.completer.CamelLanguagesCompleter;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import io.fabric8.forge.camel.commands.project.dto.LanguageDto;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.convert.Converter;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.dependencies.Dependency;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.projects.Project;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.context.UIContext;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.input.UISelectOne;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.result.Result;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.result.Results;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.util.Categories;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import org.jboss.forge.addon.ui.util.Metadata;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
import static io.fabric8.forge.camel.commands.project.helper.CamelCatalogHelper.createLanguageDto;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
public class CamelAddLanguageCommand extends AbstractCamelProjectCommand {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
@Inject,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
private UISelectOne<LanguageDto> name;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
private DependencyInstaller dependencyInstaller;,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
@Override,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
public UICommandMetadata getMetadata(UIContext context) {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
return Metadata.forCommand(CamelAddLanguageCommand.class).name(,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"""Camel: Add Language"").category(Categories.create(CATEGORY))",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
},bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
public void initializeUI(UIBuilder builder) throws Exception {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
// use value choices instead of completer as that works better in web console,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"name.setValueChoices(new CamelLanguagesCompleter(project, getCamelCatalog()).getValueChoices());",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
// include converter from string->dto,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"name.setValueConverter(new Converter<String, LanguageDto>() {",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
public LanguageDto convert(String text) {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"return createLanguageDto(getCamelCatalog(), text);",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
});,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
name.addValueChangeListener(new ValueChangeListener() {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
public void valueChanged(ValueChangeEvent event) {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
if (language != null) {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
} else {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"name.setNote("""");",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
builder.add(name);,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
public Result execute(UIExecutionContext context) throws Exception {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
Dependency core = findCamelCoreDependency(project);,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
if (core == null) {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
LanguageDto dto = name.getValue();,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
if (dto != null) {,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
.setArtifactId(dto.getArtifactId()).setVersion(core.getCoordinate().getVersion());,bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"dependencyInstaller.install(project, component);",bc9993f7966af8294f9bd900648eeb8d1dcb5b97,0,1
"private static final String VOLUME_HOST_PATH = ""hostPath"";",8648a975d99aa88e040b946d2233eb3682c4116b,3,1
"private static final String EMPTY_DIR_MEDIUM = ""emptyDir"";",8648a975d99aa88e040b946d2233eb3682c4116b,3,1
"private static final String VOLUME_GIT_REPO = ""gitRepo"";",8648a975d99aa88e040b946d2233eb3682c4116b,3,1
"private static final String VOLUME_GIT_REVISION_PROPERTY = ""fabric8.volume.%s.gitRevision"";",8648a975d99aa88e040b946d2233eb3682c4116b,3,1
"private static final String NAME = ""name"";",8648a975d99aa88e040b946d2233eb3682c4116b,3,0
"private static final String ATTRIBUTE_TYPE = ""attributeType"";",8648a975d99aa88e040b946d2233eb3682c4116b,3,0
"private static final String PARAM_REGEX = ""fabric8.parameter.(?<name>[^. ]*)(.)?(?<attributeType>[^ ]*)"";",8648a975d99aa88e040b946d2233eb3682c4116b,3,0
"private static final String TEMPLATE_NAME = ""fabric8.template"";",8648a975d99aa88e040b946d2233eb3682c4116b,3,0
"private static final String PARAMETER_PREFIX = ""fabric8.parameter"";",8648a975d99aa88e040b946d2233eb3682c4116b,3,0
"private static final String PARAMETER_NAME_PREFIX = PARAMETER_PREFIX + "".%s"";",8648a975d99aa88e040b946d2233eb3682c4116b,3,0
"private static final String PARAMETER_PROPERTY = PARAMETER_NAME_PREFIX + "".%s"";",8648a975d99aa88e040b946d2233eb3682c4116b,3,0
"private static final String GENEATE = ""generate"";",8648a975d99aa88e040b946d2233eb3682c4116b,3,0
"private static final String FROM = ""from"";",8648a975d99aa88e040b946d2233eb3682c4116b,3,0
"private static final String VALUE = ""value"";",8648a975d99aa88e040b946d2233eb3682c4116b,3,0
"private static final String DESCRIPTION = ""description"";",8648a975d99aa88e040b946d2233eb3682c4116b,3,0
String name = m.group(NAME);,8648a975d99aa88e040b946d2233eb3682c4116b,3,0
String type = m.group(ATTRIBUTE_TYPE);,8648a975d99aa88e040b946d2233eb3682c4116b,3,0
"private static final String VOLUME_NAME = ""name"";",8648a975d99aa88e040b946d2233eb3682c4116b,3,1
"private static final String VOLUME_ATTRIBUTE_TYPE = ""attributeType"";",8648a975d99aa88e040b946d2233eb3682c4116b,3,1
String name = m.group(VOLUME_NAME);,8648a975d99aa88e040b946d2233eb3682c4116b,3,1
String type = m.group(VOLUME_ATTRIBUTE_TYPE);,8648a975d99aa88e040b946d2233eb3682c4116b,3,1
String path = String.valueOf(entry.getValue());,8648a975d99aa88e040b946d2233eb3682c4116b,2,1
String medium = String.valueOf(entry.getValue());,8648a975d99aa88e040b946d2233eb3682c4116b,2,1
String repository = String.valueOf(entry.getValue());,8648a975d99aa88e040b946d2233eb3682c4116b,2,1
"String revisionPropertyName = String.format(VOLUME_GIT_REVISION_PROPERTY, name);",8648a975d99aa88e040b946d2233eb3682c4116b,2,1
String revision = project.getProperties().getProperty(revisionPropertyName);,8648a975d99aa88e040b946d2233eb3682c4116b,2,1
private static final Pattern PARAM_PATTERN = Pattern.compile(PARAM_REGEX);,8648a975d99aa88e040b946d2233eb3682c4116b,2,0
MavenProject project = getProject();,8648a975d99aa88e040b946d2233eb3682c4116b,2,0
String s = (String) key;,8648a975d99aa88e040b946d2233eb3682c4116b,2,0
Matcher m = PARAM_PATTERN.matcher(s);,8648a975d99aa88e040b946d2233eb3682c4116b,2,0
"String value = properties.getProperty(String.format(PARAMETER_PROPERTY, name, VALUE));",8648a975d99aa88e040b946d2233eb3682c4116b,2,0
"String from = properties.getProperty(String.format(PARAMETER_PROPERTY, name, FROM));",8648a975d99aa88e040b946d2233eb3682c4116b,2,0
"String description = properties.getProperty(String.format(PARAMETER_PROPERTY, name, DESCRIPTION));",8648a975d99aa88e040b946d2233eb3682c4116b,2,0
"String generate = properties.getProperty(String.format(PARAMETER_PROPERTY, name, GENEATE));",8648a975d99aa88e040b946d2233eb3682c4116b,2,0
String templateName = properties.containsKey(TEMPLATE_NAME) ?,8648a975d99aa88e040b946d2233eb3682c4116b,2,0
Properties properties = project.getProperties();,8648a975d99aa88e040b946d2233eb3682c4116b,1,0
"for (Map.Entry<Object, Object> entry : properties.entrySet()) {",8648a975d99aa88e040b946d2233eb3682c4116b,1,0
VolumeType volumeType = VolumeType.typeFor(type);,8648a975d99aa88e040b946d2233eb3682c4116b,1,0
"for (Map.Entry<Object, Object> entry : project.getProperties().entrySet()) {",8648a975d99aa88e040b946d2233eb3682c4116b,1,1
Template template = getTemplate();,8648a975d99aa88e040b946d2233eb3682c4116b,1,0
builder = builder.addToTemplates(template);,8648a975d99aa88e040b946d2233eb3682c4116b,1,0
List<io.fabric8.openshift.api.model.template.Parameter> parameters = new ArrayList<>();,8648a975d99aa88e040b946d2233eb3682c4116b,1,0
Properties properties = project.getProperties();,8648a975d99aa88e040b946d2233eb3682c4116b,1,0
"for (Map.Entry<Object, Object> entry : project.getProperties().entrySet()) {",8648a975d99aa88e040b946d2233eb3682c4116b,1,0
Object key = entry.getKey();,8648a975d99aa88e040b946d2233eb3682c4116b,1,0
"value = properties.getProperty(String.format(PARAMETER_NAME_PREFIX, name));",8648a975d99aa88e040b946d2233eb3682c4116b,1,0
import io.fabric8.maven.support.VolumeType;,8648a975d99aa88e040b946d2233eb3682c4116b,0,0
import java.util.ArrayList;,8648a975d99aa88e040b946d2233eb3682c4116b,0,0
import java.util.HashMap;,8648a975d99aa88e040b946d2233eb3682c4116b,0,0
import java.util.List;,8648a975d99aa88e040b946d2233eb3682c4116b,0,0
import java.util.Map;,8648a975d99aa88e040b946d2233eb3682c4116b,0,0
import java.util.Properties;,8648a975d99aa88e040b946d2233eb3682c4116b,0,0
import java.util.Set;,8648a975d99aa88e040b946d2233eb3682c4116b,0,0
import java.util.TreeMap;,8648a975d99aa88e040b946d2233eb3682c4116b,0,0
if (volumeType != null) {,8648a975d99aa88e040b946d2233eb3682c4116b,0,0
"volumes.add(volumeType.fromProperties(name, properties));",8648a975d99aa88e040b946d2233eb3682c4116b,0,0
import io.fabric8.kubernetes.api.model.EmptyDirVolumeSource;,8648a975d99aa88e040b946d2233eb3682c4116b,0,1
import io.fabric8.kubernetes.api.model.GitRepoVolumeSource;,8648a975d99aa88e040b946d2233eb3682c4116b,0,1
import io.fabric8.kubernetes.api.model.HostPathVolumeSource;,8648a975d99aa88e040b946d2233eb3682c4116b,0,1
import io.fabric8.kubernetes.api.model.VolumeBuilder;,8648a975d99aa88e040b946d2233eb3682c4116b,0,1
import java.util.*;,8648a975d99aa88e040b946d2233eb3682c4116b,0,1
if (type.equals(VOLUME_HOST_PATH)) {,8648a975d99aa88e040b946d2233eb3682c4116b,0,1
volumes.add(new VolumeBuilder(),8648a975d99aa88e040b946d2233eb3682c4116b,0,1
.withName(name),8648a975d99aa88e040b946d2233eb3682c4116b,0,1
.withNewSource(),8648a975d99aa88e040b946d2233eb3682c4116b,0,1
.withHostDir(new HostPathVolumeSource(path)),8648a975d99aa88e040b946d2233eb3682c4116b,0,1
.endSource(),8648a975d99aa88e040b946d2233eb3682c4116b,0,1
.build());,8648a975d99aa88e040b946d2233eb3682c4116b,0,1
} else if (type.equals(EMPTY_DIR_MEDIUM)) {,8648a975d99aa88e040b946d2233eb3682c4116b,0,1
.withEmptyDir(new EmptyDirVolumeSource(medium)),8648a975d99aa88e040b946d2233eb3682c4116b,0,1
} else if (type.equals(VOLUME_GIT_REPO)) {,8648a975d99aa88e040b946d2233eb3682c4116b,0,1
".withGitRepo(new GitRepoVolumeSource(repository, revision))",8648a975d99aa88e040b946d2233eb3682c4116b,0,1
import io.fabric8.openshift.api.model.template.ParameterBuilder;,8648a975d99aa88e040b946d2233eb3682c4116b,0,0
import io.fabric8.openshift.api.model.template.Template;,8648a975d99aa88e040b946d2233eb3682c4116b,0,0
import io.fabric8.openshift.api.model.template.TemplateBuilder;,8648a975d99aa88e040b946d2233eb3682c4116b,0,0
if (!template.getParameters().isEmpty()) {,8648a975d99aa88e040b946d2233eb3682c4116b,0,0
},8648a975d99aa88e040b946d2233eb3682c4116b,0,0
public Template getTemplate() {,8648a975d99aa88e040b946d2233eb3682c4116b,0,0
if (key instanceof String) {,8648a975d99aa88e040b946d2233eb3682c4116b,0,0
if (m.matches()) {,8648a975d99aa88e040b946d2233eb3682c4116b,0,0
//If neither value nor from has been specified read the value inline.,8648a975d99aa88e040b946d2233eb3682c4116b,0,0
if (Strings.isNullOrBlank(value) && Strings.isNullOrBlank(from)) {,8648a975d99aa88e040b946d2233eb3682c4116b,0,0
parameters.add(new ParameterBuilder(),8648a975d99aa88e040b946d2233eb3682c4116b,0,0
.withName(name),8648a975d99aa88e040b946d2233eb3682c4116b,0,0
.withFrom(from),8648a975d99aa88e040b946d2233eb3682c4116b,0,0
.withValue(value),8648a975d99aa88e040b946d2233eb3682c4116b,0,0
.withGenerate(generate),8648a975d99aa88e040b946d2233eb3682c4116b,0,0
.withDescription(description),8648a975d99aa88e040b946d2233eb3682c4116b,0,0
.build());,8648a975d99aa88e040b946d2233eb3682c4116b,0,0
String.valueOf(properties.getProperty(TEMPLATE_NAME)) :,8648a975d99aa88e040b946d2233eb3682c4116b,0,0
project.getArtifactId();,8648a975d99aa88e040b946d2233eb3682c4116b,0,0
return new TemplateBuilder().withName(templateName).withParameters(parameters).build();,8648a975d99aa88e040b946d2233eb3682c4116b,0,0
"onApplyError(""Failed to update controller from "" + sourceName + "". "" + e + "". "" + service, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,16,0
"onApplyError(""Failed to create service from "" + sourceName + "". "" + e + "". "" + service, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,16,0
"onApplyError(""Failed to update pod from "" + sourceName + "". "" + e + "". "" + pod, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,16,0
"onApplyError(""Failed to update controller from "" + sourceName + "". "" + e + "". "" + service, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,16,1
"onApplyError(""Failed to create service from "" + sourceName + "". "" + e + "". "" + service, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,16,1
"onApplyError(""Failed to update pod from "" + sourceName + "". "" + e + "". "" + pod, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,16,1
"onApplyError(""Failed to update Template from "" + sourceName + "". "" + e + "". "" + entity, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,16,0
"onApplyError(""Failed to update Service from "" + sourceName + "". "" + e + "". "" + service, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,16,0
"onApplyError(""Failed to update ReplicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,16,0
"onApplyError(""Failed to update Pod from "" + sourceName + "". "" + e + "". "" + pod, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,16,0
"onApplyError(""Failed to update pod from "" + sourceName + "". "" + e + "". "" + entity, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,16,1
"onApplyError(""Failed to update service account from "" + sourceName + "". "" + e + "". "" + serviceAccount, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,16,1
"onApplyError(""Failed to update controller from "" + sourceName + "". "" + e + "". "" + service, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,16,1
"onApplyError(""Failed to create service from "" + sourceName + "". "" + e + "". "" + service, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,16,1
"onApplyError(""Failed to update pod from "" + sourceName + "". "" + e + "". "" + pod, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,16,1
"onApplyError(""Failed to update replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,15,0
"onApplyError(""Failed to create pod from "" + sourceName + "". "" + e + "". "" + pod, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,15,0
"onApplyError(""Failed to update replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,15,1
"onApplyError(""Failed to create pod from "" + sourceName + "". "" + e + "". "" + pod, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,15,1
"onApplyError(""Failed to update replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,15,0
"onApplyError(""Failed to update replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,15,1
"onApplyError(""Failed to update replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,15,0
"onApplyError(""Failed to update replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,15,1
"onApplyError(""Failed to update OAuthClient from "" + sourceName + "". "" + e + "". "" + entity, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,15,0
"onApplyError(""Failed to Template entity from "" + sourceName + "". "" + e + "". "" + entity, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,15,0
"onApplyError(""Failed to update ServiceAccount from "" + sourceName + "". "" + e + "". "" + serviceAccount, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,15,0
"onApplyError(""Failed to create Service from "" + sourceName + "". "" + e + "". "" + service, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,15,0
"onApplyError(""Failed to create ReplicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,15,0
"onApplyError(""Failed to create Pod from "" + sourceName + "". "" + e + "". "" + pod, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,15,0
"onApplyError(""Failed to update controller from "" + sourceName + "". "" + e + "". "" + entity, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,15,1
"onApplyError(""Failed to create service account from "" + sourceName + "". "" + e + "". "" + serviceAccount, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,15,1
"onApplyError(""Failed to update replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,15,1
"onApplyError(""Failed to create pod from "" + sourceName + "". "" + e + "". "" + pod, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,15,1
"onApplyError(""Failed to create replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,14,0
"onApplyError(""Failed to create replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,14,1
"onApplyError(""Failed to create ServiceAccount from "" + sourceName + "". "" + e + "". "" + serviceAccount, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,14,0
"onApplyError(""Failed to create Secret from "" + sourceName + "". "" + e + "". "" + secret, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,14,0
"onApplyError(""Failed to template entity from "" + sourceName + "". "" + e + "". "" + entity, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,14,1
"onApplyError(""Failed to create secret from "" + sourceName + "". "" + e + "". "" + secret, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,14,1
"onApplyError(""Failed to create replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,14,1
"LOG.info(""Creating a service from "" + sourceName + "" namespace "" + namespace + "" name "" + getId(service));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,13,0
"LOG.info(""Updating a pod from "" + sourceName + "" namespace "" + namespace + "" name "" + getId(pod));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,13,0
"LOG.info(""Creating a pod from "" + sourceName + "" namespace "" + namespace + "" name "" + getId(pod));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,13,0
"LOG.info(""Creating a service from "" + sourceName + "" namespace "" + namespace + "" name "" + getId(service));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,13,1
"LOG.info(""Updating a pod from "" + sourceName + "" namespace "" + namespace + "" name "" + getId(pod));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,13,1
"LOG.info(""Creating a pod from "" + sourceName + "" namespace "" + namespace + "" name "" + getId(pod));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,13,1
"LOG.warn(""Creation disabled so not creating a Template from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(entity));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,13,0
"LOG.info(""Creating a Template from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(entity));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,13,0
"LOG.info(""Updating ReplicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,13,0
"LOG.warn(""Creation disabled so not creating a ReplicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,13,0
"LOG.info(""Creating a ReplicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,13,0
"LOG.info(""Updating a Pod from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(pod));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,13,0
"LOG.info(""Creating a Pod from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(pod));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,13,0
"LOG.warn(""Creation disabled so not creating a service from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(serviceAccount));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,13,1
"LOG.info(""Creating a service account from "" + sourceName + "" namespace "" + namespace + "" name "" + getName",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,13,1
"LOG.warn(""Creation disabled so not creating a service from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(service));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,13,1
"LOG.info(""Creating a service from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(service));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,13,1
"LOG.info(""Updating a pod from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(pod));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,13,1
"LOG.info(""Creating a pod from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(pod));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,13,1
"LOG.info(""Updating replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getId(replicationController));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,0
"LOG.info(""Creating a replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getId(replicationController));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,0
"LOG.info(""Updating replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getId(replicationController));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,1
"LOG.info(""Creating a replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getId(replicationController));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,1
"LOG.info(""Updating replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,0
"LOG.warn(""Creation disabled so not creating a replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,0
"LOG.info(""Updating replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,1
"LOG.warn(""Creation disabled so not creating a replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,1
"LOG.info(""Updating replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,0
"LOG.warn(""Creation disabled so not creating a replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,0
"LOG.info(""Updating replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,1
"LOG.warn(""Creation disabled so not creating a replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,1
"LOG.warn(""Creation disabled so not creating a ServiceAccount from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(serviceAccount));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,0
"LOG.info(""Creating a ServiceAccount from "" + sourceName + "" namespace "" + namespace + "" name "" + getName",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,0
"LOG.warn(""Creation disabled so not creating a Secret from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(secret));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,0
"LOG.info(""Creating a Secret from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(secret));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,0
"LOG.warn(""Creation disabled so not creating a Service from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(service));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,0
"LOG.info(""Creating a Service from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(service));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,0
"LOG.warn(""Creation disabled so not creating a entity from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(entity));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,1
"LOG.info(""Creating a template from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(entity));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,1
"LOG.warn(""Creation disabled so not creating a secret from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(secret));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,1
"LOG.info(""Creating a secret from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(secret));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,1
"LOG.info(""Updating replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,1
"LOG.warn(""Creation disabled so not creating a replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,1
"LOG.info(""Creating a replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,12,1
"onApplyError(""Failed to create namespace. "" + e + "". "" + entity, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,8,1
"onApplyError(""Failed to create namespace: "" + name + "" due "" + e.getMessage(), e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,7,0
"LOG.info(""rollingUpgradePreserveScale "" + rollingUpgradePreserveScale + "" new replicas is "" + (newSpec != null ? newSpec.getReplicas() : ""<null>""));",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,7,0
"LOG.info(""rollingUpgradePreserveScale "" + rollingUpgradePreserveScale + "" new replicas is "" + newSpec.getReplicas());",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,6,0
"LOG.warn(""Cannot convert "" + result + "" to JSON: "" + e, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,6,0
"LOG.warn(""Could not convert "" + result + "" to JSON: "" + e, e);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,6,1
"LOG.info(""rollingUpgradePreserveScale "" + rollingUpgradePreserveScale + "" new replicas is "" + newSpec.getReplicas());",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,6,1
"LOG.info(""Updating a service from "" + sourceName);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,4,0
"LOG.info(""Updated pod result: "" + answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,4,0
"LOG.info(""Updating a service from "" + sourceName);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,4,1
"LOG.info(""Updated pod result: "" + answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,4,1
"LOG.debug(""Ignoring Service: "" + namespace + "":"" + id);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,4,0
"LOG.info(""Rolling upgrade of the RC "" + namespace + ""/"" + id);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,4,0
"LOG.info(""Rolling upgrade of the RC "" + namespace + ""/"" + id);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,4,0
} else if (isRecreateMode()) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,4,0
"LOG.info(""Rolling upgrade of the RC "" + namespace + ""/"" + id);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,4,1
"LOG.info(""Updating a Template from "" + sourceName);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,4,0
"LOG.info(""Rolling upgrade of the ReplicationController: "" + namespace + ""/"" + id);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,4,0
"LOG.info(""Updated Pod result: "" + answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,4,0
"LOG.info(""Updated pod result: "" + answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,4,1
"LOG.info(""Updating a service account from "" + sourceName);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,4,1
"LOG.info(""Updating a service from "" + sourceName);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,4,1
"LOG.info(""Rolling upgrade of the RC "" + namespace + ""/"" + id);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,4,1
} else {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,3,0
"LOG.info(""Updated service: "" + answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,3,0
"LOG.info(""Updated replicationController: "" + answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,3,0
"LOG.info(""Created pod result: "" + answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,3,0
"LOG.info(""Updated service: "" + answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,3,1
} else {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,3,1
"LOG.info(""Updated replicationController: "" + answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,3,1
"LOG.info(""Created pod result: "" + answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,3,1
} else {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,3,0
} else {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,3,1
} else {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,3,0
if (rollingUpgradePreserveScale && newSpec != null && oldSpec != null) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,3,0
} else {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,3,1
"LOG.info(""Updated OAuthClient result: "" + answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,3,0
"LOG.info(""Updated Template: "" + answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,3,0
"LOG.info(""Updating a ServiceAccount from "" + sourceName);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,3,0
"LOG.info(""Updating a Secret from "" + sourceName);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,3,0
"LOG.info(""Updating a Service from "" + sourceName);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,3,0
"LOG.info(""Created Pod result: "" + answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,3,0
"LOG.info(""Updating a entity from "" + sourceName);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,3,1
"LOG.info(""Updated entity: "" + answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,3,1
"LOG.info(""Updateing a secret from "" + sourceName);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,3,1
"LOG.info(""Created pod result: "" + answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,3,1
"public void applyService(Service service, String sourceName) throws Exception {",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
if (isUpdateViaDeleteAndCreate()) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
"Object answer = kubernetes.updateService(id, service, namespace);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
} catch (Exception e) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
"protected void doCreateService(Service service, String namespace, String sourceName) {",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
if (Strings.isNotBlank(namespace)) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
"LOG.info(""Created service: "" + answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
"LOG.info(""Created replicationController: "" + answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
"public void applyService(Service service, String sourceName) {",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
"Object answer = kubernetes.updateService(id, service, namespace);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
} catch (Exception e) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
if (Strings.isNotBlank(namespace)) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
"LOG.info(""Created service: "" + answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
"LOG.info(""Created replicationController: "" + answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
if (isIgnoreServiceMode()) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
if (isRecreateMode()) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
if (isUpdateViaDeleteAndCreate()) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
if (rollingUpgrade) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
if (isRunning(old)) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
"if (UserConfigurationCompare.configEqual(replicationController, old)) {",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
if (isRecreateMode()) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
"LOG.info(""Deleting ReplicationController: "" + id);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
if (deletePodsOnReplicationControllerUpdate) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
} catch (Exception e) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
if (!isAllowCreate()) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
if (isRunning(old)) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
"if (UserConfigurationCompare.configEqual(replicationController, old)) {",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
if (isRecreateMode()) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
"LOG.info(""Deleting ReplicationController: "" + id);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
if (deletePodsOnReplicationControllerUpdate) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
} catch (Exception e) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
if (!isAllowCreate()) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
if (isRunning(old)) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
"if (UserConfigurationCompare.configEqual(replicationController, old)) {",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
if (rollingUpgrade) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
if (replicas != null) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
"LOG.info(""Deleting ReplicationController: "" + id);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
if (deletePodsOnReplicationControllerUpdate) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
} catch (Exception e) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
if (!isAllowCreate()) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
if (rollingUpgrade) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
if (isRunning(old)) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
"if (UserConfigurationCompare.configEqual(replicationController, old)) {",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
if (isRecreateMode()) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
"LOG.info(""Deleting ReplicationController: "" + id);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
if (deletePodsOnReplicationControllerUpdate) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
} catch (Exception e) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
if (!isAllowCreate()) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
"LOG.debug(""Ignoring recursive list "" + list);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
"LOG.info(kind + "" has not changed so not doing anything"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
"LOG.info(""Using namespace: "" + namespace);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,0
"LOG.warn(""Ignoring recursive list "" + list);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
"LOG.info(kind + "" hasn't changed so not doing anything"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
"LOG.info(""Creating a namespace "" + namespace);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,2,1
public String apply(File file) throws Exception {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
public String applyJson(byte[] json) throws Exception {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
public String applyJson(String json) throws Exception {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
public String applyJson(File json) throws Exception {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
public String applyYaml(String yaml) throws Exception {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
public String applyYaml(File yaml) throws Exception {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
public String applyJson(InputStream json) throws Exception {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
"public void apply(Object dto, String sourceName) throws Exception {",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
"public void applyEntity(Object dto, String sourceName) throws Exception {",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
"public void applyConfig(Config config, String sourceName) throws Exception {",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
"public void applyList(JsonNode entity, String sourceName) throws Exception {",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
try {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
},6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
"answer = kubernetes.createService(service, namespace);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
answer = kubernetes.createService(service);,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
"public void applyReplicationController(ReplicationController replicationController, String sourceName) throws Exception {",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
"Object answer = kubernetes.updateReplicationController(id, replicationController);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
"protected void doCreateReplicationController(ReplicationController replicationController, String namespace, String sourceName) {",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
"answer = kubernetes.createReplicationController(replicationController, namespace);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
answer = kubernetes.createReplicationController(replicationController);,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
"public void applyPod(Pod pod, String sourceName) throws Exception {",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
"Object answer = kubernetes.updatePod(id, pod);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
"protected void doCreatePod(Pod pod, String namespace, String sourceName) {",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
"answer = kubernetes.createPod(pod, namespace);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
answer = kubernetes.createPod(pod);,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
public boolean isUpdateViaDeleteAndCreate() {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
return updateViaDeleteAndCreate;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
public void setUpdateViaDeleteAndCreate(boolean updateViaDeleteAndCreate) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
public String apply(File file) throws IOException {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
public String applyJson(byte[] json) throws IOException {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
public String applyJson(String json) throws IOException {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
public String applyJson(File json) throws IOException {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
public String applyYaml(String yaml) throws IOException {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
public String applyYaml(File yaml) throws IOException {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
public String applyJson(InputStream json) throws IOException {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
"public void apply(Object dto, String sourceName) throws IOException {",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
"public void applyEntity(Object dto, String sourceName) {",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
"public void applyConfig(Config config, String sourceName) throws IOException {",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
"public void applyList(JsonNode entity, String sourceName) throws IOException {",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
try {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
"answer = kubernetes.createService(service, namespace);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
answer = kubernetes.createService(service);,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
},6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
"public void applyReplicationController(ReplicationController replicationController, String sourceName) {",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
"Object answer = kubernetes.updateReplicationController(id, replicationController);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
"answer = kubernetes.createReplicationController(replicationController, namespace);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
answer = kubernetes.createReplicationController(replicationController);,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
"public void applyPod(Pod pod, String sourceName) {",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
"Object answer = kubernetes.updatePod(id, pod);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
"answer = kubernetes.createPod(pod, namespace);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
answer = kubernetes.createPod(pod);,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
},6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
public boolean isRecreateMode() {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
return recreateMode;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
public void setRecreateMode(boolean recreateMode) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
* If enabled then all services are ignored to avoid them being recreated. This is useful if you want to,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
public boolean isIgnoreServiceMode() {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
return ignoreServiceMode;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
public void setIgnoreServiceMode(boolean ignoreServiceMode) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
public boolean isUpdateViaDeleteAndCreate() {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
return updateViaDeleteAndCreate;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
public void setUpdateViaDeleteAndCreate(boolean updateViaDeleteAndCreate) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
ReplicationController old = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).get();,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
try {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
Object answer = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).replace(replicationController);,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
"LOG.info(""Deleting any pods for the replication controller to ensure they use the new configuration"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
"LOG.info(""Warning not deleted any pods so they could well be running with the old configuration!"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
},6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
public boolean isRollingUpgrade() {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
return rollingUpgrade;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
public void setRollingUpgrade(boolean rollingUpgrade) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
ReplicationController old = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).get();,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
try {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
Object answer = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).replace(replicationController);,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
"LOG.info(""Deleting any pods for the replication controller to ensure they use the new configuration"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
"LOG.info(""Warning not deleted any pods so they could well be running with the old configuration!"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
},6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
private boolean rollingUpgradePreserveScale = true;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
ReplicationController old = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).get();,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
// lets preserve the number of replicas currently running in the environment we are about to upgrade,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
},6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
try {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
Object answer = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).replace(replicationController);,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
"LOG.info(""Deleting any pods for the replication controller to ensure they use the new configuration"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
"LOG.info(""Warning not deleted any pods so they could well be running with the old configuration!"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
public boolean isRollingUpgradePreserveScale() {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
return rollingUpgradePreserveScale;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
public void setRollingUpgradePreserveScale(boolean rollingUpgradePreserveScale) {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
ReplicationController old = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).get();,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
try {,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
Object answer = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).replace(replicationController);,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
"LOG.info(""Deleting any pods for the replication controller to ensure they use the new configuration"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
"LOG.info(""Warning not deleted any pods so they could well be running with the old configuration!"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
},6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
"logGeneratedEntity(""Updated Service: "", namespace, service, answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
"logGeneratedEntity(""Created Service: "", namespace, service, answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,0
"logGeneratedEntity(""Updated service account: "", namespace, serviceAccount, answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
"logGeneratedEntity(""Created service account: "", namespace, serviceAccount, answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
"logGeneratedEntity(""Updated service: "", namespace, service, answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
"logGeneratedEntity(""Created service: "", namespace, service, answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,1,1
private boolean updateViaDeleteAndCreate;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
kubernetes.deleteService(service);,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
"doCreateService(service, namespace, sourceName);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
Object answer;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
kubernetes.deleteReplicationControllerAndPods(replicationController);,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
"doCreateReplicationController(replicationController, namespace, sourceName);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
kubernetes.deletePod(pod);,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
"doCreatePod(pod, namespace, sourceName);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
this.updateViaDeleteAndCreate = updateViaDeleteAndCreate;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
Object answer;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
private boolean recreateMode;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
private boolean ignoreServiceMode;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
String id = getId(service);,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
return;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
* If enabled then updates are performed by deleting the resource first then creating it,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
this.recreateMode = recreateMode;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
/**,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
* recreate ReplicationControllers and Pods but leave Services as they are to avoid the portalIP addresses,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
* changing,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
*/,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
this.ignoreServiceMode = ignoreServiceMode;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
import javax.ws.rs.WebApplicationException;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
private boolean updateViaDeleteAndCreate;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
String id = getId(service);,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
* If enabled then updates are performed by deleting the resource first then rereating it,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
this.updateViaDeleteAndCreate = updateViaDeleteAndCreate;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
private boolean rollingUpgrade;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).rolling().replace(replicationController);,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
"LOG.info(""ReplicationController hasn't changed so not doing anything"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).delete();,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
"doCreateReplicationController(replicationController, namespace, sourceName);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
"logGeneratedEntity(""Updated replicationController: "", namespace, replicationController, answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
kubernetesClient.pods().inNamespace(namespace).withLabels(replicationController.getSpec().getSelector()).delete();,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
this.rollingUpgrade = rollingUpgrade;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
"LOG.info(""ReplicationController hasn't changed so not doing anything"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).delete();,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
"doCreateReplicationController(replicationController, namespace, sourceName);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
"logGeneratedEntity(""Updated replicationController: "", namespace, replicationController, answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
kubernetesClient.pods().inNamespace(namespace).withLabels(replicationController.getSpec().getSelector()).delete();,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
"LOG.info(""ReplicationController hasn't changed so not doing anything"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
ReplicationControllerSpec newSpec = replicationController.getSpec();,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
ReplicationControllerSpec oldSpec = old.getSpec();,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
Integer replicas = oldSpec.getReplicas();,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
newSpec.setReplicas(replicas);,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).rolling().replace(replicationController);,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).delete();,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
"doCreateReplicationController(replicationController, namespace, sourceName);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
"logGeneratedEntity(""Updated replicationController: "", namespace, replicationController, answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
kubernetesClient.pods().inNamespace(namespace).withLabels(newSpec.getSelector()).delete();,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
this.rollingUpgradePreserveScale = rollingUpgradePreserveScale;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
import io.fabric8.kubernetes.api.model.Doneable;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
import io.fabric8.kubernetes.api.model.DoneablePersistentVolumeClaim;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
import io.fabric8.kubernetes.api.model.KubernetesResourceList;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
import io.fabric8.kubernetes.api.model.PersistentVolumeClaimList;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
import io.fabric8.kubernetes.api.model.SecurityContextConstraints;,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).rolling().replace(replicationController);,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
"LOG.info(""ReplicationController hasn't changed so not doing anything"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).delete();,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
"doCreateReplicationController(replicationController, namespace, sourceName);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
"logGeneratedEntity(""Updated replicationController: "", namespace, replicationController, answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
kubernetesClient.pods().inNamespace(namespace).withLabels(replicationController.getSpec().getSelector()).delete();,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
"LOG.info(""OAuthClient has not changed so not doing anything"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
"LOG.info(""Template has not changed so not doing anything"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
"logGeneratedEntity(""Created Template: "", namespace, entity, answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
"LOG.info(""ServiceAccount has not changed so not doing anything"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
"logGeneratedEntity(""Updated ServiceAccount: "", namespace, serviceAccount, answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
"logGeneratedEntity(""Created ServiceAccount: "", namespace, serviceAccount, answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
"LOG.info(""Secret has not changed so not doing anything"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
"logGeneratedEntity(""Updated Secret:"", namespace, secret, answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
"logGeneratedEntity(""Created Secret: "", namespace, secret, answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
"LOG.info(""BuildConfig has not changed so not doing anything"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
"LOG.info(""Service has not changed so not doing anything"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
"LOG.info(""ReplicationController has not changed so not doing anything"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
"logGeneratedEntity(""Created ReplicationController: "", namespace, replicationController, answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
"LOG.info(""Pod has not changed so not doing anything"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,0
private static final ObjectMapper OBJECT_MAPPER = new ObjectMapper();,6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
"private Map<String, Pod> podMap;",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
"private Map<String, ReplicationController> replicationControllerMap;",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
"private Map<String, Service> serviceMap;",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
"LOG.info(""OAuthClient hasn't changed so not doing anything"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
"LOG.info(""Template hasn't changed so not doing anything"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
"logGeneratedEntity(""Created template: "", namespace, entity, answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
"LOG.info(""ServiceAccount hasn't changed so not doing anything"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
"LOG.info(""Secret hasn't changed so not doing anything"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
"logGeneratedEntity(""Updated secret:"", namespace, secret, answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
"logGeneratedEntity(""Created secret: "", namespace, secret, answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
"LOG.info(""BuildConfig hasn't changed so not doing anything"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
"LOG.info(""Service hasn't changed so not doing anything"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
"LOG.info(""ReplicationController hasn't changed so not doing anything"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
"logGeneratedEntity(""Created replicationController: "", namespace, replicationController, answer);",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
"LOG.info(""Pod hasn't changed so not doing anything"");",6fc94ec34137918a24cd3aa494b88f000f9a7a2c,0,1
"LOG.info(""Updating replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",678a8f06bef5b026f044eba73983363a64763e25,14,0
"onApplyError(""Failed to update replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",678a8f06bef5b026f044eba73983363a64763e25,14,0
"LOG.warn(""Creation disabled so not creating a replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",678a8f06bef5b026f044eba73983363a64763e25,14,0
"LOG.info(""Updating replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",678a8f06bef5b026f044eba73983363a64763e25,14,1
"onApplyError(""Failed to update replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",678a8f06bef5b026f044eba73983363a64763e25,14,1
"LOG.warn(""Creation disabled so not creating a replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",678a8f06bef5b026f044eba73983363a64763e25,14,1
"LOG.info(""Updating replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",678a8f06bef5b026f044eba73983363a64763e25,14,0
"onApplyError(""Failed to update replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",678a8f06bef5b026f044eba73983363a64763e25,14,0
"LOG.warn(""Creation disabled so not creating a replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",678a8f06bef5b026f044eba73983363a64763e25,14,0
"LOG.info(""Updating replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",678a8f06bef5b026f044eba73983363a64763e25,14,1
"onApplyError(""Failed to update replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",678a8f06bef5b026f044eba73983363a64763e25,14,1
"LOG.warn(""Creation disabled so not creating a replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",678a8f06bef5b026f044eba73983363a64763e25,14,1
"onApplyError(""Failed to create config from "" + sourceName + "". "" + e, e);",678a8f06bef5b026f044eba73983363a64763e25,10,1
"getLog().info(""Using kubernetes at: "" + kubernetes.getAddress() + "" in namespace "" + kubernetes.getNamespace());",678a8f06bef5b026f044eba73983363a64763e25,9,0
"getLog().info(""Using kubernetes at: "" + api.getAddress() + "" in namespace "" + api.getNamespace());",678a8f06bef5b026f044eba73983363a64763e25,9,1
"LOG.warn(""Unknown JSON type "" + kindNode + "". JSON: "" + tree);",678a8f06bef5b026f044eba73983363a64763e25,7,1
"onApplyError(""Failed to process "" + json + "". "" + e, e);",678a8f06bef5b026f044eba73983363a64763e25,7,1
"log.debug(""Service "" + id + "" has ports: "" + ports);",678a8f06bef5b026f044eba73983363a64763e25,6,0
"LOG.info(""rollingUpgradePreserveScale "" + rollingUpgradePreserveScale + "" new replicas is "" + newSpec.getReplicas());",678a8f06bef5b026f044eba73983363a64763e25,6,0
"json = e.getMessage() + "". object: "" + route;",678a8f06bef5b026f044eba73983363a64763e25,5,0
"json = e.getMessage() + "". object: "" + route;",678a8f06bef5b026f044eba73983363a64763e25,5,0
"json = e.getMessage() + "". object: "" + route;",678a8f06bef5b026f044eba73983363a64763e25,5,1
"LOG.info(""Rolling upgrade of the RC "" + namespace + ""/"" + id);",678a8f06bef5b026f044eba73983363a64763e25,5,0
"LOG.info(""Rolling upgrade of the RC "" + namespace + ""/"" + id);",678a8f06bef5b026f044eba73983363a64763e25,5,0
"LOG.info(""Rolling upgrade of the RC "" + namespace + ""/"" + id);",678a8f06bef5b026f044eba73983363a64763e25,5,1
"@Parameter(property = ""fabric8.apply.createRoutes"", defaultValue = ""true"")",678a8f06bef5b026f044eba73983363a64763e25,3,0
"@Parameter(property = ""fabric8.apply.domain"", defaultValue = ""${env.KUBERNETES_DOMAIN}"")",678a8f06bef5b026f044eba73983363a64763e25,3,0
"LOG.warn(""No JSON kind for: "" + tree);",678a8f06bef5b026f044eba73983363a64763e25,3,1
"@Parameter(property = ""fabric8.apply.failOnError"", defaultValue = ""true"")",678a8f06bef5b026f044eba73983363a64763e25,3,1
"@Parameter(property = ""fabric8.apply.domain"", defaultValue = ""${env.KUBERNETES_DOMAIN}"")",678a8f06bef5b026f044eba73983363a64763e25,3,1
KubernetesClient kubernetes = getKubernetes();,678a8f06bef5b026f044eba73983363a64763e25,2,0
Controller controller = new Controller(this.kubernetes);,678a8f06bef5b026f044eba73983363a64763e25,2,0
"getLog().warn(""No fabric8.apply.routeDomain property or $KUBERNETES_DOMAIN environment variable so cannot create any OpenShift Routes"");",678a8f06bef5b026f044eba73983363a64763e25,2,0
String namespace = kubernetes.getNamespace();,678a8f06bef5b026f044eba73983363a64763e25,2,0
} catch (Exception e) {,678a8f06bef5b026f044eba73983363a64763e25,2,0
"getLog().warn(""Could not load routes; we maybe are not connected to an OpenShift environment? "" + e, e);",678a8f06bef5b026f044eba73983363a64763e25,2,0
Service service = (Service) object;,678a8f06bef5b026f044eba73983363a64763e25,2,0
"route.setHost(host + ""."" + Strings.stripPrefix(routeDomain, "".""));",678a8f06bef5b026f044eba73983363a64763e25,2,0
} catch (JsonProcessingException e) {,678a8f06bef5b026f044eba73983363a64763e25,2,0
"getLog().debug(""Created route: "" + json);",678a8f06bef5b026f044eba73983363a64763e25,2,0
Controller controller = new Controller(kubernetes);,678a8f06bef5b026f044eba73983363a64763e25,2,1
} else if (dto instanceof KubernetesList) {,678a8f06bef5b026f044eba73983363a64763e25,2,0
} else if (dto instanceof JsonNode) {,678a8f06bef5b026f044eba73983363a64763e25,2,1
"} else if (Objects.equal(""Template"", kind)) {",678a8f06bef5b026f044eba73983363a64763e25,2,1
} else {,678a8f06bef5b026f044eba73983363a64763e25,2,1
} catch (IOException e) {,678a8f06bef5b026f044eba73983363a64763e25,2,1
} catch (Exception e) {,678a8f06bef5b026f044eba73983363a64763e25,2,1
Controller controller = createController();,678a8f06bef5b026f044eba73983363a64763e25,2,0
Log log = getLog();,678a8f06bef5b026f044eba73983363a64763e25,2,0
"log.warn(""No fabric8.apply.routeDomain property or $KUBERNETES_DOMAIN environment variable so cannot create any OpenShift Routes"");",678a8f06bef5b026f044eba73983363a64763e25,2,0
"log.warn(""Could not load routes; we maybe are not connected to an OpenShift environment? "" + e, e);",678a8f06bef5b026f044eba73983363a64763e25,2,0
"public static Route createRouteForService(String routeDomainPostfix, String namespace, Service service, Log log) {",678a8f06bef5b026f044eba73983363a64763e25,2,0
"routeSpec.setHost(host + ""."" + Strings.stripPrefix(routeDomainPostfix, "".""));",678a8f06bef5b026f044eba73983363a64763e25,2,0
} catch (JsonProcessingException e) {,678a8f06bef5b026f044eba73983363a64763e25,2,0
"log.debug(""Created route: "" + json);",678a8f06bef5b026f044eba73983363a64763e25,2,0
* By default lets ignore the kubernetes services and any service which does not expose ports 80 and 443,678a8f06bef5b026f044eba73983363a64763e25,2,0
"@Parameter(property = ""fabric8.apply.recreate"")",678a8f06bef5b026f044eba73983363a64763e25,2,1
private KubernetesClient kubernetes = new KubernetesClient();,678a8f06bef5b026f044eba73983363a64763e25,2,1
Controller controller = new Controller(this.kubernetes);,678a8f06bef5b026f044eba73983363a64763e25,2,1
"getLog().warn(""No fabric8.apply.routeDomain property or $KUBERNETES_DOMAIN environment variable so cannot create any OpenShift Routes"");",678a8f06bef5b026f044eba73983363a64763e25,2,1
"getLog().warn(""Could not load routes; we maybe are not connected to an OpenShift environment? "" + e, e);",678a8f06bef5b026f044eba73983363a64763e25,2,1
"routeSpec.setHost(host + ""."" + Strings.stripPrefix(routeDomain, "".""));",678a8f06bef5b026f044eba73983363a64763e25,2,1
} catch (JsonProcessingException e) {,678a8f06bef5b026f044eba73983363a64763e25,2,1
"getLog().debug(""Created route: "" + json);",678a8f06bef5b026f044eba73983363a64763e25,2,1
} else {,678a8f06bef5b026f044eba73983363a64763e25,2,0
"LOG.info(""Deleting ReplicationController: "" + id);",678a8f06bef5b026f044eba73983363a64763e25,2,0
Object answer = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).replace(replicationController);,678a8f06bef5b026f044eba73983363a64763e25,2,0
} catch (Exception e) {,678a8f06bef5b026f044eba73983363a64763e25,2,0
} else {,678a8f06bef5b026f044eba73983363a64763e25,2,1
"LOG.info(""Deleting ReplicationController: "" + id);",678a8f06bef5b026f044eba73983363a64763e25,2,1
Object answer = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).replace(replicationController);,678a8f06bef5b026f044eba73983363a64763e25,2,1
} catch (Exception e) {,678a8f06bef5b026f044eba73983363a64763e25,2,1
} else {,678a8f06bef5b026f044eba73983363a64763e25,2,0
} else if (isRecreateMode()) {,678a8f06bef5b026f044eba73983363a64763e25,2,0
"LOG.info(""Deleting ReplicationController: "" + id);",678a8f06bef5b026f044eba73983363a64763e25,2,0
Object answer = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).replace(replicationController);,678a8f06bef5b026f044eba73983363a64763e25,2,0
} catch (Exception e) {,678a8f06bef5b026f044eba73983363a64763e25,2,0
} else {,678a8f06bef5b026f044eba73983363a64763e25,2,1
"LOG.info(""Deleting ReplicationController: "" + id);",678a8f06bef5b026f044eba73983363a64763e25,2,1
Object answer = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).replace(replicationController);,678a8f06bef5b026f044eba73983363a64763e25,2,1
} catch (Exception e) {,678a8f06bef5b026f044eba73983363a64763e25,2,1
* Should we create routes for any services which don't already have them.,678a8f06bef5b026f044eba73983363a64763e25,1,0
* The domain added to the service ID when creating OpenShift routes,678a8f06bef5b026f044eba73983363a64763e25,1,0
List<Object> list = KubernetesHelper.toItemList(dto);,678a8f06bef5b026f044eba73983363a64763e25,1,0
if (createRoutes) {,678a8f06bef5b026f044eba73983363a64763e25,1,0
dto = list;,678a8f06bef5b026f044eba73983363a64763e25,1,0
},678a8f06bef5b026f044eba73983363a64763e25,1,0
"protected void createRoutes(KubernetesClient kubernetes, List<Object> list) {",678a8f06bef5b026f044eba73983363a64763e25,1,0
if (Strings.isNullOrBlank(routeDomain)) {,678a8f06bef5b026f044eba73983363a64763e25,1,0
try {,678a8f06bef5b026f044eba73983363a64763e25,1,0
RouteList routes = kubernetes.getRoutes(namespace);,678a8f06bef5b026f044eba73983363a64763e25,1,0
if (routes != null) {,678a8f06bef5b026f044eba73983363a64763e25,1,0
List<Route> items = routes.getItems();,678a8f06bef5b026f044eba73983363a64763e25,1,0
List<Route> routes = new ArrayList<>();,678a8f06bef5b026f044eba73983363a64763e25,1,0
for (Object object : list) {,678a8f06bef5b026f044eba73983363a64763e25,1,0
if (object instanceof Service) {,678a8f06bef5b026f044eba73983363a64763e25,1,0
String id = KubernetesHelper.getId(service);,678a8f06bef5b026f044eba73983363a64763e25,1,0
if (Strings.isNotBlank(id)) {,678a8f06bef5b026f044eba73983363a64763e25,1,0
Route route = new Route();,678a8f06bef5b026f044eba73983363a64763e25,1,0
"KubernetesHelper.setName(route, namespace, id + ""-route"");",678a8f06bef5b026f044eba73983363a64763e25,1,0
"String host = Strings.stripSuffix(Strings.stripSuffix(id, ""-service""), ""."");",678a8f06bef5b026f044eba73983363a64763e25,1,0
String json = null;,678a8f06bef5b026f044eba73983363a64763e25,1,0
json = KubernetesHelper.toJson(route);,678a8f06bef5b026f044eba73983363a64763e25,1,0
KubernetesClient api = getKubernetes();,678a8f06bef5b026f044eba73983363a64763e25,1,1
"public void applyList(KubernetesList list, String sourceName) throws Exception {",678a8f06bef5b026f044eba73983363a64763e25,1,0
List<Object> entities = list.getItems();,678a8f06bef5b026f044eba73983363a64763e25,1,0
if (entities != null) {,678a8f06bef5b026f044eba73983363a64763e25,1,0
for (Object entity : entities) {,678a8f06bef5b026f044eba73983363a64763e25,1,0
},678a8f06bef5b026f044eba73983363a64763e25,1,0
JsonNode tree = (JsonNode) dto;,678a8f06bef5b026f044eba73983363a64763e25,1,1
"JsonNode kindNode = tree.get(""kind"");",678a8f06bef5b026f044eba73983363a64763e25,1,1
if (kindNode != null) {,678a8f06bef5b026f044eba73983363a64763e25,1,1
String kind = kindNode.asText();,678a8f06bef5b026f044eba73983363a64763e25,1,1
"if (Objects.equal(""Config"", kind) || Objects.equal(""List"", kind)) {",678a8f06bef5b026f044eba73983363a64763e25,1,1
"Template template = createObjectMapper().treeToValue(tree, Template.class);",678a8f06bef5b026f044eba73983363a64763e25,1,1
},678a8f06bef5b026f044eba73983363a64763e25,1,1
"public void applyList(JsonNode entity, String sourceName) throws Exception {",678a8f06bef5b026f044eba73983363a64763e25,1,1
"JsonNode items = entity.get(""items"");",678a8f06bef5b026f044eba73983363a64763e25,1,1
if (items != null) {,678a8f06bef5b026f044eba73983363a64763e25,1,1
for (JsonNode item : items) {,678a8f06bef5b026f044eba73983363a64763e25,1,1
// TODO the apply method should deal with the item direct?,678a8f06bef5b026f044eba73983363a64763e25,1,1
String json = item.toString();,678a8f06bef5b026f044eba73983363a64763e25,1,1
Object dto = null;,678a8f06bef5b026f044eba73983363a64763e25,1,1
try {,678a8f06bef5b026f044eba73983363a64763e25,1,1
dto = loadJson(json);,678a8f06bef5b026f044eba73983363a64763e25,1,1
if (dto != null) {,678a8f06bef5b026f044eba73983363a64763e25,1,1
String routeDomainPostfix = this.routeDomain;,678a8f06bef5b026f044eba73983363a64763e25,1,0
if (Strings.isNullOrBlank(routeDomainPostfix)) {,678a8f06bef5b026f044eba73983363a64763e25,1,0
"Route route = createRouteForService(routeDomainPostfix, namespace, service, log);",678a8f06bef5b026f044eba73983363a64763e25,1,0
if (route != null) {,678a8f06bef5b026f044eba73983363a64763e25,1,0
Route route = null;,678a8f06bef5b026f044eba73983363a64763e25,1,0
String id = KubernetesHelper.getName(service);,678a8f06bef5b026f044eba73983363a64763e25,1,0
"if (Strings.isNotBlank(id) && shouldCreateRouteForService(log, service, id)) {",678a8f06bef5b026f044eba73983363a64763e25,1,0
route = new Route();,678a8f06bef5b026f044eba73983363a64763e25,1,0
"KubernetesHelper.setName(route, namespace, id + ""-route"");",678a8f06bef5b026f044eba73983363a64763e25,1,0
RouteSpec routeSpec = new RouteSpec();,678a8f06bef5b026f044eba73983363a64763e25,1,0
ObjectReference objectRef = new ObjectReference();,678a8f06bef5b026f044eba73983363a64763e25,1,0
"String host = Strings.stripSuffix(Strings.stripSuffix(id, ""-service""), ""."");",678a8f06bef5b026f044eba73983363a64763e25,1,0
String json = null;,678a8f06bef5b026f044eba73983363a64763e25,1,0
try {,678a8f06bef5b026f044eba73983363a64763e25,1,0
json = KubernetesHelper.toJson(route);,678a8f06bef5b026f044eba73983363a64763e25,1,0
},678a8f06bef5b026f044eba73983363a64763e25,1,0
* Should we try to create a route for the given service?,678a8f06bef5b026f044eba73983363a64763e25,1,0
* @returns true if we should create an OpenShift Route for this service.,678a8f06bef5b026f044eba73983363a64763e25,1,0
"protected static boolean shouldCreateRouteForService(Log log, Service service, String id) {",678a8f06bef5b026f044eba73983363a64763e25,1,0
"if (""kubernetes"".equals(id) || ""kubernetes-ro"".equals(id)) {",678a8f06bef5b026f044eba73983363a64763e25,1,0
Set<Integer> ports = KubernetesHelper.getPorts(service);,678a8f06bef5b026f044eba73983363a64763e25,1,0
if (!ports.contains(80) && !ports.contains(443)) {,678a8f06bef5b026f044eba73983363a64763e25,1,0
* Should we fail the build if an apply fails?,678a8f06bef5b026f044eba73983363a64763e25,1,1
* The domain added to the service ID when creating OpenShift routes,678a8f06bef5b026f044eba73983363a64763e25,1,1
if (Strings.isNullOrBlank(routeDomain)) {,678a8f06bef5b026f044eba73983363a64763e25,1,1
String id = KubernetesHelper.getName(service);,678a8f06bef5b026f044eba73983363a64763e25,1,1
if (Strings.isNotBlank(id)) {,678a8f06bef5b026f044eba73983363a64763e25,1,1
Route route = new Route();,678a8f06bef5b026f044eba73983363a64763e25,1,1
"KubernetesHelper.setName(route, namespace, id + ""-route"");",678a8f06bef5b026f044eba73983363a64763e25,1,1
RouteSpec routeSpec = new RouteSpec();,678a8f06bef5b026f044eba73983363a64763e25,1,1
ObjectReference objectRef = new ObjectReference();,678a8f06bef5b026f044eba73983363a64763e25,1,1
"String host = Strings.stripSuffix(Strings.stripSuffix(id, ""-service""), ""."");",678a8f06bef5b026f044eba73983363a64763e25,1,1
String json = null;,678a8f06bef5b026f044eba73983363a64763e25,1,1
try {,678a8f06bef5b026f044eba73983363a64763e25,1,1
json = KubernetesHelper.toJson(route);,678a8f06bef5b026f044eba73983363a64763e25,1,1
},678a8f06bef5b026f044eba73983363a64763e25,1,1
public KubernetesClient getKubernetes() {,678a8f06bef5b026f044eba73983363a64763e25,1,1
if (Strings.isNotBlank(namespace)) {,678a8f06bef5b026f044eba73983363a64763e25,1,1
kubernetes.setNamespace(namespace);,678a8f06bef5b026f044eba73983363a64763e25,1,1
if (rollingUpgrade) {,678a8f06bef5b026f044eba73983363a64763e25,1,0
ReplicationController old = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).get();,678a8f06bef5b026f044eba73983363a64763e25,1,0
if (isRunning(old)) {,678a8f06bef5b026f044eba73983363a64763e25,1,0
"if (UserConfigurationCompare.configEqual(replicationController, old)) {",678a8f06bef5b026f044eba73983363a64763e25,1,0
if (isRecreateMode()) {,678a8f06bef5b026f044eba73983363a64763e25,1,0
try {,678a8f06bef5b026f044eba73983363a64763e25,1,0
if (deletePodsOnReplicationControllerUpdate) {,678a8f06bef5b026f044eba73983363a64763e25,1,0
"LOG.info(""Deleting any pods for the replication controller to ensure they use the new configuration"");",678a8f06bef5b026f044eba73983363a64763e25,1,0
},678a8f06bef5b026f044eba73983363a64763e25,1,0
if (!isAllowCreate()) {,678a8f06bef5b026f044eba73983363a64763e25,1,0
public boolean isRollingUpgrade() {,678a8f06bef5b026f044eba73983363a64763e25,1,0
public void setRollingUpgrade(boolean rollingUpgrade) {,678a8f06bef5b026f044eba73983363a64763e25,1,0
this.rollingUpgrade = rollingUpgrade;,678a8f06bef5b026f044eba73983363a64763e25,1,0
ReplicationController old = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).get();,678a8f06bef5b026f044eba73983363a64763e25,1,1
if (isRunning(old)) {,678a8f06bef5b026f044eba73983363a64763e25,1,1
"if (UserConfigurationCompare.configEqual(replicationController, old)) {",678a8f06bef5b026f044eba73983363a64763e25,1,1
if (isRecreateMode()) {,678a8f06bef5b026f044eba73983363a64763e25,1,1
try {,678a8f06bef5b026f044eba73983363a64763e25,1,1
if (deletePodsOnReplicationControllerUpdate) {,678a8f06bef5b026f044eba73983363a64763e25,1,1
"LOG.info(""Deleting any pods for the replication controller to ensure they use the new configuration"");",678a8f06bef5b026f044eba73983363a64763e25,1,1
},678a8f06bef5b026f044eba73983363a64763e25,1,1
if (!isAllowCreate()) {,678a8f06bef5b026f044eba73983363a64763e25,1,1
private boolean rollingUpgradePreserveScale = true;,678a8f06bef5b026f044eba73983363a64763e25,1,0
ReplicationController old = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).get();,678a8f06bef5b026f044eba73983363a64763e25,1,0
if (isRunning(old)) {,678a8f06bef5b026f044eba73983363a64763e25,1,0
"if (UserConfigurationCompare.configEqual(replicationController, old)) {",678a8f06bef5b026f044eba73983363a64763e25,1,0
ReplicationControllerSpec newSpec = replicationController.getSpec();,678a8f06bef5b026f044eba73983363a64763e25,1,0
ReplicationControllerSpec oldSpec = old.getSpec();,678a8f06bef5b026f044eba73983363a64763e25,1,0
if (rollingUpgrade) {,678a8f06bef5b026f044eba73983363a64763e25,1,0
if (rollingUpgradePreserveScale && newSpec != null && oldSpec != null) {,678a8f06bef5b026f044eba73983363a64763e25,1,0
Integer replicas = oldSpec.getReplicas();,678a8f06bef5b026f044eba73983363a64763e25,1,0
if (replicas != null) {,678a8f06bef5b026f044eba73983363a64763e25,1,0
},678a8f06bef5b026f044eba73983363a64763e25,1,0
try {,678a8f06bef5b026f044eba73983363a64763e25,1,0
if (deletePodsOnReplicationControllerUpdate) {,678a8f06bef5b026f044eba73983363a64763e25,1,0
"LOG.info(""Deleting any pods for the replication controller to ensure they use the new configuration"");",678a8f06bef5b026f044eba73983363a64763e25,1,0
if (!isAllowCreate()) {,678a8f06bef5b026f044eba73983363a64763e25,1,0
public boolean isRollingUpgradePreserveScale() {,678a8f06bef5b026f044eba73983363a64763e25,1,0
public void setRollingUpgradePreserveScale(boolean rollingUpgradePreserveScale) {,678a8f06bef5b026f044eba73983363a64763e25,1,0
this.rollingUpgradePreserveScale = rollingUpgradePreserveScale;,678a8f06bef5b026f044eba73983363a64763e25,1,0
if (rollingUpgrade) {,678a8f06bef5b026f044eba73983363a64763e25,1,1
ReplicationController old = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).get();,678a8f06bef5b026f044eba73983363a64763e25,1,1
if (isRunning(old)) {,678a8f06bef5b026f044eba73983363a64763e25,1,1
"if (UserConfigurationCompare.configEqual(replicationController, old)) {",678a8f06bef5b026f044eba73983363a64763e25,1,1
if (isRecreateMode()) {,678a8f06bef5b026f044eba73983363a64763e25,1,1
try {,678a8f06bef5b026f044eba73983363a64763e25,1,1
if (deletePodsOnReplicationControllerUpdate) {,678a8f06bef5b026f044eba73983363a64763e25,1,1
"LOG.info(""Deleting any pods for the replication controller to ensure they use the new configuration"");",678a8f06bef5b026f044eba73983363a64763e25,1,1
},678a8f06bef5b026f044eba73983363a64763e25,1,1
if (!isAllowCreate()) {,678a8f06bef5b026f044eba73983363a64763e25,1,1
import com.fasterxml.jackson.core.JsonProcessingException;,678a8f06bef5b026f044eba73983363a64763e25,0,0
import io.fabric8.kubernetes.api.model.Service;,678a8f06bef5b026f044eba73983363a64763e25,0,0
import io.fabric8.openshift.api.model.Route;,678a8f06bef5b026f044eba73983363a64763e25,0,0
import io.fabric8.openshift.api.model.RouteList;,678a8f06bef5b026f044eba73983363a64763e25,0,0
import java.util.ArrayList;,678a8f06bef5b026f044eba73983363a64763e25,0,0
import java.util.List;,678a8f06bef5b026f044eba73983363a64763e25,0,0
/**,678a8f06bef5b026f044eba73983363a64763e25,0,0
*/,678a8f06bef5b026f044eba73983363a64763e25,0,0
private boolean createRoutes;,678a8f06bef5b026f044eba73983363a64763e25,0,0
private String routeDomain;,678a8f06bef5b026f044eba73983363a64763e25,0,0
"createRoutes(kubernetes, list);",678a8f06bef5b026f044eba73983363a64763e25,0,0
return;,678a8f06bef5b026f044eba73983363a64763e25,0,0
// lets get the routes first to see if we should bother,678a8f06bef5b026f044eba73983363a64763e25,0,0
route.setServiceName(id);,678a8f06bef5b026f044eba73983363a64763e25,0,0
routes.add(route);,678a8f06bef5b026f044eba73983363a64763e25,0,0
list.addAll(routes);,678a8f06bef5b026f044eba73983363a64763e25,0,0
import io.fabric8.kubernetes.api.model.KubernetesList;,678a8f06bef5b026f044eba73983363a64763e25,0,0
"applyList((KubernetesList) dto, sourceName);",678a8f06bef5b026f044eba73983363a64763e25,0,0
"applyEntity(entity, sourceName);",678a8f06bef5b026f044eba73983363a64763e25,0,0
import com.fasterxml.jackson.databind.JsonNode;,678a8f06bef5b026f044eba73983363a64763e25,0,1
import io.fabric8.utils.Objects;,678a8f06bef5b026f044eba73983363a64763e25,0,1
import java.io.IOException;,678a8f06bef5b026f044eba73983363a64763e25,0,1
import static io.fabric8.kubernetes.api.KubernetesFactory.createObjectMapper;,678a8f06bef5b026f044eba73983363a64763e25,0,1
"applyList(tree, sourceName);",678a8f06bef5b026f044eba73983363a64763e25,0,1
"applyTemplate(template, sourceName);",678a8f06bef5b026f044eba73983363a64763e25,0,1
// lets parse into a new object,678a8f06bef5b026f044eba73983363a64763e25,0,1
"LOG.debug(""Got item: {}"", json);",678a8f06bef5b026f044eba73983363a64763e25,0,1
"apply(dto, sourceName);",678a8f06bef5b026f044eba73983363a64763e25,0,1
/*,678a8f06bef5b026f044eba73983363a64763e25,0,1
kubernetes.createConfig(entity);,678a8f06bef5b026f044eba73983363a64763e25,0,1
*/,678a8f06bef5b026f044eba73983363a64763e25,0,1
import io.fabric8.openshift.api.model.template.Template;,678a8f06bef5b026f044eba73983363a64763e25,0,0
import org.apache.maven.plugin.logging.Log;,678a8f06bef5b026f044eba73983363a64763e25,0,0
import java.util.Set;,678a8f06bef5b026f044eba73983363a64763e25,0,0
objectRef.setName(id);,678a8f06bef5b026f044eba73983363a64763e25,0,0
objectRef.setNamespace(namespace);,678a8f06bef5b026f044eba73983363a64763e25,0,0
routeSpec.setTo(objectRef);,678a8f06bef5b026f044eba73983363a64763e25,0,0
route.setSpec(routeSpec);,678a8f06bef5b026f044eba73983363a64763e25,0,0
return route;,678a8f06bef5b026f044eba73983363a64763e25,0,0
/**,678a8f06bef5b026f044eba73983363a64763e25,0,0
*,678a8f06bef5b026f044eba73983363a64763e25,0,0
*/,678a8f06bef5b026f044eba73983363a64763e25,0,0
return false;,678a8f06bef5b026f044eba73983363a64763e25,0,0
return true;,678a8f06bef5b026f044eba73983363a64763e25,0,0
import io.fabric8.openshift.api.model.template.Template;,678a8f06bef5b026f044eba73983363a64763e25,0,1
/**,678a8f06bef5b026f044eba73983363a64763e25,0,1
* Should we update resources by deleting them first and then creating them again?,678a8f06bef5b026f044eba73983363a64763e25,0,1
*/,678a8f06bef5b026f044eba73983363a64763e25,0,1
private boolean recreate;,678a8f06bef5b026f044eba73983363a64763e25,0,1
private boolean failOnError;,678a8f06bef5b026f044eba73983363a64763e25,0,1
private String routeDomain;,678a8f06bef5b026f044eba73983363a64763e25,0,1
controller.setRecreateMode(recreate);,678a8f06bef5b026f044eba73983363a64763e25,0,1
controller.setThrowExceptionOnError(failOnError);,678a8f06bef5b026f044eba73983363a64763e25,0,1
objectRef.setName(id);,678a8f06bef5b026f044eba73983363a64763e25,0,1
objectRef.setNamespace(namespace);,678a8f06bef5b026f044eba73983363a64763e25,0,1
routeSpec.setTo(objectRef);,678a8f06bef5b026f044eba73983363a64763e25,0,1
route.setSpec(routeSpec);,678a8f06bef5b026f044eba73983363a64763e25,0,1
return kubernetes;,678a8f06bef5b026f044eba73983363a64763e25,0,1
private boolean rollingUpgrade;,678a8f06bef5b026f044eba73983363a64763e25,0,0
kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).rolling().replace(replicationController);,678a8f06bef5b026f044eba73983363a64763e25,0,0
"LOG.info(""ReplicationController hasn't changed so not doing anything"");",678a8f06bef5b026f044eba73983363a64763e25,0,0
kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).delete();,678a8f06bef5b026f044eba73983363a64763e25,0,0
"doCreateReplicationController(replicationController, namespace, sourceName);",678a8f06bef5b026f044eba73983363a64763e25,0,0
"logGeneratedEntity(""Updated replicationController: "", namespace, replicationController, answer);",678a8f06bef5b026f044eba73983363a64763e25,0,0
kubernetesClient.pods().inNamespace(namespace).withLabels(replicationController.getSpec().getSelector()).delete();,678a8f06bef5b026f044eba73983363a64763e25,0,0
"LOG.info(""Warning not deleted any pods so they could well be running with the old configuration!"");",678a8f06bef5b026f044eba73983363a64763e25,0,0
return rollingUpgrade;,678a8f06bef5b026f044eba73983363a64763e25,0,0
"LOG.info(""ReplicationController hasn't changed so not doing anything"");",678a8f06bef5b026f044eba73983363a64763e25,0,1
kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).delete();,678a8f06bef5b026f044eba73983363a64763e25,0,1
"doCreateReplicationController(replicationController, namespace, sourceName);",678a8f06bef5b026f044eba73983363a64763e25,0,1
"logGeneratedEntity(""Updated replicationController: "", namespace, replicationController, answer);",678a8f06bef5b026f044eba73983363a64763e25,0,1
kubernetesClient.pods().inNamespace(namespace).withLabels(replicationController.getSpec().getSelector()).delete();,678a8f06bef5b026f044eba73983363a64763e25,0,1
"LOG.info(""Warning not deleted any pods so they could well be running with the old configuration!"");",678a8f06bef5b026f044eba73983363a64763e25,0,1
"LOG.info(""ReplicationController hasn't changed so not doing anything"");",678a8f06bef5b026f044eba73983363a64763e25,0,0
// lets preserve the number of replicas currently running in the environment we are about to upgrade,678a8f06bef5b026f044eba73983363a64763e25,0,0
newSpec.setReplicas(replicas);,678a8f06bef5b026f044eba73983363a64763e25,0,0
kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).rolling().replace(replicationController);,678a8f06bef5b026f044eba73983363a64763e25,0,0
kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).delete();,678a8f06bef5b026f044eba73983363a64763e25,0,0
"doCreateReplicationController(replicationController, namespace, sourceName);",678a8f06bef5b026f044eba73983363a64763e25,0,0
"logGeneratedEntity(""Updated replicationController: "", namespace, replicationController, answer);",678a8f06bef5b026f044eba73983363a64763e25,0,0
kubernetesClient.pods().inNamespace(namespace).withLabels(newSpec.getSelector()).delete();,678a8f06bef5b026f044eba73983363a64763e25,0,0
"LOG.info(""Warning not deleted any pods so they could well be running with the old configuration!"");",678a8f06bef5b026f044eba73983363a64763e25,0,0
return rollingUpgradePreserveScale;,678a8f06bef5b026f044eba73983363a64763e25,0,0
import io.fabric8.kubernetes.api.model.Doneable;,678a8f06bef5b026f044eba73983363a64763e25,0,1
import io.fabric8.kubernetes.api.model.DoneablePersistentVolumeClaim;,678a8f06bef5b026f044eba73983363a64763e25,0,1
import io.fabric8.kubernetes.api.model.KubernetesResourceList;,678a8f06bef5b026f044eba73983363a64763e25,0,1
import io.fabric8.kubernetes.api.model.PersistentVolumeClaimList;,678a8f06bef5b026f044eba73983363a64763e25,0,1
import io.fabric8.kubernetes.api.model.SecurityContextConstraints;,678a8f06bef5b026f044eba73983363a64763e25,0,1
kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).rolling().replace(replicationController);,678a8f06bef5b026f044eba73983363a64763e25,0,1
"LOG.info(""ReplicationController hasn't changed so not doing anything"");",678a8f06bef5b026f044eba73983363a64763e25,0,1
kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).delete();,678a8f06bef5b026f044eba73983363a64763e25,0,1
"doCreateReplicationController(replicationController, namespace, sourceName);",678a8f06bef5b026f044eba73983363a64763e25,0,1
"logGeneratedEntity(""Updated replicationController: "", namespace, replicationController, answer);",678a8f06bef5b026f044eba73983363a64763e25,0,1
kubernetesClient.pods().inNamespace(namespace).withLabels(replicationController.getSpec().getSelector()).delete();,678a8f06bef5b026f044eba73983363a64763e25,0,1
"LOG.info(""Warning not deleted any pods so they could well be running with the old configuration!"");",678a8f06bef5b026f044eba73983363a64763e25,0,1
"System.out.println(""Found kubernetes dependency: "" + artifact + "" with file: "" + file);",5c4468b0ca12b87616a60d6aff4d1d97456b2a61,8,1
"System.out.println(""resolved kubernetes dependency: "" + artifact + "" with file: "" + file);",5c4468b0ca12b87616a60d6aff4d1d97456b2a61,8,1
"getLog().debug(""Found existing ("" + repo.getId() + "") remote repository: "" + repo.getUrl());",5c4468b0ca12b87616a60d6aff4d1d97456b2a61,5,1
"System.out.println(""Found kubernetes JSON dependency: "" + artifact);",5c4468b0ca12b87616a60d6aff4d1d97456b2a61,3,0
"System.out.println(""Resolved kubernetes JSON dependency: "" + artifact);",5c4468b0ca12b87616a60d6aff4d1d97456b2a61,3,0
} else if (generateJson) {,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,3,1
"throw new MojoExecutionException(""Could not find any dependent kubernetes json files!"");",5c4468b0ca12b87616a60d6aff4d1d97456b2a61,2,1
} else {,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,2,0
"getLog().warn(""No object found for file: "" + file);",5c4468b0ca12b87616a60d6aff4d1d97456b2a61,2,0
"Object combinedJson = KubernetesHelper.combineJson(generated, extra);",5c4468b0ca12b87616a60d6aff4d1d97456b2a61,2,0
Object combinedJson = null;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,2,1
if (remoteRepositories != null) {,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,2,1
if (obj instanceof ArtifactRepository) {,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,2,1
"if (repo.getUrl().contains(""repository.jboss.org/nexus/content/groups/fs-public"")) {",5c4468b0ca12b87616a60d6aff4d1d97456b2a61,2,1
if (!found) {,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,2,1
if (remoteRepositories == null) {,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,2,1
if (generateJson) {,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,2,0
if (combineDependencies) {,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,2,0
if (kubernetesExtraJson != null && kubernetesExtraJson.exists()) {,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,2,0
if (combineDependencies) {,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,2,1
if (kubernetesExtraJson != null && kubernetesExtraJson.exists()) {,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,2,1
Set<File> jsonFiles = new LinkedHashSet<>();,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,1,0
List<Object> jsonObjectList = new ArrayList<>();,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,1,0
for (File file : jsonFiles) {,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,1,0
},5c4468b0ca12b87616a60d6aff4d1d97456b2a61,1,0
"throw new MojoExecutionException(""Could not find any dependent kubernetes JSON files!"");",5c4468b0ca12b87616a60d6aff4d1d97456b2a61,1,0
List<Object> jsonObjectList = new ArrayList<>();,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,1,1
"JsonNode combinedJson = KubernetesHelper.combineJson(generated, extra);",5c4468b0ca12b87616a60d6aff4d1d97456b2a61,1,1
"private static final String GENERATE = ""generate"";",5c4468b0ca12b87616a60d6aff4d1d97456b2a61,1,0
Object combinedJson;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,1,0
"String generate = properties.getProperty(String.format(PARAMETER_PROPERTY, name, GENERATE));",5c4468b0ca12b87616a60d6aff4d1d97456b2a61,1,0
"private static final String GENEATE = ""generate"";",5c4468b0ca12b87616a60d6aff4d1d97456b2a61,1,1
"String generate = properties.getProperty(String.format(PARAMETER_PROPERTY, name, GENEATE));",5c4468b0ca12b87616a60d6aff4d1d97456b2a61,1,1
private void addNeededRemoteRepository() {,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,1,1
boolean found = false;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,1,1
for (Object obj : remoteRepositories) {,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,1,1
ArtifactRepository repo = (ArtifactRepository) obj;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,1,1
found = true;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,1,1
},5c4468b0ca12b87616a60d6aff4d1d97456b2a61,1,1
ArtifactRepository fsPublic = new MavenArtifactRepository();,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,1,1
remoteRepositories = new ArrayList();,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,1,1
},5c4468b0ca12b87616a60d6aff4d1d97456b2a61,1,0
},5c4468b0ca12b87616a60d6aff4d1d97456b2a61,1,1
import java.util.LinkedHashSet;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,0
jsonFiles.add(file);,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,0
"addKubernetesJsonFileToList(jsonObjectList, file);",5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,0
"addKubernetesJsonFileToList(jsonObjectList, file);",5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
import com.fasterxml.jackson.databind.JsonNode;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
import java.io.File;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,0
import java.io.FileInputStream;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,0
import java.io.IOException;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,0
import java.nio.charset.Charset;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,0
import java.util.ArrayList;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,0
import java.util.HashMap;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,0
import java.util.HashSet;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,0
import java.util.LinkedHashSet;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,0
import java.util.List;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,0
import java.util.Map;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,0
import java.util.Properties;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,0
import java.util.Set;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,0
import java.util.TreeMap;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,0
import java.util.regex.Matcher;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,0
import java.util.regex.Pattern;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,0
import java.io.File;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
import java.io.FileInputStream;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
import java.io.IOException;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
import java.nio.charset.Charset;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
import java.util.ArrayList;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
import java.util.HashMap;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
import java.util.HashSet;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
import java.util.LinkedHashSet;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
import java.util.List;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
import java.util.Map;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
import java.util.Properties;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
import java.util.Set;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
import java.util.TreeMap;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
import java.util.regex.Matcher;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
import java.util.regex.Pattern;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
import org.apache.maven.artifact.repository.ArtifactRepositoryPolicy;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
import org.apache.maven.artifact.repository.MavenArtifactRepository;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
import org.apache.maven.artifact.repository.layout.DefaultRepositoryLayout;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
addNeededRemoteRepository();,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
"@SuppressWarnings(""unchecked"")",5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
// TODO: Remove this code when we use releases from Maven Central,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
// included jboss-fs repo which is required until we use an Apache version of Karaf,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
break;,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
"fsPublic.setUrl(""http://repository.jboss.org/"");",5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
fsPublic.setLayout(new DefaultRepositoryLayout());,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
"fsPublic.setReleaseUpdatePolicy(new ArtifactRepositoryPolicy(true, ""never"", ""warn""));",5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
"fsPublic.setSnapshotUpdatePolicy(new ArtifactRepositoryPolicy(false, ""never"", ""ignore""));",5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
remoteRepositories.add(fsPublic);,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
generateKubernetesJson(json);,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,0
combineDependentJsonFiles(json);,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,0
"combineJsonFiles(json, kubernetesExtraJson);",5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,0
"addKubernetesJsonFileToList(jsonObjectList, json);",5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,0
combineDependentJsonFiles(json);,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
generateKubernetesJson(json);,5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
"combineJsonFiles(json, kubernetesExtraJson);",5c4468b0ca12b87616a60d6aff4d1d97456b2a61,0,1
"return ""selector: "" + entity.getSelector() + "" ports: "" + portText;",79cba8301fef86f355b87c794ca860f314a739f0,7,0
"log.debug(""Service "" + id + "" has ports: "" + ports);",79cba8301fef86f355b87c794ca860f314a739f0,7,0
} else if (entity instanceof KubernetesList) {,79cba8301fef86f355b87c794ca860f314a739f0,6,0
} else if (entity instanceof HasMetadata[]) {,79cba8301fef86f355b87c794ca860f314a739f0,6,0
} else if (entity instanceof Object[]) {,79cba8301fef86f355b87c794ca860f314a739f0,6,1
"LOG.debug(""Ignoring Service: "" + namespace + "":"" + id);",79cba8301fef86f355b87c794ca860f314a739f0,5,0
} else if (object instanceof ReplicationController) {,79cba8301fef86f355b87c794ca860f314a739f0,5,0
} else if (object instanceof Service) {,79cba8301fef86f355b87c794ca860f314a739f0,5,0
} else if (object instanceof Route) {,79cba8301fef86f355b87c794ca860f314a739f0,5,0
} if (entity instanceof List) {,79cba8301fef86f355b87c794ca860f314a739f0,5,0
} else if (object instanceof Pod) {,79cba8301fef86f355b87c794ca860f314a739f0,5,0
} else if (object instanceof Collection) {,79cba8301fef86f355b87c794ca860f314a739f0,5,0
} if (entity instanceof List) {,79cba8301fef86f355b87c794ca860f314a739f0,5,1
"json = e.getMessage() + "". object: "" + route;",79cba8301fef86f355b87c794ca860f314a739f0,5,0
"json = e.getMessage() + "". object: "" + route;",79cba8301fef86f355b87c794ca860f314a739f0,5,1
} else if (object instanceof ReplicationController) {,79cba8301fef86f355b87c794ca860f314a739f0,5,1
} else if (object instanceof Service) {,79cba8301fef86f355b87c794ca860f314a739f0,5,1
} else if (object instanceof Route) {,79cba8301fef86f355b87c794ca860f314a739f0,5,1
if (entity instanceof JsonNode) {,79cba8301fef86f355b87c794ca860f314a739f0,4,0
if (entity instanceof List) {,79cba8301fef86f355b87c794ca860f314a739f0,4,1
if (entity instanceof List) {,79cba8301fef86f355b87c794ca860f314a739f0,4,0
"String key = kind + "":"" + id;",79cba8301fef86f355b87c794ca860f314a739f0,4,0
if (entity instanceof JsonNode) {,79cba8301fef86f355b87c794ca860f314a739f0,4,1
"protected static Object loadEntity(byte[] json, String kind, Object defaultValue) throws IOException {",79cba8301fef86f355b87c794ca860f314a739f0,4,1
"} else if (Objects.equal(""ReplicationController"", kind)) {",79cba8301fef86f355b87c794ca860f314a739f0,4,1
"} else if (Objects.equal(""Service"", kind)) {",79cba8301fef86f355b87c794ca860f314a739f0,4,1
"} else if (Objects.equal(""BuildConfig"", kind)) {",79cba8301fef86f355b87c794ca860f314a739f0,4,1
"} else if (Objects.equal(""DeploymentConfig"", kind)) {",79cba8301fef86f355b87c794ca860f314a739f0,4,1
"} else if (Objects.equal(""ImageRepository"", kind)) {",79cba8301fef86f355b87c794ca860f314a739f0,4,1
"} else if (Objects.equal(""Template"", kind)) {",79cba8301fef86f355b87c794ca860f314a739f0,4,1
"} else if (Objects.equal(""Config"", kind) || Objects.equal(""List"", kind)) {",79cba8301fef86f355b87c794ca860f314a739f0,4,1
"throw new IllegalArgumentException(""config "" + config + "" is not a ObjectNode"");",79cba8301fef86f355b87c794ca860f314a739f0,4,1
"throw new IllegalArgumentException(""config "" + template + "" is not a ObjectNode"");",79cba8301fef86f355b87c794ca860f314a739f0,4,1
"String key = kind + "":"" + id;",79cba8301fef86f355b87c794ca860f314a739f0,4,1
} else if (object == null) {,79cba8301fef86f355b87c794ca860f314a739f0,4,1
"public static void setName(HasMetadata entity, String namespace, String name) {",79cba8301fef86f355b87c794ca860f314a739f0,4,0
"public static void setNamespace(HasMetadata entity, String namespace) {",79cba8301fef86f355b87c794ca860f314a739f0,4,0
if (entity instanceof HasMetadata) {,79cba8301fef86f355b87c794ca860f314a739f0,4,0
"public static void setName(Route entity, String namespace, String name) {",79cba8301fef86f355b87c794ca860f314a739f0,4,1
"public static void setNamespace(Template entity, String namespace) {",79cba8301fef86f355b87c794ca860f314a739f0,4,1
String id = getId(service);,79cba8301fef86f355b87c794ca860f314a739f0,3,0
String id = getId(service);,79cba8301fef86f355b87c794ca860f314a739f0,3,1
if (object instanceof Pod) {,79cba8301fef86f355b87c794ca860f314a739f0,3,0
} else  {,79cba8301fef86f355b87c794ca860f314a739f0,3,0
if (object instanceof Route) {,79cba8301fef86f355b87c794ca860f314a739f0,3,0
"return ""host: "" + entity.getHost();",79cba8301fef86f355b87c794ca860f314a739f0,3,0
if (item instanceof Service) {,79cba8301fef86f355b87c794ca860f314a739f0,3,0
} else {,79cba8301fef86f355b87c794ca860f314a739f0,3,0
String id = getObjectId(item);,79cba8301fef86f355b87c794ca860f314a739f0,3,0
if (object instanceof KubernetesList) {,79cba8301fef86f355b87c794ca860f314a739f0,3,0
if (entity != null) {,79cba8301fef86f355b87c794ca860f314a739f0,3,1
} else {,79cba8301fef86f355b87c794ca860f314a739f0,3,1
String json = toJson(item);,79cba8301fef86f355b87c794ca860f314a739f0,3,1
"Object entity = loadEntity(bytes, kind, null);",79cba8301fef86f355b87c794ca860f314a739f0,3,1
if (items instanceof ArrayNode) {,79cba8301fef86f355b87c794ca860f314a739f0,3,1
if (config instanceof ObjectNode) {,79cba8301fef86f355b87c794ca860f314a739f0,3,1
if (template instanceof ObjectNode) {,79cba8301fef86f355b87c794ca860f314a739f0,3,1
String id = getId(jsonNode);,79cba8301fef86f355b87c794ca860f314a739f0,3,1
if (object instanceof JsonNode) {,79cba8301fef86f355b87c794ca860f314a739f0,3,1
String json = toJson(object);,79cba8301fef86f355b87c794ca860f314a739f0,3,1
"Route route = createRouteForService(routeDomainPostfix, namespace, service, log);",79cba8301fef86f355b87c794ca860f314a739f0,3,0
"public static Route createRouteForService(String routeDomainPostfix, String namespace, Service service, Log log) {",79cba8301fef86f355b87c794ca860f314a739f0,3,0
Route route = null;,79cba8301fef86f355b87c794ca860f314a739f0,3,0
String id = KubernetesHelper.getName(service);,79cba8301fef86f355b87c794ca860f314a739f0,3,0
String json = null;,79cba8301fef86f355b87c794ca860f314a739f0,3,0
* @returns true if we should create an OpenShift Route for this service.,79cba8301fef86f355b87c794ca860f314a739f0,3,0
String id = KubernetesHelper.getName(service);,79cba8301fef86f355b87c794ca860f314a739f0,3,1
Route route = new Route();,79cba8301fef86f355b87c794ca860f314a739f0,3,1
String json = null;,79cba8301fef86f355b87c794ca860f314a739f0,3,1
if (object instanceof HasMetadata) {,79cba8301fef86f355b87c794ca860f314a739f0,3,0
if (entity != null) {,79cba8301fef86f355b87c794ca860f314a739f0,3,0
* Returns true if this entity has a valid non blank resourceVersion in its metadata,79cba8301fef86f355b87c794ca860f314a739f0,3,0
"public static void setName(HasMetadata entity, String name) {",79cba8301fef86f355b87c794ca860f314a739f0,3,0
if (object instanceof Pod) {,79cba8301fef86f355b87c794ca860f314a739f0,3,1
if (entity != null) {,79cba8301fef86f355b87c794ca860f314a739f0,3,1
} else {,79cba8301fef86f355b87c794ca860f314a739f0,3,1
"public static void setName(Pod entity, String name) {",79cba8301fef86f355b87c794ca860f314a739f0,3,1
"public static void setName(Service entity, String name) {",79cba8301fef86f355b87c794ca860f314a739f0,3,1
"public static void setName(ReplicationController entity, String name) {",79cba8301fef86f355b87c794ca860f314a739f0,3,1
"public static void setName(Template entity, String name) {",79cba8301fef86f355b87c794ca860f314a739f0,3,1
"protected static Object getAdditionalProperty(Map<String, Object> additionalProperties, String name) {",79cba8301fef86f355b87c794ca860f314a739f0,3,1
} else {,79cba8301fef86f355b87c794ca860f314a739f0,3,0
"throw new MojoFailureException(""Cannot load kubernetes json: "" + json);",79cba8301fef86f355b87c794ca860f314a739f0,3,0
* @return true if we should create an OpenShift Route for this service.,79cba8301fef86f355b87c794ca860f314a739f0,3,0
"throw new MojoFailureException(""Could not load kubernetes json: "" + json);",79cba8301fef86f355b87c794ca860f314a739f0,3,1
String json = null;,79cba8301fef86f355b87c794ca860f314a739f0,3,1
* @returns true if we should create an OpenShift Route for this service.,79cba8301fef86f355b87c794ca860f314a739f0,3,1
if (isIgnoreServiceMode()) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (isRecreateMode()) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (isUpdateViaDeleteAndCreate()) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
public static String getObjectId(Object object) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
return object != null ? object.toString() : null;,79cba8301fef86f355b87c794ca860f314a739f0,2,0
JsonNode jsonNode = (JsonNode) entity;,79cba8301fef86f355b87c794ca860f314a739f0,2,0
public static String summaryText(Object object) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
public static String summaryText(Route entity) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
public static String summaryText(Service entity) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (ports != null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (number != null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (portText.length() > 0) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (portText.length() == 0) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (port != null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
public static String summaryText(ReplicationController entity) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (desiredState != null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
"buffer.append(""replicas: "" + desiredState.getReplicas());",79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (podTemplate != null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
public static String summaryText(Pod entity) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (podState != null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (manifest != null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (containers != null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
String image = container.getImage();,79cba8301fef86f355b87c794ca860f314a739f0,2,0
"appendText(buffer, ""image: "" + image);",79cba8301fef86f355b87c794ca860f314a739f0,2,0
"protected static void appendText(StringBuilder buffer, String text) {",79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (buffer.length() > 0) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
KubernetesList config = (KubernetesList) entity;,79cba8301fef86f355b87c794ca860f314a739f0,2,0
public static Object combineJson(Object... objects) throws IOException {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
KubernetesList list = findOrCreateList(objects);,79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (items == null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (object != list) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
Object item = list.get(i);,79cba8301fef86f355b87c794ca860f314a739f0,2,0
Object nonService = list.get(lastNonService);,79cba8301fef86f355b87c794ca860f314a739f0,2,0
Object item = itemArray.get(i);,79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (item == null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
String kind = item.getClass().getSimpleName();,79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (Strings.isNotBlank(id)) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (!keys.add(key)) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
"protected static void addObjectsToItemArray(List destinationList, Object object) throws IOException {",79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (items != null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
KubernetesList list = null;,79cba8301fef86f355b87c794ca860f314a739f0,2,0
list = (KubernetesList) object;,79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (list == null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
list = new KubernetesList();,79cba8301fef86f355b87c794ca860f314a739f0,2,0
public static String getId(JsonNode entity) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
public static String getKind(JsonNode entity) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
"protected static String getJsonTextProperty(JsonNode node, String... names) {",79cba8301fef86f355b87c794ca860f314a739f0,2,1
for (String name : names) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
if (current == null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
if (tree != null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
if (kindNode != null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
String kind = kindNode.asText();,79cba8301fef86f355b87c794ca860f314a739f0,2,1
"LOG.warn(""No JSON type for: "" + tree);",79cba8301fef86f355b87c794ca860f314a739f0,2,1
JsonNode jsonNode = (JsonNode) entity;,79cba8301fef86f355b87c794ca860f314a739f0,2,1
"if (Objects.equal(""Pod"", kind)) {",79cba8301fef86f355b87c794ca860f314a739f0,2,1
if (item != null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
if (kindObject != null && kindObject.isTextual()) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
String kind = kindObject.asText();,79cba8301fef86f355b87c794ca860f314a739f0,2,1
public static Object getEntity(JsonNode item) throws IOException {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
if (kind != null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
return entity;,79cba8301fef86f355b87c794ca860f314a739f0,2,1
if (object != config) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
if (isTemplate(jsonNode)) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
if (template == null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
if (template != null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
if (!isTemplate(jsonNode)) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
if (isService(jsonNode)) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
"String kind = Strings.defaultIfEmpty(getKind(jsonNode), """");",79cba8301fef86f355b87c794ca860f314a739f0,2,1
if (Strings.isNotBlank(id)) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
if (!keys.add(key)) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
if (jsonNode != null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
"protected static void addObjectsToItemArray(ArrayNode itemArray, Object object) throws IOException {",79cba8301fef86f355b87c794ca860f314a739f0,2,1
if (items != null && items.isArray()) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
// lets create a new list,79cba8301fef86f355b87c794ca860f314a739f0,2,1
String routeDomainPostfix = this.routeDomain;,79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (Strings.isNullOrBlank(routeDomainPostfix)) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
"log.warn(""Could not load routes; we maybe are not connected to an OpenShift environment? "" + e, e);",79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (route != null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
"if (Strings.isNotBlank(id) && shouldCreateRouteForService(log, service, id)) {",79cba8301fef86f355b87c794ca860f314a739f0,2,0
route = new Route();,79cba8301fef86f355b87c794ca860f314a739f0,2,0
"KubernetesHelper.setName(route, namespace, id + ""-route"");",79cba8301fef86f355b87c794ca860f314a739f0,2,0
"String host = Strings.stripSuffix(Strings.stripSuffix(id, ""-service""), ""."");",79cba8301fef86f355b87c794ca860f314a739f0,2,0
"routeSpec.setHost(host + ""."" + Strings.stripPrefix(routeDomainPostfix, "".""));",79cba8301fef86f355b87c794ca860f314a739f0,2,0
json = KubernetesHelper.toJson(route);,79cba8301fef86f355b87c794ca860f314a739f0,2,0
} catch (JsonProcessingException e) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
"log.debug(""Created route: "" + json);",79cba8301fef86f355b87c794ca860f314a739f0,2,0
* Should we try to create a route for the given service?,79cba8301fef86f355b87c794ca860f314a739f0,2,0
"protected static boolean shouldCreateRouteForService(Log log, Service service, String id) {",79cba8301fef86f355b87c794ca860f314a739f0,2,0
"if (""kubernetes"".equals(id) || ""kubernetes-ro"".equals(id)) {",79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (!ports.contains(80) && !ports.contains(443)) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
* Should we fail the build if an apply fails?,79cba8301fef86f355b87c794ca860f314a739f0,2,1
"@Parameter(property = ""fabric8.apply.failOnError"", defaultValue = ""true"")",79cba8301fef86f355b87c794ca860f314a739f0,2,1
"@Parameter(property = ""fabric8.apply.domain"", defaultValue = ""${env.KUBERNETES_DOMAIN}"")",79cba8301fef86f355b87c794ca860f314a739f0,2,1
private KubernetesClient kubernetes = new KubernetesClient();,79cba8301fef86f355b87c794ca860f314a739f0,2,1
if (Strings.isNullOrBlank(routeDomain)) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
"getLog().warn(""Could not load routes; we maybe are not connected to an OpenShift environment? "" + e, e);",79cba8301fef86f355b87c794ca860f314a739f0,2,1
if (Strings.isNotBlank(id)) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
"KubernetesHelper.setName(route, namespace, id + ""-route"");",79cba8301fef86f355b87c794ca860f314a739f0,2,1
"String host = Strings.stripSuffix(Strings.stripSuffix(id, ""-service""), ""."");",79cba8301fef86f355b87c794ca860f314a739f0,2,1
"routeSpec.setHost(host + ""."" + Strings.stripPrefix(routeDomain, "".""));",79cba8301fef86f355b87c794ca860f314a739f0,2,1
json = KubernetesHelper.toJson(route);,79cba8301fef86f355b87c794ca860f314a739f0,2,1
} catch (JsonProcessingException e) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
"getLog().debug(""Created route: "" + json);",79cba8301fef86f355b87c794ca860f314a739f0,2,1
if (Strings.isNotBlank(namespace)) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
* Returns the resource version for the entity or null if it does not have one,79cba8301fef86f355b87c794ca860f314a739f0,2,0
public static String getResourceVersion(HasMetadata entity) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
ObjectMeta metadata = entity.getMetadata();,79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (metadata != null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
String resourceVersion = metadata.getResourceVersion();,79cba8301fef86f355b87c794ca860f314a739f0,2,0
if (Strings.isNotBlank(resourceVersion)) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
public static String getName(HasMetadata entity) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
ObjectMeta metadata = getOrCreateMetadata(entity);,79cba8301fef86f355b87c794ca860f314a739f0,2,0
public static String getNamespace(HasMetadata entity) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
return (List<HasMetadata>) entity;,79cba8301fef86f355b87c794ca860f314a739f0,2,0
HasMetadata[] array = (HasMetadata[]) entity;,79cba8301fef86f355b87c794ca860f314a739f0,2,0
List<HasMetadata> answer = new ArrayList<>();,79cba8301fef86f355b87c794ca860f314a739f0,2,0
ObjectMeta metadata = entity.getMetadata();,79cba8301fef86f355b87c794ca860f314a739f0,2,1
if (metadata == null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
metadata = new ObjectMeta();,79cba8301fef86f355b87c794ca860f314a739f0,2,1
public static String getName(Pod entity) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
public static String getName(ReplicationController entity) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
public static String getName(Service entity) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
public static String getName(OAuthClient entity) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
public static String getName(Route entity) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
public static String getName(Node entity) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
public static String getName(Template entity) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
public static String getName(ImageStream entity) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
public static String getName(Endpoints entity) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
public static String getNamespace(Pod entity) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
public static String getNamespace(ReplicationController entity) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
public static String getNamespace(Service entity) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
public static String getNamespace(OAuthClient entity) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
public static String getNamespace(Route entity) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
public static String getNamespace(Template entity) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
if (additionalProperties != null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
"protected static String getAdditionalNestedPropertyText(Map<String, Object> additionalProperties, String... names) {",79cba8301fef86f355b87c794ca860f314a739f0,2,1
for (int i = 0; i < lastIdx; i++) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
if (map == null) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
return (List<Object>) entity;,79cba8301fef86f355b87c794ca860f314a739f0,2,1
Object[] array = (Object[]) entity;,79cba8301fef86f355b87c794ca860f314a739f0,2,1
List<Object> answer = new ArrayList<>();,79cba8301fef86f355b87c794ca860f314a739f0,2,1
Object item = list.get(i);,79cba8301fef86f355b87c794ca860f314a739f0,2,1
Object nonService = list.get(lastNonService);,79cba8301fef86f355b87c794ca860f314a739f0,2,1
Object item = itemArray.get(i);,79cba8301fef86f355b87c794ca860f314a739f0,2,1
List<HasMetadata> list = KubernetesHelper.toItemList(dto);,79cba8301fef86f355b87c794ca860f314a739f0,2,0
List<Object> list = KubernetesHelper.toItemList(dto);,79cba8301fef86f355b87c794ca860f314a739f0,2,1
String routeId = id;,79cba8301fef86f355b87c794ca860f314a739f0,2,0
"KubernetesHelper.setName(route, namespace, id + ""-route"");",79cba8301fef86f355b87c794ca860f314a739f0,2,1
if (openShift) {,79cba8301fef86f355b87c794ca860f314a739f0,2,0
"log.warn(""Cannot load OpenShift Routes; maybe not connected to an OpenShift platform? "" + e, e);",79cba8301fef86f355b87c794ca860f314a739f0,2,0
"log.debug(""Loading file "" + file);",79cba8301fef86f355b87c794ca860f314a739f0,2,0
"getLog().info(""Is OpenShift: "" + openShift);",79cba8301fef86f355b87c794ca860f314a739f0,2,1
if (!openShift) {,79cba8301fef86f355b87c794ca860f314a739f0,2,1
"log.warn(""Could not load routes; we maybe are not connected to an OpenShift environment? "" + e, e);",79cba8301fef86f355b87c794ca860f314a739f0,2,1
"log.info(""Loading file "" + file);",79cba8301fef86f355b87c794ca860f314a739f0,2,1
},79cba8301fef86f355b87c794ca860f314a739f0,1,0
public boolean isRecreateMode() {,79cba8301fef86f355b87c794ca860f314a739f0,1,0
return recreateMode;,79cba8301fef86f355b87c794ca860f314a739f0,1,0
public void setRecreateMode(boolean recreateMode) {,79cba8301fef86f355b87c794ca860f314a739f0,1,0
this.recreateMode = recreateMode;,79cba8301fef86f355b87c794ca860f314a739f0,1,0
* If enabled then all services are ignored to avoid them being recreated. This is useful if you want to,79cba8301fef86f355b87c794ca860f314a739f0,1,0
public boolean isIgnoreServiceMode() {,79cba8301fef86f355b87c794ca860f314a739f0,1,0
return ignoreServiceMode;,79cba8301fef86f355b87c794ca860f314a739f0,1,0
public void setIgnoreServiceMode(boolean ignoreServiceMode) {,79cba8301fef86f355b87c794ca860f314a739f0,1,0
this.ignoreServiceMode = ignoreServiceMode;,79cba8301fef86f355b87c794ca860f314a739f0,1,0
import javax.ws.rs.WebApplicationException;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
public boolean isUpdateViaDeleteAndCreate() {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
return updateViaDeleteAndCreate;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
public void setUpdateViaDeleteAndCreate(boolean updateViaDeleteAndCreate) {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
this.updateViaDeleteAndCreate = updateViaDeleteAndCreate;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
import io.fabric8.kubernetes.api.model.ServicePort;,79cba8301fef86f355b87c794ca860f314a739f0,1,0
* Returns the ID of the given object,79cba8301fef86f355b87c794ca860f314a739f0,1,0
return getId((Pod) object);,79cba8301fef86f355b87c794ca860f314a739f0,1,0
return getId((ReplicationController) object);,79cba8301fef86f355b87c794ca860f314a739f0,1,0
return getId((Service) object);,79cba8301fef86f355b87c794ca860f314a739f0,1,0
return getId((Route) object);,79cba8301fef86f355b87c794ca860f314a739f0,1,0
},79cba8301fef86f355b87c794ca860f314a739f0,1,0
public static List<Object> toItemList(Object entity) throws IOException {,79cba8301fef86f355b87c794ca860f314a739f0,1,0
return toItemList(getEntity(jsonNode));,79cba8301fef86f355b87c794ca860f314a739f0,1,0
* Returns a short summary text message for the given kubernetes resource,79cba8301fef86f355b87c794ca860f314a739f0,1,0
return summaryText((Route) object);,79cba8301fef86f355b87c794ca860f314a739f0,1,0
return summaryText((Service) object);,79cba8301fef86f355b87c794ca860f314a739f0,1,0
return summaryText((ReplicationController) object);,79cba8301fef86f355b87c794ca860f314a739f0,1,0
return summaryText((Pod) object);,79cba8301fef86f355b87c794ca860f314a739f0,1,0
"return """";",79cba8301fef86f355b87c794ca860f314a739f0,1,0
StringBuilder portText = new StringBuilder();,79cba8301fef86f355b87c794ca860f314a739f0,1,0
List<ServicePort> ports = entity.getPorts();,79cba8301fef86f355b87c794ca860f314a739f0,1,0
for (ServicePort port : ports) {,79cba8301fef86f355b87c794ca860f314a739f0,1,0
Integer number = port.getPort();,79cba8301fef86f355b87c794ca860f314a739f0,1,0
"portText.append("""" + number);",79cba8301fef86f355b87c794ca860f314a739f0,1,0
Integer port = entity.getPort();,79cba8301fef86f355b87c794ca860f314a739f0,1,0
"portText.append("""" + port);",79cba8301fef86f355b87c794ca860f314a739f0,1,0
StringBuilder buffer = new StringBuilder();,79cba8301fef86f355b87c794ca860f314a739f0,1,0
ReplicationControllerState desiredState = entity.getDesiredState();,79cba8301fef86f355b87c794ca860f314a739f0,1,0
PodTemplate podTemplate = desiredState.getPodTemplate();,79cba8301fef86f355b87c794ca860f314a739f0,1,0
PodState podState = podTemplate.getDesiredState();,79cba8301fef86f355b87c794ca860f314a739f0,1,0
return buffer.toString();,79cba8301fef86f355b87c794ca860f314a739f0,1,0
PodState podState = entity.getDesiredState();,79cba8301fef86f355b87c794ca860f314a739f0,1,0
"protected static void appendSummaryText(StringBuilder buffer, PodState podState) {",79cba8301fef86f355b87c794ca860f314a739f0,1,0
ContainerManifest manifest = podState.getManifest();,79cba8301fef86f355b87c794ca860f314a739f0,1,0
List<Container> containers = manifest.getContainers();,79cba8301fef86f355b87c794ca860f314a739f0,1,0
for (Container container : containers) {,79cba8301fef86f355b87c794ca860f314a739f0,1,0
public static List<Object> toItemList(Object entity) {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
import io.fabric8.kubernetes.api.extensions.Templates;,79cba8301fef86f355b87c794ca860f314a739f0,1,0
import java.util.Collection;,79cba8301fef86f355b87c794ca860f314a739f0,1,0
* from the Kubernetes REST API,79cba8301fef86f355b87c794ca860f314a739f0,1,0
return objectMapper.reader(Object.class).readValue(json);,79cba8301fef86f355b87c794ca860f314a739f0,1,0
return config.getItems();,79cba8301fef86f355b87c794ca860f314a739f0,1,0
List<Object> items = list.getItems();,79cba8301fef86f355b87c794ca860f314a739f0,1,0
items = new ArrayList<>();,79cba8301fef86f355b87c794ca860f314a739f0,1,0
"return Templates.combineTemplates(list, items);",79cba8301fef86f355b87c794ca860f314a739f0,1,0
protected static void moveServicesToFrontOfArray(List<Object> list) {,79cba8301fef86f355b87c794ca860f314a739f0,1,0
int size = list.size();,79cba8301fef86f355b87c794ca860f314a739f0,1,0
protected static void removeDuplicates(List<Object> itemArray) {,79cba8301fef86f355b87c794ca860f314a739f0,1,0
},79cba8301fef86f355b87c794ca860f314a739f0,1,0
KubernetesList kubernetesList = (KubernetesList) object;,79cba8301fef86f355b87c794ca860f314a739f0,1,0
List<Object> items = kubernetesList.getItems();,79cba8301fef86f355b87c794ca860f314a739f0,1,0
Collection collection = (Collection) object;,79cba8301fef86f355b87c794ca860f314a739f0,1,0
protected static KubernetesList findOrCreateList(Object[] objects) {,79cba8301fef86f355b87c794ca860f314a739f0,1,0
return list;,79cba8301fef86f355b87c794ca860f314a739f0,1,0
import com.fasterxml.jackson.databind.JsonNode;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
import com.fasterxml.jackson.databind.ObjectReader;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
import com.fasterxml.jackson.databind.node.ArrayNode;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
import com.fasterxml.jackson.databind.node.JsonNodeFactory;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
import com.fasterxml.jackson.databind.node.ObjectNode;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
import io.fabric8.openshift.api.model.BuildConfig;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
import io.fabric8.openshift.api.model.DeploymentConfig;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
import io.fabric8.openshift.api.model.ImageRepository;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
import java.io.ByteArrayInputStream;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
import java.util.Iterator;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
import io.fabric8.kubernetes.api.model.Item;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
import io.fabric8.kubernetes.api.model.Template;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
return Strings.firstNonBlank(,79cba8301fef86f355b87c794ca860f314a739f0,1,1
return null;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
},79cba8301fef86f355b87c794ca860f314a739f0,1,1
"return getJsonTextProperty(entity, ""kind"");",79cba8301fef86f355b87c794ca860f314a739f0,1,1
JsonNode current = node;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
current = current.get(name);,79cba8301fef86f355b87c794ca860f314a739f0,1,1
return current != null ? current.textValue() : null;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
* from the Kubernetes REST API or,79cba8301fef86f355b87c794ca860f314a739f0,1,1
* {@link JsonNode} if it cannot be recognised.,79cba8301fef86f355b87c794ca860f314a739f0,1,1
ObjectReader reader = objectMapper.reader();,79cba8301fef86f355b87c794ca860f314a739f0,1,1
JsonNode tree = reader.readTree(new ByteArrayInputStream(json));,79cba8301fef86f355b87c794ca860f314a739f0,1,1
"JsonNode kindNode = tree.get(""kind"");",79cba8301fef86f355b87c794ca860f314a739f0,1,1
"return loadEntity(json, kind, tree);",79cba8301fef86f355b87c794ca860f314a739f0,1,1
return tree;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
return toItemList(getEntity(jsonNode));,79cba8301fef86f355b87c794ca860f314a739f0,1,1
return objectMapper.reader(Pod.class).readValue(json);,79cba8301fef86f355b87c794ca860f314a739f0,1,1
return objectMapper.reader(ReplicationController.class).readValue(json);,79cba8301fef86f355b87c794ca860f314a739f0,1,1
return objectMapper.reader(Service.class).readValue(json);,79cba8301fef86f355b87c794ca860f314a739f0,1,1
return objectMapper.reader(BuildConfig.class).readValue(json);,79cba8301fef86f355b87c794ca860f314a739f0,1,1
return objectMapper.reader(DeploymentConfig.class).readValue(json);,79cba8301fef86f355b87c794ca860f314a739f0,1,1
return objectMapper.reader(ImageRepository.class).readValue(json);,79cba8301fef86f355b87c794ca860f314a739f0,1,1
return objectMapper.reader(Template.class).readValue(json);,79cba8301fef86f355b87c794ca860f314a739f0,1,1
return loadList(json);,79cba8301fef86f355b87c794ca860f314a739f0,1,1
return defaultValue;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
protected static Config loadList(byte[] data) throws IOException {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
Config config = new Config();,79cba8301fef86f355b87c794ca860f314a739f0,1,1
List<Object> itemList = new ArrayList<>();,79cba8301fef86f355b87c794ca860f314a739f0,1,1
JsonNode jsonNode = objectMapper.readTree(data);,79cba8301fef86f355b87c794ca860f314a739f0,1,1
"JsonNode items = jsonNode.get(""items"");",79cba8301fef86f355b87c794ca860f314a739f0,1,1
for (JsonNode item : items) {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
"JsonNode kindObject = item.get(""kind"");",79cba8301fef86f355b87c794ca860f314a739f0,1,1
byte[] bytes = json.getBytes();,79cba8301fef86f355b87c794ca860f314a739f0,1,1
return config;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
* Loads the entity for the given item,79cba8301fef86f355b87c794ca860f314a739f0,1,1
public static JsonNode combineJson(Object... objects) throws IOException {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
JsonNode config = findOrCreateConfig(objects);,79cba8301fef86f355b87c794ca860f314a739f0,1,1
"JsonNode items = config.get(""items"");",79cba8301fef86f355b87c794ca860f314a739f0,1,1
itemArray = (ArrayNode) items;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
itemArray = new ArrayNode(createNodeFactory());,79cba8301fef86f355b87c794ca860f314a739f0,1,1
ObjectNode objectNode = (ObjectNode) config;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
"return combineTemplates(config, itemArray);",79cba8301fef86f355b87c794ca860f314a739f0,1,1
"protected static JsonNode combineTemplates(JsonNode config, ArrayNode itemArray) {",79cba8301fef86f355b87c794ca860f314a739f0,1,1
JsonNode template = null;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
for (JsonNode jsonNode : config) {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
template = jsonNode;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
"JsonNode items = config.get(""objects"");",79cba8301fef86f355b87c794ca860f314a739f0,1,1
objects = (ArrayNode) items;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
objects = new ArrayNode(createNodeFactory());,79cba8301fef86f355b87c794ca860f314a739f0,1,1
ObjectNode objectNode = (ObjectNode) template;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
return template;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
protected static void moveServicesToFrontOfArray(ArrayNode itemArray) {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
int size = itemArray.size();,79cba8301fef86f355b87c794ca860f314a739f0,1,1
JsonNode jsonNode = itemArray.get(i);,79cba8301fef86f355b87c794ca860f314a739f0,1,1
JsonNode nonService = itemArray.get(lastNonService);,79cba8301fef86f355b87c794ca860f314a739f0,1,1
protected static void removeDuplicates(ArrayNode itemArray) {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
protected static boolean isService(JsonNode jsonNode) {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
"JsonNode kind = jsonNode.get(""kind"");",79cba8301fef86f355b87c794ca860f314a739f0,1,1
"return kind != null && Objects.equal(""Service"", kind.textValue());",79cba8301fef86f355b87c794ca860f314a739f0,1,1
return false;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
protected static boolean isTemplate(JsonNode jsonNode) {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
"return kind != null && Objects.equal(""Template"", kind.textValue());",79cba8301fef86f355b87c794ca860f314a739f0,1,1
JsonNode node = toJsonNode(object);,79cba8301fef86f355b87c794ca860f314a739f0,1,1
"JsonNode items = node.get(""items"");",79cba8301fef86f355b87c794ca860f314a739f0,1,1
Iterator<JsonNode> iter = items.iterator();,79cba8301fef86f355b87c794ca860f314a739f0,1,1
protected static JsonNodeFactory createNodeFactory() {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
return new JsonNodeFactory(false);,79cba8301fef86f355b87c794ca860f314a739f0,1,1
protected static JsonNode findOrCreateConfig(Object[] objects) {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
JsonNode jsonNode = (JsonNode) object;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
return jsonNode;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
JsonNodeFactory factory = createNodeFactory();,79cba8301fef86f355b87c794ca860f314a739f0,1,1
ObjectNode config = factory.objectNode();,79cba8301fef86f355b87c794ca860f314a739f0,1,1
public static JsonNode toJsonNode(Object object) throws IOException {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
return (JsonNode) object;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
return objectMapper.reader().readTree(json);,79cba8301fef86f355b87c794ca860f314a739f0,1,1
import io.fabric8.openshift.api.model.template.Template;,79cba8301fef86f355b87c794ca860f314a739f0,1,0
import org.apache.maven.plugin.logging.Log;,79cba8301fef86f355b87c794ca860f314a739f0,1,0
import java.util.Set;,79cba8301fef86f355b87c794ca860f314a739f0,1,0
Controller controller = createController();,79cba8301fef86f355b87c794ca860f314a739f0,1,0
Log log = getLog();,79cba8301fef86f355b87c794ca860f314a739f0,1,0
"log.warn(""No fabric8.apply.routeDomain property or $KUBERNETES_DOMAIN environment variable so cannot create any OpenShift Routes"");",79cba8301fef86f355b87c794ca860f314a739f0,1,0
RouteSpec routeSpec = new RouteSpec();,79cba8301fef86f355b87c794ca860f314a739f0,1,0
ObjectReference objectRef = new ObjectReference();,79cba8301fef86f355b87c794ca860f314a739f0,1,0
try {,79cba8301fef86f355b87c794ca860f314a739f0,1,0
},79cba8301fef86f355b87c794ca860f314a739f0,1,0
return route;,79cba8301fef86f355b87c794ca860f314a739f0,1,0
* By default lets ignore the kubernetes services and any service which does not expose ports 80 and 443,79cba8301fef86f355b87c794ca860f314a739f0,1,0
return false;,79cba8301fef86f355b87c794ca860f314a739f0,1,0
Set<Integer> ports = KubernetesHelper.getPorts(service);,79cba8301fef86f355b87c794ca860f314a739f0,1,0
return true;,79cba8301fef86f355b87c794ca860f314a739f0,1,0
import io.fabric8.openshift.api.model.template.Template;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
"@Parameter(property = ""fabric8.apply.recreate"")",79cba8301fef86f355b87c794ca860f314a739f0,1,1
* The domain added to the service ID when creating OpenShift routes,79cba8301fef86f355b87c794ca860f314a739f0,1,1
private String routeDomain;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
Controller controller = new Controller(this.kubernetes);,79cba8301fef86f355b87c794ca860f314a739f0,1,1
"getLog().warn(""No fabric8.apply.routeDomain property or $KUBERNETES_DOMAIN environment variable so cannot create any OpenShift Routes"");",79cba8301fef86f355b87c794ca860f314a739f0,1,1
RouteSpec routeSpec = new RouteSpec();,79cba8301fef86f355b87c794ca860f314a739f0,1,1
ObjectReference objectRef = new ObjectReference();,79cba8301fef86f355b87c794ca860f314a739f0,1,1
try {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
},79cba8301fef86f355b87c794ca860f314a739f0,1,1
public KubernetesClient getKubernetes() {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
return kubernetes;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
import io.fabric8.kubernetes.api.model.HasMetadata;,79cba8301fef86f355b87c794ca860f314a739f0,1,0
return getName((HasMetadata) object);,79cba8301fef86f355b87c794ca860f314a739f0,1,0
public static ObjectMeta getOrCreateMetadata(HasMetadata entity) {,79cba8301fef86f355b87c794ca860f314a739f0,1,0
return resourceVersion;,79cba8301fef86f355b87c794ca860f314a739f0,1,0
},79cba8301fef86f355b87c794ca860f314a739f0,1,0
return null;,79cba8301fef86f355b87c794ca860f314a739f0,1,0
public static boolean hasResourceVersion(HasMetadata entity) {,79cba8301fef86f355b87c794ca860f314a739f0,1,0
return getResourceVersion(entity) != null;,79cba8301fef86f355b87c794ca860f314a739f0,1,0
return getName(entity.getMetadata());,79cba8301fef86f355b87c794ca860f314a739f0,1,0
return getNamespace(entity.getMetadata());,79cba8301fef86f355b87c794ca860f314a739f0,1,0
"public static Map<String, String> getLabels(HasMetadata entity) {",79cba8301fef86f355b87c794ca860f314a739f0,1,0
return getLabels(entity.getMetadata());,79cba8301fef86f355b87c794ca860f314a739f0,1,0
return Collections.EMPTY_MAP;,79cba8301fef86f355b87c794ca860f314a739f0,1,0
public static List<HasMetadata> toItemList(Object entity) throws IOException {,79cba8301fef86f355b87c794ca860f314a739f0,1,0
List<HasMetadata> items = list.getItems();,79cba8301fef86f355b87c794ca860f314a739f0,1,0
public static void moveServicesToFrontOfArray(List<HasMetadata> list) {,79cba8301fef86f355b87c794ca860f314a739f0,1,0
HasMetadata item = list.get(i);,79cba8301fef86f355b87c794ca860f314a739f0,1,0
HasMetadata nonService = list.get(lastNonService);,79cba8301fef86f355b87c794ca860f314a739f0,1,0
protected static void removeDuplicates(List<HasMetadata> itemArray) {,79cba8301fef86f355b87c794ca860f314a739f0,1,0
HasMetadata item = itemArray.get(i);,79cba8301fef86f355b87c794ca860f314a739f0,1,0
List<HasMetadata> items = kubernetesList.getItems();,79cba8301fef86f355b87c794ca860f314a739f0,1,0
List<HasMetadata> items = toItemList(dto);,79cba8301fef86f355b87c794ca860f314a739f0,1,0
return getName((Pod) object);,79cba8301fef86f355b87c794ca860f314a739f0,1,1
return getName((ReplicationController) object);,79cba8301fef86f355b87c794ca860f314a739f0,1,1
return getName((Service) object);,79cba8301fef86f355b87c794ca860f314a739f0,1,1
return getName((Route) object);,79cba8301fef86f355b87c794ca860f314a739f0,1,1
public static ObjectMeta getOrCreateMetadata(Pod entity) {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
},79cba8301fef86f355b87c794ca860f314a739f0,1,1
return metadata;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
public static ObjectMeta getOrCreateMetadata(ReplicationController entity) {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
public static ObjectMeta getOrCreateMetadata(Service entity) {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
public static ObjectMeta getOrCreateMetadata(Namespace entity) {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
public static ObjectMeta getOrCreateMetadata(Route entity) {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
public static ObjectMeta getOrCreateMetadata(Build entity) {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
public static ObjectMeta getOrCreateMetadata(BuildConfig entity) {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
public static ObjectMeta getOrCreateMetadata(DeploymentConfig entity) {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
public static ObjectMeta getOrCreateMetadata(ImageStream entity) {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
public static ObjectMeta getOrCreateMetadata(OAuthClient entity) {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
public static ObjectMeta getOrCreateMetadata(Template entity) {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
"return Strings.firstNonBlank(getName(entity.getMetadata()),",79cba8301fef86f355b87c794ca860f314a739f0,1,1
return null;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
ObjectMeta objectMeta = getOrCreateMetadata(entity);,79cba8301fef86f355b87c794ca860f314a739f0,1,1
"return Strings.firstNonBlank(getNamespace(entity.getMetadata()),",79cba8301fef86f355b87c794ca860f314a739f0,1,1
return additionalProperties.get(name);,79cba8301fef86f355b87c794ca860f314a739f0,1,1
int lastIdx = names.length - 1;,79cba8301fef86f355b87c794ca860f314a739f0,1,1
"Map<String, Object> map = additionalProperties;",79cba8301fef86f355b87c794ca860f314a739f0,1,1
"map = getAdditionalPropertyMap(map, names[i]);",79cba8301fef86f355b87c794ca860f314a739f0,1,1
"return getAdditionalPropertyText(map, names[lastIdx]);",79cba8301fef86f355b87c794ca860f314a739f0,1,1
public static List<Object> toItemList(Object entity) throws IOException {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
List<Object> items = list.getItems();,79cba8301fef86f355b87c794ca860f314a739f0,1,1
public static void moveServicesToFrontOfArray(List<Object> list) {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
protected static void removeDuplicates(List<Object> itemArray) {,79cba8301fef86f355b87c794ca860f314a739f0,1,1
List<Object> items = kubernetesList.getItems();,79cba8301fef86f355b87c794ca860f314a739f0,1,1
List<Object> items = toItemList(dto);,79cba8301fef86f355b87c794ca860f314a739f0,1,1
import io.fabric8.kubernetes.api.model.HasMetadata;,79cba8301fef86f355b87c794ca860f314a739f0,1,0
"protected void createRoutes(KubernetesClient kubernetes, List<HasMetadata> list) {",79cba8301fef86f355b87c794ca860f314a739f0,1,0
"protected void createRoutes(KubernetesClient kubernetes, List<Object> list) {",79cba8301fef86f355b87c794ca860f314a739f0,1,1
"throw new MojoFailureException(""Cannot find Kubernetes master URL"");",79cba8301fef86f355b87c794ca860f314a739f0,1,0
String json;,79cba8301fef86f355b87c794ca860f314a739f0,1,0
"throw new MojoFailureException(""Can't find Kubernetes master URL"");",79cba8301fef86f355b87c794ca860f314a739f0,1,1
List<Route> items = routes.getItems();,79cba8301fef86f355b87c794ca860f314a739f0,1,1
private boolean recreateMode;,79cba8301fef86f355b87c794ca860f314a739f0,0,0
private boolean ignoreServiceMode;,79cba8301fef86f355b87c794ca860f314a739f0,0,0
return;,79cba8301fef86f355b87c794ca860f314a739f0,0,0
* If enabled then updates are performed by deleting the resource first then creating it,79cba8301fef86f355b87c794ca860f314a739f0,0,0
/**,79cba8301fef86f355b87c794ca860f314a739f0,0,0
* recreate ReplicationControllers and Pods but leave Services as they are to avoid the portalIP addresses,79cba8301fef86f355b87c794ca860f314a739f0,0,0
* changing,79cba8301fef86f355b87c794ca860f314a739f0,0,0
*/,79cba8301fef86f355b87c794ca860f314a739f0,0,0
private boolean updateViaDeleteAndCreate;,79cba8301fef86f355b87c794ca860f314a739f0,0,1
* If enabled then updates are performed by deleting the resource first then rereating it,79cba8301fef86f355b87c794ca860f314a739f0,0,1
/**,79cba8301fef86f355b87c794ca860f314a739f0,0,0
*/,79cba8301fef86f355b87c794ca860f314a739f0,0,0
"portText.append("", "");",79cba8301fef86f355b87c794ca860f314a739f0,0,0
"appendSummaryText(buffer, podState);",79cba8301fef86f355b87c794ca860f314a739f0,0,0
"buffer.append("", "");",79cba8301fef86f355b87c794ca860f314a739f0,0,0
buffer.append(text);,79cba8301fef86f355b87c794ca860f314a739f0,0,0
list.setItems(items);,79cba8301fef86f355b87c794ca860f314a739f0,0,0
"addObjectsToItemArray(items, object);",79cba8301fef86f355b87c794ca860f314a739f0,0,0
moveServicesToFrontOfArray(items);,79cba8301fef86f355b87c794ca860f314a739f0,0,0
removeDuplicates(items);,79cba8301fef86f355b87c794ca860f314a739f0,0,0
"list.set(i, nonService);",79cba8301fef86f355b87c794ca860f314a739f0,0,0
"list.set(lastNonService, item);",79cba8301fef86f355b87c794ca860f314a739f0,0,0
* @param itemArray,79cba8301fef86f355b87c794ca860f314a739f0,0,0
itemArray.remove(i);,79cba8301fef86f355b87c794ca860f314a739f0,0,0
i--;,79cba8301fef86f355b87c794ca860f314a739f0,0,0
size--;,79cba8301fef86f355b87c794ca860f314a739f0,0,0
// lets remove this one,79cba8301fef86f355b87c794ca860f314a739f0,0,0
destinationList.addAll(items);,79cba8301fef86f355b87c794ca860f314a739f0,0,0
destinationList.addAll(collection);,79cba8301fef86f355b87c794ca860f314a739f0,0,0
destinationList.add(object);,79cba8301fef86f355b87c794ca860f314a739f0,0,0
break;,79cba8301fef86f355b87c794ca860f314a739f0,0,0
/*,79cba8301fef86f355b87c794ca860f314a739f0,0,1
TODO Config,79cba8301fef86f355b87c794ca860f314a739f0,0,1
*/,79cba8301fef86f355b87c794ca860f314a739f0,0,1
"getJsonTextProperty(entity, ""metadata"", ""name""),",79cba8301fef86f355b87c794ca860f314a739f0,0,1
"getJsonTextProperty(entity, ""metadata"", ""id""),",79cba8301fef86f355b87c794ca860f314a739f0,0,1
"getJsonTextProperty(entity, ""name""),",79cba8301fef86f355b87c794ca860f314a739f0,0,1
"getJsonTextProperty(entity, ""id""));",79cba8301fef86f355b87c794ca860f314a739f0,0,1
config.setItems(itemList);,79cba8301fef86f355b87c794ca860f314a739f0,0,1
itemList.add(entity);,79cba8301fef86f355b87c794ca860f314a739f0,0,1
/**,79cba8301fef86f355b87c794ca860f314a739f0,0,1
ArrayNode itemArray;,79cba8301fef86f355b87c794ca860f314a739f0,0,1
"objectNode.set(""items"", itemArray);",79cba8301fef86f355b87c794ca860f314a739f0,0,1
"addObjectsToItemArray(itemArray, object);",79cba8301fef86f355b87c794ca860f314a739f0,0,1
moveServicesToFrontOfArray(itemArray);,79cba8301fef86f355b87c794ca860f314a739f0,0,1
removeDuplicates(itemArray);,79cba8301fef86f355b87c794ca860f314a739f0,0,1
* If we have any templates inside the itemArray then lets unpack them and combine any parameters,79cba8301fef86f355b87c794ca860f314a739f0,0,1
// TODO combine templates...,79cba8301fef86f355b87c794ca860f314a739f0,0,1
// lets move all the content into the template,79cba8301fef86f355b87c794ca860f314a739f0,0,1
ArrayNode objects;,79cba8301fef86f355b87c794ca860f314a739f0,0,1
"objectNode.set(""objects"", itemArray);",79cba8301fef86f355b87c794ca860f314a739f0,0,1
objects.add(jsonNode);,79cba8301fef86f355b87c794ca860f314a739f0,0,1
"itemArray.set(i, nonService);",79cba8301fef86f355b87c794ca860f314a739f0,0,1
"itemArray.set(lastNonService, jsonNode);",79cba8301fef86f355b87c794ca860f314a739f0,0,1
// lets remove this one,79cba8301fef86f355b87c794ca860f314a739f0,0,1
itemArray.remove(i);,79cba8301fef86f355b87c794ca860f314a739f0,0,1
i--;,79cba8301fef86f355b87c794ca860f314a739f0,0,1
size--;,79cba8301fef86f355b87c794ca860f314a739f0,0,1
itemArray.add(item);,79cba8301fef86f355b87c794ca860f314a739f0,0,1
itemArray.add(node);,79cba8301fef86f355b87c794ca860f314a739f0,0,1
"config.set(""apiVersion"", factory.textNode(defaultApiVersion));",79cba8301fef86f355b87c794ca860f314a739f0,0,1
"config.set(""kind"", factory.textNode(""List""));",79cba8301fef86f355b87c794ca860f314a739f0,0,1
"config.set(""items"", factory.arrayNode());",79cba8301fef86f355b87c794ca860f314a739f0,0,1
* Converts the DTO to a JsonNode,79cba8301fef86f355b87c794ca860f314a739f0,0,1
objectRef.setName(id);,79cba8301fef86f355b87c794ca860f314a739f0,0,0
objectRef.setNamespace(namespace);,79cba8301fef86f355b87c794ca860f314a739f0,0,0
routeSpec.setTo(objectRef);,79cba8301fef86f355b87c794ca860f314a739f0,0,0
route.setSpec(routeSpec);,79cba8301fef86f355b87c794ca860f314a739f0,0,0
/**,79cba8301fef86f355b87c794ca860f314a739f0,0,0
*,79cba8301fef86f355b87c794ca860f314a739f0,0,0
*/,79cba8301fef86f355b87c794ca860f314a739f0,0,0
/**,79cba8301fef86f355b87c794ca860f314a739f0,0,1
* Should we update resources by deleting them first and then creating them again?,79cba8301fef86f355b87c794ca860f314a739f0,0,1
*/,79cba8301fef86f355b87c794ca860f314a739f0,0,1
private boolean recreate;,79cba8301fef86f355b87c794ca860f314a739f0,0,1
private boolean failOnError;,79cba8301fef86f355b87c794ca860f314a739f0,0,1
controller.setRecreateMode(recreate);,79cba8301fef86f355b87c794ca860f314a739f0,0,1
controller.setThrowExceptionOnError(failOnError);,79cba8301fef86f355b87c794ca860f314a739f0,0,1
objectRef.setName(id);,79cba8301fef86f355b87c794ca860f314a739f0,0,1
objectRef.setNamespace(namespace);,79cba8301fef86f355b87c794ca860f314a739f0,0,1
routeSpec.setTo(objectRef);,79cba8301fef86f355b87c794ca860f314a739f0,0,1
route.setSpec(routeSpec);,79cba8301fef86f355b87c794ca860f314a739f0,0,1
kubernetes.setNamespace(namespace);,79cba8301fef86f355b87c794ca860f314a739f0,0,1
/**,79cba8301fef86f355b87c794ca860f314a739f0,0,0
*/,79cba8301fef86f355b87c794ca860f314a739f0,0,0
metadata.setNamespace(namespace);,79cba8301fef86f355b87c794ca860f314a739f0,0,0
metadata.setName(name);,79cba8301fef86f355b87c794ca860f314a739f0,0,0
answer.add((HasMetadata) entity);,79cba8301fef86f355b87c794ca860f314a739f0,0,0
entity.setMetadata(metadata);,79cba8301fef86f355b87c794ca860f314a739f0,0,1
"getAdditionalPropertyText(entity.getAdditionalProperties(), ""name""),",79cba8301fef86f355b87c794ca860f314a739f0,0,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""name""),",79cba8301fef86f355b87c794ca860f314a739f0,0,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""id"")",79cba8301fef86f355b87c794ca860f314a739f0,0,1
);,79cba8301fef86f355b87c794ca860f314a739f0,0,1
getOrCreateMetadata(entity).setName(name);,79cba8301fef86f355b87c794ca860f314a739f0,0,1
objectMeta.setNamespace(namespace);,79cba8301fef86f355b87c794ca860f314a739f0,0,1
objectMeta.setName(name);,79cba8301fef86f355b87c794ca860f314a739f0,0,1
"getAdditionalPropertyText(entity.getAdditionalProperties(), ""namespace""),",79cba8301fef86f355b87c794ca860f314a739f0,0,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""namespace""));",79cba8301fef86f355b87c794ca860f314a739f0,0,1
answer.add(answer);,79cba8301fef86f355b87c794ca860f314a739f0,0,1
"KubernetesHelper.setName(route, namespace, routeId);",79cba8301fef86f355b87c794ca860f314a739f0,0,0
"getLog().info(""OpenShift platform detected"");",79cba8301fef86f355b87c794ca860f314a739f0,0,0
routes.getItems();,79cba8301fef86f355b87c794ca860f314a739f0,0,0
} else if (entity instanceof KubernetesList) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,3,0
int size = list.size();,04e48748aa6ea56b4ba65404c02a24269ebd57d8,3,0
} else if (object instanceof Collection) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,3,0
JsonNode jsonNode = (JsonNode) entity;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,3,1
} if (entity instanceof List) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,3,1
"} else if (Objects.equal(""ReplicationController"", kind)) {",04e48748aa6ea56b4ba65404c02a24269ebd57d8,3,1
"} else if (Objects.equal(""Service"", kind)) {",04e48748aa6ea56b4ba65404c02a24269ebd57d8,3,1
"} else if (Objects.equal(""BuildConfig"", kind)) {",04e48748aa6ea56b4ba65404c02a24269ebd57d8,3,1
"} else if (Objects.equal(""DeploymentConfig"", kind)) {",04e48748aa6ea56b4ba65404c02a24269ebd57d8,3,1
"} else if (Objects.equal(""ImageRepository"", kind)) {",04e48748aa6ea56b4ba65404c02a24269ebd57d8,3,1
"} else if (Objects.equal(""Template"", kind)) {",04e48748aa6ea56b4ba65404c02a24269ebd57d8,3,1
"} else if (Objects.equal(""Config"", kind) || Objects.equal(""List"", kind)) {",04e48748aa6ea56b4ba65404c02a24269ebd57d8,3,1
JsonNode jsonNode = objectMapper.readTree(data);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,3,1
int size = itemArray.size();,04e48748aa6ea56b4ba65404c02a24269ebd57d8,3,1
JsonNode jsonNode = itemArray.get(i);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,3,1
if (jsonNode != null) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,3,1
"JsonNode kind = jsonNode.get(""kind"");",04e48748aa6ea56b4ba65404c02a24269ebd57d8,3,1
JsonNode jsonNode = (JsonNode) object;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,3,1
} else if (object == null) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,3,1
if (entity instanceof List) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,0
if (items == null) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,0
if (object != list) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,0
Object item = list.get(i);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,0
if (item instanceof Service) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,0
Object item = itemArray.get(i);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,0
if (item == null) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,0
} else {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,0
String kind = item.getClass().getSimpleName();,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,0
if (Strings.isNotBlank(id)) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,0
"String key = kind + "":"" + id;",04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,0
if (!keys.add(key)) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,0
if (object instanceof KubernetesList) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,0
if (items != null) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,0
if (list == null) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,0
if (entity != null) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
} else {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
JsonNode current = node;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
if (current == null) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
JsonNode tree = reader.readTree(new ByteArrayInputStream(json));,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
if (tree != null) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
"JsonNode kindNode = tree.get(""kind"");",04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
if (kindNode != null) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
String kind = kindNode.asText();,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
if (entity instanceof JsonNode) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
"if (Objects.equal(""Pod"", kind)) {",04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
"JsonNode items = jsonNode.get(""items"");",04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
for (JsonNode item : items) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
if (item != null) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
"JsonNode kindObject = item.get(""kind"");",04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
if (kindObject != null && kindObject.isTextual()) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
String kind = kindObject.asText();,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
String json = toJson(item);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
if (kind != null) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
public static JsonNode combineJson(Object... objects) throws IOException {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
JsonNode config = findOrCreateConfig(objects);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
"JsonNode items = config.get(""items"");",04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
if (items instanceof ArrayNode) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
if (config instanceof ObjectNode) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
if (object != config) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
"protected static JsonNode combineTemplates(JsonNode config, ArrayNode itemArray) {",04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
JsonNode template = null;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
for (JsonNode jsonNode : config) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
if (isTemplate(jsonNode)) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
if (template == null) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
if (template != null) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
"JsonNode items = config.get(""objects"");",04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
if (template instanceof ObjectNode) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
if (!isTemplate(jsonNode)) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
if (isService(jsonNode)) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
JsonNode nonService = itemArray.get(lastNonService);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
"String kind = Strings.defaultIfEmpty(getKind(jsonNode), """");",04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
if (Strings.isNotBlank(id)) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
"String key = kind + "":"" + id;",04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
if (!keys.add(key)) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
JsonNode node = toJsonNode(object);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
"JsonNode items = node.get(""items"");",04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
if (items != null && items.isArray()) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
protected static JsonNode findOrCreateConfig(Object[] objects) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
if (object instanceof JsonNode) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
public static JsonNode toJsonNode(Object object) throws IOException {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
String json = toJson(object);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,2,1
KubernetesList config = (KubernetesList) entity;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,0
public static Object combineJson(Object... objects) throws IOException {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,0
KubernetesList list = findOrCreateList(objects);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,0
List<Object> items = list.getItems();,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,0
items = new ArrayList<>();,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,0
protected static void moveServicesToFrontOfArray(List<Object> list) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,0
Object nonService = list.get(lastNonService);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,0
protected static void removeDuplicates(List<Object> itemArray) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,0
String id = getObjectId(item);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,0
},04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,0
"protected static void addObjectsToItemArray(List destinationList, Object object) throws IOException {",04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,0
KubernetesList kubernetesList = (KubernetesList) object;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,0
List<Object> items = kubernetesList.getItems();,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,0
Collection collection = (Collection) object;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,0
protected static KubernetesList findOrCreateList(Object[] objects) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,0
KubernetesList list = null;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,0
list = (KubernetesList) object;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,0
list = new KubernetesList();,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,0
public static String getId(JsonNode entity) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
},04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
public static String getKind(JsonNode entity) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
"protected static String getJsonTextProperty(JsonNode node, String... names) {",04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
for (String name : names) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
current = current.get(name);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
* {@link JsonNode} if it cannot be recognised.,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
ObjectReader reader = objectMapper.reader();,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
"protected static Object loadEntity(byte[] json, String kind, Object defaultValue) throws IOException {",04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
protected static Config loadList(byte[] data) throws IOException {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
Config config = new Config();,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
List<Object> itemList = new ArrayList<>();,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
byte[] bytes = json.getBytes();,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
"Object entity = loadEntity(bytes, kind, null);",04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
* Loads the entity for the given item,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
public static Object getEntity(JsonNode item) throws IOException {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
itemArray = (ArrayNode) items;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
itemArray = new ArrayNode(createNodeFactory());,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
ObjectNode objectNode = (ObjectNode) config;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
template = jsonNode;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
objects = (ArrayNode) items;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
objects = new ArrayNode(createNodeFactory());,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
ObjectNode objectNode = (ObjectNode) template;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
protected static void moveServicesToFrontOfArray(ArrayNode itemArray) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
protected static void removeDuplicates(ArrayNode itemArray) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
String id = getId(jsonNode);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
protected static boolean isService(JsonNode jsonNode) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
"return kind != null && Objects.equal(""Service"", kind.textValue());",04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
protected static boolean isTemplate(JsonNode jsonNode) {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
"return kind != null && Objects.equal(""Template"", kind.textValue());",04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
"protected static void addObjectsToItemArray(ArrayNode itemArray, Object object) throws IOException {",04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
Iterator<JsonNode> iter = items.iterator();,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
protected static JsonNodeFactory createNodeFactory() {,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
JsonNodeFactory factory = createNodeFactory();,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
ObjectNode config = factory.objectNode();,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
* Converts the DTO to a JsonNode,04e48748aa6ea56b4ba65404c02a24269ebd57d8,1,1
import io.fabric8.kubernetes.api.extensions.Templates;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,0
import java.util.Collection;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,0
* from the Kubernetes REST API,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,0
return objectMapper.reader(Object.class).readValue(json);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,0
return config.getItems();,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,0
list.setItems(items);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,0
"addObjectsToItemArray(items, object);",04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,0
moveServicesToFrontOfArray(items);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,0
removeDuplicates(items);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,0
"return Templates.combineTemplates(list, items);",04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,0
"list.set(i, nonService);",04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,0
"list.set(lastNonService, item);",04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,0
* @param itemArray,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,0
itemArray.remove(i);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,0
i--;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,0
size--;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,0
// lets remove this one,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,0
destinationList.addAll(items);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,0
destinationList.addAll(collection);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,0
destinationList.add(object);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,0
break;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,0
return list;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,0
import com.fasterxml.jackson.databind.JsonNode;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
import com.fasterxml.jackson.databind.ObjectReader;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
import com.fasterxml.jackson.databind.node.ArrayNode;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
import com.fasterxml.jackson.databind.node.JsonNodeFactory;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
import com.fasterxml.jackson.databind.node.ObjectNode;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
import io.fabric8.openshift.api.model.BuildConfig;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
import io.fabric8.openshift.api.model.DeploymentConfig;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
import io.fabric8.openshift.api.model.ImageRepository;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
import java.io.ByteArrayInputStream;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
import java.util.Iterator;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
/*,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
TODO Config,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
import io.fabric8.kubernetes.api.model.Item;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
import io.fabric8.kubernetes.api.model.Template;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
*/,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
return Strings.firstNonBlank(,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
"getJsonTextProperty(entity, ""metadata"", ""name""),",04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
"getJsonTextProperty(entity, ""metadata"", ""id""),",04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
"getJsonTextProperty(entity, ""name""),",04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
"getJsonTextProperty(entity, ""id""));",04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
return null;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
"return getJsonTextProperty(entity, ""kind"");",04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
return current != null ? current.textValue() : null;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
* from the Kubernetes REST API or,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
"return loadEntity(json, kind, tree);",04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
"LOG.warn(""No JSON type for: "" + tree);",04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
return tree;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
return toItemList(getEntity(jsonNode));,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
return objectMapper.reader(Pod.class).readValue(json);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
return objectMapper.reader(ReplicationController.class).readValue(json);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
return objectMapper.reader(Service.class).readValue(json);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
return objectMapper.reader(BuildConfig.class).readValue(json);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
return objectMapper.reader(DeploymentConfig.class).readValue(json);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
return objectMapper.reader(ImageRepository.class).readValue(json);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
return objectMapper.reader(Template.class).readValue(json);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
return loadList(json);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
return defaultValue;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
config.setItems(itemList);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
itemList.add(entity);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
return config;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
/**,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
return entity;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
ArrayNode itemArray;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
"objectNode.set(""items"", itemArray);",04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
"throw new IllegalArgumentException(""config "" + config + "" is not a ObjectNode"");",04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
"addObjectsToItemArray(itemArray, object);",04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
moveServicesToFrontOfArray(itemArray);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
removeDuplicates(itemArray);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
"return combineTemplates(config, itemArray);",04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
* If we have any templates inside the itemArray then lets unpack them and combine any parameters,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
// TODO combine templates...,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
// lets move all the content into the template,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
ArrayNode objects;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
"objectNode.set(""objects"", itemArray);",04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
"throw new IllegalArgumentException(""config "" + template + "" is not a ObjectNode"");",04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
objects.add(jsonNode);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
return template;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
"itemArray.set(i, nonService);",04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
"itemArray.set(lastNonService, jsonNode);",04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
// lets remove this one,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
itemArray.remove(i);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
i--;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
size--;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
return false;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
itemArray.add(item);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
itemArray.add(node);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
return new JsonNodeFactory(false);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
return jsonNode;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
// lets create a new list,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
"config.set(""apiVersion"", factory.textNode(defaultApiVersion));",04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
"config.set(""kind"", factory.textNode(""List""));",04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
"config.set(""items"", factory.arrayNode());",04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
return (JsonNode) object;,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
return objectMapper.reader().readTree(json);,04e48748aa6ea56b4ba65404c02a24269ebd57d8,0,1
} else if (object instanceof Collection) {,11d7a713884a7e692b43b76b52c77130d9b42270,5,0
} else if (object instanceof ReplicationController) {,11d7a713884a7e692b43b76b52c77130d9b42270,5,1
} else if (object instanceof Service) {,11d7a713884a7e692b43b76b52c77130d9b42270,5,1
} else if (object instanceof Route) {,11d7a713884a7e692b43b76b52c77130d9b42270,5,1
} else if (entity instanceof KubernetesList) {,11d7a713884a7e692b43b76b52c77130d9b42270,4,0
"String key = kind + "":"" + id;",11d7a713884a7e692b43b76b52c77130d9b42270,4,0
if (object instanceof KubernetesList) {,11d7a713884a7e692b43b76b52c77130d9b42270,4,0
} if (entity instanceof List) {,11d7a713884a7e692b43b76b52c77130d9b42270,4,1
"protected static Object loadEntity(byte[] json, String kind, Object defaultValue) throws IOException {",11d7a713884a7e692b43b76b52c77130d9b42270,4,1
"throw new IllegalArgumentException(""config "" + config + "" is not a ObjectNode"");",11d7a713884a7e692b43b76b52c77130d9b42270,4,1
"throw new IllegalArgumentException(""config "" + template + "" is not a ObjectNode"");",11d7a713884a7e692b43b76b52c77130d9b42270,4,1
"String key = kind + "":"" + id;",11d7a713884a7e692b43b76b52c77130d9b42270,4,1
if (object instanceof JsonNode) {,11d7a713884a7e692b43b76b52c77130d9b42270,4,1
} else if (object == null) {,11d7a713884a7e692b43b76b52c77130d9b42270,4,1
if (object instanceof HasMetadata) {,11d7a713884a7e692b43b76b52c77130d9b42270,4,0
} else if (entity instanceof HasMetadata[]) {,11d7a713884a7e692b43b76b52c77130d9b42270,4,0
if (object instanceof Pod) {,11d7a713884a7e692b43b76b52c77130d9b42270,4,1
} else if (entity instanceof Object[]) {,11d7a713884a7e692b43b76b52c77130d9b42270,4,1
if (entity instanceof List) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,0
if (object != list) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,0
if (item instanceof Service) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,0
public static String getId(JsonNode entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,1
public static String getKind(JsonNode entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,1
if (entity instanceof JsonNode) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,1
"} else if (Objects.equal(""ReplicationController"", kind)) {",11d7a713884a7e692b43b76b52c77130d9b42270,3,1
"} else if (Objects.equal(""Service"", kind)) {",11d7a713884a7e692b43b76b52c77130d9b42270,3,1
"} else if (Objects.equal(""BuildConfig"", kind)) {",11d7a713884a7e692b43b76b52c77130d9b42270,3,1
"} else if (Objects.equal(""DeploymentConfig"", kind)) {",11d7a713884a7e692b43b76b52c77130d9b42270,3,1
"} else if (Objects.equal(""ImageRepository"", kind)) {",11d7a713884a7e692b43b76b52c77130d9b42270,3,1
"} else if (Objects.equal(""Template"", kind)) {",11d7a713884a7e692b43b76b52c77130d9b42270,3,1
"} else if (Objects.equal(""Config"", kind) || Objects.equal(""List"", kind)) {",11d7a713884a7e692b43b76b52c77130d9b42270,3,1
if (items instanceof ArrayNode) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,1
if (config instanceof ObjectNode) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,1
if (object != config) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,1
if (template instanceof ObjectNode) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,1
public static String getResourceVersion(HasMetadata entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,0
public static String getName(HasMetadata entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,0
"public static void setName(HasMetadata entity, String namespace, String name) {",11d7a713884a7e692b43b76b52c77130d9b42270,3,0
public static String getNamespace(HasMetadata entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,0
if (entity instanceof HasMetadata) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,0
public static String getName(Pod entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,1
public static String getName(ReplicationController entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,1
public static String getName(Service entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,1
public static String getName(OAuthClient entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,1
public static String getName(Route entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,1
public static String getName(Node entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,1
public static String getName(Template entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,1
public static String getName(ImageStream entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,1
public static String getName(Endpoints entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,1
"public static void setName(Route entity, String namespace, String name) {",11d7a713884a7e692b43b76b52c77130d9b42270,3,1
public static String getNamespace(Pod entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,1
public static String getNamespace(ReplicationController entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,1
public static String getNamespace(Service entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,1
public static String getNamespace(OAuthClient entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,1
public static String getNamespace(Route entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,1
public static String getNamespace(Template entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,3,1
"protected static Object getAdditionalProperty(Map<String, Object> additionalProperties, String name) {",11d7a713884a7e692b43b76b52c77130d9b42270,3,1
public static Object combineJson(Object... objects) throws IOException {,11d7a713884a7e692b43b76b52c77130d9b42270,2,0
if (items == null) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,0
if (item == null) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,0
} else {,11d7a713884a7e692b43b76b52c77130d9b42270,2,0
String kind = item.getClass().getSimpleName();,11d7a713884a7e692b43b76b52c77130d9b42270,2,0
if (Strings.isNotBlank(id)) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,0
if (!keys.add(key)) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,0
"protected static void addObjectsToItemArray(List destinationList, Object object) throws IOException {",11d7a713884a7e692b43b76b52c77130d9b42270,2,0
if (items != null) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,0
if (list == null) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,0
if (entity != null) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
} else {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
"protected static String getJsonTextProperty(JsonNode node, String... names) {",11d7a713884a7e692b43b76b52c77130d9b42270,2,1
if (current == null) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
if (tree != null) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
if (kindNode != null) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
String kind = kindNode.asText();,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
"LOG.warn(""No JSON type for: "" + tree);",11d7a713884a7e692b43b76b52c77130d9b42270,2,1
"if (Objects.equal(""Pod"", kind)) {",11d7a713884a7e692b43b76b52c77130d9b42270,2,1
if (item != null) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
if (kindObject != null && kindObject.isTextual()) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
String kind = kindObject.asText();,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
String json = toJson(item);,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
"Object entity = loadEntity(bytes, kind, null);",11d7a713884a7e692b43b76b52c77130d9b42270,2,1
public static Object getEntity(JsonNode item) throws IOException {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
if (kind != null) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
if (isTemplate(jsonNode)) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
if (template == null) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
if (template != null) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
if (!isTemplate(jsonNode)) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
if (isService(jsonNode)) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
"String kind = Strings.defaultIfEmpty(getKind(jsonNode), """");",11d7a713884a7e692b43b76b52c77130d9b42270,2,1
if (Strings.isNotBlank(id)) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
if (!keys.add(key)) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
if (jsonNode != null) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
"return kind != null && Objects.equal(""Service"", kind.textValue());",11d7a713884a7e692b43b76b52c77130d9b42270,2,1
"return kind != null && Objects.equal(""Template"", kind.textValue());",11d7a713884a7e692b43b76b52c77130d9b42270,2,1
"protected static void addObjectsToItemArray(ArrayNode itemArray, Object object) throws IOException {",11d7a713884a7e692b43b76b52c77130d9b42270,2,1
if (items != null && items.isArray()) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
String json = toJson(object);,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
public static ObjectMeta getOrCreateMetadata(HasMetadata entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,0
* Returns the resource version for the entity or null if it does not have one,11d7a713884a7e692b43b76b52c77130d9b42270,2,0
if (entity != null) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,0
if (metadata != null) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,0
if (Strings.isNotBlank(resourceVersion)) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,0
* Returns true if this entity has a valid non blank resourceVersion in its metadata,11d7a713884a7e692b43b76b52c77130d9b42270,2,0
public static boolean hasResourceVersion(HasMetadata entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,0
"public static void setName(HasMetadata entity, String name) {",11d7a713884a7e692b43b76b52c77130d9b42270,2,0
"public static void setNamespace(HasMetadata entity, String namespace) {",11d7a713884a7e692b43b76b52c77130d9b42270,2,0
"public static Map<String, String> getLabels(HasMetadata entity) {",11d7a713884a7e692b43b76b52c77130d9b42270,2,0
public static List<HasMetadata> toItemList(Object entity) throws IOException {,11d7a713884a7e692b43b76b52c77130d9b42270,2,0
public static ObjectMeta getOrCreateMetadata(Pod entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
if (metadata == null) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
public static ObjectMeta getOrCreateMetadata(ReplicationController entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
public static ObjectMeta getOrCreateMetadata(Service entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
public static ObjectMeta getOrCreateMetadata(Namespace entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
public static ObjectMeta getOrCreateMetadata(Route entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
public static ObjectMeta getOrCreateMetadata(Build entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
public static ObjectMeta getOrCreateMetadata(BuildConfig entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
public static ObjectMeta getOrCreateMetadata(DeploymentConfig entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
public static ObjectMeta getOrCreateMetadata(ImageStream entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
public static ObjectMeta getOrCreateMetadata(OAuthClient entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
public static ObjectMeta getOrCreateMetadata(Template entity) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
if (entity != null) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
} else {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
"public static void setName(Pod entity, String name) {",11d7a713884a7e692b43b76b52c77130d9b42270,2,1
"public static void setName(Service entity, String name) {",11d7a713884a7e692b43b76b52c77130d9b42270,2,1
"public static void setName(ReplicationController entity, String name) {",11d7a713884a7e692b43b76b52c77130d9b42270,2,1
"public static void setName(Template entity, String name) {",11d7a713884a7e692b43b76b52c77130d9b42270,2,1
"public static void setNamespace(Template entity, String namespace) {",11d7a713884a7e692b43b76b52c77130d9b42270,2,1
if (additionalProperties != null) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
"protected static String getAdditionalNestedPropertyText(Map<String, Object> additionalProperties, String... names) {",11d7a713884a7e692b43b76b52c77130d9b42270,2,1
if (map == null) {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
public static List<Object> toItemList(Object entity) throws IOException {,11d7a713884a7e692b43b76b52c77130d9b42270,2,1
* from the Kubernetes REST API,11d7a713884a7e692b43b76b52c77130d9b42270,1,0
return objectMapper.reader(Object.class).readValue(json);,11d7a713884a7e692b43b76b52c77130d9b42270,1,0
return config.getItems();,11d7a713884a7e692b43b76b52c77130d9b42270,1,0
"return Templates.combineTemplates(list, items);",11d7a713884a7e692b43b76b52c77130d9b42270,1,0
protected static void moveServicesToFrontOfArray(List<Object> list) {,11d7a713884a7e692b43b76b52c77130d9b42270,1,0
Object item = list.get(i);,11d7a713884a7e692b43b76b52c77130d9b42270,1,0
Object nonService = list.get(lastNonService);,11d7a713884a7e692b43b76b52c77130d9b42270,1,0
protected static void removeDuplicates(List<Object> itemArray) {,11d7a713884a7e692b43b76b52c77130d9b42270,1,0
Object item = itemArray.get(i);,11d7a713884a7e692b43b76b52c77130d9b42270,1,0
String id = getObjectId(item);,11d7a713884a7e692b43b76b52c77130d9b42270,1,0
},11d7a713884a7e692b43b76b52c77130d9b42270,1,0
protected static KubernetesList findOrCreateList(Object[] objects) {,11d7a713884a7e692b43b76b52c77130d9b42270,1,0
return list;,11d7a713884a7e692b43b76b52c77130d9b42270,1,0
return Strings.firstNonBlank(,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return null;,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
},11d7a713884a7e692b43b76b52c77130d9b42270,1,1
"return getJsonTextProperty(entity, ""kind"");",11d7a713884a7e692b43b76b52c77130d9b42270,1,1
for (String name : names) {,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return current != null ? current.textValue() : null;,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
* from the Kubernetes REST API or,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
* {@link JsonNode} if it cannot be recognised.,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
"return loadEntity(json, kind, tree);",11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return tree;,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return toItemList(getEntity(jsonNode));,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return objectMapper.reader(Pod.class).readValue(json);,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return objectMapper.reader(ReplicationController.class).readValue(json);,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return objectMapper.reader(Service.class).readValue(json);,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return objectMapper.reader(BuildConfig.class).readValue(json);,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return objectMapper.reader(DeploymentConfig.class).readValue(json);,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return objectMapper.reader(ImageRepository.class).readValue(json);,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return objectMapper.reader(Template.class).readValue(json);,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return loadList(json);,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return defaultValue;,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
protected static Config loadList(byte[] data) throws IOException {,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
for (JsonNode item : items) {,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return config;,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
* Loads the entity for the given item,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return entity;,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
public static JsonNode combineJson(Object... objects) throws IOException {,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
"return combineTemplates(config, itemArray);",11d7a713884a7e692b43b76b52c77130d9b42270,1,1
"protected static JsonNode combineTemplates(JsonNode config, ArrayNode itemArray) {",11d7a713884a7e692b43b76b52c77130d9b42270,1,1
for (JsonNode jsonNode : config) {,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return template;,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
protected static void moveServicesToFrontOfArray(ArrayNode itemArray) {,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
protected static void removeDuplicates(ArrayNode itemArray) {,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
String id = getId(jsonNode);,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
protected static boolean isService(JsonNode jsonNode) {,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
"JsonNode kind = jsonNode.get(""kind"");",11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return false;,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
protected static boolean isTemplate(JsonNode jsonNode) {,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
protected static JsonNodeFactory createNodeFactory() {,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return new JsonNodeFactory(false);,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
protected static JsonNode findOrCreateConfig(Object[] objects) {,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return jsonNode;,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
public static JsonNode toJsonNode(Object object) throws IOException {,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return (JsonNode) object;,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return objectMapper.reader().readTree(json);,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return getName((HasMetadata) object);,11d7a713884a7e692b43b76b52c77130d9b42270,1,0
String resourceVersion = metadata.getResourceVersion();,11d7a713884a7e692b43b76b52c77130d9b42270,1,0
return resourceVersion;,11d7a713884a7e692b43b76b52c77130d9b42270,1,0
},11d7a713884a7e692b43b76b52c77130d9b42270,1,0
return null;,11d7a713884a7e692b43b76b52c77130d9b42270,1,0
return getResourceVersion(entity) != null;,11d7a713884a7e692b43b76b52c77130d9b42270,1,0
return getName(entity.getMetadata());,11d7a713884a7e692b43b76b52c77130d9b42270,1,0
return getNamespace(entity.getMetadata());,11d7a713884a7e692b43b76b52c77130d9b42270,1,0
return getLabels(entity.getMetadata());,11d7a713884a7e692b43b76b52c77130d9b42270,1,0
return Collections.EMPTY_MAP;,11d7a713884a7e692b43b76b52c77130d9b42270,1,0
return (List<HasMetadata>) entity;,11d7a713884a7e692b43b76b52c77130d9b42270,1,0
public static void moveServicesToFrontOfArray(List<HasMetadata> list) {,11d7a713884a7e692b43b76b52c77130d9b42270,1,0
protected static void removeDuplicates(List<HasMetadata> itemArray) {,11d7a713884a7e692b43b76b52c77130d9b42270,1,0
return getName((Pod) object);,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return getName((ReplicationController) object);,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return getName((Service) object);,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return getName((Route) object);,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
},11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return metadata;,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
"return Strings.firstNonBlank(getName(entity.getMetadata()),",11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return null;,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
"return Strings.firstNonBlank(getNamespace(entity.getMetadata()),",11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return additionalProperties.get(name);,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
for (int i = 0; i < lastIdx; i++) {,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
"return getAdditionalPropertyText(map, names[lastIdx]);",11d7a713884a7e692b43b76b52c77130d9b42270,1,1
return (List<Object>) entity;,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
public static void moveServicesToFrontOfArray(List<Object> list) {,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
Object item = list.get(i);,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
Object nonService = list.get(lastNonService);,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
protected static void removeDuplicates(List<Object> itemArray) {,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
Object item = itemArray.get(i);,11d7a713884a7e692b43b76b52c77130d9b42270,1,1
import io.fabric8.kubernetes.api.extensions.Templates;,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
import java.util.Collection;,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
KubernetesList config = (KubernetesList) entity;,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
KubernetesList list = findOrCreateList(objects);,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
List<Object> items = list.getItems();,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
items = new ArrayList<>();,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
list.setItems(items);,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
"addObjectsToItemArray(items, object);",11d7a713884a7e692b43b76b52c77130d9b42270,0,0
moveServicesToFrontOfArray(items);,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
removeDuplicates(items);,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
int size = list.size();,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
"list.set(i, nonService);",11d7a713884a7e692b43b76b52c77130d9b42270,0,0
"list.set(lastNonService, item);",11d7a713884a7e692b43b76b52c77130d9b42270,0,0
* @param itemArray,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
itemArray.remove(i);,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
i--;,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
size--;,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
// lets remove this one,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
KubernetesList kubernetesList = (KubernetesList) object;,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
List<Object> items = kubernetesList.getItems();,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
destinationList.addAll(items);,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
Collection collection = (Collection) object;,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
destinationList.addAll(collection);,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
destinationList.add(object);,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
KubernetesList list = null;,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
list = (KubernetesList) object;,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
break;,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
list = new KubernetesList();,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
import com.fasterxml.jackson.databind.JsonNode;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
import com.fasterxml.jackson.databind.ObjectReader;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
import com.fasterxml.jackson.databind.node.ArrayNode;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
import com.fasterxml.jackson.databind.node.JsonNodeFactory;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
import com.fasterxml.jackson.databind.node.ObjectNode;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
import io.fabric8.openshift.api.model.BuildConfig;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
import io.fabric8.openshift.api.model.DeploymentConfig;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
import io.fabric8.openshift.api.model.ImageRepository;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
import java.io.ByteArrayInputStream;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
import java.util.Iterator;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
/*,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
TODO Config,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
import io.fabric8.kubernetes.api.model.Item;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
import io.fabric8.kubernetes.api.model.Template;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
*/,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"getJsonTextProperty(entity, ""metadata"", ""name""),",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"getJsonTextProperty(entity, ""metadata"", ""id""),",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"getJsonTextProperty(entity, ""name""),",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"getJsonTextProperty(entity, ""id""));",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
JsonNode current = node;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
current = current.get(name);,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
ObjectReader reader = objectMapper.reader();,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
JsonNode tree = reader.readTree(new ByteArrayInputStream(json));,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"JsonNode kindNode = tree.get(""kind"");",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
JsonNode jsonNode = (JsonNode) entity;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
Config config = new Config();,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
List<Object> itemList = new ArrayList<>();,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
config.setItems(itemList);,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
JsonNode jsonNode = objectMapper.readTree(data);,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"JsonNode items = jsonNode.get(""items"");",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"JsonNode kindObject = item.get(""kind"");",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
byte[] bytes = json.getBytes();,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
itemList.add(entity);,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
/**,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
JsonNode config = findOrCreateConfig(objects);,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"JsonNode items = config.get(""items"");",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
ArrayNode itemArray;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
itemArray = (ArrayNode) items;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
itemArray = new ArrayNode(createNodeFactory());,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
ObjectNode objectNode = (ObjectNode) config;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"objectNode.set(""items"", itemArray);",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"addObjectsToItemArray(itemArray, object);",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
moveServicesToFrontOfArray(itemArray);,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
removeDuplicates(itemArray);,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
* If we have any templates inside the itemArray then lets unpack them and combine any parameters,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
JsonNode template = null;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
template = jsonNode;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
// TODO combine templates...,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
// lets move all the content into the template,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"JsonNode items = config.get(""objects"");",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
ArrayNode objects;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
objects = (ArrayNode) items;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
objects = new ArrayNode(createNodeFactory());,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
ObjectNode objectNode = (ObjectNode) template;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"objectNode.set(""objects"", itemArray);",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
objects.add(jsonNode);,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
int size = itemArray.size();,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
JsonNode jsonNode = itemArray.get(i);,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
JsonNode nonService = itemArray.get(lastNonService);,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"itemArray.set(i, nonService);",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"itemArray.set(lastNonService, jsonNode);",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
// lets remove this one,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
itemArray.remove(i);,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
i--;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
size--;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
JsonNode node = toJsonNode(object);,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"JsonNode items = node.get(""items"");",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
Iterator<JsonNode> iter = items.iterator();,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
itemArray.add(item);,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
itemArray.add(node);,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
JsonNode jsonNode = (JsonNode) object;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
// lets create a new list,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
JsonNodeFactory factory = createNodeFactory();,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
ObjectNode config = factory.objectNode();,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"config.set(""apiVersion"", factory.textNode(defaultApiVersion));",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"config.set(""kind"", factory.textNode(""List""));",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"config.set(""items"", factory.arrayNode());",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
* Converts the DTO to a JsonNode,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
import io.fabric8.kubernetes.api.model.HasMetadata;,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
/**,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
*/,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
ObjectMeta metadata = entity.getMetadata();,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
ObjectMeta metadata = getOrCreateMetadata(entity);,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
metadata.setNamespace(namespace);,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
metadata.setName(name);,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
HasMetadata[] array = (HasMetadata[]) entity;,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
List<HasMetadata> answer = new ArrayList<>();,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
answer.add((HasMetadata) entity);,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
List<HasMetadata> items = list.getItems();,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
HasMetadata item = list.get(i);,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
HasMetadata nonService = list.get(lastNonService);,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
HasMetadata item = itemArray.get(i);,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
List<HasMetadata> items = kubernetesList.getItems();,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
List<HasMetadata> items = toItemList(dto);,11d7a713884a7e692b43b76b52c77130d9b42270,0,0
ObjectMeta metadata = entity.getMetadata();,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
metadata = new ObjectMeta();,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
entity.setMetadata(metadata);,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"getAdditionalPropertyText(entity.getAdditionalProperties(), ""name""),",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""name""),",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""id"")",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
);,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
getOrCreateMetadata(entity).setName(name);,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
ObjectMeta objectMeta = getOrCreateMetadata(entity);,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
objectMeta.setNamespace(namespace);,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
objectMeta.setName(name);,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"getAdditionalPropertyText(entity.getAdditionalProperties(), ""namespace""),",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""namespace""));",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
int lastIdx = names.length - 1;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"Map<String, Object> map = additionalProperties;",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"map = getAdditionalPropertyMap(map, names[i]);",11d7a713884a7e692b43b76b52c77130d9b42270,0,1
Object[] array = (Object[]) entity;,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
List<Object> answer = new ArrayList<>();,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
answer.add(answer);,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
List<Object> items = list.getItems();,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
List<Object> items = kubernetesList.getItems();,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
List<Object> items = toItemList(dto);,11d7a713884a7e692b43b76b52c77130d9b42270,0,1
"} else if (Objects.equal(""Config"", kind) || Objects.equal(""List"", kind)) {",486c1170e21c2eaacbf15e34da4feb380dedc7ae,7,1
} else if (entity instanceof KubernetesList) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,6,0
} else if (object instanceof Collection) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,5,0
} if (entity instanceof List) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,5,1
"} else if (Objects.equal(""ReplicationController"", kind)) {",486c1170e21c2eaacbf15e34da4feb380dedc7ae,5,1
"} else if (Objects.equal(""Service"", kind)) {",486c1170e21c2eaacbf15e34da4feb380dedc7ae,5,1
"} else if (Objects.equal(""BuildConfig"", kind)) {",486c1170e21c2eaacbf15e34da4feb380dedc7ae,5,1
"} else if (Objects.equal(""DeploymentConfig"", kind)) {",486c1170e21c2eaacbf15e34da4feb380dedc7ae,5,1
"} else if (Objects.equal(""ImageRepository"", kind)) {",486c1170e21c2eaacbf15e34da4feb380dedc7ae,5,1
"} else if (Objects.equal(""Template"", kind)) {",486c1170e21c2eaacbf15e34da4feb380dedc7ae,5,1
if (entity instanceof List) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,4,0
if (entity instanceof JsonNode) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,4,1
} else if (object == null) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,4,1
if (item instanceof Service) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,3,0
} else {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,3,0
if (object instanceof KubernetesList) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,3,0
if (entity != null) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,3,1
} else {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,3,1
"if (Objects.equal(""Pod"", kind)) {",486c1170e21c2eaacbf15e34da4feb380dedc7ae,3,1
if (items instanceof ArrayNode) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,3,1
if (config instanceof ObjectNode) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,3,1
if (template instanceof ObjectNode) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,3,1
if (object instanceof JsonNode) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,3,1
if (items == null) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,0
if (object != list) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,0
if (item == null) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,0
if (Strings.isNotBlank(id)) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,0
if (!keys.add(key)) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,0
if (items != null) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,0
if (list == null) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,0
if (current == null) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,1
if (tree != null) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,1
if (kindNode != null) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,1
protected static Config loadList(byte[] data) throws IOException {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,1
if (item != null) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,1
if (kindObject != null && kindObject.isTextual()) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,1
if (kind != null) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,1
return entity;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,1
if (object != config) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,1
if (isTemplate(jsonNode)) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,1
if (template == null) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,1
if (template != null) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,1
if (!isTemplate(jsonNode)) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,1
if (isService(jsonNode)) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,1
if (Strings.isNotBlank(id)) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,1
if (!keys.add(key)) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,1
if (jsonNode != null) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,1
"return kind != null && Objects.equal(""Service"", kind.textValue());",486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,1
"return kind != null && Objects.equal(""Template"", kind.textValue());",486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,1
if (items != null && items.isArray()) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,2,1
return objectMapper.reader(Object.class).readValue(json);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,0
KubernetesList config = (KubernetesList) entity;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,0
return config.getItems();,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,0
public static Object combineJson(Object... objects) throws IOException {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,0
"return Templates.combineTemplates(list, items);",486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,0
protected static void moveServicesToFrontOfArray(List<Object> list) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,0
protected static void removeDuplicates(List<Object> itemArray) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,0
String kind = item.getClass().getSimpleName();,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,0
"String key = kind + "":"" + id;",486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,0
},486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,0
"protected static void addObjectsToItemArray(List destinationList, Object object) throws IOException {",486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,0
protected static KubernetesList findOrCreateList(Object[] objects) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,0
return list;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,0
TODO Config,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
public static String getId(JsonNode entity) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
return Strings.firstNonBlank(,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
return null;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
},486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
public static String getKind(JsonNode entity) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
"return getJsonTextProperty(entity, ""kind"");",486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
"protected static String getJsonTextProperty(JsonNode node, String... names) {",486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
for (String name : names) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
return current != null ? current.textValue() : null;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
* {@link JsonNode} if it cannot be recognised.,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
String kind = kindNode.asText();,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
"return loadEntity(json, kind, tree);",486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
return tree;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
JsonNode jsonNode = (JsonNode) entity;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
return toItemList(getEntity(jsonNode));,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
"protected static Object loadEntity(byte[] json, String kind, Object defaultValue) throws IOException {",486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
return objectMapper.reader(Pod.class).readValue(json);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
return objectMapper.reader(ReplicationController.class).readValue(json);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
return objectMapper.reader(Service.class).readValue(json);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
return objectMapper.reader(BuildConfig.class).readValue(json);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
return objectMapper.reader(DeploymentConfig.class).readValue(json);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
return objectMapper.reader(ImageRepository.class).readValue(json);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
return objectMapper.reader(Template.class).readValue(json);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
return loadList(json);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
return defaultValue;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
Config config = new Config();,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
for (JsonNode item : items) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
String kind = kindObject.asText();,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
String json = toJson(item);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
"Object entity = loadEntity(bytes, kind, null);",486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
return config;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
* Loads the entity for the given item,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
public static Object getEntity(JsonNode item) throws IOException {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
public static JsonNode combineJson(Object... objects) throws IOException {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
"return combineTemplates(config, itemArray);",486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
"protected static JsonNode combineTemplates(JsonNode config, ArrayNode itemArray) {",486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
JsonNode template = null;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
for (JsonNode jsonNode : config) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
template = jsonNode;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
// lets move all the content into the template,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
objects = (ArrayNode) items;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
objects = new ArrayNode(createNodeFactory());,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
"throw new IllegalArgumentException(""config "" + template + "" is not a ObjectNode"");",486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
return template;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
protected static void moveServicesToFrontOfArray(ArrayNode itemArray) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
protected static void removeDuplicates(ArrayNode itemArray) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
"String kind = Strings.defaultIfEmpty(getKind(jsonNode), """");",486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
"String key = kind + "":"" + id;",486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
protected static boolean isService(JsonNode jsonNode) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
"JsonNode kind = jsonNode.get(""kind"");",486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
return false;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
protected static boolean isTemplate(JsonNode jsonNode) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
"protected static void addObjectsToItemArray(ArrayNode itemArray, Object object) throws IOException {",486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
protected static JsonNodeFactory createNodeFactory() {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
return new JsonNodeFactory(false);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
protected static JsonNode findOrCreateConfig(Object[] objects) {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
return jsonNode;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
public static JsonNode toJsonNode(Object object) throws IOException {,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
return (JsonNode) object;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
String json = toJson(object);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
return objectMapper.reader().readTree(json);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,1,1
import io.fabric8.kubernetes.api.extensions.Templates;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
import java.util.Collection;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
* from the Kubernetes REST API,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
KubernetesList list = findOrCreateList(objects);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
List<Object> items = list.getItems();,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
items = new ArrayList<>();,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
list.setItems(items);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
"addObjectsToItemArray(items, object);",486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
moveServicesToFrontOfArray(items);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
removeDuplicates(items);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
int size = list.size();,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
Object item = list.get(i);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
Object nonService = list.get(lastNonService);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
"list.set(i, nonService);",486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
"list.set(lastNonService, item);",486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
* @param itemArray,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
Object item = itemArray.get(i);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
itemArray.remove(i);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
i--;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
size--;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
String id = getObjectId(item);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
// lets remove this one,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
KubernetesList kubernetesList = (KubernetesList) object;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
List<Object> items = kubernetesList.getItems();,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
destinationList.addAll(items);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
Collection collection = (Collection) object;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
destinationList.addAll(collection);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
destinationList.add(object);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
KubernetesList list = null;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
list = (KubernetesList) object;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
break;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
list = new KubernetesList();,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,0
import com.fasterxml.jackson.databind.JsonNode;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
import com.fasterxml.jackson.databind.ObjectReader;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
import com.fasterxml.jackson.databind.node.ArrayNode;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
import com.fasterxml.jackson.databind.node.JsonNodeFactory;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
import com.fasterxml.jackson.databind.node.ObjectNode;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
import io.fabric8.openshift.api.model.BuildConfig;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
import io.fabric8.openshift.api.model.DeploymentConfig;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
import io.fabric8.openshift.api.model.ImageRepository;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
import java.io.ByteArrayInputStream;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
import java.util.Iterator;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
/*,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
import io.fabric8.kubernetes.api.model.Item;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
import io.fabric8.kubernetes.api.model.Template;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
*/,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
"getJsonTextProperty(entity, ""metadata"", ""name""),",486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
"getJsonTextProperty(entity, ""metadata"", ""id""),",486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
"getJsonTextProperty(entity, ""name""),",486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
"getJsonTextProperty(entity, ""id""));",486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
JsonNode current = node;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
current = current.get(name);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
* from the Kubernetes REST API or,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
ObjectReader reader = objectMapper.reader();,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
JsonNode tree = reader.readTree(new ByteArrayInputStream(json));,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
"JsonNode kindNode = tree.get(""kind"");",486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
"LOG.warn(""No JSON type for: "" + tree);",486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
List<Object> itemList = new ArrayList<>();,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
config.setItems(itemList);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
JsonNode jsonNode = objectMapper.readTree(data);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
"JsonNode items = jsonNode.get(""items"");",486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
"JsonNode kindObject = item.get(""kind"");",486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
byte[] bytes = json.getBytes();,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
itemList.add(entity);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
/**,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
JsonNode config = findOrCreateConfig(objects);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
"JsonNode items = config.get(""items"");",486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
ArrayNode itemArray;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
itemArray = (ArrayNode) items;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
itemArray = new ArrayNode(createNodeFactory());,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
ObjectNode objectNode = (ObjectNode) config;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
"objectNode.set(""items"", itemArray);",486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
"throw new IllegalArgumentException(""config "" + config + "" is not a ObjectNode"");",486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
"addObjectsToItemArray(itemArray, object);",486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
moveServicesToFrontOfArray(itemArray);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
removeDuplicates(itemArray);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
* If we have any templates inside the itemArray then lets unpack them and combine any parameters,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
// TODO combine templates...,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
"JsonNode items = config.get(""objects"");",486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
ArrayNode objects;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
ObjectNode objectNode = (ObjectNode) template;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
"objectNode.set(""objects"", itemArray);",486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
objects.add(jsonNode);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
int size = itemArray.size();,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
JsonNode jsonNode = itemArray.get(i);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
JsonNode nonService = itemArray.get(lastNonService);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
"itemArray.set(i, nonService);",486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
"itemArray.set(lastNonService, jsonNode);",486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
String id = getId(jsonNode);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
// lets remove this one,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
itemArray.remove(i);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
i--;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
size--;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
JsonNode node = toJsonNode(object);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
"JsonNode items = node.get(""items"");",486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
Iterator<JsonNode> iter = items.iterator();,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
itemArray.add(item);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
itemArray.add(node);,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
JsonNode jsonNode = (JsonNode) object;,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
// lets create a new list,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
JsonNodeFactory factory = createNodeFactory();,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
ObjectNode config = factory.objectNode();,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
"config.set(""apiVersion"", factory.textNode(defaultApiVersion));",486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
"config.set(""kind"", factory.textNode(""List""));",486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
"config.set(""items"", factory.arrayNode());",486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
* Converts the DTO to a JsonNode,486c1170e21c2eaacbf15e34da4feb380dedc7ae,0,1
String kind = item.getClass().getSimpleName();,33a69c75d0d30c8de8f742fe5e31371108f836ce,3,0
"String key = kind + "":"" + id;",33a69c75d0d30c8de8f742fe5e31371108f836ce,3,0
public static String getId(JsonNode entity) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,3,1
public static String getKind(JsonNode entity) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,3,1
String kind = kindNode.asText();,33a69c75d0d30c8de8f742fe5e31371108f836ce,3,1
String kind = kindObject.asText();,33a69c75d0d30c8de8f742fe5e31371108f836ce,3,1
String json = toJson(item);,33a69c75d0d30c8de8f742fe5e31371108f836ce,3,1
"String kind = Strings.defaultIfEmpty(getKind(jsonNode), """");",33a69c75d0d30c8de8f742fe5e31371108f836ce,3,1
"String key = kind + "":"" + id;",33a69c75d0d30c8de8f742fe5e31371108f836ce,3,1
"JsonNode kind = jsonNode.get(""kind"");",33a69c75d0d30c8de8f742fe5e31371108f836ce,3,1
String json = toJson(object);,33a69c75d0d30c8de8f742fe5e31371108f836ce,3,1
} else if (entity instanceof KubernetesList) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,0
int size = list.size();,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,0
Object item = list.get(i);,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,0
Object item = itemArray.get(i);,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,0
} else {,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,0
String id = getObjectId(item);,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,0
} else if (object instanceof Collection) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,0
} else {,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
"protected static String getJsonTextProperty(JsonNode node, String... names) {",33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
JsonNode current = node;,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
JsonNode tree = reader.readTree(new ByteArrayInputStream(json));,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
"JsonNode kindNode = tree.get(""kind"");",33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
JsonNode jsonNode = (JsonNode) entity;,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
} if (entity instanceof List) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
"protected static Object loadEntity(byte[] json, String kind, Object defaultValue) throws IOException {",33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
"} else if (Objects.equal(""ReplicationController"", kind)) {",33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
"} else if (Objects.equal(""Service"", kind)) {",33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
"} else if (Objects.equal(""BuildConfig"", kind)) {",33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
"} else if (Objects.equal(""DeploymentConfig"", kind)) {",33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
"} else if (Objects.equal(""ImageRepository"", kind)) {",33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
"} else if (Objects.equal(""Template"", kind)) {",33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
"} else if (Objects.equal(""Config"", kind) || Objects.equal(""List"", kind)) {",33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
JsonNode jsonNode = objectMapper.readTree(data);,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
"JsonNode items = jsonNode.get(""items"");",33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
for (JsonNode item : items) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
"JsonNode kindObject = item.get(""kind"");",33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
if (kindObject != null && kindObject.isTextual()) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
"Object entity = loadEntity(bytes, kind, null);",33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
* Loads the entity for the given item,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
public static JsonNode combineJson(Object... objects) throws IOException {,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
JsonNode config = findOrCreateConfig(objects);,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
"JsonNode items = config.get(""items"");",33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
"protected static JsonNode combineTemplates(JsonNode config, ArrayNode itemArray) {",33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
JsonNode template = null;,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
"JsonNode items = config.get(""objects"");",33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
int size = itemArray.size();,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
JsonNode jsonNode = itemArray.get(i);,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
JsonNode nonService = itemArray.get(lastNonService);,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
String id = getId(jsonNode);,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
"return kind != null && Objects.equal(""Service"", kind.textValue());",33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
"return kind != null && Objects.equal(""Template"", kind.textValue());",33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
JsonNode node = toJsonNode(object);,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
"JsonNode items = node.get(""items"");",33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
if (items != null && items.isArray()) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
protected static JsonNode findOrCreateConfig(Object[] objects) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
JsonNode jsonNode = (JsonNode) object;,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
public static JsonNode toJsonNode(Object object) throws IOException {,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
} else if (object == null) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,2,1
if (entity instanceof List) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
KubernetesList config = (KubernetesList) entity;,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
public static Object combineJson(Object... objects) throws IOException {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
KubernetesList list = findOrCreateList(objects);,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
List<Object> items = list.getItems();,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
if (items == null) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
items = new ArrayList<>();,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
if (object != list) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
protected static void moveServicesToFrontOfArray(List<Object> list) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
if (item instanceof Service) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
Object nonService = list.get(lastNonService);,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
protected static void removeDuplicates(List<Object> itemArray) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
if (item == null) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
if (Strings.isNotBlank(id)) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
if (!keys.add(key)) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
},33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
"protected static void addObjectsToItemArray(List destinationList, Object object) throws IOException {",33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
if (object instanceof KubernetesList) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
KubernetesList kubernetesList = (KubernetesList) object;,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
List<Object> items = kubernetesList.getItems();,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
if (items != null) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
Collection collection = (Collection) object;,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
protected static KubernetesList findOrCreateList(Object[] objects) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
KubernetesList list = null;,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
list = (KubernetesList) object;,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
if (list == null) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
list = new KubernetesList();,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,0
if (entity != null) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
"getJsonTextProperty(entity, ""metadata"", ""name""),",33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
"getJsonTextProperty(entity, ""name""),",33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
},33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
for (String name : names) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
if (current == null) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
current = current.get(name);,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
return current != null ? current.textValue() : null;,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
ObjectReader reader = objectMapper.reader();,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
if (tree != null) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
if (kindNode != null) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
if (entity instanceof JsonNode) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
"if (Objects.equal(""Pod"", kind)) {",33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
protected static Config loadList(byte[] data) throws IOException {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
Config config = new Config();,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
List<Object> itemList = new ArrayList<>();,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
if (item != null) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
byte[] bytes = json.getBytes();,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
public static Object getEntity(JsonNode item) throws IOException {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
if (kind != null) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
if (items instanceof ArrayNode) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
itemArray = (ArrayNode) items;,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
itemArray = new ArrayNode(createNodeFactory());,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
if (config instanceof ObjectNode) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
ObjectNode objectNode = (ObjectNode) config;,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
if (object != config) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
for (JsonNode jsonNode : config) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
if (isTemplate(jsonNode)) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
if (template == null) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
template = jsonNode;,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
if (template != null) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
objects = (ArrayNode) items;,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
objects = new ArrayNode(createNodeFactory());,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
if (template instanceof ObjectNode) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
ObjectNode objectNode = (ObjectNode) template;,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
if (!isTemplate(jsonNode)) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
protected static void moveServicesToFrontOfArray(ArrayNode itemArray) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
if (isService(jsonNode)) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
protected static void removeDuplicates(ArrayNode itemArray) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
if (Strings.isNotBlank(id)) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
if (!keys.add(key)) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
protected static boolean isService(JsonNode jsonNode) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
if (jsonNode != null) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
protected static boolean isTemplate(JsonNode jsonNode) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
"protected static void addObjectsToItemArray(ArrayNode itemArray, Object object) throws IOException {",33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
Iterator<JsonNode> iter = items.iterator();,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
protected static JsonNodeFactory createNodeFactory() {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
if (object instanceof JsonNode) {,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
JsonNodeFactory factory = createNodeFactory();,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
ObjectNode config = factory.objectNode();,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
* Converts the DTO to a JsonNode,33a69c75d0d30c8de8f742fe5e31371108f836ce,1,1
import io.fabric8.kubernetes.api.extensions.Templates;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,0
import java.util.Collection;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,0
* from the Kubernetes REST API,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,0
return objectMapper.reader(Object.class).readValue(json);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,0
return config.getItems();,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,0
list.setItems(items);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,0
"addObjectsToItemArray(items, object);",33a69c75d0d30c8de8f742fe5e31371108f836ce,0,0
moveServicesToFrontOfArray(items);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,0
removeDuplicates(items);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,0
"return Templates.combineTemplates(list, items);",33a69c75d0d30c8de8f742fe5e31371108f836ce,0,0
"list.set(i, nonService);",33a69c75d0d30c8de8f742fe5e31371108f836ce,0,0
"list.set(lastNonService, item);",33a69c75d0d30c8de8f742fe5e31371108f836ce,0,0
* @param itemArray,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,0
itemArray.remove(i);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,0
i--;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,0
size--;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,0
// lets remove this one,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,0
destinationList.addAll(items);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,0
destinationList.addAll(collection);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,0
destinationList.add(object);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,0
break;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,0
return list;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,0
import com.fasterxml.jackson.databind.JsonNode;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
import com.fasterxml.jackson.databind.ObjectReader;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
import com.fasterxml.jackson.databind.node.ArrayNode;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
import com.fasterxml.jackson.databind.node.JsonNodeFactory;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
import com.fasterxml.jackson.databind.node.ObjectNode;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
import io.fabric8.openshift.api.model.BuildConfig;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
import io.fabric8.openshift.api.model.DeploymentConfig;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
import io.fabric8.openshift.api.model.ImageRepository;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
import java.io.ByteArrayInputStream;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
import java.util.Iterator;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
/*,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
TODO Config,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
import io.fabric8.kubernetes.api.model.Item;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
import io.fabric8.kubernetes.api.model.Template;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
*/,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
return Strings.firstNonBlank(,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
"getJsonTextProperty(entity, ""metadata"", ""id""),",33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
"getJsonTextProperty(entity, ""id""));",33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
return null;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
"return getJsonTextProperty(entity, ""kind"");",33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
* from the Kubernetes REST API or,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
* {@link JsonNode} if it cannot be recognised.,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
"return loadEntity(json, kind, tree);",33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
"LOG.warn(""No JSON type for: "" + tree);",33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
return tree;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
return toItemList(getEntity(jsonNode));,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
return objectMapper.reader(Pod.class).readValue(json);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
return objectMapper.reader(ReplicationController.class).readValue(json);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
return objectMapper.reader(Service.class).readValue(json);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
return objectMapper.reader(BuildConfig.class).readValue(json);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
return objectMapper.reader(DeploymentConfig.class).readValue(json);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
return objectMapper.reader(ImageRepository.class).readValue(json);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
return objectMapper.reader(Template.class).readValue(json);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
return loadList(json);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
return defaultValue;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
config.setItems(itemList);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
itemList.add(entity);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
return config;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
/**,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
return entity;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
ArrayNode itemArray;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
"objectNode.set(""items"", itemArray);",33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
"throw new IllegalArgumentException(""config "" + config + "" is not a ObjectNode"");",33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
"addObjectsToItemArray(itemArray, object);",33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
moveServicesToFrontOfArray(itemArray);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
removeDuplicates(itemArray);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
"return combineTemplates(config, itemArray);",33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
* If we have any templates inside the itemArray then lets unpack them and combine any parameters,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
// TODO combine templates...,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
// lets move all the content into the template,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
ArrayNode objects;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
"objectNode.set(""objects"", itemArray);",33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
"throw new IllegalArgumentException(""config "" + template + "" is not a ObjectNode"");",33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
objects.add(jsonNode);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
return template;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
"itemArray.set(i, nonService);",33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
"itemArray.set(lastNonService, jsonNode);",33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
// lets remove this one,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
itemArray.remove(i);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
i--;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
size--;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
return false;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
itemArray.add(item);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
itemArray.add(node);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
return new JsonNodeFactory(false);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
return jsonNode;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
// lets create a new list,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
"config.set(""apiVersion"", factory.textNode(defaultApiVersion));",33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
"config.set(""kind"", factory.textNode(""List""));",33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
"config.set(""items"", factory.arrayNode());",33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
return (JsonNode) object;,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
return objectMapper.reader().readTree(json);,33a69c75d0d30c8de8f742fe5e31371108f836ce,0,1
* Returns the resource version for the entity or null if it does not have one,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,6,0
"String key = kind + "":"" + id;",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,5,0
* Loads the entity for the given item,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,5,1
"throw new IllegalArgumentException(""config "" + config + "" is not a ObjectNode"");",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,5,1
"throw new IllegalArgumentException(""config "" + template + "" is not a ObjectNode"");",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,5,1
"String key = kind + "":"" + id;",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,5,1
} else if (entity instanceof KubernetesList) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,4,0
} else if (object instanceof Collection) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,4,0
"protected static Object loadEntity(byte[] json, String kind, Object defaultValue) throws IOException {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,4,1
"} else if (Objects.equal(""ReplicationController"", kind)) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,4,1
"} else if (Objects.equal(""Service"", kind)) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,4,1
"} else if (Objects.equal(""BuildConfig"", kind)) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,4,1
"} else if (Objects.equal(""DeploymentConfig"", kind)) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,4,1
"} else if (Objects.equal(""ImageRepository"", kind)) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,4,1
"} else if (Objects.equal(""Template"", kind)) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,4,1
"} else if (Objects.equal(""Config"", kind) || Objects.equal(""List"", kind)) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,4,1
* If we have any templates inside the itemArray then lets unpack them and combine any parameters,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,4,1
} else if (object == null) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,4,1
} else if (entity instanceof HasMetadata[]) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,4,0
} else if (object instanceof ReplicationController) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,4,1
} else if (object instanceof Service) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,4,1
} else if (object instanceof Route) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,4,1
} else if (entity instanceof Object[]) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,4,1
* from the Kubernetes REST API,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,0
Object item = list.get(i);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,0
Object item = itemArray.get(i);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,0
} else {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,0
String id = getObjectId(item);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,0
String kind = item.getClass().getSimpleName();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,0
} else {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
* from the Kubernetes REST API or,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
String kind = kindNode.asText();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
} if (entity instanceof List) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
"JsonNode items = jsonNode.get(""items"");",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
if (kindObject != null && kindObject.isTextual()) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
String kind = kindObject.asText();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
String json = toJson(item);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
"Object entity = loadEntity(bytes, kind, null);",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
JsonNode config = findOrCreateConfig(objects);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
"JsonNode items = config.get(""items"");",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
JsonNode template = null;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
if (template == null) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
if (template != null) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
// lets move all the content into the template,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
"JsonNode items = config.get(""objects"");",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
if (template instanceof ObjectNode) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
String id = getId(jsonNode);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
"String kind = Strings.defaultIfEmpty(getKind(jsonNode), """");",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
"JsonNode kind = jsonNode.get(""kind"");",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
"return kind != null && Objects.equal(""Service"", kind.textValue());",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
"return kind != null && Objects.equal(""Template"", kind.textValue());",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
"JsonNode items = node.get(""items"");",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
if (items != null && items.isArray()) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
* Converts the DTO to a JsonNode,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
String json = toJson(object);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
* Returns true if this entity has a valid non blank resourceVersion in its metadata,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,0
"public static void setName(HasMetadata entity, String namespace, String name) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,0
} else {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
"public static void setName(Route entity, String namespace, String name) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
"protected static Object getAdditionalProperty(Map<String, Object> additionalProperties, String name) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
Object item = list.get(i);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
Object item = itemArray.get(i);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
for (Object item : items) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
for (Object object : items) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
for (Object object : objects) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,3,1
if (entity instanceof List) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
KubernetesList config = (KubernetesList) entity;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
public static Object combineJson(Object... objects) throws IOException {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
List<Object> items = list.getItems();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
if (items == null) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
items = new ArrayList<>();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
if (object != list) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
if (item instanceof Service) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
Object nonService = list.get(lastNonService);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
if (item == null) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
if (Strings.isNotBlank(id)) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
if (!keys.add(key)) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
"protected static void addObjectsToItemArray(List destinationList, Object object) throws IOException {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
if (object instanceof KubernetesList) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
List<Object> items = kubernetesList.getItems();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
if (items != null) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
if (list == null) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
public static String getId(JsonNode entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
if (entity != null) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
public static String getKind(JsonNode entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
"protected static String getJsonTextProperty(JsonNode node, String... names) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
JsonNode current = node;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
if (current == null) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
return current != null ? current.textValue() : null;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
* {@link JsonNode} if it cannot be recognised.,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
JsonNode tree = reader.readTree(new ByteArrayInputStream(json));,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
if (tree != null) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
"JsonNode kindNode = tree.get(""kind"");",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
if (kindNode != null) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
"LOG.warn(""No JSON type for: "" + tree);",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
if (entity instanceof JsonNode) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
JsonNode jsonNode = (JsonNode) entity;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
"if (Objects.equal(""Pod"", kind)) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
Config config = new Config();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
JsonNode jsonNode = objectMapper.readTree(data);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
for (JsonNode item : items) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
if (item != null) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
"JsonNode kindObject = item.get(""kind"");",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
public static Object getEntity(JsonNode item) throws IOException {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
if (kind != null) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
public static JsonNode combineJson(Object... objects) throws IOException {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
if (items instanceof ArrayNode) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
if (config instanceof ObjectNode) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
if (object != config) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
"protected static JsonNode combineTemplates(JsonNode config, ArrayNode itemArray) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
if (isTemplate(jsonNode)) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
template = jsonNode;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
objects = (ArrayNode) items;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
objects = new ArrayNode(createNodeFactory());,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
if (!isTemplate(jsonNode)) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
JsonNode jsonNode = itemArray.get(i);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
if (isService(jsonNode)) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
JsonNode nonService = itemArray.get(lastNonService);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
if (Strings.isNotBlank(id)) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
if (!keys.add(key)) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
if (jsonNode != null) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
"protected static void addObjectsToItemArray(ArrayNode itemArray, Object object) throws IOException {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
JsonNode node = toJsonNode(object);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
protected static JsonNode findOrCreateConfig(Object[] objects) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
if (object instanceof JsonNode) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
JsonNode jsonNode = (JsonNode) object;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
ObjectNode config = factory.objectNode();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
public static JsonNode toJsonNode(Object object) throws IOException {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
if (object instanceof HasMetadata) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
public static String getResourceVersion(HasMetadata entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
if (entity != null) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
if (metadata != null) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
String resourceVersion = metadata.getResourceVersion();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
if (Strings.isNotBlank(resourceVersion)) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
public static String getName(HasMetadata entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
"public static void setName(HasMetadata entity, String name) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
"public static void setNamespace(HasMetadata entity, String namespace) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
public static String getNamespace(HasMetadata entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
if (entity instanceof HasMetadata) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
List<HasMetadata> items = list.getItems();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
HasMetadata item = list.get(i);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
HasMetadata item = itemArray.get(i);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
List<HasMetadata> items = kubernetesList.getItems();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
List<HasMetadata> items = toItemList(dto);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
if (object instanceof Pod) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
if (metadata == null) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
public static String getName(Pod entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
public static String getName(ReplicationController entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
if (entity != null) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
public static String getName(Service entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
public static String getName(OAuthClient entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
public static String getName(Route entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
public static String getName(Node entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
public static String getName(Template entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
public static String getName(ImageStream entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
public static String getName(Endpoints entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
"public static void setName(Pod entity, String name) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
"public static void setName(Service entity, String name) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
"public static void setName(ReplicationController entity, String name) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
"public static void setName(Template entity, String name) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
"public static void setNamespace(Template entity, String namespace) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
public static String getNamespace(Pod entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
public static String getNamespace(ReplicationController entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
public static String getNamespace(Service entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
public static String getNamespace(OAuthClient entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
public static String getNamespace(Route entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
public static String getNamespace(Template entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
if (additionalProperties != null) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
"protected static String getAdditionalNestedPropertyText(Map<String, Object> additionalProperties, String... names) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
for (int i = 0; i < lastIdx; i++) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
if (map == null) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
List<Object> items = list.getItems();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
Object nonService = list.get(lastNonService);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
List<Object> items = kubernetesList.getItems();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
List<Object> items = toItemList(dto);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
List<HasMetadata> items = kubernetesList.getItems();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
for (HasMetadata item : items) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
for (HasMetadata object : items) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
List<HasMetadata> objects = template.getObjects();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
for (HasMetadata object : objects) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
"public static Object combineTemplates(KubernetesList kubernetesList, List<HasMetadata> items) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,0
List<Object> items = kubernetesList.getItems();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
List<Object> objects = template.getObjects();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
"public static void addTemplateObject(Template template, Object object) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
"public static Object combineTemplates(KubernetesList kubernetesList, List<Object> items) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,2,1
import io.fabric8.kubernetes.api.extensions.Templates;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
import java.util.Collection;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
return objectMapper.reader(Object.class).readValue(json);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
return config.getItems();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
KubernetesList list = findOrCreateList(objects);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
"return Templates.combineTemplates(list, items);",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
protected static void moveServicesToFrontOfArray(List<Object> list) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
int size = list.size();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
* @param itemArray,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
protected static void removeDuplicates(List<Object> itemArray) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
},ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
KubernetesList kubernetesList = (KubernetesList) object;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
Collection collection = (Collection) object;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
protected static KubernetesList findOrCreateList(Object[] objects) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
KubernetesList list = null;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
list = (KubernetesList) object;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
list = new KubernetesList();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
return list;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
import com.fasterxml.jackson.databind.JsonNode;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
import com.fasterxml.jackson.databind.ObjectReader;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
import com.fasterxml.jackson.databind.node.ArrayNode;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
import com.fasterxml.jackson.databind.node.JsonNodeFactory;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
import com.fasterxml.jackson.databind.node.ObjectNode;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
import io.fabric8.openshift.api.model.BuildConfig;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
import io.fabric8.openshift.api.model.DeploymentConfig;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
import io.fabric8.openshift.api.model.ImageRepository;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
import java.io.ByteArrayInputStream;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
import java.util.Iterator;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
import io.fabric8.kubernetes.api.model.Item;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
import io.fabric8.kubernetes.api.model.Template;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return Strings.firstNonBlank(,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return null;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
},ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
"return getJsonTextProperty(entity, ""kind"");",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
for (String name : names) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
current = current.get(name);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
ObjectReader reader = objectMapper.reader();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
"return loadEntity(json, kind, tree);",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return tree;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return toItemList(getEntity(jsonNode));,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return objectMapper.reader(Pod.class).readValue(json);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return objectMapper.reader(ReplicationController.class).readValue(json);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return objectMapper.reader(Service.class).readValue(json);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return objectMapper.reader(BuildConfig.class).readValue(json);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return objectMapper.reader(DeploymentConfig.class).readValue(json);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return objectMapper.reader(ImageRepository.class).readValue(json);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return objectMapper.reader(Template.class).readValue(json);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return loadList(json);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return defaultValue;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
protected static Config loadList(byte[] data) throws IOException {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
List<Object> itemList = new ArrayList<>();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
byte[] bytes = json.getBytes();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return config;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return entity;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
itemArray = (ArrayNode) items;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
itemArray = new ArrayNode(createNodeFactory());,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
ObjectNode objectNode = (ObjectNode) config;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
"return combineTemplates(config, itemArray);",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
for (JsonNode jsonNode : config) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
// TODO combine templates...,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
ObjectNode objectNode = (ObjectNode) template;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return template;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
protected static void moveServicesToFrontOfArray(ArrayNode itemArray) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
int size = itemArray.size();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
protected static void removeDuplicates(ArrayNode itemArray) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
protected static boolean isService(JsonNode jsonNode) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return false;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
protected static boolean isTemplate(JsonNode jsonNode) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
Iterator<JsonNode> iter = items.iterator();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
protected static JsonNodeFactory createNodeFactory() {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return new JsonNodeFactory(false);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return jsonNode;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
JsonNodeFactory factory = createNodeFactory();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return (JsonNode) object;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return objectMapper.reader().readTree(json);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
import io.fabric8.kubernetes.api.model.HasMetadata;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
return getName((HasMetadata) object);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
public static ObjectMeta getOrCreateMetadata(HasMetadata entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
ObjectMeta metadata = entity.getMetadata();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
return resourceVersion;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
},ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
return null;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
public static boolean hasResourceVersion(HasMetadata entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
return getResourceVersion(entity) != null;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
return getName(entity.getMetadata());,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
ObjectMeta metadata = getOrCreateMetadata(entity);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
return getNamespace(entity.getMetadata());,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
"public static Map<String, String> getLabels(HasMetadata entity) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
return getLabels(entity.getMetadata());,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
return Collections.EMPTY_MAP;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
public static List<HasMetadata> toItemList(Object entity) throws IOException {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
return (List<HasMetadata>) entity;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
HasMetadata[] array = (HasMetadata[]) entity;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
List<HasMetadata> answer = new ArrayList<>();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
public static void moveServicesToFrontOfArray(List<HasMetadata> list) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
HasMetadata nonService = list.get(lastNonService);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
protected static void removeDuplicates(List<HasMetadata> itemArray) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
return getName((Pod) object);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return getName((ReplicationController) object);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return getName((Service) object);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return getName((Route) object);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
public static ObjectMeta getOrCreateMetadata(Pod entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
ObjectMeta metadata = entity.getMetadata();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
metadata = new ObjectMeta();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
},ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return metadata;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
public static ObjectMeta getOrCreateMetadata(ReplicationController entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
public static ObjectMeta getOrCreateMetadata(Service entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
public static ObjectMeta getOrCreateMetadata(Namespace entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
public static ObjectMeta getOrCreateMetadata(Route entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
public static ObjectMeta getOrCreateMetadata(Build entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
public static ObjectMeta getOrCreateMetadata(BuildConfig entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
public static ObjectMeta getOrCreateMetadata(DeploymentConfig entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
public static ObjectMeta getOrCreateMetadata(ImageStream entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
public static ObjectMeta getOrCreateMetadata(OAuthClient entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
public static ObjectMeta getOrCreateMetadata(Template entity) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
"return Strings.firstNonBlank(getName(entity.getMetadata()),",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return null;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
ObjectMeta objectMeta = getOrCreateMetadata(entity);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
"return Strings.firstNonBlank(getNamespace(entity.getMetadata()),",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return additionalProperties.get(name);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
int lastIdx = names.length - 1;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
"Map<String, Object> map = additionalProperties;",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
"map = getAdditionalPropertyMap(map, names[i]);",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
"return getAdditionalPropertyText(map, names[lastIdx]);",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
public static List<Object> toItemList(Object entity) throws IOException {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
return (List<Object>) entity;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
Object[] array = (Object[]) entity;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
List<Object> answer = new ArrayList<>();,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
public static void moveServicesToFrontOfArray(List<Object> list) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
protected static void removeDuplicates(List<Object> itemArray) {,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
import io.fabric8.kubernetes.api.model.HasMetadata;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
"public static void addTemplateObject(Template template, HasMetadata object) {",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
List<HasMetadata> list = KubernetesHelper.toItemList(kubeResource);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,0
List<Object> list = KubernetesHelper.toItemList(kubeResource);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,1,1
list.setItems(items);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,0
"addObjectsToItemArray(items, object);",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,0
moveServicesToFrontOfArray(items);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,0
removeDuplicates(items);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,0
"list.set(i, nonService);",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,0
"list.set(lastNonService, item);",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,0
itemArray.remove(i);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,0
i--;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,0
size--;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,0
// lets remove this one,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,0
destinationList.addAll(items);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,0
destinationList.addAll(collection);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,0
destinationList.add(object);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,0
break;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,0
/*,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
TODO Config,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
*/,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
"getJsonTextProperty(entity, ""metadata"", ""name""),",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
"getJsonTextProperty(entity, ""metadata"", ""id""),",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
"getJsonTextProperty(entity, ""name""),",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
"getJsonTextProperty(entity, ""id""));",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
config.setItems(itemList);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
itemList.add(entity);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
/**,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
ArrayNode itemArray;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
"objectNode.set(""items"", itemArray);",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
"addObjectsToItemArray(itemArray, object);",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
moveServicesToFrontOfArray(itemArray);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
removeDuplicates(itemArray);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
ArrayNode objects;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
"objectNode.set(""objects"", itemArray);",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
objects.add(jsonNode);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
"itemArray.set(i, nonService);",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
"itemArray.set(lastNonService, jsonNode);",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
// lets remove this one,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
itemArray.remove(i);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
i--;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
size--;,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
itemArray.add(item);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
itemArray.add(node);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
// lets create a new list,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
"config.set(""apiVersion"", factory.textNode(defaultApiVersion));",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
"config.set(""kind"", factory.textNode(""List""));",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
"config.set(""items"", factory.arrayNode());",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
/**,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,0
*/,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,0
metadata.setNamespace(namespace);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,0
metadata.setName(name);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,0
answer.add((HasMetadata) entity);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,0
entity.setMetadata(metadata);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
"getAdditionalPropertyText(entity.getAdditionalProperties(), ""name""),",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""name""),",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""id"")",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
getOrCreateMetadata(entity).setName(name);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
objectMeta.setNamespace(namespace);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
objectMeta.setName(name);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
"getAdditionalPropertyText(entity.getAdditionalProperties(), ""namespace""),",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""namespace""));",ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
answer.add(answer);,ace336a657f1b61b392bb3b5f84e24b5909ebcd0,0,1
"LOG.info(""Creating Route "" + namespace + "":"" + id + "" "" + KubernetesHelper.summaryText(entity));",f3a75f92199175656a3496a159bb7dec7cd1b066,13,0
"LOG.info(""Creating Route "" + namespace + "":"" + id);",f3a75f92199175656a3496a159bb7dec7cd1b066,9,1
"onApplyError(""Failed to create config from "" + sourceName + "". "" + e, e);",f3a75f92199175656a3496a159bb7dec7cd1b066,6,1
"public void applyList(KubernetesList list, String sourceName) throws Exception {",f3a75f92199175656a3496a159bb7dec7cd1b066,5,0
"LOG.warn(""Unknown JSON type "" + kindNode + "". JSON: "" + tree);",f3a75f92199175656a3496a159bb7dec7cd1b066,5,1
"public void applyList(JsonNode entity, String sourceName) throws Exception {",f3a75f92199175656a3496a159bb7dec7cd1b066,5,1
"onApplyError(""Failed to process "" + json + "". "" + e, e);",f3a75f92199175656a3496a159bb7dec7cd1b066,5,1
for (Object entity : entities) {,f3a75f92199175656a3496a159bb7dec7cd1b066,2,0
"Template template = createObjectMapper().treeToValue(tree, Template.class);",f3a75f92199175656a3496a159bb7dec7cd1b066,2,1
"LOG.warn(""No JSON kind for: "" + tree);",f3a75f92199175656a3496a159bb7dec7cd1b066,2,1
import io.fabric8.kubernetes.api.model.KubernetesList;,f3a75f92199175656a3496a159bb7dec7cd1b066,1,0
} else if (dto instanceof KubernetesList) {,f3a75f92199175656a3496a159bb7dec7cd1b066,1,0
"applyList((KubernetesList) dto, sourceName);",f3a75f92199175656a3496a159bb7dec7cd1b066,1,0
if (entities != null) {,f3a75f92199175656a3496a159bb7dec7cd1b066,1,0
"applyEntity(entity, sourceName);",f3a75f92199175656a3496a159bb7dec7cd1b066,1,0
import com.fasterxml.jackson.databind.JsonNode;,f3a75f92199175656a3496a159bb7dec7cd1b066,1,1
import io.fabric8.utils.Objects;,f3a75f92199175656a3496a159bb7dec7cd1b066,1,1
import java.io.IOException;,f3a75f92199175656a3496a159bb7dec7cd1b066,1,1
import static io.fabric8.kubernetes.api.KubernetesFactory.createObjectMapper;,f3a75f92199175656a3496a159bb7dec7cd1b066,1,1
} else if (dto instanceof JsonNode) {,f3a75f92199175656a3496a159bb7dec7cd1b066,1,1
JsonNode tree = (JsonNode) dto;,f3a75f92199175656a3496a159bb7dec7cd1b066,1,1
if (kindNode != null) {,f3a75f92199175656a3496a159bb7dec7cd1b066,1,1
String kind = kindNode.asText();,f3a75f92199175656a3496a159bb7dec7cd1b066,1,1
"if (Objects.equal(""Config"", kind) || Objects.equal(""List"", kind)) {",f3a75f92199175656a3496a159bb7dec7cd1b066,1,1
"applyList(tree, sourceName);",f3a75f92199175656a3496a159bb7dec7cd1b066,1,1
"} else if (Objects.equal(""Template"", kind)) {",f3a75f92199175656a3496a159bb7dec7cd1b066,1,1
"applyTemplate(template, sourceName);",f3a75f92199175656a3496a159bb7dec7cd1b066,1,1
} else {,f3a75f92199175656a3496a159bb7dec7cd1b066,1,1
if (items != null) {,f3a75f92199175656a3496a159bb7dec7cd1b066,1,1
for (JsonNode item : items) {,f3a75f92199175656a3496a159bb7dec7cd1b066,1,1
// TODO the apply method should deal with the item direct?,f3a75f92199175656a3496a159bb7dec7cd1b066,1,1
String json = item.toString();,f3a75f92199175656a3496a159bb7dec7cd1b066,1,1
Object dto = null;,f3a75f92199175656a3496a159bb7dec7cd1b066,1,1
try {,f3a75f92199175656a3496a159bb7dec7cd1b066,1,1
} catch (IOException e) {,f3a75f92199175656a3496a159bb7dec7cd1b066,1,1
if (dto != null) {,f3a75f92199175656a3496a159bb7dec7cd1b066,1,1
"apply(dto, sourceName);",f3a75f92199175656a3496a159bb7dec7cd1b066,1,1
} catch (Exception e) {,f3a75f92199175656a3496a159bb7dec7cd1b066,1,1
import io.fabric8.openshift.api.model.RouteSpec;,f3a75f92199175656a3496a159bb7dec7cd1b066,1,0
List<Object> entities = list.getItems();,f3a75f92199175656a3496a159bb7dec7cd1b066,0,0
},f3a75f92199175656a3496a159bb7dec7cd1b066,0,0
"JsonNode kindNode = tree.get(""kind"");",f3a75f92199175656a3496a159bb7dec7cd1b066,0,1
},f3a75f92199175656a3496a159bb7dec7cd1b066,0,1
"JsonNode items = entity.get(""items"");",f3a75f92199175656a3496a159bb7dec7cd1b066,0,1
// lets parse into a new object,f3a75f92199175656a3496a159bb7dec7cd1b066,0,1
"LOG.debug(""Got item: {}"", json);",f3a75f92199175656a3496a159bb7dec7cd1b066,0,1
dto = loadJson(json);,f3a75f92199175656a3496a159bb7dec7cd1b066,0,1
/*,f3a75f92199175656a3496a159bb7dec7cd1b066,0,1
kubernetes.createConfig(entity);,f3a75f92199175656a3496a159bb7dec7cd1b066,0,1
*/,f3a75f92199175656a3496a159bb7dec7cd1b066,0,1
* Returns the resource version for the entity or null if it does not have one,9858948fb5d76d8f4c2e177d30019116d1ec820d,6,0
} else if (object instanceof ReplicationController) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,6,1
} else if (object instanceof Service) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,6,1
} else if (object instanceof Route) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,6,1
} else if (entity instanceof HasMetadata[]) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,5,0
for (int i = 0; i < lastIdx; i++) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,5,1
} else if (entity instanceof Object[]) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,5,1
for (Object item : items) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,5,1
for (Object object : items) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,5,1
for (Object object : list) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,4,1
if (object instanceof HasMetadata) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,4,0
if (object instanceof Pod) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,4,1
for (HasMetadata item : items) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,4,0
for (HasMetadata object : items) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,4,0
for (Object object : objects) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,4,1
"public static Object combineTemplates(KubernetesList kubernetesList, List<Object> items) {",9858948fb5d76d8f4c2e177d30019116d1ec820d,4,1
"writer.println(""import "" + className + "";"");",9858948fb5d76d8f4c2e177d30019116d1ec820d,3,0
"for (Map.Entry<String, String> entry : entries) {",9858948fb5d76d8f4c2e177d30019116d1ec820d,3,1
"writer.println(""import "" + entry.getValue() + "";"");",9858948fb5d76d8f4c2e177d30019116d1ec820d,3,1
for (HasMetadata object : list) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,3,0
List<Object> list = toItemList(kubeResource);,9858948fb5d76d8f4c2e177d30019116d1ec820d,3,1
List<Object> entities = list.getItems();,9858948fb5d76d8f4c2e177d30019116d1ec820d,3,1
* Returns true if this entity has a valid non blank resourceVersion in its metadata,9858948fb5d76d8f4c2e177d30019116d1ec820d,3,0
"public static void setName(HasMetadata entity, String namespace, String name) {",9858948fb5d76d8f4c2e177d30019116d1ec820d,3,0
if (entity instanceof HasMetadata) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,3,0
} else {,9858948fb5d76d8f4c2e177d30019116d1ec820d,3,1
"public static void setName(Route entity, String namespace, String name) {",9858948fb5d76d8f4c2e177d30019116d1ec820d,3,1
"protected static Object getAdditionalProperty(Map<String, Object> additionalProperties, String name) {",9858948fb5d76d8f4c2e177d30019116d1ec820d,3,1
List<Object> items = list.getItems();,9858948fb5d76d8f4c2e177d30019116d1ec820d,3,1
Object item = list.get(i);,9858948fb5d76d8f4c2e177d30019116d1ec820d,3,1
Object item = itemArray.get(i);,9858948fb5d76d8f4c2e177d30019116d1ec820d,3,1
List<Object> items = kubernetesList.getItems();,9858948fb5d76d8f4c2e177d30019116d1ec820d,3,1
List<Object> items = toItemList(dto);,9858948fb5d76d8f4c2e177d30019116d1ec820d,3,1
for (HasMetadata object : objects) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,3,0
"public static Object combineTemplates(KubernetesList kubernetesList, List<HasMetadata> items) {",9858948fb5d76d8f4c2e177d30019116d1ec820d,3,0
List<Object> items = kubernetesList.getItems();,9858948fb5d76d8f4c2e177d30019116d1ec820d,3,1
List<Object> items = podList.getItems();,9858948fb5d76d8f4c2e177d30019116d1ec820d,3,1
for (String className : classNames) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,0
List<HasMetadata> list = toItemList(kubeResource);,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,0
List<HasMetadata> entities = list.getItems();,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,0
public static String getResourceVersion(HasMetadata entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,0
if (entity != null) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,0
if (metadata != null) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,0
String resourceVersion = metadata.getResourceVersion();,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,0
if (Strings.isNotBlank(resourceVersion)) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,0
public static String getName(HasMetadata entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,0
"public static void setName(HasMetadata entity, String name) {",9858948fb5d76d8f4c2e177d30019116d1ec820d,2,0
"public static void setNamespace(HasMetadata entity, String namespace) {",9858948fb5d76d8f4c2e177d30019116d1ec820d,2,0
public static String getNamespace(HasMetadata entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,0
List<HasMetadata> items = list.getItems();,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,0
HasMetadata item = list.get(i);,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,0
HasMetadata item = itemArray.get(i);,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,0
List<HasMetadata> items = kubernetesList.getItems();,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,0
List<HasMetadata> items = toItemList(dto);,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,0
if (metadata == null) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
public static String getName(Pod entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
public static String getName(ReplicationController entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
if (entity != null) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
public static String getName(Service entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
public static String getName(OAuthClient entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
public static String getName(Route entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
public static String getName(Node entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
public static String getName(Template entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
public static String getName(ImageStream entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
public static String getName(Endpoints entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
"public static void setName(Pod entity, String name) {",9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
"public static void setName(Service entity, String name) {",9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
"public static void setName(ReplicationController entity, String name) {",9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
"public static void setName(Template entity, String name) {",9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
"public static void setNamespace(Template entity, String namespace) {",9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
public static String getNamespace(Pod entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
public static String getNamespace(ReplicationController entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
public static String getNamespace(Service entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
public static String getNamespace(OAuthClient entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
public static String getNamespace(Route entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
public static String getNamespace(Template entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
if (additionalProperties != null) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
"protected static String getAdditionalNestedPropertyText(Map<String, Object> additionalProperties, String... names) {",9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
"Map<String, Object> map = additionalProperties;",9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
if (map == null) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
"map = getAdditionalPropertyMap(map, names[i]);",9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
public static List<Object> toItemList(Object entity) throws IOException {,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
List<Object> answer = new ArrayList<>();,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
Object nonService = list.get(lastNonService);,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
List<HasMetadata> items = kubernetesList.getItems();,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,0
List<Object> objects = template.getObjects();,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
"public static void addTemplateObject(Template template, Object object) {",9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
List<HasMetadata> items = podList.getItems();,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,0
List<Object> objects = template.getObjects();,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
List<Object> objects = list.getItems();,9858948fb5d76d8f4c2e177d30019116d1ec820d,2,1
import io.fabric8.kubernetes.api.model.VolumeSource;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.base.Capabilities;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.base.Container;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.base.ContainerPort;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.base.EmptyDirVolumeSource;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.base.EnvVar;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.base.ExecAction;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.base.GCEPersistentDiskVolumeSource;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.base.GitRepoVolumeSource;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.base.GlusterfsVolumeSource;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.base.HTTPGetAction;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.base.Handler;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.base.HostPathVolumeSource;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.base.ISCSIVolumeSource;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.base.Lifecycle;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.base.NFSVolumeSource;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.base.ObjectReference;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.base.PodSpec;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.base.PodTemplateSpec;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.base.Probe;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.base.ReplicationControllerSpec;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.base.ResourceRequirements;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.base.SecretVolumeSource;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.base.Volume;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.base.VolumeMount;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.errors.StatusError;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.resource.Quantity;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.runtime.RawExtension;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.util.IntOrString;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.Build;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.BuildConfig;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.BuildConfigList;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.BuildList;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.BuildOutput;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.BuildParameters;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.BuildSource;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.BuildStrategy;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.BuildTriggerPolicy;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.CustomBuildStrategy;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.CustomDeploymentStrategyParams;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.Deployment;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.DeploymentCause;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.DeploymentCauseImageTrigger;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.DeploymentConfig;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.DeploymentConfigList;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.DeploymentDetails;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.DeploymentList;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.DeploymentStrategy;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.DeploymentTemplate;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.DeploymentTriggerImageChangeParams;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.DeploymentTriggerPolicy;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.DockerBuildStrategy;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.DockerConfig;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.DockerImage;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.ExecNewPodHook;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.GitBuildSource;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.GitSourceRevision;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.Image;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.ImageChangeTrigger;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.ImageList;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.ImageRepository;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.ImageRepositoryList;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.ImageRepositoryStatus;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.LifecycleHook;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.RecreateDeploymentStrategyParams;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.Route;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.RouteList;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.STIBuildStrategy;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.SourceControlUser;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.SourceRevision;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.config.Config;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.template.Parameter;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.template.Template;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.openshift.api.model.Build;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.BuildConfig;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.BuildConfigList;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.BuildList;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.BuildOutput;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.BuildParameters;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.BuildSource;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.BuildStrategy;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.BuildTriggerPolicy;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.base.Capabilities;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.config.Config;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.base.Container;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.base.ContainerPort;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.CustomBuildStrategy;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.CustomDeploymentStrategyParams;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.Deployment;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.DeploymentCause;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.DeploymentCauseImageTrigger;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.DeploymentConfig;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.DeploymentConfigList;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.DeploymentDetails;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.DeploymentList;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.DeploymentStrategy;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.DeploymentTemplate;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.DeploymentTriggerImageChangeParams;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.DeploymentTriggerPolicy;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.DockerBuildStrategy;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.DockerConfig;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.DockerImage;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.base.EmptyDirVolumeSource;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.base.EnvVar;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.base.ExecAction;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.ExecNewPodHook;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.base.GCEPersistentDiskVolumeSource;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.GitBuildSource;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.base.GitRepoVolumeSource;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.GitSourceRevision;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.base.GlusterfsVolumeSource;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.base.HTTPGetAction;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.base.Handler;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.base.HostPathVolumeSource;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.base.ISCSIVolumeSource;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.Image;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.ImageChangeTrigger;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.ImageList;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.ImageRepository;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.ImageRepositoryList;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.ImageRepositoryStatus;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.util.IntOrString;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.base.Lifecycle;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.LifecycleHook;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.base.NFSVolumeSource;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.base.ObjectReference;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.template.Parameter;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.base.PodSpec;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.base.PodTemplateSpec;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.base.Probe;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.resource.Quantity;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.runtime.RawExtension;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.RecreateDeploymentStrategyParams;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.base.ReplicationControllerSpec;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.base.ResourceRequirements;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.Route;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.RouteList;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.STIBuildStrategy;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.base.SecretVolumeSource;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.SourceControlUser;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.SourceRevision;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.errors.StatusError;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.openshift.api.model.template.Template;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.base.Volume;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.base.VolumeMount;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.VolumeSource;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import java.util.SortedSet;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import java.util.TreeSet;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
SortedSet<String> classNames = new TreeSet<>(sortedMap.values());,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.HasMetadata;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
import io.fabric8.kubernetes.api.model.HasMetadata;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
public static ObjectMeta getOrCreateMetadata(HasMetadata entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
ObjectMeta metadata = entity.getMetadata();,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
},9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
public static boolean hasResourceVersion(HasMetadata entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
ObjectMeta metadata = getOrCreateMetadata(entity);,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
"public static Map<String, String> getLabels(HasMetadata entity) {",9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
public static List<HasMetadata> toItemList(Object entity) throws IOException {,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
HasMetadata[] array = (HasMetadata[]) entity;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
List<HasMetadata> answer = new ArrayList<>();,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
public static void moveServicesToFrontOfArray(List<HasMetadata> list) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
HasMetadata nonService = list.get(lastNonService);,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
protected static void removeDuplicates(List<HasMetadata> itemArray) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
public static ObjectMeta getOrCreateMetadata(Pod entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
ObjectMeta metadata = entity.getMetadata();,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
metadata = new ObjectMeta();,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
},9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
public static ObjectMeta getOrCreateMetadata(ReplicationController entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
public static ObjectMeta getOrCreateMetadata(Service entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
public static ObjectMeta getOrCreateMetadata(Namespace entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
public static ObjectMeta getOrCreateMetadata(Route entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
public static ObjectMeta getOrCreateMetadata(Build entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
public static ObjectMeta getOrCreateMetadata(BuildConfig entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
public static ObjectMeta getOrCreateMetadata(DeploymentConfig entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
public static ObjectMeta getOrCreateMetadata(ImageStream entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
public static ObjectMeta getOrCreateMetadata(OAuthClient entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
public static ObjectMeta getOrCreateMetadata(Template entity) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
ObjectMeta objectMeta = getOrCreateMetadata(entity);,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
int lastIdx = names.length - 1;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
Object[] array = (Object[]) entity;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
public static void moveServicesToFrontOfArray(List<Object> list) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
protected static void removeDuplicates(List<Object> itemArray) {,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,1
import io.fabric8.kubernetes.api.model.HasMetadata;,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
List<HasMetadata> objects = template.getObjects();,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
"public static void addTemplateObject(Template template, HasMetadata object) {",9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
List<HasMetadata> objects = template.getObjects();,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
List<HasMetadata> objects = list.getItems();,9858948fb5d76d8f4c2e177d30019116d1ec820d,1,0
return getName((HasMetadata) object);,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,0
/**,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,0
*/,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,0
return resourceVersion;,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,0
return null;,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,0
return getResourceVersion(entity) != null;,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,0
return getName(entity.getMetadata());,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,0
metadata.setNamespace(namespace);,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,0
metadata.setName(name);,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,0
return getNamespace(entity.getMetadata());,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,0
return getLabels(entity.getMetadata());,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,0
return Collections.EMPTY_MAP;,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,0
return (List<HasMetadata>) entity;,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,0
answer.add((HasMetadata) entity);,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,0
return getName((Pod) object);,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,1
return getName((ReplicationController) object);,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,1
return getName((Service) object);,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,1
return getName((Route) object);,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,1
entity.setMetadata(metadata);,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,1
return metadata;,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,1
"return Strings.firstNonBlank(getName(entity.getMetadata()),",9858948fb5d76d8f4c2e177d30019116d1ec820d,0,1
"getAdditionalPropertyText(entity.getAdditionalProperties(), ""name""),",9858948fb5d76d8f4c2e177d30019116d1ec820d,0,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""name""),",9858948fb5d76d8f4c2e177d30019116d1ec820d,0,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""id"")",9858948fb5d76d8f4c2e177d30019116d1ec820d,0,1
);,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,1
return null;,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,1
getOrCreateMetadata(entity).setName(name);,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,1
objectMeta.setNamespace(namespace);,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,1
objectMeta.setName(name);,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,1
"return Strings.firstNonBlank(getNamespace(entity.getMetadata()),",9858948fb5d76d8f4c2e177d30019116d1ec820d,0,1
"getAdditionalPropertyText(entity.getAdditionalProperties(), ""namespace""),",9858948fb5d76d8f4c2e177d30019116d1ec820d,0,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""namespace""));",9858948fb5d76d8f4c2e177d30019116d1ec820d,0,1
return additionalProperties.get(name);,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,1
"return getAdditionalPropertyText(map, names[lastIdx]);",9858948fb5d76d8f4c2e177d30019116d1ec820d,0,1
return (List<Object>) entity;,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,1
answer.add(answer);,9858948fb5d76d8f4c2e177d30019116d1ec820d,0,1
import io.fabric8.kubernetes.api.model.EnvVar;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,2,1
// TODO add builderImage,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,2,1
import io.fabric8.kubernetes.api.model.EnvVar;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,2,1
*/,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import io.fabric8.openshift.api.model.BuildConfig;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import io.fabric8.openshift.api.model.BuildConfigBuilder;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import io.fabric8.openshift.api.model.BuildConfigSpec;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import io.fabric8.openshift.api.model.BuildConfigSpecBuilder;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import io.fabric8.openshift.api.model.ImageStream;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import io.fabric8.openshift.api.model.ImageStreamBuilder;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import io.fabric8.utils.Strings;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import java.util.HashMap;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import java.util.List;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import java.util.Map;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
return answer;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
return new ImageStreamBuilder().,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
return builder.,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
return new BuildConfigBuilder().,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
return buildConfigBuilder.withSpec(specBuilder.build()).build();,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
*/,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import io.fabric8.kubernetes.api.Controller;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import io.fabric8.kubernetes.api.builders.ListEnvVarBuilder;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import io.fabric8.kubernetes.api.builds.Builds;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import io.fabric8.openshift.api.model.BuildConfig;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import io.fabric8.openshift.api.model.ImageStream;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import io.fabric8.utils.Objects;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import org.apache.maven.model.Model;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import org.jboss.forge.addon.ui.context.UIContext;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import org.jboss.forge.addon.ui.input.UIInput;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import org.jboss.forge.addon.ui.result.Result;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import org.jboss.forge.addon.ui.result.Results;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import org.jboss.forge.addon.ui.util.Categories;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import org.jboss.forge.addon.ui.util.Metadata;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import org.slf4j.Logger;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import org.slf4j.LoggerFactory;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import javax.inject.Inject;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import java.util.List;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import java.util.Map;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import java.util.concurrent.Callable;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
import static io.fabric8.utils.cxf.JsonHelper.toJson;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
"return Metadata.from(super.getMetadata(context), getClass())",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
"return mavenModel.getArtifactId() + ""-int-test"";",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
return null;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
"return Results.success(""Added BuildConfig: "" + Builds.getName(buildConfig) + "" to OpenShift at master: "" + getKubernetes().getMasterUrl());",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
return builder.build();,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,1,1
/**,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
*,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"*  Red Hat licenses this file to you under the Apache License, version",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
*  with the License.  You may obtain a copy of the License at,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"*  Unless required by applicable law or agreed to in writing, software",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
*  implied.  See the License for the specific language governing,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
*  permissions and limitations under the License.,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
package io.fabric8.forge.devops;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
public class BuildConfigs {,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"public static Map<String, String> createBuildLabels(String buildName) {",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"Map<String, String> answer = new HashMap<>();",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"answer.put(""name"", buildName);",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
},957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"public static ImageStream imageRepository(String buildName, Map<String, String> labels) {",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
withNewMetadata().withLabels(labels).withName(buildName).endMetadata().,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
build();,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"public static BuildConfigSpec addBuildParameterOutput(BuildConfigSpecBuilder builder, String imageName) {",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
withNewOutput().,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"withNewTo().withKind(""ImageStreamImage"").withName(imageName).endTo().",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
endOutput().,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"public static BuildConfigSpec addBuildParameterGitSource(BuildConfigSpecBuilder builder, String gitUrl) {",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
withNewSource().,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"withType(""Git"").",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
withNewGit().withUri(gitUrl).endGit().,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
endSource().,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"public static BuildConfigSpecBuilder addBuildConfigSpectiStrategy(BuildConfigSpecBuilder builder, String image) {",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
withNewStrategy().,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"withType(""STI"").",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
withNewSourceStrategy().,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"withNewFrom().withName(image).withKind(""ImageStreamImage"").endFrom().",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
endSourceStrategy().,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
endStrategy();,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"public static BuildConfigSpecBuilder addBuildParameterCustomStrategy(BuildConfigSpecBuilder builder, String image, List<EnvVar> envVars) {",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"withType(""Custom"").",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
withNewCustomStrategy().,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
withEnv(envVars).,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
endCustomStrategy().,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"public static BuildConfigSpecBuilder addWebHookTriggers(BuildConfigSpecBuilder builder, String secret) {",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
addNewTrigger().,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"withType(""github"").",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
withNewGithub().withSecret(secret).endGithub().,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
endTrigger().,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"withType(""generic"").",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
withNewGeneric().withSecret(secret).endGeneric().,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
endTrigger();,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"public static BuildConfigBuilder buildConfigBuilder(String buildName, Map<String, String> labels) {",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
withNewMetadata().withLabels(labels).withName(buildName).endMetadata();,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"public static BuildConfig createBuildConfig(String buildConfigName, Map<String, String> labels, String gitUrlText, String outputImageStreamName, String imageText, String webhookSecret) {",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"BuildConfigBuilder buildConfigBuilder = buildConfigBuilder(buildConfigName, labels);",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
BuildConfigSpecBuilder specBuilder = new BuildConfigSpecBuilder();,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"addBuildParameterGitSource(specBuilder, gitUrlText);",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
if (Strings.isNotBlank(outputImageStreamName)) {,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"addBuildParameterOutput(specBuilder, outputImageStreamName);",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
if (Strings.isNotBlank(imageText)) {,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"addBuildConfigSpectiStrategy(specBuilder, imageText);",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
if (Strings.isNotBlank(webhookSecret)) {,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"addWebHookTriggers(specBuilder, webhookSecret);",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"public static BuildConfig createIntegrationTestBuildConfig(String buildConfigName, Map<String, String> labels, String gitUrlText, String image, List<EnvVar> envVars) {",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
if (Strings.isNotBlank(image)) {,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"addBuildParameterCustomStrategy(specBuilder, image, envVars);",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
/**,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
*,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"*  Red Hat licenses this file to you under the Apache License, version",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
*  with the License.  You may obtain a copy of the License at,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"*  Unless required by applicable law or agreed to in writing, software",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
*  implied.  See the License for the specific language governing,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
*  permissions and limitations under the License.,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
package io.fabric8.forge.devops;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
* Creates a new integration test build in OpenShift for the current project,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
public class NewIntegrationTestBuildCommand extends AbstractDevOpsCommand {,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
private static final transient Logger LOG = LoggerFactory.getLogger(NewIntegrationTestBuildCommand.class);,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
@Inject,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"@WithAttributes(name = ""buildName"", label = ""Build name"",",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"description = ""The build configuration name to generate."",",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
required = false),957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
UIInput<String> buildName;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"@WithAttributes(name = ""mavenCommand"", label = ""Maven command"",",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"description = ""The docker image name to generate."",",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"required = true,",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"defaultValue = ""mvn failsafe:integration-test -Pkit"")",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
UIInput<String> mavenCommand;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"@WithAttributes(name = ""image"", label = ""Docker image"",",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"description = ""The docker image to use to run the maven build."",",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"defaultValue = ""fabric8/maven"")",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
UIInput<String> image;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"@WithAttributes(name = ""gitUri"", label = ""Git Uri"",",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"description = ""If the git URI is not specified in the pom.xml then this allows you to specify one to be used."",",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
UIInput<String> gitUri;,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
@Override,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
public UICommandMetadata getMetadata(UIContext context) {,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
.category(Categories.create(CATEGORY)),957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
".name(CATEGORY + "": New Integration Test Build"")",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
".description(""Create a new integration test build configuration"");",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
},957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
public void initializeUI(final UIBuilder builder) throws Exception {,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
super.initializeUI(builder);,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
buildName.setDefaultValue(new Callable<String>() {,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
public String call() throws Exception {,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
Model mavenModel = getMavenModel(builder);,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
if (mavenModel != null) {,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
});,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
builder.add(buildName);,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
builder.add(mavenCommand);,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
builder.add(image);,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
builder.add(gitUri);,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
public Result execute(UIExecutionContext context) throws Exception {,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
String buildConfigName = buildName.getValue();,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"Objects.assertNotNull(buildConfigName, ""buildName"");",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"Map<String, String> labels = BuildConfigs.createBuildLabels(buildConfigName);",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"String gitUrlText = getOrFindGitUrl(context, gitUri.getValue());",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
String imageText = image.getValue();,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"List<EnvVar> envVars = createEnvVars(buildConfigName, gitUrlText, mavenCommand.getValue());",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"BuildConfig buildConfig = BuildConfigs.createIntegrationTestBuildConfig(buildConfigName, labels, gitUrlText, imageText, envVars);",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"LOG.info(""Generated BuildConfig: "" + toJson(buildConfig));",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"ImageStream imageRepository = BuildConfigs.imageRepository(buildConfigName, labels);",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
Controller controller = createController();,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"controller.applyImageStream(imageRepository, ""generated ImageStream: "" + toJson(imageRepository));",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"controller.applyBuildConfig(buildConfig, ""generated BuildConfig: "" + toJson(buildConfig));",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"private List<EnvVar> createEnvVars(String buildConfigName, String gitUrlText, String mavenCommand) {",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
ListEnvVarBuilder builder = new ListEnvVarBuilder();,957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"builder.withEnvVar(""BUILD_NAME"", buildConfigName);",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"builder.withEnvVar(""SOURCE_URI"", gitUrlText);",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"builder.withEnvVar(""MAVEN_COMMAND"", mavenCommand);",957acfd0684a49b104ee5f9fd7f0b2f2f5c23855,0,1
"onApplyError(""Failed to create BuildConfig from "" + sourceName + "". "" + e + "". "" + entity, e);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,16,1
"onApplyError(""Failed to update controller from "" + sourceName + "". "" + e + "". "" + entity, e);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,15,0
"onApplyError(""Failed to process template "" + sourceName + "". "" + e + "". "" + entity, e);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,15,0
"onApplyError(""Failed to create controller from "" + sourceName + "". "" + e + "". "" + entity, e);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,15,0
"onApplyError(""Failed to create Route from "" + sourceName + "". "" + e + "". "" + entity, e);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,15,0
"onApplyError(""Failed to update controller from "" + sourceName + "". "" + e + "". "" + entity, e);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,15,1
"onApplyError(""Failed to create controller from "" + sourceName + "". "" + e + "". "" + entity, e);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,15,1
"LOG.warn(""Creation disabled so not creating a entity from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(entity));",a4d39286675a9698a0ce1f89902eb4cd73b8e490,14,0
"LOG.warn(""Creation disabled so not creating a entity from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(entity));",a4d39286675a9698a0ce1f89902eb4cd73b8e490,14,1
"onApplyError(""Failed to create Route from "" + sourceName + "". "" + e1 + "". "" + entity, e1);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,13,0
"Objects.notNull(id, ""No name for "" + entity + "" "" + sourceName);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,10,0
"Objects.notNull(id, ""No name for "" + entity + "" "" + sourceName);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,10,1
"LOG.info(""Creating Template "" + namespace + "":"" + id + "" "" + summaryText(entity));",a4d39286675a9698a0ce1f89902eb4cd73b8e490,9,0
"LOG.info(""Creating Template "" + namespace + "":"" + id + "" "" + summaryText(entity));",a4d39286675a9698a0ce1f89902eb4cd73b8e490,9,1
"LOG.info(""Updating a entity from "" + sourceName);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,4,0
"LOG.info(""Updating a entity from "" + sourceName);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,4,1
* Returns the resource version for the entity or null if it does not have one,a4d39286675a9698a0ce1f89902eb4cd73b8e490,3,0
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""name""),",a4d39286675a9698a0ce1f89902eb4cd73b8e490,3,1
* Returns true if this entity has a valid non blank resourceVersion in its metadata,a4d39286675a9698a0ce1f89902eb4cd73b8e490,2,0
"getAdditionalPropertyText(entity.getAdditionalProperties(), ""name""),",a4d39286675a9698a0ce1f89902eb4cd73b8e490,2,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""id"")",a4d39286675a9698a0ce1f89902eb4cd73b8e490,2,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""namespace""));",a4d39286675a9698a0ce1f89902eb4cd73b8e490,2,1
"LOG.info(""Updated entity: "" + answer);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,2,0
"LOG.info(""Template processed into: "" + json);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,2,0
"LOG.info(""Updated entity: "" + answer);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,2,1
"LOG.info(""Template processed into: "" + json);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,2,1
ObjectMeta metadata = entity.getMetadata();,a4d39286675a9698a0ce1f89902eb4cd73b8e490,1,0
"public static void setName(HasMetadata entity, String name) {",a4d39286675a9698a0ce1f89902eb4cd73b8e490,1,0
"public static void setName(HasMetadata entity, String namespace, String name) {",a4d39286675a9698a0ce1f89902eb4cd73b8e490,1,0
ObjectMeta metadata = getOrCreateMetadata(entity);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,1,0
"public static void setNamespace(HasMetadata entity, String namespace) {",a4d39286675a9698a0ce1f89902eb4cd73b8e490,1,0
ObjectMeta metadata = entity.getMetadata();,a4d39286675a9698a0ce1f89902eb4cd73b8e490,1,1
metadata = new ObjectMeta();,a4d39286675a9698a0ce1f89902eb4cd73b8e490,1,1
"public static void setName(Pod entity, String name) {",a4d39286675a9698a0ce1f89902eb4cd73b8e490,1,1
"public static void setName(Service entity, String name) {",a4d39286675a9698a0ce1f89902eb4cd73b8e490,1,1
"public static void setName(ReplicationController entity, String name) {",a4d39286675a9698a0ce1f89902eb4cd73b8e490,1,1
"public static void setName(Route entity, String namespace, String name) {",a4d39286675a9698a0ce1f89902eb4cd73b8e490,1,1
"public static void setName(Template entity, String name) {",a4d39286675a9698a0ce1f89902eb4cd73b8e490,1,1
"public static void setNamespace(Template entity, String namespace) {",a4d39286675a9698a0ce1f89902eb4cd73b8e490,1,1
"getAdditionalPropertyText(entity.getAdditionalProperties(), ""namespace""),",a4d39286675a9698a0ce1f89902eb4cd73b8e490,1,1
for (int i = 0; i < lastIdx; i++) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,1,1
String id = getName(entity);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,1,0
"LOG.info(""Template hasn't changed so not doing anything"");",a4d39286675a9698a0ce1f89902eb4cd73b8e490,1,0
"doCreateTemplate(entity, namespace, sourceName);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,1,0
"Object answer = kubernetes.updateTemplate(id, entity, namespace);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,1,0
String id = getName(entity);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,1,1
"LOG.info(""Template hasn't changed so not doing anything"");",a4d39286675a9698a0ce1f89902eb4cd73b8e490,1,1
"doCreateTemplate(entity, namespace, sourceName);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,1,1
"Object answer = kubernetes.updateTemplate(id, entity, namespace);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,1,1
import io.fabric8.kubernetes.api.model.HasMetadata;,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
if (object instanceof HasMetadata) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
return getName((HasMetadata) object);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
public static ObjectMeta getOrCreateMetadata(HasMetadata entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
/**,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
*/,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
public static String getResourceVersion(HasMetadata entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
if (entity != null) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
if (metadata != null) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
String resourceVersion = metadata.getResourceVersion();,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
if (Strings.isNotBlank(resourceVersion)) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
return resourceVersion;,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
},a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
return null;,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
public static boolean hasResourceVersion(HasMetadata entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
return getResourceVersion(entity) != null;,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
public static String getName(HasMetadata entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
return getName(entity.getMetadata());,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
metadata.setNamespace(namespace);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
metadata.setName(name);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
public static String getNamespace(HasMetadata entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
return getNamespace(entity.getMetadata());,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
"public static Map<String, String> getLabels(HasMetadata entity) {",a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
return getLabels(entity.getMetadata());,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
return Collections.EMPTY_MAP;,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
public static List<HasMetadata> toItemList(Object entity) throws IOException {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
return (List<HasMetadata>) entity;,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
} else if (entity instanceof HasMetadata[]) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
HasMetadata[] array = (HasMetadata[]) entity;,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
List<HasMetadata> answer = new ArrayList<>();,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
if (entity instanceof HasMetadata) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
answer.add((HasMetadata) entity);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
List<HasMetadata> items = list.getItems();,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
public static void moveServicesToFrontOfArray(List<HasMetadata> list) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
HasMetadata item = list.get(i);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
HasMetadata nonService = list.get(lastNonService);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
protected static void removeDuplicates(List<HasMetadata> itemArray) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
HasMetadata item = itemArray.get(i);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
List<HasMetadata> items = kubernetesList.getItems();,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
List<HasMetadata> items = toItemList(dto);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
if (object instanceof Pod) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
return getName((Pod) object);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
} else if (object instanceof ReplicationController) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
return getName((ReplicationController) object);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
} else if (object instanceof Service) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
return getName((Service) object);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
} else if (object instanceof Route) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
return getName((Route) object);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static ObjectMeta getOrCreateMetadata(Pod entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
if (metadata == null) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
entity.setMetadata(metadata);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
},a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
return metadata;,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static ObjectMeta getOrCreateMetadata(ReplicationController entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static ObjectMeta getOrCreateMetadata(Service entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static ObjectMeta getOrCreateMetadata(Namespace entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static ObjectMeta getOrCreateMetadata(Route entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static ObjectMeta getOrCreateMetadata(Build entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static ObjectMeta getOrCreateMetadata(BuildConfig entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static ObjectMeta getOrCreateMetadata(DeploymentConfig entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static ObjectMeta getOrCreateMetadata(ImageStream entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static ObjectMeta getOrCreateMetadata(OAuthClient entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static ObjectMeta getOrCreateMetadata(Template entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static String getName(Pod entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
"return Strings.firstNonBlank(getName(entity.getMetadata()),",a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static String getName(ReplicationController entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
if (entity != null) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
} else {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
return null;,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static String getName(Service entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static String getName(OAuthClient entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static String getName(Route entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static String getName(Node entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static String getName(Template entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static String getName(ImageStream entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static String getName(Endpoints entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
getOrCreateMetadata(entity).setName(name);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
ObjectMeta objectMeta = getOrCreateMetadata(entity);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
objectMeta.setNamespace(namespace);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
objectMeta.setName(name);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static String getNamespace(Pod entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
"return Strings.firstNonBlank(getNamespace(entity.getMetadata()),",a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static String getNamespace(ReplicationController entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static String getNamespace(Service entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static String getNamespace(OAuthClient entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static String getNamespace(Route entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static String getNamespace(Template entity) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
"protected static Object getAdditionalProperty(Map<String, Object> additionalProperties, String name) {",a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
if (additionalProperties != null) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
return additionalProperties.get(name);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
"protected static String getAdditionalNestedPropertyText(Map<String, Object> additionalProperties, String... names) {",a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
int lastIdx = names.length - 1;,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
"Map<String, Object> map = additionalProperties;",a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
if (map == null) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
"map = getAdditionalPropertyMap(map, names[i]);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
"return getAdditionalPropertyText(map, names[lastIdx]);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static List<Object> toItemList(Object entity) throws IOException {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
return (List<Object>) entity;,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
} else if (entity instanceof Object[]) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
Object[] array = (Object[]) entity;,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
List<Object> answer = new ArrayList<>();,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
answer.add(answer);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
List<Object> items = list.getItems();,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
public static void moveServicesToFrontOfArray(List<Object> list) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
Object item = list.get(i);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
Object nonService = list.get(lastNonService);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
protected static void removeDuplicates(List<Object> itemArray) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
Object item = itemArray.get(i);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
List<Object> items = kubernetesList.getItems();,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
List<Object> items = toItemList(dto);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
import io.fabric8.kubernetes.api.extensions.Templates;,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
import javax.ws.rs.WebApplicationException;,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
private boolean processTemplatesLocally;,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
if (!isProcessTemplatesLocally()) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
String namespace = getNamespace();,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
"Template old = kubernetes.getTemplate(id, namespace);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
if (isRunning(old)) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
"if (UserConfigurationCompare.configEqual(entity, old)) {",a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
boolean recreateMode = isRecreateMode();,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
// TODO seems you can't update templates right now,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
recreateMode = true;,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
if (recreateMode) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
"kubernetes.deleteTemplate(id, namespace);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
} else {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
try {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
} catch (Exception e) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
},a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
if (!isAllowCreate()) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
if (isProcessTemplatesLocally()) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
return Templates.processTemplatesLocally(entity);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
} catch (IOException e) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
return null;,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
String namespace = KubernetesHelper.getNamespace(entity);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
Object result = null;,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
"String json = kubernetes.processTemplate(entity, namespace);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
result = loadJson(json);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
printSummary(result);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
return result;,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
} catch (WebApplicationException e) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
if (e.getResponse().getStatus() == 404) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
// could be OpenShift 0.4.x which has the old style REST API - lets try that...,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
"LOG.warn(""Got a 404 - could be an old Kubernetes/OpenShift environment - lets try the old style REST API..."");",a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
/*,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
"kubernetes.createRouteOldAPi(entity, namespace);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
} catch (Exception e1) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
*/,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
public boolean isProcessTemplatesLocally() {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
return processTemplatesLocally;,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
public void setProcessTemplatesLocally(boolean processTemplatesLocally) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
this.processTemplatesLocally = processTemplatesLocally;,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,0
String namespace = getNamespace();,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
"Template old = kubernetes.getTemplate(id, namespace);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
if (isRunning(old)) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
"if (UserConfigurationCompare.configEqual(entity, old)) {",a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
} else {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
boolean recreateMode = isRecreateMode();,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
// TODO seems you can't update templates right now,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
recreateMode = true;,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
if (recreateMode) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
"kubernetes.deleteTemplate(id, namespace);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
try {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
} catch (Exception e) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
},a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
if (!isAllowCreate()) {,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
String namespace = KubernetesHelper.getNamespace(entity);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
Object result = null;,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
"String json = kubernetes.processTemplate(entity, namespace);",a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
result = loadJson(json);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
printSummary(result);,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
return result;,a4d39286675a9698a0ce1f89902eb4cd73b8e490,0,1
"public static void setName(Route entity, String namespace, String name) {",a2a4c15699f34fe30cb4148bb873644348fbcffc,7,1
"public static void setName(HasMetadata entity, String namespace, String name) {",a2a4c15699f34fe30cb4148bb873644348fbcffc,6,0
"protected static Object getAdditionalProperty(Map<String, Object> additionalProperties, String name) {",a2a4c15699f34fe30cb4148bb873644348fbcffc,5,1
"public static void setName(HasMetadata entity, String name) {",a2a4c15699f34fe30cb4148bb873644348fbcffc,4,0
"public static void setName(Pod entity, String name) {",a2a4c15699f34fe30cb4148bb873644348fbcffc,4,1
"public static void setName(Service entity, String name) {",a2a4c15699f34fe30cb4148bb873644348fbcffc,4,1
"public static void setName(ReplicationController entity, String name) {",a2a4c15699f34fe30cb4148bb873644348fbcffc,4,1
"public static void setName(Template entity, String name) {",a2a4c15699f34fe30cb4148bb873644348fbcffc,4,1
* Returns true if this entity has a valid non blank resourceVersion in its metadata,a2a4c15699f34fe30cb4148bb873644348fbcffc,3,0
"public static void setNamespace(HasMetadata entity, String namespace) {",a2a4c15699f34fe30cb4148bb873644348fbcffc,3,0
metadata = new ObjectMeta();,a2a4c15699f34fe30cb4148bb873644348fbcffc,3,1
"public static void setNamespace(Template entity, String namespace) {",a2a4c15699f34fe30cb4148bb873644348fbcffc,3,1
"protected static String getAdditionalNestedPropertyText(Map<String, Object> additionalProperties, String... names) {",a2a4c15699f34fe30cb4148bb873644348fbcffc,3,1
"Map<String, Object> map = additionalProperties;",a2a4c15699f34fe30cb4148bb873644348fbcffc,3,1
public static String getResourceVersion(HasMetadata entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,0
ObjectMeta metadata = entity.getMetadata();,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,0
String resourceVersion = metadata.getResourceVersion();,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,0
public static String getName(HasMetadata entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,0
ObjectMeta metadata = getOrCreateMetadata(entity);,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,0
public static String getNamespace(HasMetadata entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,0
"public static Map<String, String> getLabels(HasMetadata entity) {",a2a4c15699f34fe30cb4148bb873644348fbcffc,2,0
List<HasMetadata> answer = new ArrayList<>();,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,0
ObjectMeta metadata = entity.getMetadata();,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,1
public static String getName(Pod entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,1
public static String getName(ReplicationController entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,1
public static String getName(Service entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,1
public static String getName(OAuthClient entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,1
public static String getName(Route entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,1
public static String getName(Node entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,1
public static String getName(Template entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,1
public static String getName(ImageStream entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,1
public static String getName(Endpoints entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,1
public static String getNamespace(Pod entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,1
public static String getNamespace(ReplicationController entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,1
public static String getNamespace(Service entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,1
public static String getNamespace(OAuthClient entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,1
public static String getNamespace(Route entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,1
public static String getNamespace(Template entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,1
List<Object> answer = new ArrayList<>();,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,1
Object item = list.get(i);,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,1
Object nonService = list.get(lastNonService);,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,1
Object item = itemArray.get(i);,a2a4c15699f34fe30cb4148bb873644348fbcffc,2,1
return getName((HasMetadata) object);,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,0
public static ObjectMeta getOrCreateMetadata(HasMetadata entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,0
* Returns the resource version for the entity or null if it does not have one,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,0
return resourceVersion;,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,0
return null;,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,0
public static boolean hasResourceVersion(HasMetadata entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,0
return getResourceVersion(entity) != null;,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,0
return getName(entity.getMetadata());,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,0
return getNamespace(entity.getMetadata());,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,0
return getLabels(entity.getMetadata());,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,0
return Collections.EMPTY_MAP;,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,0
public static List<HasMetadata> toItemList(Object entity) throws IOException {,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,0
return (List<HasMetadata>) entity;,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,0
HasMetadata[] array = (HasMetadata[]) entity;,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,0
List<HasMetadata> items = list.getItems();,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,0
public static void moveServicesToFrontOfArray(List<HasMetadata> list) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,0
HasMetadata item = list.get(i);,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,0
HasMetadata nonService = list.get(lastNonService);,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,0
protected static void removeDuplicates(List<HasMetadata> itemArray) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,0
HasMetadata item = itemArray.get(i);,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,0
List<HasMetadata> items = kubernetesList.getItems();,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,0
List<HasMetadata> items = toItemList(dto);,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,0
return getName((Pod) object);,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
return getName((ReplicationController) object);,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
return getName((Service) object);,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
return getName((Route) object);,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
public static ObjectMeta getOrCreateMetadata(Pod entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
return metadata;,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
public static ObjectMeta getOrCreateMetadata(ReplicationController entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
public static ObjectMeta getOrCreateMetadata(Service entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
public static ObjectMeta getOrCreateMetadata(Namespace entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
public static ObjectMeta getOrCreateMetadata(Route entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
public static ObjectMeta getOrCreateMetadata(Build entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
public static ObjectMeta getOrCreateMetadata(BuildConfig entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
public static ObjectMeta getOrCreateMetadata(DeploymentConfig entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
public static ObjectMeta getOrCreateMetadata(ImageStream entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
public static ObjectMeta getOrCreateMetadata(OAuthClient entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
public static ObjectMeta getOrCreateMetadata(Template entity) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
"return Strings.firstNonBlank(getName(entity.getMetadata()),",a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
return null;,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
ObjectMeta objectMeta = getOrCreateMetadata(entity);,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
"return Strings.firstNonBlank(getNamespace(entity.getMetadata()),",a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
return additionalProperties.get(name);,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
int lastIdx = names.length - 1;,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
for (int i = 0; i < lastIdx; i++) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
"map = getAdditionalPropertyMap(map, names[i]);",a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
"return getAdditionalPropertyText(map, names[lastIdx]);",a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
public static List<Object> toItemList(Object entity) throws IOException {,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
return (List<Object>) entity;,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
Object[] array = (Object[]) entity;,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
List<Object> items = list.getItems();,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
public static void moveServicesToFrontOfArray(List<Object> list) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
protected static void removeDuplicates(List<Object> itemArray) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
List<Object> items = kubernetesList.getItems();,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
List<Object> items = toItemList(dto);,a2a4c15699f34fe30cb4148bb873644348fbcffc,1,1
import io.fabric8.kubernetes.api.model.HasMetadata;,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,0
if (object instanceof HasMetadata) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,0
/**,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,0
*/,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,0
if (entity != null) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,0
if (metadata != null) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,0
if (Strings.isNotBlank(resourceVersion)) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,0
},a2a4c15699f34fe30cb4148bb873644348fbcffc,0,0
metadata.setNamespace(namespace);,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,0
metadata.setName(name);,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,0
} else if (entity instanceof HasMetadata[]) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,0
if (entity instanceof HasMetadata) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,0
answer.add((HasMetadata) entity);,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,0
if (object instanceof Pod) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,1
} else if (object instanceof ReplicationController) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,1
} else if (object instanceof Service) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,1
} else if (object instanceof Route) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,1
if (metadata == null) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,1
entity.setMetadata(metadata);,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,1
},a2a4c15699f34fe30cb4148bb873644348fbcffc,0,1
"getAdditionalPropertyText(entity.getAdditionalProperties(), ""name""),",a2a4c15699f34fe30cb4148bb873644348fbcffc,0,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""name""),",a2a4c15699f34fe30cb4148bb873644348fbcffc,0,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""id"")",a2a4c15699f34fe30cb4148bb873644348fbcffc,0,1
);,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,1
if (entity != null) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,1
} else {,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,1
getOrCreateMetadata(entity).setName(name);,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,1
objectMeta.setNamespace(namespace);,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,1
objectMeta.setName(name);,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,1
"getAdditionalPropertyText(entity.getAdditionalProperties(), ""namespace""),",a2a4c15699f34fe30cb4148bb873644348fbcffc,0,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""namespace""));",a2a4c15699f34fe30cb4148bb873644348fbcffc,0,1
if (additionalProperties != null) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,1
if (map == null) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,1
} else if (entity instanceof Object[]) {,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,1
answer.add(answer);,a2a4c15699f34fe30cb4148bb873644348fbcffc,0,1
"LOG.warn(""Creation disabled so not creating a entity from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(entity));",5213eb2a75b3ef8524cc9fe179d75d823df53148,4,0
"protected void doCreateTemplate(Template entity, String namespace, String sourceName) {",5213eb2a75b3ef8524cc9fe179d75d823df53148,4,0
"LOG.info(""Creating a template from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(entity));",5213eb2a75b3ef8524cc9fe179d75d823df53148,4,0
"LOG.warn(""Creation disabled so not creating a entity from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(entity));",5213eb2a75b3ef8524cc9fe179d75d823df53148,4,0
String namespace = KubernetesHelper.getNamespace(entity);,5213eb2a75b3ef8524cc9fe179d75d823df53148,4,0
"LOG.warn(""Creation disabled so not creating a entity from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(entity));",5213eb2a75b3ef8524cc9fe179d75d823df53148,4,1
String namespace = KubernetesHelper.getNamespace(entity);,5213eb2a75b3ef8524cc9fe179d75d823df53148,4,1
List<Object> objects = template.getObjects();,5213eb2a75b3ef8524cc9fe179d75d823df53148,3,1
"public static Object combineTemplates(KubernetesList kubernetesList, List<Object> items) {",5213eb2a75b3ef8524cc9fe179d75d823df53148,3,1
String answer = iconUrl;,5213eb2a75b3ef8524cc9fe179d75d823df53148,3,0
"String answer = URLUtils.pathJoin(urlPrefix, iconBranch, relativePath);",5213eb2a75b3ef8524cc9fe179d75d823df53148,3,0
String answer = null;,5213eb2a75b3ef8524cc9fe179d75d823df53148,3,1
"String answer = URLUtils.pathJoin(url, branch, relativePath);",5213eb2a75b3ef8524cc9fe179d75d823df53148,3,1
"public Object applyTemplate(Template entity, String sourceName) throws Exception {",5213eb2a75b3ef8524cc9fe179d75d823df53148,3,0
String namespace = getNamespace();,5213eb2a75b3ef8524cc9fe179d75d823df53148,3,0
"Object answer = kubernetes.updateTemplate(id, entity, namespace);",5213eb2a75b3ef8524cc9fe179d75d823df53148,3,0
"Object answer = kubernetes.createTemplate(entity, namespace);",5213eb2a75b3ef8524cc9fe179d75d823df53148,3,0
String namespace = getNamespace();,5213eb2a75b3ef8524cc9fe179d75d823df53148,3,0
"Object answer = kubernetes.updateTemplate(id, entity, namespace);",5213eb2a75b3ef8524cc9fe179d75d823df53148,3,0
String namespace = getNamespace();,5213eb2a75b3ef8524cc9fe179d75d823df53148,3,1
"Object answer = kubernetes.updateTemplate(id, entity, namespace);",5213eb2a75b3ef8524cc9fe179d75d823df53148,3,1
List<HasMetadata> objects = template.getObjects();,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
"public static Object combineTemplates(KubernetesList kubernetesList, List<HasMetadata> items) {",5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
List<Object> items = kubernetesList.getItems();,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
"public static void addTemplateObject(Template template, Object object) {",5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
"@Parameter(property = ""fabric8.iconBranch"", defaultValue = ""master"")",5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
"File file = new File(iconTempDir, ""icon"" + ext);",5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
answer = convertIconFileToURL(iconFile);,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
} catch (Exception e) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
String urlPrefix = iconUrlPrefix;,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
String url = scm.getUrl();,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
} else {,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
import io.fabric8.kubernetes.api.model.*;,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
import java.util.*;,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
"File file = new File(iconTempDir, ""icon"" + ext);",5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
answer = convertIconFileToURL(iconFile);,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
} catch (Exception e) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
String url = scm.getUrl();,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
"String[] prefixes = { ""http://github.com/"", ""https://github.com/""};",5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
"String branch = ""master"";",5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
String id = getName(entity);,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
"Objects.notNull(id, ""No name for "" + entity + "" "" + sourceName);",5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
} else {,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
} catch (Exception e) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
"onApplyError(""Failed to template entity from "" + sourceName + "". "" + e + "". "" + entity, e);",5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
"String json = kubernetes.processTemplate(entity, namespace);",5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
protected boolean isRunning(HasMetadata entity) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
"public void applyTemplate(Template entity, String sourceName) {",5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
"Object result = processTemplate(entity, sourceName);",5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
} catch (Exception e) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
"String json = kubernetes.createTemplate(entity, namespace);",5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
protected boolean isRunning(OAuthClient entity) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
return entity != null;,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
protected boolean isRunning(Pod entity) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
protected boolean isRunning(ReplicationController entity) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
protected boolean isRunning(Service entity) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
String id = getName(entity);,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
"Objects.notNull(id, ""No name for "" + entity + "" "" + sourceName);",5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
} else {,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
} catch (Exception e) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
} catch (IOException e) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
Object result = null;,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
"String json = kubernetes.processTemplate(entity, namespace);",5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
} catch (WebApplicationException e) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
} catch (Exception e1) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,0
String id = getName(entity);,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
"Objects.notNull(id, ""No name for "" + entity + "" "" + sourceName);",5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
} else {,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
} catch (Exception e) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
Object result = null;,5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
"String json = kubernetes.processTemplate(entity, namespace);",5213eb2a75b3ef8524cc9fe179d75d823df53148,2,1
import io.fabric8.kubernetes.api.model.HasMetadata;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
List<HasMetadata> items = kubernetesList.getItems();,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
for (HasMetadata item : items) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
for (HasMetadata object : items) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
for (HasMetadata object : objects) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
"public static void addTemplateObject(Template template, HasMetadata object) {",5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
for (Object item : items) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
for (Object object : items) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
for (Object object : objects) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
import io.fabric8.kubernetes.api.model.ContainerPort;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import io.fabric8.kubernetes.api.model.EnvVar;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import io.fabric8.kubernetes.api.model.HTTPGetAction;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import io.fabric8.kubernetes.api.model.KubernetesList;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import io.fabric8.kubernetes.api.model.KubernetesListBuilder;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import io.fabric8.kubernetes.api.model.Probe;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import io.fabric8.kubernetes.api.model.ServiceBuilder;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import io.fabric8.kubernetes.api.model.ServiceFluent;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import io.fabric8.kubernetes.api.model.ServicePort;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import io.fabric8.kubernetes.api.model.Volume;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import io.fabric8.kubernetes.api.model.VolumeMount;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import io.fabric8.kubernetes.api.model.VolumeMountBuilder;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import java.util.ArrayList;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import java.util.HashMap;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import java.util.HashSet;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import java.util.LinkedHashSet;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import java.util.List;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import java.util.Map;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import java.util.Properties;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import java.util.Set;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import java.util.TreeMap;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
"@Parameter(property = ""fabric8.iconUrl"")",5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
private String iconUrl;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
"@Parameter(property = ""fabric8.iconUrlPrefix"")",5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
private String iconUrlPrefix;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
private String iconBranch;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
if (Strings.isNullOrBlank(answer)) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
try {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
if (iconTempDir != null) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
File iconFile = copyIconToFolder(iconTempDir);,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
if (iconFile == null) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
for (String ext : ICON_EXTENSIONS) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
if (file.exists() && file.isFile()) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
iconFile = file;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
},5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
if (iconFile != null) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
if (Strings.isNullOrBlank(urlPrefix)) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
Scm scm = getProject().getScm();,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
if (scm != null) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
if (url != null) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
"String[] prefixes = {""http://github.com/"", ""https://github.com/""};",5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
for (String prefix : prefixes) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
if (url.startsWith(prefix)) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
"url = URLUtils.pathJoin(""https://raw.githubusercontent.com/"", url.substring(prefix.length()));",5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
if (url.endsWith(relativeParentPath)) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
"url = url.substring(0, url.length() - relativeParentPath.length());",5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
urlPrefix = url;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
return answer;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
try {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
if (iconTempDir != null) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
File iconFile = copyIconToFolder(iconTempDir);,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
if (iconFile == null) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
for (String ext : ICON_EXTENSIONS) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
if (file.exists() && file.isFile()) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
iconFile = file;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
if (iconFile != null) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
},5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
Scm scm = getProject().getScm();,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
if (scm != null) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
if (url != null) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
for (String prefix : prefixes) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
if (url.startsWith(prefix)) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
"url = URLUtils.pathJoin(""https://raw.githubusercontent.com/"", url.substring(prefix.length()));",5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
if (url.endsWith(relativeParentPath)) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
"url = url.substring(0, url.length() - relativeParentPath.length());",5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
return answer;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
import java.io.File;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import java.io.FileInputStream;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import java.io.FileNotFoundException;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import java.io.IOException;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import java.io.InputStream;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import static io.fabric8.kubernetes.api.KubernetesHelper.getName;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import static io.fabric8.kubernetes.api.KubernetesHelper.getObjectId;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import static io.fabric8.kubernetes.api.KubernetesHelper.getOrCreateMetadata;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import static io.fabric8.kubernetes.api.KubernetesHelper.getPodMap;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import static io.fabric8.kubernetes.api.KubernetesHelper.getReplicationControllerMap;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import static io.fabric8.kubernetes.api.KubernetesHelper.getServiceMap;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import static io.fabric8.kubernetes.api.KubernetesHelper.loadJson;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import static io.fabric8.kubernetes.api.KubernetesHelper.summaryText;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import static io.fabric8.kubernetes.api.KubernetesHelper.toItemList;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
* Creates/updates the template and processes it returning the processed DTOs,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
"Template old = kubernetes.getTemplate(id, namespace);",5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
if (isRunning(old)) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
"if (UserConfigurationCompare.configEqual(entity, old)) {",5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
boolean recreateMode = isRecreateMode();,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
recreateMode = true;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
if (recreateMode) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
"LOG.info(""Updating a entity from "" + sourceName);",5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
try {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
},5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
if (!isAllowCreate()) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
"return processTemplate(entity, sourceName);",5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import io.fabric8.openshift.api.model.RouteSpec;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
import java.io.*;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
import static io.fabric8.kubernetes.api.KubernetesHelper.*;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
if (result != null) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
try {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
"onApplyError(""Failed to apply result of template expansion from "" + sourceName + "". "" + e + "". "" + result, e);",5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
},5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
import io.fabric8.kubernetes.api.extensions.Templates;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
import javax.ws.rs.WebApplicationException;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
if (!isProcessTemplatesLocally()) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
"Template old = kubernetes.getTemplate(id, namespace);",5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
if (isRunning(old)) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
"if (UserConfigurationCompare.configEqual(entity, old)) {",5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
boolean recreateMode = isRecreateMode();,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
recreateMode = true;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
if (recreateMode) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
"LOG.info(""Updating a entity from "" + sourceName);",5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
try {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
},5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
if (!isAllowCreate()) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
if (isProcessTemplatesLocally()) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
return Templates.processTemplatesLocally(entity);,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
"onApplyError(""Failed to process template "" + sourceName + "". "" + e + "". "" + entity, e);",5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
return null;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
"LOG.info(""Creating Template "" + namespace + "":"" + id + "" "" + summaryText(entity));",5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
result = loadJson(json);,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
return result;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
if (e.getResponse().getStatus() == 404) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
public boolean isProcessTemplatesLocally() {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
return processTemplatesLocally;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
public void setProcessTemplatesLocally(boolean processTemplatesLocally) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
this.processTemplatesLocally = processTemplatesLocally;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,0
"Template old = kubernetes.getTemplate(id, namespace);",5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
if (isRunning(old)) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
"if (UserConfigurationCompare.configEqual(entity, old)) {",5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
boolean recreateMode = isRecreateMode();,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
recreateMode = true;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
if (recreateMode) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
"LOG.info(""Updating a entity from "" + sourceName);",5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
try {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
},5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
if (!isAllowCreate()) {,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
"LOG.info(""Creating Template "" + namespace + "":"" + id + "" "" + summaryText(entity));",5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
result = loadJson(json);,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
return result;,5213eb2a75b3ef8524cc9fe179d75d823df53148,1,1
/**,5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
* The URL to use to link to the icon in the generated Template,5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
*/,5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
* The URL prefix added to the relative path of the icon file,5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
* The SCM branch used when creating a URL to the icon file,5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
iconTempDir.mkdirs();,5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
"copyAppConfigFiles(iconTempDir, appConfigDir);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
// lets find the icon file...,5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
break;,5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
"getLog().warn(""Failed to load icon file: "" + e, e);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
"getLog().warn(""No iconUrlPrefix defined or could be found via SCM in the pom.xml so cannot add an icon URL!"");",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
"getLog().info(""icon url is: "" + answer);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
iconTempDir.mkdirs();,5213eb2a75b3ef8524cc9fe179d75d823df53148,0,1
"copyAppConfigFiles(iconTempDir, appConfigDir);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,1
// lets find the icon file...,5213eb2a75b3ef8524cc9fe179d75d823df53148,0,1
break;,5213eb2a75b3ef8524cc9fe179d75d823df53148,0,1
"getLog().warn(""Failed to load icon file: "" + e, e);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,1
"getLog().info(""icon url is: "" + answer);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,1
/**,5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
*/,5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
"LOG.info(""Template hasn't changed so not doing anything"");",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
// TODO seems you can't update templates right now,5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
"kubernetes.deleteTemplate(id, namespace);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
"doCreateTemplate(entity, namespace, sourceName);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
"LOG.info(""Updated entity: "" + answer);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
"onApplyError(""Failed to update controller from "" + sourceName + "". "" + e + "". "" + entity, e);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
"LOG.info(""Created template: "" + answer);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
"applyEntity(result, sourceName);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,1
// TODO we could maybe ignore failed services?,5213eb2a75b3ef8524cc9fe179d75d823df53148,0,1
private boolean processTemplatesLocally;,5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
"LOG.info(""Template hasn't changed so not doing anything"");",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
// TODO seems you can't update templates right now,5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
"kubernetes.deleteTemplate(id, namespace);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
"doCreateTemplate(entity, namespace, sourceName);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
"LOG.info(""Updated entity: "" + answer);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
"onApplyError(""Failed to update controller from "" + sourceName + "". "" + e + "". "" + entity, e);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
"LOG.info(""Template processed into: "" + json);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
printSummary(result);,5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
"onApplyError(""Failed to create controller from "" + sourceName + "". "" + e + "". "" + entity, e);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
// could be OpenShift 0.4.x which has the old style REST API - lets try that...,5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
"LOG.warn(""Got a 404 - could be an old Kubernetes/OpenShift environment - lets try the old style REST API..."");",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
/*,5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
"kubernetes.createRouteOldAPi(entity, namespace);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
"onApplyError(""Failed to create Route from "" + sourceName + "". "" + e1 + "". "" + entity, e1);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
*/,5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
"onApplyError(""Failed to create Route from "" + sourceName + "". "" + e + "". "" + entity, e);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,0
"LOG.info(""Template hasn't changed so not doing anything"");",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,1
// TODO seems you can't update templates right now,5213eb2a75b3ef8524cc9fe179d75d823df53148,0,1
"kubernetes.deleteTemplate(id, namespace);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,1
"doCreateTemplate(entity, namespace, sourceName);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,1
"LOG.info(""Updated entity: "" + answer);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,1
"onApplyError(""Failed to update controller from "" + sourceName + "". "" + e + "". "" + entity, e);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,1
"LOG.info(""Template processed into: "" + json);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,1
printSummary(result);,5213eb2a75b3ef8524cc9fe179d75d823df53148,0,1
"onApplyError(""Failed to create controller from "" + sourceName + "". "" + e + "". "" + entity, e);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,1
"onApplyError(""Failed to create BuildConfig from "" + sourceName + "". "" + e + "". "" + entity, e);",5213eb2a75b3ef8524cc9fe179d75d823df53148,0,1
"System.out.println(indent + entry.getKey() + "" = "" + entry.getValue());",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,6,1
"String text = name + "": "" + value;",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,5,1
"@WithAttributes(name = ""filter"", label = ""The text filter used to filter pods using label selectors"")",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,5,1
"@WithAttributes(name = ""filter"", label = ""The text filter used to filter pods using label selectors"")",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,5,1
"@WithAttributes(name = ""filter"", label = ""The text filter used to filter pods using label selectors"")",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,5,1
"log.status(""Applying kubernetes configuration from: "" + configUrl);",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,4,0
"log.status(""Applying kubernetes configuration from: "" + configuration.getConfigUrl());",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,4,1
"Map<String, String> labels = podInfo.getMetadata().getLabels();",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,4,1
"Map<String, String> labelMap = item.getMetadata().getLabels();",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,4,1
"log.status(""Applying "" + entity.getClass().getSimpleName() + "":"");",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,3,0
* Command to print the pod information in kubernetes,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,3,1
"String indent = ""    "";",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,3,1
String labels = KubernetesHelper.toLabelsString(labelMap);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,3,1
".name(CATEGORY + "": Replication Controller List"")",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,3,1
String labels = KubernetesHelper.toLabelsString(item.getMetadata().getLabels());,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,3,1
String labels = KubernetesHelper.toLabelsString(service.getMetadata().getLabels());,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,3,1
"log.status(""Adapting resources to pull images from registry: "" + registry);",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,3,0
"public void addRegistryToImageNameIfNotPresent(Iterable<HasMetadata> items, String registry) throws Exception {",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,3,0
"String parameterNamePrefix = """";",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,0
"log.status(""Applying template in namespace "" + namespace);",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,0
public class PodInfo extends AbstractPodCommand {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
".description(""Shows detailed information for the given pod in the kubernetes cloud"");",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
"protected void executePod(Pod podInfo, String podId) {",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
"System.out.println(""Created: "" + podInfo.getMetadata().getCreationTimestamp());",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
"for (Map.Entry<String, String> entry : labels.entrySet()) {",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
"protected void println(int indentCount, String text) {",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
for (int i = 0; i < indentCount; i++) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
* Command to list pods in kubernetes,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
public class PodsList extends AbstractKubernetesCommand {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
public void initializeUI(UIBuilder builder) throws Exception {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
public Result execute(UIExecutionContext uiExecutionContext) throws Exception {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
for (Pod item : items) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
String id = KubernetesHelper.getName(item);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
"String status = """";",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
"String host = """";",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
String image = container.getImage();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
"labels = """";",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
* Command to list replication controllers in kubernetes,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
public class ReplicationControllersList extends AbstractKubernetesCommand {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
public void initializeUI(UIBuilder builder) throws Exception {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
public Result execute(UIExecutionContext uiExecutionContext) throws Exception {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
for (ReplicationController item : items) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
String id = KubernetesHelper.getName(item);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
String selector = null;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
* Command to list services in kubernetes,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
public class ServicesList extends AbstractKubernetesCommand {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
".name(CATEGORY + "": Service List"")",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
public void initializeUI(UIBuilder builder) throws Exception {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
public Result execute(UIExecutionContext uiExecutionContext) throws Exception {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
for (Service service : items) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
String selector = KubernetesHelper.toLabelsString(getSelector(service));,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,1
public void invoke() throws Exception {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,0
String registry = getLocalDockerRegistry();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,0
private String getLocalDockerRegistry() {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,0
"return System.getenv(Constants.FABRIC8_DOCKER_REGISTRY_SERVICE_HOST) + "":"" + System.getenv(Constants.FABRIC8_DOCKER_REGISTRY_SERVICE_PORT);",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,0
for (HasMetadata item : items) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,0
"private void prefixRegistryIfNotPresent(List<Container> containers, String registry) {",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,0
"throw new IllegalArgumentException(imageName + "" is not a proper image name ([registry/][repo][:port]"");",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,0
String rest = matcher.group(1);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,0
String part = parts[0];,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,2,0
Namespace namespaceDetails = session.getNamespaceDetails();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
Object dto = loadJson(readAsString(configUrl));,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
if (dto instanceof Template) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
Template template = (Template) dto;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
"dto = controller.processTemplate(template, configUrl.toString());",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
if (dto == null) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
"throw new IllegalArgumentException(""Failed to process Template!"");",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
KubernetesList kubeList = KubernetesHelper.asKubernetesList(dto);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
List<Object> items = kubeList.getItems();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
} else if (entity != null) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
kubeConfigs.add((KubernetesList) loadJson(readAsString(configuration.getConfigUrl())));,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
"*  Red Hat licenses this file to you under the Apache License, version",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
"*  Unless required by applicable law or agreed to in writing, software",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
private int indentCount = 0;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
public UICommandMetadata getMetadata(UIContext context) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
".name(CATEGORY + "": Pod Info"")",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
PodStatus currentState = podInfo.getStatus();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
if (currentState != null) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
PodSpec spec = podInfo.getSpec();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
if (spec != null) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
List<Container> containers = spec.getContainers();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
if (notEmpty(containers)) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
for (Container container : containers) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
List<ContainerPort> ports = container.getPorts();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
if (notEmpty(ports)) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
for (ContainerPort port : ports) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
List<EnvVar> envList = container.getEnv();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
if (notEmpty(envList)) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
for (EnvVar env : envList) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
List<VolumeMount> volumeMounts = container.getVolumeMounts();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
if (notEmpty(volumeMounts)) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
for (VolumeMount volumeMount : volumeMounts) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
List<Volume> volumes = spec.getVolumes();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
if (volumes != null) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
for (Volume volume : volumes) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
System.out.println(indent + volume.getName());,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
public static boolean notEmpty(Collection<?> ports) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
protected void println(String text) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
"protected void printValue(String name, Object value) {",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
"protected void printValue(String name, Object value, int indentCount) {",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
if (value != null) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
"*  Red Hat licenses this file to you under the Apache License, version",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
"*  Unless required by applicable law or agreed to in writing, software",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
public UICommandMetadata getMetadata(UIContext context) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
".name(CATEGORY + "": Pod List"")",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
".description(""Lists the pods in a kubernetes cloud"");",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
PodList pods = getKubernetes().pods().inNamespace(getNamespace()).list();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
TablePrinter table = podsAsTable(pods);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
protected TablePrinter podsAsTable(PodList pods) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
TablePrinter table = new TablePrinter();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
List<Pod> items = pods.getItems();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
if (items == null) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
items = Collections.EMPTY_LIST;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
Filter<Pod> filter = KubernetesHelper.createPodFilter(filterText.getValue());,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
if (filter.matches(item)) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
PodStatus podStatus = item.getStatus();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
if (podStatus != null) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
status = KubernetesHelper.getStatusText(podStatus);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
host = podStatus.getHostIP();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
PodSpec spec = item.getSpec();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
if (spec != null) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
List<Container> containerList = spec.getContainers();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
for (Container container : containerList) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
"id = """";",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
"host = """";",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
"status = """";",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
"*  Red Hat licenses this file to you under the Apache License, version",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
"*  Unless required by applicable law or agreed to in writing, software",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
public UICommandMetadata getMetadata(UIContext context) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
".description(""Lists the replication controllers in a kubernetes cloud"");",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
ReplicationControllerList replicationControllers = getKubernetes().replicationControllers().inNamespace(getNamespace()).list();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
"private void printReplicationControllers(ReplicationControllerList replicationControllers, PrintStream out) {",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
TablePrinter table = new TablePrinter();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
List<ReplicationController> items = replicationControllers.getItems();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
if (items == null) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
items = Collections.EMPTY_LIST;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
Filter<ReplicationController> filter = KubernetesHelper.createReplicationControllerFilter(filterText.getValue());,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
if (filter.matches(item)) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
Integer replicas = null;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
ReplicationControllerSpec desiredState = item.getSpec();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
ReplicationControllerStatus currentState = item.getStatus();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
if (desiredState != null) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
selector = KubernetesHelper.toLabelsString(desiredState.getSelector());,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
if (currentState != null) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
replicas = currentState.getReplicas();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
"*  Red Hat licenses this file to you under the Apache License, version",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
"*  Unless required by applicable law or agreed to in writing, software",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
public UICommandMetadata getMetadata(UIContext context) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
".description(""Lists the services in a kubernetes cloud"");",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
ServiceList services = getKubernetes().services().list();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
"private void printServices(ServiceList services, PrintStream out) {",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
TablePrinter table = new TablePrinter();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
List<Service> items = services.getItems();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
if (items == null) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
items = Collections.EMPTY_LIST;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
Filter<Service> filter = KubernetesHelper.createServiceFilter(filterText.getValue());,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
if (filter.matches(service)) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
Set<Integer> ports = getPorts(service);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
List<Integer> portList = new ArrayList<>(ports);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
String portText;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
if (portList.size() == 1) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
portText = portList.get(0).toString();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
} else {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
"portText = Strings.join(portList, "", "");",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
assertAssertionError(new Block() {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
Set<HasMetadata> entities = new TreeSet<>(new HasMetadataComparator());,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
List<Object> items = new ArrayList<>();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
"Collections.sort(items, new Comparator<Object>() {",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
Set<HasMetadata> extraEntities = new TreeSet<>(new HasMetadataComparator());,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
for (Object entity : items) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
if (items != null) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
if (item instanceof KubernetesList) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
KubernetesList list = (KubernetesList) item;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
} else if (item instanceof Template) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
Template template = (Template) item;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
} else if (item instanceof Pod) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
List<Container> containers = ((Pod) item).getSpec().getContainers();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
} else if (item instanceof ReplicationController) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
List<Container> containers = ((ReplicationController) item).getSpec().getTemplate().getSpec().getContainers();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
} else if (item instanceof ReplicaSet) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
List<Container> containers = ((ReplicaSet) item).getSpec().getTemplate().getSpec().getContainers();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
} else if (item instanceof DeploymentConfig) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
List<Container> containers = ((DeploymentConfig) item).getSpec().getTemplate().getSpec().getContainers();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
} else if (item instanceof Deployment) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
List<Container> containers = ((Deployment) item).getSpec().getTemplate().getSpec().getContainers();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
for (Container container : containers) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
* Checks to see if there's a registry name already provided in the image name,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
public static boolean hasRegistry(String imageName) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
if (imageName == null) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
"Pattern tagPattern = Pattern.compile(""^(.+?)(?::([^:/]+))?$"");",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
Matcher matcher = tagPattern.matcher(imageName);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
if (!matcher.matches()) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
"String[] parts = rest.split(""\\s*/\\s*"");",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,0
import io.fabric8.kubernetes.api.model.KubernetesList;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
List<Object> entities = new ArrayList<>();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
"Collections.sort(entities, new Comparator<Object>() {",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
List<Object> extraEntities = new ArrayList<>();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
for (Object entity : entities) {,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,1,1
import io.fabric8.kubernetes.api.KubernetesHelper;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
import io.fabric8.kubernetes.api.Namespace;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
import io.fabric8.openshift.api.model.template.Template;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
import static io.fabric8.kubernetes.api.extensions.Templates.overrideTemplateParameters;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
controller.setThrowExceptionOnError(true);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
controller.setRecreateMode(true);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
controller.setIgnoreRunningOAuthClients(true);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
controller.applyNamespace(namespaceDetails);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
"KubernetesHelper.setNamespace(template, namespace);",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
"overrideTemplateParameters(template, configuration.getProperties(), parameterNamePrefix);",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
},c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
kubeConfigs.add(kubeList);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
"controller.apply(entity, session.getId());",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
"//conditions.put(3, sessionPodsReady);",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
/**,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
*,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
*  with the License.  You may obtain a copy of the License at,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
*  implied.  See the License for the specific language governing,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
*  permissions and limitations under the License.,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
*/,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
package io.fabric8.forge.kubernetes;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.Container;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.ContainerPort;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.EnvVar;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.Pod;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.PodSpec;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.PodStatus;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.Volume;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.VolumeMount;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.context.UIContext;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.util.Categories;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.util.Metadata;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.util.Collection;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.util.List;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.util.Map;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import static io.fabric8.kubernetes.api.KubernetesHelper.getStatusText;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
@Override,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"return Metadata.from(super.getMetadata(context), getClass())",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
.category(Categories.create(CATEGORY)),c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
},c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"System.out.println(""Labels: "");",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"printValue(""Host"", currentState.getHostIP());",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"printValue(""IP"", currentState.getPodIP());",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"printValue(""Status"", getStatusText(currentState));",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"System.out.println(""Containers:"");",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
indentCount++;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"printValue(""Name"", container.getName());",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"printValue(""Image"", container.getImage());",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"printValue(""Working Dir"", container.getWorkingDir());",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"printValue(""Command"", container.getCommand());",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"println(""Ports:"");",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"printValue(""Name"", port.getName());",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"printValue(""Protocol"", port.getProtocol());",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"printValue(""Host Port"", port.getHostPort());",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"printValue(""Container Port"", port.getContainerPort());",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
indentCount--;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"println(""Environment:"");",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"printValue(env.getName(), env.getValue());",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"println(""Volume Mounts:"");",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"printValue(""Name"", volumeMount.getName());",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"printValue(""Mount Path"", volumeMount.getMountPath());",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"printValue(""Read Only"", volumeMount.getReadOnly());",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"System.out.println(""Volumes: "");",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
return ports != null && !ports.isEmpty();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"println(indentCount, text);",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"printValue(name, value, indentCount);",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
System.out.print(indent);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
System.out.println(text);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
/**,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
*,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
*  with the License.  You may obtain a copy of the License at,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
*  implied.  See the License for the specific language governing,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
*  permissions and limitations under the License.,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
*/,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
package io.fabric8.forge.kubernetes;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.KubernetesHelper;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.Container;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.Pod;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.PodList;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.PodSpec;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.PodStatus;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.utils.Filter;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.utils.TablePrinter;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.context.UIContext;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.input.UIInput;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.result.Result;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.util.Categories;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.util.Metadata;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import javax.inject.Inject;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.util.Collections;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.util.List;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.util.Map;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
@Inject,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
UIInput<String> filterText;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
@Override,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"return Metadata.from(super.getMetadata(context), getClass())",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
.category(Categories.create(CATEGORY)),c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
},c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
super.initializeUI(builder);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
builder.add(filterText);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
KubernetesHelper.removeEmptyPods(pods);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
return tableResults(table);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"table.columns(""id"", ""image(s)"", ""host"", ""labels"", ""status"");",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"table.row(id, image, host, labels, status);",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
return table;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
/**,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
*,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
*  with the License.  You may obtain a copy of the License at,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
*  implied.  See the License for the specific language governing,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
*  permissions and limitations under the License.,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
*/,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
package io.fabric8.forge.kubernetes;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.KubernetesHelper;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.ReplicationController;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.ReplicationControllerList;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.ReplicationControllerSpec;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.ReplicationControllerStatus;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.utils.Filter;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.utils.TablePrinter;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.context.UIContext;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.input.UIInput;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.result.Result;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.util.Categories;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.util.Metadata;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import javax.inject.Inject;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.io.PrintStream;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.util.Collections;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.util.List;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import static io.fabric8.kubernetes.api.KubernetesHelper.toPositiveNonZeroText;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
@Inject,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
UIInput<String> filterText;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
@Override,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"return Metadata.from(super.getMetadata(context), getClass())",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
.category(Categories.create(CATEGORY)),c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
},c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
super.initializeUI(builder);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
builder.add(filterText);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"printReplicationControllers(replicationControllers, System.out);",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
return null;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"table.columns(""id"", ""labels"", ""replicas"", ""replica selector"");",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"table.row(id, labels, toPositiveNonZeroText(replicas), selector);",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
table.print();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
/**,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
*,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
*  with the License.  You may obtain a copy of the License at,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
*  implied.  See the License for the specific language governing,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
*  permissions and limitations under the License.,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
*/,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
package io.fabric8.forge.kubernetes;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.KubernetesHelper;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.Service;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.ServiceList;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.utils.Filter;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.utils.Strings;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.utils.TablePrinter;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.context.UIContext;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.input.UIInput;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.result.Result;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.util.Categories;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import org.jboss.forge.addon.ui.util.Metadata;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import javax.inject.Inject;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.io.PrintStream;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.util.ArrayList;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.util.Collections;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.util.List;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.util.Set;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import static io.fabric8.kubernetes.api.KubernetesHelper.getPorts;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import static io.fabric8.kubernetes.api.KubernetesHelper.getSelector;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
@Inject,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
UIInput<String> filterText;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
@Override,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"return Metadata.from(super.getMetadata(context), getClass())",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
.category(Categories.create(CATEGORY)),c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
},c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
super.initializeUI(builder);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
builder.add(filterText);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"printServices(services, System.out);",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
return null;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"table.columns(""id"", ""labels"", ""selector"", ""port"");",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"table.row(KubernetesHelper.getName(service), labels, selector, portText);",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
table.print();,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
assertThat(pod).metadata().name().isEqualTo(expectedId);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
assertThat(pod).metadata().labels().isEqualTo(expectedLabels);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
@Override,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
"assertThat(pod).metadata().name().isEqualTo(""cheese"");",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
},c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
});,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
"assertThat(pod).describedAs(""my pod"").metadata().name().isEqualTo(""cheese"");",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
assertThat(pod).metadata().labels().isEqualTo(wrongLabels);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
assertThat(pod.getMetadata()).hasName(expectedId).hasLabels(expectedLabels);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
"assertThat(pod.getMetadata()).hasName(""cheese"");",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
assertThat(pod.getMetadata()).hasLabels(wrongLabels);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.*;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
import io.fabric8.kubernetes.internal.HasMetadataComparator;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
import java.util.*;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
import java.util.regex.Matcher;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
import java.util.regex.Pattern;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
if (Strings.isNotBlank(registry)){,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
"addRegistryToImageNameIfNotPresent(entities, registry);",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
},c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
items.addAll(entities);,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
if (Strings.isNotBlank(System.getenv(Constants.FABRIC8_DOCKER_REGISTRY_SERVICE_HOST))){,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
return null;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
"addRegistryToImageNameIfNotPresent(list.getItems(), registry);",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
"addRegistryToImageNameIfNotPresent(template.getObjects(), registry);",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
"prefixRegistryIfNotPresent(containers, registry);",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
if (!hasRegistry(container.getImage())){,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
"container.setImage(registry+""/""+container.getImage());",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
/**,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
*,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
"* Code influenced from <a href=""https://github.com/rhuss/docker-maven-plugin/blob/master/src/main/java/org/jolokia/docker/maven/util/ImageName.java"">docker-maven-plugin</a>",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
* @param imageName,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
* @return true if the image name contains a registry,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
*/,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
"throw new NullPointerException(""Image name must not be null"");",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
"return part.contains(""."") || part.contains("":"");",c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,0
import io.fabric8.kubernetes.api.model.HasMetadata;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.KubernetesListBuilder;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.KubernetesResource;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.ObjectMeta;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.ObjectReference;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.ObjectReferenceBuilder;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.Pod;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.ReplicationController;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.Secret;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.SecurityContextConstraints;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.Service;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.ServiceAccount;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import io.fabric8.kubernetes.api.model.ServiceAccountBuilder;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.util.ArrayList;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.util.Collections;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.util.Comparator;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.util.HashMap;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.util.HashSet;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.util.LinkedHashSet;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.util.LinkedList;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.util.List;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.util.Map;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.util.Set;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
import java.util.TreeMap;,c63a8efbb5ca98194ade5b5a635d4f499e3187cf,0,1
* Returns true if this entity has a valid non blank resourceVersion in its metadata,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,2,0
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""name""),",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,2,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""id"")",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,2,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""namespace""));",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,2,1
import io.fabric8.kubernetes.api.model.HasMetadata;,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,1,0
* Returns the resource version for the entity or null if it does not have one,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,1,0
ObjectMeta metadata = entity.getMetadata();,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,1,0
ObjectMeta metadata = getOrCreateMetadata(entity);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,1,0
ObjectMeta metadata = entity.getMetadata();,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,1,1
metadata = new ObjectMeta();,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,1,1
import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,1,0
ObjectMeta metadata = getOrCreateMetadata(entity);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,1,0
import io.fabric8.kubernetes.api.model.Endpoints;,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,1,1
import io.fabric8.kubernetes.api.model.Namespace;,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,1,1
import io.fabric8.kubernetes.api.model.Node;,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,1,1
import io.fabric8.openshift.api.model.Build;,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,1,1
import io.fabric8.openshift.api.model.BuildConfig;,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,1,1
import io.fabric8.openshift.api.model.DeploymentConfig;,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,1,1
import io.fabric8.openshift.api.model.ImageStream;,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,1,1
if (object instanceof HasMetadata) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
return getName((HasMetadata) object);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
public static ObjectMeta getOrCreateMetadata(HasMetadata entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
/**,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
*/,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
public static String getResourceVersion(HasMetadata entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
if (entity != null) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
if (metadata != null) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
String resourceVersion = metadata.getResourceVersion();,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
if (Strings.isNotBlank(resourceVersion)) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
return resourceVersion;,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
},5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
return null;,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
public static boolean hasResourceVersion(HasMetadata entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
return getResourceVersion(entity) != null;,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
public static String getName(HasMetadata entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
return getName(entity.getMetadata());,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
"public static void setName(HasMetadata entity, String name) {",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
"public static void setName(HasMetadata entity, String namespace, String name) {",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
metadata.setNamespace(namespace);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
metadata.setName(name);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
"public static void setNamespace(HasMetadata entity, String namespace) {",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
public static String getNamespace(HasMetadata entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
return getNamespace(entity.getMetadata());,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
"public static Map<String, String> getLabels(HasMetadata entity) {",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
return getLabels(entity.getMetadata());,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
return Collections.EMPTY_MAP;,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
public static List<HasMetadata> toItemList(Object entity) throws IOException {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
return (List<HasMetadata>) entity;,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
} else if (entity instanceof HasMetadata[]) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
HasMetadata[] array = (HasMetadata[]) entity;,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
List<HasMetadata> answer = new ArrayList<>();,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
if (entity instanceof HasMetadata) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
answer.add((HasMetadata) entity);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
List<HasMetadata> items = list.getItems();,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
public static void moveServicesToFrontOfArray(List<HasMetadata> list) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
HasMetadata item = list.get(i);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
HasMetadata nonService = list.get(lastNonService);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
protected static void removeDuplicates(List<HasMetadata> itemArray) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
HasMetadata item = itemArray.get(i);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
List<HasMetadata> items = kubernetesList.getItems();,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
List<HasMetadata> items = toItemList(dto);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
if (object instanceof Pod) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
return getName((Pod) object);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
} else if (object instanceof ReplicationController) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
return getName((ReplicationController) object);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
} else if (object instanceof Service) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
return getName((Service) object);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
} else if (object instanceof Route) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
return getName((Route) object);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static ObjectMeta getOrCreateMetadata(Pod entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
if (metadata == null) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
entity.setMetadata(metadata);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
},5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
return metadata;,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static ObjectMeta getOrCreateMetadata(ReplicationController entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static ObjectMeta getOrCreateMetadata(Service entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static ObjectMeta getOrCreateMetadata(Namespace entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static ObjectMeta getOrCreateMetadata(Route entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static ObjectMeta getOrCreateMetadata(Build entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static ObjectMeta getOrCreateMetadata(BuildConfig entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static ObjectMeta getOrCreateMetadata(DeploymentConfig entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static ObjectMeta getOrCreateMetadata(ImageStream entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static ObjectMeta getOrCreateMetadata(OAuthClient entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static ObjectMeta getOrCreateMetadata(Template entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static String getName(Pod entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
"return Strings.firstNonBlank(getName(entity.getMetadata()),",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
"getAdditionalPropertyText(entity.getAdditionalProperties(), ""name""),",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static String getName(ReplicationController entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
if (entity != null) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
} else {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
return null;,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static String getName(Service entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static String getName(OAuthClient entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static String getName(Route entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static String getName(Node entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static String getName(Template entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static String getName(ImageStream entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static String getName(Endpoints entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
"public static void setName(Pod entity, String name) {",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
"public static void setName(Service entity, String name) {",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
getOrCreateMetadata(entity).setName(name);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
"public static void setName(ReplicationController entity, String name) {",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
"public static void setName(Route entity, String namespace, String name) {",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
ObjectMeta objectMeta = getOrCreateMetadata(entity);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
objectMeta.setNamespace(namespace);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
objectMeta.setName(name);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
"public static void setName(Template entity, String name) {",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
"public static void setNamespace(Template entity, String namespace) {",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static String getNamespace(Pod entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
"return Strings.firstNonBlank(getNamespace(entity.getMetadata()),",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
"getAdditionalPropertyText(entity.getAdditionalProperties(), ""namespace""),",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static String getNamespace(ReplicationController entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static String getNamespace(Service entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static String getNamespace(OAuthClient entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static String getNamespace(Route entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static String getNamespace(Template entity) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
"protected static Object getAdditionalProperty(Map<String, Object> additionalProperties, String name) {",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
if (additionalProperties != null) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
return additionalProperties.get(name);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
"protected static String getAdditionalNestedPropertyText(Map<String, Object> additionalProperties, String... names) {",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
int lastIdx = names.length - 1;,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
"Map<String, Object> map = additionalProperties;",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
for (int i = 0; i < lastIdx; i++) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
if (map == null) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
"map = getAdditionalPropertyMap(map, names[i]);",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
"return getAdditionalPropertyText(map, names[lastIdx]);",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static List<Object> toItemList(Object entity) throws IOException {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
return (List<Object>) entity;,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
} else if (entity instanceof Object[]) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
Object[] array = (Object[]) entity;,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
List<Object> answer = new ArrayList<>();,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
answer.add(answer);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
List<Object> items = list.getItems();,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
public static void moveServicesToFrontOfArray(List<Object> list) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
Object item = list.get(i);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
Object nonService = list.get(lastNonService);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
protected static void removeDuplicates(List<Object> itemArray) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
Object item = itemArray.get(i);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
List<Object> items = kubernetesList.getItems();,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
List<Object> items = toItemList(dto);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,1
"public static Map<String, String> getOrCreateAnnotations(HasMetadata entity) {",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
"Map<String, String> answer = metadata.getAnnotations();",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
if (answer == null) {,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
answer = new HashMap<>();,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
metadata.setAnnotations(answer);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
},5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
return answer;,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
"public static Map<String, String> getOrCreateLabels(HasMetadata entity) {",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
"Map<String, String> answer = metadata.getLabels();",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
metadata.setLabels(answer);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
/**,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
* Loads the YAML file for the given DTO class,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
*/,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
"public static <T> T loadYaml(InputStream in, Class<T> clazz) throws IOException {",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
byte[] data = Files.readBytes(in);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
"return loadYaml(data, clazz);",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
"public static <T> T loadYaml(File file, Class<T> clazz) throws IOException {",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
byte[] data = Files.readBytes(file);,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
"public static <T> T loadYaml(byte[] data, Class<T> clazz) throws IOException {",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
ObjectMapper mapper = new ObjectMapper(new YAMLFactory());,5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
"return mapper.readValue(data, clazz);",5e93e4b5de8ceda385c5700b0ffdbad89c32cbcf,0,0
"String updateTemplate(@PathParam(""name"") @NotNull String name, Template entity, @PathParam(""namespace"") String namespace) throws Exception;",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,10,0
"String deleteTemplate(@PathParam(""name"") @NotNull String name, @PathParam(""namespace"") String namespace) throws Exception;",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,8,0
"public static void setName(HasMetadata entity, String namespace, String name) {",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,6,0
"public static void setNamespace(HasMetadata entity, String namespace) {",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,6,0
"public static void setName(Route entity, String namespace, String name) {",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,6,1
"public static void setNamespace(Template entity, String namespace) {",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,6,1
"String processTemplate(Template entity, @PathParam(""namespace"") String namespace) throws Exception;",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,6,0
"String createTemplate(Template entity, @PathParam(""namespace"") String namespace) throws Exception;",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,6,0
"Template getTemplate(@PathParam(""name"") @NotNull String name, @PathParam(""namespace"") String namespace);",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,6,0
"String createTemplate(Template entity, @PathParam(""namespace"")  String namespace) throws Exception;",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,6,1
public static String getResourceVersion(HasMetadata entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,0
public static String getName(HasMetadata entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,0
"public static void setName(HasMetadata entity, String name) {",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,0
public static String getNamespace(HasMetadata entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,0
public static List<HasMetadata> toItemList(Object entity) throws IOException {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,0
public static String getName(Pod entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,1
public static String getName(ReplicationController entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,1
public static String getName(Service entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,1
public static String getName(OAuthClient entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,1
public static String getName(Route entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,1
public static String getName(Node entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,1
public static String getName(Template entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,1
public static String getName(ImageStream entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,1
public static String getName(Endpoints entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,1
"public static void setName(Pod entity, String name) {",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,1
"public static void setName(Service entity, String name) {",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,1
"public static void setName(ReplicationController entity, String name) {",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,1
"public static void setName(Template entity, String name) {",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,1
public static String getNamespace(Pod entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,1
public static String getNamespace(ReplicationController entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,1
public static String getNamespace(Service entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,1
public static String getNamespace(OAuthClient entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,1
public static String getNamespace(Route entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,1
public static String getNamespace(Template entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,1
public static List<Object> toItemList(Object entity) throws IOException {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,1
"public void doCreateBuildConfig(BuildConfig entity, String namespace ,String sourceName) {",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,5,0
public static ObjectMeta getOrCreateMetadata(HasMetadata entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,4,0
public static boolean hasResourceVersion(HasMetadata entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,4,0
"public static Map<String, String> getLabels(HasMetadata entity) {",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,4,0
public static ObjectMeta getOrCreateMetadata(Pod entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,4,1
public static ObjectMeta getOrCreateMetadata(ReplicationController entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,4,1
public static ObjectMeta getOrCreateMetadata(Service entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,4,1
public static ObjectMeta getOrCreateMetadata(Namespace entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,4,1
public static ObjectMeta getOrCreateMetadata(Route entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,4,1
public static ObjectMeta getOrCreateMetadata(Build entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,4,1
public static ObjectMeta getOrCreateMetadata(BuildConfig entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,4,1
public static ObjectMeta getOrCreateMetadata(DeploymentConfig entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,4,1
public static ObjectMeta getOrCreateMetadata(ImageStream entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,4,1
public static ObjectMeta getOrCreateMetadata(OAuthClient entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,4,1
public static ObjectMeta getOrCreateMetadata(Template entity) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,4,1
"protected static Object getAdditionalProperty(Map<String, Object> additionalProperties, String name) {",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,4,1
"Object answer = kubernetes.updateBuildConfig(id, entity, namespace);",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,4,0
public static void moveServicesToFrontOfArray(List<HasMetadata> list) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,3,0
"protected static String getAdditionalNestedPropertyText(Map<String, Object> additionalProperties, String... names) {",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,3,1
public static void moveServicesToFrontOfArray(List<Object> list) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,3,1
String namespace = KubernetesHelper.getNamespace(entity);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,3,0
"LOG.warn(""Creation disabled so not creating BuildConfig from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(entity));",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,3,0
"@Parameter(property = ""fabric8.label.project"", defaultValue = ""${project.artifactId}"")",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,3,0
String name = getProjectName();,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,3,0
public String getProjectName() {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,3,0
"@Parameter(property = ""fabric8.kubernetes.name"", defaultValue = ""${project.artifactId}"")",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,3,1
String name = getKubernetesName();,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,3,1
public String getKubernetesName() {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,3,1
* Returns the resource version for the entity or null if it does not have one,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,0
ObjectMeta metadata = entity.getMetadata();,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,0
if (metadata != null) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,0
String resourceVersion = metadata.getResourceVersion();,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,0
* Returns true if this entity has a valid non blank resourceVersion in its metadata,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,0
ObjectMeta metadata = getOrCreateMetadata(entity);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,0
} else if (entity instanceof HasMetadata[]) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,0
protected static void removeDuplicates(List<HasMetadata> itemArray) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,0
} else if (object instanceof ReplicationController) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,1
} else if (object instanceof Service) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,1
} else if (object instanceof Route) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,1
ObjectMeta metadata = entity.getMetadata();,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,1
if (metadata == null) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,1
metadata = new ObjectMeta();,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,1
return metadata;,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,1
} else {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,1
for (int i = 0; i < lastIdx; i++) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,1
} else if (entity instanceof Object[]) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,1
Object item = list.get(i);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,1
Object nonService = list.get(lastNonService);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,1
protected static void removeDuplicates(List<Object> itemArray) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,1
Object item = itemArray.get(i);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,1
"TemplateList getTemplates(@PathParam(""namespace"") String namespace);",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,0
String id = getName(entity);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,0
"Objects.notNull(id, ""No name for "" + entity + "" "" + sourceName);",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,0
namespace = kubernetes.getNamespace();,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,0
"BuildConfig old = kubernetes.getBuildConfig(id, namespace);",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,0
} else {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,0
String resourceVersion = KubernetesHelper.getResourceVersion(old);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,0
} catch (Exception e) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,0
"onApplyError(""Failed to update BuildConfig from "" + sourceName + "". "" + e + "". "" + entity, e);",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,0
public void setProjectName(String projectName) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,0
public void setKubernetesName(String kubernetesName) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,2,1
if (object instanceof HasMetadata) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
return getName((HasMetadata) object);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
if (entity != null) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
if (Strings.isNotBlank(resourceVersion)) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
return resourceVersion;,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
},016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
return null;,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
return getResourceVersion(entity) != null;,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
return getName(entity.getMetadata());,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
return getNamespace(entity.getMetadata());,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
return getLabels(entity.getMetadata());,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
return Collections.EMPTY_MAP;,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
return (List<HasMetadata>) entity;,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
HasMetadata[] array = (HasMetadata[]) entity;,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
List<HasMetadata> answer = new ArrayList<>();,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
if (entity instanceof HasMetadata) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
List<HasMetadata> items = list.getItems();,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
HasMetadata item = list.get(i);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
HasMetadata nonService = list.get(lastNonService);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
HasMetadata item = itemArray.get(i);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
List<HasMetadata> items = kubernetesList.getItems();,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
List<HasMetadata> items = toItemList(dto);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
if (object instanceof Pod) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
return getName((Pod) object);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
return getName((ReplicationController) object);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
return getName((Service) object);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
return getName((Route) object);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
},016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
"return Strings.firstNonBlank(getName(entity.getMetadata()),",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
if (entity != null) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
return null;,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
ObjectMeta objectMeta = getOrCreateMetadata(entity);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
"return Strings.firstNonBlank(getNamespace(entity.getMetadata()),",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
if (additionalProperties != null) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
return additionalProperties.get(name);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
int lastIdx = names.length - 1;,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
"Map<String, Object> map = additionalProperties;",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
if (map == null) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
"map = getAdditionalPropertyMap(map, names[i]);",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
"return getAdditionalPropertyText(map, names[lastIdx]);",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
return (List<Object>) entity;,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
Object[] array = (Object[]) entity;,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
List<Object> answer = new ArrayList<>();,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
List<Object> items = list.getItems();,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
List<Object> items = kubernetesList.getItems();,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
List<Object> items = toItemList(dto);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
if (Strings.isNullOrBlank(namespace)) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
},016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
if (isRunning(old)) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
"if (UserConfigurationCompare.configEqual(entity, old)) {",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
if (isRecreateMode()) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
"kubernetes.deleteBuildConfig(id, namespace);",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
try {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
"logGeneratedEntity(""Updated BuildConfig: "", namespace, entity, answer);",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
if (!isAllowCreate()) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
"kubernetes.createBuildConfig(entity, namespace);",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
"kubernetes.createBuildConfig(entity, getNamespace());",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
private String projectName;,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
"if (!labelMap.containsKey(""version"")) {",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
},016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
"if (!labelMap.containsKey(""project"") && Strings.isNotBlank(name)) {",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
return projectName;,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
this.projectName = projectName;,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,0
private String kubernetesName;,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
"setName(template, getKubernetesName());",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
if (labelMap.isEmpty() && Strings.isNotBlank(name)) {,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
return kubernetesName;,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
this.kubernetesName = kubernetesName;,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,1,1
import io.fabric8.kubernetes.api.model.HasMetadata;,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
/**,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
*/,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
metadata.setNamespace(namespace);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
metadata.setName(name);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
answer.add((HasMetadata) entity);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
entity.setMetadata(metadata);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,1
"getAdditionalPropertyText(entity.getAdditionalProperties(), ""name""),",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""name""),",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""id"")",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,1
);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,1
getOrCreateMetadata(entity).setName(name);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,1
objectMeta.setNamespace(namespace);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,1
objectMeta.setName(name);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,1
"getAdditionalPropertyText(entity.getAdditionalProperties(), ""namespace""),",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""namespace""));",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,1
answer.add(answer);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,1
/*,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
TODO uncomment when TemplateList is in the schema,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
"@Path(""templates"")",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
@GET,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
"@Produces(""application/json"")",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
*/,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
@POST,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
"@Consumes(""application/json"")",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
"@Path(""templates/{name}"")",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
@PUT,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
@DELETE,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
"@Consumes(""text/plain"")",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
import javax.ws.rs.QueryParam;,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,1
"LOG.info(""BuildConfig hasn't changed so not doing anything"");",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
"doCreateBuildConfig(entity, namespace, sourceName);",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
"LOG.info(""Updating BuildConfig from "" + sourceName);",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
KubernetesHelper.getOrCreateMetadata(entity).setResourceVersion(resourceVersion);,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
"setName(template, getProjectName());",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
"labelMap.put(""version"", project.getVersion());",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
// lets add a project label,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
"labelMap.put(""project"", name);",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,0
// lets add a default label,016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,1
"labelMap.put(""component"", name);",016f30ee6c2207cafc20ff3d2bffd5e8fda22647,0,1
"onApplyError(""Failed to update pod from "" + sourceName + "". "" + e + "". "" + entity, e);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,13,0
"onApplyError(""Failed to update pod from "" + sourceName + "". "" + e + "". "" + entity, e);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,13,1
"Objects.notNull(id, ""No name for "" + entity + "" "" + sourceName);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,10,0
"Objects.notNull(id, ""No name for "" + entity + "" "" + sourceName);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,10,1
"LOG.warn(""Creation disabled so not creating an OAuthClient from "" + sourceName + "" name "" + getName(entity));",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,8,0
"LOG.warn(""Creation disabled so not creating an OAuthClient from "" + sourceName + "" name "" + getName(entity));",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,8,1
* Returns the resource version for the entity or null if it does not have one,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,6,0
"public static void setName(HasMetadata entity, String namespace, String name) {",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,6,0
"public static void setNamespace(HasMetadata entity, String namespace) {",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,6,0
"public static void setName(Route entity, String namespace, String name) {",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,6,1
"public static void setNamespace(Template entity, String namespace) {",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,6,1
public static String getResourceVersion(HasMetadata entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,5,0
public static String getName(HasMetadata entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,5,0
"public static void setName(HasMetadata entity, String name) {",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,5,0
public static String getNamespace(HasMetadata entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,5,0
public static String getName(Pod entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,5,1
public static String getName(ReplicationController entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,5,1
public static String getName(Service entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,5,1
public static String getName(OAuthClient entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,5,1
public static String getName(Route entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,5,1
public static String getName(Node entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,5,1
public static String getName(Template entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,5,1
public static String getName(ImageStream entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,5,1
public static String getName(Endpoints entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,5,1
"public static void setName(Pod entity, String name) {",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,5,1
"public static void setName(Service entity, String name) {",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,5,1
"public static void setName(ReplicationController entity, String name) {",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,5,1
"public static void setName(Template entity, String name) {",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,5,1
public static String getNamespace(Pod entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,5,1
public static String getNamespace(ReplicationController entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,5,1
public static String getNamespace(Service entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,5,1
public static String getNamespace(OAuthClient entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,5,1
public static String getNamespace(Route entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,5,1
public static String getNamespace(Template entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,5,1
public static ObjectMeta getOrCreateMetadata(HasMetadata entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,4,0
if (metadata != null) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,4,0
* Returns true if this entity has a valid non blank resourceVersion in its metadata,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,4,0
public static boolean hasResourceVersion(HasMetadata entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,4,0
"public static Map<String, String> getLabels(HasMetadata entity) {",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,4,0
public static List<HasMetadata> toItemList(Object entity) throws IOException {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,4,0
public static ObjectMeta getOrCreateMetadata(Pod entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,4,1
if (metadata == null) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,4,1
public static ObjectMeta getOrCreateMetadata(ReplicationController entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,4,1
public static ObjectMeta getOrCreateMetadata(Service entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,4,1
public static ObjectMeta getOrCreateMetadata(Namespace entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,4,1
public static ObjectMeta getOrCreateMetadata(Route entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,4,1
public static ObjectMeta getOrCreateMetadata(Build entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,4,1
public static ObjectMeta getOrCreateMetadata(BuildConfig entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,4,1
public static ObjectMeta getOrCreateMetadata(DeploymentConfig entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,4,1
public static ObjectMeta getOrCreateMetadata(ImageStream entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,4,1
public static ObjectMeta getOrCreateMetadata(OAuthClient entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,4,1
public static ObjectMeta getOrCreateMetadata(Template entity) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,4,1
"protected static Object getAdditionalProperty(Map<String, Object> additionalProperties, String name) {",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,4,1
public static List<Object> toItemList(Object entity) throws IOException {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,4,1
"public static Map<String, String> getOrCreateAnnotations(HasMetadata entity) {",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,4,0
"public static Map<String, String> getOrCreateLabels(HasMetadata entity) {",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,4,0
* Loads the YAML file for the given DTO class,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,4,0
if (entity != null) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,0
} else if (entity instanceof HasMetadata[]) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,0
public static void moveServicesToFrontOfArray(List<HasMetadata> list) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,0
} else if (object instanceof ReplicationController) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,1
} else if (object instanceof Service) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,1
} else if (object instanceof Route) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,1
if (entity != null) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,1
if (additionalProperties != null) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,1
"protected static String getAdditionalNestedPropertyText(Map<String, Object> additionalProperties, String... names) {",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,1
if (map == null) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,1
} else if (entity instanceof Object[]) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,1
public static void moveServicesToFrontOfArray(List<Object> list) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,1
if (answer == null) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,0
"public static <T> T loadYaml(InputStream in, Class<T> clazz) throws IOException {",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,0
"public static <T> T loadYaml(File file, Class<T> clazz) throws IOException {",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,0
"public static <T> T loadYaml(byte[] data, Class<T> clazz) throws IOException {",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,0
if (kubernetes == null) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,0
if (factory == null) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,0
"return getKubernetes().updateReplicationController(controllerId, entity, namespace);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,0
"return getKubernetes().updateService(serviceId, entity, namespace);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,0
public Kubernetes getKubernetes(boolean writeable) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,1
if (kubernetesWriteable == null) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,1
if (kubernetes == null) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,1
if (factoryWriteable == null) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,1
if (factoryReadOnly == null) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,1
"return getWriteableKubernetes().updateReplicationController(controllerId, entity, namespace);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,1
"return getWriteableKubernetes().updateService(serviceId, entity, namespace);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,1
String id = getName(entity);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,0
String id = getName(entity);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,3,1
if (object instanceof HasMetadata) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
ObjectMeta metadata = entity.getMetadata();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
String resourceVersion = metadata.getResourceVersion();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
if (Strings.isNotBlank(resourceVersion)) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
ObjectMeta metadata = getOrCreateMetadata(entity);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
if (entity instanceof HasMetadata) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
protected static void removeDuplicates(List<HasMetadata> itemArray) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
if (object instanceof Pod) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
ObjectMeta metadata = entity.getMetadata();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
metadata = new ObjectMeta();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
return metadata;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""name""),",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""id"")",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
} else {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""namespace""));",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
for (int i = 0; i < lastIdx; i++) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
Object item = list.get(i);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
Object nonService = list.get(lastNonService);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
protected static void removeDuplicates(List<Object> itemArray) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
Object item = itemArray.get(i);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
ObjectMeta metadata = getOrCreateMetadata(entity);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
kubernetes = getFactory().createKubernetes();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
public KubernetesFactory getFactory() {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
"return getKubernetes().deletePod(podId, namespace);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
"return getKubernetes().deleteReplicationController(controllerId, namespace);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
"return getKubernetes().deleteService(serviceId, namespace);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
"return getKubernetes().createPod(entity, namespace);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
"return getKubernetes().createService(entity, namespace);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
"return getKubernetes().createReplicationController(entity, namespace);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
String openShiftToken = getFactory().findOpenShiftToken();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
"public KubernetesClient(KubernetesFactory factoryReadOnly, KubernetesFactory factoryWriteable) {",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
if (writeable) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
} else {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
kubernetes = getFactory(false).createKubernetes();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
public KubernetesFactory getFactory(boolean writeable) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
public void setWriteableFactory(KubernetesFactory factory) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
"return getWriteableKubernetes().deletePod(podId, namespace);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
"return getWriteableKubernetes().deleteReplicationController(controllerId, namespace);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
"return getWriteableKubernetes().deleteService(serviceId, namespace);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
"return getWriteableKubernetes().createPod(entity, namespace);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
"return getWriteableKubernetes().createService(entity, namespace);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
"return getWriteableKubernetes().createReplicationController(entity, namespace);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
String openShiftToken = getFactory(false).findOpenShiftToken();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
protected Kubernetes getWriteableKubernetes() {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
if (supportOAuthClients) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
if (isServicesOnlyMode()) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
"LOG.debug(""Only processing Services right now so ignoring OAuthClient: "" + id);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
if (isRunning(old)) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
if (isIgnoreRunningOAuthClients()) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
"if (UserConfigurationCompare.configEqual(entity, old)) {",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
if (isRecreateMode()) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
} else {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
"Object answer = kubernetes.updateOAuthClient(id, entity);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
"LOG.info(""Updated pod result: "" + answer);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
} catch (Exception e) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
if (!isAllowCreate()) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
public boolean isSupportOAuthClients() {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
public void setSupportOAuthClients(boolean supportOAuthClients) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,0
if (isServicesOnlyMode()) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
"LOG.debug(""Only processing Services right now so ignoring OAuthClient: "" + id);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
if (isRunning(old)) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
if (isIgnoreRunningOAuthClients()) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
"if (UserConfigurationCompare.configEqual(entity, old)) {",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
} else {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
if (isRecreateMode()) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
"Object answer = kubernetes.updateOAuthClient(id, entity);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
"LOG.info(""Updated pod result: "" + answer);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
} catch (Exception e) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
if (!isAllowCreate()) {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,2,1
import io.fabric8.kubernetes.api.model.HasMetadata;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
return getName((HasMetadata) object);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
return resourceVersion;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
},a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
return null;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
return getResourceVersion(entity) != null;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
return getName(entity.getMetadata());,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
return getNamespace(entity.getMetadata());,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
return getLabels(entity.getMetadata());,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
return Collections.EMPTY_MAP;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
return (List<HasMetadata>) entity;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
HasMetadata[] array = (HasMetadata[]) entity;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
List<HasMetadata> answer = new ArrayList<>();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
List<HasMetadata> items = list.getItems();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
HasMetadata item = list.get(i);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
HasMetadata nonService = list.get(lastNonService);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
HasMetadata item = itemArray.get(i);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
List<HasMetadata> items = kubernetesList.getItems();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
List<HasMetadata> items = toItemList(dto);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
return getName((Pod) object);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
return getName((ReplicationController) object);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
return getName((Service) object);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
return getName((Route) object);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
},a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
"return Strings.firstNonBlank(getName(entity.getMetadata()),",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
return null;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
ObjectMeta objectMeta = getOrCreateMetadata(entity);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
"return Strings.firstNonBlank(getNamespace(entity.getMetadata()),",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
return additionalProperties.get(name);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
int lastIdx = names.length - 1;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
"Map<String, Object> map = additionalProperties;",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
"map = getAdditionalPropertyMap(map, names[i]);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
"return getAdditionalPropertyText(map, names[lastIdx]);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
return (List<Object>) entity;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
Object[] array = (Object[]) entity;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
List<Object> answer = new ArrayList<>();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
List<Object> items = list.getItems();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
List<Object> items = kubernetesList.getItems();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
List<Object> items = toItemList(dto);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
"Map<String, String> answer = metadata.getAnnotations();",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
answer = new HashMap<>();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
},a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
return answer;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
"Map<String, String> answer = metadata.getLabels();",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
byte[] data = Files.readBytes(in);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
"return loadYaml(data, clazz);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
byte[] data = Files.readBytes(file);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
ObjectMapper mapper = new ObjectMapper(new YAMLFactory());,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
"return mapper.readValue(data, clazz);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
import io.fabric8.kubernetes.api.model.Endpoints;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
import io.fabric8.kubernetes.api.model.Namespace;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
import io.fabric8.kubernetes.api.model.Node;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
import io.fabric8.openshift.api.model.Build;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
import io.fabric8.openshift.api.model.BuildConfig;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
import io.fabric8.openshift.api.model.DeploymentConfig;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
import io.fabric8.openshift.api.model.ImageStream;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
this.factory = factory;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
return kubernetes;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
kubernetesExtensions = getFactory().createKubernetesExtensions();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
kubernetesGlobalExtensions = getFactory().createKubernetesGlobalExtensions();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
factory = new KubernetesFactory();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
return factory;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
return getFactory().getAddress();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
"return getKubernetes().deletePod(podId, getNamespace());",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
"return getKubernetes().deleteReplicationController(controllerId, getNamespace());",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
WebClient webClient = getFactory().createWebClient();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
WebSocketClient client = getFactory().createWebSocketClient();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
KubernetesFactory factory = getFactory();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
private Kubernetes kubernetesWriteable;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
this.factoryReadOnly = factory;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
},a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
this.factoryReadOnly = factoryReadOnly;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
this.factoryWriteable = factoryWriteable;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
return getKubernetes(false);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
kubernetesWriteable = getFactory(true).createKubernetes();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
return kubernetesWriteable;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
return kubernetes;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
kubernetesExtensions = getFactory(true).createKubernetesExtensions();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
kubernetesGlobalExtensions = getFactory(true).createKubernetesGlobalExtensions();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
factoryWriteable = new KubernetesFactory(true);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
return factoryWriteable;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
factoryReadOnly = new KubernetesFactory();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
return factoryReadOnly;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
this.factoryWriteable = factory;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
return getFactory(false).getAddress();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
return getFactory(true).getAddress();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
"return getWriteableKubernetes().deletePod(podId, getNamespace());",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
"return getWriteableKubernetes().deleteReplicationController(controllerId, getNamespace());",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
WebClient webClient = getFactory(true).createWebClient();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
WebSocketClient client = getFactory(false).createWebSocketClient();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
KubernetesFactory factory = getFactory(true);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
return getKubernetes(true);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
OAuthClient old = kubernetes.getOAuthClient(id);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
"LOG.info(""Not updating the OAuthClient which are shared across namespaces as its already running"");",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
},a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
"doCreateOAuthClient(entity, sourceName);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
try {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
return supportOAuthClients;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
this.supportOAuthClients = supportOAuthClients;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
},a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
OAuthClient old = kubernetes.getOAuthClient(id);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
"LOG.info(""Not updating the OAuthClient which are shared across namespaces as its already running"");",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
"doCreateOAuthClient(entity, sourceName);",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
try {,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,1
import io.fabric8.kubernetes.api.root.RootPaths;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,1,0
/**,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,0
*/,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,0
metadata.setNamespace(namespace);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,0
metadata.setName(name);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,0
answer.add((HasMetadata) entity);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,0
entity.setMetadata(metadata);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,1
"getAdditionalPropertyText(entity.getAdditionalProperties(), ""name""),",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,1
);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,1
getOrCreateMetadata(entity).setName(name);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,1
objectMeta.setNamespace(namespace);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,1
objectMeta.setName(name);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,1
"getAdditionalPropertyText(entity.getAdditionalProperties(), ""namespace""),",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,1
answer.add(answer);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,1
metadata.setAnnotations(answer);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,0
metadata.setLabels(answer);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,0
/**,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,0
*/,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,0
private KubernetesFactory factory;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,0
private KubernetesFactory factoryReadOnly;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,1
private KubernetesFactory factoryWriteable;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,1
private boolean supportOAuthClients;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,0
return;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,0
"LOG.info(""OAuthClient hasn't changed so not doing anything"");",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,0
kubernetes.deleteOAuthClient(id);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,0
return;,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,1
"LOG.info(""OAuthClient hasn't changed so not doing anything"");",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,1
kubernetes.deleteOAuthClient(id);,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,1
"@Path(""/"")",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,0
@GET,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,0
RootPaths getRootPaths();,a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,0
"@Path(""oapi/v1/oauthclients"")",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,0
"@Path(""oapi/v1/oauthclients/{name}"")",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,0
"@Path(""oapi/v1"")",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,1
"@Path(""oauthclients"")",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,1
"@Path(""oauthclients/{name}"")",a92a7cdc814d30d160ac59fd9cc48e67be988dc9,0,1
"LOG.warn(""Creation disabled so not creating a entity from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(entity));",2852d11515adbba69955f81394c73fd9992358b6,14,0
"LOG.warn(""Creation disabled so not creating a entity from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(entity));",2852d11515adbba69955f81394c73fd9992358b6,14,1
"onApplyError(""Failed to template entity from "" + sourceName + "". "" + e + "". "" + entity, e);",2852d11515adbba69955f81394c73fd9992358b6,13,0
"onApplyError(""Failed to update pod from "" + sourceName + "". "" + e + "". "" + entity, e);",2852d11515adbba69955f81394c73fd9992358b6,13,0
"onApplyError(""Failed to update pod from "" + sourceName + "". "" + e + "". "" + entity, e);",2852d11515adbba69955f81394c73fd9992358b6,13,1
"LOG.warn(""Creation disabled so not creating a Template from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(entity));",2852d11515adbba69955f81394c73fd9992358b6,13,0
"onApplyError(""Failed to Template entity from "" + sourceName + "". "" + e + "". "" + entity, e);",2852d11515adbba69955f81394c73fd9992358b6,13,0
"LOG.warn(""Creation disabled so not creating a ServiceAccount from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(serviceAccount));",2852d11515adbba69955f81394c73fd9992358b6,13,0
"LOG.warn(""Creation disabled so not creating a Secret from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(secret));",2852d11515adbba69955f81394c73fd9992358b6,13,0
"LOG.warn(""Creation disabled so not creating a Service from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(service));",2852d11515adbba69955f81394c73fd9992358b6,13,0
"LOG.warn(""Creation disabled so not creating a ReplicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",2852d11515adbba69955f81394c73fd9992358b6,13,0
"onApplyError(""Failed to update pod from "" + sourceName + "". "" + e + "". "" + entity, e);",2852d11515adbba69955f81394c73fd9992358b6,13,1
"onApplyError(""Failed to template entity from "" + sourceName + "". "" + e + "". "" + entity, e);",2852d11515adbba69955f81394c73fd9992358b6,13,1
"LOG.warn(""Creation disabled so not creating a service from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(serviceAccount));",2852d11515adbba69955f81394c73fd9992358b6,13,1
"LOG.warn(""Creation disabled so not creating a secret from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(secret));",2852d11515adbba69955f81394c73fd9992358b6,13,1
"LOG.warn(""Creation disabled so not creating a service from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(service));",2852d11515adbba69955f81394c73fd9992358b6,13,1
"LOG.warn(""Creation disabled so not creating a replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",2852d11515adbba69955f81394c73fd9992358b6,13,1
"LOG.info(""Updating a pod from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(pod));",2852d11515adbba69955f81394c73fd9992358b6,13,1
"LOG.info(""Creating a pod from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(pod));",2852d11515adbba69955f81394c73fd9992358b6,13,1
"onApplyError(""Failed to update controller from "" + sourceName + "". "" + e + "". "" + entity, e);",2852d11515adbba69955f81394c73fd9992358b6,12,0
"LOG.info(""Creating a template from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(entity));",2852d11515adbba69955f81394c73fd9992358b6,12,0
"onApplyError(""Failed to update OAuthClient from "" + sourceName + "". "" + e + "". "" + entity, e);",2852d11515adbba69955f81394c73fd9992358b6,12,0
"onApplyError(""Failed to update Template from "" + sourceName + "". "" + e + "". "" + entity, e);",2852d11515adbba69955f81394c73fd9992358b6,12,0
"LOG.info(""Creating a Template from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(entity));",2852d11515adbba69955f81394c73fd9992358b6,12,0
"LOG.info(""Creating a ServiceAccount from "" + sourceName + "" namespace "" + namespace + "" name "" + getName",2852d11515adbba69955f81394c73fd9992358b6,12,0
"LOG.info(""Creating a Secret from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(secret));",2852d11515adbba69955f81394c73fd9992358b6,12,0
"LOG.info(""Creating a Service from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(service));",2852d11515adbba69955f81394c73fd9992358b6,12,0
"LOG.info(""Updating ReplicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",2852d11515adbba69955f81394c73fd9992358b6,12,0
"LOG.info(""Creating a ReplicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",2852d11515adbba69955f81394c73fd9992358b6,12,0
"LOG.info(""Updating a Pod from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(pod));",2852d11515adbba69955f81394c73fd9992358b6,12,0
"LOG.info(""Creating a Pod from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(pod));",2852d11515adbba69955f81394c73fd9992358b6,12,0
"onApplyError(""Failed to update controller from "" + sourceName + "". "" + e + "". "" + entity, e);",2852d11515adbba69955f81394c73fd9992358b6,12,1
"LOG.info(""Creating a template from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(entity));",2852d11515adbba69955f81394c73fd9992358b6,12,1
"LOG.info(""Creating a service account from "" + sourceName + "" namespace "" + namespace + "" name "" + getName",2852d11515adbba69955f81394c73fd9992358b6,12,1
"LOG.info(""Creating a secret from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(secret));",2852d11515adbba69955f81394c73fd9992358b6,12,1
"LOG.info(""Creating a service from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(service));",2852d11515adbba69955f81394c73fd9992358b6,12,1
"LOG.info(""Updating replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",2852d11515adbba69955f81394c73fd9992358b6,12,1
"LOG.info(""Creating a replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",2852d11515adbba69955f81394c73fd9992358b6,12,1
"onApplyError(""Failed to update pod from "" + sourceName + "". "" + e + "". "" + pod, e);",2852d11515adbba69955f81394c73fd9992358b6,12,1
"onApplyError(""Failed to create pod from "" + sourceName + "". "" + e + "". "" + pod, e);",2852d11515adbba69955f81394c73fd9992358b6,12,1
"onApplyError(""Failed to apply result of template expansion from "" + sourceName + "". "" + e + "". "" + result, e);",2852d11515adbba69955f81394c73fd9992358b6,11,1
"onApplyError(""Failed to update ServiceAccount from "" + sourceName + "". "" + e + "". "" + serviceAccount, e);",2852d11515adbba69955f81394c73fd9992358b6,11,0
"onApplyError(""Failed to create ServiceAccount from "" + sourceName + "". "" + e + "". "" + serviceAccount, e);",2852d11515adbba69955f81394c73fd9992358b6,11,0
"onApplyError(""Failed to create Secret from "" + sourceName + "". "" + e + "". "" + secret, e);",2852d11515adbba69955f81394c73fd9992358b6,11,0
"onApplyError(""Failed to update Service from "" + sourceName + "". "" + e + "". "" + service, e);",2852d11515adbba69955f81394c73fd9992358b6,11,0
"onApplyError(""Failed to create Service from "" + sourceName + "". "" + e + "". "" + service, e);",2852d11515adbba69955f81394c73fd9992358b6,11,0
"onApplyError(""Failed to update ReplicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",2852d11515adbba69955f81394c73fd9992358b6,11,0
"onApplyError(""Failed to create ReplicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",2852d11515adbba69955f81394c73fd9992358b6,11,0
"onApplyError(""Failed to update Pod from "" + sourceName + "". "" + e + "". "" + pod, e);",2852d11515adbba69955f81394c73fd9992358b6,11,0
"onApplyError(""Failed to create Pod from "" + sourceName + "". "" + e + "". "" + pod, e);",2852d11515adbba69955f81394c73fd9992358b6,11,0
"onApplyError(""Failed to update service account from "" + sourceName + "". "" + e + "". "" + serviceAccount, e);",2852d11515adbba69955f81394c73fd9992358b6,11,1
"onApplyError(""Failed to create service account from "" + sourceName + "". "" + e + "". "" + serviceAccount, e);",2852d11515adbba69955f81394c73fd9992358b6,11,1
"onApplyError(""Failed to create secret from "" + sourceName + "". "" + e + "". "" + secret, e);",2852d11515adbba69955f81394c73fd9992358b6,11,1
"onApplyError(""Failed to update controller from "" + sourceName + "". "" + e + "". "" + service, e);",2852d11515adbba69955f81394c73fd9992358b6,11,1
"onApplyError(""Failed to create service from "" + sourceName + "". "" + e + "". "" + service, e);",2852d11515adbba69955f81394c73fd9992358b6,11,1
"onApplyError(""Failed to update replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",2852d11515adbba69955f81394c73fd9992358b6,11,1
"onApplyError(""Failed to create replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",2852d11515adbba69955f81394c73fd9992358b6,11,1
"Objects.notNull(id, ""No name for "" + entity + "" "" + sourceName);",2852d11515adbba69955f81394c73fd9992358b6,9,0
"Objects.notNull(id, ""No name for "" + entity + "" "" + sourceName);",2852d11515adbba69955f81394c73fd9992358b6,9,0
"LOG.warn(""Creation disabled so not creating an OAuthClient from "" + sourceName + "" name "" + getName(entity));",2852d11515adbba69955f81394c73fd9992358b6,9,0
"Objects.notNull(id, ""No name for "" + entity + "" "" + sourceName);",2852d11515adbba69955f81394c73fd9992358b6,9,1
"LOG.warn(""Creation disabled so not creating an OAuthClient from "" + sourceName + "" name "" + getName(entity));",2852d11515adbba69955f81394c73fd9992358b6,9,1
"onApplyError(""Failed to create namespace: "" + name + "" due "" + e.getMessage(), e);",2852d11515adbba69955f81394c73fd9992358b6,7,0
"onApplyError(""Failed to create namespace. "" + e + "". "" + entity, e);",2852d11515adbba69955f81394c73fd9992358b6,7,1
"LOG.warn(""Cannot convert "" + result + "" to JSON: "" + e, e);",2852d11515adbba69955f81394c73fd9992358b6,6,0
"LOG.info(""rollingUpgradePreserveScale "" + rollingUpgradePreserveScale + "" new replicas is "" + (newSpec != null ? newSpec.getReplicas() : ""<null>""));",2852d11515adbba69955f81394c73fd9992358b6,6,0
"LOG.warn(""Could not convert "" + result + "" to JSON: "" + e, e);",2852d11515adbba69955f81394c73fd9992358b6,6,1
"LOG.info(""rollingUpgradePreserveScale "" + rollingUpgradePreserveScale + "" new replicas is "" + newSpec.getReplicas());",2852d11515adbba69955f81394c73fd9992358b6,6,1
"LOG.info(""Rolling upgrade of the ReplicationController: "" + namespace + ""/"" + id);",2852d11515adbba69955f81394c73fd9992358b6,5,0
"LOG.info(""Rolling upgrade of the RC "" + namespace + ""/"" + id);",2852d11515adbba69955f81394c73fd9992358b6,5,1
"public ReplicationController getReplicationController(final @PathParam(""controllerId"") @NotNull String controllerId, final @QueryParam(""namespace"") String namespace) {",2852d11515adbba69955f81394c73fd9992358b6,4,0
"public Service getService(final @PathParam(""serviceId"") @NotNull String serviceId, final @QueryParam(""namespace"") String namespace) {",2852d11515adbba69955f81394c73fd9992358b6,4,0
"public Pod getPod(final @PathParam(""podId"") @NotNull String podId, final @QueryParam(""namespace"") String namespace) {",2852d11515adbba69955f81394c73fd9992358b6,4,0
"public Secret getSecret(final @NotNull String secretId, final String namespace) {",2852d11515adbba69955f81394c73fd9992358b6,4,0
"public Route getRoute(final @PathParam(""name"") @NotNull String name, final @QueryParam(""namespace"") String namespace) {",2852d11515adbba69955f81394c73fd9992358b6,4,0
"public Build getBuild(final @NotNull String name, final String namespace) {",2852d11515adbba69955f81394c73fd9992358b6,4,0
"public DeploymentConfig getDeploymentConfig(final @NotNull String name, final String namespace) {",2852d11515adbba69955f81394c73fd9992358b6,4,0
"public ImageStream getImageStream(final @NotNull String name, final String namespace) {",2852d11515adbba69955f81394c73fd9992358b6,4,0
"public ReplicationController getReplicationController(@PathParam(""controllerId"") @NotNull String controllerId, @QueryParam(""namespace"") String namespace) {",2852d11515adbba69955f81394c73fd9992358b6,4,1
"public Service getService(@PathParam(""serviceId"") @NotNull String serviceId, @QueryParam(""namespace"") String namespace) {",2852d11515adbba69955f81394c73fd9992358b6,4,1
"public Pod getPod(@PathParam(""podId"") @NotNull String podId, @QueryParam(""namespace"") String namespace) {",2852d11515adbba69955f81394c73fd9992358b6,4,1
"public Route getRoute(@PathParam(""name"") @NotNull String name, @QueryParam(""namespace"") String namespace) {",2852d11515adbba69955f81394c73fd9992358b6,4,1
"LOG.info(""Updating a entity from "" + sourceName);",2852d11515adbba69955f81394c73fd9992358b6,4,0
"protected void doCreateTemplate(Template entity, String namespace, String sourceName) {",2852d11515adbba69955f81394c73fd9992358b6,4,0
"LOG.debug(""Only processing Services right now so ignoring OAuthClient: "" + id);",2852d11515adbba69955f81394c73fd9992358b6,4,0
"LOG.debug(""Only processing Services right now so ignoring OAuthClient: "" + id);",2852d11515adbba69955f81394c73fd9992358b6,4,1
"LOG.info(""Updating a entity from "" + sourceName);",2852d11515adbba69955f81394c73fd9992358b6,4,1
public Namespace getNamespace(final @NotNull String name) {,2852d11515adbba69955f81394c73fd9992358b6,3,0
public OAuthClient getOAuthClient(final @NotNull String name) {,2852d11515adbba69955f81394c73fd9992358b6,3,0
} else {,2852d11515adbba69955f81394c73fd9992358b6,3,0
"public Secret getSecret(@NotNull String secretId, String namespace) {",2852d11515adbba69955f81394c73fd9992358b6,3,1
} else {,2852d11515adbba69955f81394c73fd9992358b6,3,1
"public Build getBuild(@NotNull String name, String namespace) {",2852d11515adbba69955f81394c73fd9992358b6,3,1
"public DeploymentConfig getDeploymentConfig(@NotNull String name, String namespace) {",2852d11515adbba69955f81394c73fd9992358b6,3,1
"public ImageStream getImageStream(@NotNull String name, String namespace) {",2852d11515adbba69955f81394c73fd9992358b6,3,1
* Creates/updates the template and processes it returning the processed DTOs,2852d11515adbba69955f81394c73fd9992358b6,3,0
"public Object applyTemplate(Template entity, String sourceName) throws Exception {",2852d11515adbba69955f81394c73fd9992358b6,3,0
} else {,2852d11515adbba69955f81394c73fd9992358b6,3,0
"public void applyTemplate(Template entity, String sourceName) {",2852d11515adbba69955f81394c73fd9992358b6,3,1
} else {,2852d11515adbba69955f81394c73fd9992358b6,3,0
"LOG.info(""Updated pod result: "" + answer);",2852d11515adbba69955f81394c73fd9992358b6,3,0
} else {,2852d11515adbba69955f81394c73fd9992358b6,3,1
"LOG.info(""Updated pod result: "" + answer);",2852d11515adbba69955f81394c73fd9992358b6,3,1
"LOG.info(""Updating a Template from "" + sourceName);",2852d11515adbba69955f81394c73fd9992358b6,3,0
"LOG.info(""Updating a ServiceAccount from "" + sourceName);",2852d11515adbba69955f81394c73fd9992358b6,3,0
"LOG.info(""Updating a Secret from "" + sourceName);",2852d11515adbba69955f81394c73fd9992358b6,3,0
"LOG.info(""Updating a Service from "" + sourceName);",2852d11515adbba69955f81394c73fd9992358b6,3,0
"LOG.info(kind + "" has not changed so not doing anything"");",2852d11515adbba69955f81394c73fd9992358b6,3,0
"LOG.info(""Updated pod result: "" + answer);",2852d11515adbba69955f81394c73fd9992358b6,3,1
"LOG.info(""Updating a service account from "" + sourceName);",2852d11515adbba69955f81394c73fd9992358b6,3,1
"LOG.info(""Updateing a secret from "" + sourceName);",2852d11515adbba69955f81394c73fd9992358b6,3,1
"LOG.info(""Updating a service from "" + sourceName);",2852d11515adbba69955f81394c73fd9992358b6,3,1
"LOG.info(kind + "" hasn't changed so not doing anything"");",2852d11515adbba69955f81394c73fd9992358b6,3,1
"LOG.info(""Created pod result: "" + answer);",2852d11515adbba69955f81394c73fd9992358b6,3,1
return handle404ByReturningNull(new Callable<Namespace>() {,2852d11515adbba69955f81394c73fd9992358b6,2,0
return handle404ByReturningNull(new Callable<ReplicationController>() {,2852d11515adbba69955f81394c73fd9992358b6,2,0
if (!KubernetesHelper.hasResourceVersion(entity)) {,2852d11515adbba69955f81394c73fd9992358b6,2,0
// lets load it from the old service,2852d11515adbba69955f81394c73fd9992358b6,2,0
if (service == null) {,2852d11515adbba69955f81394c73fd9992358b6,2,0
// no service so lets create the service,2852d11515adbba69955f81394c73fd9992358b6,2,0
return handle404ByReturningNull(new Callable<Service>() {,2852d11515adbba69955f81394c73fd9992358b6,2,0
return handle404ByReturningNull(new Callable<Pod>() {,2852d11515adbba69955f81394c73fd9992358b6,2,0
return handle404ByReturningNull(new Callable<Secret>() {,2852d11515adbba69955f81394c73fd9992358b6,2,0
public SecretList getSecrets(final String namespace) {,2852d11515adbba69955f81394c73fd9992358b6,2,0
if (answer == null) {,2852d11515adbba69955f81394c73fd9992358b6,2,0
return handle404ByReturningNull(new Callable<OAuthClient>() {,2852d11515adbba69955f81394c73fd9992358b6,2,0
"public RouteList getRoutes(final @QueryParam(""namespace"") String namespace) {",2852d11515adbba69955f81394c73fd9992358b6,2,0
return handle404ByReturningNull(new Callable<Route>() {,2852d11515adbba69955f81394c73fd9992358b6,2,0
return handle404ByReturningNull(new Callable<Build>() {,2852d11515adbba69955f81394c73fd9992358b6,2,0
public BuildList getBuilds(final String namespace) {,2852d11515adbba69955f81394c73fd9992358b6,2,0
return handle404ByReturningNull(new Callable<DeploymentConfig>() {,2852d11515adbba69955f81394c73fd9992358b6,2,0
public DeploymentConfigList getDeploymentConfigs(final String namespace) {,2852d11515adbba69955f81394c73fd9992358b6,2,0
return handle404ByReturningNull(new Callable<ImageStream>() {,2852d11515adbba69955f81394c73fd9992358b6,2,0
public ImageStreamList getImageStreams(final String namespace) {,2852d11515adbba69955f81394c73fd9992358b6,2,0
} catch (WebApplicationException e) {,2852d11515adbba69955f81394c73fd9992358b6,2,0
if (e.getResponse().getStatus() == 404) {,2852d11515adbba69955f81394c73fd9992358b6,2,0
} catch (Exception e) {,2852d11515adbba69955f81394c73fd9992358b6,2,0
public Namespace getNamespace(@NotNull String name) {,2852d11515adbba69955f81394c73fd9992358b6,2,1
public OAuthClient getOAuthClient(@NotNull String name) {,2852d11515adbba69955f81394c73fd9992358b6,2,1
} catch (WebApplicationException e) {,2852d11515adbba69955f81394c73fd9992358b6,2,1
if (e.getResponse().getStatus() == 404) {,2852d11515adbba69955f81394c73fd9992358b6,2,1
"public RouteList getRoutes(@QueryParam(""namespace"") String namespace) {",2852d11515adbba69955f81394c73fd9992358b6,2,1
String id = getName(entity);,2852d11515adbba69955f81394c73fd9992358b6,2,0
if (isRunning(old)) {,2852d11515adbba69955f81394c73fd9992358b6,2,0
"if (UserConfigurationCompare.configEqual(entity, old)) {",2852d11515adbba69955f81394c73fd9992358b6,2,0
if (recreateMode) {,2852d11515adbba69955f81394c73fd9992358b6,2,0
"LOG.info(""Updated entity: "" + answer);",2852d11515adbba69955f81394c73fd9992358b6,2,0
} catch (Exception e) {,2852d11515adbba69955f81394c73fd9992358b6,2,0
if (!isAllowCreate()) {,2852d11515adbba69955f81394c73fd9992358b6,2,0
"return processTemplate(entity, sourceName);",2852d11515adbba69955f81394c73fd9992358b6,2,0
"LOG.info(""Created template: "" + answer);",2852d11515adbba69955f81394c73fd9992358b6,2,0
protected boolean isRunning(HasMetadata entity) {,2852d11515adbba69955f81394c73fd9992358b6,2,0
if (result != null) {,2852d11515adbba69955f81394c73fd9992358b6,2,1
} catch (Exception e) {,2852d11515adbba69955f81394c73fd9992358b6,2,1
protected boolean isRunning(OAuthClient entity) {,2852d11515adbba69955f81394c73fd9992358b6,2,1
return entity != null;,2852d11515adbba69955f81394c73fd9992358b6,2,1
protected boolean isRunning(Pod entity) {,2852d11515adbba69955f81394c73fd9992358b6,2,1
protected boolean isRunning(ReplicationController entity) {,2852d11515adbba69955f81394c73fd9992358b6,2,1
protected boolean isRunning(Service entity) {,2852d11515adbba69955f81394c73fd9992358b6,2,1
if (supportOAuthClients) {,2852d11515adbba69955f81394c73fd9992358b6,2,0
String id = getName(entity);,2852d11515adbba69955f81394c73fd9992358b6,2,0
if (isServicesOnlyMode()) {,2852d11515adbba69955f81394c73fd9992358b6,2,0
if (isRunning(old)) {,2852d11515adbba69955f81394c73fd9992358b6,2,0
if (isIgnoreRunningOAuthClients()) {,2852d11515adbba69955f81394c73fd9992358b6,2,0
"if (UserConfigurationCompare.configEqual(entity, old)) {",2852d11515adbba69955f81394c73fd9992358b6,2,0
if (isRecreateMode()) {,2852d11515adbba69955f81394c73fd9992358b6,2,0
} catch (Exception e) {,2852d11515adbba69955f81394c73fd9992358b6,2,0
if (!isAllowCreate()) {,2852d11515adbba69955f81394c73fd9992358b6,2,0
String id = getName(entity);,2852d11515adbba69955f81394c73fd9992358b6,2,1
if (isServicesOnlyMode()) {,2852d11515adbba69955f81394c73fd9992358b6,2,1
if (isRunning(old)) {,2852d11515adbba69955f81394c73fd9992358b6,2,1
if (isIgnoreRunningOAuthClients()) {,2852d11515adbba69955f81394c73fd9992358b6,2,1
"if (UserConfigurationCompare.configEqual(entity, old)) {",2852d11515adbba69955f81394c73fd9992358b6,2,1
if (isRecreateMode()) {,2852d11515adbba69955f81394c73fd9992358b6,2,1
} catch (Exception e) {,2852d11515adbba69955f81394c73fd9992358b6,2,1
if (!isAllowCreate()) {,2852d11515adbba69955f81394c73fd9992358b6,2,1
"LOG.info(""Updated OAuthClient result: "" + answer);",2852d11515adbba69955f81394c73fd9992358b6,2,0
"LOG.info(""Updated Template: "" + answer);",2852d11515adbba69955f81394c73fd9992358b6,2,0
"LOG.debug(""Ignoring recursive list "" + list);",2852d11515adbba69955f81394c73fd9992358b6,2,0
"LOG.info(""Using namespace: "" + namespace);",2852d11515adbba69955f81394c73fd9992358b6,2,0
"LOG.info(""Updated Pod result: "" + answer);",2852d11515adbba69955f81394c73fd9992358b6,2,0
"LOG.info(""Created Pod result: "" + answer);",2852d11515adbba69955f81394c73fd9992358b6,2,0
"LOG.info(""Updated entity: "" + answer);",2852d11515adbba69955f81394c73fd9992358b6,2,1
"LOG.warn(""Ignoring recursive list "" + list);",2852d11515adbba69955f81394c73fd9992358b6,2,1
"LOG.info(""Creating a namespace "" + namespace);",2852d11515adbba69955f81394c73fd9992358b6,2,1
@Override,2852d11515adbba69955f81394c73fd9992358b6,1,0
public Namespace call() throws Exception {,2852d11515adbba69955f81394c73fd9992358b6,1,0
return getKubernetes().getNamespace(name);,2852d11515adbba69955f81394c73fd9992358b6,1,0
},2852d11515adbba69955f81394c73fd9992358b6,1,0
public ReplicationController call() throws Exception {,2852d11515adbba69955f81394c73fd9992358b6,1,0
"return getKubernetes().getReplicationController(controllerId, namespace);",2852d11515adbba69955f81394c73fd9992358b6,1,0
"return createService(entity, namespace);",2852d11515adbba69955f81394c73fd9992358b6,1,0
String resourceVersion = KubernetesHelper.getResourceVersion(service);,2852d11515adbba69955f81394c73fd9992358b6,1,0
public Service call() throws Exception {,2852d11515adbba69955f81394c73fd9992358b6,1,0
"return getKubernetes().getService(serviceId, namespace);",2852d11515adbba69955f81394c73fd9992358b6,1,0
public Pod call() throws Exception {,2852d11515adbba69955f81394c73fd9992358b6,1,0
"return getKubernetes().getPod(podId, namespace);",2852d11515adbba69955f81394c73fd9992358b6,1,0
public Secret call() throws Exception {,2852d11515adbba69955f81394c73fd9992358b6,1,0
"return getKubernetes().getSecret(secretId, namespace);",2852d11515adbba69955f81394c73fd9992358b6,1,0
SecretList answer = handle404ByReturningNull(new Callable<SecretList>() {,2852d11515adbba69955f81394c73fd9992358b6,1,0
public SecretList call() throws Exception {,2852d11515adbba69955f81394c73fd9992358b6,1,0
return getKubernetes().getSecrets(namespace);,2852d11515adbba69955f81394c73fd9992358b6,1,0
return answer;,2852d11515adbba69955f81394c73fd9992358b6,1,0
public OAuthClient call() throws Exception {,2852d11515adbba69955f81394c73fd9992358b6,1,0
return getKubernetesGlobalExtensions().getOAuthClient(name);,2852d11515adbba69955f81394c73fd9992358b6,1,0
RouteList answer = handle404ByReturningNull(new Callable<RouteList>() {,2852d11515adbba69955f81394c73fd9992358b6,1,0
public RouteList call() throws Exception {,2852d11515adbba69955f81394c73fd9992358b6,1,0
return getKubernetesExtensions().getRoutes(namespace);,2852d11515adbba69955f81394c73fd9992358b6,1,0
public Route call() throws Exception {,2852d11515adbba69955f81394c73fd9992358b6,1,0
"return getKubernetesExtensions().getRoute(name, namespace);",2852d11515adbba69955f81394c73fd9992358b6,1,0
public Build call() throws Exception {,2852d11515adbba69955f81394c73fd9992358b6,1,0
"return getKubernetesExtensions().getBuild(name, namespace);",2852d11515adbba69955f81394c73fd9992358b6,1,0
BuildList answer = handle404ByReturningNull(new Callable<BuildList>() {,2852d11515adbba69955f81394c73fd9992358b6,1,0
public BuildList call() throws Exception {,2852d11515adbba69955f81394c73fd9992358b6,1,0
return getKubernetesExtensions().getBuilds(namespace);,2852d11515adbba69955f81394c73fd9992358b6,1,0
public DeploymentConfig call() throws Exception {,2852d11515adbba69955f81394c73fd9992358b6,1,0
"return getKubernetesExtensions().getDeploymentConfig(name, namespace);",2852d11515adbba69955f81394c73fd9992358b6,1,0
DeploymentConfigList answer = handle404ByReturningNull(new Callable<DeploymentConfigList>() {,2852d11515adbba69955f81394c73fd9992358b6,1,0
public DeploymentConfigList call() throws Exception {,2852d11515adbba69955f81394c73fd9992358b6,1,0
return getKubernetesExtensions().getDeploymentConfigs(namespace);,2852d11515adbba69955f81394c73fd9992358b6,1,0
public ImageStream call() throws Exception {,2852d11515adbba69955f81394c73fd9992358b6,1,0
"return getKubernetesExtensions().getImageStream(name, namespace);",2852d11515adbba69955f81394c73fd9992358b6,1,0
ImageStreamList answer = handle404ByReturningNull(new Callable<ImageStreamList>() {,2852d11515adbba69955f81394c73fd9992358b6,1,0
public ImageStreamList call() throws Exception {,2852d11515adbba69955f81394c73fd9992358b6,1,0
return getKubernetesExtensions().getImageStreams(namespace);,2852d11515adbba69955f81394c73fd9992358b6,1,0
* A helper method to handle REST APIs which throw a 404 by just returning null,2852d11515adbba69955f81394c73fd9992358b6,1,0
protected static <T> T handle404ByReturningNull(Callable<T> callable) {,2852d11515adbba69955f81394c73fd9992358b6,1,0
try {,2852d11515adbba69955f81394c73fd9992358b6,1,0
return callable.call();,2852d11515adbba69955f81394c73fd9992358b6,1,0
return null;,2852d11515adbba69955f81394c73fd9992358b6,1,0
return getKubernetes().getNamespace(name);,2852d11515adbba69955f81394c73fd9992358b6,1,1
"return getKubernetes().getReplicationController(controllerId, namespace);",2852d11515adbba69955f81394c73fd9992358b6,1,1
"return getKubernetes().getService(serviceId, namespace);",2852d11515adbba69955f81394c73fd9992358b6,1,1
"return getKubernetes().getPod(podId, namespace);",2852d11515adbba69955f81394c73fd9992358b6,1,1
"return getKubernetes().getSecret(secretId, namespace);",2852d11515adbba69955f81394c73fd9992358b6,1,1
public SecretList getSecrets(String namespace) {,2852d11515adbba69955f81394c73fd9992358b6,1,1
return getKubernetes().getSecrets(namespace);,2852d11515adbba69955f81394c73fd9992358b6,1,1
try {,2852d11515adbba69955f81394c73fd9992358b6,1,1
return getKubernetesGlobalExtensions().getOAuthClient(name);,2852d11515adbba69955f81394c73fd9992358b6,1,1
return null;,2852d11515adbba69955f81394c73fd9992358b6,1,1
},2852d11515adbba69955f81394c73fd9992358b6,1,1
return getKubernetesExtensions().getRoutes(namespace);,2852d11515adbba69955f81394c73fd9992358b6,1,1
"return getKubernetesExtensions().getRoute(name, namespace);",2852d11515adbba69955f81394c73fd9992358b6,1,1
"return getKubernetesExtensions().getBuild(name, namespace);",2852d11515adbba69955f81394c73fd9992358b6,1,1
public BuildList getBuilds(String namespace) {,2852d11515adbba69955f81394c73fd9992358b6,1,1
return getKubernetesExtensions().getBuilds(namespace);,2852d11515adbba69955f81394c73fd9992358b6,1,1
"return getKubernetesExtensions().getDeploymentConfig(name, namespace);",2852d11515adbba69955f81394c73fd9992358b6,1,1
public DeploymentConfigList getDeploymentConfigs(String namespace) {,2852d11515adbba69955f81394c73fd9992358b6,1,1
return getKubernetesExtensions().getDeploymentConfigs(namespace);,2852d11515adbba69955f81394c73fd9992358b6,1,1
"return getKubernetesExtensions().getImageStream(name, namespace);",2852d11515adbba69955f81394c73fd9992358b6,1,1
public ImageStreamList getImageStreams(String namespace) {,2852d11515adbba69955f81394c73fd9992358b6,1,1
return getKubernetesExtensions().getImageStreams(namespace);,2852d11515adbba69955f81394c73fd9992358b6,1,1
String namespace = getNamespace();,2852d11515adbba69955f81394c73fd9992358b6,1,0
"Template old = kubernetes.getTemplate(id, namespace);",2852d11515adbba69955f81394c73fd9992358b6,1,0
"LOG.info(""Template hasn't changed so not doing anything"");",2852d11515adbba69955f81394c73fd9992358b6,1,0
"doCreateTemplate(entity, namespace, sourceName);",2852d11515adbba69955f81394c73fd9992358b6,1,0
try {,2852d11515adbba69955f81394c73fd9992358b6,1,0
"Object answer = kubernetes.updateTemplate(id, entity, namespace);",2852d11515adbba69955f81394c73fd9992358b6,1,0
},2852d11515adbba69955f81394c73fd9992358b6,1,0
"String json = kubernetes.processTemplate(entity, namespace);",2852d11515adbba69955f81394c73fd9992358b6,1,0
"Object result = processTemplate(entity, sourceName);",2852d11515adbba69955f81394c73fd9992358b6,1,1
try {,2852d11515adbba69955f81394c73fd9992358b6,1,1
"applyEntity(result, sourceName);",2852d11515adbba69955f81394c73fd9992358b6,1,1
"String json = kubernetes.createTemplate(entity, namespace);",2852d11515adbba69955f81394c73fd9992358b6,1,1
},2852d11515adbba69955f81394c73fd9992358b6,1,1
OAuthClient old = kubernetes.getOAuthClient(id);,2852d11515adbba69955f81394c73fd9992358b6,1,0
"LOG.info(""Not updating the OAuthClient which are shared across namespaces as its already running"");",2852d11515adbba69955f81394c73fd9992358b6,1,0
},2852d11515adbba69955f81394c73fd9992358b6,1,0
"LOG.info(""OAuthClient hasn't changed so not doing anything"");",2852d11515adbba69955f81394c73fd9992358b6,1,0
"doCreateOAuthClient(entity, sourceName);",2852d11515adbba69955f81394c73fd9992358b6,1,0
try {,2852d11515adbba69955f81394c73fd9992358b6,1,0
"Object answer = kubernetes.updateOAuthClient(id, entity);",2852d11515adbba69955f81394c73fd9992358b6,1,0
public boolean isSupportOAuthClients() {,2852d11515adbba69955f81394c73fd9992358b6,1,0
return supportOAuthClients;,2852d11515adbba69955f81394c73fd9992358b6,1,0
public void setSupportOAuthClients(boolean supportOAuthClients) {,2852d11515adbba69955f81394c73fd9992358b6,1,0
},2852d11515adbba69955f81394c73fd9992358b6,1,1
OAuthClient old = kubernetes.getOAuthClient(id);,2852d11515adbba69955f81394c73fd9992358b6,1,1
"LOG.info(""Not updating the OAuthClient which are shared across namespaces as its already running"");",2852d11515adbba69955f81394c73fd9992358b6,1,1
"LOG.info(""OAuthClient hasn't changed so not doing anything"");",2852d11515adbba69955f81394c73fd9992358b6,1,1
"doCreateOAuthClient(entity, sourceName);",2852d11515adbba69955f81394c73fd9992358b6,1,1
try {,2852d11515adbba69955f81394c73fd9992358b6,1,1
"Object answer = kubernetes.updateOAuthClient(id, entity);",2852d11515adbba69955f81394c73fd9992358b6,1,1
"LOG.info(""OAuthClient has not changed so not doing anything"");",2852d11515adbba69955f81394c73fd9992358b6,1,0
"LOG.info(""Template has not changed so not doing anything"");",2852d11515adbba69955f81394c73fd9992358b6,1,0
"logGeneratedEntity(""Created Template: "", namespace, entity, answer);",2852d11515adbba69955f81394c73fd9992358b6,1,0
"LOG.info(""ServiceAccount has not changed so not doing anything"");",2852d11515adbba69955f81394c73fd9992358b6,1,0
"LOG.info(""Secret has not changed so not doing anything"");",2852d11515adbba69955f81394c73fd9992358b6,1,0
"LOG.info(""BuildConfig has not changed so not doing anything"");",2852d11515adbba69955f81394c73fd9992358b6,1,0
"LOG.info(""Service has not changed so not doing anything"");",2852d11515adbba69955f81394c73fd9992358b6,1,0
"LOG.info(""ReplicationController has not changed so not doing anything"");",2852d11515adbba69955f81394c73fd9992358b6,1,0
"LOG.info(""Pod has not changed so not doing anything"");",2852d11515adbba69955f81394c73fd9992358b6,1,0
"LOG.info(""OAuthClient hasn't changed so not doing anything"");",2852d11515adbba69955f81394c73fd9992358b6,1,1
"LOG.info(""Template hasn't changed so not doing anything"");",2852d11515adbba69955f81394c73fd9992358b6,1,1
"logGeneratedEntity(""Created template: "", namespace, entity, answer);",2852d11515adbba69955f81394c73fd9992358b6,1,1
"LOG.info(""ServiceAccount hasn't changed so not doing anything"");",2852d11515adbba69955f81394c73fd9992358b6,1,1
"LOG.info(""Secret hasn't changed so not doing anything"");",2852d11515adbba69955f81394c73fd9992358b6,1,1
"LOG.info(""BuildConfig hasn't changed so not doing anything"");",2852d11515adbba69955f81394c73fd9992358b6,1,1
"LOG.info(""Service hasn't changed so not doing anything"");",2852d11515adbba69955f81394c73fd9992358b6,1,1
"LOG.info(""ReplicationController hasn't changed so not doing anything"");",2852d11515adbba69955f81394c73fd9992358b6,1,1
"LOG.info(""Pod hasn't changed so not doing anything"");",2852d11515adbba69955f81394c73fd9992358b6,1,1
import io.fabric8.kubernetes.api.model.ObjectMeta;,2852d11515adbba69955f81394c73fd9992358b6,0,0
import java.util.concurrent.Callable;,2852d11515adbba69955f81394c73fd9992358b6,0,0
});,2852d11515adbba69955f81394c73fd9992358b6,0,0
"Service service = getService(serviceId, namespace);",2852d11515adbba69955f81394c73fd9992358b6,0,0
KubernetesHelper.getOrCreateMetadata(entity).setResourceVersion(resourceVersion);,2852d11515adbba69955f81394c73fd9992358b6,0,0
answer = new SecretList();,2852d11515adbba69955f81394c73fd9992358b6,0,0
answer = new RouteList();,2852d11515adbba69955f81394c73fd9992358b6,0,0
answer = new BuildList();,2852d11515adbba69955f81394c73fd9992358b6,0,0
answer = new DeploymentConfigList();,2852d11515adbba69955f81394c73fd9992358b6,0,0
answer = new ImageStreamList();,2852d11515adbba69955f81394c73fd9992358b6,0,0
/**,2852d11515adbba69955f81394c73fd9992358b6,0,0
*/,2852d11515adbba69955f81394c73fd9992358b6,0,0
throw e;,2852d11515adbba69955f81394c73fd9992358b6,0,0
throw new WebApplicationException(e);,2852d11515adbba69955f81394c73fd9992358b6,0,0
// does not exist,2852d11515adbba69955f81394c73fd9992358b6,0,1
throw e;,2852d11515adbba69955f81394c73fd9992358b6,0,1
import java.io.File;,2852d11515adbba69955f81394c73fd9992358b6,0,0
import java.io.FileInputStream;,2852d11515adbba69955f81394c73fd9992358b6,0,0
import java.io.FileNotFoundException;,2852d11515adbba69955f81394c73fd9992358b6,0,0
import java.io.IOException;,2852d11515adbba69955f81394c73fd9992358b6,0,0
import java.io.InputStream;,2852d11515adbba69955f81394c73fd9992358b6,0,0
import static io.fabric8.kubernetes.api.KubernetesHelper.getName;,2852d11515adbba69955f81394c73fd9992358b6,0,0
import static io.fabric8.kubernetes.api.KubernetesHelper.getObjectId;,2852d11515adbba69955f81394c73fd9992358b6,0,0
import static io.fabric8.kubernetes.api.KubernetesHelper.getOrCreateMetadata;,2852d11515adbba69955f81394c73fd9992358b6,0,0
import static io.fabric8.kubernetes.api.KubernetesHelper.getPodMap;,2852d11515adbba69955f81394c73fd9992358b6,0,0
import static io.fabric8.kubernetes.api.KubernetesHelper.getReplicationControllerMap;,2852d11515adbba69955f81394c73fd9992358b6,0,0
import static io.fabric8.kubernetes.api.KubernetesHelper.getServiceMap;,2852d11515adbba69955f81394c73fd9992358b6,0,0
import static io.fabric8.kubernetes.api.KubernetesHelper.loadJson;,2852d11515adbba69955f81394c73fd9992358b6,0,0
import static io.fabric8.kubernetes.api.KubernetesHelper.summaryText;,2852d11515adbba69955f81394c73fd9992358b6,0,0
import static io.fabric8.kubernetes.api.KubernetesHelper.toItemList;,2852d11515adbba69955f81394c73fd9992358b6,0,0
/**,2852d11515adbba69955f81394c73fd9992358b6,0,0
*/,2852d11515adbba69955f81394c73fd9992358b6,0,0
boolean recreateMode = isRecreateMode();,2852d11515adbba69955f81394c73fd9992358b6,0,0
// TODO seems you can't update templates right now,2852d11515adbba69955f81394c73fd9992358b6,0,0
recreateMode = true;,2852d11515adbba69955f81394c73fd9992358b6,0,0
"kubernetes.deleteTemplate(id, namespace);",2852d11515adbba69955f81394c73fd9992358b6,0,0
"Object answer = kubernetes.createTemplate(entity, namespace);",2852d11515adbba69955f81394c73fd9992358b6,0,0
import io.fabric8.openshift.api.model.RouteSpec;,2852d11515adbba69955f81394c73fd9992358b6,0,1
import java.io.*;,2852d11515adbba69955f81394c73fd9992358b6,0,1
import static io.fabric8.kubernetes.api.KubernetesHelper.*;,2852d11515adbba69955f81394c73fd9992358b6,0,1
// TODO we could maybe ignore failed services?,2852d11515adbba69955f81394c73fd9992358b6,0,1
private boolean supportOAuthClients;,2852d11515adbba69955f81394c73fd9992358b6,0,0
return;,2852d11515adbba69955f81394c73fd9992358b6,0,0
kubernetes.deleteOAuthClient(id);,2852d11515adbba69955f81394c73fd9992358b6,0,0
this.supportOAuthClients = supportOAuthClients;,2852d11515adbba69955f81394c73fd9992358b6,0,0
return;,2852d11515adbba69955f81394c73fd9992358b6,0,1
kubernetes.deleteOAuthClient(id);,2852d11515adbba69955f81394c73fd9992358b6,0,1
import io.fabric8.kubernetes.api.root.RootPaths;,2852d11515adbba69955f81394c73fd9992358b6,0,0
"@Path(""/"")",2852d11515adbba69955f81394c73fd9992358b6,0,0
@GET,2852d11515adbba69955f81394c73fd9992358b6,0,0
RootPaths getRootPaths();,2852d11515adbba69955f81394c73fd9992358b6,0,0
"@Path(""oapi/v1/oauthclients"")",2852d11515adbba69955f81394c73fd9992358b6,0,0
"@Path(""oapi/v1/oauthclients/{name}"")",2852d11515adbba69955f81394c73fd9992358b6,0,0
"@Path(""oapi/v1"")",2852d11515adbba69955f81394c73fd9992358b6,0,1
"@Path(""oauthclients"")",2852d11515adbba69955f81394c73fd9992358b6,0,1
"@Path(""oauthclients/{name}"")",2852d11515adbba69955f81394c73fd9992358b6,0,1
"logGeneratedEntity(""Updated ServiceAccount: "", namespace, serviceAccount, answer);",2852d11515adbba69955f81394c73fd9992358b6,0,0
"logGeneratedEntity(""Created ServiceAccount: "", namespace, serviceAccount, answer);",2852d11515adbba69955f81394c73fd9992358b6,0,0
"logGeneratedEntity(""Updated Secret:"", namespace, secret, answer);",2852d11515adbba69955f81394c73fd9992358b6,0,0
"logGeneratedEntity(""Created Secret: "", namespace, secret, answer);",2852d11515adbba69955f81394c73fd9992358b6,0,0
"logGeneratedEntity(""Updated Service: "", namespace, service, answer);",2852d11515adbba69955f81394c73fd9992358b6,0,0
"logGeneratedEntity(""Created Service: "", namespace, service, answer);",2852d11515adbba69955f81394c73fd9992358b6,0,0
"logGeneratedEntity(""Created ReplicationController: "", namespace, replicationController, answer);",2852d11515adbba69955f81394c73fd9992358b6,0,0
private static final ObjectMapper OBJECT_MAPPER = new ObjectMapper();,2852d11515adbba69955f81394c73fd9992358b6,0,1
"private Map<String, Pod> podMap;",2852d11515adbba69955f81394c73fd9992358b6,0,1
"private Map<String, ReplicationController> replicationControllerMap;",2852d11515adbba69955f81394c73fd9992358b6,0,1
"private Map<String, Service> serviceMap;",2852d11515adbba69955f81394c73fd9992358b6,0,1
"logGeneratedEntity(""Updated service account: "", namespace, serviceAccount, answer);",2852d11515adbba69955f81394c73fd9992358b6,0,1
"logGeneratedEntity(""Created service account: "", namespace, serviceAccount, answer);",2852d11515adbba69955f81394c73fd9992358b6,0,1
"logGeneratedEntity(""Updated secret:"", namespace, secret, answer);",2852d11515adbba69955f81394c73fd9992358b6,0,1
"logGeneratedEntity(""Created secret: "", namespace, secret, answer);",2852d11515adbba69955f81394c73fd9992358b6,0,1
"logGeneratedEntity(""Updated service: "", namespace, service, answer);",2852d11515adbba69955f81394c73fd9992358b6,0,1
"logGeneratedEntity(""Created service: "", namespace, service, answer);",2852d11515adbba69955f81394c73fd9992358b6,0,1
"logGeneratedEntity(""Created replicationController: "", namespace, replicationController, answer);",2852d11515adbba69955f81394c73fd9992358b6,0,1
"public static BuildConfig createBuildConfig(String buildConfigName, Map<String, String> labels, String gitUrlText, String outputImageStreamName, String imageText, String webhookSecret) {",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,8,1
"BuildConfig buildConfig = BuildConfigs.createBuildConfig(buildConfigName, labels, gitUrlText, ouputImageName, imageText, webhookSecretText);",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,8,1
"public static BuildConfig createIntegrationTestBuildConfig(String buildConfigName, Map<String, String> labels, String gitUrlText, String image, List<EnvVar> envVars) {",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,5,1
"@WithAttributes(name = ""imageName"", label = ""Output Image Name"",",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,5,1
"@WithAttributes(name = ""outputImage"", label = ""Output image"",",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,4,1
"@WithAttributes(name = ""buildName"", label = ""Build name"",",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,3,1
"description = ""The output image name to push the docker image to."",",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,3,1
"@WithAttributes(name = ""gitUri"", label = ""Git Uri"",",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,3,1
"@WithAttributes(name = ""webHookSecret"", label = ""Webhook secret"",",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,3,1
"public static BuildConfigSpec addBuildParameterOutput(BuildConfigSpecBuilder builder, String imageName) {",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,2,1
"public static BuildConfigSpec addBuildParameterGitSource(BuildConfigSpecBuilder builder, String gitUrl) {",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,2,1
"public static BuildConfigSpecBuilder addBuildConfigSpectiStrategy(BuildConfigSpecBuilder builder, String image) {",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,2,1
"public static BuildConfigSpecBuilder addBuildParameterCustomStrategy(BuildConfigSpecBuilder builder, String image, List<EnvVar> envVars) {",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,2,1
"public static BuildConfigSpecBuilder addWebHookTriggers(BuildConfigSpecBuilder builder, String secret) {",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,2,1
"description = ""The build configuration name to generate."",",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,2,1
"description = ""The docker image name to generate."",",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,2,1
String buildConfigName = buildName.getValue();,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,2,1
"Map<String, String> labels = BuildConfigs.createBuildLabels(buildConfigName);",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,2,1
String ouputImageName = imageName.getValue();,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,2,1
"String gitUrlText = getOrFindGitUrl(context, gitUri.getValue());",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,2,1
String imageText = outputImage.getValue();,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,2,1
String webhookSecretText = webHookSecret.getValue();,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,2,1
*  with the License.  You may obtain a copy of the License at,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,1,1
"Map<String, String> answer = new HashMap<>();",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,1,1
// TODO add builderImage,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,1,1
"BuildConfigBuilder buildConfigBuilder = buildConfigBuilder(buildConfigName, labels);",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,1,1
BuildConfigSpecBuilder specBuilder = new BuildConfigSpecBuilder();,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,1,1
*  with the License.  You may obtain a copy of the License at,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,1,1
* Creates a new build in OpenShift for the current project,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,1,1
required = false),a827c9e74f004a9bf22417f7d3b39dae2a287a0e,1,1
UIInput<String> buildName;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,1,1
UIInput<String> imageName;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,1,1
"description = ""If the git URI is not specified in the pom.xml then this allows you to specify one to be used."",",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,1,1
UIInput<String> gitUri;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,1,1
UIInput<String> outputImage;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,1,1
"description = ""The secret that needs to be passed in by webhooks invoking the generated build."",",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,1,1
UIInput<String> webHookSecret;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,1,1
".name(CATEGORY + "": New Build"")",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,1,1
".description(""Create a new build configuration"");",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,1,1
public String call() throws Exception {,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,1,1
Model mavenModel = getMavenModel(builder);,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,1,1
Model mavenModel = getMavenModel(context);,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,1,1
"imageText = mavenModel.getProperties().getProperty(""docker.image"");",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,1,1
"webhookSecretText = ""secret101"";",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,1,1
"ImageStream imageRepository = BuildConfigs.imageRepository(buildConfigName, labels);",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,1,1
Controller controller = createController();,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,1,1
/**,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
*,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"*  Red Hat licenses this file to you under the Apache License, version",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"*  Unless required by applicable law or agreed to in writing, software",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
*  implied.  See the License for the specific language governing,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
*  permissions and limitations under the License.,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
*/,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
package io.fabric8.forge.devops;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import io.fabric8.kubernetes.api.model.EnvVar;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import io.fabric8.openshift.api.model.BuildConfig;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import io.fabric8.openshift.api.model.BuildConfigBuilder;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import io.fabric8.openshift.api.model.BuildConfigSpec;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import io.fabric8.openshift.api.model.BuildConfigSpecBuilder;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import io.fabric8.openshift.api.model.ImageStream;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import io.fabric8.openshift.api.model.ImageStreamBuilder;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import io.fabric8.utils.Strings;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import java.util.HashMap;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import java.util.List;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import java.util.Map;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
public class BuildConfigs {,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"public static Map<String, String> createBuildLabels(String buildName) {",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"answer.put(""name"", buildName);",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
return answer;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
},a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"public static ImageStream imageRepository(String buildName, Map<String, String> labels) {",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
return new ImageStreamBuilder().,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
withNewMetadata().withLabels(labels).withName(buildName).endMetadata().,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
build();,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
return builder.,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
withNewOutput().,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"withNewTo().withKind(""ImageStreamImage"").withName(imageName).endTo().",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
endOutput().,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
withNewSource().,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"withType(""Git"").",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
withNewGit().withUri(gitUrl).endGit().,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
endSource().,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
withNewStrategy().,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"withType(""STI"").",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
withNewSourceStrategy().,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"withNewFrom().withName(image).withKind(""ImageStreamImage"").endFrom().",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
endSourceStrategy().,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
endStrategy();,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"withType(""Custom"").",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
withNewCustomStrategy().,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
withEnv(envVars).,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
endCustomStrategy().,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
addNewTrigger().,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"withType(""github"").",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
withNewGithub().withSecret(secret).endGithub().,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
endTrigger().,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"withType(""generic"").",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
withNewGeneric().withSecret(secret).endGeneric().,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
endTrigger();,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"public static BuildConfigBuilder buildConfigBuilder(String buildName, Map<String, String> labels) {",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
return new BuildConfigBuilder().,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
withNewMetadata().withLabels(labels).withName(buildName).endMetadata();,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"addBuildParameterGitSource(specBuilder, gitUrlText);",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
if (Strings.isNotBlank(outputImageStreamName)) {,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"addBuildParameterOutput(specBuilder, outputImageStreamName);",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
if (Strings.isNotBlank(imageText)) {,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"addBuildConfigSpectiStrategy(specBuilder, imageText);",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
if (Strings.isNotBlank(webhookSecret)) {,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"addWebHookTriggers(specBuilder, webhookSecret);",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
return buildConfigBuilder.withSpec(specBuilder.build()).build();,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
if (Strings.isNotBlank(image)) {,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"addBuildParameterCustomStrategy(specBuilder, image, envVars);",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
/**,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
*,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"*  Red Hat licenses this file to you under the Apache License, version",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"*  Unless required by applicable law or agreed to in writing, software",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
*  implied.  See the License for the specific language governing,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
*  permissions and limitations under the License.,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
*/,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
package io.fabric8.forge.devops;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import io.fabric8.kubernetes.api.Controller;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import io.fabric8.kubernetes.api.builds.Builds;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import io.fabric8.openshift.api.model.BuildConfig;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import io.fabric8.openshift.api.model.ImageStream;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import io.fabric8.utils.Objects;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import io.fabric8.utils.Strings;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import org.apache.maven.model.Model;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import org.jboss.forge.addon.ui.context.UIContext;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import org.jboss.forge.addon.ui.input.UIInput;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import org.jboss.forge.addon.ui.result.Result;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import org.jboss.forge.addon.ui.result.Results;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import org.jboss.forge.addon.ui.util.Categories;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import org.jboss.forge.addon.ui.util.Metadata;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import javax.inject.Inject;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import java.util.Map;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import java.util.concurrent.Callable;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
import static io.fabric8.utils.cxf.JsonHelper.toJson;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
public class NewBuildCommand extends AbstractDevOpsCommand {,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
@Inject,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
@Override,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
public UICommandMetadata getMetadata(UIContext context) {,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"return Metadata.from(super.getMetadata(context), getClass())",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
.category(Categories.create(CATEGORY)),a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
},a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
public void initializeUI(final UIBuilder builder) throws Exception {,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
super.initializeUI(builder);,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
buildName.setDefaultValue(new Callable<String>() {,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
if (mavenModel != null) {,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
return mavenModel.getArtifactId();,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
return null;,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
});,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
builder.add(buildName);,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
builder.add(imageName);,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
builder.add(gitUri);,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
builder.add(outputImage);,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
builder.add(webHookSecret);,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
public Result execute(UIExecutionContext context) throws Exception {,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"Objects.assertNotNull(buildConfigName, ""buildName"");",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
if (Strings.isNullOrBlank(imageText) && mavenModel != null) {,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
if (Strings.isNullOrBlank(webhookSecretText)) {,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
// TODO generate a really good secret!,a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"System.out.println(""Generated BuildConfig: "" + toJson(buildConfig));",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"controller.applyImageStream(imageRepository, ""generated ImageStream: "" + toJson(imageRepository));",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"controller.applyBuildConfig(buildConfig, ""generated BuildConfig: "" + toJson(buildConfig));",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"return Results.success(""Added BuildConfig: "" + Builds.getName(buildConfig) + "" to OpenShift at master: "" + getKubernetes().getMasterUrl());",a827c9e74f004a9bf22417f7d3b39dae2a287a0e,0,1
"log.warn(""Could not parse OpenShift configuration file: "" + file);",4710f40609d08ef66b41c6a9e209bf53e79eabe7,4,1
"log.debug(""Parsing OpenShift configuration: "" + file);",4710f40609d08ef66b41c6a9e209bf53e79eabe7,3,1
import io.fabric8.kubernetes.api.extensions.Configs;,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,0
import io.fabric8.kubernetes.api.model.config.Config;,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,0
import io.fabric8.kubernetes.api.model.config.Context;,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,0
Config config = Configs.parseConfigs();,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,0
if (config != null) {,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,0
Context context = Configs.getCurrentContext(config);,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,0
if (context != null) {,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,0
"return Configs.getUserToken(config, context);",4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,0
return null;,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,0
"public static final String OPENSHIFT_CONFIG_FILE_PROPERTY = ""openshift.config.file"";",4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
File file = getOpenShiftConfigFile();,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
String answer = null;,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
if (file.exists() && file.isFile()) {,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
"String tokenPrefix = ""token:"";",4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
try (BufferedReader reader = new BufferedReader(new FileReader(file))) {,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
boolean inUsers = false;,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
while (true) {,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
String line = reader.readLine();,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
if (line == null) {,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
break;,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
},4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
if (line.isEmpty()) {,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
continue;,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
"if (line.startsWith(""users:"")) {",4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
inUsers = true;,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
} else {,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
char ch = line.charAt(0);,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
if (Character.isWhitespace(ch) || ch == '-') {,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
if (inUsers) {,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
String text = line.trim();,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
if (text.startsWith(tokenPrefix)) {,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
String token = text.substring(tokenPrefix.length()).trim();,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
if (Strings.isNotBlank(token)) {,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
answer = token;,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
inUsers = false;,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
} catch (Exception e) {,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
return answer;,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
public static File getOpenShiftConfigFile() {,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
String file = System.getProperty(OPENSHIFT_CONFIG_FILE_PROPERTY);,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
if (file != null) {,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
return new File(file);,4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
"String homeDir = System.getProperty(""user.home"", ""."");",4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
"return new File(homeDir, "".config/openshift/config"");",4710f40609d08ef66b41c6a9e209bf53e79eabe7,0,1
"getLog().info(""Overriding template parameter "" + name + "" with value: "" + propertyValue);",0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,9,1
* Before applying the given template lets allow template parameters to be overridden via the maven,0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,4,1
"getLog().info(""No property defined for template parameter: "" + name);",0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,4,1
Properties properties = project.getProperties();,0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,3,1
"String name = ""fabric8.apply."" + parameterName;",0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,3,1
"getLog().debug(""current properties "" + new TreeSet<>(properties.keySet()));",0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,3,1
* properties - or optionally - via the command line if in interactive mode.,0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,2,1
List<io.fabric8.openshift.api.model.Parameter> parameters = template.getParameters();,0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,2,1
MavenProject project = getProject();,0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,2,1
if (parameters != null && project != null) {,0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,2,1
for (io.fabric8.openshift.api.model.Parameter parameter : parameters) {,0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,2,1
} else {,0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,2,1
"dto = applyTemplates(template, kubernetes, controller, fileName);",0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,1,0
"protected Object applyTemplates(Template template, KubernetesClient kubernetes, Controller controller, String fileName) throws Exception {",0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,1,0
"dto = controller.applyTemplate(template, fileName);",0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,1,1
protected void overrideTemplateParameters(Template template) {,0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,1,1
boolean missingProperty = false;,0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,1,1
String parameterName = parameter.getName();,0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,1,1
String propertyValue = properties.getProperty(name);,0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,1,1
if (Strings.isNotBlank(propertyValue)) {,0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,1,1
missingProperty = true;,0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,1,1
},0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,1,1
if (missingProperty) {,0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,1,1
"KubernetesHelper.setNamespace(template, kubernetes.getNamespace());",0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,0,0
overrideTemplateParameters(template);,0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,0,0
"return controller.applyTemplate(template, fileName);",0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,0,0
"KubernetesHelper.setNamespace(template, kubernetes.getNamespace());",0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,0,1
overrideTemplateParameters(template);,0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,0,1
/**,0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,0,1
*/,0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,0,1
properties.putAll(project.getProperties());,0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,0,1
properties.putAll(System.getProperties());,0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,0,1
parameter.setValue(propertyValue);,0393cebe82ee1bbb6d8555cc32e3c19c6d45af50,0,1
"public String updateNamespace(@NotNull String namespaceId, Namespace entity) throws Exception {",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,5,0
"String homeDir = System.getProperty(""user.home"", ""."");",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,5,1
"public String updateTemplate(@NotNull String name, Template entity, String namespace) throws Exception {",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,5,0
"public String deleteTemplate(@NotNull String name, String namespace) throws Exception {",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,5,0
public Namespace getNamespace(@NotNull String name) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,4,0
public String deleteNamespace(@NotNull String name) throws Exception {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,4,0
public static String defaultNamespace() {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,4,0
public static String findDefaultOpenShiftNamespace() {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,4,0
"protected static String yamlValue(String prefix, String text) {",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,4,0
"protected static String yamlValue(String prefix, String text) {",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,4,1
"public static final String OPENSHIFT_CONFIG_FILE_PROPERTY = ""openshift.config.file"";",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,4,1
public static File getOpenShiftConfigFile() {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,4,1
"return new File(homeDir, "".config/openshift/config"");",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,4,1
"public String processTemplate(Template entity, String namespace) throws Exception {",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,4,0
"public Template getTemplate(final @NotNull String name, final String namespace) {",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,4,0
public String createNamespace(Namespace entity) throws Exception {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,3,0
} else {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,3,0
try (BufferedReader reader = new BufferedReader(new FileReader(file))) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,3,0
} else {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,3,0
protected static String findDefaultOpenShiftContext(File file) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,3,0
protected static String defaultNamespace() {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,3,1
private static String findDefaultOpenShiftContext() {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,3,1
try (BufferedReader reader = new BufferedReader(new FileReader(file))) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,3,1
Config config = Configs.parseConfigs();,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,3,0
File file = getOpenShiftConfigFile();,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,3,1
try (BufferedReader reader = new BufferedReader(new FileReader(file))) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,3,1
} else {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,3,1
protected static String findDefaultOpenShiftContext(File file) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,3,1
Config config = Configs.parseConfigs();,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,3,0
File file = getOpenShiftConfigFile();,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,3,1
try (BufferedReader reader = new BufferedReader(new FileReader(file))) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,3,1
} else {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,3,1
String file = System.getProperty(OPENSHIFT_CONFIG_FILE_PROPERTY);,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,3,1
"return getKubernetes().updateNamespace(namespaceId, entity);",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
} catch (WebApplicationException e) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
if (e.getResponse().getStatus() == 404) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
Endpoints answer = new Endpoints();,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
namespace = findDefaultOpenShiftNamespace();,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
"String namePrefix = ""name:"";",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
"String namespacePrefix = ""namespace:"";",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
String context = findDefaultOpenShiftContext(file);,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
if (Strings.isNotBlank(context)) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
String line = reader.readLine();,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
if (line == null) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
"String namespaceValue = yamlValue(namespacePrefix, line);",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
if (namespaceValue != null) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
"String nameValue = yamlValue(namePrefix, line);",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
if (nameValue != null && nameValue.equals(context)) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
} catch (Exception e) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
if (text.startsWith(prefix)) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
String value = text.substring(prefix.length());,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
if (Strings.isNotBlank(value)) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
"String tokenPrefix = ""current-context:"";",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
if (line.startsWith(tokenPrefix)) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
String token = line.substring(tokenPrefix.length()).trim();,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
if (Strings.isNotBlank(token)) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
namespace = findDefaultOpenShiftContext();,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
"String tokenPrefix = ""current-context:"";",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
String line = reader.readLine();,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
if (line == null) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
if (line.startsWith(tokenPrefix)) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
String token = line.substring(tokenPrefix.length()).trim();,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
if (Strings.isNotBlank(token)) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
} catch (Exception e) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
if (config != null) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
if (context != null) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
import static io.fabric8.kubernetes.api.KubernetesFactory.getOpenShiftConfigFile;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
"String namePrefix = ""name:"";",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
"String namespacePrefix = ""namespace:"";",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
String answer = null;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
if (file.exists() && file.isFile()) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
String context = findDefaultOpenShiftContext(file);,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
if (Strings.isNotBlank(context)) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
String line = reader.readLine();,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
if (line == null) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
"String namespaceValue = yamlValue(namespacePrefix, line);",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
if (namespaceValue != null) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
"String nameValue = yamlValue(namePrefix, line);",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
if (nameValue != null && nameValue.equals(context)) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
} catch (Exception e) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
if (text.startsWith(prefix)) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
String value = text.substring(prefix.length());,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
if (Strings.isNotBlank(value)) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
"String tokenPrefix = ""current-context:"";",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
if (line.startsWith(tokenPrefix)) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
String token = line.substring(tokenPrefix.length()).trim();,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
if (Strings.isNotBlank(token)) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
if (config != null) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
if (context != null) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
String answer = null;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
if (file.exists() && file.isFile()) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
"String tokenPrefix = ""token:"";",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
String line = reader.readLine();,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
if (line == null) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
if (line.isEmpty()) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
"if (line.startsWith(""users:"")) {",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
if (Character.isWhitespace(ch) || ch == '-') {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
if (inUsers) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
String text = line.trim();,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
if (text.startsWith(tokenPrefix)) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
String token = text.substring(tokenPrefix.length()).trim();,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
if (Strings.isNotBlank(token)) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
} catch (Exception e) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
if (file != null) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
return new File(file);,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,1
return handle404ByReturningNull(new Callable<Template>() {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
public Template call() throws Exception {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
if (!KubernetesHelper.hasResourceVersion(entity)) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
if (oldEntity == null) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
// no entity exists so lets create a new one,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
String resourceVersion = KubernetesHelper.getResourceVersion(oldEntity);,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,2,0
import io.fabric8.kubernetes.api.model.EndpointSubset;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
return getKubernetes().createNamespace(entity);,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
},906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
return getKubernetes().getNamespace(name);,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
return getKubernetes().deleteNamespace(name);,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
try {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
"return getKubernetes().endpointsForService(serviceId, namespace);",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
return answer;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
"return getKubernetes().endpointsForService(serviceId, namespace);",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
boolean inUsers = false;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
while (true) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
},906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
line = line.trim();,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
answer = namespaceValue;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
return answer;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
value = value.trim();,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
return value;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
return null;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
return token;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
boolean inUsers = false;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
while (true) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
},906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
return token;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
import io.fabric8.kubernetes.api.extensions.Configs;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
import io.fabric8.kubernetes.api.model.config.Config;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
import io.fabric8.kubernetes.api.model.config.Context;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
Context context = Configs.getCurrentContext(config);,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
return context.getNamespace();,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
import io.fabric8.kubernetes.api.model.ObjectMeta;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
boolean inUsers = false;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
while (true) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
},906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
line = line.trim();,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
answer = namespaceValue;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
return answer;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
value = value.trim();,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
return value;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
return token;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
return null;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
import io.fabric8.kubernetes.api.extensions.Configs;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
import io.fabric8.kubernetes.api.model.config.Config;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
import io.fabric8.kubernetes.api.model.config.Context;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
Context context = Configs.getCurrentContext(config);,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
"return Configs.getUserToken(config, context);",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
return null;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
boolean inUsers = false;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
while (true) {,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
},906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
inUsers = true;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
char ch = line.charAt(0);,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
answer = token;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
inUsers = false;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
return answer;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
"validateNamespace(namespace, entity);",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
"return getKubernetesExtensions().processTemplate(entity, namespace);",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
},906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
"return getKubernetesExtensions().getTemplate(name, namespace);",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
"ReplicationController oldEntity = getReplicationController(name, namespace);",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
"return createTemplate(entity, namespace);",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
"return getKubernetesExtensions().updateTemplate(name, entity, namespace);",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
"return getKubernetesExtensions().deleteTemplate(name, namespace);",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,0
import java.io.BufferedReader;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
import java.io.File;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
import java.io.FileReader;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,1,1
@Override,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
@GET,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
"@Path(""namespaces/{name}"")",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
@PUT,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
"@Consumes(""application/json"")",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
@DELETE,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
"@Consumes(""text/plain"")",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
"validateNamespace(namespace, serviceId);",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
// does not exist,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
answer.setSubsets(new ArrayList<EndpointSubset>());,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
throw e;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
"validateNamespace(namespace, serviceId);",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,1
break;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
"LOG.warn(""Could not parse OpenShift configuration file: "" + file);",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
break;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,1
"LOG.warn(""Could not parse OpenShift configuration file: "" + file);",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,1
"LOG.debug(""Parsing OpenShift configuration: "" + file);",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,1
break;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,1
"LOG.warn(""Could not parse OpenShift configuration file: "" + file);",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,1
"log.debug(""Parsing OpenShift configuration: "" + file);",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,1
break;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,1
continue;,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,1
"log.warn(""Could not parse OpenShift configuration file: "" + file);",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,1
"@Path(""templates"")",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
"@Consumes(""application/json"")",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
@Override,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
@POST,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
@GET,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
"@Path(""templates/{name}"")",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
"@Produces(""application/json"")",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
});,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
@PUT,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
// lets load it from the oldEntity,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
KubernetesHelper.getOrCreateMetadata(entity).setResourceVersion(resourceVersion);,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
@DELETE,906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
"@Consumes(""text/plain"")",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,0
"@Path(""templateConfigs"")",906e9b4df21e4e420f51cc93c13fb5f37d52fac7,0,1
"getLog().warn(""Not adding annotation `"" + annotation + ""` to "" + KubernetesHelper.getKind(resource) + "" "" + KubernetesHelper.getName(resource) + "" with value `"" + value + ""` as there is already an annotation value of `"" + oldValue + ""`"");",836867e0413d6087a4520a5b8653b089cad28244,14,0
"throw new MojoExecutionException(""Failed to load environment properties file: "" + envPropertiesFile + "". "" + e, e);",836867e0413d6087a4520a5b8653b089cad28244,7,1
"throw new MojoExecutionException(""Failed to load properties file: "" + file + "". "" + e, e);",836867e0413d6087a4520a5b8653b089cad28244,6,0
"throw new MojoExecutionException(""Failed to load properties URL: "" + url + "". "" + e, e);",836867e0413d6087a4520a5b8653b089cad28244,6,0
"throw new MojoExecutionException(""Failed to parse JSON "" + file + "". "" + e, e);",836867e0413d6087a4520a5b8653b089cad28244,4,0
"throw new MojoExecutionException(""Failed to updated JSON file "" + json + "". "" + e, e);",836867e0413d6087a4520a5b8653b089cad28244,4,0
* Specifies a file which maps environment variables or system properties to annotations which are then recorded on the,836867e0413d6087a4520a5b8653b089cad28244,3,0
"Map<String, String> mapEnvVarToAnnotation = new HashMap<>();",836867e0413d6087a4520a5b8653b089cad28244,3,0
"Map<String, String> annotations = KubernetesHelper.getOrCreateAnnotations(resource);",836867e0413d6087a4520a5b8653b089cad28244,3,0
"for (Map.Entry<String, String> entry : entries) {",836867e0413d6087a4520a5b8653b089cad28244,3,0
String value = Systems.getEnvVarOrSystemProperty(envVar);,836867e0413d6087a4520a5b8653b089cad28244,3,0
"protected static void addPropertiesFileToMap(File file, Map<String, String> answer) throws MojoExecutionException {",836867e0413d6087a4520a5b8653b089cad28244,3,0
if (file != null && file.isFile() && file.exists()) {,836867e0413d6087a4520a5b8653b089cad28244,3,0
Properties properties = new Properties();,836867e0413d6087a4520a5b8653b089cad28244,3,0
"Map<String, String> map = toMap(properties);",836867e0413d6087a4520a5b8653b089cad28244,3,0
"protected static void addPropertiesFileToMap(URL url, Map<String, String> answer) throws MojoExecutionException {",836867e0413d6087a4520a5b8653b089cad28244,3,0
if (envPropertiesFile != null && envPropertiesFile.isFile() && envPropertiesFile.exists()) {,836867e0413d6087a4520a5b8653b089cad28244,3,1
"@Parameter(property = ""fabric8.environmentVariableToAnnotationsFile"", defaultValue = ""${basedir}/src/main/fabric8/environemntToAnnotations.properties"")",836867e0413d6087a4520a5b8653b089cad28244,2,0
protected static Object loadJsonFile(File file) throws MojoExecutionException {,836867e0413d6087a4520a5b8653b089cad28244,2,0
} catch (IOException e) {,836867e0413d6087a4520a5b8653b089cad28244,2,0
Object dto = loadJsonFile(json);,836867e0413d6087a4520a5b8653b089cad28244,2,0
} else if (dto instanceof Template) {,836867e0413d6087a4520a5b8653b089cad28244,2,0
if (items != null) {,836867e0413d6087a4520a5b8653b089cad28244,2,0
} else if (item instanceof Template) {,836867e0413d6087a4520a5b8653b089cad28244,2,0
} else if (item instanceof ReplicationController) {,836867e0413d6087a4520a5b8653b089cad28244,2,0
} else if (item instanceof DeploymentConfig) {,836867e0413d6087a4520a5b8653b089cad28244,2,0
"String resourceName = ""environmentAnnotations.properties"";",836867e0413d6087a4520a5b8653b089cad28244,2,0
"throw new MojoExecutionException(""Could not find resource `"" + resourceName + ""` on the classpath!"");",836867e0413d6087a4520a5b8653b089cad28244,2,0
"Set<Map.Entry<String, String>> entries = mapEnvVarToAnnotation.entrySet();",836867e0413d6087a4520a5b8653b089cad28244,2,0
String envVar = entry.getKey();,836867e0413d6087a4520a5b8653b089cad28244,2,0
String annotation = entry.getValue();,836867e0413d6087a4520a5b8653b089cad28244,2,0
String oldValue = annotations.get(annotation);,836867e0413d6087a4520a5b8653b089cad28244,2,0
} else {,836867e0413d6087a4520a5b8653b089cad28244,2,0
if (url != null) {,836867e0413d6087a4520a5b8653b089cad28244,2,0
try (InputStream in = url.openStream()) {,836867e0413d6087a4520a5b8653b089cad28244,2,0
protected File environmentVariableToAnnotationsFile;,836867e0413d6087a4520a5b8653b089cad28244,1,0
try {,836867e0413d6087a4520a5b8653b089cad28244,1,0
},836867e0413d6087a4520a5b8653b089cad28244,1,0
protected void addEnvironmentAnnotations(File json) throws MojoExecutionException {,836867e0413d6087a4520a5b8653b089cad28244,1,0
if (dto instanceof KubernetesList) {,836867e0413d6087a4520a5b8653b089cad28244,1,0
KubernetesList container = (KubernetesList) dto;,836867e0413d6087a4520a5b8653b089cad28244,1,0
List<HasMetadata> items = container.getItems();,836867e0413d6087a4520a5b8653b089cad28244,1,0
Template container = (Template) dto;,836867e0413d6087a4520a5b8653b089cad28244,1,0
List<HasMetadata> items = container.getObjects();,836867e0413d6087a4520a5b8653b089cad28244,1,0
protected void addEnvironmentAnnotations(Iterable<HasMetadata> items) throws MojoExecutionException {,836867e0413d6087a4520a5b8653b089cad28244,1,0
for (HasMetadata item : items) {,836867e0413d6087a4520a5b8653b089cad28244,1,0
if (item instanceof KubernetesList) {,836867e0413d6087a4520a5b8653b089cad28244,1,0
KubernetesList list = (KubernetesList) item;,836867e0413d6087a4520a5b8653b089cad28244,1,0
Template template = (Template) item;,836867e0413d6087a4520a5b8653b089cad28244,1,0
protected void addEnvironmentAnnotations(HasMetadata resource) throws MojoExecutionException {,836867e0413d6087a4520a5b8653b089cad28244,1,0
URL url = getClass().getResource(resourceName);,836867e0413d6087a4520a5b8653b089cad28244,1,0
if (url == null) {,836867e0413d6087a4520a5b8653b089cad28244,1,0
if (Strings.isNotBlank(value)) {,836867e0413d6087a4520a5b8653b089cad28244,1,0
if (Strings.isNotBlank(oldValue)) {,836867e0413d6087a4520a5b8653b089cad28244,1,0
try (FileInputStream in = new FileInputStream(file)){,836867e0413d6087a4520a5b8653b089cad28244,1,0
try {,836867e0413d6087a4520a5b8653b089cad28244,1,1
import io.fabric8.kubernetes.api.model.KubernetesList;,836867e0413d6087a4520a5b8653b089cad28244,0,0
import io.fabric8.kubernetes.api.model.ObjectMeta;,836867e0413d6087a4520a5b8653b089cad28244,0,0
import io.fabric8.kubernetes.api.model.ReplicationController;,836867e0413d6087a4520a5b8653b089cad28244,0,0
import io.fabric8.openshift.api.model.DeploymentConfig;,836867e0413d6087a4520a5b8653b089cad28244,0,0
import io.fabric8.utils.Systems;,836867e0413d6087a4520a5b8653b089cad28244,0,0
/**,836867e0413d6087a4520a5b8653b089cad28244,0,0
* ReplicationController of the generated or applied JSON,836867e0413d6087a4520a5b8653b089cad28244,0,0
*/,836867e0413d6087a4520a5b8653b089cad28244,0,0
return KubernetesHelper.loadJson(file);,836867e0413d6087a4520a5b8653b089cad28244,0,0
addEnvironmentAnnotations(items);,836867e0413d6087a4520a5b8653b089cad28244,0,0
"getLog().info(""Added enviroment annotations:"");",836867e0413d6087a4520a5b8653b089cad28244,0,0
printSummary(items);,836867e0413d6087a4520a5b8653b089cad28244,0,0
container.setItems(items);,836867e0413d6087a4520a5b8653b089cad28244,0,0
"KubernetesHelper.saveJson(json, container);",836867e0413d6087a4520a5b8653b089cad28244,0,0
container.setObjects(items);,836867e0413d6087a4520a5b8653b089cad28244,0,0
"getLog().info(""Template is now:"");",836867e0413d6087a4520a5b8653b089cad28244,0,0
printSummary(container.getObjects());,836867e0413d6087a4520a5b8653b089cad28244,0,0
addEnvironmentAnnotations(list.getItems());,836867e0413d6087a4520a5b8653b089cad28244,0,0
addEnvironmentAnnotations(template.getObjects());,836867e0413d6087a4520a5b8653b089cad28244,0,0
addEnvironmentAnnotations(item);,836867e0413d6087a4520a5b8653b089cad28244,0,0
"addPropertiesFileToMap(url, mapEnvVarToAnnotation);",836867e0413d6087a4520a5b8653b089cad28244,0,0
"addPropertiesFileToMap(this.environmentVariableToAnnotationsFile, mapEnvVarToAnnotation);",836867e0413d6087a4520a5b8653b089cad28244,0,0
"annotations.put(annotation, value);",836867e0413d6087a4520a5b8653b089cad28244,0,0
"addPropertiesFileToMap(this.envPropertiesFile, answer);",836867e0413d6087a4520a5b8653b089cad28244,0,0
return answer;,836867e0413d6087a4520a5b8653b089cad28244,0,0
properties.load(in);,836867e0413d6087a4520a5b8653b089cad28244,0,0
answer.putAll(map);,836867e0413d6087a4520a5b8653b089cad28244,0,0
// lets override with these values,836867e0413d6087a4520a5b8653b089cad28244,0,1
properties.load(new FileInputStream(envPropertiesFile));,836867e0413d6087a4520a5b8653b089cad28244,0,1
return answer;,836867e0413d6087a4520a5b8653b089cad28244,0,1
"LOG.warn(""Creation disabled so not creating a Template from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(entity));",44f51299e38520c17184378bfaec4f6d72559153,14,0
"LOG.info(""Creating a Template from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(entity));",44f51299e38520c17184378bfaec4f6d72559153,14,0
"LOG.warn(""Creation disabled so not creating a Service from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(service));",44f51299e38520c17184378bfaec4f6d72559153,14,0
"LOG.info(""Creating a Service from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(service));",44f51299e38520c17184378bfaec4f6d72559153,14,0
"LOG.warn(""Creation disabled so not creating a entity from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(entity));",44f51299e38520c17184378bfaec4f6d72559153,14,1
"LOG.info(""Creating a template from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(entity));",44f51299e38520c17184378bfaec4f6d72559153,14,1
"LOG.warn(""Creation disabled so not creating a service from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(serviceAccount));",44f51299e38520c17184378bfaec4f6d72559153,14,1
"LOG.info(""Creating a service account from "" + sourceName + "" namespace "" + namespace + "" name "" + getName",44f51299e38520c17184378bfaec4f6d72559153,14,1
"LOG.warn(""Creation disabled so not creating a service from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(service));",44f51299e38520c17184378bfaec4f6d72559153,14,1
"LOG.info(""Creating a service from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(service));",44f51299e38520c17184378bfaec4f6d72559153,14,1
"LOG.warn(""Creation disabled so not creating a ServiceAccount from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(serviceAccount));",44f51299e38520c17184378bfaec4f6d72559153,13,0
"LOG.info(""Creating a ServiceAccount from "" + sourceName + "" namespace "" + namespace + "" name "" + getName",44f51299e38520c17184378bfaec4f6d72559153,13,0
"LOG.warn(""Creation disabled so not creating a Secret from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(secret));",44f51299e38520c17184378bfaec4f6d72559153,13,0
"LOG.info(""Creating a Secret from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(secret));",44f51299e38520c17184378bfaec4f6d72559153,13,0
"LOG.info(""Updating ReplicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",44f51299e38520c17184378bfaec4f6d72559153,13,0
"LOG.warn(""Creation disabled so not creating a ReplicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",44f51299e38520c17184378bfaec4f6d72559153,13,0
"LOG.info(""Creating a ReplicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",44f51299e38520c17184378bfaec4f6d72559153,13,0
"LOG.info(""Updating a Pod from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(pod));",44f51299e38520c17184378bfaec4f6d72559153,13,0
"LOG.info(""Creating a Pod from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(pod));",44f51299e38520c17184378bfaec4f6d72559153,13,0
"LOG.warn(""Creation disabled so not creating a secret from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(secret));",44f51299e38520c17184378bfaec4f6d72559153,13,1
"LOG.info(""Creating a secret from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(secret));",44f51299e38520c17184378bfaec4f6d72559153,13,1
"LOG.info(""Updating replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",44f51299e38520c17184378bfaec4f6d72559153,13,1
"LOG.warn(""Creation disabled so not creating a replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",44f51299e38520c17184378bfaec4f6d72559153,13,1
"LOG.info(""Creating a replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",44f51299e38520c17184378bfaec4f6d72559153,13,1
"LOG.info(""Updating a pod from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(pod));",44f51299e38520c17184378bfaec4f6d72559153,13,1
"LOG.info(""Creating a pod from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(pod));",44f51299e38520c17184378bfaec4f6d72559153,13,1
"onApplyError(""Failed to Template entity from "" + sourceName + "". "" + e + "". "" + entity, e);",44f51299e38520c17184378bfaec4f6d72559153,12,0
"onApplyError(""Failed to template entity from "" + sourceName + "". "" + e + "". "" + entity, e);",44f51299e38520c17184378bfaec4f6d72559153,12,1
"onApplyError(""Failed to update OAuthClient from "" + sourceName + "". "" + e + "". "" + entity, e);",44f51299e38520c17184378bfaec4f6d72559153,11,0
"onApplyError(""Failed to update Template from "" + sourceName + "". "" + e + "". "" + entity, e);",44f51299e38520c17184378bfaec4f6d72559153,11,0
"onApplyError(""Failed to update Service from "" + sourceName + "". "" + e + "". "" + service, e);",44f51299e38520c17184378bfaec4f6d72559153,11,0
"onApplyError(""Failed to create Service from "" + sourceName + "". "" + e + "". "" + service, e);",44f51299e38520c17184378bfaec4f6d72559153,11,0
"onApplyError(""Failed to update controller from "" + sourceName + "". "" + e + "". "" + entity, e);",44f51299e38520c17184378bfaec4f6d72559153,11,1
"onApplyError(""Failed to update service account from "" + sourceName + "". "" + e + "". "" + serviceAccount, e);",44f51299e38520c17184378bfaec4f6d72559153,11,1
"onApplyError(""Failed to create service account from "" + sourceName + "". "" + e + "". "" + serviceAccount, e);",44f51299e38520c17184378bfaec4f6d72559153,11,1
"onApplyError(""Failed to update controller from "" + sourceName + "". "" + e + "". "" + service, e);",44f51299e38520c17184378bfaec4f6d72559153,11,1
"onApplyError(""Failed to create service from "" + sourceName + "". "" + e + "". "" + service, e);",44f51299e38520c17184378bfaec4f6d72559153,11,1
"onApplyError(""Failed to update pod from "" + sourceName + "". "" + e + "". "" + entity, e);",44f51299e38520c17184378bfaec4f6d72559153,10,0
"onApplyError(""Failed to update pod from "" + sourceName + "". "" + e + "". "" + entity, e);",44f51299e38520c17184378bfaec4f6d72559153,10,1
"onApplyError(""Failed to update ServiceAccount from "" + sourceName + "". "" + e + "". "" + serviceAccount, e);",44f51299e38520c17184378bfaec4f6d72559153,10,0
"onApplyError(""Failed to create ServiceAccount from "" + sourceName + "". "" + e + "". "" + serviceAccount, e);",44f51299e38520c17184378bfaec4f6d72559153,10,0
"onApplyError(""Failed to create Secret from "" + sourceName + "". "" + e + "". "" + secret, e);",44f51299e38520c17184378bfaec4f6d72559153,10,0
"onApplyError(""Failed to update ReplicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",44f51299e38520c17184378bfaec4f6d72559153,10,0
"onApplyError(""Failed to create ReplicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",44f51299e38520c17184378bfaec4f6d72559153,10,0
"onApplyError(""Failed to update Pod from "" + sourceName + "". "" + e + "". "" + pod, e);",44f51299e38520c17184378bfaec4f6d72559153,10,0
"onApplyError(""Failed to create Pod from "" + sourceName + "". "" + e + "". "" + pod, e);",44f51299e38520c17184378bfaec4f6d72559153,10,0
"onApplyError(""Failed to update pod from "" + sourceName + "". "" + e + "". "" + entity, e);",44f51299e38520c17184378bfaec4f6d72559153,10,1
"onApplyError(""Failed to create secret from "" + sourceName + "". "" + e + "". "" + secret, e);",44f51299e38520c17184378bfaec4f6d72559153,10,1
"onApplyError(""Failed to update replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",44f51299e38520c17184378bfaec4f6d72559153,10,1
"onApplyError(""Failed to create replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",44f51299e38520c17184378bfaec4f6d72559153,10,1
"onApplyError(""Failed to update pod from "" + sourceName + "". "" + e + "". "" + pod, e);",44f51299e38520c17184378bfaec4f6d72559153,10,1
"onApplyError(""Failed to create pod from "" + sourceName + "". "" + e + "". "" + pod, e);",44f51299e38520c17184378bfaec4f6d72559153,10,1
"onApplyError(""Failed to create namespace: "" + name + "" due "" + e.getMessage(), e);",44f51299e38520c17184378bfaec4f6d72559153,9,0
"Objects.notNull(id, ""No name for "" + entity + "" "" + sourceName);",44f51299e38520c17184378bfaec4f6d72559153,8,0
"LOG.warn(""Creation disabled so not creating an OAuthClient from "" + sourceName + "" name "" + getName(entity));",44f51299e38520c17184378bfaec4f6d72559153,8,0
"Objects.notNull(id, ""No name for "" + entity + "" "" + sourceName);",44f51299e38520c17184378bfaec4f6d72559153,8,1
"LOG.warn(""Creation disabled so not creating an OAuthClient from "" + sourceName + "" name "" + getName(entity));",44f51299e38520c17184378bfaec4f6d72559153,8,1
"public Service getService(final @PathParam(""serviceId"") @NotNull String serviceId, final @QueryParam(""namespace"") String namespace) {",44f51299e38520c17184378bfaec4f6d72559153,7,0
"onApplyError(""Failed to create namespace. "" + e + "". "" + entity, e);",44f51299e38520c17184378bfaec4f6d72559153,7,0
"onApplyError(""Failed to create namespace. "" + e + "". "" + entity, e);",44f51299e38520c17184378bfaec4f6d72559153,7,1
"LOG.info(""rollingUpgradePreserveScale "" + rollingUpgradePreserveScale + "" new replicas is "" + (newSpec != null ? newSpec.getReplicas() : ""<null>""));",44f51299e38520c17184378bfaec4f6d72559153,7,0
"onApplyError(""Failed to create namespace. "" + e + "". "" + entity, e);",44f51299e38520c17184378bfaec4f6d72559153,7,1
"LOG.info(""rollingUpgradePreserveScale "" + rollingUpgradePreserveScale + "" new replicas is "" + newSpec.getReplicas());",44f51299e38520c17184378bfaec4f6d72559153,7,1
"public ReplicationController getReplicationController(final @PathParam(""controllerId"") @NotNull String controllerId, final @QueryParam(""namespace"") String namespace) {",44f51299e38520c17184378bfaec4f6d72559153,6,0
"public Pod getPod(final @PathParam(""podId"") @NotNull String podId, final @QueryParam(""namespace"") String namespace) {",44f51299e38520c17184378bfaec4f6d72559153,6,0
"public Secret getSecret(final @NotNull String secretId, final String namespace) {",44f51299e38520c17184378bfaec4f6d72559153,6,0
"public Route getRoute(final @PathParam(""name"") @NotNull String name, final @QueryParam(""namespace"") String namespace) {",44f51299e38520c17184378bfaec4f6d72559153,6,0
"public Build getBuild(final @NotNull String name, final String namespace) {",44f51299e38520c17184378bfaec4f6d72559153,6,0
"public DeploymentConfig getDeploymentConfig(final @NotNull String name, final String namespace) {",44f51299e38520c17184378bfaec4f6d72559153,6,0
"public ImageStream getImageStream(final @NotNull String name, final String namespace) {",44f51299e38520c17184378bfaec4f6d72559153,6,0
"public Service getService(@PathParam(""serviceId"") @NotNull String serviceId, @QueryParam(""namespace"") String namespace) {",44f51299e38520c17184378bfaec4f6d72559153,6,1
"public static Map<String, String> getLabels(HasMetadata entity) {",44f51299e38520c17184378bfaec4f6d72559153,6,0
"LOG.warn(""Could not convert "" + result + "" to JSON: "" + e, e);",44f51299e38520c17184378bfaec4f6d72559153,6,0
"LOG.warn(""Cannot convert "" + result + "" to JSON: "" + e, e);",44f51299e38520c17184378bfaec4f6d72559153,6,0
"LOG.info(""Rolling upgrade of the ReplicationController: "" + namespace + ""/"" + id);",44f51299e38520c17184378bfaec4f6d72559153,6,0
"LOG.warn(""Could not convert "" + result + "" to JSON: "" + e, e);",44f51299e38520c17184378bfaec4f6d72559153,6,1
"LOG.info(""Rolling upgrade of the RC "" + namespace + ""/"" + id);",44f51299e38520c17184378bfaec4f6d72559153,6,1
public Namespace getNamespace(final @NotNull String name) {,44f51299e38520c17184378bfaec4f6d72559153,5,0
public OAuthClient getOAuthClient(final @NotNull String name) {,44f51299e38520c17184378bfaec4f6d72559153,5,0
"public ReplicationController getReplicationController(@PathParam(""controllerId"") @NotNull String controllerId, @QueryParam(""namespace"") String namespace) {",44f51299e38520c17184378bfaec4f6d72559153,5,1
"public Pod getPod(@PathParam(""podId"") @NotNull String podId, @QueryParam(""namespace"") String namespace) {",44f51299e38520c17184378bfaec4f6d72559153,5,1
"public Route getRoute(@PathParam(""name"") @NotNull String name, @QueryParam(""namespace"") String namespace) {",44f51299e38520c17184378bfaec4f6d72559153,5,1
public static ObjectMeta getOrCreateMetadata(HasMetadata entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,0
public static String getResourceVersion(HasMetadata entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,0
public static boolean hasResourceVersion(HasMetadata entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,0
public static String getName(HasMetadata entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,0
"public static void setName(HasMetadata entity, String namespace, String name) {",44f51299e38520c17184378bfaec4f6d72559153,5,0
public static String getNamespace(HasMetadata entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,0
public static ObjectMeta getOrCreateMetadata(Pod entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
public static ObjectMeta getOrCreateMetadata(ReplicationController entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
public static ObjectMeta getOrCreateMetadata(Service entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
public static ObjectMeta getOrCreateMetadata(Namespace entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
public static ObjectMeta getOrCreateMetadata(Route entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
public static ObjectMeta getOrCreateMetadata(Build entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
public static ObjectMeta getOrCreateMetadata(BuildConfig entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
public static ObjectMeta getOrCreateMetadata(DeploymentConfig entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
public static ObjectMeta getOrCreateMetadata(ImageStream entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
public static ObjectMeta getOrCreateMetadata(OAuthClient entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
public static ObjectMeta getOrCreateMetadata(Template entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
public static String getName(Pod entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
public static String getName(ReplicationController entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
public static String getName(Service entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
public static String getName(OAuthClient entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
public static String getName(Route entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
public static String getName(Node entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
public static String getName(Template entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
public static String getName(ImageStream entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
public static String getName(Endpoints entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
"public static void setName(Route entity, String namespace, String name) {",44f51299e38520c17184378bfaec4f6d72559153,5,1
public static String getNamespace(Pod entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
public static String getNamespace(ReplicationController entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
public static String getNamespace(Service entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
public static String getNamespace(OAuthClient entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
public static String getNamespace(Route entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
public static String getNamespace(Template entity) {,44f51299e38520c17184378bfaec4f6d72559153,5,1
"LOG.warn(""No name for the entity "" + entity);",44f51299e38520c17184378bfaec4f6d72559153,5,0
"fileName = name + ""-"" + idx++ + "".json"";",44f51299e38520c17184378bfaec4f6d72559153,5,0
"LOG.warn(""Failed to write to file "" + file + "". "" + e, e);",44f51299e38520c17184378bfaec4f6d72559153,5,0
"private static final String NAMESPACE_PREFIX = Systems.getEnvVarOrSystemProperty(""FABRIC8_NAMESPACE_PREFIX"", ""itest-"");",44f51299e38520c17184378bfaec4f6d72559153,5,0
namespace = namespacePrefix + id;,44f51299e38520c17184378bfaec4f6d72559153,5,1
* Installs the template into the namespace without processing it,44f51299e38520c17184378bfaec4f6d72559153,5,0
public Namespace call() throws Exception {,44f51299e38520c17184378bfaec4f6d72559153,4,0
"Service service = getService(serviceId, namespace);",44f51299e38520c17184378bfaec4f6d72559153,4,0
public Service call() throws Exception {,44f51299e38520c17184378bfaec4f6d72559153,4,0
public OAuthClient call() throws Exception {,44f51299e38520c17184378bfaec4f6d72559153,4,0
public Namespace getNamespace(@NotNull String name) {,44f51299e38520c17184378bfaec4f6d72559153,4,1
"public Secret getSecret(@NotNull String secretId, String namespace) {",44f51299e38520c17184378bfaec4f6d72559153,4,1
public OAuthClient getOAuthClient(@NotNull String name) {,44f51299e38520c17184378bfaec4f6d72559153,4,1
"public Build getBuild(@NotNull String name, String namespace) {",44f51299e38520c17184378bfaec4f6d72559153,4,1
"public DeploymentConfig getDeploymentConfig(@NotNull String name, String namespace) {",44f51299e38520c17184378bfaec4f6d72559153,4,1
"public ImageStream getImageStream(@NotNull String name, String namespace) {",44f51299e38520c17184378bfaec4f6d72559153,4,1
* Returns the resource version for the entity or null if it does not have one,44f51299e38520c17184378bfaec4f6d72559153,4,0
ObjectMeta metadata = entity.getMetadata();,44f51299e38520c17184378bfaec4f6d72559153,4,0
* Returns true if this entity has a valid non blank resourceVersion in its metadata,44f51299e38520c17184378bfaec4f6d72559153,4,0
"public static void setName(HasMetadata entity, String name) {",44f51299e38520c17184378bfaec4f6d72559153,4,0
"public static void setNamespace(HasMetadata entity, String namespace) {",44f51299e38520c17184378bfaec4f6d72559153,4,0
public static List<HasMetadata> toItemList(Object entity) throws IOException {,44f51299e38520c17184378bfaec4f6d72559153,4,0
ObjectMeta metadata = entity.getMetadata();,44f51299e38520c17184378bfaec4f6d72559153,4,1
"public static void setName(Pod entity, String name) {",44f51299e38520c17184378bfaec4f6d72559153,4,1
"public static void setName(Service entity, String name) {",44f51299e38520c17184378bfaec4f6d72559153,4,1
"public static void setName(ReplicationController entity, String name) {",44f51299e38520c17184378bfaec4f6d72559153,4,1
"public static void setName(Template entity, String name) {",44f51299e38520c17184378bfaec4f6d72559153,4,1
"public static void setNamespace(Template entity, String namespace) {",44f51299e38520c17184378bfaec4f6d72559153,4,1
"protected static Object getAdditionalProperty(Map<String, Object> additionalProperties, String name) {",44f51299e38520c17184378bfaec4f6d72559153,4,1
public static List<Object> toItemList(Object entity) throws IOException {,44f51299e38520c17184378bfaec4f6d72559153,4,1
"name = kind.toLowerCase() + ""-"" + name;",44f51299e38520c17184378bfaec4f6d72559153,4,0
"String fileName = name + "".json"";",44f51299e38520c17184378bfaec4f6d72559153,4,0
"LOG.info(""Creating a namespace "" + namespace);",44f51299e38520c17184378bfaec4f6d72559153,4,0
"LOG.info(""Created namespace: "" + answer);",44f51299e38520c17184378bfaec4f6d72559153,4,1
"LOG.info(""Not updating the OAuthClient which are shared across namespaces as its already running"");",44f51299e38520c17184378bfaec4f6d72559153,4,0
"LOG.info(""Not updating the OAuthClient which are shared across namespaces as its already running"");",44f51299e38520c17184378bfaec4f6d72559153,4,1
"Objects.notNull(name, ""No name for "" + entity );",44f51299e38520c17184378bfaec4f6d72559153,4,0
private static final Boolean DEFAULT_NAMESPACE_CLEANUP_ENABLED = true;,44f51299e38520c17184378bfaec4f6d72559153,4,0
"public Session(String id, String namesapce, Logger logger) {",44f51299e38520c17184378bfaec4f6d72559153,4,0
* Returns true if the namespace is created,44f51299e38520c17184378bfaec4f6d72559153,4,0
public boolean applyNamespace(Namespace entity) {,44f51299e38520c17184378bfaec4f6d72559153,4,0
"LOG.info(""Using namespace: "" + namespace);",44f51299e38520c17184378bfaec4f6d72559153,4,0
private static final ObjectMapper OBJECT_MAPPER = new ObjectMapper();,44f51299e38520c17184378bfaec4f6d72559153,4,1
"LOG.info(""Creating a namespace "" + namespace);",44f51299e38520c17184378bfaec4f6d72559153,4,1
} else if (entity instanceof ReplicaSet || entity instanceof Deployment || entity instanceof DeploymentConfig) {,44f51299e38520c17184378bfaec4f6d72559153,4,0
"log.status(""Applying "" + entity.getClass().getSimpleName() + ""."");",44f51299e38520c17184378bfaec4f6d72559153,4,0
public ReplicationController call() throws Exception {,44f51299e38520c17184378bfaec4f6d72559153,3,0
// no service so lets create the service,44f51299e38520c17184378bfaec4f6d72559153,3,0
public Pod call() throws Exception {,44f51299e38520c17184378bfaec4f6d72559153,3,0
public Secret call() throws Exception {,44f51299e38520c17184378bfaec4f6d72559153,3,0
public SecretList getSecrets(final String namespace) {,44f51299e38520c17184378bfaec4f6d72559153,3,0
SecretList answer = handle404ByReturningNull(new Callable<SecretList>() {,44f51299e38520c17184378bfaec4f6d72559153,3,0
public SecretList call() throws Exception {,44f51299e38520c17184378bfaec4f6d72559153,3,0
"public RouteList getRoutes(final @QueryParam(""namespace"") String namespace) {",44f51299e38520c17184378bfaec4f6d72559153,3,0
RouteList answer = handle404ByReturningNull(new Callable<RouteList>() {,44f51299e38520c17184378bfaec4f6d72559153,3,0
public RouteList call() throws Exception {,44f51299e38520c17184378bfaec4f6d72559153,3,0
public Route call() throws Exception {,44f51299e38520c17184378bfaec4f6d72559153,3,0
public Build call() throws Exception {,44f51299e38520c17184378bfaec4f6d72559153,3,0
public BuildList getBuilds(final String namespace) {,44f51299e38520c17184378bfaec4f6d72559153,3,0
BuildList answer = handle404ByReturningNull(new Callable<BuildList>() {,44f51299e38520c17184378bfaec4f6d72559153,3,0
public BuildList call() throws Exception {,44f51299e38520c17184378bfaec4f6d72559153,3,0
public DeploymentConfig call() throws Exception {,44f51299e38520c17184378bfaec4f6d72559153,3,0
public DeploymentConfigList getDeploymentConfigs(final String namespace) {,44f51299e38520c17184378bfaec4f6d72559153,3,0
DeploymentConfigList answer = handle404ByReturningNull(new Callable<DeploymentConfigList>() {,44f51299e38520c17184378bfaec4f6d72559153,3,0
public DeploymentConfigList call() throws Exception {,44f51299e38520c17184378bfaec4f6d72559153,3,0
public ImageStream call() throws Exception {,44f51299e38520c17184378bfaec4f6d72559153,3,0
public ImageStreamList getImageStreams(final String namespace) {,44f51299e38520c17184378bfaec4f6d72559153,3,0
ImageStreamList answer = handle404ByReturningNull(new Callable<ImageStreamList>() {,44f51299e38520c17184378bfaec4f6d72559153,3,0
public ImageStreamList call() throws Exception {,44f51299e38520c17184378bfaec4f6d72559153,3,0
} catch (WebApplicationException e) {,44f51299e38520c17184378bfaec4f6d72559153,3,0
} catch (Exception e) {,44f51299e38520c17184378bfaec4f6d72559153,3,0
} catch (WebApplicationException e) {,44f51299e38520c17184378bfaec4f6d72559153,3,1
"public RouteList getRoutes(@QueryParam(""namespace"") String namespace) {",44f51299e38520c17184378bfaec4f6d72559153,3,1
ObjectMeta metadata = getOrCreateMetadata(entity);,44f51299e38520c17184378bfaec4f6d72559153,3,0
public static void moveServicesToFrontOfArray(List<HasMetadata> list) {,44f51299e38520c17184378bfaec4f6d72559153,3,0
metadata = new ObjectMeta();,44f51299e38520c17184378bfaec4f6d72559153,3,1
"protected static String getAdditionalNestedPropertyText(Map<String, Object> additionalProperties, String... names) {",44f51299e38520c17184378bfaec4f6d72559153,3,1
"Map<String, Object> map = additionalProperties;",44f51299e38520c17184378bfaec4f6d72559153,3,1
public static void moveServicesToFrontOfArray(List<Object> list) {,44f51299e38520c17184378bfaec4f6d72559153,3,1
"protected void logGeneratedEntity(String message, String namespace, HasMetadata entity, Object result) {",44f51299e38520c17184378bfaec4f6d72559153,3,0
String kind = KubernetesHelper.getKind(entity);,44f51299e38520c17184378bfaec4f6d72559153,3,0
String name = KubernetesHelper.getName(entity);,44f51299e38520c17184378bfaec4f6d72559153,3,0
} catch (JsonProcessingException e) {,44f51299e38520c17184378bfaec4f6d72559153,3,0
} catch (IOException e) {,44f51299e38520c17184378bfaec4f6d72559153,3,0
String namespace = getOrCreateMetadata(entity).getName();,44f51299e38520c17184378bfaec4f6d72559153,3,0
"LOG.info(""Created template: "" + answer);",44f51299e38520c17184378bfaec4f6d72559153,3,1
"LOG.info(""Created service: "" + answer);",44f51299e38520c17184378bfaec4f6d72559153,3,1
"LOG.info(""Creating a namespace "" + getOrCreateMetadata(entity).getName());",44f51299e38520c17184378bfaec4f6d72559153,3,1
"LOG.info(""Created replicationController: "" + answer);",44f51299e38520c17184378bfaec4f6d72559153,3,1
String id = getName(entity);,44f51299e38520c17184378bfaec4f6d72559153,3,0
"LOG.debug(""Only processing Services right now so ignoring OAuthClient: "" + id);",44f51299e38520c17184378bfaec4f6d72559153,3,0
"Object answer = kubernetes.updateOAuthClient(id, entity);",44f51299e38520c17184378bfaec4f6d72559153,3,0
} catch (Exception e) {,44f51299e38520c17184378bfaec4f6d72559153,3,0
public boolean isSupportOAuthClients() {,44f51299e38520c17184378bfaec4f6d72559153,3,0
String id = getName(entity);,44f51299e38520c17184378bfaec4f6d72559153,3,1
"LOG.debug(""Only processing Services right now so ignoring OAuthClient: "" + id);",44f51299e38520c17184378bfaec4f6d72559153,3,1
"Object answer = kubernetes.updateOAuthClient(id, entity);",44f51299e38520c17184378bfaec4f6d72559153,3,1
} catch (Exception e) {,44f51299e38520c17184378bfaec4f6d72559153,3,1
Namespace entity = new Namespace();,44f51299e38520c17184378bfaec4f6d72559153,3,0
String name = getName(entity);,44f51299e38520c17184378bfaec4f6d72559153,3,0
Object answer = kubernetes.createNamespace(entity);,44f51299e38520c17184378bfaec4f6d72559153,3,0
} catch (Exception e) {,44f51299e38520c17184378bfaec4f6d72559153,3,0
Object answer = kubernetes.createNamespace(entity);,44f51299e38520c17184378bfaec4f6d72559153,3,1
} catch (Exception e) {,44f51299e38520c17184378bfaec4f6d72559153,3,1
private boolean connectToServicesEnabled = DEFAULT_CONNECT_TO_SERVICES;,44f51299e38520c17184378bfaec4f6d72559153,3,0
private boolean namespaceCleanupEnabled = DEFAULT_NAMESPACE_CLEANUP_ENABLED;,44f51299e38520c17184378bfaec4f6d72559153,3,0
private boolean waitForServiceConnectionEnabled = false;,44f51299e38520c17184378bfaec4f6d72559153,3,0
public boolean isWaitForServiceConnectionEnabled() {,44f51299e38520c17184378bfaec4f6d72559153,3,0
public boolean isConnectToServicesEnabled() {,44f51299e38520c17184378bfaec4f6d72559153,3,0
public boolean isNamespaceCleanupEnabled() {,44f51299e38520c17184378bfaec4f6d72559153,3,0
public String getExistingNamespace() {,44f51299e38520c17184378bfaec4f6d72559153,3,0
private boolean connectToServices = DEFAULT_CONNECT_TO_SERVICES;,44f51299e38520c17184378bfaec4f6d72559153,3,1
private boolean waitForServiceConnection = false;,44f51299e38520c17184378bfaec4f6d72559153,3,1
public boolean isWaitForServiceConnection() {,44f51299e38520c17184378bfaec4f6d72559153,3,1
public boolean isConnectToServices() {,44f51299e38520c17184378bfaec4f6d72559153,3,1
private final String namespacePrefix;,44f51299e38520c17184378bfaec4f6d72559153,3,1
"public void installTemplate(Template entity, String sourceName) {",44f51299e38520c17184378bfaec4f6d72559153,3,0
public void applyNamespace(Namespace entity) {,44f51299e38520c17184378bfaec4f6d72559153,3,1
"LOG.info(""Updated OAuthClient result: "" + answer);",44f51299e38520c17184378bfaec4f6d72559153,3,0
"LOG.info(""Updating a Template from "" + sourceName);",44f51299e38520c17184378bfaec4f6d72559153,3,0
"LOG.info(""Updating a Service from "" + sourceName);",44f51299e38520c17184378bfaec4f6d72559153,3,0
"LOG.info(""Created Pod result: "" + answer);",44f51299e38520c17184378bfaec4f6d72559153,3,0
"LOG.info(""Updating a entity from "" + sourceName);",44f51299e38520c17184378bfaec4f6d72559153,3,1
"LOG.info(""Updating a service account from "" + sourceName);",44f51299e38520c17184378bfaec4f6d72559153,3,1
"LOG.info(""Updating a service from "" + sourceName);",44f51299e38520c17184378bfaec4f6d72559153,3,1
"LOG.info(""Created pod result: "" + answer);",44f51299e38520c17184378bfaec4f6d72559153,3,1
// lets try find the default configuration generated by the new fabric8-maven-plugin,44f51299e38520c17184378bfaec4f6d72559153,3,0
Object dto = null;,44f51299e38520c17184378bfaec4f6d72559153,3,0
Object dto = loadJson(readAsString(configUrl));,44f51299e38520c17184378bfaec4f6d72559153,3,1
List<HasMetadata> items = kubeList.getItems();,44f51299e38520c17184378bfaec4f6d72559153,2,0
List<Object> items = kubeList.getItems();,44f51299e38520c17184378bfaec4f6d72559153,2,1
return handle404ByReturningNull(new Callable<Namespace>() {,44f51299e38520c17184378bfaec4f6d72559153,2,0
return handle404ByReturningNull(new Callable<ReplicationController>() {,44f51299e38520c17184378bfaec4f6d72559153,2,0
"return getKubernetes().getReplicationController(controllerId, namespace);",44f51299e38520c17184378bfaec4f6d72559153,2,0
// lets load it from the old service,44f51299e38520c17184378bfaec4f6d72559153,2,0
"return createService(entity, namespace);",44f51299e38520c17184378bfaec4f6d72559153,2,0
String resourceVersion = KubernetesHelper.getResourceVersion(service);,44f51299e38520c17184378bfaec4f6d72559153,2,0
return handle404ByReturningNull(new Callable<Service>() {,44f51299e38520c17184378bfaec4f6d72559153,2,0
"return getKubernetes().getService(serviceId, namespace);",44f51299e38520c17184378bfaec4f6d72559153,2,0
return handle404ByReturningNull(new Callable<Pod>() {,44f51299e38520c17184378bfaec4f6d72559153,2,0
"return getKubernetes().getPod(podId, namespace);",44f51299e38520c17184378bfaec4f6d72559153,2,0
return handle404ByReturningNull(new Callable<Secret>() {,44f51299e38520c17184378bfaec4f6d72559153,2,0
"return getKubernetes().getSecret(secretId, namespace);",44f51299e38520c17184378bfaec4f6d72559153,2,0
answer = new SecretList();,44f51299e38520c17184378bfaec4f6d72559153,2,0
return handle404ByReturningNull(new Callable<OAuthClient>() {,44f51299e38520c17184378bfaec4f6d72559153,2,0
answer = new RouteList();,44f51299e38520c17184378bfaec4f6d72559153,2,0
return handle404ByReturningNull(new Callable<Route>() {,44f51299e38520c17184378bfaec4f6d72559153,2,0
"return getKubernetesExtensions().getRoute(name, namespace);",44f51299e38520c17184378bfaec4f6d72559153,2,0
return handle404ByReturningNull(new Callable<Build>() {,44f51299e38520c17184378bfaec4f6d72559153,2,0
"return getKubernetesExtensions().getBuild(name, namespace);",44f51299e38520c17184378bfaec4f6d72559153,2,0
answer = new BuildList();,44f51299e38520c17184378bfaec4f6d72559153,2,0
return handle404ByReturningNull(new Callable<DeploymentConfig>() {,44f51299e38520c17184378bfaec4f6d72559153,2,0
"return getKubernetesExtensions().getDeploymentConfig(name, namespace);",44f51299e38520c17184378bfaec4f6d72559153,2,0
answer = new DeploymentConfigList();,44f51299e38520c17184378bfaec4f6d72559153,2,0
return handle404ByReturningNull(new Callable<ImageStream>() {,44f51299e38520c17184378bfaec4f6d72559153,2,0
"return getKubernetesExtensions().getImageStream(name, namespace);",44f51299e38520c17184378bfaec4f6d72559153,2,0
answer = new ImageStreamList();,44f51299e38520c17184378bfaec4f6d72559153,2,0
protected static <T> T handle404ByReturningNull(Callable<T> callable) {,44f51299e38520c17184378bfaec4f6d72559153,2,0
} else {,44f51299e38520c17184378bfaec4f6d72559153,2,0
"return getKubernetes().getReplicationController(controllerId, namespace);",44f51299e38520c17184378bfaec4f6d72559153,2,1
"return getKubernetes().getService(serviceId, namespace);",44f51299e38520c17184378bfaec4f6d72559153,2,1
"return getKubernetes().getPod(podId, namespace);",44f51299e38520c17184378bfaec4f6d72559153,2,1
"return getKubernetes().getSecret(secretId, namespace);",44f51299e38520c17184378bfaec4f6d72559153,2,1
public SecretList getSecrets(String namespace) {,44f51299e38520c17184378bfaec4f6d72559153,2,1
} else {,44f51299e38520c17184378bfaec4f6d72559153,2,1
"return getKubernetesExtensions().getRoute(name, namespace);",44f51299e38520c17184378bfaec4f6d72559153,2,1
"return getKubernetesExtensions().getBuild(name, namespace);",44f51299e38520c17184378bfaec4f6d72559153,2,1
public BuildList getBuilds(String namespace) {,44f51299e38520c17184378bfaec4f6d72559153,2,1
"return getKubernetesExtensions().getDeploymentConfig(name, namespace);",44f51299e38520c17184378bfaec4f6d72559153,2,1
public DeploymentConfigList getDeploymentConfigs(String namespace) {,44f51299e38520c17184378bfaec4f6d72559153,2,1
"return getKubernetesExtensions().getImageStream(name, namespace);",44f51299e38520c17184378bfaec4f6d72559153,2,1
public ImageStreamList getImageStreams(String namespace) {,44f51299e38520c17184378bfaec4f6d72559153,2,1
String resourceVersion = metadata.getResourceVersion();,44f51299e38520c17184378bfaec4f6d72559153,2,0
} else if (entity instanceof HasMetadata[]) {,44f51299e38520c17184378bfaec4f6d72559153,2,0
List<HasMetadata> answer = new ArrayList<>();,44f51299e38520c17184378bfaec4f6d72559153,2,0
List<HasMetadata> items = list.getItems();,44f51299e38520c17184378bfaec4f6d72559153,2,0
protected static void removeDuplicates(List<HasMetadata> itemArray) {,44f51299e38520c17184378bfaec4f6d72559153,2,0
List<HasMetadata> items = kubernetesList.getItems();,44f51299e38520c17184378bfaec4f6d72559153,2,0
List<HasMetadata> items = toItemList(dto);,44f51299e38520c17184378bfaec4f6d72559153,2,0
} else if (object instanceof ReplicationController) {,44f51299e38520c17184378bfaec4f6d72559153,2,1
} else if (object instanceof Service) {,44f51299e38520c17184378bfaec4f6d72559153,2,1
} else if (object instanceof Route) {,44f51299e38520c17184378bfaec4f6d72559153,2,1
return metadata;,44f51299e38520c17184378bfaec4f6d72559153,2,1
} else {,44f51299e38520c17184378bfaec4f6d72559153,2,1
ObjectMeta objectMeta = getOrCreateMetadata(entity);,44f51299e38520c17184378bfaec4f6d72559153,2,1
for (int i = 0; i < lastIdx; i++) {,44f51299e38520c17184378bfaec4f6d72559153,2,1
"map = getAdditionalPropertyMap(map, names[i]);",44f51299e38520c17184378bfaec4f6d72559153,2,1
} else if (entity instanceof Object[]) {,44f51299e38520c17184378bfaec4f6d72559153,2,1
List<Object> answer = new ArrayList<>();,44f51299e38520c17184378bfaec4f6d72559153,2,1
List<Object> items = list.getItems();,44f51299e38520c17184378bfaec4f6d72559153,2,1
Object item = list.get(i);,44f51299e38520c17184378bfaec4f6d72559153,2,1
Object nonService = list.get(lastNonService);,44f51299e38520c17184378bfaec4f6d72559153,2,1
protected static void removeDuplicates(List<Object> itemArray) {,44f51299e38520c17184378bfaec4f6d72559153,2,1
Object item = itemArray.get(i);,44f51299e38520c17184378bfaec4f6d72559153,2,1
List<Object> items = kubernetesList.getItems();,44f51299e38520c17184378bfaec4f6d72559153,2,1
List<Object> items = toItemList(dto);,44f51299e38520c17184378bfaec4f6d72559153,2,1
"File namespaceDir = new File(logJsonDir, namespace);",44f51299e38520c17184378bfaec4f6d72559153,2,0
} else {,44f51299e38520c17184378bfaec4f6d72559153,2,0
Object fileLocation = file;,44f51299e38520c17184378bfaec4f6d72559153,2,0
"String path = Files.getRelativePath(basedir, file);",44f51299e38520c17184378bfaec4f6d72559153,2,0
public File getLogJsonDir() {,44f51299e38520c17184378bfaec4f6d72559153,2,0
* Lets you configure the directory where JSON logging files should go,44f51299e38520c17184378bfaec4f6d72559153,2,0
public void setLogJsonDir(File logJsonDir) {,44f51299e38520c17184378bfaec4f6d72559153,2,0
public File getBasedir() {,44f51299e38520c17184378bfaec4f6d72559153,2,0
public void setBasedir(File basedir) {,44f51299e38520c17184378bfaec4f6d72559153,2,0
"LOG.info(""Template processed into: "" + json);",44f51299e38520c17184378bfaec4f6d72559153,2,1
"LOG.info(""Updated service: "" + answer);",44f51299e38520c17184378bfaec4f6d72559153,2,1
"LOG.info(""Updated replicationController: "" + answer);",44f51299e38520c17184378bfaec4f6d72559153,2,1
private boolean supportOAuthClients;,44f51299e38520c17184378bfaec4f6d72559153,2,0
OAuthClient old = kubernetes.getOAuthClient(id);,44f51299e38520c17184378bfaec4f6d72559153,2,0
} else {,44f51299e38520c17184378bfaec4f6d72559153,2,0
"LOG.info(""Updated pod result: "" + answer);",44f51299e38520c17184378bfaec4f6d72559153,2,0
public void setSupportOAuthClients(boolean supportOAuthClients) {,44f51299e38520c17184378bfaec4f6d72559153,2,0
OAuthClient old = kubernetes.getOAuthClient(id);,44f51299e38520c17184378bfaec4f6d72559153,2,1
} else {,44f51299e38520c17184378bfaec4f6d72559153,2,1
"LOG.info(""Updated pod result: "" + answer);",44f51299e38520c17184378bfaec4f6d72559153,2,1
public void applyNamespace(String namespaceName) {,44f51299e38520c17184378bfaec4f6d72559153,2,0
Namespace old = kubernetes.getNamespace(name);,44f51299e38520c17184378bfaec4f6d72559153,2,0
import static io.fabric8.arquillian.kubernetes.Constants.NAMESPACE_CLEANUP_ENABLED;,44f51299e38520c17184378bfaec4f6d72559153,2,0
import static io.fabric8.arquillian.kubernetes.Constants.USE_EXISTING_NAMESPACE;,44f51299e38520c17184378bfaec4f6d72559153,2,0
private String existingNamespace;,44f51299e38520c17184378bfaec4f6d72559153,2,0
import static io.fabric8.arquillian.kubernetes.Constants.KUBERNETES_MASTER;,44f51299e38520c17184378bfaec4f6d72559153,2,1
public void setConnectToServices(boolean connectToServices) {,44f51299e38520c17184378bfaec4f6d72559153,2,1
namespace = namesapce;,44f51299e38520c17184378bfaec4f6d72559153,2,0
"namespacePrefix = Systems.getEnvVarOrSystemProperty(""FABRIC8_NAMESPACE_PREFIX"", ""itest-"");",44f51299e38520c17184378bfaec4f6d72559153,2,1
} else if (configuration.isWaitForServiceConnectionEnabled()) {,44f51299e38520c17184378bfaec4f6d72559153,2,0
} else if (configuration.isWaitForServiceConnection()) {,44f51299e38520c17184378bfaec4f6d72559153,2,1
"LOG.info(""Updated Template: "" + answer);",44f51299e38520c17184378bfaec4f6d72559153,2,0
"LOG.info(""Updating a ServiceAccount from "" + sourceName);",44f51299e38520c17184378bfaec4f6d72559153,2,0
"LOG.info(""Updating a Secret from "" + sourceName);",44f51299e38520c17184378bfaec4f6d72559153,2,0
"LOG.debug(""Ignoring recursive list "" + list);",44f51299e38520c17184378bfaec4f6d72559153,2,0
"LOG.info(kind + "" has not changed so not doing anything"");",44f51299e38520c17184378bfaec4f6d72559153,2,0
"LOG.info(""Updated Pod result: "" + answer);",44f51299e38520c17184378bfaec4f6d72559153,2,0
"private Map<String, Pod> podMap;",44f51299e38520c17184378bfaec4f6d72559153,2,1
"private Map<String, ReplicationController> replicationControllerMap;",44f51299e38520c17184378bfaec4f6d72559153,2,1
"private Map<String, Service> serviceMap;",44f51299e38520c17184378bfaec4f6d72559153,2,1
"LOG.info(""Updated pod result: "" + answer);",44f51299e38520c17184378bfaec4f6d72559153,2,1
"LOG.info(""Updated entity: "" + answer);",44f51299e38520c17184378bfaec4f6d72559153,2,1
"LOG.info(""Updateing a secret from "" + sourceName);",44f51299e38520c17184378bfaec4f6d72559153,2,1
"LOG.warn(""Ignoring recursive list "" + list);",44f51299e38520c17184378bfaec4f6d72559153,2,1
"LOG.info(kind + "" hasn't changed so not doing anything"");",44f51299e38520c17184378bfaec4f6d72559153,2,1
import static io.fabric8.arquillian.kubernetes.Configuration.findConfigResource;,44f51299e38520c17184378bfaec4f6d72559153,2,0
import static io.fabric8.kubernetes.api.KubernetesHelper.loadYaml;,44f51299e38520c17184378bfaec4f6d72559153,2,0
"String resourceName = ""kubernetes.yml"";",44f51299e38520c17184378bfaec4f6d72559153,2,0
"configUrl = findConfigResource(""/META-INF/fabric8/"" + resourceName);",44f51299e38520c17184378bfaec4f6d72559153,2,0
String configText = readAsString(configUrl);,44f51299e38520c17184378bfaec4f6d72559153,2,0
String configPath = configUrl.getPath();,44f51299e38520c17184378bfaec4f6d72559153,2,0
"dto = loadYaml(configText, KubernetesResource.class);",44f51299e38520c17184378bfaec4f6d72559153,2,0
} else {,44f51299e38520c17184378bfaec4f6d72559153,2,0
dto = loadJson(configText);,44f51299e38520c17184378bfaec4f6d72559153,2,0
import io.fabric8.kubernetes.api.model.HasMetadata;,44f51299e38520c17184378bfaec4f6d72559153,1,0
import io.fabric8.kubernetes.api.model.ObjectMeta;,44f51299e38520c17184378bfaec4f6d72559153,1,0
import java.util.concurrent.Callable;,44f51299e38520c17184378bfaec4f6d72559153,1,0
@Override,44f51299e38520c17184378bfaec4f6d72559153,1,0
return getKubernetes().getNamespace(name);,44f51299e38520c17184378bfaec4f6d72559153,1,0
},44f51299e38520c17184378bfaec4f6d72559153,1,0
if (!KubernetesHelper.hasResourceVersion(entity)) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
if (service == null) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
return getKubernetes().getSecrets(namespace);,44f51299e38520c17184378bfaec4f6d72559153,1,0
if (answer == null) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
return answer;,44f51299e38520c17184378bfaec4f6d72559153,1,0
return getKubernetesGlobalExtensions().getOAuthClient(name);,44f51299e38520c17184378bfaec4f6d72559153,1,0
return getKubernetesExtensions().getRoutes(namespace);,44f51299e38520c17184378bfaec4f6d72559153,1,0
return getKubernetesExtensions().getBuilds(namespace);,44f51299e38520c17184378bfaec4f6d72559153,1,0
return getKubernetesExtensions().getDeploymentConfigs(namespace);,44f51299e38520c17184378bfaec4f6d72559153,1,0
return getKubernetesExtensions().getImageStreams(namespace);,44f51299e38520c17184378bfaec4f6d72559153,1,0
* A helper method to handle REST APIs which throw a 404 by just returning null,44f51299e38520c17184378bfaec4f6d72559153,1,0
try {,44f51299e38520c17184378bfaec4f6d72559153,1,0
return callable.call();,44f51299e38520c17184378bfaec4f6d72559153,1,0
if (e.getResponse().getStatus() == 404) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
return null;,44f51299e38520c17184378bfaec4f6d72559153,1,0
return getKubernetes().getNamespace(name);,44f51299e38520c17184378bfaec4f6d72559153,1,1
return getKubernetes().getSecrets(namespace);,44f51299e38520c17184378bfaec4f6d72559153,1,1
try {,44f51299e38520c17184378bfaec4f6d72559153,1,1
return getKubernetesGlobalExtensions().getOAuthClient(name);,44f51299e38520c17184378bfaec4f6d72559153,1,1
if (e.getResponse().getStatus() == 404) {,44f51299e38520c17184378bfaec4f6d72559153,1,1
return null;,44f51299e38520c17184378bfaec4f6d72559153,1,1
},44f51299e38520c17184378bfaec4f6d72559153,1,1
return getKubernetesExtensions().getRoutes(namespace);,44f51299e38520c17184378bfaec4f6d72559153,1,1
return getKubernetesExtensions().getBuilds(namespace);,44f51299e38520c17184378bfaec4f6d72559153,1,1
return getKubernetesExtensions().getDeploymentConfigs(namespace);,44f51299e38520c17184378bfaec4f6d72559153,1,1
return getKubernetesExtensions().getImageStreams(namespace);,44f51299e38520c17184378bfaec4f6d72559153,1,1
import io.fabric8.kubernetes.api.model.HasMetadata;,44f51299e38520c17184378bfaec4f6d72559153,1,0
if (object instanceof HasMetadata) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
return getName((HasMetadata) object);,44f51299e38520c17184378bfaec4f6d72559153,1,0
if (entity != null) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
if (metadata != null) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
if (Strings.isNotBlank(resourceVersion)) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
return resourceVersion;,44f51299e38520c17184378bfaec4f6d72559153,1,0
},44f51299e38520c17184378bfaec4f6d72559153,1,0
return null;,44f51299e38520c17184378bfaec4f6d72559153,1,0
return getResourceVersion(entity) != null;,44f51299e38520c17184378bfaec4f6d72559153,1,0
return getName(entity.getMetadata());,44f51299e38520c17184378bfaec4f6d72559153,1,0
return getNamespace(entity.getMetadata());,44f51299e38520c17184378bfaec4f6d72559153,1,0
return getLabels(entity.getMetadata());,44f51299e38520c17184378bfaec4f6d72559153,1,0
return Collections.EMPTY_MAP;,44f51299e38520c17184378bfaec4f6d72559153,1,0
return (List<HasMetadata>) entity;,44f51299e38520c17184378bfaec4f6d72559153,1,0
HasMetadata[] array = (HasMetadata[]) entity;,44f51299e38520c17184378bfaec4f6d72559153,1,0
if (entity instanceof HasMetadata) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
HasMetadata item = list.get(i);,44f51299e38520c17184378bfaec4f6d72559153,1,0
HasMetadata nonService = list.get(lastNonService);,44f51299e38520c17184378bfaec4f6d72559153,1,0
HasMetadata item = itemArray.get(i);,44f51299e38520c17184378bfaec4f6d72559153,1,0
if (object instanceof Pod) {,44f51299e38520c17184378bfaec4f6d72559153,1,1
return getName((Pod) object);,44f51299e38520c17184378bfaec4f6d72559153,1,1
return getName((ReplicationController) object);,44f51299e38520c17184378bfaec4f6d72559153,1,1
return getName((Service) object);,44f51299e38520c17184378bfaec4f6d72559153,1,1
return getName((Route) object);,44f51299e38520c17184378bfaec4f6d72559153,1,1
if (metadata == null) {,44f51299e38520c17184378bfaec4f6d72559153,1,1
entity.setMetadata(metadata);,44f51299e38520c17184378bfaec4f6d72559153,1,1
},44f51299e38520c17184378bfaec4f6d72559153,1,1
"return Strings.firstNonBlank(getName(entity.getMetadata()),",44f51299e38520c17184378bfaec4f6d72559153,1,1
if (entity != null) {,44f51299e38520c17184378bfaec4f6d72559153,1,1
return null;,44f51299e38520c17184378bfaec4f6d72559153,1,1
"return Strings.firstNonBlank(getNamespace(entity.getMetadata()),",44f51299e38520c17184378bfaec4f6d72559153,1,1
if (additionalProperties != null) {,44f51299e38520c17184378bfaec4f6d72559153,1,1
return additionalProperties.get(name);,44f51299e38520c17184378bfaec4f6d72559153,1,1
int lastIdx = names.length - 1;,44f51299e38520c17184378bfaec4f6d72559153,1,1
if (map == null) {,44f51299e38520c17184378bfaec4f6d72559153,1,1
"return getAdditionalPropertyText(map, names[lastIdx]);",44f51299e38520c17184378bfaec4f6d72559153,1,1
return (List<Object>) entity;,44f51299e38520c17184378bfaec4f6d72559153,1,1
Object[] array = (Object[]) entity;,44f51299e38520c17184378bfaec4f6d72559153,1,1
import com.fasterxml.jackson.core.JsonProcessingException;,44f51299e38520c17184378bfaec4f6d72559153,1,0
import io.fabric8.utils.IOHelpers;,44f51299e38520c17184378bfaec4f6d72559153,1,0
private File logJsonDir;,44f51299e38520c17184378bfaec4f6d72559153,1,0
private File basedir;,44f51299e38520c17184378bfaec4f6d72559153,1,0
if (logJsonDir != null) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
if (Strings.isNotBlank(kind)) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
},44f51299e38520c17184378bfaec4f6d72559153,1,0
if (Strings.isNullOrBlank(name)) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
"File file = new File(namespaceDir, fileName);",44f51299e38520c17184378bfaec4f6d72559153,1,0
if (file.exists()) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
int idx = 1;,44f51299e38520c17184378bfaec4f6d72559153,1,0
while (true) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
"file = new File(namespaceDir, fileName);",44f51299e38520c17184378bfaec4f6d72559153,1,0
if (!file.exists()) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
String text;,44f51299e38520c17184378bfaec4f6d72559153,1,0
if (result instanceof String) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
text = result.toString();,44f51299e38520c17184378bfaec4f6d72559153,1,0
try {,44f51299e38520c17184378bfaec4f6d72559153,1,0
text = KubernetesHelper.toJson(result);,44f51299e38520c17184378bfaec4f6d72559153,1,0
if (result != null) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
"text = ""null"";",44f51299e38520c17184378bfaec4f6d72559153,1,0
if (basedir != null) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
if (path != null) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
"fileLocation = Strings.stripPrefix(path, ""/"");",44f51299e38520c17184378bfaec4f6d72559153,1,0
LOG.info(message + fileLocation);,44f51299e38520c17184378bfaec4f6d72559153,1,0
LOG.info(message + result);,44f51299e38520c17184378bfaec4f6d72559153,1,0
"logGeneratedEntity(""Created namespace: "", namespace, entity, answer);",44f51299e38520c17184378bfaec4f6d72559153,1,0
return logJsonDir;,44f51299e38520c17184378bfaec4f6d72559153,1,0
this.logJsonDir = logJsonDir;,44f51299e38520c17184378bfaec4f6d72559153,1,0
return basedir;,44f51299e38520c17184378bfaec4f6d72559153,1,0
this.basedir = basedir;,44f51299e38520c17184378bfaec4f6d72559153,1,0
if (supportOAuthClients) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
if (isServicesOnlyMode()) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
if (isRunning(old)) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
if (isIgnoreRunningOAuthClients()) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
},44f51299e38520c17184378bfaec4f6d72559153,1,0
"if (UserConfigurationCompare.configEqual(entity, old)) {",44f51299e38520c17184378bfaec4f6d72559153,1,0
if (isRecreateMode()) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
try {,44f51299e38520c17184378bfaec4f6d72559153,1,0
if (!isAllowCreate()) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
return supportOAuthClients;,44f51299e38520c17184378bfaec4f6d72559153,1,0
this.supportOAuthClients = supportOAuthClients;,44f51299e38520c17184378bfaec4f6d72559153,1,0
if (isServicesOnlyMode()) {,44f51299e38520c17184378bfaec4f6d72559153,1,1
},44f51299e38520c17184378bfaec4f6d72559153,1,1
if (isRunning(old)) {,44f51299e38520c17184378bfaec4f6d72559153,1,1
if (isIgnoreRunningOAuthClients()) {,44f51299e38520c17184378bfaec4f6d72559153,1,1
"if (UserConfigurationCompare.configEqual(entity, old)) {",44f51299e38520c17184378bfaec4f6d72559153,1,1
if (isRecreateMode()) {,44f51299e38520c17184378bfaec4f6d72559153,1,1
try {,44f51299e38520c17184378bfaec4f6d72559153,1,1
if (!isAllowCreate()) {,44f51299e38520c17184378bfaec4f6d72559153,1,1
},44f51299e38520c17184378bfaec4f6d72559153,1,0
if (!isRunning(old)) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
try {,44f51299e38520c17184378bfaec4f6d72559153,1,0
"logGeneratedEntity(""Created namespace: "", namespace, entity, answer);",44f51299e38520c17184378bfaec4f6d72559153,1,0
try {,44f51299e38520c17184378bfaec4f6d72559153,1,1
"logGeneratedEntity(""Created namespace: "", namespace, entity, answer);",44f51299e38520c17184378bfaec4f6d72559153,1,1
return waitForServiceConnectionEnabled;,44f51299e38520c17184378bfaec4f6d72559153,1,0
return connectToServicesEnabled;,44f51299e38520c17184378bfaec4f6d72559153,1,0
},44f51299e38520c17184378bfaec4f6d72559153,1,0
return namespaceCleanupEnabled;,44f51299e38520c17184378bfaec4f6d72559153,1,0
return existingNamespace;,44f51299e38520c17184378bfaec4f6d72559153,1,0
"configuration.waitForServiceConnectionEnabled = getBooleanProperty(WAIT_FOR_SERVICE_CONNECTION, map, true);",44f51299e38520c17184378bfaec4f6d72559153,1,0
"configuration.connectToServicesEnabled = getBooleanProperty(CONNECT_TO_SERVICES, map, DEFAULT_CONNECT_TO_SERVICES);",44f51299e38520c17184378bfaec4f6d72559153,1,0
"configuration.existingNamespace = getStringProperty(USE_EXISTING_NAMESPACE, map, null);",44f51299e38520c17184378bfaec4f6d72559153,1,0
"//We default to ""cleanup=true"" when generating namespace and ""cleanup=false"" when using existing namespace.",44f51299e38520c17184378bfaec4f6d72559153,1,0
"configuration.namespaceCleanupEnabled = getBooleanProperty(NAMESPACE_CLEANUP_ENABLED, map, Strings.isNullOrBlank(configuration.existingNamespace));",44f51299e38520c17184378bfaec4f6d72559153,1,0
import java.util.Properties;,44f51299e38520c17184378bfaec4f6d72559153,1,1
return waitForServiceConnection;,44f51299e38520c17184378bfaec4f6d72559153,1,1
return connectToServices;,44f51299e38520c17184378bfaec4f6d72559153,1,1
this.connectToServices = connectToServices;,44f51299e38520c17184378bfaec4f6d72559153,1,1
"configuration.waitForServiceConnection = getBooleanProperty(WAIT_FOR_SERVICE_CONNECTION, map, true);",44f51299e38520c17184378bfaec4f6d72559153,1,1
"configuration.connectToServices = getBooleanProperty(CONNECT_TO_SERVICES, map, DEFAULT_CONNECT_TO_SERVICES);",44f51299e38520c17184378bfaec4f6d72559153,1,1
"this(id, NAMESPACE_PREFIX + id, logger);",44f51299e38520c17184378bfaec4f6d72559153,1,0
},44f51299e38520c17184378bfaec4f6d72559153,1,0
if (configuration.isConnectToServicesEnabled()) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
if (configuration.isConnectToServices()) {,44f51299e38520c17184378bfaec4f6d72559153,1,1
"return processTemplate(entity, sourceName);",44f51299e38520c17184378bfaec4f6d72559153,1,0
},44f51299e38520c17184378bfaec4f6d72559153,1,0
return true;,44f51299e38520c17184378bfaec4f6d72559153,1,0
return false;,44f51299e38520c17184378bfaec4f6d72559153,1,0
"return processTemplate(entity, sourceName);",44f51299e38520c17184378bfaec4f6d72559153,1,1
"logGeneratedEntity(""Updated service account: "", namespace, serviceAccount, answer);",44f51299e38520c17184378bfaec4f6d72559153,1,1
"logGeneratedEntity(""Created service account: "", namespace, serviceAccount, answer);",44f51299e38520c17184378bfaec4f6d72559153,1,1
import io.fabric8.kubernetes.api.model.KubernetesResource;,44f51299e38520c17184378bfaec4f6d72559153,1,0
import io.fabric8.kubernetes.api.model.extensions.Deployment;,44f51299e38520c17184378bfaec4f6d72559153,1,0
import io.fabric8.kubernetes.api.model.extensions.ReplicaSet;,44f51299e38520c17184378bfaec4f6d72559153,1,0
import io.fabric8.openshift.api.model.DeploymentConfig;,44f51299e38520c17184378bfaec4f6d72559153,1,0
if (configUrl == null) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
if (controller.getOpenShiftClientOrNull() != null) {,44f51299e38520c17184378bfaec4f6d72559153,1,0
"resourceName = ""openshift.yml"";",44f51299e38520c17184378bfaec4f6d72559153,1,0
},44f51299e38520c17184378bfaec4f6d72559153,1,0
"if (configPath.endsWith("".yml"") || configPath.endsWith("".yaml"")) {",44f51299e38520c17184378bfaec4f6d72559153,1,0
import java.net.MalformedURLException;,44f51299e38520c17184378bfaec4f6d72559153,1,1
});,44f51299e38520c17184378bfaec4f6d72559153,0,0
KubernetesHelper.getOrCreateMetadata(entity).setResourceVersion(resourceVersion);,44f51299e38520c17184378bfaec4f6d72559153,0,0
/**,44f51299e38520c17184378bfaec4f6d72559153,0,0
*/,44f51299e38520c17184378bfaec4f6d72559153,0,0
throw e;,44f51299e38520c17184378bfaec4f6d72559153,0,0
throw new WebApplicationException(e);,44f51299e38520c17184378bfaec4f6d72559153,0,0
// does not exist,44f51299e38520c17184378bfaec4f6d72559153,0,1
throw e;,44f51299e38520c17184378bfaec4f6d72559153,0,1
/**,44f51299e38520c17184378bfaec4f6d72559153,0,0
*/,44f51299e38520c17184378bfaec4f6d72559153,0,0
metadata.setNamespace(namespace);,44f51299e38520c17184378bfaec4f6d72559153,0,0
metadata.setName(name);,44f51299e38520c17184378bfaec4f6d72559153,0,0
answer.add((HasMetadata) entity);,44f51299e38520c17184378bfaec4f6d72559153,0,0
"getAdditionalPropertyText(entity.getAdditionalProperties(), ""name""),",44f51299e38520c17184378bfaec4f6d72559153,0,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""name""),",44f51299e38520c17184378bfaec4f6d72559153,0,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""id"")",44f51299e38520c17184378bfaec4f6d72559153,0,1
);,44f51299e38520c17184378bfaec4f6d72559153,0,1
getOrCreateMetadata(entity).setName(name);,44f51299e38520c17184378bfaec4f6d72559153,0,1
objectMeta.setNamespace(namespace);,44f51299e38520c17184378bfaec4f6d72559153,0,1
objectMeta.setName(name);,44f51299e38520c17184378bfaec4f6d72559153,0,1
"getAdditionalPropertyText(entity.getAdditionalProperties(), ""namespace""),",44f51299e38520c17184378bfaec4f6d72559153,0,1
"getAdditionalNestedPropertyText(entity.getAdditionalProperties(), ""metadata"", ""namespace""));",44f51299e38520c17184378bfaec4f6d72559153,0,1
answer.add(answer);,44f51299e38520c17184378bfaec4f6d72559153,0,1
"logGeneratedEntity(""Created template: "", namespace, entity, answer);",44f51299e38520c17184378bfaec4f6d72559153,0,0
namespaceDir.mkdirs();,44f51299e38520c17184378bfaec4f6d72559153,0,0
break;,44f51299e38520c17184378bfaec4f6d72559153,0,0
"IOHelpers.writeFully(file, text);",44f51299e38520c17184378bfaec4f6d72559153,0,0
return;,44f51299e38520c17184378bfaec4f6d72559153,0,0
"logGeneratedEntity(""Template processed into: "", namespace, entity, json);",44f51299e38520c17184378bfaec4f6d72559153,0,0
"logGeneratedEntity(""Updated service: "", namespace, service, answer);",44f51299e38520c17184378bfaec4f6d72559153,0,0
"logGeneratedEntity(""Created service: "", namespace, service, answer);",44f51299e38520c17184378bfaec4f6d72559153,0,0
"logGeneratedEntity(""Updated replicationController: "", namespace, replicationController, answer);",44f51299e38520c17184378bfaec4f6d72559153,0,0
"logGeneratedEntity(""Created replicationController: "", namespace, replicationController, answer);",44f51299e38520c17184378bfaec4f6d72559153,0,0
/**,44f51299e38520c17184378bfaec4f6d72559153,0,0
*/,44f51299e38520c17184378bfaec4f6d72559153,0,0
return;,44f51299e38520c17184378bfaec4f6d72559153,0,0
"LOG.info(""OAuthClient hasn't changed so not doing anything"");",44f51299e38520c17184378bfaec4f6d72559153,0,0
kubernetes.deleteOAuthClient(id);,44f51299e38520c17184378bfaec4f6d72559153,0,0
"doCreateOAuthClient(entity, sourceName);",44f51299e38520c17184378bfaec4f6d72559153,0,0
return;,44f51299e38520c17184378bfaec4f6d72559153,0,1
"LOG.info(""OAuthClient hasn't changed so not doing anything"");",44f51299e38520c17184378bfaec4f6d72559153,0,1
kubernetes.deleteOAuthClient(id);,44f51299e38520c17184378bfaec4f6d72559153,0,1
"doCreateOAuthClient(entity, sourceName);",44f51299e38520c17184378bfaec4f6d72559153,0,1
getOrCreateMetadata(entity).setName(namespaceName);,44f51299e38520c17184378bfaec4f6d72559153,0,0
applyNamespace(entity);,44f51299e38520c17184378bfaec4f6d72559153,0,0
"installTemplate(entity, sourceName);",44f51299e38520c17184378bfaec4f6d72559153,0,0
/**,44f51299e38520c17184378bfaec4f6d72559153,0,0
*/,44f51299e38520c17184378bfaec4f6d72559153,0,0
"LOG.info(""OAuthClient has not changed so not doing anything"");",44f51299e38520c17184378bfaec4f6d72559153,0,0
"LOG.info(""Template has not changed so not doing anything"");",44f51299e38520c17184378bfaec4f6d72559153,0,0
"logGeneratedEntity(""Created Template: "", namespace, entity, answer);",44f51299e38520c17184378bfaec4f6d72559153,0,0
"LOG.info(""ServiceAccount has not changed so not doing anything"");",44f51299e38520c17184378bfaec4f6d72559153,0,0
"logGeneratedEntity(""Updated ServiceAccount: "", namespace, serviceAccount, answer);",44f51299e38520c17184378bfaec4f6d72559153,0,0
"logGeneratedEntity(""Created ServiceAccount: "", namespace, serviceAccount, answer);",44f51299e38520c17184378bfaec4f6d72559153,0,0
"LOG.info(""Secret has not changed so not doing anything"");",44f51299e38520c17184378bfaec4f6d72559153,0,0
"logGeneratedEntity(""Updated Secret:"", namespace, secret, answer);",44f51299e38520c17184378bfaec4f6d72559153,0,0
"logGeneratedEntity(""Created Secret: "", namespace, secret, answer);",44f51299e38520c17184378bfaec4f6d72559153,0,0
"LOG.info(""BuildConfig has not changed so not doing anything"");",44f51299e38520c17184378bfaec4f6d72559153,0,0
"LOG.info(""Service has not changed so not doing anything"");",44f51299e38520c17184378bfaec4f6d72559153,0,0
"logGeneratedEntity(""Updated Service: "", namespace, service, answer);",44f51299e38520c17184378bfaec4f6d72559153,0,0
"logGeneratedEntity(""Created Service: "", namespace, service, answer);",44f51299e38520c17184378bfaec4f6d72559153,0,0
"LOG.info(""ReplicationController has not changed so not doing anything"");",44f51299e38520c17184378bfaec4f6d72559153,0,0
"logGeneratedEntity(""Created ReplicationController: "", namespace, replicationController, answer);",44f51299e38520c17184378bfaec4f6d72559153,0,0
"LOG.info(""Pod has not changed so not doing anything"");",44f51299e38520c17184378bfaec4f6d72559153,0,0
"LOG.info(""OAuthClient hasn't changed so not doing anything"");",44f51299e38520c17184378bfaec4f6d72559153,0,1
"LOG.info(""Template hasn't changed so not doing anything"");",44f51299e38520c17184378bfaec4f6d72559153,0,1
"logGeneratedEntity(""Created template: "", namespace, entity, answer);",44f51299e38520c17184378bfaec4f6d72559153,0,1
"LOG.info(""ServiceAccount hasn't changed so not doing anything"");",44f51299e38520c17184378bfaec4f6d72559153,0,1
"LOG.info(""Secret hasn't changed so not doing anything"");",44f51299e38520c17184378bfaec4f6d72559153,0,1
"logGeneratedEntity(""Updated secret:"", namespace, secret, answer);",44f51299e38520c17184378bfaec4f6d72559153,0,1
"logGeneratedEntity(""Created secret: "", namespace, secret, answer);",44f51299e38520c17184378bfaec4f6d72559153,0,1
"LOG.info(""BuildConfig hasn't changed so not doing anything"");",44f51299e38520c17184378bfaec4f6d72559153,0,1
"LOG.info(""Service hasn't changed so not doing anything"");",44f51299e38520c17184378bfaec4f6d72559153,0,1
"logGeneratedEntity(""Updated service: "", namespace, service, answer);",44f51299e38520c17184378bfaec4f6d72559153,0,1
"logGeneratedEntity(""Created service: "", namespace, service, answer);",44f51299e38520c17184378bfaec4f6d72559153,0,1
"LOG.info(""ReplicationController hasn't changed so not doing anything"");",44f51299e38520c17184378bfaec4f6d72559153,0,1
"logGeneratedEntity(""Created replicationController: "", namespace, replicationController, answer);",44f51299e38520c17184378bfaec4f6d72559153,0,1
"LOG.info(""Pod hasn't changed so not doing anything"");",44f51299e38520c17184378bfaec4f6d72559153,0,1
"createNamespace(client, controller, session);",44f51299e38520c17184378bfaec4f6d72559153,0,0
"checkNamespace(client, controller, session, configuration);",44f51299e38520c17184378bfaec4f6d72559153,0,0
"controller.apply(entity, session.getId());",44f51299e38520c17184378bfaec4f6d72559153,0,0
"conditions.put(1, sessionPodsReady);",44f51299e38520c17184378bfaec4f6d72559153,0,0
"createNamespace(client, session);",44f51299e38520c17184378bfaec4f6d72559153,0,1
"checkNamespace(client, session, configuration);",44f51299e38520c17184378bfaec4f6d72559153,0,1
"return Results.success(""Added BuildConfig: "" + Builds.getName(buildConfig) + "" to OpenShift at master: "" + getKubernetes().getMasterUrl());",3994edc36aa49cf0429c5be9129b3c106cbe64eb,14,1
"return Results.success(""Added BuildConfig: "" + Builds.getName(buildConfig) + "" to OpenShift at master: "" + getKubernetes().getMasterUrl());",3994edc36aa49cf0429c5be9129b3c106cbe64eb,14,1
"LOG.warn(""Failed to find relative path for folder "" + dir + "" and file "" + file + "". "" + e, e);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,10,1
"LOG.info(""START getCurrentSelectedProject: on "" + getProjectFactory() + "" selection: "" + selectedObject + "". This may result in mvn artifacts being downloaded to ~/.m2/repository"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,9,1
"LOG.warn(""Could not find service "" + gitServiceName + "" for namespace "" + namespace);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,8,1
"""                  \""uri\"":\"""" + gitAddress + ""/"" + user + ""/"" + buildName + "".git\""\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,8,1
"LOG.info(""Creating a BuildConfig for namespace: "" + namespace + "" project: "" + projectName);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,7,1
"LOG.info(""Commiting and pushing to: "" + remoteUrl + "" and remote name "" + origin);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,6,0
"LOG.info(""END   getCurrentSelectedProject: on "" + getProjectFactory() + "" selection: "" + selectedObject);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,6,1
"LOG.info(""Configured project "" + buildName + "" environments: "" + config.getEnvironments());",3994edc36aa49cf0429c5be9129b3c106cbe64eb,6,1
"LOG.warn(""Failed to load local pipeline "" + file + "". "" + e, e);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,6,1
"LOG.warn(""Failed to parse yaml file "" + yamlFile + "". "" + e, e);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,6,1
"@WithAttributes(label = ""Replication Controller ID"", description = ""The ID of the replication controller to delete."", required = true)",3994edc36aa49cf0429c5be9129b3c106cbe64eb,6,1
"String remoteUrl = internalAddress + user + ""/"" + named + "".git"";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,6,1
"//results.appendOut(""Created git repository "" + fullName + "" at: "" + htmlUrl);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,6,1
"LOG.info(""Using remoteUrl: "" + remoteUrl + "" and remote name "" + origin);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,6,1
"LOG.info(""Commiting and pushing to: "" + remoteUrl + "" and remote name "" + origin);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,6,1
"LOG.warn(""Failed to write file "" + dummyFile + "". "" + e, e);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,6,1
"LOG.warn(""failed to find fabric8 console service URL: "" + e, e);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,5,1
"LOG.warn(""Failed to create web hook in git repo: "" + e, e);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,5,1
"@WithAttributes(name = ""kubernetesUrl"", label = ""The URL where the kubernetes master is running"")",3994edc36aa49cf0429c5be9129b3c106cbe64eb,5,1
"message = ""No "" + fileName + "" need be generated as there is no configuration"";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,5,1
"message = operation + "" "" + fileName;",3994edc36aa49cf0429c5be9129b3c106cbe64eb,5,1
"gitUrl = address + user + ""/"" + named + "".git"";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,5,1
private static String namespace = KubernetesHelper.defaultNamespace();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,5,1
"@WithAttributes(name = ""kubernetesUrl"", label = ""The URL where the kubernetes master is running"")",3994edc36aa49cf0429c5be9129b3c106cbe64eb,5,1
* Command to delete a pod in kubernetes,3994edc36aa49cf0429c5be9129b3c106cbe64eb,5,1
* Command to list pods in kubernetes,3994edc36aa49cf0429c5be9129b3c106cbe64eb,5,1
* Command to list replication controllers in kubernetes,3994edc36aa49cf0429c5be9129b3c106cbe64eb,5,1
"@WithAttributes(label = ""Service ID"", description = ""The ID of the service to delete."", required = true)",3994edc36aa49cf0429c5be9129b3c106cbe64eb,5,1
* Command to list services in kubernetes,3994edc36aa49cf0429c5be9129b3c106cbe64eb,5,1
"String htmlUrl = address + user + ""/"" + named;",3994edc36aa49cf0429c5be9129b3c106cbe64eb,5,1
"protected void createKubernetesResources(String user, String buildName, String remote, String branch, GitRepoClient repoClient, String address) throws Exception {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"""      \""description\"":\""This is an end to end example of a Continuous Delivery pipeline running on OpenShift v3\""\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"""   \""apiVersion\"":\"""" + osapiVersion + ""\"",\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"""         \""apiVersion\"":\"""" + osapiVersion + ""\"",\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"""               \""name\"":\"""" + buildName + ""\"",\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"""               \""user\"":\"""" + user + ""\""\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"""            \""name\"":\"""" + buildName + ""\""\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"""                  \""name\"":\"""" + buildName + ""\""\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"""                  \""builderImage\"":\"""" + builderImage + ""\"",\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"""                  \""image\"":\"""" + builderImage + ""\""\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"""                  \""secret\"":\"""" + secret + ""\""\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"""            \""name\"":\"""" + buildName + ""-deploy\""\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"""                              \""image\"":\"""" + buildName + ""\"",\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"""                              \""name\"":\"""" + buildName + ""\"",\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"""                        \""version\"":\"""" + imageTag + ""\""\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"""                     \""name\"":\"""" + buildName + ""\"",\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"""                     \""user\"":\"""" + user + ""\""\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"""                  \""name\"":\"""" + buildName + ""\"",\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"""                  \""user\"":\"""" + user + ""\""\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"""                     \"""" + buildName + ""\""\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"""                     \""name\"":\"""" + buildName + ""\""\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"""                  \""tag\"":\"""" + imageTag + ""\""\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"kubeAddress = KubernetesHelper.getServiceURL(kubernetes,ServiceNames.CDELIVERY_API, namespace, ""http"", false);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"LOG.warn(""failed to find cdelivery service URL: "" + e, e);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"kubeAddress = kubernetes.getServiceURL(""fabric8"", namespace, ""http"", false);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"private static final String DEFAULT_MAVEN_FLOW = ""workflows/maven/CanaryReleaseStageAndApprovePromote.groovy"";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"@WithAttributes(label = ""pipeline"", required = false, description = ""The Jenkins workflow groovy script to use for defining the Continous Delivery pipeline"")",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"@WithAttributes(label = ""chatRoom"", required = false, description = ""Name of chat room to use for this project"")",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
private String namespace = KubernetesHelper.defaultNamespace();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"String envNamespace = buildName + ""-"" + environment.toLowerCase();",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"LOG.warn(""Failed to get issue project names: "" + e, e);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
* Creates a new build in OpenShift for the current project,3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"description = ""If the git URI is not specified in the pom.xml then this allows you to specify one to be used."",",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
* Creates a new integration test build in OpenShift for the current project,3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"description = ""If the git URI is not specified in the pom.xml then this allows you to specify one to be used."",",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
KubernetesClient kubernetes = getKubernetes();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"@WithAttributes(name = ""filter"", label = ""The text filter used to filter pods using label selectors"")",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"@WithAttributes(name = ""filter"", label = ""The text filter used to filter pods using label selectors"")",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"@WithAttributes(name = ""filter"", label = ""The text filter used to filter pods using label selectors"")",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
* Git tends to ignore empty directories so lets add a dummy file to empty folders to keep them in git,3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
"IOHelpers.writeFully(dummyFile, ""This file is only here to avoid git removing empty folders\nOnce there are files in this folder feel free to delete this file!"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,4,1
String namespace = KubernetesHelper.defaultNamespace();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"String json = ""\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
Controller controller = new Controller(kubernetes);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
String kubeAddress = null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"namespacePath = ""/namespace="" + namespace;",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"Map<String,String> to = new LinkedHashMap<>();",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
private static final transient Logger LOG = LoggerFactory.getLogger(AbstractDevOpsCommand.class);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"public static String CATEGORY = ""DevOps"";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
kubernetes = new DefaultKubernetesClient(new ConfigBuilder().withMasterUrl(kubernetesAddress).build());,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
kubernetes = new DefaultKubernetesClient();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
Controller controller = new Controller(getKubernetes());,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
private static final transient Logger LOG = LoggerFactory.getLogger(DevOpsEditStep.class);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"public static final String JENKINSFILE = ""Jenkinsfile"";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"private String jenkinsFilePrefix = ""workflows/"";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"@WithAttributes(label = ""copyFlowToProject"", required = false, description = ""Should we copy the Jenkins Workflow script into the project source code"")",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"@WithAttributes(label = ""issueProjectName"", required = false, description = ""Name of the issue tracker project"")",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"@WithAttributes(label = ""codeReview"", required = false, description = ""Enable code review of all commits"")",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"flowText = Strings.replaceAllWithoutRegex(flowText, ""GIT_URL"", ""'"" + gitUrl + ""'"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"LOG.info(""Written pipeline to "" + newFile);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"LOG.error(""Failed to update DevOps resources: "" + e, e);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"protected String getStringAttribute(Map<Object, Object> attributeMap, String name, String defaultValue) {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"String postfix = ""/"" + JENKINSFILE;",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"LOG.warn(""Failed to load chat projects! "" + e, e);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"LOG.warn(""Failed to load chat rooms! "" + e, e);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"LOG.warn(""Failed to find chat room names: "" + e, e);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"description = ""The build configuration name to generate."",",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"description = ""The secret that needs to be passed in by webhooks invoking the generated build."",",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"System.out.println(""Generated BuildConfig: "" + toJson(buildConfig));",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"controller.applyBuildConfig(buildConfig, ""generated BuildConfig: "" + toJson(buildConfig));",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
private static final transient Logger LOG = LoggerFactory.getLogger(NewIntegrationTestBuildCommand.class);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"description = ""The build configuration name to generate."",",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"description = ""The docker image to use to run the maven build."",",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"LOG.info(""Generated BuildConfig: "" + toJson(buildConfig));",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"controller.applyBuildConfig(buildConfig, ""generated BuildConfig: "" + toJson(buildConfig));",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"private List<EnvVar> createEnvVars(String buildConfigName, String gitUrlText, String mavenCommand) {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"public static String CATEGORY = ""Kubernetes"";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
kubernetes = new DefaultKubernetesClient(new ConfigBuilder().withMasterUrl(kubernetesAddress).build());,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
kubernetes = new DefaultKubernetesClient();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"@WithAttributes(label = ""Pod ID"", description = ""The ID of the pod."", required = true)",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
List<String> list = new ArrayList<String>();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
PodList pods = getKubernetes().pods().list();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
String id = KubernetesHelper.getName(item);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"System.out.println(""Completion list is "" + list);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
Pod podInfo = getKubernetes().pods().inNamespace(getNamespace()).withName(podIdText).get();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"System.out.println(""No pod for id: "" + podIdText);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"System.out.println(""Deleting pod "" + podId);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
".description(""Lists the pods in a kubernetes cloud"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
PodList pods = getKubernetes().pods().inNamespace(getNamespace()).list();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
String id = KubernetesHelper.getName(item);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
".name(CATEGORY + "": Replication Controller Delete"")",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
List<String> list = new ArrayList<String>();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
ReplicationControllerList replicationControllers = getKubernetes().replicationControllers().inNamespace(getNamespace()).list();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
String id = KubernetesHelper.getName(item);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
ReplicationController replicationController = getKubernetes().replicationControllers().inNamespace(getNamespace()).withName(idText).get();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"System.out.println(""No replicationController for id: "" + idText);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
".name(CATEGORY + "": Replication Controller List"")",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
".description(""Lists the replication controllers in a kubernetes cloud"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
ReplicationControllerList replicationControllers = getKubernetes().replicationControllers().inNamespace(getNamespace()).list();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
String id = KubernetesHelper.getName(item);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
List<String> list = new ArrayList<String>();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
ServiceList services = getKubernetes().services().inNamespace(getNamespace()).list();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
String id = KubernetesHelper.getName(item);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
Service service = getKubernetes().services().inNamespace(getNamespace()).withName(idText).get();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"System.out.println(""No service for id: "" + idText);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
".description(""Lists the services in a kubernetes cloud"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
ServiceList services = getKubernetes().services().list();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
private static final transient Logger LOG = LoggerFactory.getLogger(GitCommandCompletePostProcessor.class);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"public static final String PROJECT_NEW_COMMAND = ""project-new"";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"public static final String TARGET_LOCATION_PROPERTY = ""targetLocation"";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"public static final String DEFAULT_JENKINS_SEED_JOB = ""seed"";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"@ConfigProperty(name = ""JENKINS_SEED_JOB"", defaultValue = DEFAULT_JENKINS_SEED_JOB) String jenkinsSeedJob,",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"throw new NotAuthorizedException(""You must authenticate to be able to perform this command"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"fullName = user + ""/"" + named;",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"String cloneUrl =  htmlUrl + "".git"";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"String namespace = firstNotBlank(context.getProjectName(), executionRequest.getNamespace());",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"protected void createBuildConfig(RestUIContext context, String namespace, String projectName, String cloneUrl) throws Exception {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
Controller controller = new Controller(kubernetes);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,3,1
"* Lets create an ImageRegistry, BuildConfig and DeploymentConfig for the new project",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"String imageTag = ""test"";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"String secret = ""secret101"";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"String builderImage = ""fabric8/java-main"";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"String osapiVersion = ""v1"";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"String gitServiceName = ""gogs"";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
// TODO we should replace the remote with the actual service IP address???,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"String gitAddress = getServiceAddress(gitServiceName, namespace);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""   \""annotations\"":{\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""   },\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""   \""kind\"":\""List\"",\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""   \""items\"":[\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""      {\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""         \""kind\"":\""ImageStream\"",\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""         \""metadata\"":{\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""            \""labels\"":{\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""            },\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""         }\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""      },\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""         \""kind\"":\""BuildConfig\"",\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""         },\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""         \""parameters\"":{\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""            \""output\"":{\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""               \""to\"":{\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""               },\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""               \""tag\"":\""test\""\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""            \""source\"":{\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""               \""git\"":{\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""               \""type\"":\""Git\""\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""            \""strategy\"":{\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""               \""stiStrategy\"":{\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""               \""type\"":\""STI\""\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""            }\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""         \""triggers\"":[\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""            {\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""               \""github\"":{\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""               \""type\"":\""github\""\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""               \""generic\"":{\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""               \""type\"":\""generic\""\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""         ]\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""         \""kind\"":\""DeploymentConfig\"",\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""         \""template\"":{\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""            \""controllerTemplate\"":{\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""               \""podTemplate\"":{\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""                  \""desiredState\"":{\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""                     \""manifest\"":{\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""                        \""containers\"":[\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""                           {\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""                              \""ports\"":[\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""                                 {\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""                                    \""containerPort\"":8778\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""                                 }\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""                              ]\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""                           }\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""                        ],\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""                     }\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""                  },\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""                  \""labels\"":{\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""                  }\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""               \""replicaSelector\"":{\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""               \""replicas\"":1\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""               \""type\"":\""Recreate\""\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""               \""type\"":\""ImageChange\"",\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""               \""imageChangeParams\"":{\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""                  \""automatic\"":true,\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""                  \""containerNames\"":[\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""                  ],\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""                  \""from\"":{\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""               }\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""      }"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"""   ]\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"String type = ""generic"";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
// TODO due to https://github.com/openshift/origin/issues/1317 we can't use the direct kube REST API,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
// so we need to use a workaround using the fabric8 console service's proxy which hides the payload for us,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String webhookUrl = null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
kubeAddress = kubernetes.getMasterUrl().toString();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"String namespacePath = """";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"webhookUrl = URLUtils.pathJoin(kubeAddress, ""oapi"", KubernetesHelper.defaultOsApiVersion + namespacePath, ""buildConfigHooks"", buildName, secret, type);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"LOG.info(""creating a web hook at: "" + webhookUrl);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
CreateWebhookDTO createWebhook = new CreateWebhookDTO();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"LOG.debug(""Got web hook: "" + toJson(webhook));",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"/*        Map<String,String> labels = new LinkedHashMap<>();",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
ImageStream imageRepository = new ImageStream();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
BuildConfig buildConfig = new BuildConfig();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
BuildOutput output = new BuildOutput();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
BuildSource source = new BuildSource();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
GitBuildSource git = new GitBuildSource();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
BuildStrategy strategy = new BuildStrategy();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
STIBuildStrategy stiStrategy = new STIBuildStrategy();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
BuildParameters parameters = new BuildParameters();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
BuildTriggerPolicy github = new BuildTriggerPolicy();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
WebHookTrigger githubTrigger = new WebHookTrigger();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
BuildTriggerPolicy generic = new BuildTriggerPolicy();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
WebHookTrigger genericTrigger = new WebHookTrigger();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
List<BuildTriggerPolicy> triggers = new ArrayList<>();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
List<String> answer = new ArrayList<>();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,0
String lowerInputValue = inputValue.toLowerCase();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,0
String projectName = config.getBuildName();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,0
"LOG.info(""Project name is: "" + projectName);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,0
List<String> answer = new ArrayList<>();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String lowerInputValue = inputValue.toLowerCase();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
*  with the License.  You may obtain a copy of the License at,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"*  Unless required by applicable law or agreed to in writing, software",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
private KubernetesClient kubernetes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String kubernetesAddress = kubernetesUrl.getValue();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"return new File(folder, ProjectConfigs.FILE_NAME);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"protected String getOrFindGitUrl(UIExecutionContext context, String gitUrlText) {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String configText = config.getContents();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"LOG.debug(""Ignoring missing git folders: "" + e, e);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String connection = scm.getConnection();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
*  with the License.  You may obtain a copy of the License at,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"*  Unless required by applicable law or agreed to in writing, software",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
import io.fabric8.kubernetes.api.KubernetesHelper;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
import static io.fabric8.kubernetes.api.KubernetesHelper.loadYaml;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String value = event.getNewValue() != null ? event.getNewValue().toString() : null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String description = getDescriptionForFlow(value);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String description = getDescriptionForChatRoom(value);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String description = getDescriptionForIssueProject(value);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"public static Iterable<String> filterCompletions(Iterable<String> values, String inputValue) {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
List<String> answer = new ArrayList<>();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String lowerInputValue = inputValue.toLowerCase();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String fileName = ProjectConfigs.FILE_NAME;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
config = new ProjectConfig();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"LOG.info(""Result: "" + config);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"String operation = ""Updated"";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"String gitUrl = getStringAttribute(attributeMap, ""gitUrl"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"String user = getStringAttribute(attributeMap, ""gitUser"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"String named = getStringAttribute(attributeMap, ""projectName"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"String address = getStringAttribute(attributeMap, ""gitAddress"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"LOG.error(""No MetadataFacet for newly created project "" + newProject);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String buildName = config.getBuildName();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
environments = new ArrayList<>();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"LinkedHashMap<String, String> environmentMap = new LinkedHashMap<>();",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String projectName = config.getBuildName();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"LOG.info(""Project name is: "" + projectName);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String flow = null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"String flowText = getFlowContent(flow, uiContext);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"File newFile = new File(basedir, ProjectConfigs.LOCAL_FLOW_FILE_NAME);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
final DevOpsConnector connector = new DevOpsConnector();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"LOG.info(""Using connector: "" + connector);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"String answer = getStringAttribute(attributeMap, name);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"protected String getStringAttribute(Map<Object, Object> attributeMap, String name) {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"File file = new File(dir, flow);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
Filter<File> filter = new Filter<File>() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"Map<String,PipelineDTO> nameMap = new TreeMap<>();",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"String relativePath = Files.getRelativePath(dir, file);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"String value = Strings.stripPrefix(relativePath, ""/"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String label = value;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String builder = null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String descriptionMarkdown = null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"File markdownFile = new File(file.getParentFile(), ""ReadMe.md"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"PipelineDTO pipeline = new PipelineDTO(value, label, builder, descriptionMarkdown);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"File yamlFile = new File(file.getParentFile(), ""metadata.yml"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
return new ArrayList<>(nameMap.values());,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
return new ArrayList<>();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
Set<String> answer = new TreeSet<>();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String name = project.getName();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String name = room.getSlug();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"taiga = TaigaKubernetes.createTaiga(getKubernetes(),namespace);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
*  with the License.  You may obtain a copy of the License at,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"*  Unless required by applicable law or agreed to in writing, software",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
import static io.fabric8.utils.cxf.JsonHelper.toJson;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"@WithAttributes(name = ""buildName"", label = ""Build name"",",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"@WithAttributes(name = ""imageName"", label = ""Output Image Name"",",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"description = ""The output image name to push the docker image to."",",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"@WithAttributes(name = ""gitUri"", label = ""Git Uri"",",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"@WithAttributes(name = ""outputImage"", label = ""Output image"",",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"description = ""The docker image name to generate."",",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"@WithAttributes(name = ""webHookSecret"", label = ""Webhook secret"",",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
".description(""Create a new build configuration"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String buildConfigName = buildName.getValue();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String ouputImageName = imageName.getValue();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"String gitUrlText = getOrFindGitUrl(context, gitUri.getValue());",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String imageText = outputImage.getValue();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String webhookSecretText = webHookSecret.getValue();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
Controller controller = createController();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"controller.applyImageStream(imageRepository, ""generated ImageStream: "" + toJson(imageRepository));",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
*  with the License.  You may obtain a copy of the License at,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"*  Unless required by applicable law or agreed to in writing, software",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
import static io.fabric8.utils.cxf.JsonHelper.toJson;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"@WithAttributes(name = ""buildName"", label = ""Build name"",",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"@WithAttributes(name = ""mavenCommand"", label = ""Maven command"",",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"description = ""The docker image name to generate."",",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"@WithAttributes(name = ""image"", label = ""Docker image"",",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"@WithAttributes(name = ""gitUri"", label = ""Git Uri"",",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
".description(""Create a new integration test build configuration"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"return mavenModel.getArtifactId() + ""-int-test"";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String buildConfigName = buildName.getValue();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"String gitUrlText = getOrFindGitUrl(context, gitUri.getValue());",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String imageText = image.getValue();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
Controller controller = createController();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"controller.applyImageStream(imageRepository, ""generated ImageStream: "" + toJson(imageRepository));",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
ListEnvVarBuilder builder = new ListEnvVarBuilder();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
*  with the License.  You may obtain a copy of the License at,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"*  Unless required by applicable law or agreed to in writing, software",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
import io.fabric8.kubernetes.api.KubernetesHelper;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
private KubernetesClient kubernetes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String kubernetesAddress = kubernetesUrl.getValue();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
return namespace;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
AbstractKubernetesCommand.namespace = namespace;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
*  with the License.  You may obtain a copy of the License at,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"*  Unless required by applicable law or agreed to in writing, software",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
import io.fabric8.kubernetes.api.KubernetesHelper;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
* Base class for working with a pod,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String podIdText = podId.getValue();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
*  with the License.  You may obtain a copy of the License at,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"*  Unless required by applicable law or agreed to in writing, software",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
".name(CATEGORY + "": Pod Delete"")",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
".description(""Deletes the given pod from the kubernetes cloud"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
*  with the License.  You may obtain a copy of the License at,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"*  Unless required by applicable law or agreed to in writing, software",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
import io.fabric8.kubernetes.api.KubernetesHelper;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
".name(CATEGORY + "": Pod List"")",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
TablePrinter table = new TablePrinter();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"String status = """";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"String host = """";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String labels = KubernetesHelper.toLabelsString(labelMap);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String image = container.getImage();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"id = """";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
*  with the License.  You may obtain a copy of the License at,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"*  Unless required by applicable law or agreed to in writing, software",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
import io.fabric8.kubernetes.api.KubernetesHelper;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
* Deletes a replication controller from kubernetes,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
".description(""Deletes the given replication controller from the kubernetes cloud"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String idText = replicationControllerId.getValue();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
*  with the License.  You may obtain a copy of the License at,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"*  Unless required by applicable law or agreed to in writing, software",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
import io.fabric8.kubernetes.api.KubernetesHelper;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
import static io.fabric8.kubernetes.api.KubernetesHelper.toPositiveNonZeroText;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
TablePrinter table = new TablePrinter();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String labels = KubernetesHelper.toLabelsString(item.getMetadata().getLabels());,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String selector = null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
*  with the License.  You may obtain a copy of the License at,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"*  Unless required by applicable law or agreed to in writing, software",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
import io.fabric8.kubernetes.api.KubernetesHelper;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
import static io.fabric8.kubernetes.api.KubernetesHelper.getName;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
* Deletes a service from kubernetes,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
".name(CATEGORY + "": Service Delete"")",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
".description(""Deletes the given service from the kubernetes cloud"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String idText = serviceId.getValue();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
*  with the License.  You may obtain a copy of the License at,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"*  Unless required by applicable law or agreed to in writing, software",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
import io.fabric8.kubernetes.api.KubernetesHelper;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
import static io.fabric8.kubernetes.api.KubernetesHelper.getPorts;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
import static io.fabric8.kubernetes.api.KubernetesHelper.getSelector;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
".name(CATEGORY + "": Service List"")",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
TablePrinter table = new TablePrinter();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String labels = KubernetesHelper.toLabelsString(service.getMetadata().getLabels());,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String selector = KubernetesHelper.toLabelsString(getSelector(service));,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
List<Integer> portList = new ArrayList<>(ports);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
*  with the License.  You may obtain a copy of the License at,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"*  Unless required by applicable law or agreed to in writing, software",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
import io.fabric8.kubernetes.api.KubernetesHelper;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
import static io.fabric8.utils.cxf.JsonHelper.toJson;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
private final KubernetesClient kubernetes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
private final String jenkinsSeedJob;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"@ConfigProperty(name = ""OPENSHIFT_CREATE_BUILD_ON_PROJECT_CREATE"", defaultValue = ""false"") boolean createOpenShiftBuildResources) {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String user = userDetails.getUser();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String address = userDetails.getAddress();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String internalAddress = userDetails.getInternalAddress();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String branch = userDetails.getBranch();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String origin = projectFileSystem.getRemote();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String targetLocation = null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String named = null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"File basedir = new File(targetLocation, named);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"LOG.warn(""Generated project folder does not exist: "" + basedir.getAbsolutePath());",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
CreateRepositoryDTO createRepository = new CreateRepositoryDTO();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String fullName = null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"LOG.debug(""Got repository: "" + toJson(repository));",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"String message = ExecutionRequest.createCommitMessage(name, executionRequest);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"String projectName = firstNotBlank(named, context.getProjectName(), executionRequest.getProjectName());",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
public static String firstNotBlank(String... texts) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
String jenkinsUrl = getJenkinsServiceUrl(namespace);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"controller.applyBuildConfig(buildConfig, ""from project "" + projectName);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"return KubernetesHelper.getServiceURL(kubernetes, ServiceNames.JENKINS, namespace, ""http"", true);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"File dummyFile = new File(dir, "".gitkeep"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
"LOG.warn(""Caught: "" + e, e);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,2,1
import io.fabric8.kubernetes.api.Controller;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.repo.git.CreateWebhookDTO;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.repo.git.WebHookDTO;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.repo.git.WebhookConfig;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
gitAddress = address;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"""{\n"" +",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
boolean appendNamespaceQuery = true;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"webhookUrl = URLUtils.pathJoin(kubeAddress, ""buildConfigHooks"", namespace, buildName);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
appendNamespaceQuery = false;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"webhookUrl = URLUtils.pathJoin(kubeAddress, ""oapi"", KubernetesHelper.defaultOsApiVersion, ""buildConfigHooks"", buildName, secret, type);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
WebhookConfig config = createWebhook.getConfig();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"WebHookDTO webhook = repoClient.createWebhook(user, buildName, createWebhook);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.forge.addon.utils.MavenHelpers;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,0
import org.apache.maven.model.Model;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,0
import org.jboss.forge.addon.maven.projects.MavenFacet;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,0
import java.util.Properties;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,0
boolean ignoreFilteringAsItBreaksHawtio = true;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,0
return values;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,0
return answer;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,0
projectName = named;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,0
MavenFacet maven = project.getFacet(MavenFacet.class);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,0
Model pom = maven.getModel();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,0
Properties properties = pom.getProperties();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,0
boolean updated = false;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,0
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.label.project"", projectName, updated);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,0
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.label.version"", ""${project.version}"", updated);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,0
import io.fabric8.kubernetes.client.DefaultKubernetesClient;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.client.KubernetesClient;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return answer;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  Red Hat licenses this file to you under the Apache License, version",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.devops.ProjectConfig;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.devops.ProjectConfigs;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.forge.devops.dto.PipelineDTO;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.Controller;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.client.ConfigBuilder;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.client.DefaultKubernetesClient;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.client.KubernetesClient;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.Files;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.GitHelpers;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.Objects;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.Strings;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.TablePrinter;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.apache.maven.model.Model;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.apache.maven.model.Scm;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.maven.projects.MavenFacet;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.projects.Project;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.projects.ProjectFactory;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.projects.Projects;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.projects.ui.AbstractProjectCommand;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.resource.Resource;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.resource.util.ResourceUtil;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.UIProvider;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.command.UICommand;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIContext;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIContextProvider;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UISelection;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.input.UIInput;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.output.UIOutput;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.result.Result;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.result.Results;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.slf4j.Logger;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.slf4j.LoggerFactory;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import javax.inject.Inject;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.io.File;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.io.PrintStream;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.Map;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
private ProjectFactory projectFactory;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return false;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return projectFactory;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
public KubernetesClient getKubernetes() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return kubernetes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
public Controller createController() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return controller;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
this.kubernetes = kubernetes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return getUiProvider().isGUI();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
UIProvider provider = getUiProvider();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return provider != null ? provider.getOutput() : null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return uiProvider;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
this.uiProvider = uiProvider;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Project project = null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"Map<Object, Object> attributeMap = context.getAttributeMap();",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Object object = attributeMap.get(Project.class);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
project = (Project) object;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return project;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
UISelection<Object> selection = context.getSelection();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Object selectedObject = selection.get();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"project = Projects.getSelectedProject(getProjectFactory(), context);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"public static File getProjectConfigFile(UIContext context, Project project) {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Resource<?> root = project.getRoot();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Resource<?> configFileResource = root.getChild(ProjectConfigs.FILE_NAME);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return ResourceUtil.getContextFile(configFileResource);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Object object = selection.get();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
File folder = ResourceUtil.getContextFile((Resource<?>) object);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return Results.success();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
* Prints the given table and returns success,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
UIOutput output = getOutput();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return output.out();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return System.out;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
final Project project = getSelectedProject(builder);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
MavenFacet maven = project.getFacet(MavenFacet.class);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return maven;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
MavenFacet mavenFacet = getMavenFacet(builder);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return mavenFacet.getModel();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
final Project project = getSelectedProject(context);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"Resource<?> gitFolder = root.getChild("".git"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"Resource<?> config = gitFolder.getChild(""config"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
gitUrlText = GitHelpers.extractGitUrl(configText);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Model mavenModel = getMavenModel(context);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Scm scm = mavenModel.getScm();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
gitUrlText = connection;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"throw new IllegalArgumentException(""Could not find git URL"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return gitUrlText;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"Map<Object, Object> attributeMap = context.getUIContext().getAttributeMap();",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"Object pipelineValue = attributeMap.get(""pipeline"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
PipelineDTO pipeline = (PipelineDTO) pipelineValue;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  Red Hat licenses this file to you under the Apache License, version",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.devops.ProjectConfig;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.devops.ProjectConfigs;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.devops.connector.DevOpsConnector;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.forge.addon.utils.CommandHelpers;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.forge.addon.utils.MavenHelpers;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.forge.devops.dto.PipelineDTO;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.forge.devops.dto.PipelineMetadata;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.letschat.LetsChatClient;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.letschat.LetsChatKubernetes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.letschat.RoomDTO;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.taiga.ProjectDTO;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.taiga.TaigaClient;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.taiga.TaigaKubernetes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.Files;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.Filter;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.GitHelpers;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.IOHelpers;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.Objects;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.Strings;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.apache.maven.model.Model;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.convert.Converter;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.maven.projects.MavenFacet;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.projects.Project;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.projects.facets.MetadataFacet;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIContext;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UINavigationContext;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.input.UICompleter;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.input.UIInput;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.result.NavigationResult;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.result.Result;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.result.Results;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.util.Categories;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.util.Metadata;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.wizard.UIWizardStep;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.slf4j.Logger;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.slf4j.LoggerFactory;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import javax.inject.Inject;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.io.File;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.io.IOException;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.ArrayList;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.LinkedHashMap;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.List;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.Map;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.Properties;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.Set;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.TreeMap;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.TreeSet;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
private UIInput<PipelineDTO> pipeline;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
private UIInput<Boolean> copyFlowToProject;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
private UIInput<String> chatRoom;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
private UIInput<String> issueProjectName;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
private UIInput<Boolean> codeReview;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
private LetsChatClient letsChat;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
private TaigaClient taiga;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
private List<InputComponent> inputComponents;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return Metadata.forCommand(getClass()),3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
".name(AbstractDevOpsCommand.CATEGORY + "": Configure"")",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
".description(""Configure the DevOps options for the new project"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
final UIContext context = builder.getUIContext();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"public Iterable<PipelineDTO> getCompletionProposals(UIContext context, InputComponent<?, PipelineDTO> input, String value) {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return getPipelines(context);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"return getPipelineForValue(context, text);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
boolean canCopy = Strings.isNotBlank(value);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"PipelineDTO defaultValue = getPipelineForValue(context, DEFAULT_MAVEN_FLOW);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"public Iterable<String> getCompletionProposals(UIContext context, InputComponent<?, String> input, String value) {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"return filterCompletions(getChatRoomNames(), value);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"return filterCompletions(getIssueProjectNames(), value);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
ProjectConfig config = null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Project project = getCurrentSelectedProject(context);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"File configFile = getProjectConfigFile(context, getSelectedProject(context));",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
config = ProjectConfigs.parseProjectConfig(configFile);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"PipelineDTO flow = getPipelineForValue(context, config.getPipeline());",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"inputComponents = CommandHelpers.addInputComponents(builder, pipeline, copyFlowToProject, chatRoom, issueProjectName, codeReview);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
boolean ignoreFilteringAsItBreaksHawtio = true;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return values;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return answer;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Project project = getSelectedProject(context);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"File configFile = getProjectConfigFile(context.getUIContext(), getSelectedProject(context));",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
// lets not fail as we typically want to execute SaveDevOpsStep next...,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return Results.success();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
boolean hasFile = false;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
hasFile = true;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
String message;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return Results.success(message);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"operation = ""Created"";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
UIContext uiContext = context.getUIContext();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"Map<Object, Object> attributeMap = uiContext.getAttributeMap();",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"gitUrl = getStringAttribute(attributeMap, ""gitAddress"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Object object = attributeMap.get(Project.class);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
File basedir = CommandHelpers.getBaseDir(project);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
basedir = configFile.getParentFile();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Project newProject = (Project) object;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
MetadataFacet facet = newProject.getFacet(MetadataFacet.class);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
named = facet.getProjectName();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
gitUrl = GitHelpers.extractGitUrl(basedir);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
named = basedir.getName();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
// lets default the environments from the pipeline,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
PipelineDTO pipelineValue = pipeline.getValue();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
List<String> environments = pipelineValue.getEnvironments();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
projectName = named;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
MavenFacet maven = project.getFacet(MavenFacet.class);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Model pom = maven.getModel();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Properties properties = pom.getProperties();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
boolean updated = false;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.label.project"", projectName, updated);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.label.version"", ""${project.version}"", updated);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Boolean copyFlowToProjectValue = copyFlowToProject.getValue();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"LOG.warn(""Cannot copy the pipeline to the project as no basedir!"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
PipelineDTO pipelineDTO = pipelineValue;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
flow = pipelineDTO.getValue();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"LOG.warn(""Cannot copy the pipeline to the project as no pipeline selected!"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"LOG.warn(""Cannot copy the pipeline to the project as no pipeline text could be loaded!"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
// lets not trigger the jenkins webhook yet as the git push should trigger the build,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"attributeMap.put(""registerWebHooks"", new Runnable() {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return Strings.isNullOrBlank(answer) ? defaultValue : answer;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Object value = attributeMap.get(name);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return value.toString();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
protected String getDescriptionForFlow(String flow) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"protected String getFlowContent(String flow, UIContext context) {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
File dir = getJenkinsWorkflowFolder(context);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return IOHelpers.readFully(file);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"protected PipelineDTO getPipelineForValue(UIContext context, String value) {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Iterable<PipelineDTO> pipelines = getPipelines(context);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return pipelineDTO;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"return file.isFile() && Objects.equal(JENKINSFILE, file.getName());",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"Set<File> files =  Files.findRecursive(dir, filter);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"label = label.substring(0, label.length() - postfix.length());",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
label = label.substring(jenkinsFilePrefix.length());,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
// Lets ignore the fabric8 specific pipelines,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"int idx = label.indexOf(""/"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"builder = label.substring(0, idx);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
descriptionMarkdown = IOHelpers.readFully(markdownFile);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
PipelineMetadata metadata = null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"metadata = loadYaml(yamlFile, PipelineMetadata.class);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
File dir = null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"Object workflowFolder = context.getAttributeMap().get(""jenkinsWorkflowFolder"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
dir = (File) workflowFolder;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return dir;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
protected String getDescriptionForIssueProject(String value) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
TaigaClient letschat = getTaiga();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
List<ProjectDTO> projects = null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
projects = letschat.getProjects();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
protected String getDescriptionForChatRoom(String chatRoom) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
LetsChatClient letschat = getLetsChat();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
List<RoomDTO> rooms = null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
rooms = letschat.getRooms();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
letsChat = LetsChatKubernetes.createLetsChat(getKubernetes());,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return letsChat;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
this.letsChat = letsChat;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return taiga;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
this.taiga = taiga;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  Red Hat licenses this file to you under the Apache License, version",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.Controller;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.builds.Builds;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.openshift.api.model.BuildConfig;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.openshift.api.model.ImageStream;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.Objects;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.Strings;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.apache.maven.model.Model;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIContext;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.input.UIInput;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.result.Result;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.result.Results;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.util.Categories;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.util.Metadata;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import javax.inject.Inject;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.Map;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.concurrent.Callable;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
required = false),3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"return Metadata.from(super.getMetadata(context), getClass())",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
".name(CATEGORY + "": New Build"")",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
public String call() throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Model mavenModel = getMavenModel(builder);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return mavenModel.getArtifactId();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"Map<String, String> labels = BuildConfigs.createBuildLabels(buildConfigName);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Model mavenModel = getMavenModel(context);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"imageText = mavenModel.getProperties().getProperty(""docker.image"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"webhookSecretText = ""secret101"";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"BuildConfig buildConfig = BuildConfigs.createBuildConfig(buildConfigName, labels, gitUrlText, ouputImageName, imageText, webhookSecretText);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"ImageStream imageRepository = BuildConfigs.imageRepository(buildConfigName, labels);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  Red Hat licenses this file to you under the Apache License, version",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.Controller;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.builders.ListEnvVarBuilder;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.builds.Builds;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.model.EnvVar;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.openshift.api.model.BuildConfig;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.openshift.api.model.ImageStream;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.Objects;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.apache.maven.model.Model;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIContext;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.input.UIInput;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.result.Result;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.result.Results;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.util.Categories;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.util.Metadata;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.slf4j.Logger;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.slf4j.LoggerFactory;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import javax.inject.Inject;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.List;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.Map;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.concurrent.Callable;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
required = false),3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"required = true,",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"defaultValue = ""mvn failsafe:integration-test -Pkit"")",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"defaultValue = ""fabric8/maven"")",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"return Metadata.from(super.getMetadata(context), getClass())",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
".name(CATEGORY + "": New Integration Test Build"")",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
public String call() throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Model mavenModel = getMavenModel(builder);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"Map<String, String> labels = BuildConfigs.createBuildLabels(buildConfigName);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"List<EnvVar> envVars = createEnvVars(buildConfigName, gitUrlText, mavenCommand.getValue());",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"BuildConfig buildConfig = BuildConfigs.createIntegrationTestBuildConfig(buildConfigName, labels, gitUrlText, imageText, envVars);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"ImageStream imageRepository = BuildConfigs.imageRepository(buildConfigName, labels);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return builder.build();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  Red Hat licenses this file to you under the Apache License, version",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.client.DefaultKubernetesClient;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.client.KubernetesClient;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.client.ConfigBuilder;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.Objects;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.Strings;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.TablePrinter;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.projects.ProjectFactory;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.projects.ui.AbstractProjectCommand;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.UIProvider;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.command.UICommand;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.input.UIInput;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.output.UIOutput;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.result.Result;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.result.Results;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import javax.inject.Inject;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.io.PrintStream;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
* An abstract base class for kubernetes related commands,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
private ProjectFactory projectFactory;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return false;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return projectFactory;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
public KubernetesClient getKubernetes() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return kubernetes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
this.kubernetes = kubernetes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return getUiProvider().isGUI();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
UIProvider provider = getUiProvider();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return provider != null ? provider.getOutput() : null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return uiProvider;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
this.uiProvider = uiProvider;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
* Prints the given table and returns success,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return Results.success();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
UIOutput output = getOutput();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return output.out();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return System.out;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
public String getNamespace() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  Red Hat licenses this file to you under the Apache License, version",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.model.Pod;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.model.PodList;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.client.KubernetesClient;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIContext;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.input.UICompleter;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.input.UIInput;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.result.Result;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import javax.inject.Inject;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.ArrayList;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.Collections;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.List;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"public Iterable<String> getCompletionProposals(UIContext context, InputComponent<?, String> input, String value) {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
List<Pod> items = pods.getItems();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return list;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"protected abstract void executePod(Pod pod, String podId) throws Exception;",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  Red Hat licenses this file to you under the Apache License, version",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.model.Pod;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIContext;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.util.Categories;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.util.Metadata;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"return Metadata.from(super.getMetadata(context), getClass())",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"protected void executePod(Pod pod, String podId) throws Exception {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  Red Hat licenses this file to you under the Apache License, version",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.model.Container;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.model.Pod;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.model.PodList;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.model.PodSpec;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.model.PodStatus;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.Filter;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.TablePrinter;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIContext;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.input.UIInput;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.result.Result;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.util.Categories;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.util.Metadata;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import javax.inject.Inject;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.Collections;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.List;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.Map;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"return Metadata.from(super.getMetadata(context), getClass())",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
TablePrinter table = podsAsTable(pods);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return tableResults(table);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
List<Pod> items = pods.getItems();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
items = Collections.EMPTY_LIST;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Filter<Pod> filter = KubernetesHelper.createPodFilter(filterText.getValue());,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
PodStatus podStatus = item.getStatus();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
status = KubernetesHelper.getStatusText(podStatus);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
host = podStatus.getHostIP();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"Map<String, String> labelMap = item.getMetadata().getLabels();",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
PodSpec spec = item.getSpec();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
List<Container> containerList = spec.getContainers();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"host = """";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"status = """";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"labels = """";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return table;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  Red Hat licenses this file to you under the Apache License, version",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.model.ReplicationController;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.model.ReplicationControllerList;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIContext;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.input.UICompleter;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.input.UIInput;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.result.Result;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.util.Categories;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.util.Metadata;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import javax.inject.Inject;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.ArrayList;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.Collections;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.List;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"return Metadata.from(super.getMetadata(context), getClass())",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"public Iterable<String> getCompletionProposals(UIContext context, InputComponent<?, String> input, String value) {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
List<ReplicationController> items = replicationControllers.getItems();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return list;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  Red Hat licenses this file to you under the Apache License, version",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.model.ReplicationController;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.model.ReplicationControllerList;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.model.ReplicationControllerSpec;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.model.ReplicationControllerStatus;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.Filter;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.TablePrinter;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIContext;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.input.UIInput;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.result.Result;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.util.Categories;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.util.Metadata;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import javax.inject.Inject;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.io.PrintStream;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.Collections;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.List;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"return Metadata.from(super.getMetadata(context), getClass())",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"private void printReplicationControllers(ReplicationControllerList replicationControllers, PrintStream out) {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
List<ReplicationController> items = replicationControllers.getItems();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
items = Collections.EMPTY_LIST;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Filter<ReplicationController> filter = KubernetesHelper.createReplicationControllerFilter(filterText.getValue());,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Integer replicas = null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
ReplicationControllerSpec desiredState = item.getSpec();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
ReplicationControllerStatus currentState = item.getStatus();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
selector = KubernetesHelper.toLabelsString(desiredState.getSelector());,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
replicas = currentState.getReplicas();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  Red Hat licenses this file to you under the Apache License, version",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.model.Service;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.model.ServiceList;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIContext;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.input.UICompleter;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.input.UIInput;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.result.Result;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.util.Categories;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.util.Metadata;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import javax.inject.Inject;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.ArrayList;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.Collections;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.List;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"return Metadata.from(super.getMetadata(context), getClass())",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"public Iterable<String> getCompletionProposals(UIContext context, InputComponent<?, String> input, String value) {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
List<Service> items = services.getItems();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return list;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  Red Hat licenses this file to you under the Apache License, version",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.model.Service;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.model.ServiceList;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.Filter;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.Strings;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.TablePrinter;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIContext;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.input.UIInput;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.result.Result;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.util.Categories;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.util.Metadata;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import javax.inject.Inject;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.io.PrintStream;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.ArrayList;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.Collections;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.List;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.Set;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"return Metadata.from(super.getMetadata(context), getClass())",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"private void printServices(ServiceList services, PrintStream out) {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
List<Service> items = services.getItems();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
items = Collections.EMPTY_LIST;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Filter<Service> filter = KubernetesHelper.createServiceFilter(filterText.getValue());,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
for (Service service : items) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Set<Integer> ports = getPorts(service);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
String portText;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
portText = portList.get(0).toString();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"portText = Strings.join(portList, "", "");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  Red Hat licenses this file to you under the Apache License, version",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.forge.rest.dto.ExecutionRequest;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.forge.rest.dto.ExecutionResult;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.forge.rest.hooks.CommandCompletePostProcessor;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.forge.rest.ui.RestUIContext;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.Controller;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.ServiceNames;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.api.builds.Builds;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.kubernetes.client.KubernetesClient;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.openshift.api.model.BuildConfig;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.repo.git.CreateRepositoryDTO;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.repo.git.GitRepoClient;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.repo.git.RepositoryDTO;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import io.fabric8.utils.IOHelpers;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.apache.deltaspike.core.api.config.ConfigProperty;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.eclipse.jgit.api.Git;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.eclipse.jgit.api.InitCommand;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.eclipse.jgit.lib.PersonIdent;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.addon.ui.controller.CommandController;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.jboss.forge.furnace.util.Strings;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.slf4j.Logger;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import org.slf4j.LoggerFactory;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import javax.inject.Inject;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import javax.servlet.http.HttpServletRequest;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import javax.ws.rs.NotAuthorizedException;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.io.File;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.io.IOException;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.List;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.Map;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
import java.util.Objects;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"* For new projects; lets git add, git commit, git push otherwise lets git add/commit/push any new/udpated changes",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
private final GitUserHelper gitUserHelper;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
private final ProjectFileSystem projectFileSystem;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
private final boolean createOpenShiftBuildResources;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
this.kubernetes = kubernetes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
this.gitUserHelper = gitUserHelper;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
this.projectFileSystem = projectFileSystem;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
this.jenkinsSeedJob = jenkinsSeedJob;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
this.createOpenShiftBuildResources = createOpenShiftBuildResources;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
UserDetails userDetails = gitUserHelper.createUserDetails(request);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
// TODO this isn't really required if there's a secret associated with the BuildConfig source,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"List<Map<String, String>> inputList = executionRequest.getInputList();",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"Map<String, String> page1 = inputList.get(0);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return userDetails;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
PersonIdent personIdent = userDetails.createPersonIdent();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"targetLocation = map.get(""targetLocation"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"named = map.get(""named"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
InitCommand initCommand = Git.init();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Git git = initCommand.call();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"LOG.info(""Initialised an empty git configuration repo at {}"", basedir.getAbsolutePath());",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
// lets create the repository,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
GitRepoClient repoClient = userDetails.createRepoClient();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
RepositoryDTO repository = repoClient.createRepository(createRepository);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
fullName = repository.getFullName();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
// now lets import the code and publish,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return text;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return null;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"BuildConfig buildConfig = Builds.createDefaultBuildConfig(projectName, cloneUrl, jenkinsUrl);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
protected String getJenkinsServiceUrl(String namespace) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
File[] children = dir.listFiles();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"Map<Object, Object> attributeMap = context.getAttributeMap();",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"Object registerWebHooksValue = attributeMap.get(""registerWebHooks"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
Runnable runnable = (Runnable) registerWebHooksValue;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
return true;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
throw new RuntimeException(e);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,1,1
"LOG.info(""Creating any pending webhooks"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,0
"LOG.info(""Done creating webhooks!"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,0
"createKubernetesResources(user, named, remoteUrl, branch, repoClient, address);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
/**,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*/,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (gitAddress == null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
},3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"""}"";",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (createOpenShiftBuildResources) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
controller.applyJson(json);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
// lets try the cdelivery first,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (kubeAddress == null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
try {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
} catch (Exception e) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
/*,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (appendNamespaceQuery && !Strings.isNullOrEmpty(namespace)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (webhookUrl == null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"createWebhook.setType(""gogs"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
config.setUrl(webhookUrl);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
config.setSecret(secret);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (LOG.isDebugEnabled()) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"labels.put(""name"", buildName);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"labels.put(""user"", user);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"to.put(""name"", buildName);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"imageRepository.setKind(""ImageStream"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
imageRepository.setApiVersion(osapiVersion);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
imageRepository.setName(buildName);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
imageRepository.setLabels(labels);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"handleKubernetesResourceCreation(imageRepository.getKind(), imageRepository, kubernetes.createImageStream(imageRepository));",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"buildConfig.setKind(""BuildConfig"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
buildConfig.setApiVersion(osapiVersion);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
buildConfig.setName(buildName);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
buildConfig.setLabels(labels);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
// TODO should be to: { labels },3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
//output.setRegistry(buildName);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"output.getAdditionalProperties().put(""to"", to);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
output.setImageTag(imageTag);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"source.setType(""Git"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
git.setUri(remote);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
source.setGit(git);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"strategy.setType(""STI"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
stiStrategy.setImage(builderImage);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
// TODO,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
//stiStrategy.setBuilderImage(builderImage);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"stiStrategy.getAdditionalProperties().put(""builderImage"", builderImage);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
strategy.setStiStrategy(stiStrategy);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
parameters.setOutput(output);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
parameters.setSource(source);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
parameters.setStrategy(strategy);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
buildConfig.setParameters(parameters);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"github.setType(""github"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
githubTrigger.setSecret(secret);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
github.setGithub(githubTrigger);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"generic.setType(""generic"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
genericTrigger.setSecret(secret);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
generic.setGeneric(genericTrigger);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
triggers.add(github);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
triggers.add(generic);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
buildConfig.setTriggers(triggers);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"handleKubernetesResourceCreation(buildConfig.getKind(), buildConfig, kubernetes.createBuildConfig(buildConfig));*/",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (ignoreFilteringAsItBreaksHawtio) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,0
} else {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,0
for (String value : values) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,0
if (value != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,0
if (value.toLowerCase().indexOf(lowerInputValue) >= 0) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,0
answer.add(value);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,0
},3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,0
if (Strings.isNullOrBlank(projectName)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,0
if (Strings.isNotBlank(projectName)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,0
if (pom != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,0
if (updated) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,0
"LOG.info(""Updating pom.xml properties!"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,0
maven.setModel(pom);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,0
"LOG.warn(""Did not update pom.xml properties!"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,0
"LOG.warn(""No pom.xml found!"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,0
for (String value : values) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (value != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (value.toLowerCase().indexOf(lowerInputValue) >= 0) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
answer.add(value);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
/**,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  implied.  See the License for the specific language governing,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  permissions and limitations under the License.,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*/,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
package io.fabric8.forge.devops;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
* An abstract base class for DevOps related commands,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public abstract class AbstractDevOpsCommand extends AbstractProjectCommand implements UICommand {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Inject,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
/*,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
UIProvider uiProvider;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
UIInput<String> kubernetesUrl;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Override,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
protected boolean isProjectRequired() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
},3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
protected ProjectFactory getProjectFactory() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (kubernetes == null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (Strings.isNotBlank(kubernetesAddress)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
} else {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"Objects.notNull(kubernetes, ""kubernetes"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
controller.setThrowExceptionOnError(true);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public void setKubernetes(KubernetesClient kubernetes) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public boolean isGUI() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public UIOutput getOutput() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public UIProvider getUiProvider() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public void setUiProvider(UIProvider uiProvider) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public void initializeUI(UIBuilder uiBuilder) throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public Project getCurrentSelectedProject(UIContext context) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (attributeMap != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (object instanceof Project) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
try {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (project != null && attributeMap != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"attributeMap.put(Project.class, project);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
} finally {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (project != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (root == null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (configFileResource == null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (selection != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (object instanceof Resource) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (folder != null && Files.isDirectory(folder)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public Result execute(UIExecutionContext context) throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
protected Result tableResults(TablePrinter table) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
table.print(getOut());,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public PrintStream getOut() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (output != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public MavenFacet getMavenFacet(UIContextProvider builder) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public Model getMavenModel(UIContextProvider builder) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (mavenFacet != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (Strings.isNullOrBlank(gitUrlText)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (root != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (gitFolder != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (config != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
} catch (Exception e) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (mavenModel != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (scm != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (Strings.isNotBlank(connection)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"protected void updateConfiguration(UIExecutionContext context, ProjectConfig config) {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"ProjectConfigs.configureProperties(config, attributeMap);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (pipelineValue instanceof PipelineDTO) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (pipeline != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
config.setPipeline(pipeline.getValue());,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
/**,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  implied.  See the License for the specific language governing,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  permissions and limitations under the License.,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*/,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
package io.fabric8.forge.devops;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public class DevOpsEditStep extends AbstractDevOpsCommand implements UIWizardStep {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Inject,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Override,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public UICommandMetadata getMetadata(UIContext context) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
.category(Categories.create(AbstractDevOpsCommand.CATEGORY)),3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
},3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public void initializeUI(UIBuilder builder) throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
copyFlowToProject.setValue(Boolean.TRUE);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
pipeline.setCompleter(new UICompleter<PipelineDTO>() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
});,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"pipeline.setValueConverter(new Converter<String, PipelineDTO>() {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public PipelineDTO convert(String text) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
pipeline.addValueChangeListener(new ValueChangeListener() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public void valueChanged(ValueChangeEvent event) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (value != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"pipeline.setNote(description != null ? description : """");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
} else {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"pipeline.setNote("""");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
copyFlowToProject.setEnabled(canCopy);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (getCurrentSelectedProject(context) != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (defaultValue != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
pipeline.setDefaultValue(defaultValue);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
pipeline.setValue(defaultValue);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
chatRoom.setCompleter(new UICompleter<String>() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
chatRoom.addValueChangeListener(new ValueChangeListener() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"chatRoom.setNote(description != null ? description : """");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"chatRoom.setNote("""");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
issueProjectName.setCompleter(new UICompleter<String>() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
issueProjectName.addValueChangeListener(new ValueChangeListener() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"issueProjectName.setNote(description != null ? description : """");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"issueProjectName.setNote("""");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
// lets initialise the data from the current config if it exists,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (configFile != null && configFile.exists()) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (config != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (flow != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"CommandHelpers.setInitialComponentValue(this.pipeline, flow);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"CommandHelpers.setInitialComponentValue(chatRoom, config.getChatRoom());",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"CommandHelpers.setInitialComponentValue(issueProjectName, config.getIssueProjectName());",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"CommandHelpers.setInitialComponentValue(codeReview, config.getCodeReview());",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (ignoreFilteringAsItBreaksHawtio) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
for (String value : values) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (value.toLowerCase().contains(lowerInputValue)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
answer.add(value);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public NavigationResult next(UINavigationContext context) throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public Result execute(UIExecutionContext context) throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"LOG.info(""Creating the fabric8.yml file"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (configFile == null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (configFile.exists()) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (config == null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"CommandHelpers.putComponentValuesInAttributeMap(context, inputComponents);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"updateConfiguration(context, config);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (config.isEmpty() && !hasFile) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (!configFile.exists()) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"ProjectConfigs.saveConfig(config, configFile);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
// now lets update the devops stuff,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (Strings.isNullOrBlank(gitUrl)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (basedir == null && configFile != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (object instanceof Project) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (facet != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (Strings.isNullOrBlank(named)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
// updating an existing project - so lets try find the git url from the current source code,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (basedir != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (Strings.isNotBlank(buildName)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (pipelineValue != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (environments == null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (environments.isEmpty()) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"environmentMap.put(""Current"", namespace);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
for (String environment : environments) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"environmentMap.put(environment, envNamespace);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
config.setEnvironments(environmentMap);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
ProjectConfigs.defaultEnvironments(config);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (Strings.isNullOrBlank(projectName)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
config.setBuildName(projectName);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (Strings.isNotBlank(projectName) && project != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (pom != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (updated) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"LOG.info(""Updating pom.xml properties!"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
maven.setModel(pom);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"LOG.warn(""Did not update pom.xml properties!"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"LOG.warn(""No pom.xml found!"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (copyFlowToProjectValue != null && copyFlowToProjectValue.booleanValue()) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (basedir == null || !basedir.isDirectory()) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (pipelineDTO != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (Strings.isNullOrBlank(flow)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (Strings.isNullOrBlank(flowText))  {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"Files.writeToFile(newFile, flowText.getBytes());",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
config.setPipeline(null);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
config.setUseLocalFlow(true);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
connector.setProjectConfig(config);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
connector.setTryLoadConfigFileFromRemoteGit(false);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
connector.setUsername(user);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"connector.setPassword(getStringAttribute(attributeMap, ""gitPassword""));",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"connector.setBranch(getStringAttribute(attributeMap, ""gitBranch"", ""master""));",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
connector.setBasedir(basedir);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
connector.setGitUrl(gitUrl);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
connector.setRepoName(named);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
connector.setRegisterWebHooks(true);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
connector.setTriggerJenkinsJob(false);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
/*,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public void run() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"LOG.info(""Now registering webhooks!"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
connector.registerWebHooks();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
try {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
connector.execute();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
} catch (Exception e) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (dir != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (file.isFile() && file.exists()) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
} catch (IOException e) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (Strings.isNotBlank(value)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
for (PipelineDTO pipelineDTO : pipelines) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (pipelineDTO.getValue().equals(value)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
protected Iterable<PipelineDTO> getPipelines(UIContext context) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public boolean matches(File file) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
};,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
for (File file : files) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (label.endsWith(postfix)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (label.startsWith(jenkinsFilePrefix)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"if (label.startsWith(""fabric8-release/"")) {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
continue;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (idx > 0) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (Files.isFile(markdownFile)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (Files.isFile(yamlFile)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (metadata != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
metadata.configurePipeline(pipeline);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"nameMap.put(pipeline.getLabel(), pipeline);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"LOG.warn(""No jenkinsWorkflowFolder!"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
protected File getJenkinsWorkflowFolder(UIContext context) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (workflowFolder instanceof File) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
protected Iterable<String> getIssueProjectNames() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (letschat != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (projects != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
for (ProjectDTO project : projects) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (name != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
answer.add(name);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
protected Iterable<String> getChatRoomNames() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (rooms != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
for (RoomDTO room : rooms) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public LetsChatClient getLetsChat() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (letsChat == null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public void setLetsChat(LetsChatClient letsChat) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public TaigaClient getTaiga() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (taiga == null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public void setTaiga(TaigaClient taiga) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
/**,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  implied.  See the License for the specific language governing,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  permissions and limitations under the License.,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*/,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
package io.fabric8.forge.devops;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public class NewBuildCommand extends AbstractDevOpsCommand {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Inject,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
UIInput<String> buildName;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
UIInput<String> imageName;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
UIInput<String> gitUri;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
UIInput<String> outputImage;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
UIInput<String> webHookSecret;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Override,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public UICommandMetadata getMetadata(UIContext context) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
.category(Categories.create(CATEGORY)),3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
},3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public void initializeUI(final UIBuilder builder) throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
super.initializeUI(builder);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
buildName.setDefaultValue(new Callable<String>() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (mavenModel != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
});,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
builder.add(buildName);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
builder.add(imageName);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
builder.add(gitUri);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
builder.add(outputImage);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
builder.add(webHookSecret);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public Result execute(UIExecutionContext context) throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"Objects.assertNotNull(buildConfigName, ""buildName"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (Strings.isNullOrBlank(imageText) && mavenModel != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (Strings.isNullOrBlank(webhookSecretText)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
// TODO generate a really good secret!,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
/**,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  implied.  See the License for the specific language governing,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  permissions and limitations under the License.,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*/,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
package io.fabric8.forge.devops;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public class NewIntegrationTestBuildCommand extends AbstractDevOpsCommand {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Inject,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
UIInput<String> buildName;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
UIInput<String> mavenCommand;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
UIInput<String> image;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
UIInput<String> gitUri;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Override,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public UICommandMetadata getMetadata(UIContext context) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
.category(Categories.create(CATEGORY)),3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
},3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public void initializeUI(final UIBuilder builder) throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
super.initializeUI(builder);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
buildName.setDefaultValue(new Callable<String>() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (mavenModel != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
});,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
builder.add(buildName);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
builder.add(mavenCommand);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
builder.add(image);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
builder.add(gitUri);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public Result execute(UIExecutionContext context) throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"Objects.assertNotNull(buildConfigName, ""buildName"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"builder.withEnvVar(""BUILD_NAME"", buildConfigName);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"builder.withEnvVar(""SOURCE_URI"", gitUrlText);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"builder.withEnvVar(""MAVEN_COMMAND"", mavenCommand);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
/**,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  implied.  See the License for the specific language governing,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  permissions and limitations under the License.,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*/,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
package io.fabric8.forge.kubernetes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public abstract class AbstractKubernetesCommand extends AbstractProjectCommand implements UICommand {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Inject,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
/*,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
UIProvider uiProvider;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
UIInput<String> kubernetesUrl;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Override,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
protected boolean isProjectRequired() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
},3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
protected ProjectFactory getProjectFactory() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (kubernetes == null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (Strings.isNotBlank(kubernetesAddress)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
} else {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"Objects.notNull(kubernetes, ""kubernetes"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public void setKubernetes(KubernetesClient kubernetes) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public boolean isGUI() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public UIOutput getOutput() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public UIProvider getUiProvider() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public void setUiProvider(UIProvider uiProvider) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public void initializeUI(UIBuilder uiBuilder) throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
protected Result tableResults(TablePrinter table) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
table.print(getOut());,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public PrintStream getOut() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (output != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public void setNamespace(String namespace) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
/**,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  implied.  See the License for the specific language governing,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  permissions and limitations under the License.,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*/,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
package io.fabric8.forge.kubernetes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public abstract class AbstractPodCommand extends AbstractKubernetesCommand {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Inject,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
UIInput<String> podId;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Override,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public void initializeUI(UIBuilder builder) throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
super.initializeUI(builder);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
// populate autocompletion options,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
podId.setCompleter(new UICompleter<String>() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (pods != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (items != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
for (Pod item : items) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
list.add(id);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
},3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
Collections.sort(list);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
});,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
builder.add(podId);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public Result execute(UIExecutionContext context) throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (podInfo == null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
} else {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"executePod(podInfo, podIdText);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
/**,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  implied.  See the License for the specific language governing,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  permissions and limitations under the License.,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*/,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
package io.fabric8.forge.kubernetes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public class PodDelete extends AbstractPodCommand {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Override,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public UICommandMetadata getMetadata(UIContext context) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
.category(Categories.create(CATEGORY)),3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
},3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
getKubernetes().pods().inNamespace(getNamespace()).withName(podId).delete();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
/**,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  implied.  See the License for the specific language governing,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  permissions and limitations under the License.,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*/,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
package io.fabric8.forge.kubernetes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public class PodsList extends AbstractKubernetesCommand {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Inject,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
UIInput<String> filterText;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Override,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public UICommandMetadata getMetadata(UIContext context) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
.category(Categories.create(CATEGORY)),3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
},3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public void initializeUI(UIBuilder builder) throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
super.initializeUI(builder);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
builder.add(filterText);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public Result execute(UIExecutionContext uiExecutionContext) throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
KubernetesHelper.removeEmptyPods(pods);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
protected TablePrinter podsAsTable(PodList pods) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"table.columns(""id"", ""image(s)"", ""host"", ""labels"", ""status"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (items == null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
for (Pod item : items) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (filter.matches(item)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (podStatus != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (spec != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
for (Container container : containerList) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"table.row(id, image, host, labels, status);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
/**,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  implied.  See the License for the specific language governing,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  permissions and limitations under the License.,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*/,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
package io.fabric8.forge.kubernetes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public class ReplicationControllerDelete extends AbstractKubernetesCommand {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Inject,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
UIInput<String> replicationControllerId;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Override,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public UICommandMetadata getMetadata(UIContext context) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
.category(Categories.create(CATEGORY)),3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
},3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public void initializeUI(UIBuilder builder) throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
super.initializeUI(builder);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
// populate autocompletion options,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
replicationControllerId.setCompleter(new UICompleter<String>() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (replicationControllers != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (items != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
for (ReplicationController item : items) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
list.add(id);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
Collections.sort(list);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
});,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
builder.add(replicationControllerId);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public Result execute(UIExecutionContext context) throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (replicationController == null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
} else {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
executeReplicationController(replicationController);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
protected void executeReplicationController(ReplicationController replicationController) throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
getKubernetes().replicationControllers().inNamespace(getNamespace()).withName(KubernetesHelper.getName(replicationController)).delete();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
/**,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  implied.  See the License for the specific language governing,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  permissions and limitations under the License.,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*/,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
package io.fabric8.forge.kubernetes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public class ReplicationControllersList extends AbstractKubernetesCommand {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Inject,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
UIInput<String> filterText;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Override,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public UICommandMetadata getMetadata(UIContext context) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
.category(Categories.create(CATEGORY)),3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
},3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public void initializeUI(UIBuilder builder) throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
super.initializeUI(builder);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
builder.add(filterText);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public Result execute(UIExecutionContext uiExecutionContext) throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"printReplicationControllers(replicationControllers, System.out);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"table.columns(""id"", ""labels"", ""replicas"", ""replica selector"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (items == null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
for (ReplicationController item : items) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (filter.matches(item)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (desiredState != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (currentState != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"table.row(id, labels, toPositiveNonZeroText(replicas), selector);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
table.print();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
/**,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  implied.  See the License for the specific language governing,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  permissions and limitations under the License.,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*/,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
package io.fabric8.forge.kubernetes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public class ServiceDelete extends AbstractKubernetesCommand {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Inject,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
UIInput<String> serviceId;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Override,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public UICommandMetadata getMetadata(UIContext context) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
.category(Categories.create(CATEGORY)),3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
},3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public void initializeUI(UIBuilder builder) throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
super.initializeUI(builder);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
// populate autocompletion options,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
serviceId.setCompleter(new UICompleter<String>() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (services != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (items != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
for (Service item : items) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
list.add(id);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
Collections.sort(list);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
});,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
builder.add(serviceId);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public Result execute(UIExecutionContext context) throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (service == null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
} else {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
executeService(service);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
protected void executeService(Service service) throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
getKubernetes().services().inNamespace(getNamespace()).withName(KubernetesHelper.getName(service)).delete();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
/**,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  implied.  See the License for the specific language governing,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  permissions and limitations under the License.,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*/,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
package io.fabric8.forge.kubernetes;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public class ServicesList extends AbstractKubernetesCommand {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Inject,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
UIInput<String> filterText;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Override,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public UICommandMetadata getMetadata(UIContext context) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
.category(Categories.create(CATEGORY)),3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
},3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public void initializeUI(UIBuilder builder) throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
super.initializeUI(builder);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
builder.add(filterText);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public Result execute(UIExecutionContext uiExecutionContext) throws Exception {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"printServices(services, System.out);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"table.columns(""id"", ""labels"", ""selector"", ""port"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (items == null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (filter.matches(service)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (portList.size() == 1) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
} else {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"table.row(KubernetesHelper.getName(service), labels, selector, portText);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
table.print();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
/**,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  implied.  See the License for the specific language governing,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*  permissions and limitations under the License.,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
*/,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
package io.fabric8.forge.rest.main;,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
// TODO we should try add this into the ConfigureDevOpsStep.execute() block instead!,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
public class GitCommandCompletePostProcessor implements CommandCompletePostProcessor {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Inject,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"public GitCommandCompletePostProcessor(KubernetesClient kubernetes,",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"GitUserHelper gitUserHelper,",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"ProjectFileSystem projectFileSystem,",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
},3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
@Override,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"public UserDetails preprocessRequest(String name, ExecutionRequest executionRequest, HttpServletRequest request) {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (Strings.isNullOrEmpty(userDetails.getUser()) || Strings.isNullOrEmpty(userDetails.getUser())) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"if (Objects.equals(name, PROJECT_NEW_COMMAND)) {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (inputList != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (page1 != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (page1.containsKey(TARGET_LOCATION_PROPERTY)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"page1.put(TARGET_LOCATION_PROPERTY, projectFileSystem.getUserProjectFolderLocation(userDetails));",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
/*,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"public void firePostCompleteActions(String name, ExecutionRequest executionRequest, RestUIContext context, CommandController controller, ExecutionResult results, HttpServletRequest request) {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
try {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (name.equals(PROJECT_NEW_COMMAND)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
GitHelpers.disableSslCertificateChecks();,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"for (Map<String, String> map : inputList) {",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (Strings.isNullOrEmpty(targetLocation)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (Strings.isNullOrEmpty(named)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"LOG.warn(""No targetLocation could be found!"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
} else if (Strings.isNullOrEmpty(named)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"LOG.warn(""No named could be found!"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
} else {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (!basedir.isDirectory() || !basedir.exists()) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
initCommand.setDirectory(basedir);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
createRepository.setName(named);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (repository != null) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (LOG.isDebugEnabled()) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (Strings.isNullOrEmpty(fullName)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"results.setOutputProperty(""fullName"", fullName);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"results.setOutputProperty(""cloneUrl"", remoteUrl);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"results.setOutputProperty(""htmlUrl"", htmlUrl);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"GitHelpers.configureBranch(git, branch, origin, remoteUrl);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
addDummyFileToEmptyFolders(basedir);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"GitHelpers.doAddCommitAndPushFiles(git, userDetails, personIdent, branch, origin, message, isPushOnCommit());",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
results.setProjectName(projectName);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"createBuildConfig(context, namespace, projectName, cloneUrl);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"LOG.info(""Creating any pending webhooks"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
registerWebHooks(context);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"LOG.info(""Done creating webhooks!"");",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
} catch (Exception e) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
handleException(e);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
for (String text : texts) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (!Strings.isNullOrEmpty(text)) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
controller.setNamespace(namespace);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
protected void addDummyFileToEmptyFolders(File dir) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (dir != null && dir.isDirectory()) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (children == null || children.length == 0) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
} catch (IOException e) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
for (File child : children) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (child.isDirectory()) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
addDummyFileToEmptyFolders(child);,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
protected void registerWebHooks(RestUIContext context) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
if (registerWebHooksValue instanceof Runnable) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"projectFileSystem.invokeLater(runnable, 1000L);",3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
protected boolean isPushOnCommit() {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
protected void handleException(Throwable e) {,3994edc36aa49cf0429c5be9129b3c106cbe64eb,0,1
"String consoleUrl = KubernetesHelper.getServiceURL(kubernetes, ServiceNames.FABRIC8_CONSOLE, namespace, ""http"", true);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,5,1
"String address = KubernetesHelper.getServiceURL(kubernetes, ServiceNames.JENKINS, namespace, ""http"", false);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,5,1
"String address = getServiceUrl(ServiceNames.JENKINS, false, namespace, jenkinsNamespace);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,4,0
"String consoleUrl = getServiceUrl(ServiceNames.FABRIC8_CONSOLE, namespace, fabric8ConsoleNamespace);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,3,0
"protected boolean annotationLink(Map<String, String> annotations, String annotationPrefix, String issueTrackerUrl, String issueTrackerLabel) {",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,3,0
"name = username + ""-"" + name;",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,3,1
"jenkinsUrl = KubernetesHelper.getServiceURL(kubernetes, ServiceNames.JENKINS, KubernetesHelper.defaultNamespace(), ""http"", true);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,3,1
"private String issueTrackerLabel = ""Issues"";",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,2,0
"private String teamLabel = ""Team"";",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,2,0
"private String releasesLabel = ""Releases"";",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,2,0
"private String repositoryBrowseLabel = ""Repository"";",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,2,0
"private String flowGitUrl = Systems.getEnvVar(""JENKINS_WORKFLOW_GIT_REPOSITORY"", ""https://github.com/fabric8io/jenkins-workflow-library.git"");",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,2,0
private String fabric8ConsoleNamespace = KubernetesHelper.defaultNamespace();,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,2,0
private String jenkinsNamespace = KubernetesHelper.defaultNamespace();,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,2,0
"String taigaLink = getProjectPageLink(taiga, taigaProject, this.taigaProjectLinkPage);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,2,0
"String taigaTeamLink = getProjectPageLink(taiga, taigaProject, this.taigaTeamLinkPage);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,2,0
"return KubernetesHelper.getServiceURL(getKubernetes(), serviceName, namespace, ""http"", serviceExternal);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,2,0
kubernetes = new DefaultKubernetesClient();,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,2,0
"private String flowGitUrl = System.getenv(""JENKINS_WORKFLOW_GIT_REPOSITORY"");",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,2,1
"String label = ""Monitor"";",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,2,1
"String label = ""Pipeline"";",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,2,1
"String label = ""Job"";",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,2,1
"String taigaLink = getProjectPageLink(taiga, taigaProject, this.taigaProjectLinkPage);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,2,1
"String taigaTeamLink = getProjectPageLink(taiga, taigaProject, this.taigaTeamLinkPage);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,2,1
private String issueTrackerUrl;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
private String teamUrl;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
private String releasesUrl;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
private String repositoryBrowseLink;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
"name = ProjectRepositories.createBuildName(username, repoName);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
jenkinsUrl = getJenkinsServiceUrl();,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
protected String getJenkinsServiceUrl() {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
"return getServiceUrl(ServiceNames.JENKINS, namespace, jenkinsNamespace);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
"protected String getServiceUrl(String serviceName, String... namespaces) {",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
"private String getServiceUrl(String serviceName, boolean serviceExternal, String... namespaces) {",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
List<String> namespaceList = new ArrayList<>(Arrays.asList(namespaces));,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
"String[] defaults = { KubernetesHelper.defaultNamespace(), ""default"" };",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
for (String namespace : namespaceList) {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
"annotations.put(annotationPrefix + ""url"", issueTrackerUrl);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
"annotations.put(annotationPrefix + ""label"", issueTrackerLabel);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
public String getFabric8ConsoleNamespace() {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
this.fabric8ConsoleNamespace = fabric8ConsoleNamespace;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
public String getJenkinsNamespace() {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
this.jenkinsNamespace = jenkinsNamespace;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
public String getIssueTrackerLabel() {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
this.issueTrackerLabel = issueTrackerLabel;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
public String getIssueTrackerUrl() {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
this.issueTrackerUrl = issueTrackerUrl;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
public String getTeamUrl() {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
this.teamUrl = teamUrl;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
public String getTeamLabel() {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
this.teamLabel = teamLabel;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
public String getReleasesUrl() {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
this.releasesUrl = releasesUrl;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
public String getReleasesLabel() {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
this.releasesLabel = releasesLabel;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
public String getRepositoryBrowseLabel() {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
this.repositoryBrowseLabel = repositoryBrowseLabel;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
public String getRepositoryBrowseLink() {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
this.repositoryBrowseLink = repositoryBrowseLink;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,0
name = repoName;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,1,1
import io.fabric8.devops.ProjectRepositories;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
import io.fabric8.openshift.api.model.BuildConfig;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
import io.fabric8.openshift.api.model.BuildConfigBuilder;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
import io.fabric8.openshift.api.model.BuildConfigFluent;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
import io.fabric8.utils.Systems;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
import java.util.ArrayList;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
import java.util.Arrays;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
import java.util.HashMap;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
import java.util.List;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
import java.util.Map;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
import java.util.Set;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
"annotationLink(annotations, ""fabric8.link.jenkins.monitor/"", url, ""Monitor"");",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
"annotationLink(annotations, ""fabric8.link.jenkins.pipeline/"", url, ""Pipeline"");",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
"annotationLink(annotations, ""fabric8.link.jenkins.job/"", jenkinsJobUrl, ""Job"");",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
"if (!annotationLink(annotations, ""fabric8.link.issues/"", issueTrackerUrl, issueTrackerLabel)) {",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
"annotationLink(annotations, ""fabric8.link.taiga/"", taigaLink, taigaProjectLinkLabel);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
"if (!annotationLink(annotations, ""fabric8.link.team/"", teamUrl, teamLabel)) {",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
"annotationLink(annotations, ""fabric8.link.taiga.team/"", taigaTeamLink, taigaTeamLinkLabel);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
"annotationLink(annotations, ""fabric8.link.releases/"", releasesUrl, releasesLabel);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
"annotationLink(annotations, ""fabric8.link.letschat.room/"", chatRoomLink, letschatRoomLinkLabel);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
"annotationLink(annotations, ""fabric8.link.repository.browse/"", repositoryBrowseLink, repositoryBrowseLabel);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
endStrategy();,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
},5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
/**,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
* Looks in the given namespaces for the given service or returns null if it could not be found,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
*/,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
"return getServiceUrl(serviceName, true, namespaces);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
for (String defaultNamespace : defaults) {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
if (namespaceList.contains(defaultNamespace)) {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
namespaceList.add(defaultNamespace);,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
try {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
} catch (Exception e) {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
// ignore,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
return null;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
if (Strings.isNotBlank(issueTrackerUrl)) {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
"addLink(issueTrackerLabel, issueTrackerUrl);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
return true;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
} else {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
return false;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
if (kubernetes == null) {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
return kubernetes;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
return fabric8ConsoleNamespace;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
public void setFabric8ConsoleNamespace(String fabric8ConsoleNamespace) {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
return jenkinsNamespace;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
public void setJenkinsNamespace(String jenkinsNamespace) {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
return issueTrackerLabel;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
public void setIssueTrackerLabel(String issueTrackerLabel) {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
return issueTrackerUrl;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
public void setIssueTrackerUrl(String issueTrackerUrl) {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
return teamUrl;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
public void setTeamUrl(String teamUrl) {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
return teamLabel;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
public void setTeamLabel(String teamLabel) {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
return releasesUrl;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
public void setReleasesUrl(String releasesUrl) {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
return releasesLabel;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
public void setReleasesLabel(String releasesLabel) {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
return repositoryBrowseLabel;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
public void setRepositoryBrowseLabel(String repositoryBrowseLabel) {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
return repositoryBrowseLink;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
public void setRepositoryBrowseLink(String repositoryBrowseLink) {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
controller.setNamespace(namespace);,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,0
import io.fabric8.kubernetes.api.model.EnvVar;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
import io.fabric8.openshift.client.OpenShiftClient;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
import io.fabric8.openshift.api.model.*;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
import java.util.*;,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
if (Strings.isNotBlank(username)) {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
},5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
"annotations.put(""fabric8.link.jenkins.monitor/url"", url);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
"annotations.put(""fabric8.link.jenkins.monitor/label"", label);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
"addLink(label, url);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
"annotations.put(""fabric8.link.jenkins.pipeline/url"", url);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
"annotations.put(""fabric8.link.jenkins.pipeline/label"", label);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
"annotations.put(""fabric8.link.jenkins.job/url"", jenkinsJobUrl);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
"annotations.put(""fabric8.link.jenkins.job/label"", label);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
"addLink(label, jenkinsJobUrl);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
if (Strings.isNotBlank(taigaLink)) {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
"annotations.put(""fabric8.link.taiga/url"", taigaLink);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
"annotations.put(""fabric8.link.taiga/label"", taigaProjectLinkLabel);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
"addLink(taigaProjectLinkLabel, taigaLink);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
if (Strings.isNotBlank(taigaTeamLink)) {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
"annotations.put(""fabric8.link.taiga.team/url"", taigaTeamLink);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
"annotations.put(""fabric8.link.taiga.team/label"", taigaTeamLinkLabel);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
"addLink(taigaTeamLinkLabel, taigaTeamLink);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
if (Strings.isNotBlank(chatRoomLink)) {,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
"annotations.put(""fabric8.link.letschat.room/url"", chatRoomLink);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
"annotations.put(""fabric8.link.letschat.room/label"", letschatRoomLinkLabel);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
"addLink(letschatRoomLinkLabel, chatRoomLink);",5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
endStrategy();,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
return new DefaultKubernetesClient();,5f492eb585bd87d5c1f4dc8c0ad78e884214efa6,0,1
String specificServiceType = getServiceType(serviceName);,12bf071e90211ca9016c4c962227f4b4637f7f5c,0,0
if (Strings.isNotBlank(specificServiceType)) {,12bf071e90211ca9016c4c962227f4b4637f7f5c,0,0
serviceSpecBuilder.withType(specificServiceType);,12bf071e90211ca9016c4c962227f4b4637f7f5c,0,0
private String getServiceType(String serviceName) throws MojoExecutionException {,12bf071e90211ca9016c4c962227f4b4637f7f5c,0,0
"String serviceSpecificTypeName = buildServicePrefix(serviceName, ""fabric8.service"", ""type"");",12bf071e90211ca9016c4c962227f4b4637f7f5c,0,0
Properties properties = getProjectAndFabric8Properties(getProject());,12bf071e90211ca9016c4c962227f4b4637f7f5c,0,0
String serviceSpecificType = properties.getProperty(serviceSpecificTypeName);,12bf071e90211ca9016c4c962227f4b4637f7f5c,0,0
if (Strings.isNullOrBlank(serviceSpecificType)) {,12bf071e90211ca9016c4c962227f4b4637f7f5c,0,0
serviceSpecificType = this.serviceType;,12bf071e90211ca9016c4c962227f4b4637f7f5c,0,0
},12bf071e90211ca9016c4c962227f4b4637f7f5c,0,0
return serviceSpecificType;,12bf071e90211ca9016c4c962227f4b4637f7f5c,0,0
if (Strings.isNotBlank(serviceType)) {,12bf071e90211ca9016c4c962227f4b4637f7f5c,0,1
serviceSpecBuilder.withType(serviceType);,12bf071e90211ca9016c4c962227f4b4637f7f5c,0,1
"LOG.info(""Updating replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",30ec2c8123f9a4e99aa476580f08f57a626b726a,8,0
"LOG.warn(""Creation disabled so not creating a replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",30ec2c8123f9a4e99aa476580f08f57a626b726a,8,0
"LOG.info(""Updating replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",30ec2c8123f9a4e99aa476580f08f57a626b726a,8,1
"LOG.warn(""Creation disabled so not creating a replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",30ec2c8123f9a4e99aa476580f08f57a626b726a,8,1
"LOG.info(""Updating replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",30ec2c8123f9a4e99aa476580f08f57a626b726a,8,0
"LOG.warn(""Creation disabled so not creating a replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",30ec2c8123f9a4e99aa476580f08f57a626b726a,8,0
"LOG.info(""Updating replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",30ec2c8123f9a4e99aa476580f08f57a626b726a,8,1
"LOG.warn(""Creation disabled so not creating a replicationController from "" + sourceName + "" namespace "" + namespace + "" name "" + getName(replicationController));",30ec2c8123f9a4e99aa476580f08f57a626b726a,8,1
"onApplyError(""Failed to update replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",30ec2c8123f9a4e99aa476580f08f57a626b726a,6,0
"onApplyError(""Failed to update replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",30ec2c8123f9a4e99aa476580f08f57a626b726a,6,1
"onApplyError(""Failed to update replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",30ec2c8123f9a4e99aa476580f08f57a626b726a,6,0
"onApplyError(""Failed to update replicationController from "" + sourceName + "". "" + e + "". "" + replicationController, e);",30ec2c8123f9a4e99aa476580f08f57a626b726a,6,1
"LOG.info(""START getCurrentSelectedProject: on "" + getProjectFactory() + "" selection: "" + selectedObject + "". This may result in mvn artifacts being downloaded to ~/.m2/repository"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,5,1
"@WithAttributes(label = ""Replication Controller ID"", description = ""The ID of the replication controller to delete."", required = true)",30ec2c8123f9a4e99aa476580f08f57a626b726a,5,1
"protected boolean annotationLink(Map<String, String> annotations, String annotationPrefix, String issueTrackerUrl, String issueTrackerLabel) {",30ec2c8123f9a4e99aa476580f08f57a626b726a,4,0
"String address = getServiceUrl(ServiceNames.JENKINS, false, namespace, jenkinsNamespace);",30ec2c8123f9a4e99aa476580f08f57a626b726a,4,0
"String address = KubernetesHelper.getServiceURL(kubernetes, ServiceNames.JENKINS, namespace, ""http"", false);",30ec2c8123f9a4e99aa476580f08f57a626b726a,4,1
private OpenShiftClient client = new DefaultOpenShiftClient();,30ec2c8123f9a4e99aa476580f08f57a626b726a,4,1
"watcher = new BuildWatcher(client, buildListener, namespace, consoleLink);",30ec2c8123f9a4e99aa476580f08f57a626b726a,4,1
"public String trigger(String namespace, final String buildName) {",30ec2c8123f9a4e99aa476580f08f57a626b726a,4,1
try (Watch watch = kubernetes.adapt(OpenShiftClient.class).builds().inNamespace(namespace).watch(new Watcher<Build>() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,4,1
"LOG.info(""Rolling upgrade of the RC "" + namespace + ""/"" + id);",30ec2c8123f9a4e99aa476580f08f57a626b726a,4,0
"LOG.info(""Rolling upgrade of the RC "" + namespace + ""/"" + id);",30ec2c8123f9a4e99aa476580f08f57a626b726a,4,0
"LOG.info(""rollingUpgradePreserveScale "" + rollingUpgradePreserveScale + "" new replicas is "" + newSpec.getReplicas());",30ec2c8123f9a4e99aa476580f08f57a626b726a,4,0
"LOG.info(""Rolling upgrade of the RC "" + namespace + ""/"" + id);",30ec2c8123f9a4e99aa476580f08f57a626b726a,4,1
"@WithAttributes(name = ""kubernetesUrl"", label = ""The URL where the kubernetes master is running"")",30ec2c8123f9a4e99aa476580f08f57a626b726a,4,1
private static String namespace = KubernetesHelper.defaultNamespace();,30ec2c8123f9a4e99aa476580f08f57a626b726a,4,1
"@WithAttributes(name = ""kubernetesUrl"", label = ""The URL where the kubernetes master is running"")",30ec2c8123f9a4e99aa476580f08f57a626b726a,4,1
"@WithAttributes(label = ""Service ID"", description = ""The ID of the service to delete."", required = true)",30ec2c8123f9a4e99aa476580f08f57a626b726a,4,1
"private String issueTrackerLabel = ""Issues"";",30ec2c8123f9a4e99aa476580f08f57a626b726a,3,0
"private String teamLabel = ""Team"";",30ec2c8123f9a4e99aa476580f08f57a626b726a,3,0
"private String releasesLabel = ""Releases"";",30ec2c8123f9a4e99aa476580f08f57a626b726a,3,0
"private String repositoryBrowseLabel = ""Repository"";",30ec2c8123f9a4e99aa476580f08f57a626b726a,3,0
"private String flowGitUrl = Systems.getEnvVar(""JENKINS_WORKFLOW_GIT_REPOSITORY"", ""https://github.com/fabric8io/jenkins-workflow-library.git"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,3,0
private String fabric8ConsoleNamespace = KubernetesHelper.defaultNamespace();,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,0
private String jenkinsNamespace = KubernetesHelper.defaultNamespace();,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,0
"String consoleUrl = getServiceUrl(ServiceNames.FABRIC8_CONSOLE, namespace, fabric8ConsoleNamespace);",30ec2c8123f9a4e99aa476580f08f57a626b726a,3,0
"private String getServiceUrl(String serviceName, boolean serviceExternal, String... namespaces) {",30ec2c8123f9a4e99aa476580f08f57a626b726a,3,0
} catch (Exception e) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,0
kubernetes = new DefaultKubernetesClient();,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,0
"private String flowGitUrl = System.getenv(""JENKINS_WORKFLOW_GIT_REPOSITORY"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
"name = username + ""-"" + name;",30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
"String consoleUrl = KubernetesHelper.getServiceURL(kubernetes, ServiceNames.FABRIC8_CONSOLE, namespace, ""http"", true);",30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
* This service is a helper class to create a configured instance of a,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
private Timer timer = new Timer();,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
this.client = client;,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
} catch (InterruptedException e) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
ReplicationController old = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).get();,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,0
"LOG.info(""Deleting any pods for the replication controller to ensure they use the new configuration"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,3,0
"LOG.info(""Warning not deleted any pods so they could well be running with the old configuration!"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,3,0
} catch (Exception e) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,0
ReplicationController old = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).get();,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
"LOG.info(""Deleting any pods for the replication controller to ensure they use the new configuration"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
"LOG.info(""Warning not deleted any pods so they could well be running with the old configuration!"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
} catch (Exception e) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
ReplicationController old = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).get();,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,0
"LOG.info(""Deleting any pods for the replication controller to ensure they use the new configuration"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,3,0
"LOG.info(""Warning not deleted any pods so they could well be running with the old configuration!"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,3,0
} catch (Exception e) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,0
ReplicationController old = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).get();,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
"LOG.info(""Deleting any pods for the replication controller to ensure they use the new configuration"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
"LOG.info(""Warning not deleted any pods so they could well be running with the old configuration!"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
} catch (Exception e) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
kubernetes = new DefaultKubernetesClient(new ConfigBuilder().withMasterUrl(kubernetesAddress).build());,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
kubernetes = new DefaultKubernetesClient();,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
Controller controller = new Controller(getKubernetes());,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
"LOG.info(""END   getCurrentSelectedProject: on "" + getProjectFactory() + "" selection: "" + selectedObject);",30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
"protected String getOrFindGitUrl(UIExecutionContext context, String gitUrlText) {",30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
} catch (Exception e) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
kubernetes = new DefaultKubernetesClient(new ConfigBuilder().withMasterUrl(kubernetesAddress).build());,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
kubernetes = new DefaultKubernetesClient();,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
* Base class for working with a pod,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
"@WithAttributes(label = ""Pod ID"", description = ""The ID of the pod."", required = true)",30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
List<String> list = new ArrayList<String>();,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
String id = KubernetesHelper.getName(item);,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
KubernetesClient kubernetes = getKubernetes();,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
Pod podInfo = getKubernetes().pods().inNamespace(getNamespace()).withName(podIdText).get();,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
".name(CATEGORY + "": Replication Controller Delete"")",30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
List<String> list = new ArrayList<String>();,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
String id = KubernetesHelper.getName(item);,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
ReplicationController replicationController = getKubernetes().replicationControllers().inNamespace(getNamespace()).withName(idText).get();,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
List<String> list = new ArrayList<String>();,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
String id = KubernetesHelper.getName(item);,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
Service service = getKubernetes().services().inNamespace(getNamespace()).withName(idText).get();,30ec2c8123f9a4e99aa476580f08f57a626b726a,3,1
Object answer = openShiftClient.oAuthClients().withName(id).replace(entity);,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
Object answer = openShiftClient.templates().inNamespace(namespace).withName(id).replace(entity);,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
Object answer = kubernetesClient.serviceAccounts().inNamespace(namespace).withName(id).replace(serviceAccount);,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
Object answer = kubernetesClient.secrets().inNamespace(namespace).withName(id).replace(secret);,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
Object answer = openShiftClient.buildConfigs().inNamespace(namespace).withName(id).replace(entity);,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
Object answer = kubernetesClient.services().inNamespace(namespace).withName(id).replace(service);,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
Object answer = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).replace(replicationController);,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
Object answer = kubernetesClient.pods().inNamespace(namespace).withName(id).replace(pod);,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
Object answer = openShiftClient.oAuthClients().withName(id).update(entity);,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
Object answer = openShiftClient.templates().inNamespace(namespace).withName(id).update(entity);,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
Object answer = kubernetesClient.serviceAccounts().inNamespace(namespace).withName(id).update(serviceAccount);,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
Object answer = kubernetesClient.secrets().inNamespace(namespace).withName(id).update(secret);,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
Object answer = openShiftClient.buildConfigs().inNamespace(namespace).withName(id).update(entity);,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
Object answer = kubernetesClient.services().inNamespace(namespace).withName(id).update(service);,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
Object answer = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).update(replicationController);,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
Object answer = kubernetesClient.pods().inNamespace(namespace).withName(id).update(pod);,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
private String issueTrackerUrl;,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
private String teamUrl;,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
private String releasesUrl;,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
private String repositoryBrowseLink;,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
"String taigaLink = getProjectPageLink(taiga, taigaProject, this.taigaProjectLinkPage);",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
"String taigaTeamLink = getProjectPageLink(taiga, taigaProject, this.taigaTeamLinkPage);",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
protected String getJenkinsServiceUrl() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
"return getServiceUrl(ServiceNames.JENKINS, namespace, jenkinsNamespace);",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
* Looks in the given namespaces for the given service or returns null if it could not be found,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
"protected String getServiceUrl(String serviceName, String... namespaces) {",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
List<String> namespaceList = new ArrayList<>(Arrays.asList(namespaces));,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
"String[] defaults = { KubernetesHelper.defaultNamespace(), ""default"" };",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
for (String namespace : namespaceList) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
try {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
"return KubernetesHelper.getServiceURL(getKubernetes(), serviceName, namespace, ""http"", serviceExternal);",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
} else {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
public String getFabric8ConsoleNamespace() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
public String getJenkinsNamespace() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
public String getIssueTrackerLabel() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
public String getIssueTrackerUrl() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
public String getTeamUrl() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
public String getTeamLabel() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
public String getReleasesUrl() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
public String getReleasesLabel() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
public String getRepositoryBrowseLabel() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
public String getRepositoryBrowseLink() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
"String label = ""Monitor"";",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
"String label = ""Pipeline"";",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
"String label = ""Job"";",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
"String taigaLink = getProjectPageLink(taiga, taigaProject, this.taigaProjectLinkPage);",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
"String taigaTeamLink = getProjectPageLink(taiga, taigaProject, this.taigaTeamLinkPage);",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
return new DefaultKubernetesClient();,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
public class BuildSignallerService {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
private final String namespace;,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
private BuildProcessCorrelator buildProcessCorrelator = BuildProcessCorrelators.getSingleton();,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
private String consoleLink;,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
"public BuildSignallerService(KieSession ksession, String namespace) {",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
String consoleLink = getConsoleLink();,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
"BuildSignaller buildListener = new BuildSignaller(ksession, buildProcessCorrelator);",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
} else {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
} else if (simulator != null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
return client;,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
public String getConsoleLink() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
public class DefaultBuildTrigger implements BuildTrigger {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
private final KubernetesClient kubernetes;,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
final BlockingQueue<String> uuid = new ArrayBlockingQueue<>(1);,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
"public void eventReceived(Action action, Build build) {",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
} else {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
try {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
Object answer = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).replace(replicationController);,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
} else {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
try {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
Object answer = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).replace(replicationController);,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
private boolean rollingUpgradePreserveScale = true;,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
} else {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
} else if (isRecreateMode()) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
try {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
Object answer = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).replace(replicationController);,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,0
} else {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
try {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
Object answer = kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).replace(replicationController);,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
public abstract class AbstractDevOpsCommand extends AbstractProjectCommand implements UICommand {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
private static final transient Logger LOG = LoggerFactory.getLogger(AbstractDevOpsCommand.class);,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
"public static String CATEGORY = ""DevOps"";",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
private KubernetesClient kubernetes;,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
public KubernetesClient getKubernetes() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
String kubernetesAddress = kubernetesUrl.getValue();,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
} else {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
public Controller createController() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
try {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
} finally {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
Resource<?> root = project.getRoot();,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
"return new File(folder, ProjectConfigs.FILE_NAME);",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
"Resource<?> config = gitFolder.getChild(""config"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
String configText = config.getContents();,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
String connection = scm.getConnection();,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
* An abstract base class for kubernetes related commands,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
public abstract class AbstractKubernetesCommand extends AbstractProjectCommand implements UICommand {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
"public static String CATEGORY = ""Kubernetes"";",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
private KubernetesClient kubernetes;,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
public KubernetesClient getKubernetes() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
String kubernetesAddress = kubernetesUrl.getValue();,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
} else {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
public String getNamespace() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
public abstract class AbstractPodCommand extends AbstractKubernetesCommand {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
"public Iterable<String> getCompletionProposals(UIContext context, InputComponent<?, String> input, String value) {",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
PodList pods = getKubernetes().pods().list();,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
"System.out.println(""Completion list is "" + list);",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
String podIdText = podId.getValue();,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
"System.out.println(""No pod for id: "" + podIdText);",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
} else {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
* Deletes a replication controller from kubernetes,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
public class ReplicationControllerDelete extends AbstractKubernetesCommand {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
".description(""Deletes the given replication controller from the kubernetes cloud"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
"public Iterable<String> getCompletionProposals(UIContext context, InputComponent<?, String> input, String value) {",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
String idText = replicationControllerId.getValue();,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
"System.out.println(""No replicationController for id: "" + idText);",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
} else {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
* Deletes a service from kubernetes,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
public class ServiceDelete extends AbstractKubernetesCommand {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
".name(CATEGORY + "": Service Delete"")",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
".description(""Deletes the given service from the kubernetes cloud"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
"public Iterable<String> getCompletionProposals(UIContext context, InputComponent<?, String> input, String value) {",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
ServiceList services = getKubernetes().services().inNamespace(getNamespace()).list();,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
String idText = serviceId.getValue();,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
"System.out.println(""No service for id: "" + idText);",30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
} else {,30ec2c8123f9a4e99aa476580f08f57a626b726a,2,1
import io.fabric8.devops.ProjectRepositories;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
import io.fabric8.openshift.api.model.BuildConfig;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
import io.fabric8.openshift.api.model.BuildConfigBuilder;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
import io.fabric8.openshift.api.model.BuildConfigFluent;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
import io.fabric8.utils.Systems;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
import java.util.ArrayList;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
import java.util.Arrays;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
import java.util.HashMap;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
import java.util.List;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
import java.util.Map;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
import java.util.Set;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
"name = ProjectRepositories.createBuildName(username, repoName);",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
jenkinsUrl = getJenkinsServiceUrl();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
"if (!annotationLink(annotations, ""fabric8.link.issues/"", issueTrackerUrl, issueTrackerLabel)) {",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
"if (!annotationLink(annotations, ""fabric8.link.team/"", teamUrl, teamLabel)) {",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
},30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
"return getServiceUrl(serviceName, true, namespaces);",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
for (String defaultNamespace : defaults) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
if (namespaceList.contains(defaultNamespace)) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
return null;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
if (Strings.isNotBlank(issueTrackerUrl)) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
"annotations.put(annotationPrefix + ""url"", issueTrackerUrl);",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
"annotations.put(annotationPrefix + ""label"", issueTrackerLabel);",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
return true;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
return false;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
if (kubernetes == null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
return kubernetes;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
return fabric8ConsoleNamespace;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
public void setFabric8ConsoleNamespace(String fabric8ConsoleNamespace) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
this.fabric8ConsoleNamespace = fabric8ConsoleNamespace;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
return jenkinsNamespace;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
public void setJenkinsNamespace(String jenkinsNamespace) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
this.jenkinsNamespace = jenkinsNamespace;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
return issueTrackerLabel;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
public void setIssueTrackerLabel(String issueTrackerLabel) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
this.issueTrackerLabel = issueTrackerLabel;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
return issueTrackerUrl;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
public void setIssueTrackerUrl(String issueTrackerUrl) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
this.issueTrackerUrl = issueTrackerUrl;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
return teamUrl;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
public void setTeamUrl(String teamUrl) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
this.teamUrl = teamUrl;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
return teamLabel;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
public void setTeamLabel(String teamLabel) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
this.teamLabel = teamLabel;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
return releasesUrl;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
public void setReleasesUrl(String releasesUrl) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
this.releasesUrl = releasesUrl;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
return releasesLabel;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
public void setReleasesLabel(String releasesLabel) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
this.releasesLabel = releasesLabel;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
return repositoryBrowseLabel;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
public void setRepositoryBrowseLabel(String repositoryBrowseLabel) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
this.repositoryBrowseLabel = repositoryBrowseLabel;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
return repositoryBrowseLink;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
public void setRepositoryBrowseLink(String repositoryBrowseLink) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
this.repositoryBrowseLink = repositoryBrowseLink;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
import io.fabric8.kubernetes.api.model.EnvVar;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.openshift.client.OpenShiftClient;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.openshift.api.model.*;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import java.util.*;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
name = repoName;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (Strings.isNotBlank(username)) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
},30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"jenkinsUrl = KubernetesHelper.getServiceURL(kubernetes, ServiceNames.JENKINS, KubernetesHelper.defaultNamespace(), ""http"", true);",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (Strings.isNotBlank(taigaLink)) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (Strings.isNotBlank(taigaTeamLink)) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (Strings.isNotBlank(chatRoomLink)) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
*  with the License.  You may obtain a copy of the License at,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"*  Unless required by applicable law or agreed to in writing, software",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.workflow.build.correlate.BuildProcessCorrelator;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.workflow.build.correlate.BuildProcessCorrelators;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.workflow.build.simulator.BuildSimulator;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.api.builds.BuildWatcher;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.api.builds.Links;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.client.KubernetesClient;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.openshift.client.DefaultOpenShiftClient;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.openshift.client.OpenShiftClient;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.kie.api.runtime.KieSession;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import java.util.Timer;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
* A service which listens to {@link io.fabric8.kubernetes.api.builds.BuildFinishedEvent} events from,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
* the OpenShift build watcher and then signals the correlated jBPM process instances or,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
* signals new processes to start.,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
private final KieSession ksession;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
private BuildWatcher watcher;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
private BuildSimulator simulator;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public BuildSignallerService(KieSession ksession) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
},30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
this.ksession = ksession;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
this.namespace = namespace;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public void start() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
long pollTime = 3000;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (BuildSimulator.isEnabled()) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
simulator = BuildSimulator.getSingleton();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"simulator.schedule(timer, pollTime, buildListener, consoleLink);",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public void stop() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public void join() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (watcher != null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public BuildProcessCorrelator getBuildProcessCorrelator() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return buildProcessCorrelator;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public void setBuildProcessCorrelator(BuildProcessCorrelator buildProcessCorrelator) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
this.buildProcessCorrelator = buildProcessCorrelator;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public OpenShiftClient getClient() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public void setClient(OpenShiftClient client) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public Timer getTimer() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return timer;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public void setTimer(Timer timer) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
this.timer = timer;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (consoleLink == null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
consoleLink = Links.getFabric8ConsoleLink();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return consoleLink;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public void setConsoleLink(String consoleLink) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
this.consoleLink = consoleLink;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
*  with the License.  You may obtain a copy of the License at,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"*  Unless required by applicable law or agreed to in writing, software",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.api.KubernetesHelper;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.api.builds.Builds;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.client.DefaultKubernetesClient;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.client.KubernetesClient;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.client.KubernetesClientException;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.client.Watch;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.client.Watcher;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.openshift.api.model.Build;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.openshift.client.OpenShiftClient;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import java.util.concurrent.ArrayBlockingQueue;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import java.util.concurrent.BlockingQueue;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import java.util.concurrent.TimeUnit;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public DefaultBuildTrigger() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
},30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public DefaultBuildTrigger(KubernetesClient kubernetes) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
this.kubernetes = kubernetes;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (action == Action.ADDED && KubernetesHelper.getName(build).equals(buildName)) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public void onClose(KubernetesClientException e) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
})) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"return uuid.poll(60, TimeUnit.SECONDS);",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
private boolean rollingUpgrade;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
if (rollingUpgrade) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
if (isRunning(old)) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
"if (UserConfigurationCompare.configEqual(replicationController, old)) {",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
if (isRecreateMode()) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
"LOG.info(""Deleting ReplicationController: "" + id);",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
"doCreateReplicationController(replicationController, namespace, sourceName);",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
"logGeneratedEntity(""Updated replicationController: "", namespace, replicationController, answer);",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
if (deletePodsOnReplicationControllerUpdate) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
},30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
if (!isAllowCreate()) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
public boolean isRollingUpgrade() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
return rollingUpgrade;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
public void setRollingUpgrade(boolean rollingUpgrade) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
this.rollingUpgrade = rollingUpgrade;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
if (isRunning(old)) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"if (UserConfigurationCompare.configEqual(replicationController, old)) {",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (isRecreateMode()) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"LOG.info(""Deleting ReplicationController: "" + id);",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"doCreateReplicationController(replicationController, namespace, sourceName);",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"logGeneratedEntity(""Updated replicationController: "", namespace, replicationController, answer);",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (deletePodsOnReplicationControllerUpdate) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
},30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (!isAllowCreate()) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (isRunning(old)) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
"if (UserConfigurationCompare.configEqual(replicationController, old)) {",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
ReplicationControllerSpec newSpec = replicationController.getSpec();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
ReplicationControllerSpec oldSpec = old.getSpec();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
if (rollingUpgrade) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
// lets preserve the number of replicas currently running in the environment we are about to upgrade,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
if (rollingUpgradePreserveScale && newSpec != null && oldSpec != null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
Integer replicas = oldSpec.getReplicas();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
if (replicas != null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
},30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
"LOG.info(""Deleting ReplicationController: "" + id);",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
"doCreateReplicationController(replicationController, namespace, sourceName);",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
"logGeneratedEntity(""Updated replicationController: "", namespace, replicationController, answer);",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
if (deletePodsOnReplicationControllerUpdate) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
if (!isAllowCreate()) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
public boolean isRollingUpgradePreserveScale() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
return rollingUpgradePreserveScale;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
public void setRollingUpgradePreserveScale(boolean rollingUpgradePreserveScale) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
this.rollingUpgradePreserveScale = rollingUpgradePreserveScale;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,0
import io.fabric8.kubernetes.api.model.Doneable;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.api.model.DoneablePersistentVolumeClaim;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.api.model.KubernetesResourceList;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.api.model.PersistentVolumeClaimList;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.api.model.SecurityContextConstraints;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (rollingUpgrade) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (isRunning(old)) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"if (UserConfigurationCompare.configEqual(replicationController, old)) {",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (isRecreateMode()) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"LOG.info(""Deleting ReplicationController: "" + id);",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"doCreateReplicationController(replicationController, namespace, sourceName);",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"logGeneratedEntity(""Updated replicationController: "", namespace, replicationController, answer);",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (deletePodsOnReplicationControllerUpdate) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
},30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (!isAllowCreate()) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
*  with the License.  You may obtain a copy of the License at,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"*  Unless required by applicable law or agreed to in writing, software",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.devops.ProjectConfig;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.devops.ProjectConfigs;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.forge.devops.dto.PipelineDTO;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.api.Controller;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.client.ConfigBuilder;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.client.DefaultKubernetesClient;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.client.KubernetesClient;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.utils.Files;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.utils.GitHelpers;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.utils.Objects;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.utils.Strings;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.utils.TablePrinter;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.apache.maven.model.Model;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.apache.maven.model.Scm;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.maven.projects.MavenFacet;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.projects.Project;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.projects.ProjectFactory;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.projects.Projects;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.projects.ui.AbstractProjectCommand;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.resource.Resource;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.resource.util.ResourceUtil;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.UIProvider;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.command.UICommand;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.context.UIContext;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.context.UIContextProvider;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.context.UISelection;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.input.UIInput;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.output.UIOutput;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.result.Result;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.result.Results;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.slf4j.Logger;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.slf4j.LoggerFactory;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import javax.inject.Inject;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import java.io.File;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import java.io.PrintStream;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import java.util.Map;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
* An abstract base class for DevOps related commands,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
private ProjectFactory projectFactory;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
protected boolean isProjectRequired() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return false;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
},30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
protected ProjectFactory getProjectFactory() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return projectFactory;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (kubernetes == null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (Strings.isNotBlank(kubernetesAddress)) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return kubernetes;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return controller;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public void setKubernetes(KubernetesClient kubernetes) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
this.kubernetes = kubernetes;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public boolean isGUI() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return getUiProvider().isGUI();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public UIOutput getOutput() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
UIProvider provider = getUiProvider();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return provider != null ? provider.getOutput() : null;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public UIProvider getUiProvider() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return uiProvider;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public void setUiProvider(UIProvider uiProvider) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
this.uiProvider = uiProvider;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public void initializeUI(UIBuilder uiBuilder) throws Exception {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public Project getCurrentSelectedProject(UIContext context) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
Project project = null;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"Map<Object, Object> attributeMap = context.getAttributeMap();",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (attributeMap != null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
Object object = attributeMap.get(Project.class);,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (object instanceof Project) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
project = (Project) object;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return project;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
UISelection<Object> selection = context.getSelection();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
Object selectedObject = selection.get();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"project = Projects.getSelectedProject(getProjectFactory(), context);",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (project != null && attributeMap != null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"public static File getProjectConfigFile(UIContext context, Project project) {",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (project != null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (root == null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return null;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
Resource<?> configFileResource = root.getChild(ProjectConfigs.FILE_NAME);,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (configFileResource == null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return ResourceUtil.getContextFile(configFileResource);,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (selection != null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
Object object = selection.get();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (object instanceof Resource) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
File folder = ResourceUtil.getContextFile((Resource<?>) object);,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (folder != null && Files.isDirectory(folder)) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public Result execute(UIExecutionContext context) throws Exception {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return Results.success();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
protected Result tableResults(TablePrinter table) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public PrintStream getOut() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
UIOutput output = getOutput();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (output != null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return output.out();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return System.out;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public MavenFacet getMavenFacet(UIContextProvider builder) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
final Project project = getSelectedProject(builder);,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
MavenFacet maven = project.getFacet(MavenFacet.class);,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return maven;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public Model getMavenModel(UIContextProvider builder) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
MavenFacet mavenFacet = getMavenFacet(builder);,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (mavenFacet != null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return mavenFacet.getModel();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (Strings.isNullOrBlank(gitUrlText)) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
final Project project = getSelectedProject(context);,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (root != null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"Resource<?> gitFolder = root.getChild("".git"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (gitFolder != null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (config != null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
gitUrlText = GitHelpers.extractGitUrl(configText);,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"LOG.debug(""Ignoring missing git folders: "" + e, e);",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
Model mavenModel = getMavenModel(context);,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (mavenModel != null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
Scm scm = mavenModel.getScm();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (scm != null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (Strings.isNotBlank(connection)) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
gitUrlText = connection;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"throw new IllegalArgumentException(""Could not find git URL"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return gitUrlText;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"protected void updateConfiguration(UIExecutionContext context, ProjectConfig config) {",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"Map<Object, Object> attributeMap = context.getUIContext().getAttributeMap();",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"Object pipelineValue = attributeMap.get(""pipeline"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (pipelineValue instanceof PipelineDTO) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
PipelineDTO pipeline = (PipelineDTO) pipelineValue;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (pipeline != null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
*  with the License.  You may obtain a copy of the License at,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"*  Unless required by applicable law or agreed to in writing, software",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.api.KubernetesHelper;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.client.DefaultKubernetesClient;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.client.KubernetesClient;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.client.ConfigBuilder;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.utils.Objects;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.utils.Strings;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.utils.TablePrinter;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.projects.ProjectFactory;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.projects.ui.AbstractProjectCommand;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.UIProvider;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.command.UICommand;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.input.UIInput;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.output.UIOutput;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.result.Result;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.result.Results;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import javax.inject.Inject;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import java.io.PrintStream;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
private ProjectFactory projectFactory;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
protected boolean isProjectRequired() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return false;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
},30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
protected ProjectFactory getProjectFactory() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return projectFactory;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (kubernetes == null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (Strings.isNotBlank(kubernetesAddress)) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return kubernetes;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public void setKubernetes(KubernetesClient kubernetes) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
this.kubernetes = kubernetes;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public boolean isGUI() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return getUiProvider().isGUI();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public UIOutput getOutput() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
UIProvider provider = getUiProvider();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return provider != null ? provider.getOutput() : null;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public UIProvider getUiProvider() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return uiProvider;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public void setUiProvider(UIProvider uiProvider) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
this.uiProvider = uiProvider;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public void initializeUI(UIBuilder uiBuilder) throws Exception {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
protected Result tableResults(TablePrinter table) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return Results.success();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public PrintStream getOut() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
UIOutput output = getOutput();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (output != null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return output.out();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return System.out;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return namespace;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public void setNamespace(String namespace) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
AbstractKubernetesCommand.namespace = namespace;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
*  with the License.  You may obtain a copy of the License at,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"*  Unless required by applicable law or agreed to in writing, software",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.api.KubernetesHelper;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.api.model.Pod;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.api.model.PodList;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.client.KubernetesClient;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.context.UIContext;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.input.UICompleter;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.input.UIInput;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.result.Result;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import javax.inject.Inject;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import java.util.ArrayList;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import java.util.Collections;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import java.util.List;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public void initializeUI(UIBuilder builder) throws Exception {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
podId.setCompleter(new UICompleter<String>() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (pods != null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
List<Pod> items = pods.getItems();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (items != null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
for (Pod item : items) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
},30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return list;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public Result execute(UIExecutionContext context) throws Exception {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (podInfo == null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return null;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"protected abstract void executePod(Pod pod, String podId) throws Exception;",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
*  with the License.  You may obtain a copy of the License at,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"*  Unless required by applicable law or agreed to in writing, software",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.api.KubernetesHelper;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.api.model.ReplicationController;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.api.model.ReplicationControllerList;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.context.UIContext;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.input.UICompleter;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.input.UIInput;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.result.Result;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.util.Categories;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.util.Metadata;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import javax.inject.Inject;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import java.util.ArrayList;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import java.util.Collections;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import java.util.List;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public UICommandMetadata getMetadata(UIContext context) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"return Metadata.from(super.getMetadata(context), getClass())",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
},30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public void initializeUI(UIBuilder builder) throws Exception {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
replicationControllerId.setCompleter(new UICompleter<String>() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
ReplicationControllerList replicationControllers = getKubernetes().replicationControllers().inNamespace(getNamespace()).list();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (replicationControllers != null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
List<ReplicationController> items = replicationControllers.getItems();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (items != null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
for (ReplicationController item : items) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return list;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public Result execute(UIExecutionContext context) throws Exception {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (replicationController == null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return null;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
protected void executeReplicationController(ReplicationController replicationController) throws Exception {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"*  2.0 (the ""License""); you may not use this file except in compliance",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
*  with the License.  You may obtain a copy of the License at,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"*  Unless required by applicable law or agreed to in writing, software",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.api.KubernetesHelper;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.api.model.Service;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import io.fabric8.kubernetes.api.model.ServiceList;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.context.UIBuilder;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.context.UIContext;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.input.InputComponent;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.input.UICompleter;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.input.UIInput;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.result.Result;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.util.Categories;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import org.jboss.forge.addon.ui.util.Metadata;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import javax.inject.Inject;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import java.util.ArrayList;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import java.util.Collections;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import java.util.List;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
import static io.fabric8.kubernetes.api.KubernetesHelper.getName;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public UICommandMetadata getMetadata(UIContext context) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"return Metadata.from(super.getMetadata(context), getClass())",30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
},30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public void initializeUI(UIBuilder builder) throws Exception {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
serviceId.setCompleter(new UICompleter<String>() {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (services != null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
List<Service> items = services.getItems();,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (items != null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
for (Service item : items) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return list;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
public Result execute(UIExecutionContext context) throws Exception {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
if (service == null) {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
return null;,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
protected void executeService(Service service) throws Exception {,30ec2c8123f9a4e99aa476580f08f57a626b726a,1,1
"annotationLink(annotations, ""fabric8.link.jenkins.monitor/"", url, ""Monitor"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
"annotationLink(annotations, ""fabric8.link.jenkins.pipeline/"", url, ""Pipeline"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
"annotationLink(annotations, ""fabric8.link.jenkins.job/"", jenkinsJobUrl, ""Job"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
"annotationLink(annotations, ""fabric8.link.taiga/"", taigaLink, taigaProjectLinkLabel);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
"annotationLink(annotations, ""fabric8.link.taiga.team/"", taigaTeamLink, taigaTeamLinkLabel);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
"annotationLink(annotations, ""fabric8.link.releases/"", releasesUrl, releasesLabel);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
"annotationLink(annotations, ""fabric8.link.letschat.room/"", chatRoomLink, letschatRoomLinkLabel);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
"annotationLink(annotations, ""fabric8.link.repository.browse/"", repositoryBrowseLink, repositoryBrowseLabel);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
endStrategy();,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
/**,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
*/,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
namespaceList.add(defaultNamespace);,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
// ignore,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
"addLink(issueTrackerLabel, issueTrackerUrl);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
controller.setNamespace(namespace);,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
"annotations.put(""fabric8.link.jenkins.monitor/url"", url);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"annotations.put(""fabric8.link.jenkins.monitor/label"", label);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"addLink(label, url);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"annotations.put(""fabric8.link.jenkins.pipeline/url"", url);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"annotations.put(""fabric8.link.jenkins.pipeline/label"", label);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"annotations.put(""fabric8.link.jenkins.job/url"", jenkinsJobUrl);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"annotations.put(""fabric8.link.jenkins.job/label"", label);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"addLink(label, jenkinsJobUrl);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"annotations.put(""fabric8.link.taiga/url"", taigaLink);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"annotations.put(""fabric8.link.taiga/label"", taigaProjectLinkLabel);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"addLink(taigaProjectLinkLabel, taigaLink);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"annotations.put(""fabric8.link.taiga.team/url"", taigaTeamLink);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"annotations.put(""fabric8.link.taiga.team/label"", taigaTeamLinkLabel);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"addLink(taigaTeamLinkLabel, taigaTeamLink);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"annotations.put(""fabric8.link.letschat.room/url"", chatRoomLink);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"annotations.put(""fabric8.link.letschat.room/label"", letschatRoomLinkLabel);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"addLink(letschatRoomLinkLabel, chatRoomLink);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
endStrategy();,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
kubernetesClient.pods().inNamespace(namespace).withLabels(replicationController.getSpec().getSelector()).delete();,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
kubernetesClient.replicationControllers().inNamespace(namespace).withName(KubernetesHelper.getName(replicationController)).delete();,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
/**,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  Red Hat licenses this file to you under the Apache License, version",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*  implied.  See the License for the specific language governing,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*  permissions and limitations under the License.,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*/,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
package io.fabric8.workflow.build.signal;,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
* <p/>,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
* {@link BuildSignaller} using the,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
* {@link io.fabric8.kubernetes.api.builds.BuildWatcher} helper class.,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"this(ksession, null);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"watcher.schedule(timer, pollTime);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
timer.cancel();,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
watcher.join();,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
simulator.join();,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
/**,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  Red Hat licenses this file to you under the Apache License, version",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*  implied.  See the License for the specific language governing,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*  permissions and limitations under the License.,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*/,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
package io.fabric8.workflow.build.trigger;,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
this(new DefaultKubernetesClient());,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
@Override,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
uuid.add(Builds.getUid(build));,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
// ignore,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
throw KubernetesClientException.launderThrowable(e);,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).rolling().replace(replicationController);,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
"LOG.info(""ReplicationController hasn't changed so not doing anything"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).delete();,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
kubernetesClient.pods().inNamespace(namespace).withLabels(replicationController.getSpec().getSelector()).delete();,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
"LOG.info(""ReplicationController hasn't changed so not doing anything"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).delete();,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
kubernetesClient.pods().inNamespace(namespace).withLabels(replicationController.getSpec().getSelector()).delete();,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"LOG.info(""ReplicationController hasn't changed so not doing anything"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
newSpec.setReplicas(replicas);,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).rolling().replace(replicationController);,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).delete();,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
kubernetesClient.pods().inNamespace(namespace).withLabels(newSpec.getSelector()).delete();,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,0
kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).rolling().replace(replicationController);,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"LOG.info(""ReplicationController hasn't changed so not doing anything"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
kubernetesClient.replicationControllers().inNamespace(namespace).withName(id).delete();,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
kubernetesClient.pods().inNamespace(namespace).withLabels(replicationController.getSpec().getSelector()).delete();,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
/**,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  Red Hat licenses this file to you under the Apache License, version",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*  implied.  See the License for the specific language governing,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*  permissions and limitations under the License.,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*/,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
package io.fabric8.forge.devops;,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
@Inject,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
/*,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
UIProvider uiProvider;,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
UIInput<String> kubernetesUrl;,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
@Override,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"Objects.notNull(kubernetes, ""kubernetes"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
controller.setThrowExceptionOnError(true);,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"attributeMap.put(Project.class, project);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
* Prints the given table and returns success,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
table.print(getOut());,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"ProjectConfigs.configureProperties(config, attributeMap);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
config.setPipeline(pipeline.getValue());,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
/**,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  Red Hat licenses this file to you under the Apache License, version",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*  implied.  See the License for the specific language governing,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*  permissions and limitations under the License.,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*/,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
package io.fabric8.forge.kubernetes;,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
@Inject,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
/*,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
UIProvider uiProvider;,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
UIInput<String> kubernetesUrl;,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
@Override,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"Objects.notNull(kubernetes, ""kubernetes"");",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
* Prints the given table and returns success,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
table.print(getOut());,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
/**,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  Red Hat licenses this file to you under the Apache License, version",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*  implied.  See the License for the specific language governing,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*  permissions and limitations under the License.,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*/,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
package io.fabric8.forge.kubernetes;,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
@Inject,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
UIInput<String> podId;,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
@Override,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
super.initializeUI(builder);,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
// populate autocompletion options,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
list.add(id);,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
Collections.sort(list);,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
});,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
builder.add(podId);,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"executePod(podInfo, podIdText);",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
/**,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  Red Hat licenses this file to you under the Apache License, version",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*  implied.  See the License for the specific language governing,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*  permissions and limitations under the License.,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*/,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
package io.fabric8.forge.kubernetes;,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
@Inject,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
UIInput<String> replicationControllerId;,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
@Override,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
.category(Categories.create(CATEGORY)),30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
super.initializeUI(builder);,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
// populate autocompletion options,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
list.add(id);,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
Collections.sort(list);,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
});,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
builder.add(replicationControllerId);,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
executeReplicationController(replicationController);,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
getKubernetes().replicationControllers().inNamespace(getNamespace()).withName(KubernetesHelper.getName(replicationController)).delete();,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
/**,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  Red Hat licenses this file to you under the Apache License, version",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*  implied.  See the License for the specific language governing,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*  permissions and limitations under the License.,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
*/,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
package io.fabric8.forge.kubernetes;,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
@Inject,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
UIInput<String> serviceId;,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
@Override,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
.category(Categories.create(CATEGORY)),30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
super.initializeUI(builder);,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
// populate autocompletion options,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
list.add(id);,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
Collections.sort(list);,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
});,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
builder.add(serviceId);,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
executeService(service);,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
getKubernetes().services().inNamespace(getNamespace()).withName(KubernetesHelper.getName(service)).delete();,30ec2c8123f9a4e99aa476580f08f57a626b726a,0,1
"jenkinsUrl = KubernetesHelper.getServiceURL(kubernetes, ServiceNames.JENKINS, KubernetesHelper.defaultNamespace(), ""http"", true);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,5,1
* Looks in the given namespaces for the given service or returns null if it could not be found,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,3,0
"String address = KubernetesHelper.getServiceURL(kubernetes, ServiceNames.JENKINS, namespace, ""http"", false);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,3,1
"String consoleUrl = KubernetesHelper.getServiceURL(kubernetes, ServiceNames.FABRIC8_CONSOLE, namespace, ""http"", true);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,2,1
ListEnvVarBuilder envBuilder = new ListEnvVarBuilder();,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,2,1
jenkinsUrl = getJenkinsServiceUrl();,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,1,0
"String[] defaults = { KubernetesHelper.defaultNamespace(), ""default"" };",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,1,0
"return KubernetesHelper.getServiceURL(getKubernetes(), serviceName, namespace, ""http"", serviceExternal);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,1,0
kubernetes = new DefaultKubernetesClient();,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,1,0
import io.fabric8.kubernetes.api.builders.ListEnvVarBuilder;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,1,1
if (!foundExistingGitUrl && Strings.isNotBlank(gitUrl)) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,1,1
if (Strings.isNotBlank(buildImageStream) && Strings.isNotBlank(buildImageTag)) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,1,1
import io.fabric8.devops.ProjectRepositories;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
import io.fabric8.openshift.api.model.BuildConfig;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
import io.fabric8.openshift.api.model.BuildConfigBuilder;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
import io.fabric8.openshift.api.model.BuildConfigFluent;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
import io.fabric8.utils.Systems;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
import java.util.ArrayList;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
import java.util.Arrays;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
import java.util.HashMap;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
import java.util.List;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
import java.util.Map;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
import java.util.Set;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
private String issueTrackerUrl;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"private String issueTrackerLabel = ""Issues"";",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
private String teamUrl;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"private String teamLabel = ""Team"";",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
private String releasesUrl;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"private String releasesLabel = ""Releases"";",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
private String repositoryBrowseLink;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"private String repositoryBrowseLabel = ""Repository"";",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"private String flowGitUrl = Systems.getEnvVar(""JENKINS_WORKFLOW_GIT_REPOSITORY"", ""https://github.com/fabric8io/jenkins-workflow-library.git"");",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
private String fabric8ConsoleNamespace = KubernetesHelper.defaultNamespace();,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
private String jenkinsNamespace = KubernetesHelper.defaultNamespace();,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"name = ProjectRepositories.createBuildName(username, repoName);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"annotationLink(annotations, ""fabric8.link.jenkins.monitor/"", url, ""Monitor"");",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"annotationLink(annotations, ""fabric8.link.jenkins.pipeline/"", url, ""Pipeline"");",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"annotationLink(annotations, ""fabric8.link.jenkins.job/"", jenkinsJobUrl, ""Job"");",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"if (!annotationLink(annotations, ""fabric8.link.issues/"", issueTrackerUrl, issueTrackerLabel)) {",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"String taigaLink = getProjectPageLink(taiga, taigaProject, this.taigaProjectLinkPage);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"annotationLink(annotations, ""fabric8.link.taiga/"", taigaLink, taigaProjectLinkLabel);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"if (!annotationLink(annotations, ""fabric8.link.team/"", teamUrl, teamLabel)) {",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"String taigaTeamLink = getProjectPageLink(taiga, taigaProject, this.taigaTeamLinkPage);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"annotationLink(annotations, ""fabric8.link.taiga.team/"", taigaTeamLink, taigaTeamLinkLabel);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"annotationLink(annotations, ""fabric8.link.releases/"", releasesUrl, releasesLabel);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"annotationLink(annotations, ""fabric8.link.letschat.room/"", chatRoomLink, letschatRoomLinkLabel);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"annotationLink(annotations, ""fabric8.link.repository.browse/"", repositoryBrowseLink, repositoryBrowseLabel);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"String consoleUrl = getServiceUrl(ServiceNames.FABRIC8_CONSOLE, namespace, fabric8ConsoleNamespace);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
endStrategy();,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
protected String getJenkinsServiceUrl() {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"return getServiceUrl(ServiceNames.JENKINS, namespace, jenkinsNamespace);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
},ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
/**,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
*/,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"protected String getServiceUrl(String serviceName, String... namespaces) {",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"return getServiceUrl(serviceName, true, namespaces);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"private String getServiceUrl(String serviceName, boolean serviceExternal, String... namespaces) {",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
List<String> namespaceList = new ArrayList<>(Arrays.asList(namespaces));,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
for (String defaultNamespace : defaults) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
if (namespaceList.contains(defaultNamespace)) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
namespaceList.add(defaultNamespace);,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
for (String namespace : namespaceList) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
try {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
} catch (Exception e) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
// ignore,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
return null;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"protected boolean annotationLink(Map<String, String> annotations, String annotationPrefix, String issueTrackerUrl, String issueTrackerLabel) {",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
if (Strings.isNotBlank(issueTrackerUrl)) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"annotations.put(annotationPrefix + ""url"", issueTrackerUrl);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"annotations.put(annotationPrefix + ""label"", issueTrackerLabel);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"addLink(issueTrackerLabel, issueTrackerUrl);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
return true;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
} else {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
return false;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
if (kubernetes == null) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
return kubernetes;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
public String getFabric8ConsoleNamespace() {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
return fabric8ConsoleNamespace;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
public void setFabric8ConsoleNamespace(String fabric8ConsoleNamespace) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
this.fabric8ConsoleNamespace = fabric8ConsoleNamespace;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
public String getJenkinsNamespace() {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
return jenkinsNamespace;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
public void setJenkinsNamespace(String jenkinsNamespace) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
this.jenkinsNamespace = jenkinsNamespace;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
public String getIssueTrackerLabel() {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
return issueTrackerLabel;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
public void setIssueTrackerLabel(String issueTrackerLabel) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
this.issueTrackerLabel = issueTrackerLabel;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
public String getIssueTrackerUrl() {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
return issueTrackerUrl;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
public void setIssueTrackerUrl(String issueTrackerUrl) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
this.issueTrackerUrl = issueTrackerUrl;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
public String getTeamUrl() {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
return teamUrl;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
public void setTeamUrl(String teamUrl) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
this.teamUrl = teamUrl;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
public String getTeamLabel() {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
return teamLabel;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
public void setTeamLabel(String teamLabel) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
this.teamLabel = teamLabel;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
public String getReleasesUrl() {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
return releasesUrl;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
public void setReleasesUrl(String releasesUrl) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
this.releasesUrl = releasesUrl;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
public String getReleasesLabel() {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
return releasesLabel;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
public void setReleasesLabel(String releasesLabel) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
this.releasesLabel = releasesLabel;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
public String getRepositoryBrowseLabel() {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
return repositoryBrowseLabel;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
public void setRepositoryBrowseLabel(String repositoryBrowseLabel) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
this.repositoryBrowseLabel = repositoryBrowseLabel;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
public String getRepositoryBrowseLink() {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
return repositoryBrowseLink;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
public void setRepositoryBrowseLink(String repositoryBrowseLink) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
this.repositoryBrowseLink = repositoryBrowseLink;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
controller.setNamespace(namespace);,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"String address = getServiceUrl(ServiceNames.JENKINS, false, namespace, jenkinsNamespace);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
import io.fabric8.kubernetes.api.model.EnvVar;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
import io.fabric8.openshift.client.OpenShiftClient;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
import io.fabric8.openshift.api.model.*;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
import java.util.*;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"private String flowGitUrl = System.getenv(""JENKINS_WORKFLOW_GIT_REPOSITORY"");",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
name = repoName;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
if (Strings.isNotBlank(username)) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"name = username + ""-"" + name;",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
},ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"annotations.put(""fabric8.link.jenkins.monitor/url"", url);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"String label = ""Monitor"";",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"annotations.put(""fabric8.link.jenkins.monitor/label"", label);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"addLink(label, url);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"annotations.put(""fabric8.link.jenkins.pipeline/url"", url);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"String label = ""Pipeline"";",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"annotations.put(""fabric8.link.jenkins.pipeline/label"", label);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"annotations.put(""fabric8.link.jenkins.job/url"", jenkinsJobUrl);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"String label = ""Job"";",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"annotations.put(""fabric8.link.jenkins.job/label"", label);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"addLink(label, jenkinsJobUrl);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"String taigaLink = getProjectPageLink(taiga, taigaProject, this.taigaProjectLinkPage);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
if (Strings.isNotBlank(taigaLink)) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"annotations.put(""fabric8.link.taiga/url"", taigaLink);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"annotations.put(""fabric8.link.taiga/label"", taigaProjectLinkLabel);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"addLink(taigaProjectLinkLabel, taigaLink);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"String taigaTeamLink = getProjectPageLink(taiga, taigaProject, this.taigaTeamLinkPage);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
if (Strings.isNotBlank(taigaTeamLink)) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"annotations.put(""fabric8.link.taiga.team/url"", taigaTeamLink);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"annotations.put(""fabric8.link.taiga.team/label"", taigaTeamLinkLabel);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"addLink(taigaTeamLinkLabel, taigaTeamLink);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
if (Strings.isNotBlank(chatRoomLink)) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"annotations.put(""fabric8.link.letschat.room/url"", chatRoomLink);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"annotations.put(""fabric8.link.letschat.room/label"", letschatRoomLinkLabel);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"addLink(letschatRoomLinkLabel, chatRoomLink);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
endStrategy();,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
return new DefaultKubernetesClient();,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
import io.fabric8.kubernetes.api.builds.Builds;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
private String secret = Builds.DEFAULT_SECRET;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
private String buildImageStream = Builds.DEFAULT_BUILD_IMAGE_STREAM;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
private String buildImageTag = Builds.DEFAULT_IMAGE_TAG;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
private String s2iCustomBuilderImage = Builds.DEFAULT_CUSTOM_BUILDER_IMAGE;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"log.info(""gitUrl is: "" + gitUrl);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
"Builds.configureDefaultBuildConfig(buildConfig, name, gitUrl, foundExistingGitUrl, buildImageStream, buildImageTag, s2iCustomBuilderImage, secret, jenkinsUrl);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,0
import io.fabric8.kubernetes.api.model.ObjectReferenceBuilder;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
import io.fabric8.openshift.api.model.BuildStrategy;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
import io.fabric8.openshift.api.model.BuildTriggerPolicy;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
import io.fabric8.openshift.api.model.BuildTriggerPolicyBuilder;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
import io.fabric8.openshift.api.model.CustomBuildStrategy;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
import java.util.concurrent.Future;,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"private String secret = ""secret101"";",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"private String buildImageStream = ""triggerJenkins"";",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"private String buildImageTag = ""latest"";",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"private String s2iCustomBuilderImage = ""fabric8/openshift-s2i-jenkins-trigger"";",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
BuildConfigSpec spec = buildConfig.getSpec();,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
if (spec == null) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
spec = new BuildConfigSpec();,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
buildConfig.setSpec(spec);,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
},ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"log.info(""gitUrl is: "" + gitUrl);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
BuildSource source = spec.getSource();,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
if (source == null) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
source = new BuildSource();,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
spec.setSource(source);,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"source.setType(""Git"");",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
GitBuildSource git = source.getGit();,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
if (git == null) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
git = new GitBuildSource();,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
source.setGit(git);,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
git.setUri(gitUrl);,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
BuildStrategy strategy = spec.getStrategy();,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
if (strategy == null) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
strategy = new BuildStrategy();,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
spec.setStrategy(strategy);,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
// TODO only do this if we are using Jenkins?,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"strategy.setType(""Custom"");",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
CustomBuildStrategy customStrategy = strategy.getCustomStrategy();,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
if (customStrategy == null) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
customStrategy = new CustomBuildStrategy();,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
strategy.setCustomStrategy(customStrategy);,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"envBuilder.withEnvVar(""BASE_URI"", jenkinsUrl);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"envBuilder.withEnvVar(""JOB_NAME"", name);",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
customStrategy.setEnv(envBuilder.build());,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"customStrategy.setFrom(new ObjectReferenceBuilder().withKind(""DockerImage"").withName(s2iCustomBuilderImage).build());",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
List<BuildTriggerPolicy> triggers = spec.getTriggers();,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
if (triggers.isEmpty()) {,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"triggers.add(new BuildTriggerPolicyBuilder().withType(""GitHub"").withNewGithub().withSecret(secret).endGithub().build());",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"triggers.add(new BuildTriggerPolicyBuilder().withType(""Generic"").withNewGeneric().withSecret(secret).endGeneric().build());",ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
spec.setTriggers(triggers);,ce77065a0ced98b591ac771b46fe4c5ea7ec68b6,0,1
"System.out.println(""Created config "" + config.getBuildName() + "" with flow "" + config.getPipeline());",182b509e943a15402d9cfa7592c3a255eec1f7af,7,0
"System.out.println(""Created config "" + config.getBuildName() + "" with flow "" + config.getFlow());",182b509e943a15402d9cfa7592c3a255eec1f7af,7,1
String flow = config != null ? config.getPipeline() : null;,182b509e943a15402d9cfa7592c3a255eec1f7af,4,0
String flow = config != null ? config.getFlow() : null;,182b509e943a15402d9cfa7592c3a255eec1f7af,4,1
String flow = projectConfig.getPipeline();,182b509e943a15402d9cfa7592c3a255eec1f7af,2,0
} else {,182b509e943a15402d9cfa7592c3a255eec1f7af,2,0
String flow = projectConfig.getFlow();,182b509e943a15402d9cfa7592c3a255eec1f7af,2,1
"getLog().info(""Not creating Jenkins job as no pipeline defined for project configuration!"");",182b509e943a15402d9cfa7592c3a255eec1f7af,1,0
import java.util.Set;,182b509e943a15402d9cfa7592c3a255eec1f7af,1,1
"config.setPipeline(""maven/Deploy.groovy"");",182b509e943a15402d9cfa7592c3a255eec1f7af,0,0
"config.setFlow(""maven/Deploy.groovy"");",182b509e943a15402d9cfa7592c3a255eec1f7af,0,1
"addLink(""Git"", getGitUrl());",182b509e943a15402d9cfa7592c3a255eec1f7af,0,0
"return getServiceUrl(ServiceNames.JENKINS, false, namespace, jenkinsNamespace);",182b509e943a15402d9cfa7592c3a255eec1f7af,0,0
"return getServiceUrl(serviceName, false, namespaces);",182b509e943a15402d9cfa7592c3a255eec1f7af,0,0
"return getServiceUrl(ServiceNames.JENKINS, namespace, jenkinsNamespace);",182b509e943a15402d9cfa7592c3a255eec1f7af,0,1
"return getServiceUrl(serviceName, true, namespaces);",182b509e943a15402d9cfa7592c3a255eec1f7af,0,1
"protected void addLabelIntoObjects(List<HasMetadata> objects, String label, String value) {",f98f985fe79f75db00fae124ad3d65d8553df857,3,0
"protected boolean addLabelIfNotExist(HasMetadata object, String label, String value) {",f98f985fe79f75db00fae124ad3d65d8553df857,3,0
String templateName = getProjectName();,f98f985fe79f75db00fae124ad3d65d8553df857,2,0
final PodTemplateSpec template = spec.getTemplate();,f98f985fe79f75db00fae124ad3d65d8553df857,2,0
HasMetadata hasMetadata = new HasMetadata() {,f98f985fe79f75db00fae124ad3d65d8553df857,2,0
public String getKind() {,f98f985fe79f75db00fae124ad3d65d8553df857,2,0
for (HasMetadata object : objects) {,f98f985fe79f75db00fae124ad3d65d8553df857,1,0
if (object instanceof ReplicationController) {,f98f985fe79f75db00fae124ad3d65d8553df857,1,0
ReplicationController entity = (ReplicationController) object;,f98f985fe79f75db00fae124ad3d65d8553df857,1,0
ReplicationControllerSpec spec = entity.getSpec();,f98f985fe79f75db00fae124ad3d65d8553df857,1,0
if (spec != null) {,f98f985fe79f75db00fae124ad3d65d8553df857,1,0
if (template != null) {,f98f985fe79f75db00fae124ad3d65d8553df857,1,0
public ObjectMeta getMetadata() {,f98f985fe79f75db00fae124ad3d65d8553df857,1,0
public void setMetadata(ObjectMeta objectMeta) {,f98f985fe79f75db00fae124ad3d65d8553df857,1,0
if (object != null) {,f98f985fe79f75db00fae124ad3d65d8553df857,1,0
"Map<String, String> labels = KubernetesHelper.getOrCreateLabels(object);",f98f985fe79f75db00fae124ad3d65d8553df857,1,0
if (labels.get(label) == null) {,f98f985fe79f75db00fae124ad3d65d8553df857,1,0
"setName(template, templateName);",f98f985fe79f75db00fae124ad3d65d8553df857,0,0
"addLabelIntoObjects(template.getObjects(), ""group"", templateName);",f98f985fe79f75db00fae124ad3d65d8553df857,0,0
"addLabelIfNotExist(object, label, value);",f98f985fe79f75db00fae124ad3d65d8553df857,0,0
// TODO hack until this is fixed https://github.com/fabric8io/kubernetes-model/issues/112,f98f985fe79f75db00fae124ad3d65d8553df857,0,0
@Override,f98f985fe79f75db00fae124ad3d65d8553df857,0,0
return template.getMetadata();,f98f985fe79f75db00fae124ad3d65d8553df857,0,0
},f98f985fe79f75db00fae124ad3d65d8553df857,0,0
template.setMetadata(objectMeta);,f98f985fe79f75db00fae124ad3d65d8553df857,0,0
"return ""PodTemplateSpec"";",f98f985fe79f75db00fae124ad3d65d8553df857,0,0
};,f98f985fe79f75db00fae124ad3d65d8553df857,0,0
"addLabelIfNotExist(hasMetadata, label, value);",f98f985fe79f75db00fae124ad3d65d8553df857,0,0
"labels.put(label, value);",f98f985fe79f75db00fae124ad3d65d8553df857,0,0
return true;,f98f985fe79f75db00fae124ad3d65d8553df857,0,0
return false;,f98f985fe79f75db00fae124ad3d65d8553df857,0,0
"setName(template, getProjectName());",f98f985fe79f75db00fae124ad3d65d8553df857,0,1
return objectMapper.readerFor(clazz).readValue(json);,1077f3fbcb6a98bb9c709a88eaf851361a780599,1,1
return objectMapper.writer().writeValueAsString(object);,1077f3fbcb6a98bb9c709a88eaf851361a780599,1,1
/**,1077f3fbcb6a98bb9c709a88eaf851361a780599,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",1077f3fbcb6a98bb9c709a88eaf851361a780599,0,1
*,1077f3fbcb6a98bb9c709a88eaf851361a780599,0,1
"*  Red Hat licenses this file to you under the Apache License, version",1077f3fbcb6a98bb9c709a88eaf851361a780599,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",1077f3fbcb6a98bb9c709a88eaf851361a780599,0,1
*  with the License.  You may obtain a copy of the License at,1077f3fbcb6a98bb9c709a88eaf851361a780599,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,1077f3fbcb6a98bb9c709a88eaf851361a780599,0,1
"*  Unless required by applicable law or agreed to in writing, software",1077f3fbcb6a98bb9c709a88eaf851361a780599,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",1077f3fbcb6a98bb9c709a88eaf851361a780599,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",1077f3fbcb6a98bb9c709a88eaf851361a780599,0,1
*  implied.  See the License for the specific language governing,1077f3fbcb6a98bb9c709a88eaf851361a780599,0,1
*  permissions and limitations under the License.,1077f3fbcb6a98bb9c709a88eaf851361a780599,0,1
*/,1077f3fbcb6a98bb9c709a88eaf851361a780599,0,1
package io.fabric8.docker.api;,1077f3fbcb6a98bb9c709a88eaf851361a780599,0,1
import com.fasterxml.jackson.databind.ObjectMapper;,1077f3fbcb6a98bb9c709a88eaf851361a780599,0,1
import java.io.IOException;,1077f3fbcb6a98bb9c709a88eaf851361a780599,0,1
public class JsonHelper {,1077f3fbcb6a98bb9c709a88eaf851361a780599,0,1
private static ObjectMapper objectMapper = new ObjectMapper();,1077f3fbcb6a98bb9c709a88eaf851361a780599,0,1
"public static <T> T fromJson(String json, Class<T> clazz) throws IOException {",1077f3fbcb6a98bb9c709a88eaf851361a780599,0,1
},1077f3fbcb6a98bb9c709a88eaf851361a780599,0,1
public static String toJson(Object object) throws IOException {,1077f3fbcb6a98bb9c709a88eaf851361a780599,0,1
import java.util.List;,e2ab3d033df9943e996529dbcce7564d8de4262a,1,1
import lombok.Data;,e2ab3d033df9943e996529dbcce7564d8de4262a,1,1
import lombok.EqualsAndHashCode;,e2ab3d033df9943e996529dbcce7564d8de4262a,1,1
import com.fasterxml.jackson.annotation.JsonProperty;,e2ab3d033df9943e996529dbcce7564d8de4262a,1,1
/**,e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
*,e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
"*  Red Hat licenses this file to you under the Apache License, version",e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
*  with the License.  You may obtain a copy of the License at,e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
"*  Unless required by applicable law or agreed to in writing, software",e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
*  implied.  See the License for the specific language governing,e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
*  permissions and limitations under the License.,e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
*/,e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
package io.fabric8.docker.api;,e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
@Data,e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
@EqualsAndHashCode(callSuper=false),e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
public class Info extends AbstractDockerDTO {,e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
private boolean debug;,e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
private int containers;,e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
private int images;,e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
private String driver;,e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
private List<List<String>> driverStatus;,e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
"@JsonProperty(""NFd"")",e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
private int nFd;,e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
"@JsonProperty(""NGoroutines"")",e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
private int nGoroutines;,e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
"@JsonProperty(""IPv4Forwarding"")",e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
private boolean iPV4Forwarding;,e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
"@JsonProperty(""LXCVersion"")",e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
private String lXCVersion;,e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
"@JsonProperty(""NEventsListener"")",e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
private int nEventsListener;,e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
private String kernelVersion;,e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
private String indexServerAddress;,e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
private boolean memoryLimit;,e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
private boolean swapLimit;,e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
},e2ab3d033df9943e996529dbcce7564d8de4262a,0,1
"getLog().warn(""Not adding annotation `"" + annotation + ""` to "" + KubernetesHelper.getKind(resource) + "" "" + KubernetesHelper.getName(resource) + "" with value `"" + value + ""` as there is already an annotation value of `"" + oldValue + ""`"");",e94e2d25dac04477fb1e3a6cc77f3744efb08756,14,0
"getLog().warn(""Not adding annotation `"" + annotation + ""` to "" + KubernetesHelper.getKind(resource) + "" "" + KubernetesHelper.getName(resource) + "" with value `"" + value + ""` as there is already an annotation value of `"" + oldValue + ""`"");",e94e2d25dac04477fb1e3a6cc77f3744efb08756,14,1
"getLog().warn(""Failed to find git url in directory "" + basedir + "". "" + e, e);",e94e2d25dac04477fb1e3a6cc77f3744efb08756,7,0
"getLog().warn(""Cannot auto-default GIT_URL as there is no environment variable `"" + userEnvVar + ""` defined so we can't guess the Gogs build URL"");",e94e2d25dac04477fb1e3a6cc77f3744efb08756,4,0
"getLog().warn(""Failed to find git commit id. "" + e, e);",e94e2d25dac04477fb1e3a6cc77f3744efb08756,4,0
"getLog().warn(""failed to find git commit id. "" + e, e);",e94e2d25dac04477fb1e3a6cc77f3744efb08756,4,1
"getLog().warn(""Cannot auto-default BUILD_URL as there is no environment variable `"" + userEnvVar + ""` defined so we can't guess the Jenkins build URL"");",e94e2d25dac04477fb1e3a6cc77f3744efb08756,3,0
"getLog().warn(""Could not find BUILD_ID to create a specific jenkins build URL. So using: "" + jobUrl);",e94e2d25dac04477fb1e3a6cc77f3744efb08756,3,0
"getLog().debug(""Cannot connect to Kubernetes due: "" + cause.getMessage());",e94e2d25dac04477fb1e3a6cc77f3744efb08756,3,0
"throw new MojoExecutionException(""Cannot find resource `"" + resourceName + ""` on the classpath!"");",e94e2d25dac04477fb1e3a6cc77f3744efb08756,3,0
"getLog().warn(""Cannot find BUILD_ID to create a specific jenkins build URL. So using: "" + jobUrl);",e94e2d25dac04477fb1e3a6cc77f3744efb08756,3,0
"getLog().warn(""Cannot connect to Kubernetes to find jenkins service URL: "" + cause.getMessage());",e94e2d25dac04477fb1e3a6cc77f3744efb08756,3,0
"getLog().warn(""Cannot connect to Kubernetes to find gogs service URL: "" + cause.getMessage());",e94e2d25dac04477fb1e3a6cc77f3744efb08756,3,0
"getLog().warn(""Cannot create default value for $"" + envVarName + "" as no .git/config file could be found"");",e94e2d25dac04477fb1e3a6cc77f3744efb08756,3,0
"getLog().debug(""Current properties "" + new TreeSet<>(properties.keySet()));",e94e2d25dac04477fb1e3a6cc77f3744efb08756,3,0
"throw new MojoExecutionException(""Could not find resource `"" + resourceName + ""` on the classpath!"");",e94e2d25dac04477fb1e3a6cc77f3744efb08756,3,1
"getLog().warn(""Could not find BUILD_ID to create a specific jenkins build URL. So using: "" + jobUrl);",e94e2d25dac04477fb1e3a6cc77f3744efb08756,3,1
"getLog().debug(""Cannot connect to Kubernetes due: "" + cause.getMessage());",e94e2d25dac04477fb1e3a6cc77f3744efb08756,3,1
"getLog().warn(""Could not create default value for $"" + envVarName + "" as no .git/config file could be found"");",e94e2d25dac04477fb1e3a6cc77f3744efb08756,3,1
"getLog().debug(""current properties "" + new TreeSet<>(properties.keySet()));",e94e2d25dac04477fb1e3a6cc77f3744efb08756,3,1
String value = Systems.getEnvVarOrSystemProperty(envVar);,e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
String oldValue = annotations.get(annotation);,e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
} else {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
protected String tryDefaultAnnotationEnvVar(String envVarName) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
File basedir = rootProject.getBasedir();,e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
String repoName = rootProject.getArtifactId();,e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
"String userEnvVar = ""JENKINS_GOGS_USER"";",e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
String username = Systems.getEnvVarOrSystemProperty(userEnvVar);,e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
"String jobUrl = projectConfig.getLink(""Job"");",e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
String name = projectConfig.getBuildName();,e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
"String jenkinsUrl = KubernetesHelper.getServiceURLInCurrentNamespace(getKubernetes(), ServiceNames.JENKINS, ""http"", null, true);",e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
"String buildId = Systems.getEnvVarOrSystemProperty(""BUILD_ID"");",e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
} catch (Exception e) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
"getLog().warn(""Could not find jenkins service URL: "" + e, e);",e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
"String gogsUrl = KubernetesHelper.getServiceURLInCurrentNamespace(getKubernetes(), ServiceNames.GOGS, ""http"", null, true);",e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
"getLog().warn(""Could not find gogs service URL: "" + e, e);",e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
TODO this is the git clone url; while we could try convert from it to a browse URL its probably too flaky?,e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
url = GitHelpers.extractGitUrl(basedir);,e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
} catch (IOException e) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
String value = Systems.getEnvVarOrSystemProperty(envVar);,e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,1
String oldValue = annotations.get(annotation);,e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,1
} else {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,1
} catch (Throwable e) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
} else {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
"getLog().warn(""Could not find gogs service URL: "" + cause, cause);",e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
protected static Iterable<Throwable> createExceptionIterable(Throwable exception) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
} catch (Exception e) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,1
"getLog().warn(""Could not find jenkins service URL: "" + e, e);",e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,1
"getLog().warn(""Could not find gogs service URL: "" + e, e);",e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,1
"getLog().warn(""Cannot find jenkins service URL: "" + cause, cause);",e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
"getLog().warn(""Cannot find gogs service URL: "" + cause, cause);",e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,0
"getLog().warn(""Could not find gogs service URL: "" + cause, cause);",e94e2d25dac04477fb1e3a6cc77f3744efb08756,2,1
if (Strings.isNotBlank(envVar) && Strings.isNotBlank(annotation)) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
if (Strings.isNullOrBlank(value)) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
value = tryDefaultAnnotationEnvVar(envVar);,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
},e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
if (Strings.isNotBlank(value)) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
if (Strings.isNotBlank(oldValue)) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
* This can happen if using Jenkins Workflow which doens't seem to define BUILD_URL or GIT_URL for example,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
MavenProject rootProject = getRootProject();,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
ProjectConfig projectConfig = ProjectConfigs.loadFromFolder(basedir);,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
"if (Objects.equal(""BUILD_URL"", envVarName)) {",e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
if (Strings.isNullOrBlank(jobUrl)) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
if (Strings.isNullOrBlank(name)) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
// lets try deduce the jenkins build name we'll generate,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
if (Strings.isNotBlank(repoName)) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
name = repoName;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
if (Strings.isNotBlank(username)) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
"name = ProjectRepositories.createBuildName(username, repoName);",e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
if (Strings.isNotBlank(name)) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
try {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
"jobUrl = URLUtils.pathJoin(jenkinsUrl, ""/job"", name);",e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
if (Strings.isNotBlank(buildId)) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
"jobUrl = URLUtils.pathJoin(jobUrl, buildId);",e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
"if (Objects.equal(""GIT_URL"", envVarName)) {",e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
if (Strings.isNotBlank(repoName) && Strings.isNotBlank(username)) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
if (Strings.isNotBlank(url)) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
protected MavenProject getRootProject() {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
MavenProject project = getProject();,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
while (project != null) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
MavenProject parent = project.getParent();,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
if (parent == null) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
project = parent;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
if (Strings.isNotBlank(value)) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,1
if (Strings.isNotBlank(oldValue)) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,1
Throwable cause = e;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
boolean connectError = false;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
Iterable<Throwable> it = createExceptionIterable(e);,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
for (Throwable t : it) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
"connectError = t instanceof ConnectException || ""No route to host"".equals(t.getMessage());",e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
if (connectError) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
cause = t;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
},e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
List<Throwable> throwables = new ArrayList<Throwable>();,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
Throwable current = exception;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
while (current != null) {,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
current = current.getCause();,e94e2d25dac04477fb1e3a6cc77f3744efb08756,1,0
import io.fabric8.devops.ProjectConfig;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import io.fabric8.devops.ProjectConfigs;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import io.fabric8.devops.ProjectRepositories;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import io.fabric8.kubernetes.api.ServiceNames;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import io.fabric8.utils.GitHelpers;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import io.fabric8.utils.URLUtils;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import java.io.ByteArrayInputStream;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import java.io.File;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import java.io.FileInputStream;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import java.io.FileOutputStream;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import java.io.FilenameFilter;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import java.io.IOException;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import java.io.InputStream;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import java.util.ArrayList;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import java.util.Arrays;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import java.util.Collection;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import java.util.HashMap;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import java.util.LinkedHashSet;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import java.util.List;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import java.util.Locale;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import java.util.Map;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import java.util.Properties;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import java.util.Set;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import java.util.TreeSet;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
"annotations.put(annotation, value);",e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
/**,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
* Tries to default some environment variables if they are not already defined.,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
*,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
* @return the value of the environment variable name if it can be found or calculated,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
*/,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
return jobUrl;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
"return URLUtils.pathJoin(gogsUrl, username, repoName);",e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
/*,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
// for gogs / github style repos we trim the .git suffix for browsing,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
"return Strings.stripSuffix(url, "".git"");",e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
return null;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
* Returns the root project folder,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
break;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
return project;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import io.fabric8.kubernetes.api.model.ObjectMeta;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import java.io.*;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import java.util.*;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
"annotations.put(annotation, value);",e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import java.net.ConnectException;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import java.util.Collections;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import java.util.Iterator;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import io.fabric8.devops.ProjectConfig;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import io.fabric8.devops.ProjectConfigs;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import io.fabric8.devops.ProjectRepositories;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import io.fabric8.kubernetes.api.KubernetesHelper;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import io.fabric8.kubernetes.api.ServiceNames;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import io.fabric8.kubernetes.api.model.HasMetadata;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import io.fabric8.kubernetes.api.model.KubernetesList;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import io.fabric8.kubernetes.api.model.ReplicationController;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import io.fabric8.maven.support.JsonSchema;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import io.fabric8.maven.support.JsonSchemas;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import io.fabric8.openshift.api.model.DeploymentConfig;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import io.fabric8.openshift.api.model.Template;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import io.fabric8.utils.Files;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import io.fabric8.utils.Objects;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import io.fabric8.utils.Strings;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import io.fabric8.utils.Systems;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import io.fabric8.utils.URLUtils;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import org.apache.maven.artifact.Artifact;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import org.apache.maven.plugin.MojoExecutionException;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import org.apache.maven.plugins.annotations.Parameter;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import org.apache.maven.project.MavenProject;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import org.eclipse.jgit.lib.ObjectId;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import org.eclipse.jgit.lib.Repository;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import org.eclipse.jgit.storage.file.FileRepositoryBuilder;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
// this requires online access to kubernetes so we should silently fail if no connection,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
break;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
/**,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
* Creates an Iterable to walk the exception from the bottom up,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
* (the last caused by going upwards to the root exception).,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
*,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
* @see java.lang.Iterable,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
* @param exception  the exception,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
* @return the Iterable,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
*/,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
// spool to the bottom of the caused by tree,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
throwables.add(current);,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
Collections.reverse(throwables);,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
return throwables;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import io.fabric8.devops.ProjectConfig;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import io.fabric8.devops.ProjectConfigs;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import io.fabric8.devops.ProjectRepositories;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import io.fabric8.kubernetes.api.KubernetesHelper;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import io.fabric8.kubernetes.api.ServiceNames;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import io.fabric8.kubernetes.api.model.HasMetadata;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import io.fabric8.kubernetes.api.model.KubernetesList;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import io.fabric8.kubernetes.api.model.ReplicationController;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import io.fabric8.maven.support.JsonSchema;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import io.fabric8.maven.support.JsonSchemas;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import io.fabric8.openshift.api.model.DeploymentConfig;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import io.fabric8.openshift.api.model.Template;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import io.fabric8.utils.Files;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import io.fabric8.utils.GitHelpers;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import io.fabric8.utils.Objects;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import io.fabric8.utils.Strings;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import io.fabric8.utils.Systems;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import io.fabric8.utils.URLUtils;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import org.apache.maven.artifact.Artifact;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import org.apache.maven.plugin.MojoExecutionException;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import org.apache.maven.plugins.annotations.Parameter;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import org.apache.maven.project.MavenProject;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import org.eclipse.jgit.lib.ObjectId;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import org.eclipse.jgit.lib.Repository;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
import org.eclipse.jgit.storage.file.FileRepositoryBuilder;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
"getLog().info(""Added environment annotations:"");",e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,0
import java.util.Iterator;,e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
"getLog().info(""Added enviroment annotations:"");",e94e2d25dac04477fb1e3a6cc77f3744efb08756,0,1
private String namespace = KubernetesHelper.defaultNamespace();,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,5,1
String namespace = null;,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,3,0
private String namespace;,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,2,0
"@Parameter(property = ""fabric8.environment"")",ff16ca8db52a87c49d786f1feb925c7f7660f5b7,2,0
private String environment;,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,2,0
namespace = getNamespaceForEnvironment(environment);,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,2,0
namespace = environments.get(environment);,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,2,0
"String envVarName = environment.toUpperCase() + ""_NAMESPACE"";",ff16ca8db52a87c49d786f1feb925c7f7660f5b7,2,0
namespace = Systems.getEnvVarOrSystemProperty(envVarName);,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,2,0
"throw new IllegalStateException(""Could not find namespace for environment `"" + environment",ff16ca8db52a87c49d786f1feb925c7f7660f5b7,2,0
"getLog().info(""Mapping environment `"" + environment + ""` to namespace `"" + namespace + ""`"");",ff16ca8db52a87c49d786f1feb925c7f7660f5b7,2,0
"basedir = new File(System.getProperty(""basedir"", "".""));",ff16ca8db52a87c49d786f1feb925c7f7660f5b7,2,0
import io.fabric8.devops.ProjectConfig;,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
import io.fabric8.devops.ProjectConfigs;,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
import io.fabric8.utils.Systems;,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
import org.apache.maven.plugin.MojoExecutionException;,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
import org.apache.maven.project.MavenProject;,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
import java.io.File;,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
import java.util.LinkedHashMap;,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
* otherwise lets look for environment variables or return null,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
protected String getNamespaceForEnvironment(String environment) throws IllegalStateException {,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
ProjectConfig projectConfig = findProjectConfig();,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
"LinkedHashMap<String, String> environments = projectConfig.getEnvironments();",ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
// lets try find an environment variable or system property,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
return namespace;,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
MavenProject rootProject = getRootProject();,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
File basedir = null;,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
basedir = rootProject.getBasedir();,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
MavenProject project = getProject();,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
basedir = project.getBasedir();,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
return ProjectConfigs.loadFromFolder(basedir);,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
return null;,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
File answer = null;,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
File basedir = project.getBasedir();,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
answer = basedir;,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
project = project.getParent();,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
return answer;,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
MavenProject parent = project.getParent();,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
project = parent;,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
return project;,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,1,0
if (Strings.isNullOrBlank(namespace)) {,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,0,0
if (Strings.isNotBlank(environment)) {,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,0,0
},ff16ca8db52a87c49d786f1feb925c7f7660f5b7,0,0
/**,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,0,0
* Lets look in the fabric8.yml file if it exists and find the environment name from it,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,0,0
*/,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,0,0
if (projectConfig != null) {,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,0,0
if (environments != null) {,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,0,0
"+ ""` by looking for a fabric8.yml file and at environment variable $"" + envVarName);",ff16ca8db52a87c49d786f1feb925c7f7660f5b7,0,0
if (Strings.isNotBlank(namespace)) {,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,0,0
* Returns the configuration of the project in the <code>fabric8.yml</code> file in the root project or current directory,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,0,0
* or returns an empty configuraiton,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,0,0
protected ProjectConfig findProjectConfig() {,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,0,0
if (rootProject != null) {,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,0,0
if (basedir == null) {,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,0,0
if (project != null) {,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,0,0
public MavenProject getProject() {,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,0,0
* Returns the root project folder,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,0,0
protected File getRootProjectFolder() {,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,0,0
while (project != null) {,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,0,0
if (basedir != null) {,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,0,0
protected MavenProject getRootProject() {,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,0,0
if (parent == null) {,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,0,0
break;,ff16ca8db52a87c49d786f1feb925c7f7660f5b7,0,0
"String msg = ""The fabric8.service.name: "" + name + "" is being limited to max 24 chars as that is required by Kubernetes/Openshift.""",a8f0906d7539780418289bfc609c8ea410aa3717,7,1
"@WithAttributes(label = ""Test classes"", required = false, defaultValue = ""true"", description = ""Include test dependencies"")",a8f0906d7539780418289bfc609c8ea410aa3717,4,1
"@WithAttributes(label = ""Maven Fabric8 Profiles"", required = false, defaultValue = ""true"", description = ""Include Maven fabric8 profiles for easily building and deploying"")",a8f0906d7539780418289bfc609c8ea410aa3717,4,1
"@WithAttributes(label = ""Docker Organization"", required = true, description = ""The Docker organization/company"")",a8f0906d7539780418289bfc609c8ea410aa3717,3,1
"@WithAttributes(label = ""Docker Image From"", required = true, description = ""The Docker image to use as base line"")",a8f0906d7539780418289bfc609c8ea410aa3717,3,1
"@WithAttributes(label = ""Container label"", required = false, description = ""Container label to use for the app"")",a8f0906d7539780418289bfc609c8ea410aa3717,3,1
"@WithAttributes(label = ""Group label"", required = false, description = ""Group label to use for the app"")",a8f0906d7539780418289bfc609c8ea410aa3717,3,1
"@WithAttributes(label = ""Icon"", required = false, description = ""Icon to use for the app"")",a8f0906d7539780418289bfc609c8ea410aa3717,3,1
"@WithAttributes(label = ""Main class"", required = false, description = ""Main class to use for Java standalone"")",a8f0906d7539780418289bfc609c8ea410aa3717,3,1
"// this is a step in a wizard, you cannot run this standalone",a8f0906d7539780418289bfc609c8ea410aa3717,3,1
final Project project = getSelectedProject(builder.getUIContext());,a8f0906d7539780418289bfc609c8ea410aa3717,3,1
// favor Camel if there is a Camel dependency,a8f0906d7539780418289bfc609c8ea410aa3717,3,1
Project project = getSelectedProject(context.getUIContext());,a8f0906d7539780418289bfc609c8ea410aa3717,3,1
"String msg = ""Added Fabric8 Maven support with base Docker image: "" + from.getValue();",a8f0906d7539780418289bfc609c8ea410aa3717,3,1
"+ "" You can change the name of the service in the <properties> section of the Maven pom file."";",a8f0906d7539780418289bfc609c8ea410aa3717,3,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",a8f0906d7539780418289bfc609c8ea410aa3717,2,1
private static final transient Logger LOG = LoggerFactory.getLogger(Fabric8SetupStep.class);,a8f0906d7539780418289bfc609c8ea410aa3717,2,1
// limit the choices depending on the project packaging,a8f0906d7539780418289bfc609c8ea410aa3717,2,1
// is it possible to pre select a choice?,a8f0906d7539780418289bfc609c8ea410aa3717,2,1
// if there is an existing then leave it as-is,a8f0906d7539780418289bfc609c8ea410aa3717,2,1
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.iconRef"", ""icons/"" + iconValue, updated);",a8f0906d7539780418289bfc609c8ea410aa3717,2,1
// there is a max 24 chars limit in OpenShift/Kubernetes,a8f0906d7539780418289bfc609c8ea410aa3717,2,1
// log and print to system out as the latter is what is seen in the CLI,a8f0906d7539780418289bfc609c8ea410aa3717,2,1
* If this is a WAR or EAR then lets assume 8080.,a8f0906d7539780418289bfc609c8ea410aa3717,2,1
fromImage = fromImage.substring(idx + 1);,a8f0906d7539780418289bfc609c8ea410aa3717,2,1
*  with the License.  You may obtain a copy of the License at,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"private String[] jarImages = new String[]{DockerSetupHelper.DEFAULT_JAVA_IMAGE, DockerSetupHelper.S2I_JAVA_IMAGE};",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
private String[] bundleImages = new String[]{DockerSetupHelper.DEFAULT_KARAF_IMAGE};,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"private String[] warImages = new String[]{DockerSetupHelper.DEFAULT_TOMCAT_IMAGE, DockerSetupHelper.DEFAULT_WILDFLY_IMAGE};",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
".description(""Configure the Fabric8 and Docker options for the project"");",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"LOG.info(""Getting the current project"");",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"LOG.info(""Got the current project"");",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
String packaging = getProjectPackaging(project);,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
boolean springBoot = hasSpringBootMavenPlugin(project);,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
final List<String> choices = new ArrayList<String>();,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"if (packaging == null || springBoot || ""jar"".equals(packaging)) {",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
String currentImage = getDockerFromImage(project);,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
if (currentImage != null) {,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"if (packaging == null || ""bundle"".equals(packaging)) {",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"if (!springBoot && (packaging == null || ""war"".equals(packaging))) {",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
if (choices.size() > 0) {,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
String defaultChoice = choices.get(0);,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
if (defaultChoice != null) {,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
// use a listener so the docker step knows what we selected as it want to reuse,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"if (packaging == null || (!packaging.equals(""war"") && !packaging.equals(""ear""))) {",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
boolean jarImage = DockerSetupHelper.isJarImage(from.getValue());,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
// only enable main if its required,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
// TODO we could disable if we knew this was an executable jar,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
if (project != null) {,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"String from = (String) builder.getUIContext().getAttributeMap().get(""docker.from"");",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
if (from != null) {,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
Set<String> choices = new LinkedHashSet<String>();,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
if (!findCamelArtifacts(project).isEmpty()) {,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
if (container.getValue() != null) {,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
if (choice.equals(container.getValue())) {,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
// use the project name as default value,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"LOG.info(""starting to setup fabric8 project"");",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
if (project == null) {,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
MavenFacet maven = project.getFacet(MavenFacet.class);,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
Model pom = maven.getModel();,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"boolean f8profiles = setupFabricMavenProfiles(project, maven, pom);",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
if (f8profiles) {,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"msg += "". Added the following Maven profiles [f8-build, f8-deploy, f8-local-deploy] to make building the project easier, e.g. mvn -Pf8-local-deploy"";",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"if (!MavenHelpers.hasManagedDependency(pom, ""io.fabric8"", ""fabric8-project"")) {",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
Dependency bom = DependencyBuilder.create(),a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"MavenPlugin plugin = MavenHelpers.findPlugin(project, ""io.fabric8"", ""fabric8-maven-plugin"");",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
if (plugin != null) {,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
pluginBuilder = null;,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
pluginBuilder = MavenPluginBuilder.create(),a8f0906d7539780418289bfc609c8ea410aa3717,1,1
if (pluginBuilder != null) {,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
MavenPluginFacet pluginFacet = project.getFacet(MavenPluginFacet.class);,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
if (test.getValue() != null && test.getValue()) {,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
boolean updated = false;,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
Properties properties = pom.getProperties();,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.label.container"", container.getValue(), updated);",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
String iconValue = icon.getValue();,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
if (Strings.isNotBlank(iconValue)) {,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.label.group"", group.getValue(), updated);",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
String servicePort = getDefaultServicePort(project);,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
if (servicePort != null) {,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
String name = pom.getArtifactId();,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
if (name.length() > 24) {,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
// print a warning,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"name = name.substring(0, 24);",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.service.containerPort"", servicePort, updated);",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.service.port"", ""80"", updated);",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.service.name"", name, updated);",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
if (updated) {,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
if (profiles.getValue() == null || !profiles.getValue()) {,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"Profile profile = MavenHelpers.findProfile(pom, ""f8-build"");",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
if (profile == null) {,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
profile = new Profile();,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
Build build = new Build();,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
updated = true;,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"profile = MavenHelpers.findProfile(pom, ""f8-deploy"");",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
Properties prop = new Properties();,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"profile = MavenHelpers.findProfile(pom, ""f8-local-deploy"");",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
* Try to determine the default service port.,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
if (Strings.isNotBlank(packaging)) {,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"if (Objects.equal(""war"", packaging) || Objects.equal(""ear"", packaging)) {",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
int idx = fromImage.indexOf('/');,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
if (idx > 0) {,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
idx = fromImage.indexOf('-');,a8f0906d7539780418289bfc609c8ea410aa3717,1,1
"fromImage = fromImage.substring(0, idx);",a8f0906d7539780418289bfc609c8ea410aa3717,1,1
/**,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
*,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"*  Red Hat licenses this file to you under the Apache License, version",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"*  Unless required by applicable law or agreed to in writing, software",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
*  implied.  See the License for the specific language governing,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
*  permissions and limitations under the License.,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
*/,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
package io.fabric8.forge.devops.setup;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import java.util.ArrayList;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import java.util.Arrays;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import java.util.Iterator;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import java.util.LinkedHashSet;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import java.util.List;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import java.util.Properties;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import java.util.Set;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import java.util.concurrent.Callable;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import javax.inject.Inject;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import io.fabric8.forge.addon.utils.MavenHelpers;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import io.fabric8.forge.addon.utils.VersionHelper;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import io.fabric8.forge.addon.utils.validator.ClassNameOrMavenPropertyValidator;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import io.fabric8.utils.Objects;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import io.fabric8.utils.Strings;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.apache.maven.model.Build;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.apache.maven.model.Model;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.apache.maven.model.Profile;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.dependencies.Dependency;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.facets.FacetFactory;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.facets.constraints.FacetConstraint;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.maven.plugins.ExecutionBuilder;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.maven.plugins.MavenPlugin;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.maven.plugins.MavenPluginBuilder;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.maven.projects.MavenFacet;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.maven.projects.MavenPluginFacet;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.projects.Project;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.resource.ResourceFactory;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.templates.TemplateFactory;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.ui.context.UIContext;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.ui.context.UINavigationContext;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.ui.input.InputComponent;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.ui.input.UICompleter;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.ui.input.UIInput;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.ui.input.UISelectOne;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.ui.result.NavigationResult;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.ui.result.Result;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.ui.result.Results;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.ui.util.Categories;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.ui.util.Metadata;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.jboss.forge.addon.ui.wizard.UIWizardStep;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.slf4j.Logger;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import org.slf4j.LoggerFactory;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import static io.fabric8.forge.addon.utils.MavenHelpers.ensureMavenDependencyAdded;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import static io.fabric8.forge.devops.setup.DockerSetupHelper.getDockerFromImage;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import static io.fabric8.forge.devops.setup.DockerSetupHelper.hasSpringBootMavenPlugin;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import static io.fabric8.forge.devops.setup.DockerSetupHelper.setupDocker;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
import static io.fabric8.forge.devops.setup.SetupProjectHelper.findCamelArtifacts;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"@FacetConstraint({MavenFacet.class, MavenPluginFacet.class, ResourcesFacet.class})",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
public class Fabric8SetupStep extends AbstractFabricProjectCommand implements UIWizardStep {,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
@Inject,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
private UIInput<String> organization;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
private UIInput<String> from;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
private UIInput<String> container;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
private UIInput<String> group;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
private UISelectOne<String> icon;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
private UIInput<String> main;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
private UIInput<Boolean> test;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
private UIInput<Boolean> profiles;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
private DependencyInstaller dependencyInstaller;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
private TemplateFactory factory;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
ResourceFactory resourceFactory;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
FacetFactory facetFactory;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
@Override,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
public UICommandMetadata getMetadata(UIContext context) {,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
return Metadata.forCommand(Fabric8SetupStep.class).name(,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"""Fabric8: Setup"").category(Categories.create(CATEGORY))",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
},a8f0906d7539780418289bfc609c8ea410aa3717,0,1
public boolean isEnabled(UIContext context) {,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
return false;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
public NavigationResult next(UINavigationContext context) throws Exception {,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
return null;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
public void initializeUI(final UIBuilder builder) throws Exception {,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"organization.setDefaultValue(""fabric8"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
builder.add(organization);,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
choices.add(currentImage);,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
} else {,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
choices.addAll(Arrays.asList(jarImages));,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
choices.add(bundleImages[0]);,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
choices.addAll(Arrays.asList(warImages));,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
from.setCompleter(new UICompleter<String>() {,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"public Iterable<String> getCompletionProposals(UIContext context, InputComponent<?, String> input, String value) {",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
return choices;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
});,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
from.setDefaultValue(defaultChoice);,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
from.addValueChangeListener(new ValueChangeListener() {,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
public void valueChanged(ValueChangeEvent event) {,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"builder.getUIContext().getAttributeMap().put(""docker.from"", event.getNewValue());",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
builder.add(from);,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
// TODO until we can detect reliably executable JARS versus mains lets not make this mandatory,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
/*,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
main.setRequired(new Callable<Boolean>() {,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
public Boolean call() throws Exception {,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
return jarImage;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
main.setEnabled(jarImage);,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
main.setDefaultValue(DockerSetupHelper.defaultMainClass(project));,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
main.addValidator(new ClassNameOrMavenPropertyValidator(true));,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
main.addValueChangeListener(new ValueChangeListener() {,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"builder.getUIContext().getAttributeMap().put(""docker.main"", event.getNewValue());",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
builder.add(main);,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
container.setDefaultValue(new Callable<String>() {,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
public String call() throws Exception {,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
return asContainer(from);,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
// the from image values,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
icon.setValueChoices(new Iterable<String>() {,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
public Iterator<String> iterator() {,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"choices.add(""activemq"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"choices.add(""camel"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"choices.add(""java"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"choices.add(""jetty"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"choices.add(""karaf"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"choices.add(""mule"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"choices.add(""tomcat"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"choices.add(""tomee"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"choices.add(""weld"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"choices.add(""wildfly"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
return choices.iterator();,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
icon.setDefaultValue(new Callable<String>() {,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"return ""camel"";",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
for (String choice : icon.getValueChoices()) {,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
return choice;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
// use java by default,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"return ""java"";",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
group.setDefaultValue(new Callable<String>() {,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
builder.add(profiles).add(test).add(icon).add(group).add(container);,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
public Result execute(UIExecutionContext context) throws Exception {,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"return Results.fail(""No pom.xml available so cannot edit the project!"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
// setup docker-maven-plugin and fabric8-maven-plugin,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"setupDocker(project, organization.getValue(), from.getValue(), main.getValue());",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"LOG.info(""docker-maven-plugin now setup"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
setupFabricMavenPlugin(project);,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"LOG.info(""fabric8-maven-plugin now setup"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
// import fabric8 bom,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"LOG.info(""importing fabric8 bom"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"importFabricBom(project, pom);",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
// make sure we have resources as we need it later,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"facetFactory.install(project, ResourcesFacet.class);",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"LOG.info(""setting up arquillian test"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"setupArguillianTest(project, pom);",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"LOG.info(""setting up fabric8 properties"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"setupFabricProperties(project, maven, pom);",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"LOG.info(""setting up fabric8 maven profiles"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
return Results.success(msg);,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"private void importFabricBom(Project project, Model pom) {",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
".setCoordinate(MavenHelpers.createCoordinate(""io.fabric8"", ""fabric8-project"", VersionHelper.fabric8Version(), ""pom""))",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
".setScopeType(""import"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"dependencyInstaller.installManaged(project, bom);",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
private void setupFabricMavenPlugin(Project project) {,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
MavenPluginBuilder pluginBuilder;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"LOG.info(""Found existing fabric8-maven-plugin"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"LOG.info(""Adding fabric8-maven-plugin"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
// add fabric8 plugin,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
".setCoordinate(MavenHelpers.createCoordinate(""io.fabric8"", ""fabric8-maven-plugin"", VersionHelper.fabric8Version()))",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
".addExecution(ExecutionBuilder.create().setId(""json"").setPhase(""generate-resources"").addGoal(""json""))",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
".addExecution(ExecutionBuilder.create().setId(""attach"").setPhase(""package"").addGoal(""attach""));",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
pluginFacet.addPlugin(pluginBuilder);,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"private void setupArguillianTest(Project project, Model pom) {",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"ensureMavenDependencyAdded(project, dependencyInstaller, ""io.fabric8"", ""fabric8-arquillian"", ""test"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"ensureMavenDependencyAdded(project, dependencyInstaller, ""org.jboss.arquillian.junit"", ""arquillian-junit-container"", ""test"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"private void setupFabricProperties(Project project, MavenFacet maven, Model pom) {",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
// update properties section in pom.xml,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
LOG.warn(msg);,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
System.out.println(msg);,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
// clip the name at max 24 chars,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
// to save then set the model,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
maven.setModel(pom);,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"LOG.info(""updated pom.xml"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"private boolean setupFabricMavenProfiles(Project project, MavenFacet maven, Model pom) {",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"LOG.info(""Adding f8-build profile"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"profile.setId(""f8-build"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"build.setDefaultGoal(""clean install docker:build fabric8:json"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
profile.setBuild(build);,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
pom.addProfile(profile);,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"LOG.info(""Adding f8-deploy profile"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"profile.setId(""f8-deploy"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"prop.setProperty(""fabric8.imagePullPolicySnapshot"", ""Always"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"prop.setProperty(""fabric8.recreate"", ""true"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
profile.setProperties(prop);,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"build.setDefaultGoal(""clean install docker:build docker:push fabric8:json fabric8:apply"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"LOG.info(""Adding f8-local-deploy profile"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"profile.setId(""f8-local-deploy"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"build.setDefaultGoal(""clean install docker:build fabric8:json fabric8:apply"");",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
return true;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
* For karaf we can't know its definitely got http inside; so lets punt for now.,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
protected String getDefaultServicePort(Project project) {,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
"return ""8080"";",a8f0906d7539780418289bfc609c8ea410aa3717,0,1
private static String asContainer(String fromImage) {,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
return fromImage;,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
private static String getProjectPackaging(Project project) {,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
return maven.getModel().getPackaging();,a8f0906d7539780418289bfc609c8ea410aa3717,0,1
if (repository != null) {,161563b49eb48a735f1448ff50f1c71aa59ddc49,4,0
if (id != null) {,161563b49eb48a735f1448ff50f1c71aa59ddc49,4,0
if (gitFolder != null) {,161563b49eb48a735f1448ff50f1c71aa59ddc49,4,0
if (basedir != null) {,161563b49eb48a735f1448ff50f1c71aa59ddc49,4,1
"} else if (Objects.equal(""GIT_URL"", envVarName)) {",161563b49eb48a735f1448ff50f1c71aa59ddc49,3,0
"} else if (Objects.equal(""GIT_COMMIT"", envVarName)) {",161563b49eb48a735f1448ff50f1c71aa59ddc49,3,0
"} else if (Objects.equal(""GIT_BRANCH"", envVarName)) {",161563b49eb48a735f1448ff50f1c71aa59ddc49,3,0
if (repository == null) {,161563b49eb48a735f1448ff50f1c71aa59ddc49,3,0
while (current != null) {,161563b49eb48a735f1448ff50f1c71aa59ddc49,3,0
"getLog().warn(""Could not find jenkins service URL: "" + e, e);",161563b49eb48a735f1448ff50f1c71aa59ddc49,3,1
"getLog().warn(""Cannot connect to Kubernetes to find jenkins service URL: "" + cause.getMessage());",161563b49eb48a735f1448ff50f1c71aa59ddc49,3,0
"getLog().warn(""Cannot find jenkins service URL: "" + cause, cause);",161563b49eb48a735f1448ff50f1c71aa59ddc49,3,0
while (project != null) {,161563b49eb48a735f1448ff50f1c71aa59ddc49,3,1
if (parent == null) {,161563b49eb48a735f1448ff50f1c71aa59ddc49,3,1
"try (Repository repository = getGitRepository(basedir, envVarName)) {",161563b49eb48a735f1448ff50f1c71aa59ddc49,2,0
} catch (IOException e) {,161563b49eb48a735f1448ff50f1c71aa59ddc49,2,0
"protected Repository getGitRepository(File basedir, String envVarName) {",161563b49eb48a735f1448ff50f1c71aa59ddc49,2,0
Repository repository = null;,161563b49eb48a735f1448ff50f1c71aa59ddc49,2,0
"getLog().warn(""Could not create default value for $"" + envVarName + "" as no .git/config file could be found"");",161563b49eb48a735f1448ff50f1c71aa59ddc49,2,0
return null;,161563b49eb48a735f1448ff50f1c71aa59ddc49,2,0
"if (Objects.equal(""GIT_URL"", envVarName)) {",161563b49eb48a735f1448ff50f1c71aa59ddc49,2,1
} catch (Throwable e) {,161563b49eb48a735f1448ff50f1c71aa59ddc49,2,0
"connectError = t instanceof ConnectException || ""No route to host"".equals(t.getMessage());",161563b49eb48a735f1448ff50f1c71aa59ddc49,2,0
if (connectError) {,161563b49eb48a735f1448ff50f1c71aa59ddc49,2,0
} else {,161563b49eb48a735f1448ff50f1c71aa59ddc49,2,0
"getLog().warn(""Could not find gogs service URL: "" + cause, cause);",161563b49eb48a735f1448ff50f1c71aa59ddc49,2,0
} catch (Exception e) {,161563b49eb48a735f1448ff50f1c71aa59ddc49,2,1
"getLog().warn(""Could not find gogs service URL: "" + e, e);",161563b49eb48a735f1448ff50f1c71aa59ddc49,2,1
"throw new MojoExecutionException(""Cannot find resource `"" + resourceName + ""` on the classpath!"");",161563b49eb48a735f1448ff50f1c71aa59ddc49,2,0
"getLog().warn(""Cannot find BUILD_ID to create a specific jenkins build URL. So using: "" + jobUrl);",161563b49eb48a735f1448ff50f1c71aa59ddc49,2,0
"getLog().warn(""Cannot connect to Kubernetes to find gogs service URL: "" + cause.getMessage());",161563b49eb48a735f1448ff50f1c71aa59ddc49,2,0
"getLog().warn(""Cannot find gogs service URL: "" + cause, cause);",161563b49eb48a735f1448ff50f1c71aa59ddc49,2,0
"getLog().warn(""Cannot create default value for $"" + envVarName + "" as no .git/config file could be found"");",161563b49eb48a735f1448ff50f1c71aa59ddc49,2,0
"throw new MojoExecutionException(""Could not find resource `"" + resourceName + ""` on the classpath!"");",161563b49eb48a735f1448ff50f1c71aa59ddc49,2,1
"getLog().warn(""Could not find BUILD_ID to create a specific jenkins build URL. So using: "" + jobUrl);",161563b49eb48a735f1448ff50f1c71aa59ddc49,2,1
"getLog().warn(""Could not find gogs service URL: "" + cause, cause);",161563b49eb48a735f1448ff50f1c71aa59ddc49,2,1
"getLog().warn(""Could not create default value for $"" + envVarName + "" as no .git/config file could be found"");",161563b49eb48a735f1448ff50f1c71aa59ddc49,2,1
if (Strings.isNotBlank(jobUrl)) {,161563b49eb48a735f1448ff50f1c71aa59ddc49,2,0
"String buildId = Systems.getEnvVarOrSystemProperty(""BUILD_ID"");",161563b49eb48a735f1448ff50f1c71aa59ddc49,2,0
if (Strings.isNotBlank(buildId)) {,161563b49eb48a735f1448ff50f1c71aa59ddc49,2,0
} else {,161563b49eb48a735f1448ff50f1c71aa59ddc49,2,0
"getLog().warn(""Cannot find BUILD_ID to create a specific jenkins build URL. So using: "" + jobUrl);",161563b49eb48a735f1448ff50f1c71aa59ddc49,2,0
"String buildId = Systems.getEnvVarOrSystemProperty(""BUILD_ID"");",161563b49eb48a735f1448ff50f1c71aa59ddc49,2,1
if (Strings.isNotBlank(buildId)) {,161563b49eb48a735f1448ff50f1c71aa59ddc49,2,1
} else {,161563b49eb48a735f1448ff50f1c71aa59ddc49,2,1
"getLog().warn(""Cannot find BUILD_ID to create a specific jenkins build URL. So using: "" + jobUrl);",161563b49eb48a735f1448ff50f1c71aa59ddc49,2,1
File answer = null;,161563b49eb48a735f1448ff50f1c71aa59ddc49,2,1
MavenProject project = getProject();,161563b49eb48a735f1448ff50f1c71aa59ddc49,2,1
project = project.getParent();,161563b49eb48a735f1448ff50f1c71aa59ddc49,2,1
project = parent;,161563b49eb48a735f1448ff50f1c71aa59ddc49,2,1
import org.eclipse.jgit.lib.ObjectId;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import org.eclipse.jgit.lib.Repository;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import org.eclipse.jgit.storage.file.FileRepositoryBuilder;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
ObjectId id = repository.resolve(repository.getFullBranch());,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
return id.getName();,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
},161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
"getLog().warn(""failed to find git commit id. "" + e, e);",161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
return repository.getBranch();,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
try {,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
File gitFolder = GitHelpers.findGitRootFolder(basedir);,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
FileRepositoryBuilder builder = new FileRepositoryBuilder();,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
repository = builder.setGitDir(basedir),161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
return repository;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
"getLog().warn(""Failed to initialise Git Repository: "" + e, e);",161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
},161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import java.net.ConnectException;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import java.util.Collections;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import java.util.Iterator;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import io.fabric8.devops.ProjectConfig;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import io.fabric8.devops.ProjectConfigs;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import io.fabric8.devops.ProjectRepositories;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import io.fabric8.kubernetes.api.KubernetesHelper;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import io.fabric8.kubernetes.api.ServiceNames;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import io.fabric8.kubernetes.api.model.HasMetadata;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import io.fabric8.kubernetes.api.model.KubernetesList;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import io.fabric8.kubernetes.api.model.ReplicationController;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import io.fabric8.maven.support.JsonSchema;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import io.fabric8.maven.support.JsonSchemas;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import io.fabric8.openshift.api.model.DeploymentConfig;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import io.fabric8.openshift.api.model.Template;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import io.fabric8.utils.Files;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import io.fabric8.utils.Objects;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import io.fabric8.utils.Strings;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import io.fabric8.utils.Systems;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import io.fabric8.utils.URLUtils;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import org.apache.maven.artifact.Artifact;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import org.apache.maven.plugin.MojoExecutionException;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import org.apache.maven.plugins.annotations.Parameter;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import org.apache.maven.project.MavenProject;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import org.eclipse.jgit.lib.ObjectId;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import org.eclipse.jgit.lib.Repository;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import org.eclipse.jgit.storage.file.FileRepositoryBuilder;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
// this requires online access to kubernetes so we should silently fail if no connection,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
Throwable cause = e;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
boolean connectError = false;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
Iterable<Throwable> it = createExceptionIterable(e);,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
for (Throwable t : it) {,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
cause = t;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
},161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
"getLog().debug(""Cannot connect to Kubernetes due: "" + cause.getMessage());",161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
protected static Iterable<Throwable> createExceptionIterable(Throwable exception) {,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
List<Throwable> throwables = new ArrayList<Throwable>();,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
Throwable current = exception;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
current = current.getCause();,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
return throwables;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import io.fabric8.devops.ProjectConfig;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import io.fabric8.devops.ProjectConfigs;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import io.fabric8.devops.ProjectRepositories;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import io.fabric8.kubernetes.api.KubernetesHelper;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import io.fabric8.kubernetes.api.ServiceNames;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import io.fabric8.kubernetes.api.model.HasMetadata;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import io.fabric8.kubernetes.api.model.KubernetesList;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import io.fabric8.kubernetes.api.model.ReplicationController;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import io.fabric8.maven.support.JsonSchema;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import io.fabric8.maven.support.JsonSchemas;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import io.fabric8.openshift.api.model.DeploymentConfig;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import io.fabric8.openshift.api.model.Template;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import io.fabric8.utils.Files;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import io.fabric8.utils.GitHelpers;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import io.fabric8.utils.Objects;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import io.fabric8.utils.Strings;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import io.fabric8.utils.Systems;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import io.fabric8.utils.URLUtils;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import org.apache.maven.artifact.Artifact;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import org.apache.maven.plugin.MojoExecutionException;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import org.apache.maven.plugins.annotations.Parameter;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import org.apache.maven.project.MavenProject;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import org.eclipse.jgit.lib.ObjectId;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import org.eclipse.jgit.lib.Repository;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
import org.eclipse.jgit.storage.file.FileRepositoryBuilder;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
"getLog().warn(""Failed to find git commit id. "" + e, e);",161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
"getLog().debug(""Current properties "" + new TreeSet<>(properties.keySet()));",161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
import java.util.Iterator;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
"getLog().debug(""Cannot connect to Kubernetes due: "" + cause.getMessage());",161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
"getLog().warn(""failed to find git commit id. "" + e, e);",161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
"getLog().debug(""current properties "" + new TreeSet<>(properties.keySet()));",161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
"jobUrl = URLUtils.pathJoin(jobUrl, buildId);",161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
},161563b49eb48a735f1448ff50f1c71aa59ddc49,1,0
"jobUrl = URLUtils.pathJoin(jobUrl, buildId);",161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
},161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
* Returns the root project folder,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
protected File getRootProjectFolder() {,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
File basedir = project.getBasedir();,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
answer = basedir;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
},161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
return answer;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
protected MavenProject getRootProject() {,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
MavenProject parent = project.getParent();,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
return project;,161563b49eb48a735f1448ff50f1c71aa59ddc49,1,1
/*,161563b49eb48a735f1448ff50f1c71aa59ddc49,0,0
*/,161563b49eb48a735f1448ff50f1c71aa59ddc49,0,0
.readEnvironment() // scan environment GIT_* variables,161563b49eb48a735f1448ff50f1c71aa59ddc49,0,0
.findGitDir() // scan up the file system tree,161563b49eb48a735f1448ff50f1c71aa59ddc49,0,0
.build();,161563b49eb48a735f1448ff50f1c71aa59ddc49,0,0
break;,161563b49eb48a735f1448ff50f1c71aa59ddc49,0,0
/**,161563b49eb48a735f1448ff50f1c71aa59ddc49,0,0
* Creates an Iterable to walk the exception from the bottom up,161563b49eb48a735f1448ff50f1c71aa59ddc49,0,0
* (the last caused by going upwards to the root exception).,161563b49eb48a735f1448ff50f1c71aa59ddc49,0,0
*,161563b49eb48a735f1448ff50f1c71aa59ddc49,0,0
* @see java.lang.Iterable,161563b49eb48a735f1448ff50f1c71aa59ddc49,0,0
* @param exception  the exception,161563b49eb48a735f1448ff50f1c71aa59ddc49,0,0
* @return the Iterable,161563b49eb48a735f1448ff50f1c71aa59ddc49,0,0
*/,161563b49eb48a735f1448ff50f1c71aa59ddc49,0,0
// spool to the bottom of the caused by tree,161563b49eb48a735f1448ff50f1c71aa59ddc49,0,0
throwables.add(current);,161563b49eb48a735f1448ff50f1c71aa59ddc49,0,0
Collections.reverse(throwables);,161563b49eb48a735f1448ff50f1c71aa59ddc49,0,0
"getLog().info(""Added environment annotations:"");",161563b49eb48a735f1448ff50f1c71aa59ddc49,0,0
"getLog().info(""Added enviroment annotations:"");",161563b49eb48a735f1448ff50f1c71aa59ddc49,0,1
@Override,161563b49eb48a735f1448ff50f1c71aa59ddc49,0,0
/**,161563b49eb48a735f1448ff50f1c71aa59ddc49,0,1
*/,161563b49eb48a735f1448ff50f1c71aa59ddc49,0,1
break;,161563b49eb48a735f1448ff50f1c71aa59ddc49,0,1
} catch (Throwable e) {,87724435378bc5e35dccd647246890c68460d249,2,0
if (connectError) {,87724435378bc5e35dccd647246890c68460d249,2,0
} else {,87724435378bc5e35dccd647246890c68460d249,2,0
} catch (Exception e) {,87724435378bc5e35dccd647246890c68460d249,2,1
"getLog().warn(""Failed to find git commit id. "" + e, e);",87724435378bc5e35dccd647246890c68460d249,2,0
"getLog().warn(""failed to find git commit id. "" + e, e);",87724435378bc5e35dccd647246890c68460d249,2,1
} catch (Exception e) {,87724435378bc5e35dccd647246890c68460d249,2,0
"warnIfInCDBuild(""Could not find .git folder based on the current basedir of "" + basedir);",87724435378bc5e35dccd647246890c68460d249,2,0
"getLog().warn(""Could not find .git folder based on the current basedir of "" + basedir);",87724435378bc5e35dccd647246890c68460d249,2,1
// this requires online access to kubernetes so we should silently fail if no connection,87724435378bc5e35dccd647246890c68460d249,1,0
for (Throwable t : it) {,87724435378bc5e35dccd647246890c68460d249,1,0
},87724435378bc5e35dccd647246890c68460d249,1,0
"getLog().warn(""Could not find gogs service URL: "" + cause, cause);",87724435378bc5e35dccd647246890c68460d249,1,0
protected static Iterable<Throwable> createExceptionIterable(Throwable exception) {,87724435378bc5e35dccd647246890c68460d249,1,0
while (current != null) {,87724435378bc5e35dccd647246890c68460d249,1,0
"getLog().warn(""Could not find jenkins service URL: "" + e, e);",87724435378bc5e35dccd647246890c68460d249,1,1
"getLog().warn(""Could not find gogs service URL: "" + e, e);",87724435378bc5e35dccd647246890c68460d249,1,1
"throw new MojoExecutionException(""Cannot find resource `"" + resourceName + ""` on the classpath!"");",87724435378bc5e35dccd647246890c68460d249,1,0
"getLog().warn(""Cannot find BUILD_ID to create a specific jenkins build URL. So using: "" + jobUrl);",87724435378bc5e35dccd647246890c68460d249,1,0
"getLog().warn(""Cannot connect to Kubernetes to find jenkins service URL: "" + cause.getMessage());",87724435378bc5e35dccd647246890c68460d249,1,0
"getLog().warn(""Cannot find jenkins service URL: "" + cause, cause);",87724435378bc5e35dccd647246890c68460d249,1,0
"getLog().warn(""Cannot connect to Kubernetes to find gogs service URL: "" + cause.getMessage());",87724435378bc5e35dccd647246890c68460d249,1,0
"getLog().warn(""Cannot find gogs service URL: "" + cause, cause);",87724435378bc5e35dccd647246890c68460d249,1,0
"throw new MojoExecutionException(""Could not find resource `"" + resourceName + ""` on the classpath!"");",87724435378bc5e35dccd647246890c68460d249,1,1
"getLog().warn(""Could not find BUILD_ID to create a specific jenkins build URL. So using: "" + jobUrl);",87724435378bc5e35dccd647246890c68460d249,1,1
"getLog().warn(""Could not find gogs service URL: "" + cause, cause);",87724435378bc5e35dccd647246890c68460d249,1,1
try {,87724435378bc5e35dccd647246890c68460d249,1,0
},87724435378bc5e35dccd647246890c68460d249,1,0
"warnIfInCDBuild(""Failed to initialise Git Repository: "" + e, e);",87724435378bc5e35dccd647246890c68460d249,1,0
"getLog().warn(""Failed to initialise Git Repository: "" + e, e);",87724435378bc5e35dccd647246890c68460d249,1,1
import java.net.ConnectException;,87724435378bc5e35dccd647246890c68460d249,0,0
import java.util.Collections;,87724435378bc5e35dccd647246890c68460d249,0,0
import java.util.Iterator;,87724435378bc5e35dccd647246890c68460d249,0,0
import io.fabric8.devops.ProjectConfig;,87724435378bc5e35dccd647246890c68460d249,0,0
import io.fabric8.devops.ProjectConfigs;,87724435378bc5e35dccd647246890c68460d249,0,0
import io.fabric8.devops.ProjectRepositories;,87724435378bc5e35dccd647246890c68460d249,0,0
import io.fabric8.kubernetes.api.KubernetesHelper;,87724435378bc5e35dccd647246890c68460d249,0,0
import io.fabric8.kubernetes.api.ServiceNames;,87724435378bc5e35dccd647246890c68460d249,0,0
import io.fabric8.kubernetes.api.model.HasMetadata;,87724435378bc5e35dccd647246890c68460d249,0,0
import io.fabric8.kubernetes.api.model.KubernetesList;,87724435378bc5e35dccd647246890c68460d249,0,0
import io.fabric8.kubernetes.api.model.ReplicationController;,87724435378bc5e35dccd647246890c68460d249,0,0
import io.fabric8.maven.support.JsonSchema;,87724435378bc5e35dccd647246890c68460d249,0,0
import io.fabric8.maven.support.JsonSchemas;,87724435378bc5e35dccd647246890c68460d249,0,0
import io.fabric8.openshift.api.model.DeploymentConfig;,87724435378bc5e35dccd647246890c68460d249,0,0
import io.fabric8.openshift.api.model.Template;,87724435378bc5e35dccd647246890c68460d249,0,0
import io.fabric8.utils.Files;,87724435378bc5e35dccd647246890c68460d249,0,0
import io.fabric8.utils.Objects;,87724435378bc5e35dccd647246890c68460d249,0,0
import io.fabric8.utils.Strings;,87724435378bc5e35dccd647246890c68460d249,0,0
import io.fabric8.utils.Systems;,87724435378bc5e35dccd647246890c68460d249,0,0
import io.fabric8.utils.URLUtils;,87724435378bc5e35dccd647246890c68460d249,0,0
import org.apache.maven.artifact.Artifact;,87724435378bc5e35dccd647246890c68460d249,0,0
import org.apache.maven.plugin.MojoExecutionException;,87724435378bc5e35dccd647246890c68460d249,0,0
import org.apache.maven.plugins.annotations.Parameter;,87724435378bc5e35dccd647246890c68460d249,0,0
import org.apache.maven.project.MavenProject;,87724435378bc5e35dccd647246890c68460d249,0,0
import org.eclipse.jgit.lib.ObjectId;,87724435378bc5e35dccd647246890c68460d249,0,0
import org.eclipse.jgit.lib.Repository;,87724435378bc5e35dccd647246890c68460d249,0,0
import org.eclipse.jgit.storage.file.FileRepositoryBuilder;,87724435378bc5e35dccd647246890c68460d249,0,0
Throwable cause = e;,87724435378bc5e35dccd647246890c68460d249,0,0
boolean connectError = false;,87724435378bc5e35dccd647246890c68460d249,0,0
Iterable<Throwable> it = createExceptionIterable(e);,87724435378bc5e35dccd647246890c68460d249,0,0
"connectError = t instanceof ConnectException || ""No route to host"".equals(t.getMessage());",87724435378bc5e35dccd647246890c68460d249,0,0
cause = t;,87724435378bc5e35dccd647246890c68460d249,0,0
break;,87724435378bc5e35dccd647246890c68460d249,0,0
"getLog().debug(""Cannot connect to Kubernetes due: "" + cause.getMessage());",87724435378bc5e35dccd647246890c68460d249,0,0
/**,87724435378bc5e35dccd647246890c68460d249,0,0
* Creates an Iterable to walk the exception from the bottom up,87724435378bc5e35dccd647246890c68460d249,0,0
* (the last caused by going upwards to the root exception).,87724435378bc5e35dccd647246890c68460d249,0,0
*,87724435378bc5e35dccd647246890c68460d249,0,0
* @see java.lang.Iterable,87724435378bc5e35dccd647246890c68460d249,0,0
* @param exception  the exception,87724435378bc5e35dccd647246890c68460d249,0,0
* @return the Iterable,87724435378bc5e35dccd647246890c68460d249,0,0
*/,87724435378bc5e35dccd647246890c68460d249,0,0
List<Throwable> throwables = new ArrayList<Throwable>();,87724435378bc5e35dccd647246890c68460d249,0,0
Throwable current = exception;,87724435378bc5e35dccd647246890c68460d249,0,0
// spool to the bottom of the caused by tree,87724435378bc5e35dccd647246890c68460d249,0,0
throwables.add(current);,87724435378bc5e35dccd647246890c68460d249,0,0
current = current.getCause();,87724435378bc5e35dccd647246890c68460d249,0,0
Collections.reverse(throwables);,87724435378bc5e35dccd647246890c68460d249,0,0
return throwables;,87724435378bc5e35dccd647246890c68460d249,0,0
import io.fabric8.devops.ProjectConfig;,87724435378bc5e35dccd647246890c68460d249,0,1
import io.fabric8.devops.ProjectConfigs;,87724435378bc5e35dccd647246890c68460d249,0,1
import io.fabric8.devops.ProjectRepositories;,87724435378bc5e35dccd647246890c68460d249,0,1
import io.fabric8.kubernetes.api.KubernetesHelper;,87724435378bc5e35dccd647246890c68460d249,0,1
import io.fabric8.kubernetes.api.ServiceNames;,87724435378bc5e35dccd647246890c68460d249,0,1
import io.fabric8.kubernetes.api.model.HasMetadata;,87724435378bc5e35dccd647246890c68460d249,0,1
import io.fabric8.kubernetes.api.model.KubernetesList;,87724435378bc5e35dccd647246890c68460d249,0,1
import io.fabric8.kubernetes.api.model.ReplicationController;,87724435378bc5e35dccd647246890c68460d249,0,1
import io.fabric8.maven.support.JsonSchema;,87724435378bc5e35dccd647246890c68460d249,0,1
import io.fabric8.maven.support.JsonSchemas;,87724435378bc5e35dccd647246890c68460d249,0,1
import io.fabric8.openshift.api.model.DeploymentConfig;,87724435378bc5e35dccd647246890c68460d249,0,1
import io.fabric8.openshift.api.model.Template;,87724435378bc5e35dccd647246890c68460d249,0,1
import io.fabric8.utils.Files;,87724435378bc5e35dccd647246890c68460d249,0,1
import io.fabric8.utils.GitHelpers;,87724435378bc5e35dccd647246890c68460d249,0,1
import io.fabric8.utils.Objects;,87724435378bc5e35dccd647246890c68460d249,0,1
import io.fabric8.utils.Strings;,87724435378bc5e35dccd647246890c68460d249,0,1
import io.fabric8.utils.Systems;,87724435378bc5e35dccd647246890c68460d249,0,1
import io.fabric8.utils.URLUtils;,87724435378bc5e35dccd647246890c68460d249,0,1
import org.apache.maven.artifact.Artifact;,87724435378bc5e35dccd647246890c68460d249,0,1
import org.apache.maven.plugin.MojoExecutionException;,87724435378bc5e35dccd647246890c68460d249,0,1
import org.apache.maven.plugins.annotations.Parameter;,87724435378bc5e35dccd647246890c68460d249,0,1
import org.apache.maven.project.MavenProject;,87724435378bc5e35dccd647246890c68460d249,0,1
import org.eclipse.jgit.lib.ObjectId;,87724435378bc5e35dccd647246890c68460d249,0,1
import org.eclipse.jgit.lib.Repository;,87724435378bc5e35dccd647246890c68460d249,0,1
import org.eclipse.jgit.storage.file.FileRepositoryBuilder;,87724435378bc5e35dccd647246890c68460d249,0,1
"getLog().info(""Added environment annotations:"");",87724435378bc5e35dccd647246890c68460d249,0,0
"getLog().warn(""Cannot create default value for $"" + envVarName + "" as no .git/config file could be found"");",87724435378bc5e35dccd647246890c68460d249,0,0
"getLog().debug(""Current properties "" + new TreeSet<>(properties.keySet()));",87724435378bc5e35dccd647246890c68460d249,0,0
import java.util.Iterator;,87724435378bc5e35dccd647246890c68460d249,0,1
"getLog().info(""Added enviroment annotations:"");",87724435378bc5e35dccd647246890c68460d249,0,1
"getLog().debug(""Cannot connect to Kubernetes due: "" + cause.getMessage());",87724435378bc5e35dccd647246890c68460d249,0,1
"getLog().warn(""Could not create default value for $"" + envVarName + "" as no .git/config file could be found"");",87724435378bc5e35dccd647246890c68460d249,0,1
"getLog().debug(""current properties "" + new TreeSet<>(properties.keySet()));",87724435378bc5e35dccd647246890c68460d249,0,1
"getLog().info(""Looking at repo with directory "" + repository.getDirectory());",87724435378bc5e35dccd647246890c68460d249,0,0
repository.close();,87724435378bc5e35dccd647246890c68460d249,0,0
// ignore,87724435378bc5e35dccd647246890c68460d249,0,0
"warnIfInCDBuild(""Cannot create default value for $"" + envVarName + "" as no .git/config file could be found"");",87724435378bc5e35dccd647246890c68460d249,0,0
"getLog().debug(""No environment schemas found for file: "" + JsonSchemas.ENVIRONMENT_SCHEMA_FILE);",87724435378bc5e35dccd647246890c68460d249,0,0
"System.out.println(""Looking at repo with directory "" + repository.getDirectory());",87724435378bc5e35dccd647246890c68460d249,0,1
repository.close();,87724435378bc5e35dccd647246890c68460d249,0,1
"getLog().warn(""Cannot create default value for $"" + envVarName + "" as no .git/config file could be found"");",87724435378bc5e35dccd647246890c68460d249,0,1
"getLog().info(""No environment schemas found for file: "" + JsonSchemas.ENVIRONMENT_SCHEMA_FILE);",87724435378bc5e35dccd647246890c68460d249,0,1
// TODO we could disable if we knew this was an executable jar,3262a38ab89de5fc32e33559efda76136b88fb87,9,1
"LOG.debug(""Adding pom.xml dependency:  "" + groupId + "":"" + artifactId + "" version: "" + version + "" scope: "" + scope);",3262a38ab89de5fc32e33559efda76136b88fb87,7,0
"System.out.println(""Adding pom.xml dependency:  "" + groupId + "":"" + artifactId + "" version: "" + version + "" scope: "" + scope);",3262a38ab89de5fc32e33559efda76136b88fb87,7,1
// TODO until we can detect reliably executable JARS versus mains lets not make this mandatory,3262a38ab89de5fc32e33559efda76136b88fb87,7,1
"LOG.debug(""Adding pom.xml dependency:  "" + groupId + "":"" + artifactId + "" version: "" + version + "" scope: "" + scope);",3262a38ab89de5fc32e33559efda76136b88fb87,7,1
"boolean jar = packaging == null || packaging.equals(""jar""); // jar is default packaging",3262a38ab89de5fc32e33559efda76136b88fb87,6,1
"LOG.warn(""Could not find the version for groupId: "" + groupId + "" artifactId: "" + artifactId + "" in: "" + map);",3262a38ab89de5fc32e33559efda76136b88fb87,6,1
"LOG.debug(""Project already includes:  "" + groupId + "":"" + artifactId + "" for version: "" + d.getCoordinate().getVersion());",3262a38ab89de5fc32e33559efda76136b88fb87,5,0
"System.out.println(""Project already includes:  "" + groupId + "":"" + artifactId + "" for version: "" + d.getCoordinate().getVersion());",3262a38ab89de5fc32e33559efda76136b88fb87,5,1
"@WithAttributes(label = ""Docker Image From"", required = true, description = ""The Docker image to use as base line"")",3262a38ab89de5fc32e33559efda76136b88fb87,5,1
"@WithAttributes(label = ""Maven Fabric8 Profiles"", required = false, defaultValue = ""true"", description = ""Include Maven fabric8 profiles for easily building and deploying"")",3262a38ab89de5fc32e33559efda76136b88fb87,5,1
"String msg = ""Added Fabric8 Maven support with base Docker image: "" + from.getValue();",3262a38ab89de5fc32e33559efda76136b88fb87,5,1
"LOG.debug(""Project already includes:  "" + groupId + "":"" + artifactId + "" for version: "" + d.getCoordinate().getVersion());",3262a38ab89de5fc32e33559efda76136b88fb87,5,1
"String key = """" + groupId + ""/"" + artifactId;",3262a38ab89de5fc32e33559efda76136b88fb87,5,1
"LOG.debug(""No version could be found for:  "" + groupId + "":"" + artifactId);",3262a38ab89de5fc32e33559efda76136b88fb87,4,0
"System.out.println(""No version could be found for:  "" + groupId + "":"" + artifactId);",3262a38ab89de5fc32e33559efda76136b88fb87,4,1
"public static void setupDocker(Project project, String organization, String fromImage, String main) {",3262a38ab89de5fc32e33559efda76136b88fb87,4,1
} else if (jar && main != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,4,1
// if we are adding then we need to include some configurations as well,3262a38ab89de5fc32e33559efda76136b88fb87,4,1
"@WithAttributes(label = ""Docker Organization"", required = true, description = ""The Docker organization/company"")",3262a38ab89de5fc32e33559efda76136b88fb87,4,1
"@WithAttributes(label = ""Test classes"", required = false, defaultValue = ""true"", description = ""Include test dependencies"")",3262a38ab89de5fc32e33559efda76136b88fb87,4,1
// make sure we have resources as we need it later,3262a38ab89de5fc32e33559efda76136b88fb87,4,1
"String msg = ""The fabric8.service.name: "" + name + "" is being limited to max 24 chars as that is required by Kubernetes/Openshift.""",3262a38ab89de5fc32e33559efda76136b88fb87,4,1
"public static boolean ensureMavenDependencyAdded(Project project, DependencyInstaller dependencyInstaller, String groupId, String artifactId, String scope) {",3262a38ab89de5fc32e33559efda76136b88fb87,4,1
"LOG.debug(""No version could be found for:  "" + groupId + "":"" + artifactId);",3262a38ab89de5fc32e33559efda76136b88fb87,4,1
"public static Coordinate createCoordinate(String groupId, String artifactId, String version, String packaging) {",3262a38ab89de5fc32e33559efda76136b88fb87,4,1
* Returns the plugin configuration element for the given set of element names,3262a38ab89de5fc32e33559efda76136b88fb87,4,1
* @return true if the value changed and was non null or updated was true,3262a38ab89de5fc32e33559efda76136b88fb87,3,0
"public static boolean hasMavenPlugin(Model pom, String groupId, String artifactId) {",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
* @returns true if the value changed and was non null or updated was true,3262a38ab89de5fc32e33559efda76136b88fb87,3,1
String packaging = getProjectPackaging(project);,3262a38ab89de5fc32e33559efda76136b88fb87,3,1
} else if (war) {,3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"ConfigurationElement env = MavenHelpers.getOrCreateElement(build, ""env"");",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"public static void setupDockerProperties(Project project, String organization, String fromImage) {",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"boolean jar = packaging != null && packaging.equals(""jar"");",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
} else if (bundle) {,3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"} else if (""bundle"".equals(packaging)) {",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"} else if (""war"".equals(packaging)) {",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"private static Coordinate createCoordinate(String groupId, String artifactId, String version) {",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
String answer = null;,3262a38ab89de5fc32e33559efda76136b88fb87,3,1
Configuration config = plugin.getConfig();,3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"ConfigurationElement element = MavenHelpers.getConfigurationElement(config, ""images"", ""image"", ""build"", ""env"", ""JAVA_MAIN_CLASS"");",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
} else if (CamelProjectHelper.findCamelSpringDependency(project) != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,3,1
} else if (CamelProjectHelper.findCamelBlueprintDependency(project) != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"@WithAttributes(label = ""Container label"", required = false, description = ""Container label to use for the app"")",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"@WithAttributes(label = ""Group label"", required = false, description = ""Group label to use for the app"")",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"@WithAttributes(label = ""Icon"", required = false, description = ""Icon to use for the app"")",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"@WithAttributes(label = ""Main class"", required = false, description = ""Main class to use for Java standalone"")",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
String packaging = getProjectPackaging(project);,3262a38ab89de5fc32e33559efda76136b88fb87,3,1
// limit the choices depending on the project packaging,3262a38ab89de5fc32e33559efda76136b88fb87,3,1
// use a listener so the docker step knows what we selected as it want to reuse,3262a38ab89de5fc32e33559efda76136b88fb87,3,1
// only enable main if its required,3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"String from = (String) builder.getUIContext().getAttributeMap().get(""docker.from"");",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"msg += "". Added the following Maven profiles [f8-build, f8-deploy, f8-local-deploy] to make building the project easier, e.g. mvn -Pf8-local-deploy"";",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"+ "" You can change the name of the service in the <properties> section of the Maven pom file."";",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
* Returns the maven plugin for the given artifact id or returns null if it cannot be found,3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"public static Plugin findPlugin(List<Plugin> plugins, String artifactId) {",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"public static MavenPlugin findPlugin(Project project, String groupId, String artifactId) {",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
* Returns true if the dependency was added or false if its already there,3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"public static String getVersion(String groupId, String artifactId) {",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"public static Coordinate createCoordinate(String groupId, String artifactId, String version) {",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"public static boolean hasDependency(Model pom, String groupId, String artifactId) {",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"public static boolean hasDependency(List<org.apache.maven.model.Dependency> dependencies, String groupId, String artifactId) {",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"public static boolean hasManagedDependency(Model pom, String groupId, String artifactId) {",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
* Updates the given maven property value if value is not null and returns true if the pom has been changed,3262a38ab89de5fc32e33559efda76136b88fb87,3,1
* @return true if the value changed and was non null or updated was true,3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"LOG.info(""Updating pom.xml property: "" + name + "" to "" + value);",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"public static ConfigurationElement getConfigurationElement(Configuration config, String... names) {",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"public static ConfigurationElement getConfigurationElement(ConfigurationElement element, String... names) {",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"public static ConfigurationElement findChildByName(ConfigurationElement element, String name) {",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"public static ConfigurationElement findConfigurationElement(Configuration config, String name) {",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"public static ConfigurationElement getOrCreateElement(Configuration config, String name) {",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"ConfigurationElement answer = findConfigurationElement(config, name);",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"public static ConfigurationElement getOrCreateElement(ConfigurationElement config, String... names) {",3262a38ab89de5fc32e33559efda76136b88fb87,3,1
ConfigurationElement answer = config;,3262a38ab89de5fc32e33559efda76136b88fb87,3,1
"if (!Objects.equal(oldValue, value)) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,0
* Returns true if the pom has the given plugin,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (pom != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (build != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
List<Plugin> plugins = build.getPlugins();,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (plugins != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
for (Plugin plugin : plugins) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"if (Objects.equal(groupId, plugin.getGroupId()) && Objects.equal(artifactId, plugin.getArtifactId())) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"if (value != null && !Objects.equal(oldValue, value)) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (springBoot || jar) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,0
"if (!assembly.hasChildByName(""basedir"")) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,0
"protected static void setupDockerConfiguration(ConfigurationBuilder config, Map<String, String> envs, String commandShell) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"public static final String DEFAULT_KARAF_IMAGE = ""fabric8/karaf-2.4"";",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"public static final String DEFAULT_TOMCAT_IMAGE = ""fabric8/tomcat-8.0"";",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"public static final String DEFAULT_WILDFLY_IMAGE = ""jboss/wildfly:9.0.2.Final"";",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"public static final String DEFAULT_JAVA_IMAGE = ""fabric8/java-jboss-openjdk8-jdk:1.0.10"";",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"public static final String S2I_JAVA_IMAGE = ""fabric8/s2i-java:1.1.6"";",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"private static String dockerFromImagePrefix = ""docker.io/"";",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
private static String[] jarImages = new String[]{DEFAULT_JAVA_IMAGE}; // s2i is not yet supported,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
MavenFacet maven = project.getFacet(MavenFacet.class);,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"boolean war = packaging != null && packaging.equals(""war"");",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"boolean bundle = packaging != null && packaging.equals(""bundle"");",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"Map<String, String> envs = new LinkedHashMap<>();",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (springBoot) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
// only include main for JAR deployment as WAR/bundle is container based,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"MavenPlugin plugin = MavenHelpers.findPlugin(project, ""org.jolokia"", ""docker-maven-plugin"");",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (plugin != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
// if there is an existing then leave it as-is,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
} else {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (pluginBuilder != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
String commandShell = null;,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (bundle) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"ConfigurationElement images = MavenHelpers.getOrCreateElement(config, ""images"");",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"ConfigurationElement image = MavenHelpers.getOrCreateElement(images, ""image"");",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"ConfigurationElement build = MavenHelpers.getOrCreateElement(image, ""build"");",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
ConfigurationElement cfg = ConfigurationElementBuilder.create().setName(entry.getKey()).setText(entry.getValue());,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (Strings.isNotBlank(commandShell)) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (Strings.isNullOrBlank(shell.getText())) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"ConfigurationElementBuilder from = MavenHelpers.getOrCreateElementBuilder(build, ""from"");",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (Strings.isNullOrBlank(from.getText())) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (Strings.isNullOrBlank(name.getText())) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"ConfigurationElementBuilder assembly = MavenHelpers.getOrCreateElementBuilder(build, ""assembly"");",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (springBoot || jar) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"if (!assembly.hasChildByName(""basedir"")) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"if (!assembly.hasChildByName(""descriptor"")) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (Strings.isNullOrBlank(descriptorRef.getText())) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (Strings.isNotBlank(fromImage)) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
String fullDockerFromName = fromImage;,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"if (!fromImage.startsWith(dockerFromImagePrefix) || fromImage.split(""/"").length <= 2) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
fullDockerFromName = dockerFromImagePrefix + fromImage;,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"updated = MavenHelpers.updatePomProperty(properties, ""docker.image"", organization + ""/${project.artifactId}:${project.version}"", updated);",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
// jolokia is exposed on our docker images on port 8778,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (updated) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
public static String getDockerFromImage(Project project) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (project != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (maven != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (pom != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
public static String defaultDockerImage(Project project) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"if (""jar"".equals(packaging)) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
// we have both tomcat or jboss,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
private static String getProjectPackaging(Project project) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
// is required for jar images,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
for (String jar : jarImages) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (jar.equals(fromImage)) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (version != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"* @return the suggested main class, or <tt>null</tt> if not possible to guess/find a good candidate",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
public static String defaultMainClass(Project project) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
// try to guess a default main class,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (element != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
answer = element.getText();,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (Strings.isNullOrBlank(answer)) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"answer = properties.getProperty(""docker.env.MAIN"");",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"answer = properties.getProperty(""fabric8.env.MAIN"");",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (Strings.isNotBlank(answer)) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
// if camel-spring is on classpath,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (CamelProjectHelper.findCamelCDIDependency(project) != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
final Project project = getSelectedProject(builder.getUIContext());,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"if (packaging == null || springBoot || ""jar"".equals(packaging)) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
String currentImage = getDockerFromImage(project);,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (currentImage != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
} else {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"if (packaging == null || ""bundle"".equals(packaging)) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"if (!springBoot && (packaging == null || ""war"".equals(packaging))) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"public Iterable<String> getCompletionProposals(UIContext context, InputComponent<?, String> input, String value) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (choices.size() > 0) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
String defaultChoice = choices.get(0);,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (defaultChoice != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"if (packaging == null || (!packaging.equals(""war"") && !packaging.equals(""ear""))) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
boolean jarImage = DockerSetupHelper.isJarImage(from.getValue());,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (project != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
public String call() throws Exception {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (from != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
// the from image values,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
// favor Camel if there is a Camel dependency,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (!findCamelArtifacts(project).isEmpty()) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (container.getValue() != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (choice.equals(container.getValue())) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
// use the project name as default value,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
Project project = getSelectedProject(context.getUIContext());,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (project == null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
MavenFacet maven = project.getFacet(MavenFacet.class);,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (f8profiles) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"if (!MavenHelpers.hasManagedDependency(pom, ""io.fabric8"", ""fabric8-project"")) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"MavenPlugin plugin = MavenHelpers.findPlugin(project, ""io.fabric8"", ""fabric8-maven-plugin"");",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (plugin != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
// if there is an existing then leave it as-is,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
// add fabric8 plugin,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (pluginBuilder != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (test.getValue() != null && test.getValue()) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
String iconValue = icon.getValue();,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (Strings.isNotBlank(iconValue)) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.iconRef"", ""icons/"" + iconValue, updated);",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
String servicePort = getDefaultServicePort(project);,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (servicePort != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
String name = pom.getArtifactId();,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (name.length() > 24) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (updated) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (profiles.getValue() == null || !profiles.getValue()) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (profile == null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
* For karaf we can't know its definitely got http inside; so lets punt for now.,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
protected String getDefaultServicePort(Project project) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (Strings.isNotBlank(packaging)) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"if (Objects.equal(""war"", packaging) || Objects.equal(""ear"", packaging)) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
private static String asContainer(String fromImage) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (idx > 0) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
fromImage = fromImage.substring(idx + 1);,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
private static String getProjectPackaging(Project project) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"public static final String mavenPluginsGroupId = ""org.apache.maven.plugins"";",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"public static final String failsafeArtifactId = ""maven-failsafe-plugin"";",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"public static final String surefireArtifactId = ""maven-surefire-plugin"";",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (plugins != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
for (Plugin plugin : plugins) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
String groupId = plugin.getGroupId();,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"if (Strings.isNullOrBlank(groupId) || Objects.equal(groupId, mavenPluginsGroupId)) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"if (Objects.equal(artifactId, plugin.getArtifactId())) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"public static MavenPlugin findPlugin(Project project, String artifactId) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (project != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (pluginFacet != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
List<MavenPlugin> plugins = pluginFacet.listConfiguredPlugins();,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
for (MavenPlugin plugin : plugins) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (coordinate != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
* Returns the profile for the given id or null if it could not be found,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"public static Profile findProfile(Model mavenModel, String profileId) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (profiles != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"if (Objects.equal(profile.getId(), profileId)) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (groupId.equals(d.getCoordinate().getGroupId()) && artifactId.equals(d.getCoordinate().getArtifactId())) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"String version = MavenHelpers.getVersion(groupId, artifactId);",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (Strings.isNotBlank(version)) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
} else {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
String version = map.get(key);,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (version == null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (groupArtifactVersionMap == null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (in == null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
} catch (IOException e) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (key != null && value != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (version != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (packaging != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (pom != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (dependencies != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"if (Objects.equal(groupId, dependency.getGroupId()) && Objects.equal(artifactId, dependency.getArtifactId())) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (dependencyManagement != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"public static boolean updatePomProperty(Properties properties, String name, Object value, boolean updated) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (value != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"if (!Objects.equal(oldValue, value)) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (config != null && names.length > 0) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
String first = names[0];,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"ConfigurationElement root = findConfigurationElement(config, first);",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (root != null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (names.length == 1) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
ConfigurationElement e = element;,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
for (String name : names) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (e == null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
} catch (Exception e) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (answer == null) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
answer = ConfigurationElementBuilder.create().setName(name);,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"answer = findChildByName(answer, name);",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
answer = configBuilder.addChild(name);,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
if (element instanceof ConfigurationElementBuilder) {,3262a38ab89de5fc32e33559efda76136b88fb87,2,1
"public static ConfigurationElementBuilder getOrCreateElementBuilder(ConfigurationElement element, String... names) {",3262a38ab89de5fc32e33559efda76136b88fb87,2,1
MavenPluginBuilder pluginBuilder = null;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
ConfigurationBuilder configurationBuilder = null;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
* Returns the version from the list of pre-configured versions of common groupId/artifact pairs,3262a38ab89de5fc32e33559efda76136b88fb87,1,0
* Returns true if the list has the given dependency,3262a38ab89de5fc32e33559efda76136b88fb87,1,0
* Returns the version from the list of pre-configured versions of common groupid/artifact pairs,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
Build build = pom.getBuild();,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return true;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
},3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return false;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
* Returns true if the lilst has the given dependency,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"protected static void setupDockerConfiguration(ConfigurationBuilder config, Map<String, String> envs, String commandShell,",3262a38ab89de5fc32e33559efda76136b88fb87,1,0
"boolean springBoot, boolean war, boolean bundle, boolean jar) {",3262a38ab89de5fc32e33559efda76136b88fb87,1,0
"ConfigurationElementBuilder baseDir = MavenHelpers.getOrCreateElementBuilder(assembly, ""basedir"");",3262a38ab89de5fc32e33559efda76136b88fb87,1,0
},3262a38ab89de5fc32e33559efda76136b88fb87,1,0
public class DockerSetupHelper {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
private static final transient Logger LOG = LoggerFactory.getLogger(DockerSetupHelper.class);,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
// see https://github.com/fabric8io/fabric8/issues/4160,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
private static String[] bundleImages = new String[]{DEFAULT_KARAF_IMAGE};,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"private static String[] warImages = new String[]{DEFAULT_TOMCAT_IMAGE, DEFAULT_WILDFLY_IMAGE};",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
Model pom = maven.getModel();,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
boolean springBoot = hasSpringBootMavenPlugin(project);,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
},3262a38ab89de5fc32e33559efda76136b88fb87,1,1
pluginBuilder = null;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
configurationBuilder = null;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
pluginBuilder = MavenPluginBuilder.create(),3262a38ab89de5fc32e33559efda76136b88fb87,1,1
configurationBuilder = ConfigurationBuilder.create(pluginBuilder);,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"commandShell = ""/usr/bin/deploy-and-start"";",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
MavenPluginFacet pluginFacet = project.getFacet(MavenPluginFacet.class);,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"protected static void setupDockerConfiguration(ConfigurationBuilder config, Map<String, String> envs, String commandShell,",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"boolean springBoot, boolean war, boolean bundle, boolean jar) {",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"for (Map.Entry<String, String> entry : envs.entrySet()) {",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"ConfigurationElementBuilder shell = MavenHelpers.getOrCreateElementBuilder(build, ""cmd"", ""shell"");",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"ConfigurationElementBuilder name = MavenHelpers.getOrCreateElementBuilder(image, ""name"");",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"ConfigurationElementBuilder baseDir = MavenHelpers.getOrCreateElementBuilder(assembly, ""basedir"");",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"ConfigurationElementBuilder descriptorRef = MavenHelpers.getOrCreateElementBuilder(assembly, ""descriptorRef"");",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
// update properties section in pom.xml,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
Properties properties = pom.getProperties();,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
boolean updated = false;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""docker.from"", fullDockerFromName, updated);",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""docker.port.container.jolokia"", ""8778"", updated);",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
// spring-boot is packaged as war but runs as fat WARs,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""docker.assemblyDescriptorRef"", ""artifact"", updated);",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""docker.port.container.http"", ""8080"", updated);",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
// tomcat/jetty on port 8080,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""docker.assemblyDescriptorRef"", ""rootWar"", updated);",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
// karaf,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""docker.assemblyDescriptorRef"", ""artifact-with-dependencies"", updated);",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""docker.port.container.http"", ""8181"", updated);",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
// to save then set the model,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"return properties.getProperty(""docker.from"");",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return null;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
public static boolean hasSpringBootMavenPlugin(Project project) {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"Coordinate coor = CoordinateBuilder.create(""org.springframework.boot:spring-boot-maven-plugin"");",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return pluginFacet.hasPlugin(coor);,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return false;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return jarImages[0];,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return bundleImages[0];,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return maven.getModel().getPackaging();,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
public static boolean isJarImage(String fromImage) {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return true;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
CoordinateBuilder builder = CoordinateBuilder.create(),3262a38ab89de5fc32e33559efda76136b88fb87,1,1
builder = builder.setVersion(version);,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return builder;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
* Tries to guess a good default main class to use based on the project.,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return answer;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"return ""org.apache.camel.cdi.Main"";",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"return ""org.apache.camel.spring.Main"";",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"return ""org.apache.camel.test.blueprint.Main"";",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
// TODO: what about spring-boot / docker-swarm??,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
public class Fabric8SetupStep extends AbstractFabricProjectCommand implements UIWizardStep {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
private static final transient Logger LOG = LoggerFactory.getLogger(Fabric8SetupStep.class);,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"private String[] jarImages = new String[]{DockerSetupHelper.DEFAULT_JAVA_IMAGE, DockerSetupHelper.S2I_JAVA_IMAGE};",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
private String[] bundleImages = new String[]{DockerSetupHelper.DEFAULT_KARAF_IMAGE};,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"private String[] warImages = new String[]{DockerSetupHelper.DEFAULT_TOMCAT_IMAGE, DockerSetupHelper.DEFAULT_WILDFLY_IMAGE};",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
public UICommandMetadata getMetadata(UIContext context) {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return Metadata.forCommand(Fabric8SetupStep.class).name(,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
".description(""Configure the Fabric8 and Docker options for the project"");",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
},3262a38ab89de5fc32e33559efda76136b88fb87,1,1
public boolean isEnabled(UIContext context) {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"// this is a step in a wizard, you cannot run this standalone",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return false;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
public NavigationResult next(UINavigationContext context) throws Exception {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return null;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
public void initializeUI(final UIBuilder builder) throws Exception {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
boolean springBoot = hasSpringBootMavenPlugin(project);,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
final List<String> choices = new ArrayList<String>();,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
from.setCompleter(new UICompleter<String>() {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return choices;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
// is it possible to pre select a choice?,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
from.addValueChangeListener(new ValueChangeListener() {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
public void valueChanged(ValueChangeEvent event) {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
main.setRequired(new Callable<Boolean>() {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
public Boolean call() throws Exception {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return jarImage;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
main.addValueChangeListener(new ValueChangeListener() {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
container.setDefaultValue(new Callable<String>() {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return asContainer(from);,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
icon.setValueChoices(new Iterable<String>() {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
public Iterator<String> iterator() {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
Set<String> choices = new LinkedHashSet<String>();,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return choices.iterator();,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
icon.setDefaultValue(new Callable<String>() {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"return ""camel"";",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
for (String choice : icon.getValueChoices()) {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return choice;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
// use java by default,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"return ""java"";",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
group.setDefaultValue(new Callable<String>() {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
public Result execute(UIExecutionContext context) throws Exception {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"return Results.fail(""No pom.xml available so cannot edit the project!"");",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
// setup docker-maven-plugin and fabric8-maven-plugin,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
Model pom = maven.getModel();,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
// import fabric8 bom,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"LOG.info(""setting up fabric8 maven profiles"");",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"boolean f8profiles = setupFabricMavenProfiles(project, maven, pom);",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return Results.success(msg);,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"private void importFabricBom(Project project, Model pom) {",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
Dependency bom = DependencyBuilder.create(),3262a38ab89de5fc32e33559efda76136b88fb87,1,1
private void setupFabricMavenPlugin(Project project) {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
pluginBuilder = null;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
pluginBuilder = MavenPluginBuilder.create(),3262a38ab89de5fc32e33559efda76136b88fb87,1,1
MavenPluginFacet pluginFacet = project.getFacet(MavenPluginFacet.class);,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"private void setupArguillianTest(Project project, Model pom) {",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"private void setupFabricProperties(Project project, MavenFacet maven, Model pom) {",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
// update properties section in pom.xml,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
boolean updated = false;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
Properties properties = pom.getProperties();,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.label.container"", container.getValue(), updated);",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.label.group"", group.getValue(), updated);",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
// there is a max 24 chars limit in OpenShift/Kubernetes,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
// print a warning,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
// log and print to system out as the latter is what is seen in the CLI,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
// clip the name at max 24 chars,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"name = name.substring(0, 24);",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.service.containerPort"", servicePort, updated);",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.service.port"", ""80"", updated);",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"updated = MavenHelpers.updatePomProperty(properties, ""fabric8.service.name"", name, updated);",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
// to save then set the model,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"private boolean setupFabricMavenProfiles(Project project, MavenFacet maven, Model pom) {",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"Profile profile = MavenHelpers.findProfile(pom, ""f8-build"");",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
profile = new Profile();,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
Build build = new Build();,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
updated = true;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"profile = MavenHelpers.findProfile(pom, ""f8-deploy"");",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
Properties prop = new Properties();,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"profile = MavenHelpers.findProfile(pom, ""f8-local-deploy"");",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return true;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
* If this is a WAR or EAR then lets assume 8080.,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"return ""8080"";",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
int idx = fromImage.indexOf('/');,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
idx = fromImage.indexOf('-');,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"fromImage = fromImage.substring(0, idx);",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return fromImage;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return maven.getModel().getPackaging();,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
public class MavenHelpers {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
private static final transient Logger LOG = LoggerFactory.getLogger(MavenHelpers.class);,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return plugin;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
},3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return null;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"return findPlugin(project, mavenPluginsGroupId, artifactId);",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
MavenPluginFacet pluginFacet = project.getFacet(MavenPluginFacet.class);,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
Coordinate coordinate = plugin.getCoordinate();,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"if (Objects.equal(groupId, coordinate.getGroupId()) &&",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"Objects.equal(artifactId, coordinate.getArtifactId())) {",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
List<Profile> profiles = mavenModel.getProfiles();,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
for (Profile profile : profiles) {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return profile;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
List<Dependency> dependencies = project.getFacet(DependencyFacet.class).getEffectiveDependencies();,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
for (Dependency d : dependencies) {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return false;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
DependencyBuilder component = DependencyBuilder.create().,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
component = component.setVersion(version);,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return true;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
* Returns the version from the list of pre-configured versions of common groupId/artifact pairs,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"Map<String, String> map = getGroupArtifactVersionMap();",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return version;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"protected static Map<String, String> getGroupArtifactVersionMap() {",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
groupArtifactVersionMap = new HashMap<>();,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"InputStream in = MavenHelpers.class.getResourceAsStream(""versions.properties"");",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"LOG.warn(""Could not find versions.properties on the classpath!"");",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
Properties properties = new Properties();,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
try {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"throw new RuntimeException(""Failed to load versions.properties: "" + e, e);",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"Set<Map.Entry<Object, Object>> entries = properties.entrySet();",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"for (Map.Entry<Object, Object> entry : entries) {",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
Object key = entry.getKey();,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
Object value = entry.getValue();,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return groupArtifactVersionMap;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"return createCoordinate(groupId, artifactId, version, null);",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
CoordinateBuilder builder = CoordinateBuilder.create(),3262a38ab89de5fc32e33559efda76136b88fb87,1,1
builder = builder.setVersion(version);,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
builder = builder.setPackaging(packaging);,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return builder;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
* Returns true if the pom has the given dependency,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
List<org.apache.maven.model.Dependency> dependencies = pom.getDependencies();,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"return hasDependency(dependencies, groupId, artifactId);",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
* Returns true if the list has the given dependency,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
for (org.apache.maven.model.Dependency dependency : dependencies) {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
* Returns true if the pom has the given managed dependency,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
DependencyManagement dependencyManagement = pom.getDependencyManagement();,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"return hasDependency(dependencyManagement.getDependencies(), groupId, artifactId);",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
Object oldValue = properties.get(name);,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return updated;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return root;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
int remainingLength = names.length - 1;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
String[] remaining = new String[remainingLength];,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"return getConfigurationElement(root, remaining);",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"e = findChildByName(e, name);",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return e;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return element.getChildByName(name);,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return config.getConfigurationElement(name);,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return answer;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
ConfigurationElementBuilder configBuilder = asConfigurationElementBuilder(config);,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
public static ConfigurationElementBuilder asConfigurationElementBuilder(ConfigurationElement element) {,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return (ConfigurationElementBuilder) element;,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
return ConfigurationElementBuilder.createFromExisting(element);,3262a38ab89de5fc32e33559efda76136b88fb87,1,1
"return asConfigurationElementBuilder(getOrCreateElement(element, names));",3262a38ab89de5fc32e33559efda76136b88fb87,1,1
MavenPluginBuilder pluginBuilder;,3262a38ab89de5fc32e33559efda76136b88fb87,0,0
ConfigurationBuilder configurationBuilder;,3262a38ab89de5fc32e33559efda76136b88fb87,0,0
".setCoordinate(createCoordinate(""org.jolokia"", ""docker-maven-plugin"", VersionHelper.dockerVersion()));",3262a38ab89de5fc32e33559efda76136b88fb87,0,0
".setCoordinate(createCoordinate(""org.jolokia"", ""docker-maven-plugin"", VersionHelper.dockerVersion()));;",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.io.IOException;,3262a38ab89de5fc32e33559efda76136b88fb87,0,0
import java.io.InputStream;,3262a38ab89de5fc32e33559efda76136b88fb87,0,0
import java.util.HashMap;,3262a38ab89de5fc32e33559efda76136b88fb87,0,0
import java.util.List;,3262a38ab89de5fc32e33559efda76136b88fb87,0,0
import java.util.Map;,3262a38ab89de5fc32e33559efda76136b88fb87,0,0
import java.util.Properties;,3262a38ab89de5fc32e33559efda76136b88fb87,0,0
import java.util.Set;,3262a38ab89de5fc32e33559efda76136b88fb87,0,0
import org.apache.maven.model.Build;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.maven.plugins.ConfigurationElementNotFoundException;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.maven.plugins.MavenPluginBuilder;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.io.IOException;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.io.InputStream;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.util.HashMap;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.util.List;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.util.Map;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.util.Properties;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.util.Set;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
/**,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
*/,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"baseDir.setText(""/app"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,0
"setupDockerConfiguration(configurationBuilder, envs, commandShell, springBoot, war, bundle, jar);",3262a38ab89de5fc32e33559efda76136b88fb87,0,0
"setupDockerConfiguration(configurationBuilder, envs, commandShell);",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
/**,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
*,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"*  Red Hat licenses this file to you under the Apache License, version",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
*  with the License.  You may obtain a copy of the License at,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"*  Unless required by applicable law or agreed to in writing, software",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
*  implied.  See the License for the specific language governing,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
*  permissions and limitations under the License.,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
*/,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
package io.fabric8.forge.devops.setup;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import io.fabric8.forge.addon.utils.CamelProjectHelper;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import io.fabric8.forge.addon.utils.MavenHelpers;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import io.fabric8.forge.addon.utils.VersionHelper;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import io.fabric8.utils.Strings;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.apache.maven.model.Model;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.dependencies.Coordinate;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.dependencies.builder.CoordinateBuilder;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.maven.plugins.Configuration;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.maven.plugins.ConfigurationBuilder;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.maven.plugins.ConfigurationElement;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.maven.plugins.ConfigurationElementBuilder;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.maven.plugins.MavenPlugin;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.maven.plugins.MavenPluginBuilder;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.maven.projects.MavenFacet;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.maven.projects.MavenPluginFacet;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.projects.Project;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.slf4j.Logger;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.slf4j.LoggerFactory;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.util.LinkedHashMap;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.util.Map;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.util.Properties;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"envs.put(""JAR"", ""${project.artifactId}-${project.version}.war"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"envs.put(""JAVA_OPTIONS"", ""-Djava.security.egd=/dev/./urandom"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"envs.put(""CATALINA_OPTS"", ""-javaagent:/opt/tomcat/jolokia-agent.jar=host=0.0.0.0,port=8778"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"envs.put(""JAVA_MAIN_CLASS"", main);",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
MavenPluginBuilder pluginBuilder;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
ConfigurationBuilder configurationBuilder;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"LOG.info(""Found existing docker-maven-plugin"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"LOG.info(""Adding docker-maven-plugin"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
".setCoordinate(MavenHelpers.createCoordinate(""org.jolokia"", ""docker-maven-plugin"", VersionHelper.dockerVersion()));",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
pluginBuilder.setConfiguration(configurationBuilder);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"setupDockerConfiguration(configurationBuilder, envs, commandShell, springBoot, war, bundle, jar);",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
pluginFacet.addPlugin(pluginBuilder);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"setupDockerProperties(project, organization, fromImage);",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
env.getChildren().add(cfg);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
MavenHelpers.asConfigurationElementBuilder(shell).setText(commandShell);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"from.setText(""${docker.from}"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"name.setText(""${docker.image}"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"baseDir.setText(""/app"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"descriptorRef.setText(""${docker.assemblyDescriptorRef}"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
maven.setModel(pom);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
.setGroupId(groupId),3262a38ab89de5fc32e33559efda76136b88fb87,0,1
.setArtifactId(artifactId);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
/**,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
*,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"*  Red Hat licenses this file to you under the Apache License, version",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
*  with the License.  You may obtain a copy of the License at,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"*  Unless required by applicable law or agreed to in writing, software",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
*  implied.  See the License for the specific language governing,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
*  permissions and limitations under the License.,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
*/,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
package io.fabric8.forge.devops.setup;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.util.ArrayList;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.util.Arrays;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.util.Iterator;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.util.LinkedHashSet;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.util.List;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.util.Properties;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.util.Set;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.util.concurrent.Callable;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import javax.inject.Inject;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import io.fabric8.forge.addon.utils.MavenHelpers;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import io.fabric8.forge.addon.utils.VersionHelper;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import io.fabric8.forge.addon.utils.validator.ClassNameOrMavenPropertyValidator;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import io.fabric8.utils.Objects;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import io.fabric8.utils.Strings;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.apache.maven.model.Build;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.apache.maven.model.Model;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.apache.maven.model.Profile;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.dependencies.Dependency;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.facets.FacetFactory;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.facets.constraints.FacetConstraint;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.maven.plugins.ExecutionBuilder;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.maven.plugins.MavenPlugin;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.maven.plugins.MavenPluginBuilder;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.maven.projects.MavenFacet;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.maven.projects.MavenPluginFacet;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.projects.Project;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.projects.facets.ResourcesFacet;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.resource.ResourceFactory;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.templates.TemplateFactory;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.ui.context.UIBuilder;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.ui.context.UIContext;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.ui.context.UIExecutionContext;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.ui.context.UINavigationContext;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.ui.input.InputComponent;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.ui.input.UICompleter;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.ui.input.UIInput;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.ui.input.UISelectOne;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.ui.input.ValueChangeListener;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.ui.input.events.ValueChangeEvent;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.ui.metadata.UICommandMetadata;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.ui.metadata.WithAttributes;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.ui.result.NavigationResult;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.ui.result.Result;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.ui.result.Results;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.ui.util.Categories;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.ui.util.Metadata;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.ui.wizard.UIWizardStep;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.slf4j.Logger;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.slf4j.LoggerFactory;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import static io.fabric8.forge.addon.utils.MavenHelpers.ensureMavenDependencyAdded;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import static io.fabric8.forge.devops.setup.DockerSetupHelper.getDockerFromImage;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import static io.fabric8.forge.devops.setup.DockerSetupHelper.hasSpringBootMavenPlugin;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import static io.fabric8.forge.devops.setup.DockerSetupHelper.setupDocker;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import static io.fabric8.forge.devops.setup.SetupProjectHelper.findCamelArtifacts;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"@FacetConstraint({MavenFacet.class, MavenPluginFacet.class, ResourcesFacet.class})",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
@Inject,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
private UIInput<String> organization;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
private UIInput<String> from;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
private UIInput<String> container;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
private UIInput<String> group;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
private UISelectOne<String> icon;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
private UIInput<String> main;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
private UIInput<Boolean> test;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
private UIInput<Boolean> profiles;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
private DependencyInstaller dependencyInstaller;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
private TemplateFactory factory;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
ResourceFactory resourceFactory;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
FacetFactory facetFactory;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
@Override,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"""Fabric8: Setup"").category(Categories.create(CATEGORY))",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"organization.setDefaultValue(""fabric8"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
builder.add(organization);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"LOG.info(""Getting the current project"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"LOG.info(""Got the current project"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
choices.add(currentImage);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
choices.addAll(Arrays.asList(jarImages));,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
choices.add(bundleImages[0]);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
choices.addAll(Arrays.asList(warImages));,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
});,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
from.setDefaultValue(defaultChoice);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"builder.getUIContext().getAttributeMap().put(""docker.from"", event.getNewValue());",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
builder.add(from);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
/*,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
main.setEnabled(jarImage);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
main.setDefaultValue(DockerSetupHelper.defaultMainClass(project));,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
main.addValidator(new ClassNameOrMavenPropertyValidator(true));,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"builder.getUIContext().getAttributeMap().put(""docker.main"", event.getNewValue());",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
builder.add(main);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"choices.add(""activemq"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"choices.add(""camel"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"choices.add(""java"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"choices.add(""jetty"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"choices.add(""karaf"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"choices.add(""mule"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"choices.add(""tomcat"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"choices.add(""tomee"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"choices.add(""weld"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"choices.add(""wildfly"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
builder.add(profiles).add(test).add(icon).add(group).add(container);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"LOG.info(""starting to setup fabric8 project"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"setupDocker(project, organization.getValue(), from.getValue(), main.getValue());",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"LOG.info(""docker-maven-plugin now setup"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
setupFabricMavenPlugin(project);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"LOG.info(""fabric8-maven-plugin now setup"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"LOG.info(""importing fabric8 bom"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"importFabricBom(project, pom);",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"facetFactory.install(project, ResourcesFacet.class);",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"LOG.info(""setting up arquillian test"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"setupArguillianTest(project, pom);",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"LOG.info(""setting up fabric8 properties"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"setupFabricProperties(project, maven, pom);",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
".setCoordinate(MavenHelpers.createCoordinate(""io.fabric8"", ""fabric8-project"", VersionHelper.fabric8Version(), ""pom""))",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
".setScopeType(""import"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"dependencyInstaller.installManaged(project, bom);",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
MavenPluginBuilder pluginBuilder;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"LOG.info(""Found existing fabric8-maven-plugin"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"LOG.info(""Adding fabric8-maven-plugin"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
".setCoordinate(MavenHelpers.createCoordinate(""io.fabric8"", ""fabric8-maven-plugin"", VersionHelper.fabric8Version()))",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
".addExecution(ExecutionBuilder.create().setId(""json"").setPhase(""generate-resources"").addGoal(""json""))",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
".addExecution(ExecutionBuilder.create().setId(""attach"").setPhase(""package"").addGoal(""attach""));",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
pluginFacet.addPlugin(pluginBuilder);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"ensureMavenDependencyAdded(project, dependencyInstaller, ""io.fabric8"", ""fabric8-arquillian"", ""test"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"ensureMavenDependencyAdded(project, dependencyInstaller, ""org.jboss.arquillian.junit"", ""arquillian-junit-container"", ""test"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
LOG.warn(msg);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
System.out.println(msg);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
maven.setModel(pom);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"LOG.info(""updated pom.xml"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"LOG.info(""Adding f8-build profile"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"profile.setId(""f8-build"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"build.setDefaultGoal(""clean install docker:build fabric8:json"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
profile.setBuild(build);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
pom.addProfile(profile);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"LOG.info(""Adding f8-deploy profile"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"profile.setId(""f8-deploy"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"prop.setProperty(""fabric8.imagePullPolicySnapshot"", ""Always"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"prop.setProperty(""fabric8.recreate"", ""true"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
profile.setProperties(prop);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"build.setDefaultGoal(""clean install docker:build docker:push fabric8:json fabric8:apply"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"LOG.info(""Adding f8-local-deploy profile"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"profile.setId(""f8-local-deploy"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"build.setDefaultGoal(""clean install docker:build fabric8:json fabric8:apply"");",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
* Try to determine the default service port.,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
/**,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"*  Copyright 2005-2015 Red Hat, Inc.",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
*,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"*  Red Hat licenses this file to you under the Apache License, version",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"*  2.0 (the ""License""); you may not use this file except in compliance",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
*  with the License.  You may obtain a copy of the License at,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
*     http://www.apache.org/licenses/LICENSE-2.0,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"*  Unless required by applicable law or agreed to in writing, software",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"*  distributed under the License is distributed on an ""AS IS"" BASIS,",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
*  implied.  See the License for the specific language governing,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
*  permissions and limitations under the License.,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
*/,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
package io.fabric8.forge.addon.utils;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.io.IOException;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.io.InputStream;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.util.HashMap;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.util.List;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.util.Map;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.util.Properties;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import java.util.Set;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import io.fabric8.utils.Objects;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import io.fabric8.utils.Strings;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.apache.maven.model.DependencyManagement;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.apache.maven.model.Model;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.apache.maven.model.Plugin;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.apache.maven.model.Profile;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.dependencies.Coordinate;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.dependencies.Dependency;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.dependencies.builder.CoordinateBuilder;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.dependencies.builder.DependencyBuilder;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.maven.plugins.Configuration;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.maven.plugins.ConfigurationElement;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.maven.plugins.ConfigurationElementBuilder;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.maven.plugins.MavenPlugin;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.maven.projects.MavenPluginFacet;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.projects.Project;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.projects.dependencies.DependencyInstaller;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.jboss.forge.addon.projects.facets.DependencyFacet;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.slf4j.Logger;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
import org.slf4j.LoggerFactory;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"private static Map<String, String> groupArtifactVersionMap;",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
setGroupId(groupId).,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
setArtifactId(artifactId).,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
setScopeType(scope);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"dependencyInstaller.install(project, component);",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
properties.load(in);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"groupArtifactVersionMap.put(key.toString(), value.toString());",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
.setGroupId(groupId),3262a38ab89de5fc32e33559efda76136b88fb87,0,1
.setArtifactId(artifactId);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"properties.put(name, value);",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
"System.arraycopy(names, 1, remaining, 0, remainingLength);",3262a38ab89de5fc32e33559efda76136b88fb87,0,1
break;,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
config.addConfigurationElement(answer);,3262a38ab89de5fc32e33559efda76136b88fb87,0,1
